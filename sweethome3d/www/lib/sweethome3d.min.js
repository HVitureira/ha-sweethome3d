var __extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),ObjectXMLExporter=function(){function e(){}return e.prototype.writeElement=function(e,t){e.writeStartElement(this.getTag(t)),this.writeAttributes(e,t),this.writeChildren(e,t),e.writeEndElement()},e.prototype.getTag=function(e){var t,i="string"==typeof(t=e.constructor)?t.substring(t.lastIndexOf(".")+1):t.__class?t.__class.substring(t.__class.lastIndexOf(".")+1):t.name.substring(t.name.lastIndexOf(".")+1);return function(e,t,i){return void 0===i&&(i=0),e.substr(i,4)===t}(i,"Home")&&"Home"!==i&&(i=i.substring(4)),i.charAt(0).toLowerCase()+i.substring(1)},e.prototype.writeAttributes=function(e,t){},e.prototype.writeChildren=function(e,t){},e}();ObjectXMLExporter.__class="com.eteks.sweethome3d.io.ObjectXMLExporter";var XMLWriter=function(){function e(e){this.elements=[],void 0===this.emptyElement&&(this.emptyElement=!1),void 0===this.elementWithText&&(this.elementWithText=!1),this.out=e,this.out.write("<?xml version='1.0'?>\n")}return e.prototype.writeStartElement=function(e){this.elements.length>0&&(this.emptyElement&&this.out.write(">"),this.writeIndentation()),this.out.write("<"+e),this.elements.push(e),this.emptyElement=!0,this.elementWithText=!1},e.prototype.writeEndElement=function(){var e=this.elements.pop();this.emptyElement?this.out.write("/>"):(this.elementWithText||this.writeIndentation(),this.out.write("</"+e+">")),this.emptyElement=!1,this.elementWithText=!1},e.prototype.writeIndentation=function(){this.out.write("\n");for(var e=0;e<this.elements.length;e++)this.out.write("  ")},e.prototype.writeAttribute$java_lang_String$java_lang_String=function(t,i){this.out.write(" "+t+"='"+e.replaceByEntities(i)+"'")},e.prototype.writeAttribute$java_lang_String$java_lang_String$java_lang_String=function(e,t,i){null==t&&t===i||t===i||this.writeAttribute$java_lang_String$java_lang_String(e,t)},e.prototype.writeAttribute=function(e,t,i){if("string"!=typeof e&&null!==e||"string"!=typeof t&&null!==t||"string"!=typeof i&&null!==i){if("string"!=typeof e&&null!==e||"string"!=typeof t&&null!==t||void 0!==i)throw new Error("invalid overload");return this.writeAttribute$java_lang_String$java_lang_String(e,t)}return this.writeAttribute$java_lang_String$java_lang_String$java_lang_String(e,t,i)},e.prototype.writeIntegerAttribute$java_lang_String$int=function(e,t){this.writeAttribute$java_lang_String$java_lang_String(e,String(t).toString())},e.prototype.writeIntegerAttribute$java_lang_String$int$int=function(e,t,i){t!==i&&this.writeAttribute$java_lang_String$java_lang_String(e,String(t).toString())},e.prototype.writeIntegerAttribute=function(e,t,i){if("string"!=typeof e&&null!==e||"number"!=typeof t&&null!==t||"number"!=typeof i&&null!==i){if("string"!=typeof e&&null!==e||"number"!=typeof t&&null!==t||void 0!==i)throw new Error("invalid overload");return this.writeIntegerAttribute$java_lang_String$int(e,t)}return this.writeIntegerAttribute$java_lang_String$int$int(e,t,i)},e.prototype.writeLongAttribute$java_lang_String$long=function(e,t){this.writeAttribute$java_lang_String$java_lang_String(e,String(t).toString())},e.prototype.writeLongAttribute$java_lang_String$java_lang_Long=function(e,t){null!=t&&this.writeAttribute$java_lang_String$java_lang_String(e,t.toString())},e.prototype.writeLongAttribute=function(e,t){if("string"!=typeof e&&null!==e||"number"!=typeof t&&null!==t){if("string"!=typeof e&&null!==e||"number"!=typeof t&&null!==t)throw new Error("invalid overload");return this.writeLongAttribute$java_lang_String$long(e,t)}return this.writeLongAttribute$java_lang_String$java_lang_Long(e,t)},e.prototype.writeFloatAttribute$java_lang_String$float=function(e,t){this.writeAttribute$java_lang_String$java_lang_String(e,String(t).toString())},e.prototype.writeFloatAttribute$java_lang_String$float$float=function(e,t,i){t!==i&&this.writeFloatAttribute$java_lang_String$float(e,t)},e.prototype.writeFloatAttribute=function(e,t,i){if("string"!=typeof e&&null!==e||"number"!=typeof t&&null!==t||"number"!=typeof i&&null!==i){if("string"!=typeof e&&null!==e||"number"!=typeof t&&null!==t||void 0!==i){if("string"!=typeof e&&null!==e||"number"!=typeof t&&null!==t||void 0!==i)throw new Error("invalid overload");return this.writeFloatAttribute$java_lang_String$float(e,t)}return this.writeFloatAttribute$java_lang_String$java_lang_Float(e,t)}return this.writeFloatAttribute$java_lang_String$float$float(e,t,i)},e.prototype.writeFloatAttribute$java_lang_String$java_lang_Float=function(e,t){null!=t&&this.writeAttribute$java_lang_String$java_lang_String(e,t.toString())},e.prototype.writeBigDecimalAttribute=function(e,t){null!=t&&this.writeAttribute$java_lang_String$java_lang_String(e,String(t).toString())},e.prototype.writeBooleanAttribute=function(e,t,i){t!==i&&this.writeAttribute$java_lang_String$java_lang_String(e,String(t).toString())},e.prototype.writeColorAttribute=function(e,t){null!=t&&this.writeAttribute$java_lang_String$java_lang_String(e,CoreTools.format("%08X",t))},e.prototype.writeText=function(t){this.emptyElement&&(this.out.write(">"),this.emptyElement=!1,this.elementWithText=!0),this.out.write(e.replaceByEntities(t))},e.replaceByEntities=function(e){return e.split("&").join("&amp;").split("<").join("&lt;").split("'").join("&apos;").split('"').join("&quot;").split("\n").join("&#10;")},e.prototype.write$int=function(e){this.writeText(String(String.fromCharCode(e)).toString())},e.prototype.write$char_A$int$int=function(e,t,i){this.writeText(e.join("").substr(t,i))},e.prototype.write=function(e,t,i){if(!(null!=e&&e instanceof Array&&(0==e.length||null==e[0]||"string"==typeof e[0])||null===e)||"number"!=typeof t&&null!==t||"number"!=typeof i&&null!==i){if("string"!=typeof e&&null!==e||"number"!=typeof t&&null!==t||"number"!=typeof i&&null!==i){if("number"!=typeof e&&null!==e||void 0!==t||void 0!==i)throw new Error("invalid overload");return this.write$int(e)}return this.write$java_lang_String$int$int(e,t,i)}return this.write$char_A$int$int(e,t,i)},e.prototype.write$java_lang_String$int$int=function(e,t,i){this.writeText(e.substring(t,t+i))},e}();XMLWriter.__class="com.eteks.sweethome3d.io.XMLWriter";var HomeXMLHandler=function(e){function t(t){var i=this;if(null!=t&&t instanceof UserPreferences||null===t){void 0===(i=e.call(this)||this).preferences&&(i.preferences=null),void 0===i.home&&(i.home=null),void 0===i.homeElementName&&(i.homeElementName=null),void 0===i.labelText&&(i.labelText=null),void 0===i.leftSideBaseboard&&(i.leftSideBaseboard=null),void 0===i.rightSideBaseboard&&(i.rightSideBaseboard=null),void 0===i.homeBackgroundImage&&(i.homeBackgroundImage=null),void 0===i.backgroundImage&&(i.backgroundImage=null),void 0===i.materialTexture&&(i.materialTexture=null),i.buffer={str:"",toString:function(){return this.str}},i.elements=[],i.attributes=[],i.groupsFurniture=[],i.properties=[],i.textStyles=[],i.levels={},i.joinedWalls={},i.textures={},i.materials=[],i.transformations=[],i.sashes=[],i.lightSources=[],i.lightSourceMaterialNames=[],i.shelfBoxes=[],i.shelfElevations=[],i.points=[],i.furnitureVisiblePropertyNames=[],i.printedLevelIds=[],i.preferences=null!=t?t:new DefaultUserPreferences(!1,null)}else{if(void 0!==t)throw new Error("invalid overload");void 0===(i=e.call(this)||this).preferences&&(i.preferences=null),void 0===i.home&&(i.home=null),void 0===i.homeElementName&&(i.homeElementName=null),void 0===i.labelText&&(i.labelText=null),void 0===i.leftSideBaseboard&&(i.leftSideBaseboard=null),void 0===i.rightSideBaseboard&&(i.rightSideBaseboard=null),void 0===i.homeBackgroundImage&&(i.homeBackgroundImage=null),void 0===i.backgroundImage&&(i.backgroundImage=null),void 0===i.materialTexture&&(i.materialTexture=null),i.buffer={str:"",toString:function(){return this.str}},i.elements=[],i.attributes=[],i.groupsFurniture=[],i.properties=[],i.textStyles=[],i.levels={},i.joinedWalls={},i.textures={},i.materials=[],i.transformations=[],i.sashes=[],i.lightSources=[],i.lightSourceMaterialNames=[],i.shelfBoxes=[],i.shelfElevations=[],i.points=[],i.furnitureVisiblePropertyNames=[],i.printedLevelIds=[],i.preferences=new DefaultUserPreferences(!1,null),void 0===i.preferences&&(i.preferences=null),void 0===i.home&&(i.home=null),void 0===i.homeElementName&&(i.homeElementName=null),void 0===i.labelText&&(i.labelText=null),void 0===i.leftSideBaseboard&&(i.leftSideBaseboard=null),void 0===i.rightSideBaseboard&&(i.rightSideBaseboard=null),void 0===i.homeBackgroundImage&&(i.homeBackgroundImage=null),void 0===i.backgroundImage&&(i.backgroundImage=null),void 0===i.materialTexture&&(i.materialTexture=null),i.buffer={str:"",toString:function(){return this.str}},i.elements=[],i.attributes=[],i.groupsFurniture=[],i.properties=[],i.textStyles=[],i.levels={},i.joinedWalls={},i.textures={},i.materials=[],i.transformations=[],i.sashes=[],i.lightSources=[],i.lightSourceMaterialNames=[],i.shelfBoxes=[],i.shelfElevations=[],i.points=[],i.furnitureVisiblePropertyNames=[],i.printedLevelIds=[]}return i}return __extends(t,e),t.prototype.startDocument=function(){this.home=null,this.elements.length=0,this.attributes.length=0,this.groupsFurniture.length=0,function(e){for(var t in e)delete e[t]}(this.levels),function(e){for(var t in e)delete e[t]}(this.joinedWalls)},t.prototype.startElement=function(e,i,n,o){var r,l=this;(r=this.buffer).str=r.str.substring(0,0),this.elements.push(n);for(var a={},s=0;s<o.getLength();s++)a[o.getQName(s)]=o.getValue(s).replace("&quot;",'"').replace("&lt;","<").replace("&gt;",">").replace("&amp;","&");this.attributes.push(a),"property"!==n&&"furnitureVisibleProperty"!==n&&"textStyle"!==n&&(this.properties.push({}),this.textStyles.push({})),"home"===n?(this.setHome(this.createHome(n,a)),this.furnitureVisiblePropertyNames.length=0,this.homeBackgroundImage=null):"environment"===n?function(e){for(var t in e)delete e[t]}(this.textures):"level"===n?this.backgroundImage=null:"pieceOfFurniture"===n||"doorOrWindow"===n||"light"===n||"shelfUnit"===n||"furnitureGroup"===n?(!function(e){for(var t in e)delete e[t]}(this.textures),this.materials.length=0,this.transformations.length=0,this.sashes.length=0,this.lightSources.length=0,this.lightSourceMaterialNames.length=0,this.shelfBoxes.length=0,this.shelfElevations.length=0,"furnitureGroup"===n&&this.groupsFurniture.push([])):"room"===n?(!function(e){for(var t in e)delete e[t]}(this.textures),this.points.length=0):"polyline"===n?this.points.length=0:"label"===n?this.labelText=null:"wall"===n?(!function(e){for(var t in e)delete e[t]}(this.textures),this.leftSideBaseboard=null,this.rightSideBaseboard=null):"baseboard"===n?(this.textures,l.textures[t.UNIQUE_ATTRIBUTE],delete l.textures[t.UNIQUE_ATTRIBUTE]):"material"===n&&(this.materialTexture=null)},t.prototype.characters=function(e,t,i){this.buffer.str+=e.substr(t,i)},t.prototype.endElement=function(e,i,n){this.elements.pop();var o,r=0==this.elements.length?null:0==(o=this.elements).length?null:o[o.length-1],l=this.attributes.pop();if(null!=this.homeElementName&&this.homeElementName===n)this.setHomeAttributes(this.home,n,l);else if("furnitureVisibleProperty"===n){if(null==function(e,t){return void 0===e[t]?null:e[t]}(l,"name"))throw new SAXException("Missing name attribute");this.furnitureVisiblePropertyNames.push(function(e,t){return void 0===e[t]?null:e[t]}(l,"name"))}else if("environment"===n)this.setEnvironmentAttributes(this.home.getEnvironment(),n,l);else if("compass"===n)this.setCompassAttributes(this.home.getCompass(),n,l);else if("print"===n)this.home.setPrint(this.createPrint(l));else if("printedLevel"===n&&"print"===r){if(null==function(e,t){return void 0===e[t]?null:e[t]}(l,"level"))throw new SAXException("Missing level attribute");this.printedLevelIds.push(function(e,t){return void 0===e[t]?null:e[t]}(l,"level"))}else if("level"===n){var a=this.createLevel(n,l);this.setLevelAttributes(a,n,l),this.levels[function(e,t){return void 0===e.id?null:e.id}(l)]=a,this.home.addLevel(a)}else if("camera"===n||"observerCamera"===n){var s=this.createCamera(n,l);this.setCameraAttributes(s,n,l);var h=function(e,t){return void 0===e[t]?null:e[t]}(l,"attribute");if("cameraPath"===h){var u=this.home.getEnvironment().getVideoCameraPath().slice(0);u.push(s),this.home.getEnvironment().setVideoCameraPath(u)}else if("topCamera"===h){var d=this.home.getTopCamera();d.setCamera(s),d.setTime(s.getTime()),d.setLens(s.getLens())}else if("observerCamera"===h){var c=this.home.getObserverCamera();c.setCamera(s),c.setTime(s.getTime()),c.setLens(s.getLens()),c.setFixedSize(s.isFixedSize())}else if("storedCamera"===h){var p=this.home.getStoredCameras().slice(0);p.push(s),this.home.setStoredCameras(p)}}else if("pieceOfFurniture"===n||"doorOrWindow"===n||"light"===n||"shelfUnit"===n||"furnitureGroup"===n){var g="furnitureGroup"===n?this.createFurnitureGroup(n,l,this.groupsFurniture.pop()):this.createPieceOfFurniture(n,l);if(this.setPieceOfFurnitureAttributes(g,n,l),null!=this.homeElementName&&this.homeElementName===r){this.home.addPieceOfFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture(g);var m=function(e,t){return void 0===e[t]?null:e[t]}(l,"level");null!=m&&g.setLevel(function(e,t){return void 0===e[t]?null:e[t]}(this.levels,m))}else"furnitureGroup"===r&&function(e){return 0==e.length?null:e[e.length-1]}(this.groupsFurniture).push(g)}else if("wall"===n){var f=this.createWall(n,l);this.joinedWalls[function(e,t){return void 0===e.id?null:e.id}(l)]=new t.JoinedWall(f,function(e,t){return void 0===e[t]?null:e[t]}(l,"wallAtStart"),function(e,t){return void 0===e[t]?null:e[t]}(l,"wallAtEnd")),this.setWallAttributes(f,n,l),this.home.addWall(f);m=function(e,t){return void 0===e[t]?null:e[t]}(l,"level");null!=m&&f.setLevel(function(e,t){return void 0===e[t]?null:e[t]}(this.levels,m))}else if("baseboard"===n){var v=this.createBaseboard(n,l);"leftSideBaseboard"===function(e,t){return void 0===e[t]?null:e[t]}(l,"attribute")?this.leftSideBaseboard=v:this.rightSideBaseboard=v}else if("room"===n){var _=this.createRoom(n,l,this.points.slice(0));this.setRoomAttributes(_,n,l),this.home.addRoom$com_eteks_sweethome3d_model_Room(_);m=function(e,t){return void 0===e[t]?null:e[t]}(l,"level");null!=m&&_.setLevel(function(e,t){return void 0===e[t]?null:e[t]}(this.levels,m))}else if("polyline"===n){var S=this.createPolyline(n,l,this.points.slice(0));this.setPolylineAttributes(S,n,l),this.home.addPolyline$com_eteks_sweethome3d_model_Polyline(S);m=function(e,t){return void 0===e[t]?null:e[t]}(l,"level");null!=m&&S.setLevel(function(e,t){return void 0===e[t]?null:e[t]}(this.levels,m))}else if("dimensionLine"===n){var y=this.createDimensionLine(n,l);this.setDimensionLineAttributes(y,n,l),this.home.addDimensionLine(y);m=function(e,t){return void 0===e[t]?null:e[t]}(l,"level");null!=m&&y.setLevel(function(e,t){return void 0===e[t]?null:e[t]}(this.levels,m))}else if("label"===n){var E=this.createLabel(n,l,this.labelText);this.setLabelAttributes(E,n,l),this.home.addLabel(E);m=function(e,t){return void 0===e[t]?null:e[t]}(l,"level");null!=m&&E.setLevel(function(e,t){return void 0===e[t]?null:e[t]}(this.levels,m))}else if("text"===n)this.labelText=this.getCharacters();else if("textStyle"===n){h=function(e,t){return void 0===e[t]?null:e[t]}(l,"attribute");(function(e){return 0==e.length?null:e[e.length-1]}(this.textStyles))[null!=h?h:t.UNIQUE_ATTRIBUTE]=this.createTextStyle(n,l)}else if("texture"===n)if("material"===r)this.materialTexture=this.createTexture(n,l);else{h=function(e,t){return void 0===e[t]?null:e[t]}(l,"attribute");this.textures[null!=h?h:t.UNIQUE_ATTRIBUTE]=this.createTexture(n,l)}else if("material"===n)this.materials.push(this.createMaterial(n,l));else if("transformation"===n){var C=function(e,t){return void 0===e[t]?null:e[t]}(l,"matrix");if(null==C)throw new SAXException("Missing attribute matrix");var P=C.split(/ /);if(P.length<12)throw new SAXException("Missing values for attribute matrix");try{var w=[[parseFloat(P[0]),parseFloat(P[1]),parseFloat(P[2]),parseFloat(P[3])],[parseFloat(P[4]),parseFloat(P[5]),parseFloat(P[6]),parseFloat(P[7])],[parseFloat(P[8]),parseFloat(P[9]),parseFloat(P[10]),parseFloat(P[11])]],L=new Transformation(function(e,t){return void 0===e[t]?null:e[t]}(l,"name"),w);this.transformations.push(this.resolveObject(L,n,l))}catch(e){throw new SAXException("Invalid value for attribute matrix",e)}}else if("point"===n)this.points.push([this.parseFloat(l,"x"),this.parseFloat(l,"y")]);else if("sash"===n){var T=new Sash(this.parseFloat(l,"xAxis"),this.parseFloat(l,"yAxis"),this.parseFloat(l,"width"),this.parseFloat(l,"startAngle"),this.parseFloat(l,"endAngle"));this.sashes.push(this.resolveObject(T,n,l))}else if("lightSource"===n){var A=new LightSource(this.parseFloat(l,"x"),this.parseFloat(l,"y"),this.parseFloat(l,"z"),this.parseOptionalColor(l,"color"),this.parseOptionalFloat(l,"diameter"));this.lightSources.push(this.resolveObject(A,n,l))}else if("lightSourceMaterial"===n)this.lightSourceMaterialNames.push(function(e,t){return void 0===e[t]?null:e[t]}(l,"name"));else if("shelf"===n)null!=function(e,t){return void 0===e[t]?null:e[t]}(l,"xLower")?this.shelfBoxes.push(new BoxBounds(this.parseFloat(l,"xLower"),this.parseFloat(l,"yLower"),this.parseFloat(l,"zLower"),this.parseFloat(l,"xUpper"),this.parseFloat(l,"yUpper"),this.parseFloat(l,"zUpper"))):this.shelfElevations.push(this.parseFloat(l,"elevation"));else if("backgroundImage"===n){var I=new BackgroundImage(this.parseContent(n,l,"image"),this.parseFloat(l,"scaleDistance"),this.parseFloat(l,"scaleDistanceXStart"),this.parseFloat(l,"scaleDistanceYStart"),this.parseFloat(l,"scaleDistanceXEnd"),this.parseFloat(l,"scaleDistanceYEnd"),null!=function(e,t){return void 0===e[t]?null:e[t]}(l,"xOrigin")?this.parseFloat(l,"xOrigin"):0,null!=function(e,t){return void 0===e[t]?null:e[t]}(l,"yOrigin")?this.parseFloat(l,"yOrigin"):0,!("false"===function(e,t){return void 0===e[t]?null:e[t]}(l,"visible")));I=this.resolveObject(I,n,l),null!=this.homeElementName&&this.homeElementName===r?this.homeBackgroundImage=I:this.backgroundImage=I}else"property"===n&&null!=this.homeElementName&&(ObjectProperty.Type[ObjectProperty.Type.CONTENT]===function(e,t){return void 0===e[t]?null:e[t]}(l,"type")?(function(e){return 0==e.length?null:e[e.length-1]}(this.properties))[function(e,t){return void 0===e[t]?null:e[t]}(l,"name")]=this.parseContent(n,l,"value"):(function(e){return 0==e.length?null:e[e.length-1]}(this.properties))[function(e,t){return void 0===e[t]?null:e[t]}(l,"name")]=function(e,t){return void 0===e[t]?null:e[t]}(l,"value"));"property"!==n&&"furnitureVisibleProperty"!==n&&"textStyle"!==n&&(this.properties.pop(),this.textStyles.pop())},t.prototype.getCharacters=function(){return this.buffer.str.replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")},t.prototype.endDocument=function(){for(var e=[],t=0;t<this.printedLevelIds.length;t++)for(var i=this.printedLevelIds[t],n=this.home.getLevels(),o=0;o<n.length;o++){var r=n[o];if(i===r.getId()){e.push(r);break}}var l=this.home.getPrint();null!=l&&0!=e.length&&l.constructor===HomePrint&&this.home.setPrint(new HomePrint(l.getPaperOrientation(),l.getPaperWidth(),l.getPaperHeight(),l.getPaperTopMargin(),l.getPaperLeftMargin(),l.getPaperBottomMargin(),l.getPaperRightMargin(),l.isFurniturePrinted(),l.isPlanPrinted(),e,l.isView3DPrinted(),l.getPlanScale(),l.getHeaderFormat(),l.getFooterFormat()));var a;for(n=(a=this.joinedWalls,Object.keys(a).map((function(e){return a[e]}))),t=0;t<n.length;t++){var s=n[t],h=s.getWall();if(null!=s.getWallAtStartId()&&s.getWallAtStartId()!==h.getId()){var u=function(e,t){return void 0===e[t]?null:e[t]}(this.joinedWalls,s.getWallAtStartId());null!=u&&h.setWallAtStart(u.getWall())}if(null!=s.getWallAtEndId()&&s.getWallAtEndId()!==h.getId()){var d=function(e,t){return void 0===e[t]?null:e[t]}(this.joinedWalls,s.getWallAtEndId());null!=d&&h.setWallAtEnd(d.getWall())}}},t.prototype.resolveObject=function(e,t,i){return e},t.prototype.createHome=function(e,t){var i,n,o;i=null!=(void 0===(n=t)[o="wallHeight"]?null:n[o])?new Home(this.parseFloat(t,"wallHeight")):new Home;var r=function(e,t){return void 0===e[t]?null:e[t]}(t,"version");if(null!=r)try{i.setVersion(parseInt(r))}catch(e){throw new SAXException("Invalid value for integer attribute version",e)}return this.resolveObject(i,e,t)},t.prototype.setHomeAttributes=function(e,t,i){for(var n,o,r,l=function(e){var t=[];for(var i in e)t.push({k:i,v:e[i],getKey:function(){return this.k},getValue:function(){return this.v}});return t}(0==(n=this.properties).length?null:n[n.length-1]),a=0;a<l.length;a++){var s=l[a];"string"==typeof s.getValue()&&e.setProperty(s.getKey(),s.getValue())}this.furnitureVisiblePropertyNames.length>0&&this.home.setFurnitureVisiblePropertyNames(this.furnitureVisiblePropertyNames),this.home.setBackgroundImage(this.homeBackgroundImage),e.setName(void 0===(o=i)[r="name"]?null:o[r]);var h=function(e,t){return void 0===e[t]?null:e[t]}(i,"selectedLevel");null!=h&&this.home.setSelectedLevel(function(e,t){return void 0===e[t]?null:e[t]}(this.levels,h)),"observerCamera"===function(e,t){return void 0===e[t]?null:e[t]}(i,"camera")&&this.home.setCamera(this.home.getObserverCamera()),e.setBasePlanLocked("true"===function(e,t){return void 0===e[t]?null:e[t]}(i,"basePlanLocked"));var u=function(e,t){return void 0===e[t]?null:e[t]}(i,"furnitureSortedProperty");if(null!=u)try{e.setFurnitureSortedPropertyName(u)}catch(e){}e.setFurnitureDescendingSorted("true"===function(e,t){return void 0===e[t]?null:e[t]}(i,"furnitureDescendingSorted")),i.structure&&(e.structure=this.parseContent(this.homeElementName,i,"structure"))},t.prototype.setEnvironmentAttributes=function(e,t,i){this.setProperties(e,t,i);var n,o,r=this.parseOptionalColor(i,"groundColor");null!=r&&e.setGroundColor(r),e.setGroundTexture(void 0===(n=this.textures)[o="groundTexture"]?null:n[o]),e.setBackgroundImageVisibleOnGround3D("true"===function(e,t){return void 0===e[t]?null:e[t]}(i,"backgroundImageVisibleOnGround3D"));var l=this.parseOptionalColor(i,"skyColor");null!=l&&e.setSkyColor(l),e.setSkyTexture(function(e,t){return void 0===e[t]?null:e[t]}(this.textures,"skyTexture"));var a=this.parseOptionalColor(i,"lightColor");null!=a&&e.setLightColor(a);var s=this.parseOptionalFloat(i,"wallsAlpha");null!=s&&e.setWallsAlpha(s),e.setAllLevelsVisible("true"===function(e,t){return void 0===e[t]?null:e[t]}(i,"allLevelsVisible")),e.setObserverCameraElevationAdjusted(!("false"===function(e,t){return void 0===e[t]?null:e[t]}(i,"observerCameraElevationAdjusted")));var h=this.parseOptionalColor(i,"ceillingLightColor");null!=h&&e.setCeillingLightColor(h);var u=function(e,t){return void 0===e[t]?null:e[t]}(i,"drawingMode");if(null!=u)try{e.setDrawingMode(HomeEnvironment.DrawingMode[u])}catch(e){}var d=this.parseOptionalFloat(i,"subpartSizeUnderLight");null!=d&&e.setSubpartSizeUnderLight(d);var c=this.parseOptionalInteger(i,"photoWidth");null!=c&&e.setPhotoWidth(c);var p=this.parseOptionalInteger(i,"photoHeight");null!=p&&e.setPhotoHeight(p);var g=function(e,t){return void 0===e[t]?null:e[t]}(i,"photoAspectRatio");if(null!=g)try{e.setPhotoAspectRatio(AspectRatio[g])}catch(e){}var m=this.parseOptionalInteger(i,"photoQuality");null!=m&&e.setPhotoQuality(m);var f=this.parseOptionalInteger(i,"videoWidth");null!=f&&e.setVideoWidth(f);var v=function(e,t){return void 0===e[t]?null:e[t]}(i,"videoAspectRatio");if(null!=v)try{e.setVideoAspectRatio(AspectRatio[v])}catch(e){}var _=this.parseOptionalInteger(i,"videoQuality");null!=_&&e.setVideoQuality(_);var S=this.parseOptionalFloat(i,"videoSpeed");null!=S&&e.setVideoSpeed(S);var y=this.parseOptionalInteger(i,"videoFrameRate");null!=y&&e.setVideoFrameRate(y)},t.prototype.createPrint=function(e){var t,i,n=HomePrint.PaperOrientation.PORTRAIT;try{if(null==(void 0===(t=e)[i="paperOrientation"]?null:t[i]))throw new SAXException("Missing paperOrientation attribute");n=HomePrint.PaperOrientation[function(e,t){return void 0===e[t]?null:e[t]}(e,"paperOrientation")]}catch(e){}var o=new HomePrint(n,this.parseFloat(e,"paperWidth"),this.parseFloat(e,"paperHeight"),this.parseFloat(e,"paperTopMargin"),this.parseFloat(e,"paperLeftMargin"),this.parseFloat(e,"paperBottomMargin"),this.parseFloat(e,"paperRightMargin"),!("false"===function(e,t){return void 0===e[t]?null:e[t]}(e,"furniturePrinted")),!("false"===function(e,t){return void 0===e[t]?null:e[t]}(e,"planPrinted")),!("false"===function(e,t){return void 0===e[t]?null:e[t]}(e,"view3DPrinted")),this.parseOptionalFloat(e,"planScale"),function(e,t){return void 0===e[t]?null:e[t]}(e,"headerFormat"),function(e,t){return void 0===e[t]?null:e[t]}(e,"footerFormat"));return this.resolveObject(o,"print",e)},t.prototype.setCompassAttributes=function(e,t,i){this.setProperties(e,t,i),e.setX(this.parseOptionalFloat(i,"x")),e.setY(this.parseOptionalFloat(i,"y")),e.setDiameter(this.parseOptionalFloat(i,"diameter"));var n=this.parseOptionalFloat(i,"northDirection");null!=n&&e.setNorthDirection(n);var o=this.parseOptionalFloat(i,"longitude");null!=o&&e.setLongitude(o);var r=this.parseOptionalFloat(i,"latitude");null!=r&&e.setLatitude(r);var l,a,s=void 0===(l=i)[a="timeZone"]?null:l[a];null!=s&&e.setTimeZone(s),e.setVisible(!("false"===function(e,t){return void 0===e[t]?null:e[t]}(i,"visible")))},t.prototype.createCamera=function(e,t){var i,n,o=void 0===(i=t).id?null:i.id,r=this.parseFloat(t,"x"),l=this.parseFloat(t,"y"),a=this.parseFloat(t,"z"),s=this.parseFloat(t,"yaw"),h=this.parseFloat(t,"pitch"),u=this.parseFloat(t,"fieldOfView");return n="observerCamera"===e?null!=o?new ObserverCamera(o,r,l,a,s,h,u):new ObserverCamera(r,l,a,s,h,u):null!=o?new Camera(o,r,l,a,s,h,u):new Camera(r,l,a,s,h,u),this.resolveObject(n,e,t)},t.prototype.setCameraAttributes=function(e,t,i){var n,o;this.setProperties(e,t,i),null!=e&&e instanceof ObserverCamera&&e.setFixedSize("true"===(void 0===(n=i)[o="fixedSize"]?null:n[o]));var r=function(e,t){return void 0===e[t]?null:e[t]}(i,"lens");if(null!=r)try{e.setLens(Camera.Lens[r])}catch(e){}var l=function(e,t){return void 0===e[t]?null:e[t]}(i,"time");if(null!=l)try{e.setTime(parseInt(l))}catch(e){throw new SAXException("Invalid value for long attribute time",e)}e.setName(function(e,t){return void 0===e[t]?null:e[t]}(i,"name")),e.setRenderer(function(e,t){return void 0===e[t]?null:e[t]}(i,"renderer"))},t.prototype.createLevel=function(e,t){var i,n=void 0===(i=t).id?null:i.id,o=function(e,t){return void 0===e[t]?null:e[t]}(t,"name"),r=this.parseFloat(t,"elevation"),l=this.parseFloat(t,"floorThickness"),a=this.parseFloat(t,"height"),s=null!=n?new Level(n,o,r,l,a):new Level(o,r,l,a);return this.resolveObject(s,e,t)},t.prototype.setLevelAttributes=function(e,t,i){this.setProperties(e,t,i),e.setBackgroundImage(this.backgroundImage);var n,o,r=this.parseOptionalInteger(i,"elevationIndex");null!=r&&e.setElevationIndex(r),e.setVisible(!("false"===(n=i,o="visible",void 0===n[o]?null:n[o]))),e.setViewable(!("false"===function(e,t){return void 0===e[t]?null:e[t]}(i,"viewable")))},t.prototype.createPieceOfFurniture=function(e,t){var i,n=void 0===(i=t).id?null:i.id,o=function(e,t){return void 0===e[t]?null:e[t]}(t,"catalogId"),r=null!=function(e,t){return void 0===e[t]?null:e[t]}(t,"tags")?function(e,t){return void 0===e[t]?null:e[t]}(t,"tags").split(/ /):null,l=null!=function(e,t){return void 0===e[t]?null:e[t]}(t,"elevation")?this.parseFloat(t,"elevation"):0,a=null!=function(e,t){return void 0===e[t]?null:e[t]}(t,"dropOnTopElevation")?this.parseFloat(t,"dropOnTopElevation"):1,s=null;if(null!=function(e,t){return void 0===e[t]?null:e[t]}(t,"modelRotation")){var h=function(e,t){return void 0===e[t]?null:e[t]}(t,"modelRotation").split(/ /);if(h.length<9)throw new SAXException("Missing values for attribute modelRotation");try{s=[[parseFloat(h[0]),parseFloat(h[1]),parseFloat(h[2])],[parseFloat(h[3]),parseFloat(h[4]),parseFloat(h[5])],[parseFloat(h[6]),parseFloat(h[7]),parseFloat(h[8])]]}catch(e){throw new SAXException("Invalid value for attribute modelRotation",e)}}var u=function(e,t){return void 0===e[t]?null:e[t]}(t,"name"),d=function(e,t){return void 0===e[t]?null:e[t]}(t,"description"),c=function(e,t){return void 0===e[t]?null:e[t]}(t,"information"),p=function(e,t){return void 0===e[t]?null:e[t]}(t,"license"),g=this.parseOptionalLong(t,"creationDate"),m=this.parseOptionalFloat(t,"grade"),f=this.parseContent(e,t,"icon"),v=this.parseContent(e,t,"planIcon"),_=this.parseContent(e,t,"model"),S=this.parseFloat(t,"width"),y=this.parseFloat(t,"depth"),E=this.parseFloat(t,"height"),C=!("false"===function(e,t){return void 0===e[t]?null:e[t]}(t,"movable")),P=this.parseOptionalInteger(t,"modelFlags");null==P&&(P="true"===function(e,t){return void 0===e[t]?null:e[t]}(t,"backFaceShown")?PieceOfFurniture.SHOW_BACK_FACE:0);var w,L=this.parseOptionalLong(t,"modelSize"),T=function(e,t){return void 0===e[t]?null:e[t]}(t,"creator"),A=!("false"===function(e,t){return void 0===e[t]?null:e[t]}(t,"resizable")),I=!("false"===function(e,t){return void 0===e[t]?null:e[t]}(t,"deformable")),b=!("false"===function(e,t){return void 0===e[t]?null:e[t]}(t,"texturable")),O=this.parseOptionalDecimal(t,"price"),M=this.parseOptionalDecimal(t,"valueAddedTaxPercentage"),D=function(e,t){return void 0===e[t]?null:e[t]}(t,"currency");if("doorOrWindow"===e||"true"===function(e,t){return void 0===e[t]?null:e[t]}(t,"doorOrWindow")){var R=null!=function(e,t){return void 0===e[t]?null:e[t]}(t,"wallThickness")?this.parseFloat(t,"wallThickness"):1,F=null!=function(e,t){return void 0===e[t]?null:e[t]}(t,"wallDistance")?this.parseFloat(t,"wallDistance"):0,x=function(e,t){return void 0===e[t]?null:e[t]}(t,"cutOutShape");null==x&&"doorOrWindow"!==e&&(x=PieceOfFurniture.DEFAULT_CUT_OUT_SHAPE);var N="true"===function(e,t){return void 0===e[t]?null:e[t]}(t,"wallCutOutOnBothSides"),k=!("false"===function(e,t){return void 0===e[t]?null:e[t]}(t,"widthDepthDeformable")),H=new CatalogDoorOrWindow(o,u,d,c,p,r,g,m,f,v,_,S,y,E,l,a,C,x,R,F,N,k,this.sashes.slice(0),s,P,L,T,A,I,b,O,M,D,null,null);w=null!=n?new HomeDoorOrWindow(n,H):new HomeDoorOrWindow(H)}else{var V=function(e,t){return void 0===e[t]?null:e[t]}(t,"staircaseCutOutShape"),U=!("false"===function(e,t){return void 0===e[t]?null:e[t]}(t,"horizontallyRotatable"));if("light"===e){var W=new CatalogLight(o,u,d,c,p,r,g,m,f,v,_,S,y,E,l,a,C,this.lightSources.slice(0),this.lightSourceMaterialNames.slice(0),V,s,P,L,T,A,I,b,U,O,M,D,null,null);w=null!=n?new HomeLight(n,W):new HomeLight(W)}else if("shelfUnit"===e){for(var B=function(e){for(var t=[];e-- >0;)t.push(0);return t}(this.shelfElevations.length),G=0;G<B.length;G++)B[G]=this.shelfElevations[G];var Y=new CatalogShelfUnit(o,u,d,c,p,r,g,m,f,v,_,S,y,E,l,a,B,this.shelfBoxes.slice(0),C,V,s,P,L,T,A,I,b,U,O,M,D,null,null);w=null!=n?new HomeShelfUnit(n,Y):new HomeShelfUnit(Y)}else{var $=new CatalogPieceOfFurniture(o,u,d,c,p,r,g,m,f,v,_,S,y,E,l,a,C,V,s,P,L,T,A,I,b,U,O,M,D,null,null);w=null!=n?new HomePieceOfFurniture(n,$):new HomePieceOfFurniture($)}}return this.resolveObject(w,e,t)},t.prototype.createFurnitureGroup=function(e,t,i){var n,o=void 0===(n=t).id?null:n.id,r=null!=function(e,t){return void 0===e[t]?null:e[t]}(t,"angle")?this.parseFloat(t,"angle"):0,l="true"===function(e,t){return void 0===e[t]?null:e[t]}(t,"modelMirrored"),a=function(e,t){return void 0===e[t]?null:e[t]}(t,"name"),s=null!=o?new HomeFurnitureGroup(o,i,r,l,a):new HomeFurnitureGroup(i,r,l,a);return this.resolveObject(s,e,t)},t.prototype.setPieceOfFurnitureAttributes=function(e,i,n){var o;this.setProperties(e,i,n),e.setNameStyle(function(e,t){return void 0===e[t]?null:e[t]}(0==(o=this.textStyles).length?null:o[o.length-1],"nameStyle")),e.setNameVisible("true"===function(e,t){return void 0===e[t]?null:e[t]}(n,"nameVisible"));var r=this.parseOptionalFloat(n,"nameAngle");null!=r&&e.setNameAngle(r);var l=this.parseOptionalFloat(n,"nameXOffset");null!=l&&e.setNameXOffset(l);var a=this.parseOptionalFloat(n,"nameYOffset");if(null!=a&&e.setNameYOffset(a),e.setVisible(!("false"===function(e,t){return void 0===e[t]?null:e[t]}(n,"visible"))),null!=e&&e instanceof HomeFurnitureGroup)e.setCatalogId(function(e,t){return void 0===e[t]?null:e[t]}(n,"catalogId")),e.setDescription(function(e,t){return void 0===e[t]?null:e[t]}(n,"description")),e.setInformation(function(e,t){return void 0===e[t]?null:e[t]}(n,"information")),e.setLicense(function(e,t){return void 0===e[t]?null:e[t]}(n,"license")),e.setCreator(function(e,t){return void 0===e[t]?null:e[t]}(n,"creator"));else{var s=this.parseOptionalFloat(n,"x");null!=s&&e.setX(s);var h=this.parseOptionalFloat(n,"y");null!=h&&e.setY(h);var u=this.parseOptionalFloat(n,"angle");if(null!=u&&e.setAngle(u),e.isHorizontallyRotatable()){var d=this.parseOptionalFloat(n,"pitch");null!=d&&e.setPitch(d);var c=this.parseOptionalFloat(n,"roll");null!=c&&e.setRoll(c)}var p=this.parseOptionalFloat(n,"widthInPlan");null!=p&&e.setWidthInPlan(p);var g=this.parseOptionalFloat(n,"depthInPlan");null!=g&&e.setDepthInPlan(g);var m=this.parseOptionalFloat(n,"heightInPlan");if(null!=m&&e.setHeightInPlan(m),(this.home.getVersion()<5500||"false"===function(e,t){return void 0===e[t]?null:e[t]}(n,"modelCenteredAtOrigin"))&&e.setModelCenteredAtOrigin(null==function(e,t){return void 0===e[t]?null:e[t]}(n,"modelRotation")),e.isResizable()&&e.setModelMirrored("true"===function(e,t){return void 0===e[t]?null:e[t]}(n,"modelMirrored")),e.isTexturable()){this.materials.length>0&&e.setModelMaterials(this.materials.slice(0));var f=this.parseOptionalColor(n,"color");null!=f&&e.setColor(f);var v=function(e,t){return void 0===e[t]?null:e[t]}(this.textures,t.UNIQUE_ATTRIBUTE);null!=v&&e.setTexture(v);var _=this.parseOptionalFloat(n,"shininess");null!=_&&e.setShininess(_)}if(e.isDeformable()&&this.transformations.length>0&&e.setModelTransformations(this.transformations.slice(0)),null!=e&&e instanceof HomeLight&&null!=function(e,t){return void 0===e[t]?null:e[t]}(n,"power"))e.setPower(this.parseFloat(n,"power"));else if(null!=e&&e instanceof HomeDoorOrWindow&&"doorOrWindow"===i){var S=e;S.setBoundToWall(!("false"===function(e,t){return void 0===e[t]?null:e[t]}(n,"boundToWall")));var y=this.parseOptionalFloat(n,"wallWidth");null!=y&&S.setWallWidth(y);var E=this.parseOptionalFloat(n,"wallLeft");null!=E&&S.setWallLeft(E);var C=this.parseOptionalFloat(n,"wallHeight");null!=C&&S.setWallHeight(C);var P=this.parseOptionalFloat(n,"wallTop");null!=P&&S.setWallTop(P)}}},t.prototype.createWall=function(e,t){var i,n=void 0===(i=t).id?null:i.id,o=this.parseFloat(t,"xStart"),r=this.parseFloat(t,"yStart"),l=this.parseFloat(t,"xEnd"),a=this.parseFloat(t,"yEnd"),s=this.parseFloat(t,"thickness"),h=null!=n?new Wall(n,o,r,l,a,s,0):new Wall(o,r,l,a,s,0);return this.resolveObject(h,e,t)},t.prototype.setWallAttributes=function(e,t,i){var n,o;this.setProperties(e,t,i),e.setLeftSideBaseboard(this.leftSideBaseboard),e.setRightSideBaseboard(this.rightSideBaseboard),e.setHeight(this.parseOptionalFloat(i,"height")),e.setHeightAtEnd(this.parseOptionalFloat(i,"heightAtEnd")),e.setArcExtent(this.parseOptionalFloat(i,"arcExtent")),e.setTopColor(this.parseOptionalColor(i,"topColor")),e.setLeftSideColor(this.parseOptionalColor(i,"leftSideColor")),e.setLeftSideTexture(void 0===(n=this.textures)[o="leftSideTexture"]?null:n[o]);var r=this.parseOptionalFloat(i,"leftSideShininess");null!=r&&e.setLeftSideShininess(r),e.setRightSideColor(this.parseOptionalColor(i,"rightSideColor")),e.setRightSideTexture(function(e,t){return void 0===e[t]?null:e[t]}(this.textures,"rightSideTexture"));var l=this.parseOptionalFloat(i,"rightSideShininess");null!=l&&e.setRightSideShininess(l);var a=function(e,t){return void 0===e[t]?null:e[t]}(i,"pattern");if(null!=a)try{e.setPattern(this.preferences.getPatternsCatalog().getPattern$java_lang_String(a))}catch(e){}},t.prototype.createRoom=function(e,t,i){var n,o=void 0===(n=t).id?null:n.id,r=null!=o?new Room(o,i):new Room(i);return this.resolveObject(r,e,t)},t.prototype.setRoomAttributes=function(e,t,i){var n;this.setProperties(e,t,i),e.setNameStyle(function(e,t){return void 0===e[t]?null:e[t]}(0==(n=this.textStyles).length?null:n[n.length-1],"nameStyle")),e.setAreaStyle(function(e,t){return void 0===e[t]?null:e[t]}(function(e){return 0==e.length?null:e[e.length-1]}(this.textStyles),"areaStyle")),e.setName(function(e,t){return void 0===e[t]?null:e[t]}(i,"name"));var o=this.parseOptionalFloat(i,"nameAngle");null!=o&&e.setNameAngle(o);var r=this.parseOptionalFloat(i,"nameXOffset");null!=r&&e.setNameXOffset(r);var l=this.parseOptionalFloat(i,"nameYOffset");null!=l&&e.setNameYOffset(l),e.setAreaVisible("true"===function(e,t){return void 0===e[t]?null:e[t]}(i,"areaVisible"));var a=this.parseOptionalFloat(i,"areaAngle");null!=a&&e.setAreaAngle(a);var s=this.parseOptionalFloat(i,"areaXOffset");null!=s&&e.setAreaXOffset(s);var h=this.parseOptionalFloat(i,"areaYOffset");null!=h&&e.setAreaYOffset(h),e.setFloorVisible(!("false"===function(e,t){return void 0===e[t]?null:e[t]}(i,"floorVisible"))),e.setFloorColor(this.parseOptionalColor(i,"floorColor")),e.setFloorTexture(function(e,t){return void 0===e[t]?null:e[t]}(this.textures,"floorTexture"));var u=this.parseOptionalFloat(i,"floorShininess");null!=u&&e.setFloorShininess(u),e.setCeilingVisible(!("false"===function(e,t){return void 0===e[t]?null:e[t]}(i,"ceilingVisible"))),e.setCeilingColor(this.parseOptionalColor(i,"ceilingColor")),e.setCeilingTexture(function(e,t){return void 0===e[t]?null:e[t]}(this.textures,"ceilingTexture"));var d=this.parseOptionalFloat(i,"ceilingShininess");null!=d&&e.setCeilingShininess(d),e.setCeilingFlat("true"===function(e,t){return void 0===e[t]?null:e[t]}(i,"ceilingFlat"))},t.prototype.createPolyline=function(e,t,i){var n,o=void 0===(n=t).id?null:n.id,r=null!=o?new Polyline(o,i):new Polyline(i);return this.resolveObject(r,e,t)},t.prototype.setPolylineAttributes=function(e,t,i){this.setProperties(e,t,i);var n=this.parseOptionalFloat(i,"thickness");null!=n&&e.setThickness(n);var o,r,l=void 0===(o=i)[r="capStyle"]?null:o[r];if(null!=l)try{e.setCapStyle(Polyline.CapStyle[l])}catch(e){}var a=function(e,t){return void 0===e[t]?null:e[t]}(i,"joinStyle");if(null!=a)try{e.setJoinStyle(Polyline.JoinStyle[a])}catch(e){}var s=function(e,t){return void 0===e[t]?null:e[t]}(i,"dashStyle");if(null!=s)try{e.setDashStyle(Polyline.DashStyle[s])}catch(e){}var h=function(e,t){return void 0===e[t]?null:e[t]}(i,"dashPattern");if(null!=h)try{for(var u=h.split(/ /),d=function(e){for(var t=[];e-- >0;)t.push(0);return t}(u.length),c=0;c<u.length;c++)d[c]=parseFloat(u[c]);e.setDashPattern(d)}catch(e){throw new SAXException("Invalid value for dash pattern",e)}var p=this.parseOptionalFloat(i,"dashOffset");null!=p&&e.setDashOffset(p);var g=function(e,t){return void 0===e[t]?null:e[t]}(i,"startArrowStyle");if(null!=g)try{e.setStartArrowStyle(Polyline.ArrowStyle[g])}catch(e){}var m=function(e,t){return void 0===e[t]?null:e[t]}(i,"endArrowStyle");if(null!=m)try{e.setEndArrowStyle(Polyline.ArrowStyle[m])}catch(e){}var f=this.parseOptionalFloat(i,"elevation");null!=f&&(e.setVisibleIn3D(!0),e.setElevation(f));var v=this.parseOptionalColor(i,"color");null!=v&&e.setColor(v),e.setClosedPath("true"===function(e,t){return void 0===e[t]?null:e[t]}(i,"closedPath"))},t.prototype.createDimensionLine=function(e,t){var i,n=void 0===(i=t).id?null:i.id,o=this.parseFloat(t,"xStart"),r=this.parseFloat(t,"yStart"),l=this.parseOptionalFloat(t,"elevationStart"),a=null!=l?l:0,s=this.parseFloat(t,"xEnd"),h=this.parseFloat(t,"yEnd"),u=null!=(l=this.parseOptionalFloat(t,"elevationEnd"))?l:0,d=this.parseFloat(t,"offset"),c=null!=n?new DimensionLine(n,o,r,a,s,h,u,d):new DimensionLine(o,r,a,s,h,u,d);null!=(l=this.parseOptionalFloat(t,"endMarkSize"))&&c.setEndMarkSize(l),null!=(l=this.parseOptionalFloat(t,"pitch"))&&c.setPitch(l);var p=this.parseOptionalColor(t,"color");return null!=p&&c.setColor(p),c.setVisibleIn3D("true"===function(e,t){return void 0===e[t]?null:e[t]}(t,"visibleIn3D")),this.resolveObject(c,e,t)},t.prototype.setDimensionLineAttributes=function(e,t,i){var n;this.setProperties(e,t,i),e.setLengthStyle(function(e,t){return void 0===e[t]?null:e[t]}(0==(n=this.textStyles).length?null:n[n.length-1],"lengthStyle"))},t.prototype.createLabel=function(e,t,i){var n,o=void 0===(n=t).id?null:n.id,r=this.parseFloat(t,"x"),l=this.parseFloat(t,"y"),a=null!=o?new Label(o,i,r,l):new Label(i,r,l);return this.resolveObject(a,e,t)},t.prototype.setLabelAttributes=function(e,i,n){var o;this.setProperties(e,i,n),e.setStyle(function(e,t){return void 0===e[t]?null:e[t]}(0==(o=this.textStyles).length?null:o[o.length-1],t.UNIQUE_ATTRIBUTE));var r=this.parseOptionalFloat(n,"angle");null!=r&&e.setAngle(r);var l=this.parseOptionalFloat(n,"elevation");null!=l&&e.setElevation(l);var a=this.parseOptionalFloat(n,"pitch");null!=a&&e.setPitch(a),e.setColor(this.parseOptionalColor(n,"color")),e.setOutlineColor(this.parseOptionalColor(n,"outlineColor"))},t.prototype.createBaseboard=function(e,i){var n,o,r=Baseboard.getInstance(this.parseFloat(i,"thickness"),this.parseFloat(i,"height"),this.parseOptionalColor(i,"color"),(n=this.textures,o=t.UNIQUE_ATTRIBUTE,void 0===n[o]?null:n[o]));return this.resolveObject(r,e,i)},t.prototype.createTextStyle=function(e,t){var i,n,o=TextStyle.Alignment.CENTER,r=void 0===(i=t)[n="alignment"]?null:i[n];if(null!=r)try{o=TextStyle.Alignment[r]}catch(e){}var l=new TextStyle(function(e,t){return void 0===e[t]?null:e[t]}(t,"fontName"),this.parseFloat(t,"fontSize"),"true"===function(e,t){return void 0===e[t]?null:e[t]}(t,"bold"),"true"===function(e,t){return void 0===e[t]?null:e[t]}(t,"italic"),o);return this.resolveObject(l,e,t)},t.prototype.createTexture=function(e,t){var i,n,o=void 0===(i=t)[n="catalogId"]?null:i[n],r=new HomeTexture(new CatalogTexture(o,function(e,t){return void 0===e[t]?null:e[t]}(t,"name"),this.parseContent(e,t,"image"),this.parseFloat(t,"width"),this.parseFloat(t,"height"),function(e,t){return void 0===e[t]?null:e[t]}(t,"creator")),null!=function(e,t){return void 0===e[t]?null:e[t]}(t,"xOffset")?this.parseFloat(t,"xOffset"):0,null!=function(e,t){return void 0===e[t]?null:e[t]}(t,"yOffset")?this.parseFloat(t,"yOffset"):0,null!=function(e,t){return void 0===e[t]?null:e[t]}(t,"angle")?this.parseFloat(t,"angle"):0,null!=function(e,t){return void 0===e[t]?null:e[t]}(t,"scale")?this.parseFloat(t,"scale"):1,"true"===function(e,t){return void 0===e[t]?null:e[t]}(t,"fittingArea"),!("false"===function(e,t){return void 0===e[t]?null:e[t]}(t,"leftToRightOriented")));return this.resolveObject(r,e,t)},t.prototype.createMaterial=function(e,t){var i,n,o=new HomeMaterial(void 0===(i=t)[n="name"]?null:i[n],function(e,t){return void 0===e.key?null:e.key}(t),this.parseOptionalColor(t,"color"),this.materialTexture,this.parseOptionalFloat(t,"shininess"));return this.resolveObject(o,e,t)},t.prototype.setProperties=function(e,t,i){for(var n,o=function(e){var t=[];for(var i in e)t.push({k:i,v:e[i],getKey:function(){return this.k},getValue:function(){return this.v}});return t}(0==(n=this.properties).length?null:n[n.length-1]),r=0;r<o.length;r++){var l=o[r];e.setProperty$java_lang_String$java_lang_Object(l.getKey(),l.getValue())}},t.prototype.parseOptionalColor=function(e,t){var i,n,o=void 0===(i=e)[n=t]?null:i[n];if(null==o)return null;try{return 0|parseInt(o,16)}catch(e){throw new SAXException("Invalid value for color attribute "+t,e)}},t.prototype.parseOptionalInteger=function(e,t){var i,n,o=void 0===(i=e)[n=t]?null:i[n];if(null==o)return null;try{return parseInt(o)}catch(e){throw new SAXException("Invalid value for integer attribute "+t,e)}},t.prototype.parseOptionalLong=function(e,t){var i,n,o=void 0===(i=e)[n=t]?null:i[n];if(null==o)return null;try{return parseInt(o)}catch(e){throw new SAXException("Invalid value for long attribute "+t,e)}},t.prototype.parseOptionalDecimal=function(e,t){var i,n,o=void 0===(i=e)[n=t]?null:i[n];if(null==o)return null;try{return new Big(o)}catch(e){throw new SAXException("Invalid value for decimal attribute "+t,e)}},t.prototype.parseOptionalFloat=function(e,t){var i,n,o=void 0===(i=e)[n=t]?null:i[n];if(null==o)return null;try{return parseFloat(o)}catch(e){throw new SAXException("Invalid value for float attribute "+t,e)}},t.prototype.parseFloat=function(e,t){var i,n,o=void 0===(i=e)[n=t]?null:i[n];if(null==o)throw new SAXException("Missing float attribute "+t);try{return parseFloat(o)}catch(e){throw new SAXException("Invalid value for float attribute "+t,e)}},t.prototype.parseContent=function(e,t,i){var n=t[i];return void 0===n?null:n.indexOf("://")>=0?URLContent.fromURL(n):new HomeURLContent("jar:"+this.homeUrl+"!/"+n)},t.prototype.setHome=function(e){var t;this.home=e,this.homeElementName=0==(t=this.elements).length?null:t[t.length-1]},t.prototype.getHome=function(){return this.home},t.UNIQUE_ATTRIBUTE="@&unique&@",t}(DefaultHandler);HomeXMLHandler.__class="com.eteks.sweethome3d.io.HomeXMLHandler",HomeXMLHandler.__interfaces=["org.xml.sax.ErrorHandler","org.xml.sax.DTDHandler","org.xml.sax.ContentHandler","org.xml.sax.EntityResolver"],function(e){var t=function(){function e(e,t,i){void 0===this.wall&&(this.wall=null),void 0===this.wallAtStartId&&(this.wallAtStartId=null),void 0===this.wallAtEndId&&(this.wallAtEndId=null),this.wall=e,this.wallAtStartId=t,this.wallAtEndId=i}return e.prototype.getWall=function(){return this.wall},e.prototype.getWallAtStartId=function(){return this.wallAtStartId},e.prototype.getWallAtEndId=function(){return this.wallAtEndId},e}();e.JoinedWall=t,t.__class="com.eteks.sweethome3d.io.HomeXMLHandler.JoinedWall"}(HomeXMLHandler||(HomeXMLHandler={}));var BoxBounds=function(){function e(e,t,i,n,o,r){void 0===this.xLower&&(this.xLower=0),void 0===this.yLower&&(this.yLower=0),void 0===this.zLower&&(this.zLower=0),void 0===this.xUpper&&(this.xUpper=0),void 0===this.yUpper&&(this.yUpper=0),void 0===this.zUpper&&(this.zUpper=0),this.xLower=e,this.yLower=t,this.zLower=i,this.xUpper=n,this.yUpper=o,this.zUpper=r}return e.prototype.getXLower=function(){return this.xLower},e.prototype.getYLower=function(){return this.yLower},e.prototype.getZLower=function(){return this.zLower},e.prototype.getXUpper=function(){return this.xUpper},e.prototype.getYUpper=function(){return this.yUpper},e.prototype.getZUpper=function(){return this.zUpper},e.prototype.equals=function(t){if(null!=t&&t instanceof e){var i=t;return i.xLower===this.xLower&&i.yLower===this.yLower&&i.zLower===this.zLower&&i.xUpper===this.xUpper&&i.yUpper===this.yUpper&&i.zUpper===this.zUpper}return!1},e.prototype.hashCode=function(){var e,t,i=(e=this.xLower,t=new ArrayBuffer(4),new Float32Array(t)[0]=e,new Uint32Array(t)[0]+function(e){var t=new ArrayBuffer(4);return new Float32Array(t)[0]=e,new Uint32Array(t)[0]}(this.yLower)+function(e){var t=new ArrayBuffer(4);return new Float32Array(t)[0]=e,new Uint32Array(t)[0]}(this.zLower));return i+=31*(function(e){var t=new ArrayBuffer(4);return new Float32Array(t)[0]=e,new Uint32Array(t)[0]}(this.xUpper)+function(e){var t=new ArrayBuffer(4);return new Float32Array(t)[0]=e,new Uint32Array(t)[0]}(this.yUpper)+function(e){var t=new ArrayBuffer(4);return new Float32Array(t)[0]=e,new Uint32Array(t)[0]}(this.zUpper)),i},e}();BoxBounds.__class="com.eteks.sweethome3d.model.BoxBounds";var PatternsCatalog=function(){function e(e){void 0===this.patterns&&(this.patterns=null),this.patterns=e.slice(0)}return e.prototype.getPatterns=function(){return this.patterns.slice(0)},e.prototype.getPatternsCount=function(){return this.patterns.length},e.prototype.getPattern$int=function(e){return this.patterns[e]},e.prototype.getPattern$java_lang_String=function(e){for(var t=0;t<this.patterns.length;t++){var i=this.patterns[t];if(e===i.getName())return i}throw new IllegalArgumentException("No pattern with name "+e)},e.prototype.getPattern=function(e){if("string"==typeof e||null===e)return this.getPattern$java_lang_String(e);if("number"==typeof e||null===e)return this.getPattern$int(e);throw new Error("invalid overload")},e}();PatternsCatalog.__class="com.eteks.sweethome3d.model.PatternsCatalog";var HomePrint=function(){function e(e,t,i,n,o,r,l,a,s,h,u,d,c,p){if("number"!=typeof e&&null!==e||"number"!=typeof t&&null!==t||"number"!=typeof i&&null!==i||"number"!=typeof n&&null!==n||"number"!=typeof o&&null!==o||"number"!=typeof r&&null!==r||"number"!=typeof l&&null!==l||"boolean"!=typeof a&&null!==a||"boolean"!=typeof s&&null!==s||!(null!=h&&h instanceof Array||null===h)||"boolean"!=typeof u&&null!==u||"number"!=typeof d&&null!==d||"string"!=typeof c&&null!==c||"string"!=typeof p&&null!==p){if("number"!=typeof e&&null!==e||"number"!=typeof t&&null!==t||"number"!=typeof i&&null!==i||"number"!=typeof n&&null!==n||"number"!=typeof o&&null!==o||"number"!=typeof r&&null!==r||"number"!=typeof l&&null!==l||"boolean"!=typeof a&&null!==a||"boolean"!=typeof s&&null!==s||"boolean"!=typeof h&&null!==h||"number"!=typeof u&&null!==u||"string"!=typeof d&&null!==d||"string"!=typeof c&&null!==c||void 0!==p)throw new Error("invalid overload");var g=(_=arguments)[9],m=_[10],f=_[11],v=_[12];void 0===this.paperOrientation&&(this.paperOrientation=null),void 0===this.paperWidth&&(this.paperWidth=0),void 0===this.paperHeight&&(this.paperHeight=0),void 0===this.paperTopMargin&&(this.paperTopMargin=0),void 0===this.paperLeftMargin&&(this.paperLeftMargin=0),void 0===this.paperBottomMargin&&(this.paperBottomMargin=0),void 0===this.paperRightMargin&&(this.paperRightMargin=0),void 0===this.furniturePrinted&&(this.furniturePrinted=!1),void 0===this.planPrinted&&(this.planPrinted=!1),void 0===this.printedLevels&&(this.printedLevels=null),void 0===this.view3DPrinted&&(this.view3DPrinted=!1),void 0===this.planScale&&(this.planScale=null),void 0===this.headerFormat&&(this.headerFormat=null),void 0===this.footerFormat&&(this.footerFormat=null),this.paperOrientation=e,this.paperWidth=t,this.paperHeight=i,this.paperTopMargin=n,this.paperLeftMargin=o,this.paperBottomMargin=r,this.paperRightMargin=l,this.furniturePrinted=a,this.planPrinted=s,this.printedLevels=null,this.view3DPrinted=g,this.planScale=m,this.headerFormat=f,this.footerFormat=v,void 0===this.paperOrientation&&(this.paperOrientation=null),void 0===this.paperWidth&&(this.paperWidth=0),void 0===this.paperHeight&&(this.paperHeight=0),void 0===this.paperTopMargin&&(this.paperTopMargin=0),void 0===this.paperLeftMargin&&(this.paperLeftMargin=0),void 0===this.paperBottomMargin&&(this.paperBottomMargin=0),void 0===this.paperRightMargin&&(this.paperRightMargin=0),void 0===this.furniturePrinted&&(this.furniturePrinted=!1),void 0===this.planPrinted&&(this.planPrinted=!1),void 0===this.printedLevels&&(this.printedLevels=null),void 0===this.view3DPrinted&&(this.view3DPrinted=!1),void 0===this.planScale&&(this.planScale=null),void 0===this.headerFormat&&(this.headerFormat=null),void 0===this.footerFormat&&(this.footerFormat=null)}else{var _=arguments;void 0===this.paperOrientation&&(this.paperOrientation=null),void 0===this.paperWidth&&(this.paperWidth=0),void 0===this.paperHeight&&(this.paperHeight=0),void 0===this.paperTopMargin&&(this.paperTopMargin=0),void 0===this.paperLeftMargin&&(this.paperLeftMargin=0),void 0===this.paperBottomMargin&&(this.paperBottomMargin=0),void 0===this.paperRightMargin&&(this.paperRightMargin=0),void 0===this.furniturePrinted&&(this.furniturePrinted=!1),void 0===this.planPrinted&&(this.planPrinted=!1),void 0===this.printedLevels&&(this.printedLevels=null),void 0===this.view3DPrinted&&(this.view3DPrinted=!1),void 0===this.planScale&&(this.planScale=null),void 0===this.headerFormat&&(this.headerFormat=null),void 0===this.footerFormat&&(this.footerFormat=null),this.paperOrientation=e,this.paperWidth=t,this.paperHeight=i,this.paperTopMargin=n,this.paperLeftMargin=o,this.paperBottomMargin=r,this.paperRightMargin=l,this.furniturePrinted=a,this.planPrinted=s,this.printedLevels=null!=h?h.slice(0):null,this.view3DPrinted=u,this.planScale=d,this.headerFormat=c,this.footerFormat=p}}return e.prototype.getPaperOrientation=function(){return this.paperOrientation},e.prototype.getPaperBottomMargin=function(){return this.paperBottomMargin},e.prototype.getPaperHeight=function(){return this.paperHeight},e.prototype.getPaperLeftMargin=function(){return this.paperLeftMargin},e.prototype.getPaperRightMargin=function(){return this.paperRightMargin},e.prototype.getPaperTopMargin=function(){return this.paperTopMargin},e.prototype.getPaperWidth=function(){return this.paperWidth},e.prototype.isFurniturePrinted=function(){return this.furniturePrinted},e.prototype.isPlanPrinted=function(){return this.planPrinted},e.prototype.getPrintedLevels=function(){return this.printedLevels},e.prototype.isView3DPrinted=function(){return this.view3DPrinted},e.prototype.getPlanScale=function(){return this.planScale},e.prototype.getHeaderFormat=function(){return this.headerFormat},e.prototype.getFooterFormat=function(){return this.footerFormat},e}();HomePrint.__class="com.eteks.sweethome3d.model.HomePrint",function(e){var t;(t=e.PaperOrientation||(e.PaperOrientation={}))[t.PORTRAIT=0]="PORTRAIT",t[t.LANDSCAPE=1]="LANDSCAPE",t[t.REVERSE_LANDSCAPE=2]="REVERSE_LANDSCAPE"}(HomePrint||(HomePrint={}));var HomeRecorder,TexturesCategory=function(){function e(e){void 0===this.name&&(this.name=null),void 0===this.textures&&(this.textures=null),this.name=e,this.textures=[]}return e.COMPARATOR_$LI$=function(){return null==e.COMPARATOR&&(e.COMPARATOR={compare:function(e,t){return e.toString().localeCompare(t.toString())},equals:function(e,t){return 0===e.toString().localeCompare(t.toString())}}),e.COMPARATOR},e.prototype.getName=function(){return this.name},e.prototype.getTextures=function(){return this.textures.slice(0)},e.prototype.getTexturesCount=function(){return this.textures.length},e.prototype.getTexture=function(e){return this.textures[e]},e.prototype.getIndexOfTexture=function(e){return this.textures.indexOf(e)},e.prototype.add=function(e){e.setCategory(this);var t=function(e,t){for(var i,n,o=0,r=e.length-1;o<=r;){var l=o+r>>>1,a=e[l],s=(n=t,(i=a).compareTo?i.compareTo(n):i.localeCompare(n));if(s<0)o=l+1;else{if(!(s>0))return l;r=l-1}}return-(o+1)}(this.textures,e);t<0&&(t=-t-1),this.textures.splice(t,0,e)},e.prototype.delete=function(e){var t=this.textures.indexOf(e);if(-1===t)throw new IllegalArgumentException(this.name+" doesn't contain texture "+e.getName());this.textures=this.textures.slice(0),this.textures.splice(t,1)[0]},e.prototype.equals=function(t){return null!=t&&t instanceof e&&e.COMPARATOR_$LI$().equals(this.name,t.name)},e.prototype.hashCode=function(){return(e=this.name).hashCode?e.hashCode():e.toString().split("").reduce((function(e,t){return(e<<5)-e+t.charCodeAt(0)|0}),0);var e},e.prototype.compareTo=function(t){return e.COMPARATOR_$LI$().compare(this.name,t.name)},e}();TexturesCategory.__class="com.eteks.sweethome3d.model.TexturesCategory",function(e){var t;(t=e.Type||(e.Type={}))[t.DEFAULT=0]="DEFAULT",t[t.COMPRESSED=1]="COMPRESSED"}(HomeRecorder||(HomeRecorder={}));var CatalogTexture=function(){function e(e,t,i,n,o,r,l){if("string"!=typeof e&&null!==e||"string"!=typeof t&&null!==t||!(null!=i&&null!=i.constructor&&null!=i.constructor.__interfaces&&i.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0||null===i)||"number"!=typeof n&&null!==n||"number"!=typeof o&&null!==o||"string"!=typeof r&&null!==r||"boolean"!=typeof l&&null!==l)if("string"!=typeof e&&null!==e||"string"!=typeof t&&null!==t||!(null!=i&&null!=i.constructor&&null!=i.constructor.__interfaces&&i.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0||null===i)||"number"!=typeof n&&null!==n||"number"!=typeof o&&null!==o||"string"!=typeof r&&null!==r||void 0!==l)if("string"!=typeof e&&null!==e||!(null!=t&&null!=t.constructor&&null!=t.constructor.__interfaces&&t.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0||null===t)||"number"!=typeof i&&null!==i||"number"!=typeof n&&null!==n||"boolean"!=typeof o&&null!==o||void 0!==r||void 0!==l){if("string"!=typeof e&&null!==e||!(null!=t&&null!=t.constructor&&null!=t.constructor.__interfaces&&t.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0||null===t)||"number"!=typeof i&&null!==i||"number"!=typeof n&&null!==n||void 0!==o||void 0!==r||void 0!==l)throw new Error("invalid overload");var a=(f=arguments)[0],s=f[1],h=f[2],u=f[3];void 0===this.id&&(this.id=null),void 0===this.name&&(this.name=null),void 0===this.image&&(this.image=null),void 0===this.width&&(this.width=0),void 0===this.height&&(this.height=0),void 0===this.creator&&(this.creator=null),void 0===this.modifiable&&(this.modifiable=!1),void 0===this.category&&(this.category=null),void 0===this.filterCollationKey&&(this.filterCollationKey=null),this.id=null,this.name=a,this.image=s,this.width=h,this.height=u,this.creator=null,this.modifiable=!1,void 0===this.id&&(this.id=null),void 0===this.name&&(this.name=null),void 0===this.image&&(this.image=null),void 0===this.width&&(this.width=0),void 0===this.height&&(this.height=0),void 0===this.creator&&(this.creator=null),void 0===this.modifiable&&(this.modifiable=!1),void 0===this.category&&(this.category=null),void 0===this.filterCollationKey&&(this.filterCollationKey=null),void 0===this.id&&(this.id=null),void 0===this.name&&(this.name=null),void 0===this.image&&(this.image=null),void 0===this.width&&(this.width=0),void 0===this.height&&(this.height=0),void 0===this.creator&&(this.creator=null),void 0===this.modifiable&&(this.modifiable=!1),void 0===this.category&&(this.category=null),void 0===this.filterCollationKey&&(this.filterCollationKey=null)}else{var d=(f=arguments)[0],c=f[1],p=f[2],g=f[3],m=f[4];void 0===this.id&&(this.id=null),void 0===this.name&&(this.name=null),void 0===this.image&&(this.image=null),void 0===this.width&&(this.width=0),void 0===this.height&&(this.height=0),void 0===this.creator&&(this.creator=null),void 0===this.modifiable&&(this.modifiable=!1),void 0===this.category&&(this.category=null),void 0===this.filterCollationKey&&(this.filterCollationKey=null),this.id=null,this.name=d,this.image=c,this.width=p,this.height=g,this.creator=null,this.modifiable=m,void 0===this.id&&(this.id=null),void 0===this.name&&(this.name=null),void 0===this.image&&(this.image=null),void 0===this.width&&(this.width=0),void 0===this.height&&(this.height=0),void 0===this.creator&&(this.creator=null),void 0===this.modifiable&&(this.modifiable=!1),void 0===this.category&&(this.category=null),void 0===this.filterCollationKey&&(this.filterCollationKey=null)}else{var f=arguments;void 0===this.id&&(this.id=null),void 0===this.name&&(this.name=null),void 0===this.image&&(this.image=null),void 0===this.width&&(this.width=0),void 0===this.height&&(this.height=0),void 0===this.creator&&(this.creator=null),void 0===this.modifiable&&(this.modifiable=!1),void 0===this.category&&(this.category=null),void 0===this.filterCollationKey&&(this.filterCollationKey=null),this.id=e,this.name=t,this.image=i,this.width=n,this.height=o,this.creator=r,this.modifiable=!1,void 0===this.id&&(this.id=null),void 0===this.name&&(this.name=null),void 0===this.image&&(this.image=null),void 0===this.width&&(this.width=0),void 0===this.height&&(this.height=0),void 0===this.creator&&(this.creator=null),void 0===this.modifiable&&(this.modifiable=!1),void 0===this.category&&(this.category=null),void 0===this.filterCollationKey&&(this.filterCollationKey=null)}else{var f=arguments;void 0===this.id&&(this.id=null),void 0===this.name&&(this.name=null),void 0===this.image&&(this.image=null),void 0===this.width&&(this.width=0),void 0===this.height&&(this.height=0),void 0===this.creator&&(this.creator=null),void 0===this.modifiable&&(this.modifiable=!1),void 0===this.category&&(this.category=null),void 0===this.filterCollationKey&&(this.filterCollationKey=null),this.id=e,this.name=t,this.image=i,this.width=n,this.height=o,this.creator=r,this.modifiable=l}}return e.__static_initialize=function(){e.__static_initialized||(e.__static_initialized=!0,e.__static_initializer_0())},e.EMPTY_CRITERIA_$LI$=function(){return e.__static_initialize(),null==e.EMPTY_CRITERIA&&(e.EMPTY_CRITERIA=[]),e.EMPTY_CRITERIA},e.COMPARATOR_$LI$=function(){return e.__static_initialize(),e.COMPARATOR},e.recentFilters_$LI$=function(){return e.__static_initialize(),e.recentFilters},e.__static_initializer_0=function(){e.COMPARATOR={compare:function(e,t){return e.toString().localeCompare(t.toString())},equals:function(e,t){return 0===e.toString().localeCompare(t.toString())}},e.COMPARATOR_$LI$(),e.recentFilters={}},e.prototype.getId=function(){return this.id},e.prototype.getName=function(){return this.name},e.prototype.getImage=function(){return this.image},e.prototype.getIcon=function(){return this.getImage()},e.prototype.getWidth=function(){return this.width},e.prototype.getHeight=function(){return this.height},e.prototype.getCreator=function(){return this.creator},e.prototype.isModifiable=function(){return this.modifiable},e.prototype.getCategory=function(){return this.category},e.prototype.setCategory=function(e){this.category=e},e.prototype.equals=function(e){return i=e,(t=this)&&t.equals?t.equals(i):t===i;var t,i},e.prototype.hashCode=function(){return(e=this).hashCode?e.hashCode():e.toString().split("").reduce((function(e,t){return(e<<5)-e+t.charCodeAt(0)|0}),0);var e},e.prototype.compareTo=function(t){var i=e.COMPARATOR_$LI$().compare(this.name,t.name);return 0!==i?i:this.modifiable===t.modifiable?0:this.modifiable?1:-1},e.prototype.matchesFilter=function(e){var t=this.getFilterCollationKeys(e),i=0;if(t.length>0)for(var n=this.getTextureCollationKey(),o=0;o<t.length&&this.isSubCollationKey(n,t[o],0);o++)i++;return i===t.length},e.prototype.getFilterCollationKeys=function(t){if(0===t.length)return e.EMPTY_CRITERIA_$LI$();var i,n,o=void 0===(i=e.recentFilters_$LI$())[n=t]?null:i[n];if(null==o){for(var r=t.split(/\s|\p{Punct}|\\|/),l=[],a=0;a<r.length;a++){var s=r[a];s.length>0&&l.push(e.COMPARATOR_$LI$().getCollationKey(s).toByteArray())}o=0===l.length?e.EMPTY_CRITERIA_$LI$():l.slice(0),e.recentFilters_$LI$()[t]=o}return o},e.prototype.getTextureCollationKey=function(){var t=this;if(null==this.filterCollationKey){var i={str:"",toString:function(){return this.str}};i.str+=t.getName(),function(e){e.str+="|"}(i),null!=this.getCategory()&&(function(e){e.str+=t.getCategory().getName()}(i),function(e){e.str+="|"}(i)),null!=this.getCreator()&&(function(e){e.str+=t.getCreator()}(i),function(e){e.str+="|"}(i)),this.filterCollationKey=e.COMPARATOR_$LI$().getCollationKey(i.str).toByteArray()}return this.filterCollationKey},e.prototype.isSubCollationKey=function(e,t,i){for(var n=i,o=e.length-4,r=t.length-4;n<o&&n<o-r+1;n++)if(e[n]===t[0]){for(var l=1;l<r;l++)if(e[n+l]!==t[l])return this.isSubCollationKey(e,t,n+1);return!0}return!1},e.__static_initialized=!1,e}();CatalogTexture.__class="com.eteks.sweethome3d.model.CatalogTexture",CatalogTexture.__interfaces=["com.eteks.sweethome3d.model.CatalogItem","com.eteks.sweethome3d.model.TextureImage"];var Transformation=function(){function e(e,t){void 0===this.name&&(this.name=null),void 0===this.matrix&&(this.matrix=null),this.name=e,this.matrix=t}return e.prototype.getName=function(){return this.name},e.prototype.getMatrix=function(){return[[this.matrix[0][0],this.matrix[0][1],this.matrix[0][2],this.matrix[0][3]],[this.matrix[1][0],this.matrix[1][1],this.matrix[1][2],this.matrix[1][3]],[this.matrix[2][0],this.matrix[2][1],this.matrix[2][2],this.matrix[2][3]]]},e.prototype.equals=function(t){if(null!=t&&t instanceof e){var i=t;if(i.name===this.name){for(var n=0;n<this.matrix.length;n++)for(var o=0;o<this.matrix[n].length;o++)if(i.matrix[n][o]!==this.matrix[n][o])return!1;return!0}}return!1},e.prototype.hashCode=function(){return((e=this.name).hashCode?e.hashCode():e.toString().split("").reduce((function(e,t){return(e<<5)-e+t.charCodeAt(0)|0}),0))+(this.matrix,function e(t){if(null==t)return 0;for(var i=1,n=0;n<t.length;n++){var o=1;Array.isArray(t[n])?o=e(t[n]):"number"==typeof t[n]&&(o=1e3*t[n]|0),i=31*i+o}return i});var e},e}();Transformation.__class="com.eteks.sweethome3d.model.Transformation";var LightSource=function(){function e(e,t,i,n,o){if("number"!=typeof e&&null!==e||"number"!=typeof t&&null!==t||"number"!=typeof i&&null!==i||"number"!=typeof n&&null!==n||"number"!=typeof o&&null!==o){if("number"!=typeof e&&null!==e||"number"!=typeof t&&null!==t||"number"!=typeof i&&null!==i||"number"!=typeof n&&null!==n||void 0!==o)throw new Error("invalid overload");void 0===this.x&&(this.x=0),void 0===this.y&&(this.y=0),void 0===this.z&&(this.z=0),void 0===this.color&&(this.color=0),void 0===this.diameter&&(this.diameter=null),this.x=e,this.y=t,this.z=i,this.color=n,this.diameter=null,void 0===this.x&&(this.x=0),void 0===this.y&&(this.y=0),void 0===this.z&&(this.z=0),void 0===this.color&&(this.color=0),void 0===this.diameter&&(this.diameter=null)}else{void 0===this.x&&(this.x=0),void 0===this.y&&(this.y=0),void 0===this.z&&(this.z=0),void 0===this.color&&(this.color=0),void 0===this.diameter&&(this.diameter=null),this.x=e,this.y=t,this.z=i,this.color=n,this.diameter=o}}return e.prototype.getX=function(){return this.x},e.prototype.getY=function(){return this.y},e.prototype.getZ=function(){return this.z},e.prototype.getColor=function(){return this.color},e.prototype.getDiameter=function(){return this.diameter},e}();LightSource.__class="com.eteks.sweethome3d.model.LightSource";var TextStyle=function(){function e(t,i,n,o,r,l){if("string"!=typeof t&&null!==t||"number"!=typeof i&&null!==i||"boolean"!=typeof n&&null!==n||"boolean"!=typeof o&&null!==o||"number"!=typeof r&&null!==r||"boolean"!=typeof l&&null!==l)if("string"!=typeof t&&null!==t||"number"!=typeof i&&null!==i||"boolean"!=typeof n&&null!==n||"boolean"!=typeof o&&null!==o||"number"!=typeof r&&null!==r||void 0!==l)if("string"!=typeof t&&null!==t||"number"!=typeof i&&null!==i||"boolean"!=typeof n&&null!==n||"boolean"!=typeof o&&null!==o||void 0!==r||void 0!==l)if("number"!=typeof t&&null!==t||"boolean"!=typeof i&&null!==i||"boolean"!=typeof n&&null!==n||void 0!==o||void 0!==r||void 0!==l){if("number"!=typeof t&&null!==t||void 0!==i||void 0!==n||void 0!==o||void 0!==r||void 0!==l)throw new Error("invalid overload");var a=(p=arguments)[0],s=e.Alignment.CENTER;void 0===this.fontName&&(this.fontName=null),void 0===this.fontSize&&(this.fontSize=0),void 0===this.bold&&(this.bold=!1),void 0===this.italic&&(this.italic=!1),void 0===this.alignment&&(this.alignment=null),this.fontName=null,this.fontSize=a,this.bold=!1,this.italic=!1,this.alignment=s,e.textStylesCache_$LI$().push(this),void 0===this.fontName&&(this.fontName=null),void 0===this.fontSize&&(this.fontSize=0),void 0===this.bold&&(this.bold=!1),void 0===this.italic&&(this.italic=!1),void 0===this.alignment&&(this.alignment=null),void 0===this.fontName&&(this.fontName=null),void 0===this.fontSize&&(this.fontSize=0),void 0===this.bold&&(this.bold=!1),void 0===this.italic&&(this.italic=!1),void 0===this.alignment&&(this.alignment=null),void 0===this.fontName&&(this.fontName=null),void 0===this.fontSize&&(this.fontSize=0),void 0===this.bold&&(this.bold=!1),void 0===this.italic&&(this.italic=!1),void 0===this.alignment&&(this.alignment=null),void 0===this.fontName&&(this.fontName=null),void 0===this.fontSize&&(this.fontSize=0),void 0===this.bold&&(this.bold=!1),void 0===this.italic&&(this.italic=!1),void 0===this.alignment&&(this.alignment=null)}else{var h=(p=arguments)[0],u=p[1],d=p[2],c=e.Alignment.CENTER;void 0===this.fontName&&(this.fontName=null),void 0===this.fontSize&&(this.fontSize=0),void 0===this.bold&&(this.bold=!1),void 0===this.italic&&(this.italic=!1),void 0===this.alignment&&(this.alignment=null),this.fontName=null,this.fontSize=h,this.bold=u,this.italic=d,this.alignment=c,e.textStylesCache_$LI$().push(this),void 0===this.fontName&&(this.fontName=null),void 0===this.fontSize&&(this.fontSize=0),void 0===this.bold&&(this.bold=!1),void 0===this.italic&&(this.italic=!1),void 0===this.alignment&&(this.alignment=null),void 0===this.fontName&&(this.fontName=null),void 0===this.fontSize&&(this.fontSize=0),void 0===this.bold&&(this.bold=!1),void 0===this.italic&&(this.italic=!1),void 0===this.alignment&&(this.alignment=null),void 0===this.fontName&&(this.fontName=null),void 0===this.fontSize&&(this.fontSize=0),void 0===this.bold&&(this.bold=!1),void 0===this.italic&&(this.italic=!1),void 0===this.alignment&&(this.alignment=null)}else{var p=arguments,g=e.Alignment.CENTER;void 0===this.fontName&&(this.fontName=null),void 0===this.fontSize&&(this.fontSize=0),void 0===this.bold&&(this.bold=!1),void 0===this.italic&&(this.italic=!1),void 0===this.alignment&&(this.alignment=null),this.fontName=t,this.fontSize=i,this.bold=n,this.italic=o,this.alignment=g,e.textStylesCache_$LI$().push(this),void 0===this.fontName&&(this.fontName=null),void 0===this.fontSize&&(this.fontSize=0),void 0===this.bold&&(this.bold=!1),void 0===this.italic&&(this.italic=!1),void 0===this.alignment&&(this.alignment=null),void 0===this.fontName&&(this.fontName=null),void 0===this.fontSize&&(this.fontSize=0),void 0===this.bold&&(this.bold=!1),void 0===this.italic&&(this.italic=!1),void 0===this.alignment&&(this.alignment=null)}else{var p=arguments;void 0===this.fontName&&(this.fontName=null),void 0===this.fontSize&&(this.fontSize=0),void 0===this.bold&&(this.bold=!1),void 0===this.italic&&(this.italic=!1),void 0===this.alignment&&(this.alignment=null),this.fontName=t,this.fontSize=i,this.bold=n,this.italic=o,this.alignment=r,e.textStylesCache_$LI$().push(this),void 0===this.fontName&&(this.fontName=null),void 0===this.fontSize&&(this.fontSize=0),void 0===this.bold&&(this.bold=!1),void 0===this.italic&&(this.italic=!1),void 0===this.alignment&&(this.alignment=null)}else{var p=arguments;void 0===this.fontName&&(this.fontName=null),void 0===this.fontSize&&(this.fontSize=0),void 0===this.bold&&(this.bold=!1),void 0===this.italic&&(this.italic=!1),void 0===this.alignment&&(this.alignment=null),this.fontName=t,this.fontSize=i,this.bold=n,this.italic=o,this.alignment=r,l&&e.textStylesCache_$LI$().push(this)}}return e.textStylesCache_$LI$=function(){return null==e.textStylesCache&&(e.textStylesCache=[]),e.textStylesCache},e.prototype.getInstance=function(t,i,n,o,r){for(var l=new e(t,i,n,o,r,!1),a=e.textStylesCache_$LI$().length-1;a>=0;a--){var s=e.textStylesCache_$LI$()[a];if(null==s)e.textStylesCache_$LI$().splice(a,1)[0];else if(s.equals(l))return l}return e.textStylesCache_$LI$().push(l),l},e.prototype.getFontName=function(){return this.fontName},e.prototype.getFontSize=function(){return this.fontSize},e.prototype.isBold=function(){return this.bold},e.prototype.isItalic=function(){return this.italic},e.prototype.getAlignment=function(){return this.alignment},e.prototype.deriveStyle$java_lang_String=function(e){return this.getFontName()===e||null!=e&&e===this.getFontName()?this:this.getInstance(e,this.getFontSize(),this.isBold(),this.isItalic(),this.getAlignment())},e.prototype.deriveStyle=function(e){if("string"==typeof e||null===e)return this.deriveStyle$java_lang_String(e);if("number"==typeof e||null===e)return this.deriveStyle$com_eteks_sweethome3d_model_TextStyle_Alignment(e);if("number"==typeof e||null===e)return this.deriveStyle$float(e);throw new Error("invalid overload")},e.prototype.deriveStyle$float=function(e){return this.getFontSize()===e?this:this.getInstance(this.getFontName(),e,this.isBold(),this.isItalic(),this.getAlignment())},e.prototype.deriveStyle$com_eteks_sweethome3d_model_TextStyle_Alignment=function(e){return this.getAlignment()===e?this:this.getInstance(this.getFontName(),this.getFontSize(),this.isBold(),this.isItalic(),e)},e.prototype.deriveBoldStyle=function(e){return this.isBold()===e?this:this.getInstance(this.getFontName(),this.getFontSize(),e,this.isItalic(),this.getAlignment())},e.prototype.deriveItalicStyle=function(e){return this.isItalic()===e?this:this.getInstance(this.getFontName(),this.getFontSize(),this.isBold(),e,this.getAlignment())},e.prototype.equals=function(t){if(null!=t&&t instanceof e){var i=t;return(i.fontName===this.fontName||null!=i.fontName&&i.fontName===this.fontName)&&i.fontSize===this.fontSize&&i.bold===this.bold&&i.italic===this.italic&&i.alignment===this.alignment}return!1},e.prototype.hashCode=function(){var e,t,i=(e=this.fontSize,t=new ArrayBuffer(4),new Float32Array(t)[0]=e,new Uint32Array(t)[0]);return null!=this.fontName&&(i+=function(e){return e.hashCode?e.hashCode():e.toString().split("").reduce((function(e,t){return(e<<5)-e+t.charCodeAt(0)|0}),0)}(this.fontName)),this.bold&&i++,this.italic&&i++,i+=0},e}();TextStyle.__class="com.eteks.sweethome3d.model.TextStyle",function(e){var t;(t=e.Alignment||(e.Alignment={}))[t.LEFT=0]="LEFT",t[t.CENTER=1]="CENTER",t[t.RIGHT=2]="RIGHT"}(TextStyle||(TextStyle={}));var HomeTexture=function(){function e(t,i,n,o,r,l,a){if(!(null!=t&&null!=t.constructor&&null!=t.constructor.__interfaces&&t.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.TextureImage")>=0||null===t)||"number"!=typeof i&&null!==i||"number"!=typeof n&&null!==n||"number"!=typeof o&&null!==o||"number"!=typeof r&&null!==r||"boolean"!=typeof l&&null!==l||"boolean"!=typeof a&&null!==a)if(!(null!=t&&null!=t.constructor&&null!=t.constructor.__interfaces&&t.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.TextureImage")>=0||null===t)||"number"!=typeof i&&null!==i||"number"!=typeof n&&null!==n||"number"!=typeof o&&null!==o||"number"!=typeof r&&null!==r||"boolean"!=typeof l&&null!==l||void 0!==a)if(!(null!=t&&null!=t.constructor&&null!=t.constructor.__interfaces&&t.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.TextureImage")>=0||null===t)||"number"!=typeof i&&null!==i||"number"!=typeof n&&null!==n||"boolean"!=typeof o&&null!==o||void 0!==r||void 0!==l||void 0!==a)if(!(null!=t&&null!=t.constructor&&null!=t.constructor.__interfaces&&t.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.TextureImage")>=0||null===t)||"number"!=typeof i&&null!==i||"boolean"!=typeof n&&null!==n||void 0!==o||void 0!==r||void 0!==l||void 0!==a)if(!(null!=t&&null!=t.constructor&&null!=t.constructor.__interfaces&&t.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.TextureImage")>=0||null===t)||"number"!=typeof i&&null!==i||void 0!==n||void 0!==o||void 0!==r||void 0!==l||void 0!==a){if(!(null!=t&&null!=t.constructor&&null!=t.constructor.__interfaces&&t.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.TextureImage")>=0||null===t)||void 0!==i||void 0!==n||void 0!==o||void 0!==r||void 0!==l||void 0!==a)throw new Error("invalid overload");m=arguments;void 0===this.catalogId&&(this.catalogId=null),void 0===this.name&&(this.name=null),void 0===this.creator&&(this.creator=null),void 0===this.image&&(this.image=null),void 0===this.width&&(this.width=0),void 0===this.height&&(this.height=0),void 0===this.xOffset&&(this.xOffset=0),void 0===this.yOffset&&(this.yOffset=0),void 0===this.angle&&(this.angle=0),void 0===this.scale&&(this.scale=0),void 0===this.fittingArea&&(this.fittingArea=!1),void 0===this.leftToRightOriented&&(this.leftToRightOriented=!1),this.name=t.getName(),this.creator=t.getCreator(),this.image=t.getImage(),this.width=t.getWidth(),this.height=t.getHeight(),this.xOffset=0,this.yOffset=0,this.angle=0,this.scale=1,this.fittingArea=!1,this.leftToRightOriented=!0,this.catalogId=null!=t&&t instanceof e?t.getCatalogId():null!=t&&t instanceof CatalogTexture?t.getId():null,void 0===this.catalogId&&(this.catalogId=null),void 0===this.name&&(this.name=null),void 0===this.creator&&(this.creator=null),void 0===this.image&&(this.image=null),void 0===this.width&&(this.width=0),void 0===this.height&&(this.height=0),void 0===this.xOffset&&(this.xOffset=0),void 0===this.yOffset&&(this.yOffset=0),void 0===this.angle&&(this.angle=0),void 0===this.scale&&(this.scale=0),void 0===this.fittingArea&&(this.fittingArea=!1),void 0===this.leftToRightOriented&&(this.leftToRightOriented=!1),void 0===this.catalogId&&(this.catalogId=null),void 0===this.name&&(this.name=null),void 0===this.creator&&(this.creator=null),void 0===this.image&&(this.image=null),void 0===this.width&&(this.width=0),void 0===this.height&&(this.height=0),void 0===this.xOffset&&(this.xOffset=0),void 0===this.yOffset&&(this.yOffset=0),void 0===this.angle&&(this.angle=0),void 0===this.scale&&(this.scale=0),void 0===this.fittingArea&&(this.fittingArea=!1),void 0===this.leftToRightOriented&&(this.leftToRightOriented=!1),void 0===this.catalogId&&(this.catalogId=null),void 0===this.name&&(this.name=null),void 0===this.creator&&(this.creator=null),void 0===this.image&&(this.image=null),void 0===this.width&&(this.width=0),void 0===this.height&&(this.height=0),void 0===this.xOffset&&(this.xOffset=0),void 0===this.yOffset&&(this.yOffset=0),void 0===this.angle&&(this.angle=0),void 0===this.scale&&(this.scale=0),void 0===this.fittingArea&&(this.fittingArea=!1),void 0===this.leftToRightOriented&&(this.leftToRightOriented=!1),void 0===this.catalogId&&(this.catalogId=null),void 0===this.name&&(this.name=null),void 0===this.creator&&(this.creator=null),void 0===this.image&&(this.image=null),void 0===this.width&&(this.width=0),void 0===this.height&&(this.height=0),void 0===this.xOffset&&(this.xOffset=0),void 0===this.yOffset&&(this.yOffset=0),void 0===this.angle&&(this.angle=0),void 0===this.scale&&(this.scale=0),void 0===this.fittingArea&&(this.fittingArea=!1),void 0===this.leftToRightOriented&&(this.leftToRightOriented=!1),void 0===this.catalogId&&(this.catalogId=null),void 0===this.name&&(this.name=null),void 0===this.creator&&(this.creator=null),void 0===this.image&&(this.image=null),void 0===this.width&&(this.width=0),void 0===this.height&&(this.height=0),void 0===this.xOffset&&(this.xOffset=0),void 0===this.yOffset&&(this.yOffset=0),void 0===this.angle&&(this.angle=0),void 0===this.scale&&(this.scale=0),void 0===this.fittingArea&&(this.fittingArea=!1),void 0===this.leftToRightOriented&&(this.leftToRightOriented=!1)}else{var s=(m=arguments)[1];void 0===this.catalogId&&(this.catalogId=null),void 0===this.name&&(this.name=null),void 0===this.creator&&(this.creator=null),void 0===this.image&&(this.image=null),void 0===this.width&&(this.width=0),void 0===this.height&&(this.height=0),void 0===this.xOffset&&(this.xOffset=0),void 0===this.yOffset&&(this.yOffset=0),void 0===this.angle&&(this.angle=0),void 0===this.scale&&(this.scale=0),void 0===this.fittingArea&&(this.fittingArea=!1),void 0===this.leftToRightOriented&&(this.leftToRightOriented=!1),this.name=t.getName(),this.creator=t.getCreator(),this.image=t.getImage(),this.width=t.getWidth(),this.height=t.getHeight(),this.xOffset=0,this.yOffset=0,this.angle=s,this.scale=1,this.fittingArea=!1,this.leftToRightOriented=!0,this.catalogId=null!=t&&t instanceof e?t.getCatalogId():null!=t&&t instanceof CatalogTexture?t.getId():null,void 0===this.catalogId&&(this.catalogId=null),void 0===this.name&&(this.name=null),void 0===this.creator&&(this.creator=null),void 0===this.image&&(this.image=null),void 0===this.width&&(this.width=0),void 0===this.height&&(this.height=0),void 0===this.xOffset&&(this.xOffset=0),void 0===this.yOffset&&(this.yOffset=0),void 0===this.angle&&(this.angle=0),void 0===this.scale&&(this.scale=0),void 0===this.fittingArea&&(this.fittingArea=!1),void 0===this.leftToRightOriented&&(this.leftToRightOriented=!1),void 0===this.catalogId&&(this.catalogId=null),void 0===this.name&&(this.name=null),void 0===this.creator&&(this.creator=null),void 0===this.image&&(this.image=null),void 0===this.width&&(this.width=0),void 0===this.height&&(this.height=0),void 0===this.xOffset&&(this.xOffset=0),void 0===this.yOffset&&(this.yOffset=0),void 0===this.angle&&(this.angle=0),void 0===this.scale&&(this.scale=0),void 0===this.fittingArea&&(this.fittingArea=!1),void 0===this.leftToRightOriented&&(this.leftToRightOriented=!1),void 0===this.catalogId&&(this.catalogId=null),void 0===this.name&&(this.name=null),void 0===this.creator&&(this.creator=null),void 0===this.image&&(this.image=null),void 0===this.width&&(this.width=0),void 0===this.height&&(this.height=0),void 0===this.xOffset&&(this.xOffset=0),void 0===this.yOffset&&(this.yOffset=0),void 0===this.angle&&(this.angle=0),void 0===this.scale&&(this.scale=0),void 0===this.fittingArea&&(this.fittingArea=!1),void 0===this.leftToRightOriented&&(this.leftToRightOriented=!1),void 0===this.catalogId&&(this.catalogId=null),void 0===this.name&&(this.name=null),void 0===this.creator&&(this.creator=null),void 0===this.image&&(this.image=null),void 0===this.width&&(this.width=0),void 0===this.height&&(this.height=0),void 0===this.xOffset&&(this.xOffset=0),void 0===this.yOffset&&(this.yOffset=0),void 0===this.angle&&(this.angle=0),void 0===this.scale&&(this.scale=0),void 0===this.fittingArea&&(this.fittingArea=!1),void 0===this.leftToRightOriented&&(this.leftToRightOriented=!1)}else{var h=(m=arguments)[1],u=m[2];void 0===this.catalogId&&(this.catalogId=null),void 0===this.name&&(this.name=null),void 0===this.creator&&(this.creator=null),void 0===this.image&&(this.image=null),void 0===this.width&&(this.width=0),void 0===this.height&&(this.height=0),void 0===this.xOffset&&(this.xOffset=0),void 0===this.yOffset&&(this.yOffset=0),void 0===this.angle&&(this.angle=0),void 0===this.scale&&(this.scale=0),void 0===this.fittingArea&&(this.fittingArea=!1),void 0===this.leftToRightOriented&&(this.leftToRightOriented=!1),this.name=t.getName(),this.creator=t.getCreator(),this.image=t.getImage(),this.width=t.getWidth(),this.height=t.getHeight(),this.xOffset=0,this.yOffset=0,this.angle=h,this.scale=1,this.fittingArea=!1,this.leftToRightOriented=u,this.catalogId=null!=t&&t instanceof e?t.getCatalogId():null!=t&&t instanceof CatalogTexture?t.getId():null,void 0===this.catalogId&&(this.catalogId=null),void 0===this.name&&(this.name=null),void 0===this.creator&&(this.creator=null),void 0===this.image&&(this.image=null),void 0===this.width&&(this.width=0),void 0===this.height&&(this.height=0),void 0===this.xOffset&&(this.xOffset=0),void 0===this.yOffset&&(this.yOffset=0),void 0===this.angle&&(this.angle=0),void 0===this.scale&&(this.scale=0),void 0===this.fittingArea&&(this.fittingArea=!1),void 0===this.leftToRightOriented&&(this.leftToRightOriented=!1),void 0===this.catalogId&&(this.catalogId=null),void 0===this.name&&(this.name=null),void 0===this.creator&&(this.creator=null),void 0===this.image&&(this.image=null),void 0===this.width&&(this.width=0),void 0===this.height&&(this.height=0),void 0===this.xOffset&&(this.xOffset=0),void 0===this.yOffset&&(this.yOffset=0),void 0===this.angle&&(this.angle=0),void 0===this.scale&&(this.scale=0),void 0===this.fittingArea&&(this.fittingArea=!1),void 0===this.leftToRightOriented&&(this.leftToRightOriented=!1),void 0===this.catalogId&&(this.catalogId=null),void 0===this.name&&(this.name=null),void 0===this.creator&&(this.creator=null),void 0===this.image&&(this.image=null),void 0===this.width&&(this.width=0),void 0===this.height&&(this.height=0),void 0===this.xOffset&&(this.xOffset=0),void 0===this.yOffset&&(this.yOffset=0),void 0===this.angle&&(this.angle=0),void 0===this.scale&&(this.scale=0),void 0===this.fittingArea&&(this.fittingArea=!1),void 0===this.leftToRightOriented&&(this.leftToRightOriented=!1)}else{var d=(m=arguments)[1],c=m[2],p=m[3];void 0===this.catalogId&&(this.catalogId=null),void 0===this.name&&(this.name=null),void 0===this.creator&&(this.creator=null),void 0===this.image&&(this.image=null),void 0===this.width&&(this.width=0),void 0===this.height&&(this.height=0),void 0===this.xOffset&&(this.xOffset=0),void 0===this.yOffset&&(this.yOffset=0),void 0===this.angle&&(this.angle=0),void 0===this.scale&&(this.scale=0),void 0===this.fittingArea&&(this.fittingArea=!1),void 0===this.leftToRightOriented&&(this.leftToRightOriented=!1),this.name=t.getName(),this.creator=t.getCreator(),this.image=t.getImage(),this.width=t.getWidth(),this.height=t.getHeight(),this.xOffset=0,this.yOffset=0,this.angle=d,this.scale=c,this.fittingArea=!1,this.leftToRightOriented=p,this.catalogId=null!=t&&t instanceof e?t.getCatalogId():null!=t&&t instanceof CatalogTexture?t.getId():null,void 0===this.catalogId&&(this.catalogId=null),void 0===this.name&&(this.name=null),void 0===this.creator&&(this.creator=null),void 0===this.image&&(this.image=null),void 0===this.width&&(this.width=0),void 0===this.height&&(this.height=0),void 0===this.xOffset&&(this.xOffset=0),void 0===this.yOffset&&(this.yOffset=0),void 0===this.angle&&(this.angle=0),void 0===this.scale&&(this.scale=0),void 0===this.fittingArea&&(this.fittingArea=!1),void 0===this.leftToRightOriented&&(this.leftToRightOriented=!1),void 0===this.catalogId&&(this.catalogId=null),void 0===this.name&&(this.name=null),void 0===this.creator&&(this.creator=null),void 0===this.image&&(this.image=null),void 0===this.width&&(this.width=0),void 0===this.height&&(this.height=0),void 0===this.xOffset&&(this.xOffset=0),void 0===this.yOffset&&(this.yOffset=0),void 0===this.angle&&(this.angle=0),void 0===this.scale&&(this.scale=0),void 0===this.fittingArea&&(this.fittingArea=!1),void 0===this.leftToRightOriented&&(this.leftToRightOriented=!1)}else{var g=(m=arguments)[5];void 0===this.catalogId&&(this.catalogId=null),void 0===this.name&&(this.name=null),void 0===this.creator&&(this.creator=null),void 0===this.image&&(this.image=null),void 0===this.width&&(this.width=0),void 0===this.height&&(this.height=0),void 0===this.xOffset&&(this.xOffset=0),void 0===this.yOffset&&(this.yOffset=0),void 0===this.angle&&(this.angle=0),void 0===this.scale&&(this.scale=0),void 0===this.fittingArea&&(this.fittingArea=!1),void 0===this.leftToRightOriented&&(this.leftToRightOriented=!1),this.name=t.getName(),this.creator=t.getCreator(),this.image=t.getImage(),this.width=t.getWidth(),this.height=t.getHeight(),this.xOffset=i,this.yOffset=n,this.angle=o,this.scale=r,this.fittingArea=!1,this.leftToRightOriented=g,this.catalogId=null!=t&&t instanceof e?t.getCatalogId():null!=t&&t instanceof CatalogTexture?t.getId():null,void 0===this.catalogId&&(this.catalogId=null),void 0===this.name&&(this.name=null),void 0===this.creator&&(this.creator=null),void 0===this.image&&(this.image=null),void 0===this.width&&(this.width=0),void 0===this.height&&(this.height=0),void 0===this.xOffset&&(this.xOffset=0),void 0===this.yOffset&&(this.yOffset=0),void 0===this.angle&&(this.angle=0),void 0===this.scale&&(this.scale=0),void 0===this.fittingArea&&(this.fittingArea=!1),void 0===this.leftToRightOriented&&(this.leftToRightOriented=!1)}else{var m=arguments;void 0===this.catalogId&&(this.catalogId=null),void 0===this.name&&(this.name=null),void 0===this.creator&&(this.creator=null),void 0===this.image&&(this.image=null),void 0===this.width&&(this.width=0),void 0===this.height&&(this.height=0),void 0===this.xOffset&&(this.xOffset=0),void 0===this.yOffset&&(this.yOffset=0),void 0===this.angle&&(this.angle=0),void 0===this.scale&&(this.scale=0),void 0===this.fittingArea&&(this.fittingArea=!1),void 0===this.leftToRightOriented&&(this.leftToRightOriented=!1),this.name=t.getName(),this.creator=t.getCreator(),this.image=t.getImage(),this.width=t.getWidth(),this.height=t.getHeight(),this.xOffset=i,this.yOffset=n,this.angle=o,this.scale=r,this.fittingArea=l,this.leftToRightOriented=a,this.catalogId=null!=t&&t instanceof e?t.getCatalogId():null!=t&&t instanceof CatalogTexture?t.getId():null}}return e.prototype.getCatalogId=function(){return this.catalogId},e.prototype.getName=function(){return this.name},e.prototype.getCreator=function(){return this.creator},e.prototype.getImage=function(){return this.image},e.prototype.getWidth=function(){return this.width},e.prototype.getHeight=function(){return this.height},e.prototype.getXOffset=function(){return this.xOffset},e.prototype.getYOffset=function(){return this.yOffset},e.prototype.getAngle=function(){return this.angle},e.prototype.getScale=function(){return this.scale},e.prototype.isFittingArea=function(){return this.fittingArea},e.prototype.setFittingArea=function(e){this.fittingArea=e},e.prototype.isLeftToRightOriented=function(){return this.leftToRightOriented},e.prototype.equals=function(t){if(t===this)return!0;if(null!=t&&t instanceof e){var i=t;return(i.name===this.name||null!=i.name&&i.name===this.name)&&(i.image===this.image||null!=i.image&&(n=i.image,o=this.image,n&&n.equals?n.equals(o):n===o))&&i.width===this.width&&i.height===this.height&&i.xOffset===this.xOffset&&i.yOffset===this.yOffset&&i.fittingArea===this.fittingArea&&i.leftToRightOriented===this.leftToRightOriented&&i.angle===this.angle&&i.scale===this.scale}return!1;var n,o},e.prototype.hashCode=function(){return(null!=this.name?(e=this.name).hashCode?e.hashCode():e.toString().split("").reduce((function(e,t){return(e<<5)-e+t.charCodeAt(0)|0}),0):0)+(null!=this.image?function(e){return e.hashCode?e.hashCode():e.toString().split("").reduce((function(e,t){return(e<<5)-e+t.charCodeAt(0)|0}),0)}(this.image):0)+function(e){var t=new ArrayBuffer(4);return new Float32Array(t)[0]=e,new Uint32Array(t)[0]}(this.width)+function(e){var t=new ArrayBuffer(4);return new Float32Array(t)[0]=e,new Uint32Array(t)[0]}(this.height)+function(e){var t=new ArrayBuffer(4);return new Float32Array(t)[0]=e,new Uint32Array(t)[0]}(this.xOffset)+function(e){var t=new ArrayBuffer(4);return new Float32Array(t)[0]=e,new Uint32Array(t)[0]}(this.yOffset)+function(e){var t=new ArrayBuffer(4);return new Float32Array(t)[0]=e,new Uint32Array(t)[0]}(this.angle)+function(e){var t=new ArrayBuffer(4);return new Float32Array(t)[0]=e,new Uint32Array(t)[0]}(this.scale);var e},e}();HomeTexture.__class="com.eteks.sweethome3d.model.HomeTexture",HomeTexture.__interfaces=["com.eteks.sweethome3d.model.TextureImage"];var AspectRatio,IllegalHomonymException=function(e){if("string"==typeof e||null===e);else if(void 0!==e)throw new Error("invalid overload")};IllegalHomonymException.__class="com.eteks.sweethome3d.model.IllegalHomonymException",function(e){e[e.FREE_RATIO=0]="FREE_RATIO",e[e.VIEW_3D_RATIO=1]="VIEW_3D_RATIO",e[e.RATIO_4_3=2]="RATIO_4_3",e[e.RATIO_3_2=3]="RATIO_3_2",e[e.RATIO_16_9=4]="RATIO_16_9",e[e.RATIO_2_1=5]="RATIO_2_1",e[e.RATIO_24_10=6]="RATIO_24_10",e[e.SQUARE_RATIO=7]="SQUARE_RATIO"}(AspectRatio||(AspectRatio={}));var AspectRatio_$WRAPPER=function(){function e(e,t,i){this._$ordinal=e,this._$name=t,void 0===this.value&&(this.value=null),this.value=i}return e.prototype.getValue=function(){return this.value},e.prototype.name=function(){return this._$name},e.prototype.ordinal=function(){return this._$ordinal},e.prototype.compareTo=function(e){return this._$ordinal-(isNaN(e)?e._$ordinal:e)},e}();AspectRatio.__class="com.eteks.sweethome3d.model.AspectRatio",AspectRatio._$wrappers={0:new AspectRatio_$WRAPPER(0,"FREE_RATIO",null),1:new AspectRatio_$WRAPPER(1,"VIEW_3D_RATIO",null),2:new AspectRatio_$WRAPPER(2,"RATIO_4_3",4/3),3:new AspectRatio_$WRAPPER(3,"RATIO_3_2",1.5),4:new AspectRatio_$WRAPPER(4,"RATIO_16_9",16/9),5:new AspectRatio_$WRAPPER(5,"RATIO_2_1",2),6:new AspectRatio_$WRAPPER(6,"RATIO_24_10",2.4),7:new AspectRatio_$WRAPPER(7,"SQUARE_RATIO",1)};var Baseboard=function(){function e(t,i,n,o,r){if("number"!=typeof t&&null!==t||"number"!=typeof i&&null!==i||"number"!=typeof n&&null!==n||!(null!=o&&o instanceof HomeTexture||null===o)||"boolean"!=typeof r&&null!==r){if("number"!=typeof t&&null!==t||"number"!=typeof i&&null!==i||"number"!=typeof n&&null!==n||!(null!=o&&o instanceof HomeTexture||null===o)||void 0!==r)throw new Error("invalid overload");var l=arguments,a=l[1],s=l[0];void 0===this.thickness&&(this.thickness=0),void 0===this.height&&(this.height=0),void 0===this.color&&(this.color=null),void 0===this.texture&&(this.texture=null),this.height=s,this.thickness=a,this.color=n,this.texture=o,e.baseboardsCache_$LI$().push(this),void 0===this.thickness&&(this.thickness=0),void 0===this.height&&(this.height=0),void 0===this.color&&(this.color=null),void 0===this.texture&&(this.texture=null)}else{void 0===this.thickness&&(this.thickness=0),void 0===this.height&&(this.height=0),void 0===this.color&&(this.color=null),void 0===this.texture&&(this.texture=null),this.height=i,this.thickness=t,this.color=n,this.texture=o,r&&e.baseboardsCache_$LI$().push(this)}}return e.baseboardsCache_$LI$=function(){return null==e.baseboardsCache&&(e.baseboardsCache=[]),e.baseboardsCache},e.getInstance=function(t,i,n,o){for(var r=new e(t,i,n,o,!1),l=e.baseboardsCache_$LI$().length-1;l>=0;l--){var a=e.baseboardsCache_$LI$()[l];if(null==a)e.baseboardsCache_$LI$().splice(l,1)[0];else if(a.equals(r))return r}return e.baseboardsCache_$LI$().push(r),r},e.prototype.getThickness=function(){return this.thickness},e.prototype.getHeight=function(){return this.height},e.prototype.getColor=function(){return this.color},e.prototype.getTexture=function(){return this.texture},e.prototype.equals=function(t){if(null!=t&&t instanceof e){var i=t;return i.thickness===this.thickness&&i.height===this.height&&(i.color===this.color||null!=i.color&&i.color===this.color)&&(i.texture===this.texture||null!=i.texture&&i.texture.equals(this.texture))}return!1},e.prototype.hashCode=function(){var e,t,i=(e=this.thickness,t=new ArrayBuffer(4),new Float32Array(t)[0]=e,new Uint32Array(t)[0]+function(e){var t=new ArrayBuffer(4);return new Float32Array(t)[0]=e,new Uint32Array(t)[0]}(this.height));return null!=this.color&&(i+=function(e){return e.hashCode?e.hashCode():e.toString().split("").reduce((function(e,t){return(e<<5)-e+t.charCodeAt(0)|0}),0)}(this.color)),null!=this.texture&&(i+=function(e){return e.hashCode?e.hashCode():e.toString().split("").reduce((function(e,t){return(e<<5)-e+t.charCodeAt(0)|0}),0)}(this.texture)),i},e}();Baseboard.__class="com.eteks.sweethome3d.model.Baseboard";var FurnitureCatalog=function(){function e(){this.categories=[],this.furnitureChangeSupport=new CollectionChangeSupport(this)}return e.prototype.getCategories=function(){return this.categories.slice(0)},e.prototype.getCategoriesCount=function(){return this.categories.length},e.prototype.getCategory=function(e){return this.categories[e]},e.prototype.addFurnitureListener=function(e){var t;this.furnitureChangeSupport.addCollectionListener(null==(t=e)||"function"==typeof t?t:function(e){return(t.collectionChanged?t.collectionChanged:t).call(t,e)})},e.prototype.removeFurnitureListener=function(e){var t;this.furnitureChangeSupport.removeCollectionListener(null==(t=e)||"function"==typeof t?t:function(e){return(t.collectionChanged?t.collectionChanged:t).call(t,e)})},e.prototype.add=function(e,t){var i=function(e,t){for(var i,n,o=0,r=e.length-1;o<=r;){var l=o+r>>>1,a=e[l],s=(n=t,(i=a).compareTo?i.compareTo(n):i.localeCompare(n));if(s<0)o=l+1;else{if(!(s>0))return l;r=l-1}}return-(o+1)}(this.categories,e);i<0?(e=new FurnitureCategory(e.getName()),this.categories.splice(-i-1,0,e)):e=this.categories[i],e.add(t),this.furnitureChangeSupport.fireCollectionChanged(t,e.getIndexOfPieceOfFurniture(t),CollectionEvent.Type.ADD)},e.prototype.delete=function(e){var t,i,n=e.getCategory();if(null!=n){var o=n.getIndexOfPieceOfFurniture(e);if(o>=0)return n.delete(e),0===n.getFurnitureCount()&&(this.categories=this.categories.slice(0),t=this.categories,(i=t.indexOf(n))>=0&&t.splice(i,1)),void this.furnitureChangeSupport.fireCollectionChanged(e,o,CollectionEvent.Type.DELETE)}throw new IllegalArgumentException("catalog doesn't contain piece "+e.getName())},e.prototype.getPieceOfFurnitureWithId=function(e){for(var t=0;t<this.categories.length;t++)for(var i=this.categories[t].getFurniture(),n=0;n<i.length;n++){var o=i[n];if(e===o.getId())return o}return null},e}();FurnitureCatalog.__class="com.eteks.sweethome3d.model.FurnitureCatalog";var HomeDescriptor=function(){function e(e,t,i){void 0===this.name&&(this.name=null),void 0===this.content&&(this.content=null),void 0===this.icon&&(this.icon=null),this.name=e,this.content=t,this.icon=i}return e.prototype.getName=function(){return this.name},e.prototype.getContent=function(){return this.content},e.prototype.getIcon=function(){return this.icon},e}();HomeDescriptor.__class="com.eteks.sweethome3d.model.HomeDescriptor";var HomeApplication=function(){function e(){this.homes=[],this.homesChangeSupport=new CollectionChangeSupport(this)}return e.prototype.addHomesListener=function(e){var t;this.homesChangeSupport.addCollectionListener(null==(t=e)||"function"==typeof t?t:function(e){return(t.collectionChanged?t.collectionChanged:t).call(t,e)})},e.prototype.removeHomesListener=function(e){var t;this.homesChangeSupport.removeCollectionListener(null==(t=e)||"function"==typeof t?t:function(e){return(t.collectionChanged?t.collectionChanged:t).call(t,e)})},e.prototype.createHome=function(){return new Home(this.getUserPreferences().getNewWallHeight())},e.prototype.getHomes=function(){return this.homes.slice(0)},e.prototype.addHome=function(e){this.homes=this.homes.slice(0),this.homes.push(e),this.homesChangeSupport.fireCollectionChanged(e,this.homes.length-1,CollectionEvent.Type.ADD)},e.prototype.deleteHome=function(e){var t=this.homes.indexOf(e);-1!==t&&(this.homes=this.homes.slice(0),this.homes.splice(t,1)[0],this.homesChangeSupport.fireCollectionChanged(e,t,CollectionEvent.Type.DELETE))},e.prototype.getHomeRecorder$=function(){throw new Error("cannot invoke abstract overloaded method... check your argument(s) type(s)")},e.prototype.getHomeRecorder$com_eteks_sweethome3d_model_HomeRecorder_Type=function(e){return this.getHomeRecorder$()},e.prototype.getHomeRecorder=function(e){if("number"==typeof e||null===e)return this.getHomeRecorder$com_eteks_sweethome3d_model_HomeRecorder_Type(e);if(void 0===e)return this.getHomeRecorder$();throw new Error("invalid overload")},e.prototype.getName=function(){return"Sweet Home 3D"},e.prototype.getVersion=function(){return""},e.prototype.getId=function(){return null},e}();HomeApplication.__class="com.eteks.sweethome3d.model.HomeApplication";var BackgroundImage=function(){function e(e,t,i,n,o,r,l,a,s){if(!(null!=e&&null!=e.constructor&&null!=e.constructor.__interfaces&&e.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0||null===e)||"number"!=typeof t&&null!==t||"number"!=typeof i&&null!==i||"number"!=typeof n&&null!==n||"number"!=typeof o&&null!==o||"number"!=typeof r&&null!==r||"number"!=typeof l&&null!==l||"number"!=typeof a&&null!==a||"boolean"!=typeof s&&null!==s){if(!(null!=e&&null!=e.constructor&&null!=e.constructor.__interfaces&&e.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0||null===e)||"number"!=typeof t&&null!==t||"number"!=typeof i&&null!==i||"number"!=typeof n&&null!==n||"number"!=typeof o&&null!==o||"number"!=typeof r&&null!==r||"number"!=typeof l&&null!==l||"number"!=typeof a&&null!==a||void 0!==s)throw new Error("invalid overload");void 0===this.image&&(this.image=null),void 0===this.scaleDistance&&(this.scaleDistance=0),void 0===this.scaleDistanceXStart&&(this.scaleDistanceXStart=0),void 0===this.scaleDistanceYStart&&(this.scaleDistanceYStart=0),void 0===this.scaleDistanceXEnd&&(this.scaleDistanceXEnd=0),void 0===this.scaleDistanceYEnd&&(this.scaleDistanceYEnd=0),void 0===this.xOrigin&&(this.xOrigin=0),void 0===this.yOrigin&&(this.yOrigin=0),void 0===this.invisible&&(this.invisible=!1),this.image=e,this.scaleDistance=t,this.scaleDistanceXStart=i,this.scaleDistanceYStart=n,this.scaleDistanceXEnd=o,this.scaleDistanceYEnd=r,this.xOrigin=l,this.yOrigin=a,this.invisible=!1,void 0===this.image&&(this.image=null),void 0===this.scaleDistance&&(this.scaleDistance=0),void 0===this.scaleDistanceXStart&&(this.scaleDistanceXStart=0),void 0===this.scaleDistanceYStart&&(this.scaleDistanceYStart=0),void 0===this.scaleDistanceXEnd&&(this.scaleDistanceXEnd=0),void 0===this.scaleDistanceYEnd&&(this.scaleDistanceYEnd=0),void 0===this.xOrigin&&(this.xOrigin=0),void 0===this.yOrigin&&(this.yOrigin=0),void 0===this.invisible&&(this.invisible=!1)}else{void 0===this.image&&(this.image=null),void 0===this.scaleDistance&&(this.scaleDistance=0),void 0===this.scaleDistanceXStart&&(this.scaleDistanceXStart=0),void 0===this.scaleDistanceYStart&&(this.scaleDistanceYStart=0),void 0===this.scaleDistanceXEnd&&(this.scaleDistanceXEnd=0),void 0===this.scaleDistanceYEnd&&(this.scaleDistanceYEnd=0),void 0===this.xOrigin&&(this.xOrigin=0),void 0===this.yOrigin&&(this.yOrigin=0),void 0===this.invisible&&(this.invisible=!1),this.image=e,this.scaleDistance=t,this.scaleDistanceXStart=i,this.scaleDistanceYStart=n,this.scaleDistanceXEnd=o,this.scaleDistanceYEnd=r,this.xOrigin=l,this.yOrigin=a,this.invisible=!s}}return e.prototype.getImage=function(){return this.image},e.prototype.getScaleDistance=function(){return this.scaleDistance},e.prototype.getScaleDistanceXStart=function(){return this.scaleDistanceXStart},e.prototype.getScaleDistanceYStart=function(){return this.scaleDistanceYStart},e.prototype.getScaleDistanceXEnd=function(){return this.scaleDistanceXEnd},e.prototype.getScaleDistanceYEnd=function(){return this.scaleDistanceYEnd},e.prototype.getScale=function(){return e.getScale(this.scaleDistance,this.scaleDistanceXStart,this.scaleDistanceYStart,this.scaleDistanceXEnd,this.scaleDistanceYEnd)},e.getScale=function(e,t,i,n,o){return e/java.awt.geom.Point2D.distance(t,i,n,o)},e.prototype.getXOrigin=function(){return this.xOrigin},e.prototype.getYOrigin=function(){return this.yOrigin},e.prototype.isVisible=function(){return!this.invisible},e}();BackgroundImage.__class="com.eteks.sweethome3d.model.BackgroundImage";var RecorderException=function(e){function t(t,i){var n=this;if("string"!=typeof t&&null!==t||!(null!=i&&i.__classes&&i.__classes.indexOf("java.lang.Throwable")>=0||null!=i&&i instanceof Error||null===i))if("string"!=typeof t&&null!==t||void 0!==i){if(void 0!==t||void 0!==i)throw new Error("invalid overload");n=e.call(this)||this}else{(n=e.call(this,t)||this).message=t}else{(n=e.call(this,t)||this).message=t}return n}return __extends(t,e),t}(Error);RecorderException.__class="com.eteks.sweethome3d.model.RecorderException";var HomeObject=function(){function e(t){if("string"==typeof t||null===t){if(void 0===this.id&&(this.id=null),void 0===this.properties&&(this.properties=null),void 0===this.propertyChangeSupport&&(this.propertyChangeSupport=null),null==t)throw new IllegalArgumentException("ID must exist");this.id=t}else{if(void 0!==t)throw new Error("invalid overload");var i=e.createId(e.ID_DEFAULT_PREFIX);if(void 0===this.id&&(this.id=null),void 0===this.properties&&(this.properties=null),void 0===this.propertyChangeSupport&&(this.propertyChangeSupport=null),null==i)throw new IllegalArgumentException("ID must exist");this.id=i,void 0===this.id&&(this.id=null),void 0===this.properties&&(this.properties=null),void 0===this.propertyChangeSupport&&(this.propertyChangeSupport=null)}}return e.createId=function(e){return e+"-"+UUID.randomUUID()},e.prototype.addPropertyChangeListener=function(e,t){null==this.propertyChangeSupport&&(this.propertyChangeSupport=new PropertyChangeSupport(this)),void 0===t?this.propertyChangeSupport.addPropertyChangeListener(e):this.propertyChangeSupport.addPropertyChangeListener(e,t)},e.prototype.removePropertyChangeListener=function(e,t){null!=this.propertyChangeSupport&&(void 0===t?this.propertyChangeSupport.removePropertyChangeListener(e):this.propertyChangeSupport.removePropertyChangeListener(e,t),0===this.propertyChangeSupport.getPropertyChangeListeners().length&&(this.propertyChangeSupport=null))},e.prototype.firePropertyChange=function(e,t,i){null!=this.propertyChangeSupport&&this.propertyChangeSupport.firePropertyChange(e,t,i)},e.prototype.getId=function(){return this.id},e.prototype.getProperty=function(e){if(null!=this.properties){var t=void 0===(i=this.properties)[n=e]?null:i[n];if("string"==typeof t)return t}var i,n;return null},e.prototype.getContentProperty=function(e){if(null!=this.properties){var t=void 0===(i=this.properties)[n=e]?null:i[n];if(null!=t&&null!=t.constructor&&null!=t.constructor.__interfaces&&t.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0)return t}var i,n;return null},e.prototype.isContentProperty=function(e){return null!=this.properties&&null!=(void 0===(t=this.properties)[i=e]?null:t[i])&&null!=function(e,t){return void 0===e[t]?null:e[t]}(this.properties,e).constructor&&null!=function(e,t){return void 0===e[t]?null:e[t]}(this.properties,e).constructor.__interfaces&&function(e,t){return void 0===e[t]?null:e[t]}(this.properties,e).constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0;var t,i},e.prototype.setProperty$java_lang_String$java_lang_String=function(e,t){this.setProperty$java_lang_String$java_lang_Object(e,t)},e.prototype.setProperty=function(e,t){if("string"!=typeof e&&null!==e||"string"!=typeof t&&null!==t){if("string"!=typeof e&&null!==e||null==t&&null!==t)throw new Error("invalid overload");return this.setProperty$java_lang_String$java_lang_Object(e,t)}return this.setProperty$java_lang_String$java_lang_String(e,t)},e.prototype.setProperty$java_lang_String$java_lang_Object=function(e,t){var i=this;if(null!=t&&!("string"==typeof t||null!=t&&null!=t.constructor&&null!=t.constructor.__interfaces&&t.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))throw new IllegalArgumentException("Property value can be only a string or a content, not an instance of "+t.constructor);var n,o,r=null!=this.properties?void 0===(n=this.properties)[o=e]?null:n[o]:null;if(null==t){if(null!=this.properties&&null!=r){try{!function(t){var n=i.properties[e];delete i.properties[e]}(this.properties),0===Object.keys(this.properties).length&&(this.properties=null)}catch(e){this.properties=null}this.firePropertyChange(e,r,null)}}else null==this.properties||1===Object.keys(this.properties).length&&null!=r?this.properties=function(e){var i={};return i[e]=t,i}(e):(1===Object.keys(this.properties).length&&(this.properties=function(e){var t={};for(var i in e)t[i]=e[i];return t}(this.properties)),this.properties[e]=t),this.firePropertyChange(e,r,t)},e.prototype.getPropertyNames=function(){return null!=this.properties?Object.keys(this.properties):[]},e.prototype.duplicate=function(){for(var t,i,n=function(e){if(null!=e.clone)return e.clone();var t=Object.create(e);for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t}(this),o=0;o<this.id.length&&(null==(i=t=this.id.charAt(o).toLowerCase()).charCodeAt?i:i.charCodeAt(0))>="a".charCodeAt(0)&&function(e){return null==e.charCodeAt?e:e.charCodeAt(0)}(t)<="z".charCodeAt(0);)o++;var r=o>=0?this.id.substring(0,o):e.ID_DEFAULT_PREFIX;return n.id=e.createId(r),n},e.prototype.clone=function(){var e,t,i=this;try{var n=function(e){var t=Object.create(e);for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t}(this);return null!=this.properties&&(n.properties=1===Object.keys(n.properties).length?function(e){var t,n={};return n[e]=function(e){var t=0;return{next:function(){return t<e.length?e[t++]:null},hasNext:function(){return t<e.length}}}((t=i.properties,Object.keys(t).map((function(e){return t[e]})))).next(),n}((e=Object.keys(this.properties),t=0,{next:function(){return t<e.length?e[t++]:null},hasNext:function(){return t<e.length}}).next()):function(e){var t={};for(var i in e)t[i]=e[i];return t}(this.properties)),n.propertyChangeSupport=null,n}catch(e){throw new IllegalStateException("Super class isn't cloneable")}},e.ID_DEFAULT_PREFIX="object",e}();HomeObject.__class="com.eteks.sweethome3d.model.HomeObject",HomeObject.__transients=["propertyChangeSupport"];var ObjectProperty=function(){function e(t,i,n,o,r,l){if("string"!=typeof t&&null!==t||"string"!=typeof i&&null!==i||"number"!=typeof n&&null!==n||"boolean"!=typeof o&&null!==o||"boolean"!=typeof r&&null!==r||"boolean"!=typeof l&&null!==l)if("string"!=typeof t&&null!==t||"number"!=typeof i&&null!==i||"boolean"!=typeof n&&null!==n||"boolean"!=typeof o&&null!==o||"boolean"!=typeof r&&null!==r||void 0!==l)if("string"!=typeof t&&null!==t||"number"!=typeof i&&null!==i||void 0!==n||void 0!==o||void 0!==r||void 0!==l){if("string"!=typeof t&&null!==t||void 0!==i||void 0!==n||void 0!==o||void 0!==r||void 0!==l)throw new Error("invalid overload");u=arguments;var a=null;void 0===this.name&&(this.name=null),void 0===this.displayedName&&(this.displayedName=null),void 0===this.type&&(this.type=null),void 0===this.typeName&&(this.typeName=null),void 0===this.displayable&&(this.displayable=!1),void 0===this.modifiable&&(this.modifiable=!1),void 0===this.exportable&&(this.exportable=!1),this.name=t,this.displayedName=null,this.type=a,this.typeName=null,this.displayable=!0,this.modifiable=!0,this.exportable=!0,void 0===this.name&&(this.name=null),void 0===this.displayedName&&(this.displayedName=null),void 0===this.type&&(this.type=null),void 0===this.typeName&&(this.typeName=null),void 0===this.displayable&&(this.displayable=!1),void 0===this.modifiable&&(this.modifiable=!1),void 0===this.exportable&&(this.exportable=!1),void 0===this.name&&(this.name=null),void 0===this.displayedName&&(this.displayedName=null),void 0===this.type&&(this.type=null),void 0===this.typeName&&(this.typeName=null),void 0===this.displayable&&(this.displayable=!1),void 0===this.modifiable&&(this.modifiable=!1),void 0===this.exportable&&(this.exportable=!1)}else{var s=(u=arguments)[1];void 0===this.name&&(this.name=null),void 0===this.displayedName&&(this.displayedName=null),void 0===this.type&&(this.type=null),void 0===this.typeName&&(this.typeName=null),void 0===this.displayable&&(this.displayable=!1),void 0===this.modifiable&&(this.modifiable=!1),void 0===this.exportable&&(this.exportable=!1),this.name=t,this.displayedName=null,this.type=s,this.typeName=null!=s?e.Type[s]:null,this.displayable=!0,this.modifiable=!0,this.exportable=!0,void 0===this.name&&(this.name=null),void 0===this.displayedName&&(this.displayedName=null),void 0===this.type&&(this.type=null),void 0===this.typeName&&(this.typeName=null),void 0===this.displayable&&(this.displayable=!1),void 0===this.modifiable&&(this.modifiable=!1),void 0===this.exportable&&(this.exportable=!1)}else{var h=(u=arguments)[1];u[2],u[3],u[4];void 0===this.name&&(this.name=null),void 0===this.displayedName&&(this.displayedName=null),void 0===this.type&&(this.type=null),void 0===this.typeName&&(this.typeName=null),void 0===this.displayable&&(this.displayable=!1),void 0===this.modifiable&&(this.modifiable=!1),void 0===this.exportable&&(this.exportable=!1),this.name=t,this.displayedName=null,this.type=h,this.typeName=null!=h?e.Type[h]:null,this.displayable=!0,this.modifiable=!0,this.exportable=!0,void 0===this.name&&(this.name=null),void 0===this.displayedName&&(this.displayedName=null),void 0===this.type&&(this.type=null),void 0===this.typeName&&(this.typeName=null),void 0===this.displayable&&(this.displayable=!1),void 0===this.modifiable&&(this.modifiable=!1),void 0===this.exportable&&(this.exportable=!1)}else{var u=arguments;void 0===this.name&&(this.name=null),void 0===this.displayedName&&(this.displayedName=null),void 0===this.type&&(this.type=null),void 0===this.typeName&&(this.typeName=null),void 0===this.displayable&&(this.displayable=!1),void 0===this.modifiable&&(this.modifiable=!1),void 0===this.exportable&&(this.exportable=!1),this.name=t,this.displayedName=i,this.type=n,this.typeName=null!=n?e.Type[n]:null,this.displayable=o,this.modifiable=r,this.exportable=l}}return e.fromDescription=function(t){if(0===t.length)throw new IllegalArgumentException("Description empty");var i,n,o,r=t.indexOf(":"),l=t.substring(0,r>0?r:t.length).trim(),a=null,s=!0,h=!0,u=!0,d=null;if(r>0){var c=t.substring(r+1).trim().split(/ /);if(c.length>0){a=e.Type[c[0]];for(var p=1;p<c.length;p++)i=c[p],n="displayable=",void 0===(o=void 0)&&(o=0),i.substr(o,12)===n?s=function(e,t){return"true".toUpperCase()===(null===t?t:t.toUpperCase())}(0,c[p].substring(13)):!function(e,t,i){return void 0===i&&(i=0),e.substr(i,11)===t}(c[p],"modifiable=")?!function(e,t,i){return void 0===i&&(i=0),e.substr(i,11)===t}(c[p],"exportable=")?function(e,t,i){return void 0===i&&(i=0),e.substr(i,14)===t}(c[p],"displayedName=")&&(d=t.substring(t.indexOf("displayedName=")+14)):u=function(e,t){return"true".toUpperCase()===(null===t?t:t.toUpperCase())}(0,c[p].substring(12)):h=function(e,t){return"true".toUpperCase()===(null===t?t:t.toUpperCase())}(0,c[p].substring(12))}}return new e(l,d,a,s,h,u)},e.prototype.getName=function(){return this.name},e.prototype.getType=function(){return this.type},e.prototype.isDisplayable=function(){return this.displayable},e.prototype.isModifiable=function(){return this.modifiable},e.prototype.isExportable=function(){return this.exportable},e.prototype.getDisplayedName=function(){if(null!=this.displayedName)return this.displayedName;var e=this.name.split("_").join(" ").toLowerCase();return e.charAt(0).toUpperCase()+(e.length>1?e.substring(1):"")},e.prototype.hashCode=function(){return null==this.name?0:(e=this.name).hashCode?e.hashCode():e.toString().split("").reduce((function(e,t){return(e<<5)-e+t.charCodeAt(0)|0}),0);var e},e.prototype.equals=function(t){return this===t||null!=t&&t instanceof e&&this.name===t.name},e}();ObjectProperty.__class="com.eteks.sweethome3d.model.ObjectProperty",function(e){var t;(t=e.Type||(e.Type={}))[t.ANY=0]="ANY",t[t.STRING=1]="STRING",t[t.BOOLEAN=2]="BOOLEAN",t[t.INTEGER=3]="INTEGER",t[t.NUMBER=4]="NUMBER",t[t.PRICE=5]="PRICE",t[t.LENGTH=6]="LENGTH",t[t.PERCENTAGE=7]="PERCENTAGE",t[t.DATE=8]="DATE",t[t.CONTENT=9]="CONTENT"}(ObjectProperty||(ObjectProperty={})),ObjectProperty.__transients=["type"];var TexturesCatalog=function(){function e(){this.categories=[],this.texturesChangeSupport=new CollectionChangeSupport(this)}return e.prototype.getCategories=function(){return this.categories.slice(0)},e.prototype.getCategoriesCount=function(){return this.categories.length},e.prototype.getCategory=function(e){return this.categories[e]},e.prototype.addTexturesListener=function(e){var t;this.texturesChangeSupport.addCollectionListener(null==(t=e)||"function"==typeof t?t:function(e){return(t.collectionChanged?t.collectionChanged:t).call(t,e)})},e.prototype.removeTexturesListener=function(e){var t;this.texturesChangeSupport.removeCollectionListener(null==(t=e)||"function"==typeof t?t:function(e){return(t.collectionChanged?t.collectionChanged:t).call(t,e)})},e.prototype.add=function(e,t){var i=function(e,t){for(var i,n,o=0,r=e.length-1;o<=r;){var l=o+r>>>1,a=e[l],s=(n=t,(i=a).compareTo?i.compareTo(n):i.localeCompare(n));if(s<0)o=l+1;else{if(!(s>0))return l;r=l-1}}return-(o+1)}(this.categories,e);i<0?(e=new TexturesCategory(e.getName()),this.categories.splice(-i-1,0,e)):e=this.categories[i],e.add(t),this.texturesChangeSupport.fireCollectionChanged(t,e.getIndexOfTexture(t),CollectionEvent.Type.ADD)},e.prototype.delete=function(e){var t,i,n=e.getCategory();if(null!=n){var o=n.getIndexOfTexture(e);if(o>=0)return n.delete(e),0===n.getTexturesCount()&&(this.categories=this.categories.slice(0),t=this.categories,(i=t.indexOf(n))>=0&&t.splice(i,1)),void this.texturesChangeSupport.fireCollectionChanged(e,o,CollectionEvent.Type.DELETE)}throw new IllegalArgumentException("catalog doesn't contain texture "+e.getName())},e}();TexturesCatalog.__class="com.eteks.sweethome3d.model.TexturesCatalog";var CatalogPieceOfFurniture=function(){function e(t,i,n,o,r,l,a,s,h,u,d,c,p,g,m,f,v,_,S,y,E,C,P,w,L,T,A,I,b,O,M,D,R,F,x,N,k,H){if("string"!=typeof t&&null!==t||"string"!=typeof i&&null!==i||"string"!=typeof n&&null!==n||"string"!=typeof o&&null!==o||"string"!=typeof r&&null!==r||!(null!=l&&l instanceof Array&&(0==l.length||null==l[0]||"string"==typeof l[0])||null===l)||"number"!=typeof a&&null!==a||"number"!=typeof s&&null!==s||!(null!=h&&null!=h.constructor&&null!=h.constructor.__interfaces&&h.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0||null===h)||!(null!=u&&null!=u.constructor&&null!=u.constructor.__interfaces&&u.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0||null===u)||!(null!=d&&null!=d.constructor&&null!=d.constructor.__interfaces&&d.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0||null===d)||"number"!=typeof c&&null!==c||"number"!=typeof p&&null!==p||"number"!=typeof g&&null!==g||"number"!=typeof m&&null!==m||"number"!=typeof f&&null!==f||"boolean"!=typeof v&&null!==v||"boolean"!=typeof _&&null!==_||"string"!=typeof S&&null!==S||"number"!=typeof y&&null!==y||!(null!=E&&E instanceof Array&&(0==E.length||null==E[0]||E[0]instanceof Array)||null===E)||"number"!=typeof C&&null!==C||"number"!=typeof P&&null!==P||"string"!=typeof w&&null!==w||"boolean"!=typeof L&&null!==L||"boolean"!=typeof T&&null!==T||"boolean"!=typeof A&&null!==A||"boolean"!=typeof I&&null!==I||!(null!=b&&b instanceof Big||null===b)||!(null!=O&&O instanceof Big||null===O)||"string"!=typeof M&&null!==M||!(null!=D&&D instanceof Object||null===D)||!(null!=R&&R instanceof Object||null===R)||"number"!=typeof F&&null!==F||"number"!=typeof x&&null!==x||"number"!=typeof N&&null!==N||"boolean"!=typeof k&&null!==k||"boolean"!=typeof H&&null!==H)if("string"!=typeof t&&null!==t||"string"!=typeof i&&null!==i||"string"!=typeof n&&null!==n||"string"!=typeof o&&null!==o||"string"!=typeof r&&null!==r||!(null!=l&&l instanceof Array&&(0==l.length||null==l[0]||"string"==typeof l[0])||null===l)||"number"!=typeof a&&null!==a||"number"!=typeof s&&null!==s||!(null!=h&&null!=h.constructor&&null!=h.constructor.__interfaces&&h.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0||null===h)||!(null!=u&&null!=u.constructor&&null!=u.constructor.__interfaces&&u.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0||null===u)||!(null!=d&&null!=d.constructor&&null!=d.constructor.__interfaces&&d.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0||null===d)||"number"!=typeof c&&null!==c||"number"!=typeof p&&null!==p||"number"!=typeof g&&null!==g||"number"!=typeof m&&null!==m||"number"!=typeof f&&null!==f||"boolean"!=typeof v&&null!==v||"string"!=typeof _&&null!==_||!(null!=S&&S instanceof Array&&(0==S.length||null==S[0]||S[0]instanceof Array)||null===S)||"number"!=typeof y&&null!==y||"number"!=typeof E&&null!==E||"string"!=typeof C&&null!==C||"boolean"!=typeof P&&null!==P||"boolean"!=typeof w&&null!==w||"boolean"!=typeof L&&null!==L||"boolean"!=typeof T&&null!==T||!(null!=A&&A instanceof Big||null===A)||!(null!=I&&I instanceof Big||null===I)||"string"!=typeof b&&null!==b||!(null!=O&&O instanceof Object||null===O)||!(null!=M&&M instanceof Object||null===M)||void 0!==D||void 0!==R||void 0!==F||void 0!==x||void 0!==N||void 0!==k||void 0!==H)if("string"!=typeof t&&null!==t||"string"!=typeof i&&null!==i||"string"!=typeof n&&null!==n||"string"!=typeof o&&null!==o||!(null!=r&&r instanceof Array&&(0==r.length||null==r[0]||"string"==typeof r[0])||null===r)||"number"!=typeof l&&null!==l||"number"!=typeof a&&null!==a||!(null!=s&&null!=s.constructor&&null!=s.constructor.__interfaces&&s.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0||null===s)||!(null!=h&&null!=h.constructor&&null!=h.constructor.__interfaces&&h.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0||null===h)||!(null!=u&&null!=u.constructor&&null!=u.constructor.__interfaces&&u.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0||null===u)||"number"!=typeof d&&null!==d||"number"!=typeof c&&null!==c||"number"!=typeof p&&null!==p||"number"!=typeof g&&null!==g||"number"!=typeof m&&null!==m||"boolean"!=typeof f&&null!==f||"string"!=typeof v&&null!==v||!(null!=_&&_ instanceof Array&&(0==_.length||null==_[0]||_[0]instanceof Array)||null===_)||"boolean"!=typeof S&&null!==S||"number"!=typeof y&&null!==y||"string"!=typeof E&&null!==E||"boolean"!=typeof C&&null!==C||"boolean"!=typeof P&&null!==P||"boolean"!=typeof w&&null!==w||"boolean"!=typeof L&&null!==L||!(null!=T&&T instanceof Big||null===T)||!(null!=A&&A instanceof Big||null===A)||"string"!=typeof I&&null!==I||!(null!=b&&b instanceof Object||null===b)||void 0!==O||void 0!==M||void 0!==D||void 0!==R||void 0!==F||void 0!==x||void 0!==N||void 0!==k||void 0!==H)if("string"!=typeof t&&null!==t||"string"!=typeof i&&null!==i||"string"!=typeof n&&null!==n||"string"!=typeof o&&null!==o||!(null!=r&&r instanceof Array&&(0==r.length||null==r[0]||"string"==typeof r[0])||null===r)||"number"!=typeof l&&null!==l||"number"!=typeof a&&null!==a||!(null!=s&&null!=s.constructor&&null!=s.constructor.__interfaces&&s.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0||null===s)||!(null!=h&&null!=h.constructor&&null!=h.constructor.__interfaces&&h.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0||null===h)||!(null!=u&&null!=u.constructor&&null!=u.constructor.__interfaces&&u.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0||null===u)||"number"!=typeof d&&null!==d||"number"!=typeof c&&null!==c||"number"!=typeof p&&null!==p||"number"!=typeof g&&null!==g||"number"!=typeof m&&null!==m||"boolean"!=typeof f&&null!==f||"string"!=typeof v&&null!==v||!(null!=_&&_ instanceof Array&&(0==_.length||null==_[0]||_[0]instanceof Array)||null===_)||"number"!=typeof S&&null!==S||"number"!=typeof y&&null!==y||"string"!=typeof E&&null!==E||"boolean"!=typeof C&&null!==C||"boolean"!=typeof P&&null!==P||"boolean"!=typeof w&&null!==w||"boolean"!=typeof L&&null!==L||!(null!=T&&T instanceof Big||null===T)||!(null!=A&&A instanceof Big||null===A)||"string"!=typeof I&&null!==I||!(null!=b&&b instanceof Object||null===b)||void 0!==O||void 0!==M||void 0!==D||void 0!==R||void 0!==F||void 0!==x||void 0!==N||void 0!==k||void 0!==H)if("string"!=typeof t&&null!==t||"string"!=typeof i&&null!==i||"string"!=typeof n&&null!==n||"string"!=typeof o&&null!==o||!(null!=r&&r instanceof Array&&(0==r.length||null==r[0]||"string"==typeof r[0])||null===r)||"number"!=typeof l&&null!==l||"number"!=typeof a&&null!==a||!(null!=s&&null!=s.constructor&&null!=s.constructor.__interfaces&&s.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0||null===s)||!(null!=h&&null!=h.constructor&&null!=h.constructor.__interfaces&&h.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0||null===h)||!(null!=u&&null!=u.constructor&&null!=u.constructor.__interfaces&&u.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0||null===u)||"number"!=typeof d&&null!==d||"number"!=typeof c&&null!==c||"number"!=typeof p&&null!==p||"number"!=typeof g&&null!==g||"number"!=typeof m&&null!==m||"boolean"!=typeof f&&null!==f||"string"!=typeof v&&null!==v||!(null!=_&&_ instanceof Array&&(0==_.length||null==_[0]||_[0]instanceof Array)||null===_)||"boolean"!=typeof S&&null!==S||"number"!=typeof y&&null!==y||"string"!=typeof E&&null!==E||"boolean"!=typeof C&&null!==C||"boolean"!=typeof P&&null!==P||"boolean"!=typeof w&&null!==w||"boolean"!=typeof L&&null!==L||!(null!=T&&T instanceof Big||null===T)||!(null!=A&&A instanceof Big||null===A)||"string"!=typeof I&&null!==I||void 0!==b||void 0!==O||void 0!==M||void 0!==D||void 0!==R||void 0!==F||void 0!==x||void 0!==N||void 0!==k||void 0!==H)if("string"!=typeof t&&null!==t||"string"!=typeof i&&null!==i||"string"!=typeof n&&null!==n||"string"!=typeof o&&null!==o||!(null!=r&&r instanceof Array&&(0==r.length||null==r[0]||"string"==typeof r[0])||null===r)||"number"!=typeof l&&null!==l||"number"!=typeof a&&null!==a||!(null!=s&&null!=s.constructor&&null!=s.constructor.__interfaces&&s.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0||null===s)||!(null!=h&&null!=h.constructor&&null!=h.constructor.__interfaces&&h.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0||null===h)||!(null!=u&&null!=u.constructor&&null!=u.constructor.__interfaces&&u.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0||null===u)||"number"!=typeof d&&null!==d||"number"!=typeof c&&null!==c||"number"!=typeof p&&null!==p||"number"!=typeof g&&null!==g||"number"!=typeof m&&null!==m||"boolean"!=typeof f&&null!==f||"string"!=typeof v&&null!==v||!(null!=_&&_ instanceof Array&&(0==_.length||null==_[0]||_[0]instanceof Array)||null===_)||"boolean"!=typeof S&&null!==S||"string"!=typeof y&&null!==y||"boolean"!=typeof E&&null!==E||"boolean"!=typeof C&&null!==C||"boolean"!=typeof P&&null!==P||!(null!=w&&w instanceof Big||null===w)||!(null!=L&&L instanceof Big||null===L)||"string"!=typeof T&&null!==T||void 0!==A||void 0!==I||void 0!==b||void 0!==O||void 0!==M||void 0!==D||void 0!==R||void 0!==F||void 0!==x||void 0!==N||void 0!==k||void 0!==H)if("string"!=typeof t&&null!==t||!(null!=i&&null!=i.constructor&&null!=i.constructor.__interfaces&&i.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0||null===i)||!(null!=n&&null!=n.constructor&&null!=n.constructor.__interfaces&&n.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0||null===n)||"number"!=typeof o&&null!==o||"number"!=typeof r&&null!==r||"number"!=typeof l&&null!==l||"number"!=typeof a&&null!==a||"boolean"!=typeof s&&null!==s||"string"!=typeof h&&null!==h||"number"!=typeof u&&null!==u||!(null!=d&&d instanceof Array&&(0==d.length||null==d[0]||d[0]instanceof Array)||null===d)||"number"!=typeof c&&null!==c||"number"!=typeof p&&null!==p||"string"!=typeof g&&null!==g||"number"!=typeof m&&null!==m||"number"!=typeof f&&null!==f||"number"!=typeof v&&null!==v||"boolean"!=typeof _&&null!==_||void 0!==S||void 0!==y||void 0!==E||void 0!==C||void 0!==P||void 0!==w||void 0!==L||void 0!==T||void 0!==A||void 0!==I||void 0!==b||void 0!==O||void 0!==M||void 0!==D||void 0!==R||void 0!==F||void 0!==x||void 0!==N||void 0!==k||void 0!==H)if("string"!=typeof t&&null!==t||"string"!=typeof i&&null!==i||"string"!=typeof n&&null!==n||!(null!=o&&null!=o.constructor&&null!=o.constructor.__interfaces&&o.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0||null===o)||!(null!=r&&null!=r.constructor&&null!=r.constructor.__interfaces&&r.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0||null===r)||!(null!=l&&null!=l.constructor&&null!=l.constructor.__interfaces&&l.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0||null===l)||"number"!=typeof a&&null!==a||"number"!=typeof s&&null!==s||"number"!=typeof h&&null!==h||"number"!=typeof u&&null!==u||"boolean"!=typeof d&&null!==d||!(null!=c&&c instanceof Array&&(0==c.length||null==c[0]||c[0]instanceof Array)||null===c)||"string"!=typeof p&&null!==p||"boolean"!=typeof g&&null!==g||"boolean"!=typeof m&&null!==m||"boolean"!=typeof f&&null!==f||!(null!=v&&v instanceof Big||null===v)||!(null!=_&&_ instanceof Big||null===_)||void 0!==S||void 0!==y||void 0!==E||void 0!==C||void 0!==P||void 0!==w||void 0!==L||void 0!==T||void 0!==A||void 0!==I||void 0!==b||void 0!==O||void 0!==M||void 0!==D||void 0!==R||void 0!==F||void 0!==x||void 0!==N||void 0!==k||void 0!==H)if("string"!=typeof t&&null!==t||!(null!=i&&null!=i.constructor&&null!=i.constructor.__interfaces&&i.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0||null===i)||!(null!=n&&null!=n.constructor&&null!=n.constructor.__interfaces&&n.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0||null===n)||"number"!=typeof o&&null!==o||"number"!=typeof r&&null!==r||"number"!=typeof l&&null!==l||"number"!=typeof a&&null!==a||"boolean"!=typeof s&&null!==s||"string"!=typeof h&&null!==h||"number"!=typeof u&&null!==u||!(null!=d&&d instanceof Array&&(0==d.length||null==d[0]||d[0]instanceof Array)||null===d)||"boolean"!=typeof c&&null!==c||"number"!=typeof p&&null!==p||"string"!=typeof g&&null!==g||"number"!=typeof m&&null!==m||"boolean"!=typeof f&&null!==f||void 0!==v||void 0!==_||void 0!==S||void 0!==y||void 0!==E||void 0!==C||void 0!==P||void 0!==w||void 0!==L||void 0!==T||void 0!==A||void 0!==I||void 0!==b||void 0!==O||void 0!==M||void 0!==D||void 0!==R||void 0!==F||void 0!==x||void 0!==N||void 0!==k||void 0!==H)if("string"!=typeof t&&null!==t||"string"!=typeof i&&null!==i||"string"!=typeof n&&null!==n||!(null!=o&&null!=o.constructor&&null!=o.constructor.__interfaces&&o.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0||null===o)||!(null!=r&&null!=r.constructor&&null!=r.constructor.__interfaces&&r.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0||null===r)||!(null!=l&&null!=l.constructor&&null!=l.constructor.__interfaces&&l.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0||null===l)||"number"!=typeof a&&null!==a||"number"!=typeof s&&null!==s||"number"!=typeof h&&null!==h||"number"!=typeof u&&null!==u||"boolean"!=typeof d&&null!==d||!(null!=c&&c instanceof Array&&(0==c.length||null==c[0]||c[0]instanceof Array)||null===c)||"string"!=typeof p&&null!==p||"boolean"!=typeof g&&null!==g||!(null!=m&&m instanceof Big||null===m)||!(null!=f&&f instanceof Big||null===f)||void 0!==v||void 0!==_||void 0!==S||void 0!==y||void 0!==E||void 0!==C||void 0!==P||void 0!==w||void 0!==L||void 0!==T||void 0!==A||void 0!==I||void 0!==b||void 0!==O||void 0!==M||void 0!==D||void 0!==R||void 0!==F||void 0!==x||void 0!==N||void 0!==k||void 0!==H){if("string"!=typeof t&&null!==t||"string"!=typeof i&&null!==i||"string"!=typeof n&&null!==n||!(null!=o&&null!=o.constructor&&null!=o.constructor.__interfaces&&o.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0||null===o)||!(null!=r&&null!=r.constructor&&null!=r.constructor.__interfaces&&r.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0||null===r)||"number"!=typeof l&&null!==l||"number"!=typeof a&&null!==a||"number"!=typeof s&&null!==s||"number"!=typeof h&&null!==h||"boolean"!=typeof u&&null!==u||"boolean"!=typeof d&&null!==d||!(null!=c&&c instanceof Array&&(0==c.length||null==c[0]||c[0]instanceof Array)||null===c)||"string"!=typeof p&&null!==p||"boolean"!=typeof g&&null!==g||!(null!=m&&m instanceof Big||null===m)||!(null!=f&&f instanceof Big||null===f)||void 0!==v||void 0!==_||void 0!==S||void 0!==y||void 0!==E||void 0!==C||void 0!==P||void 0!==w||void 0!==L||void 0!==T||void 0!==A||void 0!==I||void 0!==b||void 0!==O||void 0!==M||void 0!==D||void 0!==R||void 0!==F||void 0!==x||void 0!==N||void 0!==k||void 0!==H)throw new Error("invalid overload");Oi=arguments,Oi[4],Oi[5],Oi[6],Oi[7],Oi[8],Oi[9],Oi[10],Oi[11],Oi[12],Oi[13],Oi[14],Oi[15];void 0===this.id&&(this.id=null),void 0===this.name&&(this.name=null),void 0===this.description&&(this.description=null),void 0===this.information&&(this.information=null),void 0===this.license&&(this.license=null),void 0===this.tags&&(this.tags=null),void 0===this.creationDate&&(this.creationDate=null),void 0===this.grade&&(this.grade=null),void 0===this.icon&&(this.icon=null),void 0===this.planIcon&&(this.planIcon=null),void 0===this.model&&(this.model=null),void 0===this.width&&(this.width=0),void 0===this.depth&&(this.depth=0),void 0===this.height&&(this.height=0),void 0===this.proportional&&(this.proportional=!1),void 0===this.elevation&&(this.elevation=0),void 0===this.dropOnTopElevation&&(this.dropOnTopElevation=0),void 0===this.movable&&(this.movable=!1),void 0===this.doorOrWindow&&(this.doorOrWindow=!1),void 0===this.staircaseCutOutShape&&(this.staircaseCutOutShape=null),void 0===this.modelRotation&&(this.modelRotation=null),void 0===this.modelFlags&&(this.modelFlags=0),void 0===this.modelSize&&(this.modelSize=null),void 0===this.creator&&(this.creator=null),void 0===this.color&&(this.color=null),void 0===this.iconYaw&&(this.iconYaw=0),void 0===this.iconPitch&&(this.iconPitch=0),void 0===this.iconScale&&(this.iconScale=0),void 0===this.modifiable&&(this.modifiable=!1),void 0===this.resizable&&(this.resizable=!1),void 0===this.deformable&&(this.deformable=!1),void 0===this.texturable&&(this.texturable=!1),void 0===this.horizontallyRotatable&&(this.horizontallyRotatable=!1),void 0===this.price&&(this.price=null),void 0===this.valueAddedTaxPercentage&&(this.valueAddedTaxPercentage=null),void 0===this.currency&&(this.currency=null),void 0===this.properties&&(this.properties=null),void 0===this.category&&(this.category=null),void 0===this.filterCollationKey&&(this.filterCollationKey=null)}else{Oi=arguments,Oi[4],Oi[5],Oi[6],Oi[7],Oi[8],Oi[9],Oi[10],Oi[11],Oi[12],Oi[13],Oi[14],Oi[15];void 0===this.id&&(this.id=null),void 0===this.name&&(this.name=null),void 0===this.description&&(this.description=null),void 0===this.information&&(this.information=null),void 0===this.license&&(this.license=null),void 0===this.tags&&(this.tags=null),void 0===this.creationDate&&(this.creationDate=null),void 0===this.grade&&(this.grade=null),void 0===this.icon&&(this.icon=null),void 0===this.planIcon&&(this.planIcon=null),void 0===this.model&&(this.model=null),void 0===this.width&&(this.width=0),void 0===this.depth&&(this.depth=0),void 0===this.height&&(this.height=0),void 0===this.proportional&&(this.proportional=!1),void 0===this.elevation&&(this.elevation=0),void 0===this.dropOnTopElevation&&(this.dropOnTopElevation=0),void 0===this.movable&&(this.movable=!1),void 0===this.doorOrWindow&&(this.doorOrWindow=!1),void 0===this.staircaseCutOutShape&&(this.staircaseCutOutShape=null),void 0===this.modelRotation&&(this.modelRotation=null),void 0===this.modelFlags&&(this.modelFlags=0),void 0===this.modelSize&&(this.modelSize=null),void 0===this.creator&&(this.creator=null),void 0===this.color&&(this.color=null),void 0===this.iconYaw&&(this.iconYaw=0),void 0===this.iconPitch&&(this.iconPitch=0),void 0===this.iconScale&&(this.iconScale=0),void 0===this.modifiable&&(this.modifiable=!1),void 0===this.resizable&&(this.resizable=!1),void 0===this.deformable&&(this.deformable=!1),void 0===this.texturable&&(this.texturable=!1),void 0===this.horizontallyRotatable&&(this.horizontallyRotatable=!1),void 0===this.price&&(this.price=null),void 0===this.valueAddedTaxPercentage&&(this.valueAddedTaxPercentage=null),void 0===this.currency&&(this.currency=null),void 0===this.properties&&(this.properties=null),void 0===this.category&&(this.category=null),void 0===this.filterCollationKey&&(this.filterCollationKey=null),void 0===this.id&&(this.id=null),void 0===this.name&&(this.name=null),void 0===this.description&&(this.description=null),void 0===this.information&&(this.information=null),void 0===this.license&&(this.license=null),void 0===this.tags&&(this.tags=null),void 0===this.creationDate&&(this.creationDate=null),void 0===this.grade&&(this.grade=null),void 0===this.icon&&(this.icon=null),void 0===this.planIcon&&(this.planIcon=null),void 0===this.model&&(this.model=null),void 0===this.width&&(this.width=0),void 0===this.depth&&(this.depth=0),void 0===this.height&&(this.height=0),void 0===this.proportional&&(this.proportional=!1),void 0===this.elevation&&(this.elevation=0),void 0===this.dropOnTopElevation&&(this.dropOnTopElevation=0),void 0===this.movable&&(this.movable=!1),void 0===this.doorOrWindow&&(this.doorOrWindow=!1),void 0===this.staircaseCutOutShape&&(this.staircaseCutOutShape=null),void 0===this.modelRotation&&(this.modelRotation=null),void 0===this.modelFlags&&(this.modelFlags=0),void 0===this.modelSize&&(this.modelSize=null),void 0===this.creator&&(this.creator=null),void 0===this.color&&(this.color=null),void 0===this.iconYaw&&(this.iconYaw=0),void 0===this.iconPitch&&(this.iconPitch=0),void 0===this.iconScale&&(this.iconScale=0),void 0===this.modifiable&&(this.modifiable=!1),void 0===this.resizable&&(this.resizable=!1),void 0===this.deformable&&(this.deformable=!1),void 0===this.texturable&&(this.texturable=!1),void 0===this.horizontallyRotatable&&(this.horizontallyRotatable=!1),void 0===this.price&&(this.price=null),void 0===this.valueAddedTaxPercentage&&(this.valueAddedTaxPercentage=null),void 0===this.currency&&(this.currency=null),void 0===this.properties&&(this.properties=null),void 0===this.category&&(this.category=null),void 0===this.filterCollationKey&&(this.filterCollationKey=null)}else{var V=(Oi=arguments)[0],U=Oi[1],W=Oi[2],B=Oi[3],G=Oi[4],Y=Oi[5],$=Oi[6],X=Oi[7],z=Oi[8],j=Oi[9],K=Oi[10],J=(rt=Oi[11],Oi[12]),q=Oi[13],Z=Oi[14],Q=Oi[15],ee=Date.now(),te=rt?PieceOfFurniture.SHOW_BACK_FACE:0,ie=-Math.PI/16;void 0===this.id&&(this.id=null),void 0===this.name&&(this.name=null),void 0===this.description&&(this.description=null),void 0===this.information&&(this.information=null),void 0===this.license&&(this.license=null),void 0===this.tags&&(this.tags=null),void 0===this.creationDate&&(this.creationDate=null),void 0===this.grade&&(this.grade=null),void 0===this.icon&&(this.icon=null),void 0===this.planIcon&&(this.planIcon=null),void 0===this.model&&(this.model=null),void 0===this.width&&(this.width=0),void 0===this.depth&&(this.depth=0),void 0===this.height&&(this.height=0),void 0===this.proportional&&(this.proportional=!1),void 0===this.elevation&&(this.elevation=0),void 0===this.dropOnTopElevation&&(this.dropOnTopElevation=0),void 0===this.movable&&(this.movable=!1),void 0===this.doorOrWindow&&(this.doorOrWindow=!1),void 0===this.staircaseCutOutShape&&(this.staircaseCutOutShape=null),void 0===this.modelRotation&&(this.modelRotation=null),void 0===this.modelFlags&&(this.modelFlags=0),void 0===this.modelSize&&(this.modelSize=null),void 0===this.creator&&(this.creator=null),void 0===this.color&&(this.color=null),void 0===this.iconYaw&&(this.iconYaw=0),void 0===this.iconPitch&&(this.iconPitch=0),void 0===this.iconScale&&(this.iconScale=0),void 0===this.modifiable&&(this.modifiable=!1),void 0===this.resizable&&(this.resizable=!1),void 0===this.deformable&&(this.deformable=!1),void 0===this.texturable&&(this.texturable=!1),void 0===this.horizontallyRotatable&&(this.horizontallyRotatable=!1),void 0===this.price&&(this.price=null),void 0===this.valueAddedTaxPercentage&&(this.valueAddedTaxPercentage=null),void 0===this.currency&&(this.currency=null),void 0===this.properties&&(this.properties=null),void 0===this.category&&(this.category=null),void 0===this.filterCollationKey&&(this.filterCollationKey=null),this.id=null,this.name=V,this.description=null,this.information=null,this.license=null,this.tags=[],this.creationDate=ee,this.grade=null,this.icon=U,this.planIcon=null,this.model=W,this.width=B,this.depth=G,this.height=Y,this.elevation=$,this.dropOnTopElevation=1,this.movable=X,this.doorOrWindow=!1,this.color=j,this.staircaseCutOutShape=z,this.creator=q,this.horizontallyRotatable=!0,this.price=null,this.valueAddedTaxPercentage=null,this.currency=null,this.properties={},this.modelRotation=null==K?PieceOfFurniture.IDENTITY_ROTATION_$LI$():e.deepClone(K),this.modelFlags=te,this.modelSize=J,this.resizable=!0,this.deformable=!0,this.texturable=!0,this.iconYaw=Z,this.iconPitch=ie,this.iconScale=1,this.proportional=Q,this.modifiable=!0,void 0===this.id&&(this.id=null),void 0===this.name&&(this.name=null),void 0===this.description&&(this.description=null),void 0===this.information&&(this.information=null),void 0===this.license&&(this.license=null),void 0===this.tags&&(this.tags=null),void 0===this.creationDate&&(this.creationDate=null),void 0===this.grade&&(this.grade=null),void 0===this.icon&&(this.icon=null),void 0===this.planIcon&&(this.planIcon=null),void 0===this.model&&(this.model=null),void 0===this.width&&(this.width=0),void 0===this.depth&&(this.depth=0),void 0===this.height&&(this.height=0),void 0===this.proportional&&(this.proportional=!1),void 0===this.elevation&&(this.elevation=0),void 0===this.dropOnTopElevation&&(this.dropOnTopElevation=0),void 0===this.movable&&(this.movable=!1),void 0===this.doorOrWindow&&(this.doorOrWindow=!1),void 0===this.staircaseCutOutShape&&(this.staircaseCutOutShape=null),void 0===this.modelRotation&&(this.modelRotation=null),void 0===this.modelFlags&&(this.modelFlags=0),void 0===this.modelSize&&(this.modelSize=null),void 0===this.creator&&(this.creator=null),void 0===this.color&&(this.color=null),void 0===this.iconYaw&&(this.iconYaw=0),void 0===this.iconPitch&&(this.iconPitch=0),void 0===this.iconScale&&(this.iconScale=0),void 0===this.modifiable&&(this.modifiable=!1),void 0===this.resizable&&(this.resizable=!1),void 0===this.deformable&&(this.deformable=!1),void 0===this.texturable&&(this.texturable=!1),void 0===this.horizontallyRotatable&&(this.horizontallyRotatable=!1),void 0===this.price&&(this.price=null),void 0===this.valueAddedTaxPercentage&&(this.valueAddedTaxPercentage=null),void 0===this.currency&&(this.currency=null),void 0===this.properties&&(this.properties=null),void 0===this.category&&(this.category=null),void 0===this.filterCollationKey&&(this.filterCollationKey=null)}else{Oi=arguments,Oi[4],Oi[5],Oi[6],Oi[7],Oi[8],Oi[9],Oi[10],Oi[11],Oi[12],Oi[13],Oi[14],Oi[15],Oi[16],Oi[17];void 0===this.id&&(this.id=null),void 0===this.name&&(this.name=null),void 0===this.description&&(this.description=null),void 0===this.information&&(this.information=null),void 0===this.license&&(this.license=null),void 0===this.tags&&(this.tags=null),void 0===this.creationDate&&(this.creationDate=null),void 0===this.grade&&(this.grade=null),void 0===this.icon&&(this.icon=null),void 0===this.planIcon&&(this.planIcon=null),void 0===this.model&&(this.model=null),void 0===this.width&&(this.width=0),void 0===this.depth&&(this.depth=0),void 0===this.height&&(this.height=0),void 0===this.proportional&&(this.proportional=!1),void 0===this.elevation&&(this.elevation=0),void 0===this.dropOnTopElevation&&(this.dropOnTopElevation=0),void 0===this.movable&&(this.movable=!1),void 0===this.doorOrWindow&&(this.doorOrWindow=!1),void 0===this.staircaseCutOutShape&&(this.staircaseCutOutShape=null),void 0===this.modelRotation&&(this.modelRotation=null),void 0===this.modelFlags&&(this.modelFlags=0),void 0===this.modelSize&&(this.modelSize=null),void 0===this.creator&&(this.creator=null),void 0===this.color&&(this.color=null),void 0===this.iconYaw&&(this.iconYaw=0),void 0===this.iconPitch&&(this.iconPitch=0),void 0===this.iconScale&&(this.iconScale=0),void 0===this.modifiable&&(this.modifiable=!1),void 0===this.resizable&&(this.resizable=!1),void 0===this.deformable&&(this.deformable=!1),void 0===this.texturable&&(this.texturable=!1),void 0===this.horizontallyRotatable&&(this.horizontallyRotatable=!1),void 0===this.price&&(this.price=null),void 0===this.valueAddedTaxPercentage&&(this.valueAddedTaxPercentage=null),void 0===this.currency&&(this.currency=null),void 0===this.properties&&(this.properties=null),void 0===this.category&&(this.category=null),void 0===this.filterCollationKey&&(this.filterCollationKey=null)}else{var ne=(Oi=arguments)[0],oe=Oi[1],re=Oi[2],le=Oi[3],ae=Oi[4],se=Oi[5],he=Oi[6],ue=Oi[7],de=Oi[8],ce=Oi[9],pe=Oi[10],ge=Oi[11],me=Oi[12],fe=Oi[13],ve=Oi[14],_e=Oi[15],Se=Oi[16],ye=Oi[17],Ee=Date.now();void 0===this.id&&(this.id=null),void 0===this.name&&(this.name=null),void 0===this.description&&(this.description=null),void 0===this.information&&(this.information=null),void 0===this.license&&(this.license=null),void 0===this.tags&&(this.tags=null),void 0===this.creationDate&&(this.creationDate=null),void 0===this.grade&&(this.grade=null),void 0===this.icon&&(this.icon=null),void 0===this.planIcon&&(this.planIcon=null),void 0===this.model&&(this.model=null),void 0===this.width&&(this.width=0),void 0===this.depth&&(this.depth=0),void 0===this.height&&(this.height=0),void 0===this.proportional&&(this.proportional=!1),void 0===this.elevation&&(this.elevation=0),void 0===this.dropOnTopElevation&&(this.dropOnTopElevation=0),void 0===this.movable&&(this.movable=!1),void 0===this.doorOrWindow&&(this.doorOrWindow=!1),void 0===this.staircaseCutOutShape&&(this.staircaseCutOutShape=null),void 0===this.modelRotation&&(this.modelRotation=null),void 0===this.modelFlags&&(this.modelFlags=0),void 0===this.modelSize&&(this.modelSize=null),void 0===this.creator&&(this.creator=null),void 0===this.color&&(this.color=null),void 0===this.iconYaw&&(this.iconYaw=0),void 0===this.iconPitch&&(this.iconPitch=0),void 0===this.iconScale&&(this.iconScale=0),void 0===this.modifiable&&(this.modifiable=!1),void 0===this.resizable&&(this.resizable=!1),void 0===this.deformable&&(this.deformable=!1),void 0===this.texturable&&(this.texturable=!1),void 0===this.horizontallyRotatable&&(this.horizontallyRotatable=!1),void 0===this.price&&(this.price=null),void 0===this.valueAddedTaxPercentage&&(this.valueAddedTaxPercentage=null),void 0===this.currency&&(this.currency=null),void 0===this.properties&&(this.properties=null),void 0===this.category&&(this.category=null),void 0===this.filterCollationKey&&(this.filterCollationKey=null),this.id=null,this.name=ne,this.description=null,this.information=null,this.license=null,this.tags=[],this.creationDate=Ee,this.grade=null,this.icon=oe,this.planIcon=null,this.model=re,this.width=le,this.depth=ae,this.height=se,this.elevation=he,this.dropOnTopElevation=1,this.movable=ue,this.doorOrWindow=!1,this.color=ce,this.staircaseCutOutShape=de,this.creator=fe,this.horizontallyRotatable=!0,this.price=null,this.valueAddedTaxPercentage=null,this.currency=null,this.properties={},this.modelRotation=null==pe?PieceOfFurniture.IDENTITY_ROTATION_$LI$():e.deepClone(pe),this.modelFlags=ge,this.modelSize=me,this.resizable=!0,this.deformable=!0,this.texturable=!0,this.iconYaw=ve,this.iconPitch=_e,this.iconScale=Se,this.proportional=ye,this.modifiable=!0,void 0===this.id&&(this.id=null),void 0===this.name&&(this.name=null),void 0===this.description&&(this.description=null),void 0===this.information&&(this.information=null),void 0===this.license&&(this.license=null),void 0===this.tags&&(this.tags=null),void 0===this.creationDate&&(this.creationDate=null),void 0===this.grade&&(this.grade=null),void 0===this.icon&&(this.icon=null),void 0===this.planIcon&&(this.planIcon=null),void 0===this.model&&(this.model=null),void 0===this.width&&(this.width=0),void 0===this.depth&&(this.depth=0),void 0===this.height&&(this.height=0),void 0===this.proportional&&(this.proportional=!1),void 0===this.elevation&&(this.elevation=0),void 0===this.dropOnTopElevation&&(this.dropOnTopElevation=0),void 0===this.movable&&(this.movable=!1),void 0===this.doorOrWindow&&(this.doorOrWindow=!1),void 0===this.staircaseCutOutShape&&(this.staircaseCutOutShape=null),void 0===this.modelRotation&&(this.modelRotation=null),void 0===this.modelFlags&&(this.modelFlags=0),void 0===this.modelSize&&(this.modelSize=null),void 0===this.creator&&(this.creator=null),void 0===this.color&&(this.color=null),void 0===this.iconYaw&&(this.iconYaw=0),void 0===this.iconPitch&&(this.iconPitch=0),void 0===this.iconScale&&(this.iconScale=0),void 0===this.modifiable&&(this.modifiable=!1),void 0===this.resizable&&(this.resizable=!1),void 0===this.deformable&&(this.deformable=!1),void 0===this.texturable&&(this.texturable=!1),void 0===this.horizontallyRotatable&&(this.horizontallyRotatable=!1),void 0===this.price&&(this.price=null),void 0===this.valueAddedTaxPercentage&&(this.valueAddedTaxPercentage=null),void 0===this.currency&&(this.currency=null),void 0===this.properties&&(this.properties=null),void 0===this.category&&(this.category=null),void 0===this.filterCollationKey&&(this.filterCollationKey=null)}else{var Ce=(Oi=arguments)[4],Pe=Oi[5],we=Oi[6],Le=Oi[7],Te=Oi[8],Ae=Oi[9],Ie=Oi[10],be=Oi[11],Oe=Oi[12],Me=Oi[13],De=Oi[14],Re=Oi[15],Fe=Oi[16],xe=Oi[17],Ne=(rt=Oi[18],Oi[19]),ke=Oi[20],He=Oi[21],Ve=Oi[22],Ue=Oi[23],We=Oi[24],Be=Oi[25],Ge=rt?PieceOfFurniture.SHOW_BACK_FACE:0,Ye=Math.PI/8;void 0===this.id&&(this.id=null),void 0===this.name&&(this.name=null),void 0===this.description&&(this.description=null),void 0===this.information&&(this.information=null),void 0===this.license&&(this.license=null),void 0===this.tags&&(this.tags=null),void 0===this.creationDate&&(this.creationDate=null),void 0===this.grade&&(this.grade=null),void 0===this.icon&&(this.icon=null),void 0===this.planIcon&&(this.planIcon=null),void 0===this.model&&(this.model=null),void 0===this.width&&(this.width=0),void 0===this.depth&&(this.depth=0),void 0===this.height&&(this.height=0),void 0===this.proportional&&(this.proportional=!1),void 0===this.elevation&&(this.elevation=0),void 0===this.dropOnTopElevation&&(this.dropOnTopElevation=0),void 0===this.movable&&(this.movable=!1),void 0===this.doorOrWindow&&(this.doorOrWindow=!1),void 0===this.staircaseCutOutShape&&(this.staircaseCutOutShape=null),void 0===this.modelRotation&&(this.modelRotation=null),void 0===this.modelFlags&&(this.modelFlags=0),void 0===this.modelSize&&(this.modelSize=null),void 0===this.creator&&(this.creator=null),void 0===this.color&&(this.color=null),void 0===this.iconYaw&&(this.iconYaw=0),void 0===this.iconPitch&&(this.iconPitch=0),void 0===this.iconScale&&(this.iconScale=0),void 0===this.modifiable&&(this.modifiable=!1),void 0===this.resizable&&(this.resizable=!1),void 0===this.deformable&&(this.deformable=!1),void 0===this.texturable&&(this.texturable=!1),void 0===this.horizontallyRotatable&&(this.horizontallyRotatable=!1),void 0===this.price&&(this.price=null),void 0===this.valueAddedTaxPercentage&&(this.valueAddedTaxPercentage=null),void 0===this.currency&&(this.currency=null),void 0===this.properties&&(this.properties=null),void 0===this.category&&(this.category=null),void 0===this.filterCollationKey&&(this.filterCollationKey=null),this.id=t,this.name=i,this.description=n,this.information=o,this.license=null,this.tags=Ce,this.creationDate=Pe,this.grade=we,this.icon=Le,this.planIcon=Te,this.model=Ae,this.width=Ie,this.depth=be,this.height=Oe,this.elevation=Me,this.dropOnTopElevation=De,this.movable=Re,this.doorOrWindow=!1,this.color=null,this.staircaseCutOutShape=Fe,this.creator=Ne,this.horizontallyRotatable=!0,this.price=Ue,this.valueAddedTaxPercentage=We,this.currency=Be,this.properties={},this.modelRotation=null==xe?PieceOfFurniture.IDENTITY_ROTATION_$LI$():e.deepClone(xe),this.modelFlags=Ge,this.modelSize=null,this.resizable=ke,this.deformable=He,this.texturable=Ve,this.iconYaw=Ye,this.iconPitch=0,this.iconScale=1,this.proportional=!0,this.modifiable=!1,void 0===this.id&&(this.id=null),void 0===this.name&&(this.name=null),void 0===this.description&&(this.description=null),void 0===this.information&&(this.information=null),void 0===this.license&&(this.license=null),void 0===this.tags&&(this.tags=null),void 0===this.creationDate&&(this.creationDate=null),void 0===this.grade&&(this.grade=null),void 0===this.icon&&(this.icon=null),void 0===this.planIcon&&(this.planIcon=null),void 0===this.model&&(this.model=null),void 0===this.width&&(this.width=0),void 0===this.depth&&(this.depth=0),void 0===this.height&&(this.height=0),void 0===this.proportional&&(this.proportional=!1),void 0===this.elevation&&(this.elevation=0),void 0===this.dropOnTopElevation&&(this.dropOnTopElevation=0),void 0===this.movable&&(this.movable=!1),void 0===this.doorOrWindow&&(this.doorOrWindow=!1),void 0===this.staircaseCutOutShape&&(this.staircaseCutOutShape=null),void 0===this.modelRotation&&(this.modelRotation=null),void 0===this.modelFlags&&(this.modelFlags=0),void 0===this.modelSize&&(this.modelSize=null),void 0===this.creator&&(this.creator=null),void 0===this.color&&(this.color=null),void 0===this.iconYaw&&(this.iconYaw=0),void 0===this.iconPitch&&(this.iconPitch=0),void 0===this.iconScale&&(this.iconScale=0),void 0===this.modifiable&&(this.modifiable=!1),void 0===this.resizable&&(this.resizable=!1),void 0===this.deformable&&(this.deformable=!1),void 0===this.texturable&&(this.texturable=!1),void 0===this.horizontallyRotatable&&(this.horizontallyRotatable=!1),void 0===this.price&&(this.price=null),void 0===this.valueAddedTaxPercentage&&(this.valueAddedTaxPercentage=null),void 0===this.currency&&(this.currency=null),void 0===this.properties&&(this.properties=null),void 0===this.category&&(this.category=null),void 0===this.filterCollationKey&&(this.filterCollationKey=null),void 0===this.id&&(this.id=null),void 0===this.name&&(this.name=null),void 0===this.description&&(this.description=null),void 0===this.information&&(this.information=null),void 0===this.license&&(this.license=null),void 0===this.tags&&(this.tags=null),void 0===this.creationDate&&(this.creationDate=null),void 0===this.grade&&(this.grade=null),void 0===this.icon&&(this.icon=null),void 0===this.planIcon&&(this.planIcon=null),void 0===this.model&&(this.model=null),void 0===this.width&&(this.width=0),void 0===this.depth&&(this.depth=0),void 0===this.height&&(this.height=0),void 0===this.proportional&&(this.proportional=!1),void 0===this.elevation&&(this.elevation=0),void 0===this.dropOnTopElevation&&(this.dropOnTopElevation=0),void 0===this.movable&&(this.movable=!1),void 0===this.doorOrWindow&&(this.doorOrWindow=!1),void 0===this.staircaseCutOutShape&&(this.staircaseCutOutShape=null),void 0===this.modelRotation&&(this.modelRotation=null),void 0===this.modelFlags&&(this.modelFlags=0),void 0===this.modelSize&&(this.modelSize=null),void 0===this.creator&&(this.creator=null),void 0===this.color&&(this.color=null),void 0===this.iconYaw&&(this.iconYaw=0),void 0===this.iconPitch&&(this.iconPitch=0),void 0===this.iconScale&&(this.iconScale=0),void 0===this.modifiable&&(this.modifiable=!1),void 0===this.resizable&&(this.resizable=!1),void 0===this.deformable&&(this.deformable=!1),void 0===this.texturable&&(this.texturable=!1),void 0===this.horizontallyRotatable&&(this.horizontallyRotatable=!1),void 0===this.price&&(this.price=null),void 0===this.valueAddedTaxPercentage&&(this.valueAddedTaxPercentage=null),void 0===this.currency&&(this.currency=null),void 0===this.properties&&(this.properties=null),void 0===this.category&&(this.category=null),void 0===this.filterCollationKey&&(this.filterCollationKey=null),void 0===this.id&&(this.id=null),void 0===this.name&&(this.name=null),void 0===this.description&&(this.description=null),void 0===this.information&&(this.information=null),void 0===this.license&&(this.license=null),void 0===this.tags&&(this.tags=null),void 0===this.creationDate&&(this.creationDate=null),void 0===this.grade&&(this.grade=null),void 0===this.icon&&(this.icon=null),void 0===this.planIcon&&(this.planIcon=null),void 0===this.model&&(this.model=null),void 0===this.width&&(this.width=0),void 0===this.depth&&(this.depth=0),void 0===this.height&&(this.height=0),void 0===this.proportional&&(this.proportional=!1),void 0===this.elevation&&(this.elevation=0),void 0===this.dropOnTopElevation&&(this.dropOnTopElevation=0),void 0===this.movable&&(this.movable=!1),void 0===this.doorOrWindow&&(this.doorOrWindow=!1),void 0===this.staircaseCutOutShape&&(this.staircaseCutOutShape=null),void 0===this.modelRotation&&(this.modelRotation=null),void 0===this.modelFlags&&(this.modelFlags=0),void 0===this.modelSize&&(this.modelSize=null),void 0===this.creator&&(this.creator=null),void 0===this.color&&(this.color=null),void 0===this.iconYaw&&(this.iconYaw=0),void 0===this.iconPitch&&(this.iconPitch=0),void 0===this.iconScale&&(this.iconScale=0),void 0===this.modifiable&&(this.modifiable=!1),void 0===this.resizable&&(this.resizable=!1),void 0===this.deformable&&(this.deformable=!1),void 0===this.texturable&&(this.texturable=!1),void 0===this.horizontallyRotatable&&(this.horizontallyRotatable=!1),void 0===this.price&&(this.price=null),void 0===this.valueAddedTaxPercentage&&(this.valueAddedTaxPercentage=null),void 0===this.currency&&(this.currency=null),void 0===this.properties&&(this.properties=null),void 0===this.category&&(this.category=null),void 0===this.filterCollationKey&&(this.filterCollationKey=null),void 0===this.id&&(this.id=null),void 0===this.name&&(this.name=null),void 0===this.description&&(this.description=null),void 0===this.information&&(this.information=null),void 0===this.license&&(this.license=null),void 0===this.tags&&(this.tags=null),void 0===this.creationDate&&(this.creationDate=null),void 0===this.grade&&(this.grade=null),void 0===this.icon&&(this.icon=null),void 0===this.planIcon&&(this.planIcon=null),void 0===this.model&&(this.model=null),void 0===this.width&&(this.width=0),void 0===this.depth&&(this.depth=0),void 0===this.height&&(this.height=0),void 0===this.proportional&&(this.proportional=!1),void 0===this.elevation&&(this.elevation=0),void 0===this.dropOnTopElevation&&(this.dropOnTopElevation=0),void 0===this.movable&&(this.movable=!1),void 0===this.doorOrWindow&&(this.doorOrWindow=!1),void 0===this.staircaseCutOutShape&&(this.staircaseCutOutShape=null),void 0===this.modelRotation&&(this.modelRotation=null),void 0===this.modelFlags&&(this.modelFlags=0),void 0===this.modelSize&&(this.modelSize=null),void 0===this.creator&&(this.creator=null),void 0===this.color&&(this.color=null),void 0===this.iconYaw&&(this.iconYaw=0),void 0===this.iconPitch&&(this.iconPitch=0),void 0===this.iconScale&&(this.iconScale=0),void 0===this.modifiable&&(this.modifiable=!1),void 0===this.resizable&&(this.resizable=!1),void 0===this.deformable&&(this.deformable=!1),void 0===this.texturable&&(this.texturable=!1),void 0===this.horizontallyRotatable&&(this.horizontallyRotatable=!1),void 0===this.price&&(this.price=null),void 0===this.valueAddedTaxPercentage&&(this.valueAddedTaxPercentage=null),void 0===this.currency&&(this.currency=null),void 0===this.properties&&(this.properties=null),void 0===this.category&&(this.category=null),void 0===this.filterCollationKey&&(this.filterCollationKey=null),void 0===this.id&&(this.id=null),void 0===this.name&&(this.name=null),void 0===this.description&&(this.description=null),void 0===this.information&&(this.information=null),void 0===this.license&&(this.license=null),void 0===this.tags&&(this.tags=null),void 0===this.creationDate&&(this.creationDate=null),void 0===this.grade&&(this.grade=null),void 0===this.icon&&(this.icon=null),void 0===this.planIcon&&(this.planIcon=null),void 0===this.model&&(this.model=null),void 0===this.width&&(this.width=0),void 0===this.depth&&(this.depth=0),void 0===this.height&&(this.height=0),void 0===this.proportional&&(this.proportional=!1),void 0===this.elevation&&(this.elevation=0),void 0===this.dropOnTopElevation&&(this.dropOnTopElevation=0),void 0===this.movable&&(this.movable=!1),void 0===this.doorOrWindow&&(this.doorOrWindow=!1),void 0===this.staircaseCutOutShape&&(this.staircaseCutOutShape=null),void 0===this.modelRotation&&(this.modelRotation=null),void 0===this.modelFlags&&(this.modelFlags=0),void 0===this.modelSize&&(this.modelSize=null),void 0===this.creator&&(this.creator=null),void 0===this.color&&(this.color=null),void 0===this.iconYaw&&(this.iconYaw=0),void 0===this.iconPitch&&(this.iconPitch=0),void 0===this.iconScale&&(this.iconScale=0),void 0===this.modifiable&&(this.modifiable=!1),void 0===this.resizable&&(this.resizable=!1),void 0===this.deformable&&(this.deformable=!1),void 0===this.texturable&&(this.texturable=!1),void 0===this.horizontallyRotatable&&(this.horizontallyRotatable=!1),void 0===this.price&&(this.price=null),void 0===this.valueAddedTaxPercentage&&(this.valueAddedTaxPercentage=null),void 0===this.currency&&(this.currency=null),void 0===this.properties&&(this.properties=null),void 0===this.category&&(this.category=null),void 0===this.filterCollationKey&&(this.filterCollationKey=null)}else{var $e=(Oi=arguments)[4],Xe=Oi[5],ze=Oi[6],je=Oi[7],Ke=Oi[8],Je=Oi[9],qe=Oi[10],Ze=Oi[11],Qe=Oi[12],et=Oi[13],tt=Oi[14],it=Oi[15],nt=Oi[16],ot=Oi[17],rt=Oi[18],lt=Oi[19],at=Oi[20],st=Oi[21],ht=Oi[22],ut=Oi[23],dt=Oi[24],ct=Oi[25],pt=Oi[26],gt=Oi[27],mt=rt?PieceOfFurniture.SHOW_BACK_FACE:0,ft=Math.PI/8;void 0===this.id&&(this.id=null),void 0===this.name&&(this.name=null),void 0===this.description&&(this.description=null),void 0===this.information&&(this.information=null),void 0===this.license&&(this.license=null),void 0===this.tags&&(this.tags=null),void 0===this.creationDate&&(this.creationDate=null),void 0===this.grade&&(this.grade=null),void 0===this.icon&&(this.icon=null),void 0===this.planIcon&&(this.planIcon=null),void 0===this.model&&(this.model=null),void 0===this.width&&(this.width=0),void 0===this.depth&&(this.depth=0),void 0===this.height&&(this.height=0),void 0===this.proportional&&(this.proportional=!1),void 0===this.elevation&&(this.elevation=0),void 0===this.dropOnTopElevation&&(this.dropOnTopElevation=0),void 0===this.movable&&(this.movable=!1),void 0===this.doorOrWindow&&(this.doorOrWindow=!1),void 0===this.staircaseCutOutShape&&(this.staircaseCutOutShape=null),void 0===this.modelRotation&&(this.modelRotation=null),void 0===this.modelFlags&&(this.modelFlags=0),void 0===this.modelSize&&(this.modelSize=null),void 0===this.creator&&(this.creator=null),void 0===this.color&&(this.color=null),void 0===this.iconYaw&&(this.iconYaw=0),void 0===this.iconPitch&&(this.iconPitch=0),void 0===this.iconScale&&(this.iconScale=0),void 0===this.modifiable&&(this.modifiable=!1),void 0===this.resizable&&(this.resizable=!1),void 0===this.deformable&&(this.deformable=!1),void 0===this.texturable&&(this.texturable=!1),void 0===this.horizontallyRotatable&&(this.horizontallyRotatable=!1),void 0===this.price&&(this.price=null),void 0===this.valueAddedTaxPercentage&&(this.valueAddedTaxPercentage=null),void 0===this.currency&&(this.currency=null),void 0===this.properties&&(this.properties=null),void 0===this.category&&(this.category=null),void 0===this.filterCollationKey&&(this.filterCollationKey=null),this.id=t,this.name=i,this.description=n,this.information=o,this.license=null,this.tags=$e,this.creationDate=Xe,this.grade=ze,this.icon=je,this.planIcon=Ke,this.model=Je,this.width=qe,this.depth=Ze,this.height=Qe,this.elevation=et,this.dropOnTopElevation=tt,this.movable=it,this.doorOrWindow=!1,this.color=null,this.staircaseCutOutShape=nt,this.creator=at,this.horizontallyRotatable=dt,this.price=ct,this.valueAddedTaxPercentage=pt,this.currency=gt,this.properties={},this.modelRotation=null==ot?PieceOfFurniture.IDENTITY_ROTATION_$LI$():e.deepClone(ot),this.modelFlags=mt,this.modelSize=lt,this.resizable=st,this.deformable=ht,this.texturable=ut,this.iconYaw=ft,this.iconPitch=0,this.iconScale=1,this.proportional=!0,this.modifiable=!1,void 0===this.id&&(this.id=null),void 0===this.name&&(this.name=null),void 0===this.description&&(this.description=null),void 0===this.information&&(this.information=null),void 0===this.license&&(this.license=null),void 0===this.tags&&(this.tags=null),void 0===this.creationDate&&(this.creationDate=null),void 0===this.grade&&(this.grade=null),void 0===this.icon&&(this.icon=null),void 0===this.planIcon&&(this.planIcon=null),void 0===this.model&&(this.model=null),void 0===this.width&&(this.width=0),void 0===this.depth&&(this.depth=0),void 0===this.height&&(this.height=0),void 0===this.proportional&&(this.proportional=!1),void 0===this.elevation&&(this.elevation=0),void 0===this.dropOnTopElevation&&(this.dropOnTopElevation=0),void 0===this.movable&&(this.movable=!1),void 0===this.doorOrWindow&&(this.doorOrWindow=!1),void 0===this.staircaseCutOutShape&&(this.staircaseCutOutShape=null),void 0===this.modelRotation&&(this.modelRotation=null),void 0===this.modelFlags&&(this.modelFlags=0),void 0===this.modelSize&&(this.modelSize=null),void 0===this.creator&&(this.creator=null),void 0===this.color&&(this.color=null),void 0===this.iconYaw&&(this.iconYaw=0),void 0===this.iconPitch&&(this.iconPitch=0),void 0===this.iconScale&&(this.iconScale=0),void 0===this.modifiable&&(this.modifiable=!1),void 0===this.resizable&&(this.resizable=!1),void 0===this.deformable&&(this.deformable=!1),void 0===this.texturable&&(this.texturable=!1),void 0===this.horizontallyRotatable&&(this.horizontallyRotatable=!1),void 0===this.price&&(this.price=null),void 0===this.valueAddedTaxPercentage&&(this.valueAddedTaxPercentage=null),void 0===this.currency&&(this.currency=null),void 0===this.properties&&(this.properties=null),void 0===this.category&&(this.category=null),void 0===this.filterCollationKey&&(this.filterCollationKey=null),void 0===this.id&&(this.id=null),void 0===this.name&&(this.name=null),void 0===this.description&&(this.description=null),void 0===this.information&&(this.information=null),void 0===this.license&&(this.license=null),void 0===this.tags&&(this.tags=null),void 0===this.creationDate&&(this.creationDate=null),void 0===this.grade&&(this.grade=null),void 0===this.icon&&(this.icon=null),void 0===this.planIcon&&(this.planIcon=null),void 0===this.model&&(this.model=null),void 0===this.width&&(this.width=0),void 0===this.depth&&(this.depth=0),void 0===this.height&&(this.height=0),void 0===this.proportional&&(this.proportional=!1),void 0===this.elevation&&(this.elevation=0),void 0===this.dropOnTopElevation&&(this.dropOnTopElevation=0),void 0===this.movable&&(this.movable=!1),void 0===this.doorOrWindow&&(this.doorOrWindow=!1),void 0===this.staircaseCutOutShape&&(this.staircaseCutOutShape=null),void 0===this.modelRotation&&(this.modelRotation=null),void 0===this.modelFlags&&(this.modelFlags=0),void 0===this.modelSize&&(this.modelSize=null),void 0===this.creator&&(this.creator=null),void 0===this.color&&(this.color=null),void 0===this.iconYaw&&(this.iconYaw=0),void 0===this.iconPitch&&(this.iconPitch=0),void 0===this.iconScale&&(this.iconScale=0),void 0===this.modifiable&&(this.modifiable=!1),void 0===this.resizable&&(this.resizable=!1),void 0===this.deformable&&(this.deformable=!1),void 0===this.texturable&&(this.texturable=!1),void 0===this.horizontallyRotatable&&(this.horizontallyRotatable=!1),void 0===this.price&&(this.price=null),void 0===this.valueAddedTaxPercentage&&(this.valueAddedTaxPercentage=null),void 0===this.currency&&(this.currency=null),void 0===this.properties&&(this.properties=null),void 0===this.category&&(this.category=null),void 0===this.filterCollationKey&&(this.filterCollationKey=null),void 0===this.id&&(this.id=null),void 0===this.name&&(this.name=null),void 0===this.description&&(this.description=null),void 0===this.information&&(this.information=null),void 0===this.license&&(this.license=null),void 0===this.tags&&(this.tags=null),void 0===this.creationDate&&(this.creationDate=null),void 0===this.grade&&(this.grade=null),void 0===this.icon&&(this.icon=null),void 0===this.planIcon&&(this.planIcon=null),void 0===this.model&&(this.model=null),void 0===this.width&&(this.width=0),void 0===this.depth&&(this.depth=0),void 0===this.height&&(this.height=0),void 0===this.proportional&&(this.proportional=!1),void 0===this.elevation&&(this.elevation=0),void 0===this.dropOnTopElevation&&(this.dropOnTopElevation=0),void 0===this.movable&&(this.movable=!1),void 0===this.doorOrWindow&&(this.doorOrWindow=!1),void 0===this.staircaseCutOutShape&&(this.staircaseCutOutShape=null),void 0===this.modelRotation&&(this.modelRotation=null),void 0===this.modelFlags&&(this.modelFlags=0),void 0===this.modelSize&&(this.modelSize=null),void 0===this.creator&&(this.creator=null),void 0===this.color&&(this.color=null),void 0===this.iconYaw&&(this.iconYaw=0),void 0===this.iconPitch&&(this.iconPitch=0),void 0===this.iconScale&&(this.iconScale=0),void 0===this.modifiable&&(this.modifiable=!1),void 0===this.resizable&&(this.resizable=!1),void 0===this.deformable&&(this.deformable=!1),void 0===this.texturable&&(this.texturable=!1),void 0===this.horizontallyRotatable&&(this.horizontallyRotatable=!1),void 0===this.price&&(this.price=null),void 0===this.valueAddedTaxPercentage&&(this.valueAddedTaxPercentage=null),void 0===this.currency&&(this.currency=null),void 0===this.properties&&(this.properties=null),void 0===this.category&&(this.category=null),void 0===this.filterCollationKey&&(this.filterCollationKey=null),void 0===this.id&&(this.id=null),void 0===this.name&&(this.name=null),void 0===this.description&&(this.description=null),void 0===this.information&&(this.information=null),void 0===this.license&&(this.license=null),void 0===this.tags&&(this.tags=null),void 0===this.creationDate&&(this.creationDate=null),void 0===this.grade&&(this.grade=null),void 0===this.icon&&(this.icon=null),void 0===this.planIcon&&(this.planIcon=null),void 0===this.model&&(this.model=null),void 0===this.width&&(this.width=0),void 0===this.depth&&(this.depth=0),void 0===this.height&&(this.height=0),void 0===this.proportional&&(this.proportional=!1),void 0===this.elevation&&(this.elevation=0),void 0===this.dropOnTopElevation&&(this.dropOnTopElevation=0),void 0===this.movable&&(this.movable=!1),void 0===this.doorOrWindow&&(this.doorOrWindow=!1),void 0===this.staircaseCutOutShape&&(this.staircaseCutOutShape=null),void 0===this.modelRotation&&(this.modelRotation=null),void 0===this.modelFlags&&(this.modelFlags=0),void 0===this.modelSize&&(this.modelSize=null),void 0===this.creator&&(this.creator=null),void 0===this.color&&(this.color=null),void 0===this.iconYaw&&(this.iconYaw=0),void 0===this.iconPitch&&(this.iconPitch=0),void 0===this.iconScale&&(this.iconScale=0),void 0===this.modifiable&&(this.modifiable=!1),void 0===this.resizable&&(this.resizable=!1),void 0===this.deformable&&(this.deformable=!1),void 0===this.texturable&&(this.texturable=!1),void 0===this.horizontallyRotatable&&(this.horizontallyRotatable=!1),void 0===this.price&&(this.price=null),void 0===this.valueAddedTaxPercentage&&(this.valueAddedTaxPercentage=null),void 0===this.currency&&(this.currency=null),void 0===this.properties&&(this.properties=null),void 0===this.category&&(this.category=null),void 0===this.filterCollationKey&&(this.filterCollationKey=null)}else{var vt=(Oi=arguments)[4],_t=Oi[5],St=Oi[6],yt=Oi[7],Et=Oi[8],Ct=Oi[9],Pt=Oi[10],wt=Oi[11],Lt=Oi[12],Tt=Oi[13],At=Oi[14],It=Oi[15],bt=Oi[16],Ot=Oi[17],Mt=Oi[18],Dt=Oi[19],Rt=Oi[20],Ft=Oi[21],xt=Oi[22],Nt=Oi[23],kt=Oi[24],Ht=Oi[25],Vt=Oi[26],Ut=Oi[27],Wt=Oi[28],Bt=Math.PI/8;void 0===this.id&&(this.id=null),void 0===this.name&&(this.name=null),void 0===this.description&&(this.description=null),void 0===this.information&&(this.information=null),void 0===this.license&&(this.license=null),void 0===this.tags&&(this.tags=null),void 0===this.creationDate&&(this.creationDate=null),void 0===this.grade&&(this.grade=null),void 0===this.icon&&(this.icon=null),void 0===this.planIcon&&(this.planIcon=null),void 0===this.model&&(this.model=null),void 0===this.width&&(this.width=0),void 0===this.depth&&(this.depth=0),void 0===this.height&&(this.height=0),void 0===this.proportional&&(this.proportional=!1),void 0===this.elevation&&(this.elevation=0),void 0===this.dropOnTopElevation&&(this.dropOnTopElevation=0),void 0===this.movable&&(this.movable=!1),void 0===this.doorOrWindow&&(this.doorOrWindow=!1),void 0===this.staircaseCutOutShape&&(this.staircaseCutOutShape=null),void 0===this.modelRotation&&(this.modelRotation=null),void 0===this.modelFlags&&(this.modelFlags=0),void 0===this.modelSize&&(this.modelSize=null),void 0===this.creator&&(this.creator=null),void 0===this.color&&(this.color=null),void 0===this.iconYaw&&(this.iconYaw=0),void 0===this.iconPitch&&(this.iconPitch=0),void 0===this.iconScale&&(this.iconScale=0),void 0===this.modifiable&&(this.modifiable=!1),void 0===this.resizable&&(this.resizable=!1),void 0===this.deformable&&(this.deformable=!1),void 0===this.texturable&&(this.texturable=!1),void 0===this.horizontallyRotatable&&(this.horizontallyRotatable=!1),void 0===this.price&&(this.price=null),void 0===this.valueAddedTaxPercentage&&(this.valueAddedTaxPercentage=null),void 0===this.currency&&(this.currency=null),void 0===this.properties&&(this.properties=null),void 0===this.category&&(this.category=null),void 0===this.filterCollationKey&&(this.filterCollationKey=null),this.id=t,this.name=i,this.description=n,this.information=o,this.license=null,this.tags=vt,this.creationDate=_t,this.grade=St,this.icon=yt,this.planIcon=Et,this.model=Ct,this.width=Pt,this.depth=wt,this.height=Lt,this.elevation=Tt,this.dropOnTopElevation=At,this.movable=It,this.doorOrWindow=!1,this.color=null,this.staircaseCutOutShape=bt,this.creator=Rt,this.horizontallyRotatable=kt,this.price=Ht,this.valueAddedTaxPercentage=Vt,this.currency=Ut,null==Wt||0===Object.keys(Wt).length?this.properties={}:1===Object.keys(Wt).length?this.properties=function(e){var t,i={};return i[e]=function(e){var t=0;return{next:function(){return t<e.length?e[t++]:null},hasNext:function(){return t<e.length}}}((t=Wt,Object.keys(t).map((function(e){return t[e]})))).next(),i}(function(e){var t=0;return{next:function(){return t<e.length?e[t++]:null},hasNext:function(){return t<e.length}}}(Object.keys(Wt)).next()):this.properties=function(e){var t={};for(var i in e)t[i]=e[i];return t}(Wt),this.modelRotation=null==Ot?PieceOfFurniture.IDENTITY_ROTATION_$LI$():e.deepClone(Ot),this.modelFlags=Mt,this.modelSize=Dt,this.resizable=Ft,this.deformable=xt,this.texturable=Nt,this.iconYaw=Bt,this.iconPitch=0,this.iconScale=1,this.proportional=!0,this.modifiable=!1,void 0===this.id&&(this.id=null),void 0===this.name&&(this.name=null),void 0===this.description&&(this.description=null),void 0===this.information&&(this.information=null),void 0===this.license&&(this.license=null),void 0===this.tags&&(this.tags=null),void 0===this.creationDate&&(this.creationDate=null),void 0===this.grade&&(this.grade=null),void 0===this.icon&&(this.icon=null),void 0===this.planIcon&&(this.planIcon=null),void 0===this.model&&(this.model=null),void 0===this.width&&(this.width=0),void 0===this.depth&&(this.depth=0),void 0===this.height&&(this.height=0),void 0===this.proportional&&(this.proportional=!1),void 0===this.elevation&&(this.elevation=0),void 0===this.dropOnTopElevation&&(this.dropOnTopElevation=0),void 0===this.movable&&(this.movable=!1),void 0===this.doorOrWindow&&(this.doorOrWindow=!1),void 0===this.staircaseCutOutShape&&(this.staircaseCutOutShape=null),void 0===this.modelRotation&&(this.modelRotation=null),void 0===this.modelFlags&&(this.modelFlags=0),void 0===this.modelSize&&(this.modelSize=null),void 0===this.creator&&(this.creator=null),void 0===this.color&&(this.color=null),void 0===this.iconYaw&&(this.iconYaw=0),void 0===this.iconPitch&&(this.iconPitch=0),void 0===this.iconScale&&(this.iconScale=0),void 0===this.modifiable&&(this.modifiable=!1),void 0===this.resizable&&(this.resizable=!1),void 0===this.deformable&&(this.deformable=!1),void 0===this.texturable&&(this.texturable=!1),void 0===this.horizontallyRotatable&&(this.horizontallyRotatable=!1),void 0===this.price&&(this.price=null),void 0===this.valueAddedTaxPercentage&&(this.valueAddedTaxPercentage=null),void 0===this.currency&&(this.currency=null),void 0===this.properties&&(this.properties=null),void 0===this.category&&(this.category=null),void 0===this.filterCollationKey&&(this.filterCollationKey=null),void 0===this.id&&(this.id=null),void 0===this.name&&(this.name=null),void 0===this.description&&(this.description=null),void 0===this.information&&(this.information=null),void 0===this.license&&(this.license=null),void 0===this.tags&&(this.tags=null),void 0===this.creationDate&&(this.creationDate=null),void 0===this.grade&&(this.grade=null),void 0===this.icon&&(this.icon=null),void 0===this.planIcon&&(this.planIcon=null),void 0===this.model&&(this.model=null),void 0===this.width&&(this.width=0),void 0===this.depth&&(this.depth=0),void 0===this.height&&(this.height=0),void 0===this.proportional&&(this.proportional=!1),void 0===this.elevation&&(this.elevation=0),void 0===this.dropOnTopElevation&&(this.dropOnTopElevation=0),void 0===this.movable&&(this.movable=!1),void 0===this.doorOrWindow&&(this.doorOrWindow=!1),void 0===this.staircaseCutOutShape&&(this.staircaseCutOutShape=null),void 0===this.modelRotation&&(this.modelRotation=null),void 0===this.modelFlags&&(this.modelFlags=0),void 0===this.modelSize&&(this.modelSize=null),void 0===this.creator&&(this.creator=null),void 0===this.color&&(this.color=null),void 0===this.iconYaw&&(this.iconYaw=0),void 0===this.iconPitch&&(this.iconPitch=0),void 0===this.iconScale&&(this.iconScale=0),void 0===this.modifiable&&(this.modifiable=!1),void 0===this.resizable&&(this.resizable=!1),void 0===this.deformable&&(this.deformable=!1),void 0===this.texturable&&(this.texturable=!1),void 0===this.horizontallyRotatable&&(this.horizontallyRotatable=!1),void 0===this.price&&(this.price=null),void 0===this.valueAddedTaxPercentage&&(this.valueAddedTaxPercentage=null),void 0===this.currency&&(this.currency=null),void 0===this.properties&&(this.properties=null),void 0===this.category&&(this.category=null),void 0===this.filterCollationKey&&(this.filterCollationKey=null)}else{var Gt=(Oi=arguments)[4],Yt=Oi[5],$t=Oi[6],Xt=Oi[7],zt=Oi[8],jt=Oi[9],Kt=Oi[10],Jt=Oi[11],qt=Oi[12],Zt=Oi[13],Qt=Oi[14],ei=Oi[15],ti=Oi[16],ii=Oi[17],rt=Oi[18],ni=Oi[19],oi=Oi[20],ri=Oi[21],li=Oi[22],ai=Oi[23],si=Oi[24],hi=Oi[25],ui=Oi[26],di=Oi[27],ci=Oi[28],pi=rt?PieceOfFurniture.SHOW_BACK_FACE:0,gi=Math.PI/8;void 0===this.id&&(this.id=null),void 0===this.name&&(this.name=null),void 0===this.description&&(this.description=null),void 0===this.information&&(this.information=null),void 0===this.license&&(this.license=null),void 0===this.tags&&(this.tags=null),void 0===this.creationDate&&(this.creationDate=null),void 0===this.grade&&(this.grade=null),void 0===this.icon&&(this.icon=null),void 0===this.planIcon&&(this.planIcon=null),void 0===this.model&&(this.model=null),void 0===this.width&&(this.width=0),void 0===this.depth&&(this.depth=0),void 0===this.height&&(this.height=0),void 0===this.proportional&&(this.proportional=!1),void 0===this.elevation&&(this.elevation=0),void 0===this.dropOnTopElevation&&(this.dropOnTopElevation=0),void 0===this.movable&&(this.movable=!1),void 0===this.doorOrWindow&&(this.doorOrWindow=!1),void 0===this.staircaseCutOutShape&&(this.staircaseCutOutShape=null),void 0===this.modelRotation&&(this.modelRotation=null),void 0===this.modelFlags&&(this.modelFlags=0),void 0===this.modelSize&&(this.modelSize=null),void 0===this.creator&&(this.creator=null),void 0===this.color&&(this.color=null),void 0===this.iconYaw&&(this.iconYaw=0),void 0===this.iconPitch&&(this.iconPitch=0),void 0===this.iconScale&&(this.iconScale=0),void 0===this.modifiable&&(this.modifiable=!1),void 0===this.resizable&&(this.resizable=!1),void 0===this.deformable&&(this.deformable=!1),void 0===this.texturable&&(this.texturable=!1),void 0===this.horizontallyRotatable&&(this.horizontallyRotatable=!1),void 0===this.price&&(this.price=null),void 0===this.valueAddedTaxPercentage&&(this.valueAddedTaxPercentage=null),void 0===this.currency&&(this.currency=null),void 0===this.properties&&(this.properties=null),void 0===this.category&&(this.category=null),void 0===this.filterCollationKey&&(this.filterCollationKey=null),this.id=t,this.name=i,this.description=n,this.information=o,this.license=null,this.tags=Gt,this.creationDate=Yt,this.grade=$t,this.icon=Xt,this.planIcon=zt,this.model=jt,this.width=Kt,this.depth=Jt,this.height=qt,this.elevation=Zt,this.dropOnTopElevation=Qt,this.movable=ei,this.doorOrWindow=!1,this.color=null,this.staircaseCutOutShape=ti,this.creator=oi,this.horizontallyRotatable=si,this.price=hi,this.valueAddedTaxPercentage=ui,this.currency=di,null==ci||0===Object.keys(ci).length?this.properties={}:1===Object.keys(ci).length?this.properties=function(e){var t,i={};return i[e]=function(e){var t=0;return{next:function(){return t<e.length?e[t++]:null},hasNext:function(){return t<e.length}}}((t=ci,Object.keys(t).map((function(e){return t[e]})))).next(),i}(function(e){var t=0;return{next:function(){return t<e.length?e[t++]:null},hasNext:function(){return t<e.length}}}(Object.keys(ci)).next()):this.properties=function(e){var t={};for(var i in e)t[i]=e[i];return t}(ci),this.modelRotation=null==ii?PieceOfFurniture.IDENTITY_ROTATION_$LI$():e.deepClone(ii),this.modelFlags=pi,this.modelSize=ni,this.resizable=ri,this.deformable=li,this.texturable=ai,this.iconYaw=gi,this.iconPitch=0,this.iconScale=1,this.proportional=!0,this.modifiable=!1,void 0===this.id&&(this.id=null),void 0===this.name&&(this.name=null),void 0===this.description&&(this.description=null),void 0===this.information&&(this.information=null),void 0===this.license&&(this.license=null),void 0===this.tags&&(this.tags=null),void 0===this.creationDate&&(this.creationDate=null),void 0===this.grade&&(this.grade=null),void 0===this.icon&&(this.icon=null),void 0===this.planIcon&&(this.planIcon=null),void 0===this.model&&(this.model=null),void 0===this.width&&(this.width=0),void 0===this.depth&&(this.depth=0),void 0===this.height&&(this.height=0),void 0===this.proportional&&(this.proportional=!1),void 0===this.elevation&&(this.elevation=0),void 0===this.dropOnTopElevation&&(this.dropOnTopElevation=0),void 0===this.movable&&(this.movable=!1),void 0===this.doorOrWindow&&(this.doorOrWindow=!1),void 0===this.staircaseCutOutShape&&(this.staircaseCutOutShape=null),void 0===this.modelRotation&&(this.modelRotation=null),void 0===this.modelFlags&&(this.modelFlags=0),void 0===this.modelSize&&(this.modelSize=null),void 0===this.creator&&(this.creator=null),void 0===this.color&&(this.color=null),void 0===this.iconYaw&&(this.iconYaw=0),void 0===this.iconPitch&&(this.iconPitch=0),void 0===this.iconScale&&(this.iconScale=0),void 0===this.modifiable&&(this.modifiable=!1),void 0===this.resizable&&(this.resizable=!1),void 0===this.deformable&&(this.deformable=!1),void 0===this.texturable&&(this.texturable=!1),void 0===this.horizontallyRotatable&&(this.horizontallyRotatable=!1),void 0===this.price&&(this.price=null),void 0===this.valueAddedTaxPercentage&&(this.valueAddedTaxPercentage=null),void 0===this.currency&&(this.currency=null),void 0===this.properties&&(this.properties=null),void 0===this.category&&(this.category=null),void 0===this.filterCollationKey&&(this.filterCollationKey=null),void 0===this.id&&(this.id=null),void 0===this.name&&(this.name=null),void 0===this.description&&(this.description=null),void 0===this.information&&(this.information=null),void 0===this.license&&(this.license=null),void 0===this.tags&&(this.tags=null),void 0===this.creationDate&&(this.creationDate=null),void 0===this.grade&&(this.grade=null),void 0===this.icon&&(this.icon=null),void 0===this.planIcon&&(this.planIcon=null),void 0===this.model&&(this.model=null),void 0===this.width&&(this.width=0),void 0===this.depth&&(this.depth=0),void 0===this.height&&(this.height=0),void 0===this.proportional&&(this.proportional=!1),void 0===this.elevation&&(this.elevation=0),void 0===this.dropOnTopElevation&&(this.dropOnTopElevation=0),void 0===this.movable&&(this.movable=!1),void 0===this.doorOrWindow&&(this.doorOrWindow=!1),void 0===this.staircaseCutOutShape&&(this.staircaseCutOutShape=null),void 0===this.modelRotation&&(this.modelRotation=null),void 0===this.modelFlags&&(this.modelFlags=0),void 0===this.modelSize&&(this.modelSize=null),void 0===this.creator&&(this.creator=null),void 0===this.color&&(this.color=null),void 0===this.iconYaw&&(this.iconYaw=0),void 0===this.iconPitch&&(this.iconPitch=0),void 0===this.iconScale&&(this.iconScale=0),void 0===this.modifiable&&(this.modifiable=!1),void 0===this.resizable&&(this.resizable=!1),void 0===this.deformable&&(this.deformable=!1),void 0===this.texturable&&(this.texturable=!1),void 0===this.horizontallyRotatable&&(this.horizontallyRotatable=!1),void 0===this.price&&(this.price=null),void 0===this.valueAddedTaxPercentage&&(this.valueAddedTaxPercentage=null),void 0===this.currency&&(this.currency=null),void 0===this.properties&&(this.properties=null),void 0===this.category&&(this.category=null),void 0===this.filterCollationKey&&(this.filterCollationKey=null),void 0===this.id&&(this.id=null),void 0===this.name&&(this.name=null),void 0===this.description&&(this.description=null),void 0===this.information&&(this.information=null),void 0===this.license&&(this.license=null),void 0===this.tags&&(this.tags=null),void 0===this.creationDate&&(this.creationDate=null),void 0===this.grade&&(this.grade=null),void 0===this.icon&&(this.icon=null),void 0===this.planIcon&&(this.planIcon=null),void 0===this.model&&(this.model=null),void 0===this.width&&(this.width=0),void 0===this.depth&&(this.depth=0),void 0===this.height&&(this.height=0),void 0===this.proportional&&(this.proportional=!1),void 0===this.elevation&&(this.elevation=0),void 0===this.dropOnTopElevation&&(this.dropOnTopElevation=0),void 0===this.movable&&(this.movable=!1),void 0===this.doorOrWindow&&(this.doorOrWindow=!1),void 0===this.staircaseCutOutShape&&(this.staircaseCutOutShape=null),void 0===this.modelRotation&&(this.modelRotation=null),void 0===this.modelFlags&&(this.modelFlags=0),void 0===this.modelSize&&(this.modelSize=null),void 0===this.creator&&(this.creator=null),void 0===this.color&&(this.color=null),void 0===this.iconYaw&&(this.iconYaw=0),void 0===this.iconPitch&&(this.iconPitch=0),void 0===this.iconScale&&(this.iconScale=0),void 0===this.modifiable&&(this.modifiable=!1),void 0===this.resizable&&(this.resizable=!1),void 0===this.deformable&&(this.deformable=!1),void 0===this.texturable&&(this.texturable=!1),void 0===this.horizontallyRotatable&&(this.horizontallyRotatable=!1),void 0===this.price&&(this.price=null),void 0===this.valueAddedTaxPercentage&&(this.valueAddedTaxPercentage=null),void 0===this.currency&&(this.currency=null),void 0===this.properties&&(this.properties=null),void 0===this.category&&(this.category=null),void 0===this.filterCollationKey&&(this.filterCollationKey=null)}else{var mi=(Oi=arguments)[17],fi=Oi[18],vi=Oi[19],_i=Oi[20],Si=Oi[21],yi=Oi[22],Ei=Oi[23],Ci=Oi[24],Pi=Oi[25],wi=Oi[26],Li=Oi[27],Ti=Oi[28],Ai=Oi[29],Ii=Oi[30],bi=Math.PI/8;void 0===this.id&&(this.id=null),void 0===this.name&&(this.name=null),void 0===this.description&&(this.description=null),void 0===this.information&&(this.information=null),void 0===this.license&&(this.license=null),void 0===this.tags&&(this.tags=null),void 0===this.creationDate&&(this.creationDate=null),void 0===this.grade&&(this.grade=null),void 0===this.icon&&(this.icon=null),void 0===this.planIcon&&(this.planIcon=null),void 0===this.model&&(this.model=null),void 0===this.width&&(this.width=0),void 0===this.depth&&(this.depth=0),void 0===this.height&&(this.height=0),void 0===this.proportional&&(this.proportional=!1),void 0===this.elevation&&(this.elevation=0),void 0===this.dropOnTopElevation&&(this.dropOnTopElevation=0),void 0===this.movable&&(this.movable=!1),void 0===this.doorOrWindow&&(this.doorOrWindow=!1),void 0===this.staircaseCutOutShape&&(this.staircaseCutOutShape=null),void 0===this.modelRotation&&(this.modelRotation=null),void 0===this.modelFlags&&(this.modelFlags=0),void 0===this.modelSize&&(this.modelSize=null),void 0===this.creator&&(this.creator=null),void 0===this.color&&(this.color=null),void 0===this.iconYaw&&(this.iconYaw=0),void 0===this.iconPitch&&(this.iconPitch=0),void 0===this.iconScale&&(this.iconScale=0),void 0===this.modifiable&&(this.modifiable=!1),void 0===this.resizable&&(this.resizable=!1),void 0===this.deformable&&(this.deformable=!1),void 0===this.texturable&&(this.texturable=!1),void 0===this.horizontallyRotatable&&(this.horizontallyRotatable=!1),void 0===this.price&&(this.price=null),void 0===this.valueAddedTaxPercentage&&(this.valueAddedTaxPercentage=null),void 0===this.currency&&(this.currency=null),void 0===this.properties&&(this.properties=null),void 0===this.category&&(this.category=null),void 0===this.filterCollationKey&&(this.filterCollationKey=null),this.id=t,this.name=i,this.description=n,this.information=o,this.license=r,this.tags=l,this.creationDate=a,this.grade=s,this.icon=h,this.planIcon=u,this.model=d,this.width=c,this.depth=p,this.height=g,this.elevation=m,this.dropOnTopElevation=f,this.movable=v,this.doorOrWindow=!1,this.color=null,this.staircaseCutOutShape=mi,this.creator=Si,this.horizontallyRotatable=Pi,this.price=wi,this.valueAddedTaxPercentage=Li,this.currency=Ti,null==Ai||0===Object.keys(Ai).length?null==Ii||0===Object.keys(Ii).length?this.properties={}:1===Object.keys(Ii).length?this.properties=function(e){var t,i={};return i[e]=function(e){var t=0;return{next:function(){return t<e.length?e[t++]:null},hasNext:function(){return t<e.length}}}((t=Ii,Object.keys(t).map((function(e){return t[e]})))).next(),i}(function(e){var t=0;return{next:function(){return t<e.length?e[t++]:null},hasNext:function(){return t<e.length}}}(Object.keys(Ii)).next()):this.properties=function(e){var t={};for(var i in e)t[i]=e[i];return t}(Ii):1!==Object.keys(Ai).length||null!=Ii&&0!==Object.keys(Ii).length?(this.properties=function(e){var t={};for(var i in e)t[i]=e[i];return t}(Ai),null!=Ii&&function(e,t){for(var i in t)e[i]=t[i]}(this.properties,Ii)):this.properties=function(e){var t,i={};return i[e]=function(e){var t=0;return{next:function(){return t<e.length?e[t++]:null},hasNext:function(){return t<e.length}}}((t=Ai,Object.keys(t).map((function(e){return t[e]})))).next(),i}(function(e){var t=0;return{next:function(){return t<e.length?e[t++]:null},hasNext:function(){return t<e.length}}}(Object.keys(Ai)).next()),this.modelRotation=null==fi?PieceOfFurniture.IDENTITY_ROTATION_$LI$():e.deepClone(fi),this.modelFlags=vi,this.modelSize=_i,this.resizable=yi,this.deformable=Ei,this.texturable=Ci,this.iconYaw=bi,this.iconPitch=0,this.iconScale=1,this.proportional=!0,this.modifiable=!1,void 0===this.id&&(this.id=null),void 0===this.name&&(this.name=null),void 0===this.description&&(this.description=null),void 0===this.information&&(this.information=null),void 0===this.license&&(this.license=null),void 0===this.tags&&(this.tags=null),void 0===this.creationDate&&(this.creationDate=null),void 0===this.grade&&(this.grade=null),void 0===this.icon&&(this.icon=null),void 0===this.planIcon&&(this.planIcon=null),void 0===this.model&&(this.model=null),void 0===this.width&&(this.width=0),void 0===this.depth&&(this.depth=0),void 0===this.height&&(this.height=0),void 0===this.proportional&&(this.proportional=!1),void 0===this.elevation&&(this.elevation=0),void 0===this.dropOnTopElevation&&(this.dropOnTopElevation=0),void 0===this.movable&&(this.movable=!1),void 0===this.doorOrWindow&&(this.doorOrWindow=!1),void 0===this.staircaseCutOutShape&&(this.staircaseCutOutShape=null),void 0===this.modelRotation&&(this.modelRotation=null),void 0===this.modelFlags&&(this.modelFlags=0),void 0===this.modelSize&&(this.modelSize=null),void 0===this.creator&&(this.creator=null),void 0===this.color&&(this.color=null),void 0===this.iconYaw&&(this.iconYaw=0),void 0===this.iconPitch&&(this.iconPitch=0),void 0===this.iconScale&&(this.iconScale=0),void 0===this.modifiable&&(this.modifiable=!1),void 0===this.resizable&&(this.resizable=!1),void 0===this.deformable&&(this.deformable=!1),void 0===this.texturable&&(this.texturable=!1),void 0===this.horizontallyRotatable&&(this.horizontallyRotatable=!1),void 0===this.price&&(this.price=null),void 0===this.valueAddedTaxPercentage&&(this.valueAddedTaxPercentage=null),void 0===this.currency&&(this.currency=null),void 0===this.properties&&(this.properties=null),void 0===this.category&&(this.category=null),void 0===this.filterCollationKey&&(this.filterCollationKey=null)}else{var Oi=arguments;void 0===this.id&&(this.id=null),void 0===this.name&&(this.name=null),void 0===this.description&&(this.description=null),void 0===this.information&&(this.information=null),void 0===this.license&&(this.license=null),void 0===this.tags&&(this.tags=null),void 0===this.creationDate&&(this.creationDate=null),void 0===this.grade&&(this.grade=null),void 0===this.icon&&(this.icon=null),void 0===this.planIcon&&(this.planIcon=null),void 0===this.model&&(this.model=null),void 0===this.width&&(this.width=0),void 0===this.depth&&(this.depth=0),void 0===this.height&&(this.height=0),void 0===this.proportional&&(this.proportional=!1),void 0===this.elevation&&(this.elevation=0),void 0===this.dropOnTopElevation&&(this.dropOnTopElevation=0),void 0===this.movable&&(this.movable=!1),void 0===this.doorOrWindow&&(this.doorOrWindow=!1),void 0===this.staircaseCutOutShape&&(this.staircaseCutOutShape=null),void 0===this.modelRotation&&(this.modelRotation=null),void 0===this.modelFlags&&(this.modelFlags=0),void 0===this.modelSize&&(this.modelSize=null),void 0===this.creator&&(this.creator=null),void 0===this.color&&(this.color=null),void 0===this.iconYaw&&(this.iconYaw=0),void 0===this.iconPitch&&(this.iconPitch=0),void 0===this.iconScale&&(this.iconScale=0),void 0===this.modifiable&&(this.modifiable=!1),void 0===this.resizable&&(this.resizable=!1),void 0===this.deformable&&(this.deformable=!1),void 0===this.texturable&&(this.texturable=!1),void 0===this.horizontallyRotatable&&(this.horizontallyRotatable=!1),void 0===this.price&&(this.price=null),void 0===this.valueAddedTaxPercentage&&(this.valueAddedTaxPercentage=null),void 0===this.currency&&(this.currency=null),void 0===this.properties&&(this.properties=null),void 0===this.category&&(this.category=null),void 0===this.filterCollationKey&&(this.filterCollationKey=null),this.id=t,this.name=i,this.description=n,this.information=o,this.license=r,this.tags=l,this.creationDate=a,this.grade=s,this.icon=h,this.planIcon=u,this.model=d,this.width=c,this.depth=p,this.height=g,this.elevation=m,this.dropOnTopElevation=f,this.movable=v,this.doorOrWindow=_,this.color=y,this.staircaseCutOutShape=S,this.creator=w,this.horizontallyRotatable=I,this.price=b,this.valueAddedTaxPercentage=O,this.currency=M,null==D||0===Object.keys(D).length?null==R||0===Object.keys(R).length?this.properties={}:1===Object.keys(R).length?this.properties=function(e){var t,i={};return i[e]=function(e){var t=0;return{next:function(){return t<e.length?e[t++]:null},hasNext:function(){return t<e.length}}}((t=R,Object.keys(t).map((function(e){return t[e]})))).next(),i}((Mi=Object.keys(R),Di=0,{next:function(){return Di<Mi.length?Mi[Di++]:null},hasNext:function(){return Di<Mi.length}}).next()):this.properties=function(e){var t={};for(var i in e)t[i]=e[i];return t}(R):1!==Object.keys(D).length||null!=R&&0!==Object.keys(R).length?(this.properties=function(e){var t={};for(var i in e)t[i]=e[i];return t}(D),null!=R&&function(e,t){for(var i in t)e[i]=t[i]}(this.properties,R)):this.properties=function(e){var t,i={};return i[e]=function(e){var t=0;return{next:function(){return t<e.length?e[t++]:null},hasNext:function(){return t<e.length}}}((t=D,Object.keys(t).map((function(e){return t[e]})))).next(),i}(function(e){var t=0;return{next:function(){return t<e.length?e[t++]:null},hasNext:function(){return t<e.length}}}(Object.keys(D)).next()),this.modelRotation=null==E?PieceOfFurniture.IDENTITY_ROTATION_$LI$():e.deepClone(E),this.modelFlags=C,this.modelSize=P,this.resizable=L,this.deformable=T,this.texturable=A,this.iconYaw=F,this.iconPitch=x,this.iconScale=N,this.proportional=k,this.modifiable=H}var Mi,Di}return e.__static_initialize=function(){e.__static_initialized||(e.__static_initialized=!0,e.__static_initializer_0())},e.EMPTY_CRITERIA_$LI$=function(){return e.__static_initialize(),null==e.EMPTY_CRITERIA&&(e.EMPTY_CRITERIA=[]),e.EMPTY_CRITERIA},e.COMPARATOR_$LI$=function(){return e.__static_initialize(),e.COMPARATOR},e.recentFilters_$LI$=function(){return e.__static_initialize(),e.recentFilters},e.__static_initializer_0=function(){e.COMPARATOR={compare:function(e,t){return e.toString().localeCompare(t.toString())},equals:function(e,t){return 0===e.toString().localeCompare(t.toString())}},e.COMPARATOR_$LI$(),e.recentFilters={}},e.prototype.getId=function(){return this.id},e.prototype.getName=function(){return this.name},e.prototype.getDescription=function(){return this.description},e.prototype.getInformation=function(){return this.information},e.prototype.getLicense=function(){return this.license},e.prototype.getTags=function(){return this.tags},e.prototype.getCreationDate=function(){return this.creationDate},e.prototype.getGrade=function(){return this.grade},e.prototype.getDepth=function(){return this.depth},e.prototype.getHeight=function(){return this.height},e.prototype.getWidth=function(){return this.width},e.prototype.getElevation=function(){return this.elevation},e.prototype.getDropOnTopElevation=function(){return this.dropOnTopElevation},e.prototype.isMovable=function(){return this.movable},e.prototype.isDoorOrWindow=function(){return this.doorOrWindow},e.prototype.getIcon=function(){return this.icon},e.prototype.getPlanIcon=function(){return this.planIcon},e.prototype.getModel=function(){return this.model},e.prototype.getModelFlags=function(){return this.modelFlags},e.prototype.getModelSize=function(){return this.modelSize},e.prototype.getModelRotation=function(){return e.deepClone(this.modelRotation)},e.deepClone=function(e){for(var t=function(e){for(var t=[];e-- >0;)t.push(null);return t}(e.length),i=0;i<e.length;i++)t[i]=e[i].slice(0);return t},e.prototype.getStaircaseCutOutShape=function(){return this.staircaseCutOutShape},e.prototype.getCreator=function(){return this.creator},e.prototype.isBackFaceShown=function(){return(this.modelFlags&PieceOfFurniture.SHOW_BACK_FACE)===PieceOfFurniture.SHOW_BACK_FACE},e.prototype.getColor=function(){return this.color},e.prototype.getIconYaw=function(){return this.iconYaw},e.prototype.getIconPitch=function(){return this.iconPitch},e.prototype.getIconScale=function(){return this.iconScale},e.prototype.isProportional=function(){return this.proportional},e.prototype.isModifiable=function(){return this.modifiable},e.prototype.isResizable=function(){return this.resizable},e.prototype.isDeformable=function(){return this.deformable},e.prototype.isWidthDepthDeformable=function(){return this.isDeformable()},e.prototype.isTexturable=function(){return this.texturable},e.prototype.isHorizontallyRotatable=function(){return this.horizontallyRotatable},e.prototype.getPrice=function(){return this.price},e.prototype.getValueAddedTaxPercentage=function(){return this.valueAddedTaxPercentage},e.prototype.getCurrency=function(){return this.currency},e.prototype.getProperty=function(e){var t,i,n=void 0===(t=this.properties)[i=e]?null:t[i];return"string"==typeof n?n:null},e.prototype.getPropertyNames=function(){return Object.keys(this.properties)},e.prototype.getContentProperty=function(e){var t,i,n=void 0===(t=this.properties)[i=e]?null:t[i];return null!=n&&null!=n.constructor&&null!=n.constructor.__interfaces&&n.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0?n:null},e.prototype.isContentProperty=function(e){return null!=(void 0===(t=this.properties)[i=e]?null:t[i])&&null!=function(e,t){return void 0===e[t]?null:e[t]}(this.properties,e).constructor&&null!=function(e,t){return void 0===e[t]?null:e[t]}(this.properties,e).constructor.__interfaces&&function(e,t){return void 0===e[t]?null:e[t]}(this.properties,e).constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0;var t,i},e.prototype.getCategory=function(){return this.category},e.prototype.setCategory=function(e){this.category=e},e.prototype.equals=function(e){return i=e,(t=this)&&t.equals?t.equals(i):t===i;var t,i},e.prototype.hashCode=function(){return(e=this).hashCode?e.hashCode():e.toString().split("").reduce((function(e,t){return(e<<5)-e+t.charCodeAt(0)|0}),0);var e},e.prototype.compareTo=function(t){var i=e.COMPARATOR_$LI$().compare(this.name,t.name);return 0!==i?i:this.modifiable===t.modifiable?0:this.modifiable?1:-1},e.prototype.matchesFilter=function(e){var t=this.getFilterCollationKeys(e),i=0;if(t.length>0)for(var n=this.getPieceOfFurnitureCollationKey(),o=0;o<t.length&&this.isSubCollationKey(n,t[o],0);o++)i++;return i===t.length},e.prototype.getFilterCollationKeys=function(t){if(0===t.length)return e.EMPTY_CRITERIA_$LI$();var i,n,o=void 0===(i=e.recentFilters_$LI$())[n=t]?null:i[n];if(null==o){for(var r=t.split(/\s|\p{Punct}|\\|/),l=[],a=0;a<r.length;a++){var s=r[a];s.length>0&&l.push(e.COMPARATOR_$LI$().getCollationKey(s).toByteArray())}o=0===l.length?e.EMPTY_CRITERIA_$LI$():l.slice(0),e.recentFilters_$LI$()[t]=o}return o},e.prototype.getPieceOfFurnitureCollationKey=function(){if(null==this.filterCollationKey){for(var t={str:"",toString:function(){return this.str}},i=this.getFilterCriteria(),n=0;n<i.length;n++)o=void 0,o=i[n],0!==t.str.length&&(t.str+="|"),t.str+=o;this.filterCollationKey=e.COMPARATOR_$LI$().getCollationKey(t.str).toByteArray()}var o;return this.filterCollationKey},e.prototype.getFilterCriteria=function(){var e=[];e.push(this.getName()),null!=this.getCategory()&&e.push(this.getCategory().getName()),null!=this.getCreator()&&e.push(this.getCreator()),null!=this.getDescription()&&e.push(this.getDescription()),null!=this.getLicense()&&e.push(this.getLicense());for(var t=this.getTags(),i=0;i<t.length;i++){var n=t[i];e.push(n)}return e.slice(0)},e.prototype.isSubCollationKey=function(e,t,i){for(var n=i,o=e.length-4,r=t.length-4;n<o&&n<o-r+1;n++)if(e[n]===t[0]){for(var l=1;l<r;l++)if(e[n+l]!==t[l])return this.isSubCollationKey(e,t,n+1);return!0}return!1},e.prototype.clone=function(){try{var e=function(e){var t=Object.create(e);for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t}(this);return e.category=null,e}catch(e){throw new IllegalStateException("Super class isn't cloneable")}},e.__static_initialized=!1,e}();CatalogPieceOfFurniture.__class="com.eteks.sweethome3d.model.CatalogPieceOfFurniture",CatalogPieceOfFurniture.__interfaces=["com.eteks.sweethome3d.model.CatalogItem","com.eteks.sweethome3d.model.PieceOfFurniture"];var CollectionChangeSupport=function(){function e(e){void 0===this.source&&(this.source=null),void 0===this.collectionListeners&&(this.collectionListeners=null),this.source=e,this.collectionListeners=[]}return e.prototype.addCollectionListener=function(e){this.collectionListeners.push(e)},e.prototype.removeCollectionListener=function(e){var t,i;t=this.collectionListeners,(i=t.indexOf(e))>=0&&t.splice(i,1)},e.prototype.fireCollectionChanged$java_lang_Object$com_eteks_sweethome3d_model_CollectionEvent_Type=function(e,t){this.fireCollectionChanged(e,-1,t)},e.prototype.fireCollectionChanged$java_lang_Object$int$com_eteks_sweethome3d_model_CollectionEvent_Type=function(e,t,i){if(0!=this.collectionListeners.length)for(var n=new CollectionEvent(this.source,e,t,i),o=this.collectionListeners.slice(0),r=0;r<o.length;r++){(0,o[r])(n)}},e.prototype.fireCollectionChanged=function(e,t,i){if(null==e&&null!==e||"number"!=typeof t&&null!==t||"number"!=typeof i&&null!==i){if(null==e&&null!==e||"number"!=typeof t&&null!==t||void 0!==i)throw new Error("invalid overload");return this.fireCollectionChanged$java_lang_Object$com_eteks_sweethome3d_model_CollectionEvent_Type(e,t)}return this.fireCollectionChanged$java_lang_Object$int$com_eteks_sweethome3d_model_CollectionEvent_Type(e,t,i)},e}();CollectionChangeSupport.__class="com.eteks.sweethome3d.model.CollectionChangeSupport";var CollectionEvent=function(e){function t(t,i,n,o){var r=this;if(null==t&&null!==t||null==i&&null!==i||"number"!=typeof n&&null!==n||"number"!=typeof o&&null!==o){if(null==t&&null!==t||null==i&&null!==i||"number"!=typeof n&&null!==n||void 0!==o)throw new Error("invalid overload");var l=arguments[2];void 0===(r=e.call(this,t)||this).item&&(r.item=null),void 0===r.index&&(r.index=0),void 0===r.type&&(r.type=null),r.item=i,r.index=-1,r.type=l,void 0===r.item&&(r.item=null),void 0===r.index&&(r.index=0),void 0===r.type&&(r.type=null)}else{void 0===(r=e.call(this,t)||this).item&&(r.item=null),void 0===r.index&&(r.index=0),void 0===r.type&&(r.type=null),r.item=i,r.index=n,r.type=o}return r}return __extends(t,e),t.prototype.getItem=function(){return this.item},t.prototype.getIndex=function(){return this.index},t.prototype.getType=function(){return this.type},t}(EventObject);CollectionEvent.__class="com.eteks.sweethome3d.model.CollectionEvent",function(e){var t;(t=e.Type||(e.Type={}))[t.ADD=0]="ADD",t[t.DELETE=1]="DELETE"}(CollectionEvent||(CollectionEvent={})),CollectionEvent.__transients=["source"];var SelectionEvent=function(e){function t(t,i,n){var o=this;if((null!=t||null===t)&&(null!=i&&i instanceof Array||null===i)&&(null!=n&&n instanceof Array||null===n)){void 0===(o=e.call(this,t)||this).oldSelectedItems&&(o.oldSelectedItems=null),void 0===o.selectedItems&&(o.selectedItems=null),o.oldSelectedItems=i,o.selectedItems=n}else{if(null==t&&null!==t||!(null!=i&&i instanceof Array||null===i)||void 0!==n)throw new Error("invalid overload");var r=arguments[1];void 0===(o=e.call(this,t)||this).oldSelectedItems&&(o.oldSelectedItems=null),void 0===o.selectedItems&&(o.selectedItems=null),o.oldSelectedItems=null,o.selectedItems=r,void 0===o.oldSelectedItems&&(o.oldSelectedItems=null),void 0===o.selectedItems&&(o.selectedItems=null)}return o}return __extends(t,e),t.prototype.getOldSelectedItems=function(){return this.oldSelectedItems},t.prototype.getSelectedItems=function(){return this.selectedItems},t}(EventObject);SelectionEvent.__class="com.eteks.sweethome3d.model.SelectionEvent",SelectionEvent.__transients=["source"];var FurnitureCategory=function(){function e(e){void 0===this.name&&(this.name=null),void 0===this.furniture&&(this.furniture=null),this.name=e,this.furniture=[]}return e.COMPARATOR_$LI$=function(){return null==e.COMPARATOR&&(e.COMPARATOR={compare:function(e,t){return e.toString().localeCompare(t.toString())},equals:function(e,t){return 0===e.toString().localeCompare(t.toString())}}),e.COMPARATOR},e.prototype.getName=function(){return this.name},e.prototype.getFurniture=function(){return this.furniture.slice(0)},e.prototype.getFurnitureCount=function(){return this.furniture.length},e.prototype.getPieceOfFurniture=function(e){return this.furniture[e]},e.prototype.getIndexOfPieceOfFurniture=function(e){return this.furniture.indexOf(e)},e.prototype.add=function(e){e.setCategory(this);var t=function(e,t){for(var i,n,o=0,r=e.length-1;o<=r;){var l=o+r>>>1,a=e[l],s=(n=t,(i=a).compareTo?i.compareTo(n):i.localeCompare(n));if(s<0)o=l+1;else{if(!(s>0))return l;r=l-1}}return-(o+1)}(this.furniture,e);t<0&&(t=-t-1),this.furniture.splice(t,0,e)},e.prototype.delete=function(e){var t=this.furniture.indexOf(e);if(-1===t)throw new IllegalArgumentException(this.name+" doesn't contain piece "+e.getName());this.furniture=this.furniture.slice(0),this.furniture.splice(t,1)[0]},e.prototype.equals=function(t){return null!=t&&t instanceof e&&e.COMPARATOR_$LI$().equals(this.name,t.name)},e.prototype.hashCode=function(){return(e=this.name).hashCode?e.hashCode():e.toString().split("").reduce((function(e,t){return(e<<5)-e+t.charCodeAt(0)|0}),0);var e},e.prototype.compareTo=function(t){return e.COMPARATOR_$LI$().compare(this.name,t.name)},e}();FurnitureCategory.__class="com.eteks.sweethome3d.model.FurnitureCategory";var HomeMaterial=function(){function e(e,t,i,n,o){if("string"!=typeof e&&null!==e||"string"!=typeof t&&null!==t||"number"!=typeof i&&null!==i||!(null!=n&&n instanceof HomeTexture||null===n)||"number"!=typeof o&&null!==o){if("string"!=typeof e&&null!==e||"number"!=typeof t&&null!==t||!(null!=i&&i instanceof HomeTexture||null===i)||"number"!=typeof n&&null!==n||void 0!==o)throw new Error("invalid overload");var r=(s=arguments)[1],l=s[2],a=s[3];void 0===this.name&&(this.name=null),void 0===this.key&&(this.key=null),void 0===this.color&&(this.color=null),void 0===this.texture&&(this.texture=null),void 0===this.shininess&&(this.shininess=null),this.name=e,this.key=null,this.color=r,this.texture=l,this.shininess=a,void 0===this.name&&(this.name=null),void 0===this.key&&(this.key=null),void 0===this.color&&(this.color=null),void 0===this.texture&&(this.texture=null),void 0===this.shininess&&(this.shininess=null)}else{var s=arguments;void 0===this.name&&(this.name=null),void 0===this.key&&(this.key=null),void 0===this.color&&(this.color=null),void 0===this.texture&&(this.texture=null),void 0===this.shininess&&(this.shininess=null),this.name=e,this.key=t,this.color=i,this.texture=n,this.shininess=o}}return e.prototype.getName=function(){return this.name},e.prototype.getKey=function(){return this.key},e.prototype.getColor=function(){return this.color},e.prototype.getTexture=function(){return this.texture},e.prototype.getShininess=function(){return this.shininess},e.prototype.equals=function(t){if(null!=t&&t instanceof e){var i=t;return(i.name===this.name||null!=i.name&&i.name===this.name)&&(i.key===this.key||null!=i.key&&i.key===this.name)&&(i.color===this.color||null!=i.color&&i.color===this.color)&&(i.texture===this.texture||null!=i.texture&&i.texture.equals(this.texture))&&(i.shininess===this.shininess||null!=i.shininess&&i.shininess===this.shininess)}return!1},e.prototype.hashCode=function(){var e,t=0;return null!=this.name&&(t+=(e=this.name).hashCode?e.hashCode():e.toString().split("").reduce((function(e,t){return(e<<5)-e+t.charCodeAt(0)|0}),0)),null!=this.key&&(t+=function(e){return e.hashCode?e.hashCode():e.toString().split("").reduce((function(e,t){return(e<<5)-e+t.charCodeAt(0)|0}),0)}(this.key)),null!=this.color&&(t+=function(e){return e.hashCode?e.hashCode():e.toString().split("").reduce((function(e,t){return(e<<5)-e+t.charCodeAt(0)|0}),0)}(this.color)),null!=this.texture&&(t+=function(e){return e.hashCode?e.hashCode():e.toString().split("").reduce((function(e,t){return(e<<5)-e+t.charCodeAt(0)|0}),0)}(this.texture)),null!=this.shininess&&(t+=function(e){return e.hashCode?e.hashCode():e.toString().split("").reduce((function(e,t){return(e<<5)-e+t.charCodeAt(0)|0}),0)}(this.shininess)),t},e}();HomeMaterial.__class="com.eteks.sweethome3d.model.HomeMaterial";var PieceOfFurniture,Sash=function(){function e(e,t,i,n,o){void 0===this.xAxis&&(this.xAxis=0),void 0===this.yAxis&&(this.yAxis=0),void 0===this.width&&(this.width=0),void 0===this.startAngle&&(this.startAngle=0),void 0===this.endAngle&&(this.endAngle=0),this.xAxis=e,this.yAxis=t,this.width=i,this.startAngle=n,this.endAngle=o}return e.prototype.getXAxis=function(){return this.xAxis},e.prototype.getYAxis=function(){return this.yAxis},e.prototype.getWidth=function(){return this.width},e.prototype.getStartAngle=function(){return this.startAngle},e.prototype.getEndAngle=function(){return this.endAngle},e}();Sash.__class="com.eteks.sweethome3d.model.Sash",function(e){e.DEFAULT_CUT_OUT_SHAPE="M0,0 v1 h1 v-1 z",e.IDENTITY_ROTATION_$LI$=function(){return null==e.IDENTITY_ROTATION&&(e.IDENTITY_ROTATION=[[1,0,0],[0,1,0],[0,0,1]]),e.IDENTITY_ROTATION},e.SHOW_BACK_FACE=1,e.HIDE_EDGE_COLOR_MATERIAL=2}(PieceOfFurniture||(PieceOfFurniture={}));var TransferableView,HomeController3D=function(){function e(t,i,n,o,r,l){var a=this;if((null!=t&&t instanceof Home||null===t)&&(null!=i&&i instanceof PlanController||null===i)&&(null!=n&&n instanceof UserPreferences||null===n)&&(null!=o&&null!=o.constructor&&null!=o.constructor.__interfaces&&o.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0||null===o)&&(null!=r&&null!=r.constructor&&null!=r.constructor.__interfaces&&r.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ContentManager")>=0||null===r)&&(null!=l&&l instanceof javax.swing.undo.UndoableEditSupport||null===l)){var s=arguments;void 0===this.home&&(this.home=null),void 0===this.preferences&&(this.preferences=null),void 0===this.viewFactory&&(this.viewFactory=null),void 0===this.contentManager&&(this.contentManager=null),void 0===this.undoSupport&&(this.undoSupport=null),void 0===this.planController&&(this.planController=null),void 0===this.home3DView&&(this.home3DView=null),void 0===this.topCameraState&&(this.topCameraState=null),void 0===this.observerCameraState&&(this.observerCameraState=null),void 0===this.cameraState&&(this.cameraState=null),this.home=t,this.preferences=n,this.viewFactory=o,this.contentManager=r,this.undoSupport=l,this.topCameraState=new e.TopCameraState(this,n),this.observerCameraState=new e.ObserverCameraState(this),this.setCameraState(t.getCamera()===t.getTopCamera()?this.topCameraState:this.observerCameraState),this.addModelListeners(t),void 0===this.home&&(this.home=null),void 0===this.preferences&&(this.preferences=null),void 0===this.viewFactory&&(this.viewFactory=null),void 0===this.contentManager&&(this.contentManager=null),void 0===this.undoSupport&&(this.undoSupport=null),void 0===this.planController&&(this.planController=null),void 0===this.home3DView&&(this.home3DView=null),void 0===this.topCameraState&&(this.topCameraState=null),void 0===this.observerCameraState&&(this.observerCameraState=null),void 0===this.cameraState&&(this.cameraState=null),a.planController=i}else{if(!((null!=t&&t instanceof Home||null===t)&&(null!=i&&i instanceof UserPreferences||null===i)&&(null!=n&&null!=n.constructor&&null!=n.constructor.__interfaces&&n.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0||null===n)&&(null!=o&&null!=o.constructor&&null!=o.constructor.__interfaces&&o.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ContentManager")>=0||null===o)&&(null!=r&&r instanceof javax.swing.undo.UndoableEditSupport||null===r)&&void 0===l))throw new Error("invalid overload");var h=(s=arguments)[1],u=s[2],d=s[3],c=s[4];void 0===this.home&&(this.home=null),void 0===this.preferences&&(this.preferences=null),void 0===this.viewFactory&&(this.viewFactory=null),void 0===this.contentManager&&(this.contentManager=null),void 0===this.undoSupport&&(this.undoSupport=null),void 0===this.planController&&(this.planController=null),void 0===this.home3DView&&(this.home3DView=null),void 0===this.topCameraState&&(this.topCameraState=null),void 0===this.observerCameraState&&(this.observerCameraState=null),void 0===this.cameraState&&(this.cameraState=null),this.home=t,this.preferences=h,this.viewFactory=u,this.contentManager=d,this.undoSupport=c,this.topCameraState=new e.TopCameraState(this,h),this.observerCameraState=new e.ObserverCameraState(this),this.setCameraState(t.getCamera()===t.getTopCamera()?this.topCameraState:this.observerCameraState),this.addModelListeners(t)}}return e.prototype.addModelListeners=function(t){t.addPropertyChangeListener("CAMERA",new e.HomeController3D$0(this,t));var i=new e.HomeController3D$1(this,t),n=t.getSelectedLevel();null!=n&&n.addPropertyChangeListener(i),t.addPropertyChangeListener("SELECTED_LEVEL",new e.HomeController3D$2(this,t,i));var o=new e.HomeController3D$3(this,t);t.addPropertyChangeListener("SELECTED_LEVEL",o),t.getEnvironment().addPropertyChangeListener("ALL_LEVELS_VISIBLE",o)},e.prototype.getObserverCameraMinimumElevation=function(e){var t=e.getLevels();return 0===t.length?10:10+t[0].getElevation()},e.prototype.getView=function(){return null==this.home3DView&&(this.home3DView=this.viewFactory.createView3D(this.home,this.preferences,this)),this.home3DView},e.prototype.viewFromTop=function(){this.home.setCamera(this.home.getTopCamera())},e.prototype.viewFromObserver=function(){this.home.setCamera(this.home.getObserverCamera())},e.prototype.storeCamera=function(e){var t=this.home.getCamera().duplicate();t.setName(e);var i,n,o=this.home.getStoredCameras(),r=[];n=o,(i=r).push.apply(i,n);for(var l=r.length-1;l>=0;l--){var a=r[l];(e===a.getName()||t.getX()===a.getX()&&t.getY()===a.getY()&&t.getZ()===a.getZ()&&t.getPitch()===a.getPitch()&&t.getYaw()===a.getYaw()&&t.getFieldOfView()===a.getFieldOfView()&&t.getTime()===a.getTime()&&t.getLens()===a.getLens()&&(t.getRenderer()===a.getRenderer()||null!=t.getRenderer()&&t.getRenderer()===a.getRenderer()))&&r.splice(l,1)[0]}for(r.splice(0,0,t);r.length>this.preferences.getStoredCamerasMaxCount();)r.splice(r.length-1,1)[0];this.home.setStoredCameras(r)},e.prototype.goToCamera=function(e){null!=e&&e instanceof ObserverCamera?this.viewFromObserver():this.viewFromTop(),this.cameraState.goToCamera(e);var t,i,n=this.home.getStoredCameras().slice(0);(i=(t=n).indexOf(e))>=0&&t.splice(i,1),n.splice(0,0,e),this.home.setStoredCameras(n)},e.prototype.deleteCameras=function(e){for(var t=this.home.getStoredCameras(),i=[],n=0;n<t.length;n++){var o=t[n];e.indexOf(o)>=0||i.push(o)}this.home.setStoredCameras(i)},e.prototype.displayAllLevels=function(){this.home.getEnvironment().setAllLevelsVisible(!0)},e.prototype.displaySelectedLevel=function(){this.home.getEnvironment().setAllLevelsVisible(!1)},e.prototype.modifyAttributes=function(){new Home3DAttributesController(this.home,this.preferences,this.viewFactory,this.contentManager,this.undoSupport).displayView(this.getView())},e.prototype.setCameraState=function(e){null!=this.cameraState&&this.cameraState.exit(),this.cameraState=e,this.cameraState.enter()},e.prototype.moveCamera=function(e){this.cameraState.moveCamera(e)},e.prototype.moveCameraSideways=function(e){this.cameraState.moveCameraSideways(e)},e.prototype.elevateCamera=function(e){this.cameraState.elevateCamera(e)},e.prototype.rotateCameraYaw=function(e){this.cameraState.rotateCameraYaw(e)},e.prototype.rotateCameraPitch=function(e){this.cameraState.rotateCameraPitch(e)},e.prototype.modifyFieldOfView=function(e){this.cameraState.modifyFieldOfView(e)},e.prototype.pressMouse=function(e,t,i,n,o,r,l,a){this.cameraState.pressMouse(e,t,i,n,o,r,l,a)},e.prototype.releaseMouse=function(e,t){this.cameraState.releaseMouse(e,t)},e.prototype.moveMouse=function(e,t){this.cameraState.moveMouse(e,t)},e.prototype.isEditingState=function(){return this.cameraState.isEditingState()},e.prototype.escape=function(){this.cameraState.escape()},e.prototype.toggleMagnetism=function(e){this.cameraState.toggleMagnetism(e)},e.prototype.setAlignmentActivated=function(e){this.cameraState.setAlignmentActivated(e)},e.prototype.setDuplicationActivated=function(e){this.cameraState.setDuplicationActivated(e)},e.prototype.getObserverCameraState=function(){return this.observerCameraState},e.prototype.getTopCameraState=function(){return this.topCameraState},e}();HomeController3D.__class="com.eteks.sweethome3d.viewcontroller.HomeController3D",HomeController3D.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"],function(e){var t=function(){function e(){}return e.prototype.enter=function(){},e.prototype.exit=function(){},e.prototype.moveCamera=function(e){},e.prototype.moveCameraSideways=function(e){},e.prototype.elevateCamera=function(e){},e.prototype.rotateCameraYaw=function(e){},e.prototype.rotateCameraPitch=function(e){},e.prototype.modifyFieldOfView=function(e){},e.prototype.goToCamera=function(e){},e.prototype.isEditingState=function(){return!1},e.prototype.pressMouse=function(e,t,i,n,o,r,l,a){},e.prototype.releaseMouse=function(e,t){},e.prototype.moveMouse=function(e,t){},e.prototype.escape=function(){},e.prototype.toggleMagnetism=function(e){},e.prototype.setAlignmentActivated=function(e){},e.prototype.setDuplicationActivated=function(e){},e.prototype.setEditionActivated=function(e){},e}();e.CameraControllerState=t,t.__class="com.eteks.sweethome3d.viewcontroller.HomeController3D.CameraControllerState";var i=function(){function e(e){void 0===this.topCameraState&&(this.topCameraState=null),this.topCameraState=e}return e.prototype.propertyChange=function(e){var t=this.topCameraState,i=e.getSource();null==t?i.removePropertyChangeListener(e.getPropertyName(),this):t.setAerialViewCenteredOnSelectionEnabled(i.isAerialViewCenteredOnSelectionEnabled())},e}();e.UserPreferencesChangeListener=i,i.__class="com.eteks.sweethome3d.viewcontroller.HomeController3D.UserPreferencesChangeListener";var n=function(e){function t(t){var i=e.call(this)||this;return i.__parent=t,void 0===i.cameraMoved&&(i.cameraMoved=!1),void 0===i.mouseMoved&&(i.mouseMoved=!1),void 0===i.elevationActivated&&(i.elevationActivated=!1),void 0===i.rotationActivated&&(i.rotationActivated=!1),void 0===i.lastMousePressedPoint3D&&(i.lastMousePressedPoint3D=null),void 0===i.distancesRatio&&(i.distancesRatio=0),void 0===i.yLastMousePress&&(i.yLastMousePress=0),void 0===i.angleMousePress&&(i.angleMousePress=null),void 0===i.alignmentActivated&&(i.alignmentActivated=!1),void 0===i.duplicationActivated&&(i.duplicationActivated=!1),void 0===i.magnetismToggled&&(i.magnetismToggled=!1),void 0===i.pointerType&&(i.pointerType=null),void 0===i.movedItems&&(i.movedItems=null),void 0===i.closestMovedPiece&&(i.closestMovedPiece=null),void 0===i.movedItemsStartPoint&&(i.movedItemsStartPoint=null),void 0===i.movedItemsDeltaX&&(i.movedItemsDeltaX=null),void 0===i.movedItemsDeltaY&&(i.movedItemsDeltaY=null),i}return __extends(t,e),t.prototype.isEditingState=function(){return null!=this.movedItems},t.prototype.moveCamera=function(e){this.cameraMoved=!0},t.prototype.moveCameraSideways=function(e){this.cameraMoved=!0},t.prototype.elevateCamera=function(e){this.cameraMoved=!0},t.prototype.rotateCameraYaw=function(e){this.cameraMoved=!0},t.prototype.rotateCameraPitch=function(e){this.cameraMoved=!0},t.prototype.modifyFieldOfView=function(e){this.cameraMoved=!0},t.prototype.goToCamera=function(e){this.cameraMoved=!0},t.prototype.pressMouse=function(e,t,i,n,o,r,l,a){if(null!=this.__parent.planController&&this.__parent.preferences.isEditingIn3DViewEnabled()&&null!=this.__parent.getView()&&null!=this.__parent.getView().constructor&&null!=this.__parent.getView().constructor.__interfaces&&this.__parent.getView().constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.View3D")>=0&&!this.__parent.planController.isModificationState()){if(1===i){for(var s=this.__parent.getView().getClosestSelectableItemAt(Math.round(e),Math.round(t)),h=[],u=this.__parent.home.getSelectedItems(),d=0;d<u.length;d++){null!=(c=u[d])&&c instanceof HomeFurnitureGroup?(f=h,v=c.getAllFurniture(),f.push.apply(f,v)):h.push(c)}if(h.indexOf(s)>=0&&this.__parent.planController.isItemMovable(s)&&null!=s&&s instanceof HomePieceOfFurniture){this.movedItems=[];for(d=0;d<u.length;d++){var c=u[d];this.__parent.planController.isItemMovable(c)&&null!=c&&c instanceof HomePieceOfFurniture&&this.movedItems.push(c)}if(this.elevationActivated=!o&&r,this.rotationActivated=o&&r,(this.elevationActivated||this.rotationActivated)&&null!=s&&s instanceof HomePieceOfFurniture&&u.length>1&&(this.elevationActivated=!1,this.rotationActivated=!1),null!=this.movedItems){this.closestMovedPiece=s;var p=this.closestMovedPiece.getGroundElevation()+this.closestMovedPiece.getHeightInPlan()/2*Math.cos(this.__parent.home.getCamera().getPitch());this.lastMousePressedPoint3D=this.__parent.getView().convertPixelLocationToVirtualWorld(Math.round(e),Math.round(t));var g=Math.sqrt((this.__parent.home.getCamera().getX()-this.closestMovedPiece.getX())*(this.__parent.home.getCamera().getX()-this.closestMovedPiece.getX())+(this.__parent.home.getCamera().getY()-this.closestMovedPiece.getY())*(this.__parent.home.getCamera().getY()-this.closestMovedPiece.getY())+(this.__parent.home.getCamera().getZ()-p)*(this.__parent.home.getCamera().getZ()-p)),m=Math.sqrt((this.__parent.home.getCamera().getX()-this.lastMousePressedPoint3D[0])*(this.__parent.home.getCamera().getX()-this.lastMousePressedPoint3D[0])+(this.__parent.home.getCamera().getY()-this.lastMousePressedPoint3D[1])*(this.__parent.home.getCamera().getY()-this.lastMousePressedPoint3D[1])+(this.__parent.home.getCamera().getZ()-this.lastMousePressedPoint3D[2])*(this.__parent.home.getCamera().getZ()-this.lastMousePressedPoint3D[2]));this.distancesRatio=g/m}this.movedItemsDeltaX=null,this.movedItemsDeltaY=null}}else 2===i&&0!=this.__parent.home.getSelectedItems().length&&this.__parent.planController.modifySelectedItem();this.mouseMoved=!1,this.cameraMoved=!1,this.yLastMousePress=t,this.alignmentActivated=o,this.duplicationActivated=r,this.magnetismToggled=l,this.pointerType=a}var f,v},t.prototype.releaseMouse=function(e,t){if(null!=this.__parent.planController&&this.__parent.preferences.isEditingIn3DViewEnabled()&&null!=this.__parent.getView()&&null!=this.__parent.getView().constructor&&null!=this.__parent.getView().constructor.__interfaces&&this.__parent.getView().constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.View3D")>=0){if(null!=this.movedItems&&null!=this.movedItemsDeltaY)this.__parent.planController.releaseMouse(this.movedItemsStartPoint[0]+this.movedItemsDeltaX,this.movedItemsStartPoint[1]+this.movedItemsDeltaY),this.__parent.planController.setFeedbackDisplayed(!0);else if(!this.__parent.planController.isModificationState()&&!this.mouseMoved&&!this.cameraMoved){var i=this.__parent.getView().getClosestSelectableItemAt(Math.round(e),Math.round(t));if(null!=i&&this.__parent.home.isBasePlanLocked()&&this.__parent.planController.isItemPartOfBasePlan(i)&&(i=null),this.alignmentActivated){if(null!=i)(n=this.__parent.home.getSelectedItems().slice(0)).indexOf(i)>=0?this.__parent.home.deselectItem(i):(n.push(i),this.__parent.home.setSelectedItems(n))}else if(null!=i)this.__parent.home.setSelectedItems([i]);else{var n=[];this.__parent.home.setSelectedItems(n)}}this.movedItems=null,this.closestMovedPiece=null,this.elevationActivated=!1,this.rotationActivated=!1}},t.prototype.moveMouse=function(e,t){if(null!=this.__parent.planController&&this.__parent.preferences.isEditingIn3DViewEnabled()&&null!=this.movedItems){null==this.movedItemsDeltaY&&(this.movedItemsStartPoint=this.rotationActivated?this.movedItems[0].getPoints()[0]:[this.closestMovedPiece.getX(),this.closestMovedPiece.getY()],this.angleMousePress=null,this.__parent.planController.setFeedbackDisplayed(!1),this.__parent.planController.moveMouse(this.movedItemsStartPoint[0],this.movedItemsStartPoint[1]),this.__parent.planController.pressMouse$float$float$int$boolean$boolean$boolean$boolean(this.movedItemsStartPoint[0],this.movedItemsStartPoint[1],1,!1,!1,this.duplicationActivated,this.magnetismToggled),this.elevationActivated?this.__parent.planController.setState(this.__parent.planController.getPieceOfFurnitureElevationState()):this.rotationActivated?this.__parent.planController.setState(this.__parent.planController.getPieceOfFurnitureRotationState()):(this.__parent.home.setSelectedItems(this.movedItems),this.__parent.planController.setState(this.__parent.planController.getSelectionMoveState()),this.__parent.planController.setAlignmentActivated(this.alignmentActivated))),this.rotationActivated&&null==this.angleMousePress&&(this.angleMousePress=Math.atan2(this.movedItemsStartPoint[1]-this.movedItems[0].getY(),this.movedItemsStartPoint[0]-this.movedItems[0].getX()),this.pointerType===View.PointerType.TOUCH&&(this.lastMousePressedPoint3D=this.__parent.getView().convertPixelLocationToVirtualWorld(Math.round(e),Math.round(t))));var i=this.__parent.getView().convertPixelLocationToVirtualWorld(Math.round(e),Math.round(t));if(this.rotationActivated){var n=this.angleMousePress-(i[0]-this.lastMousePressedPoint3D[0])*this.distancesRatio/50,o=java.awt.geom.Point2D.distance(this.movedItems[0].getX(),this.movedItems[0].getY(),this.movedItemsStartPoint[0],this.movedItemsStartPoint[1]);this.movedItemsDeltaX=this.movedItems[0].getX()+o*Math.cos(n)-this.movedItemsStartPoint[0],this.movedItemsDeltaY=this.movedItems[0].getY()+o*Math.sin(n)-this.movedItemsStartPoint[1]}else this.elevationActivated?(this.movedItemsDeltaX=0,this.movedItemsDeltaY=(this.lastMousePressedPoint3D[2]-i[2])*this.distancesRatio+(t-this.yLastMousePress)*(1-Math.cos(this.__parent.home.getCamera().getPitch()))):(this.movedItemsDeltaX=(i[0]-this.lastMousePressedPoint3D[0])*this.distancesRatio,this.movedItemsDeltaY=(i[1]-this.lastMousePressedPoint3D[1])*this.distancesRatio);this.__parent.planController.moveMouse(this.movedItemsStartPoint[0]+this.movedItemsDeltaX,this.movedItemsStartPoint[1]+this.movedItemsDeltaY)}this.mouseMoved=!0},t.prototype.escape=function(){null!=this.__parent.planController&&this.__parent.preferences.isEditingIn3DViewEnabled()&&(this.movedItems=null,this.__parent.planController.escape())},t.prototype.toggleMagnetism=function(e){null!=this.__parent.planController&&this.__parent.preferences.isEditingIn3DViewEnabled()&&(this.magnetismToggled=e,this.__parent.planController.toggleMagnetism(e))},t.prototype.setAlignmentActivated=function(e){null!=this.__parent.planController&&this.__parent.preferences.isEditingIn3DViewEnabled()&&(this.pointerType===View.PointerType.TOUCH&&e&&1===this.__parent.home.getSelectedItems().length&&!this.mouseMoved&&(this.elevationActivated=!0,this.rotationActivated=!1),this.alignmentActivated=e,this.__parent.planController.setAlignmentActivated(e))},t.prototype.setDuplicationActivated=function(e){null!=this.__parent.planController&&this.__parent.preferences.isEditingIn3DViewEnabled()&&(this.pointerType===View.PointerType.TOUCH&&e&&1===this.__parent.home.getSelectedItems().length&&(this.elevationActivated&&!this.mouseMoved?(this.elevationActivated=!1,this.rotationActivated=!0):(this.movedItemsStartPoint[0]+=this.movedItemsDeltaX,this.movedItemsStartPoint[1]+=this.movedItemsDeltaY,this.angleMousePress=null)),this.duplicationActivated=e,this.elevationActivated||this.__parent.planController.setDuplicationActivated(e))},t}(e.CameraControllerState);e.EditingCameraState=n,n.__class="com.eteks.sweethome3d.viewcontroller.HomeController3D.EditingCameraState";var o=function(t){function i(n,o){var r=t.call(this,n)||this;return r.__parent=n,r.MIN_WIDTH=100,r.MIN_DEPTH=r.MIN_WIDTH,r.MIN_HEIGHT=20,void 0===r.topCamera&&(r.topCamera=null),void 0===r.aerialViewBoundsLowerPoint&&(r.aerialViewBoundsLowerPoint=null),void 0===r.aerialViewBoundsUpperPoint&&(r.aerialViewBoundsUpperPoint=null),void 0===r.minDistanceToAerialViewCenter&&(r.minDistanceToAerialViewCenter=0),void 0===r.maxDistanceToAerialViewCenter&&(r.maxDistanceToAerialViewCenter=0),void 0===r.aerialViewCenteredOnSelectionEnabled&&(r.aerialViewCenteredOnSelectionEnabled=!1),void 0===r.previousSelectionEmpty&&(r.previousSelectionEmpty=!1),r.distanceToCenterWithSelection=-1,r.objectChangeListener=new i.TopCameraState$0(r),r.levelsListener=function(e){e.getType()===CollectionEvent.Type.ADD?e.getItem().addPropertyChangeListener(r.objectChangeListener):e.getType()===CollectionEvent.Type.DELETE&&e.getItem().removePropertyChangeListener(r.objectChangeListener),r.updateCameraFromHomeBounds(!1,!1)},r.wallsListener=function(e){e.getType()===CollectionEvent.Type.ADD?e.getItem().addPropertyChangeListener(r.objectChangeListener):e.getType()===CollectionEvent.Type.DELETE&&e.getItem().removePropertyChangeListener(r.objectChangeListener),r.updateCameraFromHomeBounds(!1,!1)},r.furnitureListener=function(e){e.getType()===CollectionEvent.Type.ADD?(r.addPropertyChangeListener(e.getItem(),r.objectChangeListener),r.updateCameraFromHomeBounds(1===n.home.getFurniture().length&&0==n.home.getWalls().length&&0==n.home.getRooms().length,!1)):e.getType()===CollectionEvent.Type.DELETE&&(r.removePropertyChangeListener(e.getItem(),r.objectChangeListener),r.updateCameraFromHomeBounds(!1,!1))},r.roomsListener=function(e){e.getType()===CollectionEvent.Type.ADD?e.getItem().addPropertyChangeListener(r.objectChangeListener):e.getType()===CollectionEvent.Type.DELETE&&e.getItem().removePropertyChangeListener(r.objectChangeListener),r.updateCameraFromHomeBounds(!1,!1)},r.polylinesListener=function(e){e.getType()===CollectionEvent.Type.ADD?e.getItem().addPropertyChangeListener(r.objectChangeListener):e.getType()===CollectionEvent.Type.DELETE&&e.getItem().removePropertyChangeListener(r.objectChangeListener),r.updateCameraFromHomeBounds(!1,!1)},r.dimensionLinesListener=function(e){e.getType()===CollectionEvent.Type.ADD?e.getItem().addPropertyChangeListener(r.objectChangeListener):e.getType()===CollectionEvent.Type.DELETE&&e.getItem().removePropertyChangeListener(r.objectChangeListener),r.updateCameraFromHomeBounds(!1,!1)},r.labelsListener=function(e){e.getType()===CollectionEvent.Type.ADD?e.getItem().addPropertyChangeListener(r.objectChangeListener):e.getType()===CollectionEvent.Type.DELETE&&e.getItem().removePropertyChangeListener(r.objectChangeListener),r.updateCameraFromHomeBounds(!1,!1)},r.selectionListener=new i.TopCameraState$1(r),void 0===r.userPreferencesChangeListener&&(r.userPreferencesChangeListener=null),r.userPreferencesChangeListener=new e.UserPreferencesChangeListener(r),r}return __extends(i,t),i.prototype.addPropertyChangeListener=function(e,t){if(null!=e&&e instanceof HomeFurnitureGroup)for(var i=e.getFurniture(),n=0;n<i.length;n++){var o=i[n];this.addPropertyChangeListener(o,t)}else e.addPropertyChangeListener(t)},i.prototype.removePropertyChangeListener=function(e,t){if(null!=e&&e instanceof HomeFurnitureGroup)for(var i=e.getFurniture(),n=0;n<i.length;n++){var o=i[n];this.removePropertyChangeListener(o,t)}else e.removePropertyChangeListener(t)},i.prototype.enter=function(){this.topCamera=this.__parent.home.getCamera(),this.previousSelectionEmpty=0==this.__parent.home.getSelectedItems().length,this.aerialViewCenteredOnSelectionEnabled=this.__parent.preferences.isAerialViewCenteredOnSelectionEnabled(),this.updateCameraFromHomeBounds(!1,!1);for(var e,t=this.__parent.home.getLevels(),i=0;i<t.length;i++){t[i].addPropertyChangeListener(this.objectChangeListener)}this.__parent.home.addLevelsListener(null==(e=this.levelsListener)||"function"==typeof e?e:function(t){return(e.collectionChanged?e.collectionChanged:e).call(e,t)});for(t=this.__parent.home.getWalls(),i=0;i<t.length;i++){t[i].addPropertyChangeListener(this.objectChangeListener)}this.__parent.home.addWallsListener(function(e){return null==e||"function"==typeof e?e:function(t){return(e.collectionChanged?e.collectionChanged:e).call(e,t)}}(this.wallsListener));for(t=this.__parent.home.getFurniture(),i=0;i<t.length;i++){var n=t[i];this.addPropertyChangeListener(n,this.objectChangeListener)}this.__parent.home.addFurnitureListener(function(e){return null==e||"function"==typeof e?e:function(t){return(e.collectionChanged?e.collectionChanged:e).call(e,t)}}(this.furnitureListener));for(t=this.__parent.home.getRooms(),i=0;i<t.length;i++){t[i].addPropertyChangeListener(this.objectChangeListener)}this.__parent.home.addRoomsListener(function(e){return null==e||"function"==typeof e?e:function(t){return(e.collectionChanged?e.collectionChanged:e).call(e,t)}}(this.roomsListener));for(t=this.__parent.home.getPolylines(),i=0;i<t.length;i++){t[i].addPropertyChangeListener(this.objectChangeListener)}this.__parent.home.addPolylinesListener(function(e){return null==e||"function"==typeof e?e:function(t){return(e.collectionChanged?e.collectionChanged:e).call(e,t)}}(this.polylinesListener));for(t=this.__parent.home.getDimensionLines(),i=0;i<t.length;i++){t[i].addPropertyChangeListener(this.objectChangeListener)}this.__parent.home.addDimensionLinesListener(function(e){return null==e||"function"==typeof e?e:function(t){return(e.collectionChanged?e.collectionChanged:e).call(e,t)}}(this.dimensionLinesListener));for(t=this.__parent.home.getLabels(),i=0;i<t.length;i++){t[i].addPropertyChangeListener(this.objectChangeListener)}this.__parent.home.addLabelsListener(function(e){return null==e||"function"==typeof e?e:function(t){return(e.collectionChanged?e.collectionChanged:e).call(e,t)}}(this.labelsListener)),this.__parent.home.addSelectionListener(this.selectionListener),this.__parent.preferences.addPropertyChangeListener("AERIAL_VIEW_CENTERED_ON_SELECTION_ENABLED",this.userPreferencesChangeListener)},i.prototype.setAerialViewCenteredOnSelectionEnabled=function(e){this.aerialViewCenteredOnSelectionEnabled=e,this.updateCameraFromHomeBounds(!1,!1)},i.prototype.updateCameraFromHomeBounds=function(e,t){if(!this.isEditingState()){null==this.aerialViewBoundsLowerPoint&&this.updateAerialViewBoundsFromHomeBounds(this.aerialViewCenteredOnSelectionEnabled);var i=void 0;i=t&&this.__parent.preferences.isAerialViewCenteredOnSelectionEnabled()&&-1!==this.distanceToCenterWithSelection?this.distanceToCenterWithSelection:this.getCameraToAerialViewCenterDistance(),0!=this.__parent.home.getSelectedItems().length&&(this.distanceToCenterWithSelection=i),this.updateAerialViewBoundsFromHomeBounds(this.aerialViewCenteredOnSelectionEnabled),this.updateCameraIntervalToAerialViewCenter(),this.placeCameraAt(i,e)}},i.prototype.getCameraToAerialViewCenterDistance=function(){return Math.sqrt(Math.pow((this.aerialViewBoundsLowerPoint[0]+this.aerialViewBoundsUpperPoint[0])/2-this.topCamera.getX(),2)+Math.pow((this.aerialViewBoundsLowerPoint[1]+this.aerialViewBoundsUpperPoint[1])/2-this.topCamera.getY(),2)+Math.pow((this.aerialViewBoundsLowerPoint[2]+this.aerialViewBoundsUpperPoint[2])/2-this.topCamera.getZ(),2))},i.prototype.updateAerialViewBoundsFromHomeBounds=function(e){this.aerialViewBoundsLowerPoint=this.aerialViewBoundsUpperPoint=null;var t=[];if(e){t=[];for(var i=this.__parent.home.getSelectedItems(),n=0;n<i.length;n++){var o=i[n];!(null!=o&&null!=o.constructor&&null!=o.constructor.__interfaces&&o.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Elevatable")>=0&&this.isItemAtVisibleLevel(o))||null!=o&&o instanceof HomePieceOfFurniture&&!o.isVisible()||null!=o&&o instanceof Polyline&&!o.isVisibleIn3D()||null!=o&&o instanceof DimensionLine&&!o.isVisibleIn3D()||null!=o&&o instanceof Label&&null==o.getPitch()||t.push(o)}}var r=0===t.length||!e,l=!1;for(i=r?this.__parent.home.getWalls():Home.getWallsSubList(t),n=0;n<i.length;n++){var a=i[n];if(this.isItemAtVisibleLevel(a)){l=!0;var s=null!=a.getLevel()?a.getLevel().getElevation():0,h=r?0:s,u=a.getHeight(),d=void 0;d=null!=u?s+u:s+this.__parent.home.getWallHeight();var c=a.getHeightAtEnd();null!=c&&(d=Math.max(d,s+c));for(var p=a.getPoints$(),g=0;g<p.length;g++){var m=p[g];this.updateAerialViewBounds(m[0],m[1],h,d)}}}for(i=r?this.__parent.home.getFurniture():Home.getFurnitureSubList(t),n=0;n<i.length;n++){var f=i[n];if(f.isVisible()&&this.isItemAtVisibleLevel(f)){h=void 0,d=void 0;r?(h=Math.max(0,f.getGroundElevation()),d=Math.max(0,f.getGroundElevation()+f.getHeightInPlan())):(h=f.getGroundElevation(),d=f.getGroundElevation()+f.getHeightInPlan());for(p=f.getPoints(),g=0;g<p.length;g++){m=p[g];this.updateAerialViewBounds(m[0],m[1],h,d)}}}for(i=r?this.__parent.home.getRooms():Home.getRoomsSubList(t),n=0;n<i.length;n++){var v=i[n];if(this.isItemAtVisibleLevel(v)){h=0,d=this.MIN_HEIGHT;var _=v.getLevel();null!=_&&(h=_.getElevation()-_.getFloorThickness(),d=_.getElevation(),r&&(h=Math.max(0,h),d=Math.max(this.MIN_HEIGHT,_.getElevation())));for(p=v.getPoints(),g=0;g<p.length;g++){m=p[g];this.updateAerialViewBounds(m[0],m[1],h,d)}}}for(i=r?this.__parent.home.getPolylines():Home.getPolylinesSubList(t),n=0;n<i.length;n++){var S=i[n];if(S.isVisibleIn3D()&&this.isItemAtVisibleLevel(S)){h=void 0,d=void 0;r?(h=Math.max(0,S.getGroundElevation()),d=Math.max(this.MIN_HEIGHT,S.getGroundElevation())):h=d=S.getGroundElevation();for(p=S.getPoints(),g=0;g<p.length;g++){m=p[g];this.updateAerialViewBounds(m[0],m[1],h,d)}}}for(i=r?this.__parent.home.getDimensionLines():Home.getDimensionLinesSubList(t),n=0;n<i.length;n++){var y=i[n];if(y.isVisibleIn3D()&&this.isItemAtVisibleLevel(y)){var E=null!=y.getLevel()?y.getLevel().getElevation():0;h=void 0,d=void 0;r?(h=Math.max(0,E+y.getElevationStart()),d=Math.max(this.MIN_HEIGHT,E+y.getElevationEnd())):(h=E+y.getElevationStart(),d=E+y.getElevationEnd());for(p=y.getPoints(),g=0;g<p.length;g++){m=p[g];this.updateAerialViewBounds(m[0],m[1],h,d)}}}for(i=r?this.__parent.home.getLabels():Home.getLabelsSubList(t),n=0;n<i.length;n++){var C=i[n];if(null!=C.getPitch()&&this.isItemAtVisibleLevel(C)){h=void 0,d=void 0;r?(h=Math.max(0,C.getGroundElevation()),d=Math.max(this.MIN_HEIGHT,C.getGroundElevation())):h=d=C.getGroundElevation();for(p=C.getPoints(),g=0;g<p.length;g++){m=p[g];this.updateAerialViewBounds(m[0],m[1],h,d)}}}null==this.aerialViewBoundsLowerPoint?(this.aerialViewBoundsLowerPoint=[0,0,0],this.aerialViewBoundsUpperPoint=[this.MIN_WIDTH,this.MIN_DEPTH,this.MIN_HEIGHT]):l&&r&&(this.MIN_WIDTH>this.aerialViewBoundsUpperPoint[0]-this.aerialViewBoundsLowerPoint[0]&&(this.aerialViewBoundsLowerPoint[0]=(this.aerialViewBoundsLowerPoint[0]+this.aerialViewBoundsUpperPoint[0])/2-this.MIN_WIDTH/2,this.aerialViewBoundsUpperPoint[0]=this.aerialViewBoundsLowerPoint[0]+this.MIN_WIDTH),this.MIN_DEPTH>this.aerialViewBoundsUpperPoint[1]-this.aerialViewBoundsLowerPoint[1]&&(this.aerialViewBoundsLowerPoint[1]=(this.aerialViewBoundsLowerPoint[1]+this.aerialViewBoundsUpperPoint[1])/2-this.MIN_DEPTH/2,this.aerialViewBoundsUpperPoint[1]=this.aerialViewBoundsLowerPoint[1]+this.MIN_DEPTH),this.MIN_HEIGHT>this.aerialViewBoundsUpperPoint[2]-this.aerialViewBoundsLowerPoint[2]&&(this.aerialViewBoundsLowerPoint[2]=(this.aerialViewBoundsLowerPoint[2]+this.aerialViewBoundsUpperPoint[2])/2-this.MIN_HEIGHT/2,this.aerialViewBoundsUpperPoint[2]=this.aerialViewBoundsLowerPoint[2]+this.MIN_HEIGHT))},i.prototype.updateAerialViewBounds=function(e,t,i,n){null==this.aerialViewBoundsLowerPoint?(this.aerialViewBoundsLowerPoint=[e,t,i],this.aerialViewBoundsUpperPoint=[e,t,n]):(this.aerialViewBoundsLowerPoint[0]=Math.min(this.aerialViewBoundsLowerPoint[0],e),this.aerialViewBoundsUpperPoint[0]=Math.max(this.aerialViewBoundsUpperPoint[0],e),this.aerialViewBoundsLowerPoint[1]=Math.min(this.aerialViewBoundsLowerPoint[1],t),this.aerialViewBoundsUpperPoint[1]=Math.max(this.aerialViewBoundsUpperPoint[1],t),this.aerialViewBoundsLowerPoint[2]=Math.min(this.aerialViewBoundsLowerPoint[2],i),this.aerialViewBoundsUpperPoint[2]=Math.max(this.aerialViewBoundsUpperPoint[2],n))},i.prototype.isItemAtVisibleLevel=function(e){return null==e.getLevel()||e.getLevel().isViewableAndVisible()},i.prototype.updateCameraIntervalToAerialViewCenter=function(){var e=this.aerialViewBoundsUpperPoint[0]-this.aerialViewBoundsLowerPoint[0],t=this.aerialViewBoundsUpperPoint[1]-this.aerialViewBoundsLowerPoint[1],i=this.aerialViewBoundsUpperPoint[2]-this.aerialViewBoundsLowerPoint[2],n=Math.sqrt(e*e+t*t+i*i)/2;this.minDistanceToAerialViewCenter=1.05*n,this.maxDistanceToAerialViewCenter=Math.max(5*this.minDistanceToAerialViewCenter,5e3)},i.prototype.moveCamera=function(e){t.prototype.moveCamera.call(this,e),e*=5;var i=this.getCameraToAerialViewCenterDistance()-e;this.placeCameraAt(i,!1)},i.prototype.placeCameraAt=function(e,t){e=Math.max(e,this.minDistanceToAerialViewCenter),e=Math.min(e,this.maxDistanceToAerialViewCenter),t&&(e=Math.min(e,3*this.minDistanceToAerialViewCenter));var i=e*Math.cos(this.topCamera.getPitch());this.topCamera.setX((this.aerialViewBoundsLowerPoint[0]+this.aerialViewBoundsUpperPoint[0])/2+Math.sin(this.topCamera.getYaw())*i),this.topCamera.setY((this.aerialViewBoundsLowerPoint[1]+this.aerialViewBoundsUpperPoint[1])/2-Math.cos(this.topCamera.getYaw())*i),this.topCamera.setZ((this.aerialViewBoundsLowerPoint[2]+this.aerialViewBoundsUpperPoint[2])/2+Math.sin(this.topCamera.getPitch())*e)},i.prototype.rotateCameraYaw=function(e){t.prototype.rotateCameraYaw.call(this,e);var i=this.topCamera.getYaw()+e,n=this.getCameraToAerialViewCenterDistance()*Math.cos(this.topCamera.getPitch());this.topCamera.setYaw(i),this.topCamera.setX((this.aerialViewBoundsLowerPoint[0]+this.aerialViewBoundsUpperPoint[0])/2+Math.sin(i)*n),this.topCamera.setY((this.aerialViewBoundsLowerPoint[1]+this.aerialViewBoundsUpperPoint[1])/2-Math.cos(i)*n)},i.prototype.rotateCameraPitch=function(e){t.prototype.rotateCameraPitch.call(this,e);var i=this.topCamera.getPitch()+e;i=Math.max(i,0),i=Math.min(i,Math.PI/2);var n=this.getCameraToAerialViewCenterDistance(),o=n*Math.cos(i);this.topCamera.setPitch(i),this.topCamera.setX((this.aerialViewBoundsLowerPoint[0]+this.aerialViewBoundsUpperPoint[0])/2+Math.sin(this.topCamera.getYaw())*o),this.topCamera.setY((this.aerialViewBoundsLowerPoint[1]+this.aerialViewBoundsUpperPoint[1])/2-Math.cos(this.topCamera.getYaw())*o),this.topCamera.setZ((this.aerialViewBoundsLowerPoint[2]+this.aerialViewBoundsUpperPoint[2])/2+n*Math.sin(i))},i.prototype.goToCamera=function(e){t.prototype.goToCamera.call(this,e),this.topCamera.setCamera(e),this.topCamera.setTime(e.getTime()),this.topCamera.setLens(e.getLens()),this.topCamera.setRenderer(e.getRenderer()),this.updateCameraFromHomeBounds(!1,!1)},i.prototype.releaseMouse=function(e,i){t.prototype.releaseMouse.call(this,e,i),this.updateCameraFromHomeBounds(!1,!1)},i.prototype.exit=function(){this.topCamera=null;for(var e,t=this.__parent.home.getWalls(),i=0;i<t.length;i++){t[i].removePropertyChangeListener(this.objectChangeListener)}this.__parent.home.removeWallsListener(null==(e=this.wallsListener)||"function"==typeof e?e:function(t){return(e.collectionChanged?e.collectionChanged:e).call(e,t)});for(t=this.__parent.home.getFurniture(),i=0;i<t.length;i++){var n=t[i];this.removePropertyChangeListener(n,this.objectChangeListener)}this.__parent.home.removeFurnitureListener(function(e){return null==e||"function"==typeof e?e:function(t){return(e.collectionChanged?e.collectionChanged:e).call(e,t)}}(this.furnitureListener));for(t=this.__parent.home.getRooms(),i=0;i<t.length;i++){t[i].removePropertyChangeListener(this.objectChangeListener)}this.__parent.home.removeRoomsListener(function(e){return null==e||"function"==typeof e?e:function(t){return(e.collectionChanged?e.collectionChanged:e).call(e,t)}}(this.roomsListener));for(t=this.__parent.home.getPolylines(),i=0;i<t.length;i++){t[i].removePropertyChangeListener(this.objectChangeListener)}this.__parent.home.removePolylinesListener(function(e){return null==e||"function"==typeof e?e:function(t){return(e.collectionChanged?e.collectionChanged:e).call(e,t)}}(this.polylinesListener));for(t=this.__parent.home.getDimensionLines(),i=0;i<t.length;i++){t[i].removePropertyChangeListener(this.objectChangeListener)}this.__parent.home.removeDimensionLinesListener(function(e){return null==e||"function"==typeof e?e:function(t){return(e.collectionChanged?e.collectionChanged:e).call(e,t)}}(this.dimensionLinesListener));for(t=this.__parent.home.getLabels(),i=0;i<t.length;i++){t[i].removePropertyChangeListener(this.objectChangeListener)}this.__parent.home.removeLabelsListener(function(e){return null==e||"function"==typeof e?e:function(t){return(e.collectionChanged?e.collectionChanged:e).call(e,t)}}(this.labelsListener));for(t=this.__parent.home.getLevels(),i=0;i<t.length;i++){t[i].removePropertyChangeListener(this.objectChangeListener)}this.__parent.home.removeLevelsListener(function(e){return null==e||"function"==typeof e?e:function(t){return(e.collectionChanged?e.collectionChanged:e).call(e,t)}}(this.levelsListener)),this.__parent.home.removeSelectionListener(this.selectionListener),this.__parent.preferences.removePropertyChangeListener("AERIAL_VIEW_CENTERED_ON_SELECTION_ENABLED",this.userPreferencesChangeListener)},i}(e.EditingCameraState);e.TopCameraState=o,o.__class="com.eteks.sweethome3d.viewcontroller.HomeController3D.TopCameraState",function(e){var t=function(){function e(e){this.__parent=e}return e.prototype.propertyChange=function(e){this.__parent.updateCameraFromHomeBounds(!1,!1)},e}();e.TopCameraState$0=t;var i=function(){function e(e){this.__parent=e}return e.prototype.selectionChanged=function(e){var t=0==e.getSelectedItems().length;this.__parent.updateCameraFromHomeBounds(!1,this.__parent.previousSelectionEmpty&&!t),this.__parent.previousSelectionEmpty=t},e}();e.TopCameraState$1=i,i.__interfaces=["com.eteks.sweethome3d.model.SelectionListener"]}(o=e.TopCameraState||(e.TopCameraState={}));var r,l,a=function(e){function t(i){var n=e.call(this,i)||this;return n.__parent=i,void 0===n.observerCamera&&(n.observerCamera=null),n.levelElevationChangeListener=new t.ObserverCameraState$0(n),n.levelsListener=function(e){e.getType()===CollectionEvent.Type.ADD?e.getItem().addPropertyChangeListener(n.levelElevationChangeListener):e.getType()===CollectionEvent.Type.DELETE&&e.getItem().removePropertyChangeListener(n.levelElevationChangeListener),n.updateCameraMinimumElevation()},n}return __extends(t,e),t.prototype.enter=function(){this.observerCamera=this.__parent.home.getCamera();for(var e,t=this.__parent.home.getLevels(),i=0;i<t.length;i++){t[i].addPropertyChangeListener(this.levelElevationChangeListener)}this.__parent.home.addLevelsListener(null==(e=this.levelsListener)||"function"==typeof e?e:function(t){return(e.collectionChanged?e.collectionChanged:e).call(e,t)}),this.selectCamera()},t.prototype.selectCamera=function(){if(this.__parent.preferences.isObserverCameraSelectedAtChange()){var e=this.__parent.home.getSelectedItems();(!this.__parent.preferences.isEditingIn3DViewEnabled()||0==e.length||1===e.length&&e[0]===this.observerCamera)&&this.__parent.home.setSelectedItems([this.observerCamera].slice(0))}},t.prototype.moveCamera=function(t){e.prototype.moveCamera.call(this,t),this.observerCamera.setX(this.observerCamera.getX()-Math.sin(this.observerCamera.getYaw())*t),this.observerCamera.setY(this.observerCamera.getY()+Math.cos(this.observerCamera.getYaw())*t),this.selectCamera()},t.prototype.moveCameraSideways=function(t){e.prototype.moveCameraSideways.call(this,t),this.observerCamera.setX(this.observerCamera.getX()-Math.cos(this.observerCamera.getYaw())*t),this.observerCamera.setY(this.observerCamera.getY()-Math.sin(this.observerCamera.getYaw())*t),this.selectCamera()},t.prototype.elevateCamera=function(t){e.prototype.elevateCamera.call(this,t);var i=this.observerCamera.getZ()+t;i=Math.min(Math.max(i,this.getMinimumElevation()),this.__parent.preferences.getLengthUnit().getMaximumElevation()),this.observerCamera.setZ(i),this.selectCamera()},t.prototype.updateCameraMinimumElevation=function(){this.observerCamera.setZ(Math.max(this.observerCamera.getZ(),this.getMinimumElevation()))},t.prototype.getMinimumElevation=function(){var e=this.__parent.home.getLevels();return e.length>0?10+e[0].getElevation():10},t.prototype.rotateCameraYaw=function(t){e.prototype.rotateCameraYaw.call(this,t),this.observerCamera.setYaw(this.observerCamera.getYaw()+t),this.selectCamera()},t.prototype.rotateCameraPitch=function(t){e.prototype.rotateCameraPitch.call(this,t);var i=this.observerCamera.getPitch()+t;i=Math.min(Math.max(-Math.PI/2,i),Math.PI/2),this.observerCamera.setPitch(i),this.selectCamera()},t.prototype.modifyFieldOfView=function(t){e.prototype.modifyFieldOfView.call(this,t);var i=this.observerCamera.getFieldOfView()+t;i=Math.min(Math.max(2*Math.PI/180,i),120*Math.PI/180),this.observerCamera.setFieldOfView(i),this.selectCamera()},t.prototype.goToCamera=function(t){e.prototype.goToCamera.call(this,t),this.observerCamera.setCamera(t),this.observerCamera.setTime(t.getTime()),this.observerCamera.setLens(t.getLens()),this.observerCamera.setRenderer(t.getRenderer())},t.prototype.exit=function(){var e,t,i=this,n=this.__parent.home.getSelectedItems();n.indexOf(this.observerCamera)>=0&&(n=n.slice(0),(t=(e=n).indexOf(i.observerCamera))>=0&&e.splice(t,1),this.__parent.home.setSelectedItems(n));for(var o=this.__parent.home.getLevels(),r=0;r<o.length;r++){o[r].removePropertyChangeListener(this.levelElevationChangeListener)}this.__parent.home.removeLevelsListener(function(e){return null==e||"function"==typeof e?e:function(t){return(e.collectionChanged?e.collectionChanged:e).call(e,t)}}(this.levelsListener)),this.observerCamera=null},t}(e.EditingCameraState);e.ObserverCameraState=a,a.__class="com.eteks.sweethome3d.viewcontroller.HomeController3D.ObserverCameraState",r=a=e.ObserverCameraState||(e.ObserverCameraState={}),l=function(){function e(e){this.__parent=e}return e.prototype.propertyChange=function(e){"ELEVATION"===e.getPropertyName()&&this.__parent.updateCameraMinimumElevation()},e}(),r.ObserverCameraState$0=l;var s=function(){function e(e,t){this.home=t,this.__parent=e}return e.prototype.propertyChange=function(e){this.__parent.setCameraState(this.home.getCamera()===this.home.getTopCamera()?this.__parent.topCameraState:this.__parent.observerCameraState)},e}();e.HomeController3D$0=s;var h=function(){function e(e,t){this.home=t,this.__parent=e}return e.prototype.propertyChange=function(e){"ELEVATION"===e.getPropertyName()&&this.home.getEnvironment().isObserverCameraElevationAdjusted()&&this.home.getObserverCamera().setZ(Math.max(this.__parent.getObserverCameraMinimumElevation(this.home),this.home.getObserverCamera().getZ()+e.getNewValue()-e.getOldValue()))},e}();e.HomeController3D$1=h;var u=function(){function e(e,t,i){this.home=t,this.levelElevationChangeListener=i,this.__parent=e}return e.prototype.propertyChange=function(e){var t=e.getOldValue(),i=this.home.getSelectedLevel();this.home.getEnvironment().isObserverCameraElevationAdjusted()&&this.home.getObserverCamera().setZ(Math.max(this.__parent.getObserverCameraMinimumElevation(this.home),this.home.getObserverCamera().getZ()+(null==i?0:i.getElevation())-(null==t?0:t.getElevation()))),null!=t&&t.removePropertyChangeListener(this.levelElevationChangeListener),null!=i&&i.addPropertyChangeListener(this.levelElevationChangeListener)},e}();e.HomeController3D$2=u;var d=function(){function e(e,t){this.home=t,this.__parent=e}return e.prototype.propertyChange=function(e){for(var t=this.home.getLevels(),i=this.home.getSelectedLevel(),n=!0,o=0;o<t.length;o++)t[o].setVisible(n),t[o]!==i||this.home.getEnvironment().isAllLevelsVisible()||(n=!1)},e}();e.HomeController3D$3=d}(HomeController3D||(HomeController3D={})),function(e){var t=function(){function t(e){void 0===this.__name&&(this.__name=null),this.__name=e}return t.PLAN_IMAGE_$LI$=function(){return null==t.PLAN_IMAGE&&(t.PLAN_IMAGE=new e.DataType("PLAN_IMAGE")),t.PLAN_IMAGE},t.FURNITURE_LIST_$LI$=function(){return null==t.FURNITURE_LIST&&(t.FURNITURE_LIST=new e.DataType("FURNITURE_LIST")),t.FURNITURE_LIST},t.prototype.name=function(){return this.__name},t.prototype.toString=function(){return this.__name},t}();e.DataType=t,t.__class="com.eteks.sweethome3d.viewcontroller.TransferableView.DataType"}(TransferableView||(TransferableView={}));var ModelMaterialsController=function(){function e(e,t,i,n){void 0===this.title&&(this.title=null),void 0===this.preferences&&(this.preferences=null),void 0===this.viewFactory&&(this.viewFactory=null),void 0===this.contentManager&&(this.contentManager=null),void 0===this.propertyChangeSupport&&(this.propertyChangeSupport=null),void 0===this.materialsChoiceView&&(this.materialsChoiceView=null),void 0===this.textureController&&(this.textureController=null),void 0===this.model&&(this.model=null),void 0===this.modelCreator&&(this.modelCreator=null),void 0===this.modelWidth&&(this.modelWidth=0),void 0===this.modelDepth&&(this.modelDepth=0),void 0===this.modelHeight&&(this.modelHeight=0),void 0===this.modelRotation&&(this.modelRotation=null),void 0===this.modelTransformations&&(this.modelTransformations=null),void 0===this.modelFlags&&(this.modelFlags=0),void 0===this.materials&&(this.materials=null),this.title=e,this.preferences=t,this.viewFactory=i,this.contentManager=n,this.propertyChangeSupport=new PropertyChangeSupport(this)}return e.prototype.getView=function(){return null==this.materialsChoiceView&&(this.materialsChoiceView=this.viewFactory.createModelMaterialsView(this.preferences,this)),this.materialsChoiceView},e.prototype.addPropertyChangeListener=function(e,t){this.propertyChangeSupport.addPropertyChangeListener(e,t)},e.prototype.removePropertyChangeListener=function(e,t){this.propertyChangeSupport.removePropertyChangeListener(e,t)},e.prototype.setModel=function(e){if(this.model!==e){var t=this.model;this.model=e,this.propertyChangeSupport.firePropertyChange("MODEL",t,e)}},e.prototype.getModel=function(){return this.model},e.prototype.setModelCreator=function(e){this.modelCreator=e},e.prototype.getModelCreator=function(){return this.modelCreator},e.prototype.setModelRotation=function(e){this.modelRotation=e},e.prototype.getModelRotation=function(){return this.modelRotation},e.prototype.setModelTransformations=function(e){this.modelTransformations=e},e.prototype.getModelTransformations=function(){return this.modelTransformations},e.prototype.setModelSize=function(e,t,i){this.modelWidth=e,this.modelDepth=t,this.modelHeight=i},e.prototype.getModelWidth=function(){return this.modelWidth},e.prototype.getModelDepth=function(){return this.modelDepth},e.prototype.getModelHeight=function(){return this.modelHeight},e.prototype.setBackFaceShown=function(e){this.setModelFlags(this.getModelFlags()&~PieceOfFurniture.SHOW_BACK_FACE|(e?PieceOfFurniture.SHOW_BACK_FACE:0))},e.prototype.isBackFaceShown=function(){return(this.modelFlags&PieceOfFurniture.SHOW_BACK_FACE)===PieceOfFurniture.SHOW_BACK_FACE},e.prototype.setModelFlags=function(e){this.modelFlags=e},e.prototype.getModelFlags=function(){return this.modelFlags},e.prototype.setMaterials=function(e){if(!function(e,t){if(null==e&&null==t)return!0;if(null==e||null==t)return!1;if(e.length!=t.length)return!1;for(var i=0;i<e.length;i++)if(e[i]!=t[i])return!1;return!0}(this.materials,e)){var t=this.materials;this.materials=e,this.propertyChangeSupport.firePropertyChange("MATERIALS",t,e)}},e.prototype.getMaterials=function(){return this.materials},e.prototype.getDialogTitle=function(){return this.title},e.prototype.getTextureController=function(){return null==this.textureController&&(this.textureController=new TextureChoiceController(this.preferences.getLocalizedString(e,"textureTitle"),this.preferences,this.viewFactory,this.contentManager)),this.textureController},e}();ModelMaterialsController.__class="com.eteks.sweethome3d.viewcontroller.ModelMaterialsController",ModelMaterialsController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"];var WizardController=function(){function e(t,i){void 0===this.preferences&&(this.preferences=null),void 0===this.viewFactory&&(this.viewFactory=null),void 0===this.propertyChangeSupport&&(this.propertyChangeSupport=null),void 0===this.stepStatePropertyChangeListener&&(this.stepStatePropertyChangeListener=null),void 0===this.wizardView&&(this.wizardView=null),void 0===this.stepState&&(this.stepState=null),void 0===this.backStepEnabled&&(this.backStepEnabled=!1),void 0===this.nextStepEnabled&&(this.nextStepEnabled=!1),void 0===this.lastStep&&(this.lastStep=!1),void 0===this.stepView&&(this.stepView=null),void 0===this.stepIcon&&(this.stepIcon=null),void 0===this.title&&(this.title=null),void 0===this.resizable&&(this.resizable=!1),this.preferences=t,this.viewFactory=i,this.stepStatePropertyChangeListener=new e.WizardController$0(this),this.propertyChangeSupport=new PropertyChangeSupport(this)}return e.prototype.getView=function(){return null==this.wizardView&&(this.wizardView=this.viewFactory.createWizardView(this.preferences,this)),this.wizardView},e.prototype.displayView=function(e){this.getView().displayView(e)},e.prototype.addPropertyChangeListener=function(e,t){this.propertyChangeSupport.addPropertyChangeListener(e,t)},e.prototype.removePropertyChangeListener=function(e,t){this.propertyChangeSupport.removePropertyChangeListener(e,t)},e.prototype.setBackStepEnabled=function(e){e!==this.backStepEnabled&&(this.backStepEnabled=e,this.propertyChangeSupport.firePropertyChange("BACK_STEP_ENABLED",!e,e))},e.prototype.isBackStepEnabled=function(){return this.backStepEnabled},e.prototype.setNextStepEnabled=function(e){e!==this.nextStepEnabled&&(this.nextStepEnabled=e,this.propertyChangeSupport.firePropertyChange("NEXT_STEP_ENABLED",!e,e))},e.prototype.isNextStepEnabled=function(){return this.nextStepEnabled},e.prototype.setLastStep=function(e){e!==this.lastStep&&(this.lastStep=e,this.propertyChangeSupport.firePropertyChange("LAST_STEP",!e,e))},e.prototype.isLastStep=function(){return this.lastStep},e.prototype.setStepView=function(e){if(e!==this.stepView){var t=this.stepView;this.stepView=e,this.propertyChangeSupport.firePropertyChange("STEP_VIEW",t,e)}},e.prototype.getStepView=function(){return this.stepView},e.prototype.setStepIcon=function(e){if(e!==this.stepIcon){var t=this.stepIcon;this.stepIcon=e,this.propertyChangeSupport.firePropertyChange("STEP_ICON",t,e)}},e.prototype.getStepIcon=function(){return this.stepIcon},e.prototype.setTitle=function(e){if(e!==this.title){var t=this.title;this.title=e,this.propertyChangeSupport.firePropertyChange("TITLE",t,e)}},e.prototype.getTitle=function(){return this.title},e.prototype.setResizable=function(e){e!==this.resizable&&(this.resizable=e,this.propertyChangeSupport.firePropertyChange("RESIZABLE",!e,e))},e.prototype.isResizable=function(){return this.resizable},e.prototype.setStepState=function(e){null!=this.stepState&&(this.stepState.exit(),this.stepState.removePropertyChangeListener(this.stepStatePropertyChangeListener)),this.stepState=e,this.setBackStepEnabled(!e.isFirstStep()),this.setNextStepEnabled(e.isNextStepEnabled()),this.setStepView(e.getView()),this.setStepIcon(e.getIcon()),this.setLastStep(e.isLastStep()),this.stepState.addPropertyChangeListener(this.stepStatePropertyChangeListener),this.stepState.enter()},e.prototype.getStepState=function(){return this.stepState},e.prototype.goToNextStep=function(){this.stepState.goToNextStep()},e.prototype.goBackToPreviousStep=function(){this.stepState.goBackToPreviousStep()},e}();WizardController.__class="com.eteks.sweethome3d.viewcontroller.WizardController",WizardController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"],function(e){var t=function(){function e(){void 0===this.propertyChangeSupport&&(this.propertyChangeSupport=null),void 0===this.firstStep&&(this.firstStep=!1),void 0===this.lastStep&&(this.lastStep=!1),void 0===this.nextStepEnabled&&(this.nextStepEnabled=!1),this.propertyChangeSupport=new PropertyChangeSupport(this)}return e.prototype.addPropertyChangeListener=function(e){this.propertyChangeSupport.addPropertyChangeListener(e)},e.prototype.removePropertyChangeListener=function(e){this.propertyChangeSupport.removePropertyChangeListener(e)},e.prototype.enter=function(){},e.prototype.exit=function(){},e.prototype.getIcon=function(){return null},e.prototype.goBackToPreviousStep=function(){},e.prototype.goToNextStep=function(){},e.prototype.isFirstStep=function(){return this.firstStep},e.prototype.setFirstStep=function(e){e!==this.firstStep&&(this.firstStep=e,this.propertyChangeSupport.firePropertyChange("FIRST_STEP",!e,e))},e.prototype.isLastStep=function(){return this.lastStep},e.prototype.setLastStep=function(e){e!==this.lastStep&&(this.lastStep=e,this.propertyChangeSupport.firePropertyChange("LAST_STEP",!e,e))},e.prototype.isNextStepEnabled=function(){return this.nextStepEnabled},e.prototype.setNextStepEnabled=function(e){e!==this.nextStepEnabled&&(this.nextStepEnabled=e,this.propertyChangeSupport.firePropertyChange("NEXT_STEP_ENABLED",!e,e))},e}();e.WizardControllerStepState=t,t.__class="com.eteks.sweethome3d.viewcontroller.WizardController.WizardControllerStepState";var i=function(){function e(e){this.__parent=e}return e.prototype.propertyChange=function(e){switch(e.getPropertyName()){case"FIRST_STEP":this.__parent.setBackStepEnabled(!this.__parent.stepState.isFirstStep());break;case"LAST_STEP":this.__parent.setLastStep(this.__parent.stepState.isLastStep());break;case"NEXT_STEP_ENABLED":this.__parent.setNextStepEnabled(this.__parent.stepState.isNextStepEnabled())}},e}();e.WizardController$0=i}(WizardController||(WizardController={}));var HomeView,BaseboardChoiceController=function(){function e(e,t,i){void 0===this.preferences&&(this.preferences=null),void 0===this.viewFactory&&(this.viewFactory=null),void 0===this.contentManager&&(this.contentManager=null),void 0===this.textureController&&(this.textureController=null),void 0===this.propertyChangeSupport&&(this.propertyChangeSupport=null),void 0===this.view&&(this.view=null),void 0===this.visible&&(this.visible=null),void 0===this.thickness&&(this.thickness=null),void 0===this.height&&(this.height=null),void 0===this.maxHeight&&(this.maxHeight=null),void 0===this.color&&(this.color=null),void 0===this.paint&&(this.paint=null),this.preferences=e,this.viewFactory=t,this.contentManager=i,this.propertyChangeSupport=new PropertyChangeSupport(this)}return e.prototype.getTextureController=function(){return null==this.textureController&&(this.textureController=new TextureChoiceController(this.preferences.getLocalizedString(e,"baseboardTextureTitle"),this.preferences,this.viewFactory,this.contentManager),this.textureController.addPropertyChangeListener("TEXTURE",new e.BaseboardChoiceController$0(this))),this.textureController},e.prototype.getView=function(){return null==this.view&&(this.view=this.viewFactory.createBaseboardChoiceView(this.preferences,this)),this.view},e.prototype.addPropertyChangeListener=function(e,t){this.propertyChangeSupport.addPropertyChangeListener(e,t)},e.prototype.removePropertyChangeListener=function(e,t){this.propertyChangeSupport.removePropertyChangeListener(e,t)},e.prototype.getVisible=function(){return this.visible},e.prototype.setVisible=function(e){if(e!==this.visible){var t=this.visible;this.visible=e,this.propertyChangeSupport.firePropertyChange("VISIBLE",t,e)}},e.prototype.setThickness=function(e){if(e!==this.thickness){var t=this.thickness;this.thickness=e,this.propertyChangeSupport.firePropertyChange("THICKNESS",t,e)}},e.prototype.getThickness=function(){return this.thickness},e.prototype.setHeight=function(e){if(e!==this.height){var t=this.height;this.height=e,this.propertyChangeSupport.firePropertyChange("HEIGHT",t,e)}},e.prototype.getHeight=function(){return this.height},e.prototype.setMaxHeight=function(e){if(null==this.maxHeight||e!==this.maxHeight){var t=this.maxHeight;this.maxHeight=e,this.propertyChangeSupport.firePropertyChange("MAX_HEIGHT",t,e)}},e.prototype.getMaxHeight=function(){return this.maxHeight},e.prototype.setColor=function(t){if(t!==this.color){var i=this.color;this.color=t,this.propertyChangeSupport.firePropertyChange("COLOR",i,t),this.setPaint(e.BaseboardPaint.COLORED)}},e.prototype.getColor=function(){return this.color},e.prototype.setPaint=function(e){if(e!==this.paint){var t=this.paint;this.paint=e,this.propertyChangeSupport.firePropertyChange("PAINT",t,e)}},e.prototype.getPaint=function(){return this.paint},e.prototype.setBaseboard=function(t){null==t?(this.setVisible(!1),this.setThickness(null),this.setHeight(null),this.setColor(null),this.getTextureController().setTexture(null),this.setPaint(null)):(this.setVisible(!0),this.setThickness(t.getThickness()),this.setHeight(t.getHeight()),null!=t.getTexture()?(this.setColor(null),this.getTextureController().setTexture(t.getTexture()),this.setPaint(e.BaseboardPaint.TEXTURED)):null!=t.getColor()?(this.getTextureController().setTexture(null),this.setColor(t.getColor())):(this.setColor(null),this.getTextureController().setTexture(null),this.setPaint(e.BaseboardPaint.DEFAULT)))},e}();BaseboardChoiceController.__class="com.eteks.sweethome3d.viewcontroller.BaseboardChoiceController",BaseboardChoiceController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"],function(e){var t;(t=e.BaseboardPaint||(e.BaseboardPaint={}))[t.DEFAULT=0]="DEFAULT",t[t.COLORED=1]="COLORED",t[t.TEXTURED=2]="TEXTURED";var i=function(){function t(e){this.__parent=e}return t.prototype.propertyChange=function(t){this.__parent.setPaint(e.BaseboardPaint.TEXTURED)},t}();e.BaseboardChoiceController$0=i}(BaseboardChoiceController||(BaseboardChoiceController={})),function(e){e.SORT_HOME_FURNITURE_ADDITIONAL_PROPERTY_ACTION_PREFIX="SORT_HOME_FURNITURE_ADDITIONAL_PROPERTY_BY_",e.DISPLAY_HOME_FURNITURE_ADDITIONAL_PROPERTY_ACTION_PREFIX="DISPLAY_HOME_FURNITURE_ADDITIONAL_PROPERTY_"}(HomeView||(HomeView={})),function(e){var t;(t=e.ActionType||(e.ActionType={}))[t.NEW_HOME=0]="NEW_HOME",t[t.NEW_HOME_FROM_EXAMPLE=1]="NEW_HOME_FROM_EXAMPLE",t[t.CLOSE=2]="CLOSE",t[t.OPEN=3]="OPEN",t[t.DELETE_RECENT_HOMES=4]="DELETE_RECENT_HOMES",t[t.SAVE=5]="SAVE",t[t.SAVE_AS=6]="SAVE_AS",t[t.SAVE_AND_COMPRESS=7]="SAVE_AND_COMPRESS",t[t.PAGE_SETUP=8]="PAGE_SETUP",t[t.PRINT_PREVIEW=9]="PRINT_PREVIEW",t[t.PRINT=10]="PRINT",t[t.PRINT_TO_PDF=11]="PRINT_TO_PDF",t[t.PREFERENCES=12]="PREFERENCES",t[t.EXIT=13]="EXIT",t[t.UNDO=14]="UNDO",t[t.REDO=15]="REDO",t[t.CUT=16]="CUT",t[t.COPY=17]="COPY",t[t.PASTE=18]="PASTE",t[t.PASTE_TO_GROUP=19]="PASTE_TO_GROUP",t[t.PASTE_STYLE=20]="PASTE_STYLE",t[t.DELETE=21]="DELETE",t[t.SELECT_ALL=22]="SELECT_ALL",t[t.SELECT_ALL_AT_ALL_LEVELS=23]="SELECT_ALL_AT_ALL_LEVELS",t[t.ADD_HOME_FURNITURE=24]="ADD_HOME_FURNITURE",t[t.ADD_FURNITURE_TO_GROUP=25]="ADD_FURNITURE_TO_GROUP",t[t.DELETE_HOME_FURNITURE=26]="DELETE_HOME_FURNITURE",t[t.MODIFY_FURNITURE=27]="MODIFY_FURNITURE",t[t.IMPORT_FURNITURE=28]="IMPORT_FURNITURE",t[t.IMPORT_FURNITURE_LIBRARY=29]="IMPORT_FURNITURE_LIBRARY",t[t.IMPORT_TEXTURE=30]="IMPORT_TEXTURE",t[t.IMPORT_TEXTURES_LIBRARY=31]="IMPORT_TEXTURES_LIBRARY",t[t.SORT_HOME_FURNITURE_BY_CATALOG_ID=32]="SORT_HOME_FURNITURE_BY_CATALOG_ID",t[t.SORT_HOME_FURNITURE_BY_NAME=33]="SORT_HOME_FURNITURE_BY_NAME",t[t.SORT_HOME_FURNITURE_BY_DESCRIPTION=34]="SORT_HOME_FURNITURE_BY_DESCRIPTION",t[t.SORT_HOME_FURNITURE_BY_CREATOR=35]="SORT_HOME_FURNITURE_BY_CREATOR",t[t.SORT_HOME_FURNITURE_BY_LICENSE=36]="SORT_HOME_FURNITURE_BY_LICENSE",t[t.SORT_HOME_FURNITURE_BY_WIDTH=37]="SORT_HOME_FURNITURE_BY_WIDTH",t[t.SORT_HOME_FURNITURE_BY_DEPTH=38]="SORT_HOME_FURNITURE_BY_DEPTH",t[t.SORT_HOME_FURNITURE_BY_HEIGHT=39]="SORT_HOME_FURNITURE_BY_HEIGHT",t[t.SORT_HOME_FURNITURE_BY_X=40]="SORT_HOME_FURNITURE_BY_X",t[t.SORT_HOME_FURNITURE_BY_Y=41]="SORT_HOME_FURNITURE_BY_Y",t[t.SORT_HOME_FURNITURE_BY_ELEVATION=42]="SORT_HOME_FURNITURE_BY_ELEVATION",t[t.SORT_HOME_FURNITURE_BY_ANGLE=43]="SORT_HOME_FURNITURE_BY_ANGLE",t[t.SORT_HOME_FURNITURE_BY_LEVEL=44]="SORT_HOME_FURNITURE_BY_LEVEL",t[t.SORT_HOME_FURNITURE_BY_MODEL_SIZE=45]="SORT_HOME_FURNITURE_BY_MODEL_SIZE",t[t.SORT_HOME_FURNITURE_BY_COLOR=46]="SORT_HOME_FURNITURE_BY_COLOR",t[t.SORT_HOME_FURNITURE_BY_TEXTURE=47]="SORT_HOME_FURNITURE_BY_TEXTURE",t[t.SORT_HOME_FURNITURE_BY_MOVABILITY=48]="SORT_HOME_FURNITURE_BY_MOVABILITY",t[t.SORT_HOME_FURNITURE_BY_TYPE=49]="SORT_HOME_FURNITURE_BY_TYPE",t[t.SORT_HOME_FURNITURE_BY_VISIBILITY=50]="SORT_HOME_FURNITURE_BY_VISIBILITY",t[t.SORT_HOME_FURNITURE_BY_PRICE=51]="SORT_HOME_FURNITURE_BY_PRICE",t[t.SORT_HOME_FURNITURE_BY_VALUE_ADDED_TAX_PERCENTAGE=52]="SORT_HOME_FURNITURE_BY_VALUE_ADDED_TAX_PERCENTAGE",t[t.SORT_HOME_FURNITURE_BY_VALUE_ADDED_TAX=53]="SORT_HOME_FURNITURE_BY_VALUE_ADDED_TAX",t[t.SORT_HOME_FURNITURE_BY_PRICE_VALUE_ADDED_TAX_INCLUDED=54]="SORT_HOME_FURNITURE_BY_PRICE_VALUE_ADDED_TAX_INCLUDED",t[t.SORT_HOME_FURNITURE_BY_DESCENDING_ORDER=55]="SORT_HOME_FURNITURE_BY_DESCENDING_ORDER",t[t.DISPLAY_HOME_FURNITURE_CATALOG_ID=56]="DISPLAY_HOME_FURNITURE_CATALOG_ID",t[t.DISPLAY_HOME_FURNITURE_NAME=57]="DISPLAY_HOME_FURNITURE_NAME",t[t.DISPLAY_HOME_FURNITURE_DESCRIPTION=58]="DISPLAY_HOME_FURNITURE_DESCRIPTION",t[t.DISPLAY_HOME_FURNITURE_CREATOR=59]="DISPLAY_HOME_FURNITURE_CREATOR",t[t.DISPLAY_HOME_FURNITURE_LICENSE=60]="DISPLAY_HOME_FURNITURE_LICENSE",t[t.DISPLAY_HOME_FURNITURE_WIDTH=61]="DISPLAY_HOME_FURNITURE_WIDTH",t[t.DISPLAY_HOME_FURNITURE_DEPTH=62]="DISPLAY_HOME_FURNITURE_DEPTH",t[t.DISPLAY_HOME_FURNITURE_HEIGHT=63]="DISPLAY_HOME_FURNITURE_HEIGHT",t[t.DISPLAY_HOME_FURNITURE_X=64]="DISPLAY_HOME_FURNITURE_X",t[t.DISPLAY_HOME_FURNITURE_Y=65]="DISPLAY_HOME_FURNITURE_Y",t[t.DISPLAY_HOME_FURNITURE_ELEVATION=66]="DISPLAY_HOME_FURNITURE_ELEVATION",t[t.DISPLAY_HOME_FURNITURE_ANGLE=67]="DISPLAY_HOME_FURNITURE_ANGLE",t[t.DISPLAY_HOME_FURNITURE_LEVEL=68]="DISPLAY_HOME_FURNITURE_LEVEL",t[t.DISPLAY_HOME_FURNITURE_MODEL_SIZE=69]="DISPLAY_HOME_FURNITURE_MODEL_SIZE",t[t.DISPLAY_HOME_FURNITURE_COLOR=70]="DISPLAY_HOME_FURNITURE_COLOR",t[t.DISPLAY_HOME_FURNITURE_TEXTURE=71]="DISPLAY_HOME_FURNITURE_TEXTURE",t[t.DISPLAY_HOME_FURNITURE_MOVABLE=72]="DISPLAY_HOME_FURNITURE_MOVABLE",t[t.DISPLAY_HOME_FURNITURE_DOOR_OR_WINDOW=73]="DISPLAY_HOME_FURNITURE_DOOR_OR_WINDOW",t[t.DISPLAY_HOME_FURNITURE_VISIBLE=74]="DISPLAY_HOME_FURNITURE_VISIBLE",t[t.DISPLAY_HOME_FURNITURE_PRICE=75]="DISPLAY_HOME_FURNITURE_PRICE",t[t.DISPLAY_HOME_FURNITURE_VALUE_ADDED_TAX_PERCENTAGE=76]="DISPLAY_HOME_FURNITURE_VALUE_ADDED_TAX_PERCENTAGE",t[t.DISPLAY_HOME_FURNITURE_VALUE_ADDED_TAX=77]="DISPLAY_HOME_FURNITURE_VALUE_ADDED_TAX",t[t.DISPLAY_HOME_FURNITURE_PRICE_VALUE_ADDED_TAX_INCLUDED=78]="DISPLAY_HOME_FURNITURE_PRICE_VALUE_ADDED_TAX_INCLUDED",t[t.ALIGN_FURNITURE_ON_TOP=79]="ALIGN_FURNITURE_ON_TOP",t[t.ALIGN_FURNITURE_ON_BOTTOM=80]="ALIGN_FURNITURE_ON_BOTTOM",t[t.ALIGN_FURNITURE_ON_LEFT=81]="ALIGN_FURNITURE_ON_LEFT",t[t.ALIGN_FURNITURE_ON_RIGHT=82]="ALIGN_FURNITURE_ON_RIGHT",t[t.ALIGN_FURNITURE_ON_FRONT_SIDE=83]="ALIGN_FURNITURE_ON_FRONT_SIDE",t[t.ALIGN_FURNITURE_ON_BACK_SIDE=84]="ALIGN_FURNITURE_ON_BACK_SIDE",t[t.ALIGN_FURNITURE_ON_LEFT_SIDE=85]="ALIGN_FURNITURE_ON_LEFT_SIDE",t[t.ALIGN_FURNITURE_ON_RIGHT_SIDE=86]="ALIGN_FURNITURE_ON_RIGHT_SIDE",t[t.ALIGN_FURNITURE_SIDE_BY_SIDE=87]="ALIGN_FURNITURE_SIDE_BY_SIDE",t[t.DISTRIBUTE_FURNITURE_HORIZONTALLY=88]="DISTRIBUTE_FURNITURE_HORIZONTALLY",t[t.DISTRIBUTE_FURNITURE_VERTICALLY=89]="DISTRIBUTE_FURNITURE_VERTICALLY",t[t.RESET_FURNITURE_ELEVATION=90]="RESET_FURNITURE_ELEVATION",t[t.GROUP_FURNITURE=91]="GROUP_FURNITURE",t[t.UNGROUP_FURNITURE=92]="UNGROUP_FURNITURE",t[t.EXPORT_TO_CSV=93]="EXPORT_TO_CSV",t[t.SELECT=94]="SELECT",t[t.PAN=95]="PAN",t[t.CREATE_WALLS=96]="CREATE_WALLS",t[t.CREATE_ROOMS=97]="CREATE_ROOMS",t[t.CREATE_DIMENSION_LINES=98]="CREATE_DIMENSION_LINES",t[t.CREATE_POLYLINES=99]="CREATE_POLYLINES",t[t.CREATE_LABELS=100]="CREATE_LABELS",t[t.DELETE_SELECTION=101]="DELETE_SELECTION",t[t.LOCK_BASE_PLAN=102]="LOCK_BASE_PLAN",t[t.UNLOCK_BASE_PLAN=103]="UNLOCK_BASE_PLAN",t[t.ENABLE_MAGNETISM=104]="ENABLE_MAGNETISM",t[t.DISABLE_MAGNETISM=105]="DISABLE_MAGNETISM",t[t.FLIP_HORIZONTALLY=106]="FLIP_HORIZONTALLY",t[t.FLIP_VERTICALLY=107]="FLIP_VERTICALLY",t[t.MODIFY_COMPASS=108]="MODIFY_COMPASS",t[t.MODIFY_WALL=109]="MODIFY_WALL",t[t.JOIN_WALLS=110]="JOIN_WALLS",t[t.REVERSE_WALL_DIRECTION=111]="REVERSE_WALL_DIRECTION",t[t.SPLIT_WALL=112]="SPLIT_WALL",t[t.MODIFY_ROOM=113]="MODIFY_ROOM",t[t.RECOMPUTE_ROOM_POINTS=114]="RECOMPUTE_ROOM_POINTS",t[t.ADD_ROOM_POINT=115]="ADD_ROOM_POINT",t[t.DELETE_ROOM_POINT=116]="DELETE_ROOM_POINT",t[t.MODIFY_POLYLINE=117]="MODIFY_POLYLINE",t[t.MODIFY_DIMENSION_LINE=118]="MODIFY_DIMENSION_LINE",t[t.MODIFY_LABEL=119]="MODIFY_LABEL",t[t.INCREASE_TEXT_SIZE=120]="INCREASE_TEXT_SIZE",t[t.DECREASE_TEXT_SIZE=121]="DECREASE_TEXT_SIZE",t[t.TOGGLE_BOLD_STYLE=122]="TOGGLE_BOLD_STYLE",t[t.TOGGLE_ITALIC_STYLE=123]="TOGGLE_ITALIC_STYLE",t[t.IMPORT_BACKGROUND_IMAGE=124]="IMPORT_BACKGROUND_IMAGE",t[t.MODIFY_BACKGROUND_IMAGE=125]="MODIFY_BACKGROUND_IMAGE",t[t.HIDE_BACKGROUND_IMAGE=126]="HIDE_BACKGROUND_IMAGE",t[t.SHOW_BACKGROUND_IMAGE=127]="SHOW_BACKGROUND_IMAGE",t[t.DELETE_BACKGROUND_IMAGE=128]="DELETE_BACKGROUND_IMAGE",t[t.ADD_LEVEL=129]="ADD_LEVEL",t[t.ADD_LEVEL_AT_SAME_ELEVATION=130]="ADD_LEVEL_AT_SAME_ELEVATION",t[t.MAKE_LEVEL_VIEWABLE=131]="MAKE_LEVEL_VIEWABLE",t[t.MAKE_LEVEL_UNVIEWABLE=132]="MAKE_LEVEL_UNVIEWABLE",t[t.MAKE_LEVEL_ONLY_VIEWABLE_ONE=133]="MAKE_LEVEL_ONLY_VIEWABLE_ONE",t[t.MAKE_ALL_LEVELS_VIEWABLE=134]="MAKE_ALL_LEVELS_VIEWABLE",t[t.MODIFY_LEVEL=135]="MODIFY_LEVEL",t[t.DELETE_LEVEL=136]="DELETE_LEVEL",t[t.ZOOM_OUT=137]="ZOOM_OUT",t[t.ZOOM_IN=138]="ZOOM_IN",t[t.EXPORT_TO_SVG=139]="EXPORT_TO_SVG",t[t.SELECT_OBJECT=140]="SELECT_OBJECT",t[t.TOGGLE_SELECTION=141]="TOGGLE_SELECTION",t[t.VIEW_FROM_TOP=142]="VIEW_FROM_TOP",t[t.VIEW_FROM_OBSERVER=143]="VIEW_FROM_OBSERVER",t[t.MODIFY_OBSERVER=144]="MODIFY_OBSERVER",t[t.STORE_POINT_OF_VIEW=145]="STORE_POINT_OF_VIEW",t[t.DELETE_POINTS_OF_VIEW=146]="DELETE_POINTS_OF_VIEW",t[t.CREATE_PHOTOS_AT_POINTS_OF_VIEW=147]="CREATE_PHOTOS_AT_POINTS_OF_VIEW",t[t.DETACH_3D_VIEW=148]="DETACH_3D_VIEW",t[t.ATTACH_3D_VIEW=149]="ATTACH_3D_VIEW",t[t.DISPLAY_ALL_LEVELS=150]="DISPLAY_ALL_LEVELS",t[t.DISPLAY_SELECTED_LEVEL=151]="DISPLAY_SELECTED_LEVEL",t[t.MODIFY_3D_ATTRIBUTES=152]="MODIFY_3D_ATTRIBUTES",t[t.CREATE_PHOTO=153]="CREATE_PHOTO",t[t.CREATE_VIDEO=154]="CREATE_VIDEO",t[t.EXPORT_TO_OBJ=155]="EXPORT_TO_OBJ",t[t.HELP=156]="HELP",t[t.ABOUT=157]="ABOUT",function(e){e[e.SAVE=0]="SAVE",e[e.CANCEL=1]="CANCEL",e[e.DO_NOT_SAVE=2]="DO_NOT_SAVE"}(e.SaveAnswer||(e.SaveAnswer={})),function(e){e[e.REMOVE_DAMAGED_ITEMS=0]="REMOVE_DAMAGED_ITEMS",e[e.REPLACE_DAMAGED_ITEMS=1]="REPLACE_DAMAGED_ITEMS",e[e.DO_NOT_OPEN_HOME=2]="DO_NOT_OPEN_HOME"}(e.OpenDamagedHomeAnswer||(e.OpenDamagedHomeAnswer={}))}(HomeView||(HomeView={}));var FurnitureCatalogController=function(){function e(t,i,n,o){if((null!=t&&t instanceof FurnitureCatalog||null===t)&&(null!=i&&i instanceof UserPreferences||null===i)&&(null!=n&&null!=n.constructor&&null!=n.constructor.__interfaces&&n.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0||null===n)&&(null!=o&&null!=o.constructor&&null!=o.constructor.__interfaces&&o.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ContentManager")>=0||null===o)){void 0===this.catalog&&(this.catalog=null),void 0===this.preferences&&(this.preferences=null),void 0===this.viewFactory&&(this.viewFactory=null),void 0===this.contentManager&&(this.contentManager=null),void 0===this.selectionListeners&&(this.selectionListeners=null),void 0===this.selectedFurniture&&(this.selectedFurniture=null),void 0===this.catalogView&&(this.catalogView=null),this.catalog=t,this.preferences=i,this.viewFactory=n,this.contentManager=o,this.selectionListeners=[],this.selectedFurniture=[],this.catalog.addFurnitureListener(null==(a=new e.FurnitureCatalogChangeListener(this))||"function"==typeof a?a:function(e){return(a.collectionChanged?a.collectionChanged:a).call(a,e)}),null!=i&&i.addPropertyChangeListener("FURNITURE_CATALOG_VIEWED_IN_TREE",new e.FurnitureCatalogViewChangeListener(this))}else{if(!(null!=t&&t instanceof FurnitureCatalog||null===t)||!(null!=i&&null!=i.constructor&&null!=i.constructor.__interfaces&&i.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0||null===i)||void 0!==n||void 0!==o)throw new Error("invalid overload");var r=arguments[1],l=null;void 0===this.catalog&&(this.catalog=null),void 0===this.preferences&&(this.preferences=null),void 0===this.viewFactory&&(this.viewFactory=null),void 0===this.contentManager&&(this.contentManager=null),void 0===this.selectionListeners&&(this.selectionListeners=null),void 0===this.selectedFurniture&&(this.selectedFurniture=null),void 0===this.catalogView&&(this.catalogView=null),this.catalog=t,this.preferences=l,this.viewFactory=r,this.contentManager=null,this.selectionListeners=[],this.selectedFurniture=[],this.catalog.addFurnitureListener(function(e){return null==e||"function"==typeof e?e:function(t){return(e.collectionChanged?e.collectionChanged:e).call(e,t)}}(new e.FurnitureCatalogChangeListener(this))),void 0===this.catalog&&(this.catalog=null),void 0===this.preferences&&(this.preferences=null),void 0===this.viewFactory&&(this.viewFactory=null),void 0===this.contentManager&&(this.contentManager=null),void 0===this.selectionListeners&&(this.selectionListeners=null),void 0===this.selectedFurniture&&(this.selectedFurniture=null),void 0===this.catalogView&&(this.catalogView=null)}var a}return e.prototype.getView=function(){return null==this.catalogView&&(this.catalogView=this.viewFactory.createFurnitureCatalogView(this.catalog,this.preferences,this)),this.catalogView},e.prototype.addSelectionListener=function(e){this.selectionListeners.push(e)},e.prototype.removeSelectionListener=function(e){var t,i;t=this.selectionListeners,(i=t.indexOf(e))>=0&&t.splice(i,1)},e.prototype.getSelectedFurniture=function(){return this.selectedFurniture.slice(0)},e.prototype.setSelectedFurniture=function(e){if(this.selectedFurniture=e.slice(0),0!=this.selectionListeners.length)for(var t=new SelectionEvent(this,this.getSelectedFurniture()),i=this.selectionListeners.slice(0),n=0;n<i.length;n++){i[n].selectionChanged(t)}},e.prototype.deselectPieceOfFurniture=function(e){var t=this.selectedFurniture.indexOf(e);if(-1!==t){var i=this.getSelectedFurniture().slice(0);i.splice(t,1)[0],this.setSelectedFurniture(i)}},e.prototype.modifySelectedFurniture=function(){if(null!=this.preferences&&this.selectedFurniture.length>0){var t=this.selectedFurniture[0];if(t.isModifiable()){var i=new e.AddedFurnitureSelector(this);this.preferences.getFurnitureCatalog().addFurnitureListener(null==(n=i)||"function"==typeof n?n:function(e){return(n.collectionChanged?n.collectionChanged:n).call(n,e)}),new ImportedFurnitureWizardController(t,this.preferences,this.viewFactory,this.contentManager).displayView(this.getView()),i.selectAddedFurniture(),this.preferences.getFurnitureCatalog().removeFurnitureListener(function(e){return null==e||"function"==typeof e?e:function(t){return(e.collectionChanged?e.collectionChanged:e).call(e,t)}}(i))}}var n},e.prototype.importFurniture$=function(){if(null!=this.preferences){var t=new e.AddedFurnitureSelector(this);this.preferences.getFurnitureCatalog().addFurnitureListener(null==(i=t)||"function"==typeof i?i:function(e){return(i.collectionChanged?i.collectionChanged:i).call(i,e)}),new ImportedFurnitureWizardController(this.preferences,this.viewFactory,this.contentManager).displayView(this.getView()),t.selectAddedFurniture(),this.preferences.getFurnitureCatalog().removeFurnitureListener(function(e){return null==e||"function"==typeof e?e:function(t){return(e.collectionChanged?e.collectionChanged:e).call(e,t)}}(t))}var i},e.prototype.importFurniture$java_lang_String=function(e){null!=this.preferences&&new ImportedFurnitureWizardController(e,this.preferences,this.viewFactory,this.contentManager).displayView(this.getView())},e.prototype.importFurniture=function(e){if("string"==typeof e||null===e)return this.importFurniture$java_lang_String(e);if(void 0===e)return this.importFurniture$();throw new Error("invalid overload")},e.prototype.deleteSelection=function(){for(var e=0;e<this.selectedFurniture.length;e++){var t=this.selectedFurniture[e];t.isModifiable()&&this.catalog.delete(t)}},e.prototype.dropFiles=function(t){var i,n=new e.AddedFurnitureSelector(this);this.preferences.getFurnitureCatalog().addFurnitureListener(null==(i=n)||"function"==typeof i?i:function(e){return(i.collectionChanged?i.collectionChanged:i).call(i,e)});for(var o=0;o<t.length;o++){var r=t[o];this.importFurniture$java_lang_String(r)}n.selectAddedFurniture(),this.preferences.getFurnitureCatalog().removeFurnitureListener(function(e){return null==e||"function"==typeof e?e:function(t){return(e.collectionChanged?e.collectionChanged:e).call(e,t)}}(n))},e}();FurnitureCatalogController.__class="com.eteks.sweethome3d.viewcontroller.FurnitureCatalogController",FurnitureCatalogController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"],function(e){var t=function(){function e(e){void 0===this.furnitureCatalogController&&(this.furnitureCatalogController=null),this.furnitureCatalogController=e}return e.prototype.collectionChanged=function(e){var t,i=this.furnitureCatalogController;null==i?e.getSource().removeFurnitureListener(null==(t=this)||"function"==typeof t?t:function(e){return(t.collectionChanged?t.collectionChanged:t).call(t,e)}):e.getType()===CollectionEvent.Type.DELETE&&i.deselectPieceOfFurniture(e.getItem())},e}();e.FurnitureCatalogChangeListener=t,t.__class="com.eteks.sweethome3d.viewcontroller.FurnitureCatalogController.FurnitureCatalogChangeListener",t.__interfaces=["com.eteks.sweethome3d.model.CollectionListener"];var i=function(){function e(e){void 0===this.controller&&(this.controller=null),this.controller=e}return e.prototype.propertyChange=function(e){var t=this.controller;null==t?e.getSource().removePropertyChangeListener("FURNITURE_CATALOG_VIEWED_IN_TREE",this):t.catalogView=null},e}();e.FurnitureCatalogViewChangeListener=i,i.__class="com.eteks.sweethome3d.viewcontroller.FurnitureCatalogController.FurnitureCatalogViewChangeListener";var n=function(){function e(e){this.__parent=e,this.addedFurniture=[]}return e.prototype.collectionChanged=function(e){e.getType()===CollectionEvent.Type.ADD&&this.addedFurniture.push(e.getItem())},e.prototype.selectAddedFurniture=function(){this.addedFurniture.length>0&&this.__parent.setSelectedFurniture(this.addedFurniture)},e}();e.AddedFurnitureSelector=n,n.__class="com.eteks.sweethome3d.viewcontroller.FurnitureCatalogController.AddedFurnitureSelector",n.__interfaces=["com.eteks.sweethome3d.model.CollectionListener"]}(FurnitureCatalogController||(FurnitureCatalogController={}));var View,ObserverCameraController=function(){function e(e,t,i){void 0===this.home&&(this.home=null),void 0===this.preferences&&(this.preferences=null),void 0===this.viewFactory&&(this.viewFactory=null),void 0===this.propertyChangeSupport&&(this.propertyChangeSupport=null),void 0===this.observerCameraView&&(this.observerCameraView=null),void 0===this.x&&(this.x=0),void 0===this.y&&(this.y=0),void 0===this.elevation&&(this.elevation=0),void 0===this.minimumElevation&&(this.minimumElevation=0),void 0===this.yawInDegrees&&(this.yawInDegrees=0),void 0===this.yaw&&(this.yaw=0),void 0===this.pitchInDegrees&&(this.pitchInDegrees=0),void 0===this.pitch&&(this.pitch=0),void 0===this.fieldOfViewInDegrees&&(this.fieldOfViewInDegrees=0),void 0===this.fieldOfView&&(this.fieldOfView=0),void 0===this.elevationAdjusted&&(this.elevationAdjusted=!1),this.home=e,this.preferences=t,this.viewFactory=i,this.propertyChangeSupport=new PropertyChangeSupport(this),this.updateProperties()}return e.prototype.getView=function(){return null==this.observerCameraView&&(this.observerCameraView=this.viewFactory.createObserverCameraView(this.preferences,this)),this.observerCameraView},e.prototype.displayView=function(e){this.getView().displayView(e)},e.prototype.addPropertyChangeListener=function(e,t){this.propertyChangeSupport.addPropertyChangeListener(e,t)},e.prototype.removePropertyChangeListener=function(e,t){this.propertyChangeSupport.removePropertyChangeListener(e,t)},e.prototype.updateProperties=function(){var e=this.home.getObserverCamera();this.setX(e.getX()),this.setY(e.getY());var t=this.home.getLevels();this.setMinimumElevation(0===t.length?10:10+t[0].getElevation()),this.setElevation(e.getZ()),this.setYaw(e.getYaw()),this.setPitch(e.getPitch()),this.setFieldOfView(e.getFieldOfView());var i=this.home.getEnvironment();this.setElevationAdjusted(i.isObserverCameraElevationAdjusted())},e.prototype.setX=function(e){if(e!==this.x){var t=this.x;this.x=e,this.propertyChangeSupport.firePropertyChange("X",t,e)}},e.prototype.getX=function(){return this.x},e.prototype.setY=function(e){if(e!==this.y){var t=this.y;this.y=e,this.propertyChangeSupport.firePropertyChange("Y",t,e)}},e.prototype.getY=function(){return this.y},e.prototype.setElevation=function(e){if(e!==this.elevation){var t=this.elevation;this.elevation=e,this.propertyChangeSupport.firePropertyChange("ELEVATION",t,e)}},e.prototype.getElevation=function(){return this.elevation},e.prototype.setMinimumElevation=function(e){if(e!==this.minimumElevation){var t=this.minimumElevation;this.minimumElevation=e,this.propertyChangeSupport.firePropertyChange("MINIMUM_ELEVATION",t,e)}},e.prototype.getMinimumElevation=function(){return this.minimumElevation},e.prototype.isElevationAdjusted=function(){return this.elevationAdjusted},e.prototype.setElevationAdjusted=function(e){if(this.elevationAdjusted!==e){this.elevationAdjusted=e,this.propertyChangeSupport.firePropertyChange("OBSERVER_CAMERA_ELEVATION_ADJUSTED",!e,e);var t=this.home.getSelectedLevel();null!=t&&(e?this.setElevation(this.getElevation()-t.getElevation()):this.setElevation(this.getElevation()+t.getElevation()))}},e.prototype.isObserverCameraElevationAdjustedEditable=function(){return this.home.getLevels().length>1},e.prototype.setYawInDegrees=function(e,t){if(void 0===t&&(t=!0),e!==this.yawInDegrees){var i=this.yawInDegrees;this.yawInDegrees=e,this.propertyChangeSupport.firePropertyChange("YAW_IN_DEGREES",i,e),t&&this.setYaw(e*Math.PI/180,!1)}},e.prototype.getYawInDegrees=function(){return this.yawInDegrees},e.prototype.setYaw=function(e,t){if(void 0===t&&(t=!0),e!==this.yaw){var i=this.yaw;this.yaw=e,this.propertyChangeSupport.firePropertyChange("YAW",i,e),t&&this.setYawInDegrees(0|Math.round(180*e/Math.PI),!1)}},e.prototype.getYaw=function(){return this.yaw},e.prototype.setPitchInDegrees=function(e,t){if(void 0===t&&(t=!0),e!==this.pitchInDegrees){var i=this.pitchInDegrees;this.pitchInDegrees=e,this.propertyChangeSupport.firePropertyChange("PITCH_IN_DEGREES",i,e),t&&this.setPitch(e*Math.PI/180,!1)}},e.prototype.getPitchInDegrees=function(){return this.pitchInDegrees},e.prototype.setPitch=function(e,t){if(void 0===t&&(t=!0),e!==this.pitch){var i=this.pitch;this.pitch=e,this.propertyChangeSupport.firePropertyChange("PITCH",i,e),t&&this.setPitchInDegrees(0|Math.round(180*e/Math.PI),!1)}},e.prototype.getPitch=function(){return this.pitch},e.prototype.setFieldOfViewInDegrees=function(e,t){if(void 0===t&&(t=!0),e!==this.fieldOfViewInDegrees){var i=this.fieldOfViewInDegrees;this.fieldOfViewInDegrees=e,this.propertyChangeSupport.firePropertyChange("FIELD_OF_VIEW_IN_DEGREES",i,e),t&&this.setFieldOfView(e*Math.PI/180,!1)}},e.prototype.getFieldOfViewInDegrees=function(){return this.fieldOfViewInDegrees},e.prototype.setFieldOfView=function(e,t){if(void 0===t&&(t=!0),e!==this.fieldOfView){var i=this.fieldOfView;this.fieldOfView=e,this.propertyChangeSupport.firePropertyChange("FIELD_OF_VIEW",i,e),t&&this.setFieldOfViewInDegrees(0|Math.round(180*e/Math.PI),!1)}},e.prototype.getFieldOfView=function(){return this.fieldOfView},e.prototype.modifyObserverCamera=function(){var e=this.getX(),t=this.getY(),i=this.getElevation(),n=this.isElevationAdjusted(),o=this.home.getSelectedLevel();if(n&&null!=o){i+=o.getElevation();var r=this.home.getLevels();i=Math.max(i,0===r.length?10:10+r[0].getElevation())}var l=this.getYaw(),a=this.getPitch(),s=this.getFieldOfView(),h=this.home.getObserverCamera();h.setX(e),h.setY(t),h.setZ(i),h.setYaw(l),h.setPitch(a),h.setFieldOfView(s),this.home.getEnvironment().setObserverCameraElevationAdjusted(n)},e}();ObserverCameraController.__class="com.eteks.sweethome3d.viewcontroller.ObserverCameraController",ObserverCameraController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"],function(e){var t;(t=e.PointerType||(e.PointerType={}))[t.MOUSE=0]="MOUSE",t[t.TOUCH=1]="TOUCH"}(View||(View={}));var UserPreferencesController=function(){function e(e,t,i,n){if((null!=e&&e instanceof UserPreferences||null===e)&&(null!=t&&null!=t.constructor&&null!=t.constructor.__interfaces&&t.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0||null===t)&&(null!=i&&null!=i.constructor&&null!=i.constructor.__interfaces&&i.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ContentManager")>=0||null===i)&&(null!=n&&n instanceof HomeController||null===n)){void 0===this.preferences&&(this.preferences=null),void 0===this.viewFactory&&(this.viewFactory=null),void 0===this.homeController&&(this.homeController=null),void 0===this.propertyChangeSupport&&(this.propertyChangeSupport=null),void 0===this.userPreferencesView&&(this.userPreferencesView=null),void 0===this.language&&(this.language=null),void 0===this.unit&&(this.unit=null),void 0===this.currency&&(this.currency=null),void 0===this.valueAddedTaxEnabled&&(this.valueAddedTaxEnabled=!1),void 0===this.furnitureCatalogViewedInTree&&(this.furnitureCatalogViewedInTree=!1),void 0===this.navigationPanelVisible&&(this.navigationPanelVisible=!1),void 0===this.editingIn3DViewEnabled&&(this.editingIn3DViewEnabled=!1),void 0===this.aerialViewCenteredOnSelectionEnabled&&(this.aerialViewCenteredOnSelectionEnabled=!1),void 0===this.observerCameraSelectedAtChange&&(this.observerCameraSelectedAtChange=!1),void 0===this.magnetismEnabled&&(this.magnetismEnabled=!1),void 0===this.rulersVisible&&(this.rulersVisible=!1),void 0===this.gridVisible&&(this.gridVisible=!1),void 0===this.defaultFontName&&(this.defaultFontName=null),void 0===this.furnitureViewedFromTop&&(this.furnitureViewedFromTop=!1),void 0===this.furnitureModelIconSize&&(this.furnitureModelIconSize=0),void 0===this.roomFloorColoredOrTextured&&(this.roomFloorColoredOrTextured=!1),void 0===this.wallPattern&&(this.wallPattern=null),void 0===this.newWallPattern&&(this.newWallPattern=null),void 0===this.newWallThickness&&(this.newWallThickness=0),void 0===this.newWallHeight&&(this.newWallHeight=0),void 0===this.newFloorThickness&&(this.newFloorThickness=0),void 0===this.checkUpdatesEnabled&&(this.checkUpdatesEnabled=!1),void 0===this.autoSaveDelayForRecovery&&(this.autoSaveDelayForRecovery=0),void 0===this.autoSaveForRecoveryEnabled&&(this.autoSaveForRecoveryEnabled=!1),this.preferences=e,this.viewFactory=t,this.homeController=n,this.propertyChangeSupport=new PropertyChangeSupport(this),this.updateProperties()}else{if(!((null!=e&&e instanceof UserPreferences||null===e)&&(null!=t&&null!=t.constructor&&null!=t.constructor.__interfaces&&t.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0||null===t)&&(null!=i&&null!=i.constructor&&null!=i.constructor.__interfaces&&i.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ContentManager")>=0||null===i)&&void 0===n))throw new Error("invalid overload");void 0===this.preferences&&(this.preferences=null),void 0===this.viewFactory&&(this.viewFactory=null),void 0===this.homeController&&(this.homeController=null),void 0===this.propertyChangeSupport&&(this.propertyChangeSupport=null),void 0===this.userPreferencesView&&(this.userPreferencesView=null),void 0===this.language&&(this.language=null),void 0===this.unit&&(this.unit=null),void 0===this.currency&&(this.currency=null),void 0===this.valueAddedTaxEnabled&&(this.valueAddedTaxEnabled=!1),void 0===this.furnitureCatalogViewedInTree&&(this.furnitureCatalogViewedInTree=!1),void 0===this.navigationPanelVisible&&(this.navigationPanelVisible=!1),void 0===this.editingIn3DViewEnabled&&(this.editingIn3DViewEnabled=!1),void 0===this.aerialViewCenteredOnSelectionEnabled&&(this.aerialViewCenteredOnSelectionEnabled=!1),void 0===this.observerCameraSelectedAtChange&&(this.observerCameraSelectedAtChange=!1),void 0===this.magnetismEnabled&&(this.magnetismEnabled=!1),void 0===this.rulersVisible&&(this.rulersVisible=!1),void 0===this.gridVisible&&(this.gridVisible=!1),void 0===this.defaultFontName&&(this.defaultFontName=null),void 0===this.furnitureViewedFromTop&&(this.furnitureViewedFromTop=!1),void 0===this.furnitureModelIconSize&&(this.furnitureModelIconSize=0),void 0===this.roomFloorColoredOrTextured&&(this.roomFloorColoredOrTextured=!1),void 0===this.wallPattern&&(this.wallPattern=null),void 0===this.newWallPattern&&(this.newWallPattern=null),void 0===this.newWallThickness&&(this.newWallThickness=0),void 0===this.newWallHeight&&(this.newWallHeight=0),void 0===this.newFloorThickness&&(this.newFloorThickness=0),void 0===this.checkUpdatesEnabled&&(this.checkUpdatesEnabled=!1),void 0===this.autoSaveDelayForRecovery&&(this.autoSaveDelayForRecovery=0),void 0===this.autoSaveForRecoveryEnabled&&(this.autoSaveForRecoveryEnabled=!1),this.preferences=e,this.viewFactory=t,this.homeController=null,this.propertyChangeSupport=new PropertyChangeSupport(this),this.updateProperties(),this.preferences=e,this.viewFactory=t,this.propertyChangeSupport=new PropertyChangeSupport(this),this.updateProperties()}}return e.prototype.getView=function(){return null==this.userPreferencesView&&(this.userPreferencesView=this.viewFactory.createUserPreferencesView(this.preferences,this)),this.userPreferencesView},e.prototype.displayView=function(e){this.getView().displayView(e)},e.prototype.addPropertyChangeListener=function(e,t){this.propertyChangeSupport.addPropertyChangeListener(e,t)},e.prototype.removePropertyChangeListener=function(e,t){this.propertyChangeSupport.removePropertyChangeListener(e,t)},e.prototype.updateProperties=function(){this.setLanguage(this.preferences.getLanguage()),this.setUnit(this.preferences.getLengthUnit()),this.setCurrency(this.preferences.getCurrency()),this.setValueAddedTaxEnabled(this.preferences.isValueAddedTaxEnabled()),this.setFurnitureCatalogViewedInTree(this.preferences.isFurnitureCatalogViewedInTree()),this.setNavigationPanelVisible(this.preferences.isNavigationPanelVisible()),this.setEditingIn3DViewEnabled(this.preferences.isEditingIn3DViewEnabled()),this.setAerialViewCenteredOnSelectionEnabled(this.preferences.isAerialViewCenteredOnSelectionEnabled()),this.setObserverCameraSelectedAtChange(this.preferences.isObserverCameraSelectedAtChange()),this.setMagnetismEnabled(this.preferences.isMagnetismEnabled()),this.setRulersVisible(this.preferences.isRulersVisible()),this.setGridVisible(this.preferences.isGridVisible()),this.setDefaultFontName(this.preferences.getDefaultFontName()),this.setFurnitureViewedFromTop(this.preferences.isFurnitureViewedFromTop()),this.setFurnitureModelIconSize(this.preferences.getFurnitureModelIconSize()),this.setRoomFloorColoredOrTextured(this.preferences.isRoomFloorColoredOrTextured()),this.setWallPattern(this.preferences.getWallPattern()),this.setNewWallPattern(this.preferences.getNewWallPattern());var e=this.getUnit().getMinimumLength(),t=this.getUnit().getMaximumLength();this.setNewWallThickness(Math.min(Math.max(e,this.preferences.getNewWallThickness()),t/10)),this.setNewWallHeight(Math.min(Math.max(e,this.preferences.getNewWallHeight()),t)),this.setNewFloorThickness(Math.min(Math.max(e,this.preferences.getNewFloorThickness()),t/10)),this.setCheckUpdatesEnabled(this.preferences.isCheckUpdatesEnabled()),this.setAutoSaveDelayForRecovery(this.preferences.getAutoSaveDelayForRecovery()),this.setAutoSaveForRecoveryEnabled(this.preferences.getAutoSaveDelayForRecovery()>0)},e.prototype.isPropertyEditable=function(e){return"LANGUAGE"!==e||this.preferences.isLanguageEditable()},e.prototype.setLanguage=function(e){if(e!==this.language){var t=this.language;this.language=e,this.propertyChangeSupport.firePropertyChange("LANGUAGE",t,e)}},e.prototype.getLanguage=function(){return this.language},e.prototype.setUnit=function(e){if(e!==this.unit){var t=this.unit;this.unit=e,this.propertyChangeSupport.firePropertyChange("UNIT",t,e)}},e.prototype.getUnit=function(){return this.unit},e.prototype.setCurrency=function(e){if(e!==this.currency){var t=this.currency;this.currency=e,this.propertyChangeSupport.firePropertyChange("CURRENCY",t,e),null==e&&this.setValueAddedTaxEnabled(!1)}},e.prototype.getCurrency=function(){return this.currency},e.prototype.setValueAddedTaxEnabled=function(e){this.valueAddedTaxEnabled!==e&&(this.valueAddedTaxEnabled=e,this.propertyChangeSupport.firePropertyChange("VALUE_ADDED_TAX_ENABLED",!e,e))},e.prototype.isValueAddedTaxEnabled=function(){return this.valueAddedTaxEnabled},e.prototype.setFurnitureCatalogViewedInTree=function(e){this.furnitureCatalogViewedInTree!==e&&(this.furnitureCatalogViewedInTree=e,this.propertyChangeSupport.firePropertyChange("FURNITURE_CATALOG_VIEWED_IN_TREE",!e,e))},e.prototype.isFurnitureCatalogViewedInTree=function(){return this.furnitureCatalogViewedInTree},e.prototype.setNavigationPanelVisible=function(e){this.navigationPanelVisible!==e&&(this.navigationPanelVisible=e,this.propertyChangeSupport.firePropertyChange("NAVIGATION_PANEL_VISIBLE",!e,e))},e.prototype.isNavigationPanelVisible=function(){return this.navigationPanelVisible},e.prototype.setEditingIn3DViewEnabled=function(e){e!==this.editingIn3DViewEnabled&&(this.editingIn3DViewEnabled=e,this.propertyChangeSupport.firePropertyChange("EDITING_IN_3D_VIEW_ENABLED",!e,e))},e.prototype.isEditingIn3DViewEnabled=function(){return this.editingIn3DViewEnabled},e.prototype.setAerialViewCenteredOnSelectionEnabled=function(e){e!==this.aerialViewCenteredOnSelectionEnabled&&(this.aerialViewCenteredOnSelectionEnabled=e,this.propertyChangeSupport.firePropertyChange("AERIAL_VIEW_CENTERED_ON_SELECTION_ENABLED",!e,e))},e.prototype.isAerialViewCenteredOnSelectionEnabled=function(){return this.aerialViewCenteredOnSelectionEnabled},e.prototype.setObserverCameraSelectedAtChange=function(e){e!==this.observerCameraSelectedAtChange&&(this.observerCameraSelectedAtChange=e,this.propertyChangeSupport.firePropertyChange("OBSERVER_CAMERA_SELECTED_AT_CHANGE",!e,e))},e.prototype.isObserverCameraSelectedAtChange=function(){return this.observerCameraSelectedAtChange},e.prototype.setMagnetismEnabled=function(e){e!==this.magnetismEnabled&&(this.magnetismEnabled=e,this.propertyChangeSupport.firePropertyChange("MAGNETISM_ENABLED",!e,e))},e.prototype.isMagnetismEnabled=function(){return this.magnetismEnabled},e.prototype.setRulersVisible=function(e){e!==this.rulersVisible&&(this.rulersVisible=e,this.propertyChangeSupport.firePropertyChange("RULERS_VISIBLE",!e,e))},e.prototype.isRulersVisible=function(){return this.rulersVisible},e.prototype.setGridVisible=function(e){e!==this.gridVisible&&(this.gridVisible=e,this.propertyChangeSupport.firePropertyChange("GRID_VISIBLE",!e,e))},e.prototype.isGridVisible=function(){return this.gridVisible},e.prototype.setDefaultFontName=function(e){if(e!==this.defaultFontName&&(null==e||e!==this.defaultFontName)){var t=this.defaultFontName;this.defaultFontName=e,this.propertyChangeSupport.firePropertyChange("DEFAULT_FONT_NAME",t,e)}},e.prototype.getDefaultFontName=function(){return this.defaultFontName},e.prototype.setFurnitureViewedFromTop=function(e){this.furnitureViewedFromTop!==e&&(this.furnitureViewedFromTop=e,this.propertyChangeSupport.firePropertyChange("FURNITURE_VIEWED_FROM_TOP",!e,e))},e.prototype.isFurnitureViewedFromTop=function(){return this.furnitureViewedFromTop},e.prototype.setFurnitureModelIconSize=function(e){if(e!==this.furnitureModelIconSize){var t=this.furnitureModelIconSize;this.furnitureModelIconSize=e,this.propertyChangeSupport.firePropertyChange("FURNITURE_MODEL_ICON_SIZE",t,e)}},e.prototype.getFurnitureModelIconSize=function(){return this.furnitureModelIconSize},e.prototype.setRoomFloorColoredOrTextured=function(e){this.roomFloorColoredOrTextured!==e&&(this.roomFloorColoredOrTextured=e,this.propertyChangeSupport.firePropertyChange("ROOM_FLOOR_COLORED_OR_TEXTURED",!e,e))},e.prototype.isRoomFloorColoredOrTextured=function(){return this.roomFloorColoredOrTextured},e.prototype.setWallPattern=function(e){if(this.wallPattern!==e){var t=this.wallPattern;this.wallPattern=e,this.propertyChangeSupport.firePropertyChange("WALL_PATTERN",t,e)}},e.prototype.getWallPattern=function(){return this.wallPattern},e.prototype.setNewWallPattern=function(e){if(this.newWallPattern!==e){var t=this.newWallPattern;this.newWallPattern=e,this.propertyChangeSupport.firePropertyChange("NEW_WALL_PATTERN",t,e)}},e.prototype.getNewWallPattern=function(){return this.newWallPattern},e.prototype.setNewWallThickness=function(e){if(e!==this.newWallThickness){var t=this.newWallThickness;this.newWallThickness=e,this.propertyChangeSupport.firePropertyChange("NEW_WALL_THICKNESS",t,e)}},e.prototype.getNewWallThickness=function(){return this.newWallThickness},e.prototype.setNewWallHeight=function(e){if(e!==this.newWallHeight){var t=this.newWallHeight;this.newWallHeight=e,this.propertyChangeSupport.firePropertyChange("NEW_WALL_HEIGHT",t,e)}},e.prototype.getNewWallHeight=function(){return this.newWallHeight},e.prototype.setNewFloorThickness=function(e){if(e!==this.newFloorThickness){var t=this.newFloorThickness;this.newFloorThickness=e,this.propertyChangeSupport.firePropertyChange("NEW_FLOOR_THICKNESS",t,e)}},e.prototype.getNewFloorThickness=function(){return this.newFloorThickness},e.prototype.setCheckUpdatesEnabled=function(e){e!==this.checkUpdatesEnabled&&(this.checkUpdatesEnabled=e,this.propertyChangeSupport.firePropertyChange("CHECK_UPDATES_ENABLED",!e,e))},e.prototype.isCheckUpdatesEnabled=function(){return this.checkUpdatesEnabled},e.prototype.setAutoSaveDelayForRecovery=function(e){if(e!==this.autoSaveDelayForRecovery){var t=this.autoSaveDelayForRecovery;this.autoSaveDelayForRecovery=e,this.propertyChangeSupport.firePropertyChange("AUTO_SAVE_DELAY_FOR_RECOVERY",t,e)}},e.prototype.getAutoSaveDelayForRecovery=function(){return this.autoSaveDelayForRecovery},e.prototype.setAutoSaveForRecoveryEnabled=function(e){e!==this.autoSaveForRecoveryEnabled&&(this.autoSaveForRecoveryEnabled=e,this.propertyChangeSupport.firePropertyChange("AUTO_SAVE_FOR_RECOVERY_ENABLED",!e,e))},e.prototype.isAutoSaveForRecoveryEnabled=function(){return this.autoSaveForRecoveryEnabled},e.prototype.resetDisplayedActionTips=function(){this.preferences.resetIgnoredActionTips()},e.prototype.modifyUserPreferences=function(){this.preferences.setLanguage(this.getLanguage()),this.preferences.setUnit(this.getUnit()),this.preferences.setCurrency(this.getCurrency()),this.preferences.setValueAddedTaxEnabled(this.isValueAddedTaxEnabled()),this.preferences.setFurnitureCatalogViewedInTree(this.isFurnitureCatalogViewedInTree()),this.preferences.setNavigationPanelVisible(this.isNavigationPanelVisible()),this.preferences.setEditingIn3DViewEnabled(this.isEditingIn3DViewEnabled()),this.preferences.setAerialViewCenteredOnSelectionEnabled(this.isAerialViewCenteredOnSelectionEnabled()),this.preferences.setObserverCameraSelectedAtChange(this.isObserverCameraSelectedAtChange()),this.preferences.setMagnetismEnabled(this.isMagnetismEnabled()),this.preferences.setRulersVisible(this.isRulersVisible()),this.preferences.setGridVisible(this.isGridVisible()),this.preferences.setDefaultFontName(this.getDefaultFontName()),this.preferences.setFurnitureViewedFromTop(this.isFurnitureViewedFromTop()),this.preferences.setFurnitureModelIconSize(this.getFurnitureModelIconSize()),this.preferences.setFloorColoredOrTextured(this.isRoomFloorColoredOrTextured()),this.preferences.setWallPattern(this.getWallPattern()),this.preferences.setNewWallPattern(this.getNewWallPattern()),this.preferences.setNewWallThickness(this.getNewWallThickness()),this.preferences.setNewWallHeight(this.getNewWallHeight()),this.preferences.setNewFloorThickness(this.getNewFloorThickness()),this.preferences.setCheckUpdatesEnabled(this.isCheckUpdatesEnabled()),this.preferences.setAutoSaveDelayForRecovery(this.isAutoSaveForRecoveryEnabled()?this.getAutoSaveDelayForRecovery():0)},e}();UserPreferencesController.__class="com.eteks.sweethome3d.viewcontroller.UserPreferencesController",UserPreferencesController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"];var VideoController=function(){function e(t,i,n,o){void 0===this.home&&(this.home=null),void 0===this.preferences&&(this.preferences=null),void 0===this.viewFactory&&(this.viewFactory=null),void 0===this.contentManager&&(this.contentManager=null),void 0===this.propertyChangeSupport&&(this.propertyChangeSupport=null),void 0===this.videoView&&(this.videoView=null),void 0===this.aspectRatio&&(this.aspectRatio=null),void 0===this.frameRate&&(this.frameRate=0),void 0===this.width&&(this.width=0),void 0===this.height&&(this.height=0),void 0===this.quality&&(this.quality=0),void 0===this.speed&&(this.speed=0),void 0===this.cameraPath&&(this.cameraPath=null),void 0===this.time&&(this.time=0),void 0===this.renderer&&(this.renderer=null),void 0===this.ceilingLightColor&&(this.ceilingLightColor=0),this.home=t,this.preferences=i,this.viewFactory=n,this.contentManager=o,this.propertyChangeSupport=new PropertyChangeSupport(this),this.updateProperties(),t.getEnvironment().addPropertyChangeListener("CEILING_LIGHT_COLOR",new e.HomeEnvironmentChangeListener(this))}return e.prototype.getView=function(){return null==this.videoView&&(this.videoView=this.viewFactory.createVideoView(this.home,this.preferences,this)),this.videoView},e.prototype.displayView=function(e){this.getView().displayView(e)},e.prototype.getContentManager=function(){return this.contentManager},e.prototype.addPropertyChangeListener=function(e,t){this.propertyChangeSupport.addPropertyChangeListener(e,t)},e.prototype.removePropertyChangeListener=function(e,t){this.propertyChangeSupport.removePropertyChangeListener(e,t)},e.prototype.updateProperties=function(){var e=this.home.getEnvironment();this.setFrameRate(e.getVideoFrameRate()),this.setWidth(e.getVideoWidth(),!1),this.setHeight(e.getVideoHeight(),!1),this.setAspectRatio(e.getVideoAspectRatio()),this.setQuality(e.getVideoQuality()),this.setSpeed(e.getVideoSpeed());var t=e.getVideoCameraPath();this.setCameraPath(t),this.setTime(0==t.length?this.home.getCamera().getTime():t[0].getTime());var i=this.home.getCamera().getRenderer();null==i&&(i=this.preferences.getPhotoRenderer()),this.setRenderer(i,!1),this.setCeilingLightColor(e.getCeillingLightColor())},e.prototype.setAspectRatio=function(e){if(this.aspectRatio!==e){var t=this.aspectRatio;this.aspectRatio=e,this.propertyChangeSupport.firePropertyChange("ASPECT_RATIO",t,e),this.home.getEnvironment().setVideoAspectRatio(this.aspectRatio),this.setHeight(Math.round(this.width/{FREE_RATIO:null,VIEW_3D_RATIO:null,RATIO_4_3:4/3,RATIO_3_2:1.5,RATIO_16_9:16/9,RATIO_2_1:2,SQUARE_RATIO:1}[this.aspectRatio]),!1)}},e.prototype.getAspectRatio=function(){return this.aspectRatio},e.prototype.setFrameRate=function(e){if(this.frameRate!==e){var t=this.frameRate;this.frameRate=e,this.propertyChangeSupport.firePropertyChange("QUALITY",t,e),this.home.getEnvironment().setVideoFrameRate(this.frameRate)}},e.prototype.getFrameRate=function(){return this.frameRate},e.prototype.setWidth=function(e,t){if(void 0===t&&(t=!0),this.width!==e){var i=this.width;this.width=e,this.propertyChangeSupport.firePropertyChange("WIDTH",i,e),t&&this.setHeight(Math.round(e/{FREE_RATIO:null,VIEW_3D_RATIO:null,RATIO_4_3:4/3,RATIO_3_2:1.5,RATIO_16_9:16/9,RATIO_2_1:2,SQUARE_RATIO:1}[this.aspectRatio]),!1),this.home.getEnvironment().setVideoWidth(this.width)}},e.prototype.getWidth=function(){return this.width},e.prototype.setHeight=function(e,t){if(void 0===t&&(t=!0),this.height!==e){var i=this.height;this.height=e,this.propertyChangeSupport.firePropertyChange("HEIGHT",i,e),t&&this.setWidth(Math.round(e*{FREE_RATIO:null,VIEW_3D_RATIO:null,RATIO_4_3:4/3,RATIO_3_2:1.5,RATIO_16_9:16/9,RATIO_2_1:2,SQUARE_RATIO:1}[this.aspectRatio]),!1)}},e.prototype.getHeight=function(){return this.height},e.prototype.setQuality=function(e){if(this.quality!==e){var t=this.quality;this.quality=Math.min(e,this.getQualityLevelCount()-1),this.propertyChangeSupport.firePropertyChange("QUALITY",t,e),this.home.getEnvironment().setVideoQuality(this.quality)}},e.prototype.getQuality=function(){return this.quality},e.prototype.setSpeed=function(e){if(this.speed!==e){var t=this.speed;this.speed=e,this.propertyChangeSupport.firePropertyChange("SPEED",t,e),this.home.getEnvironment().setVideoSpeed(this.speed)}},e.prototype.getSpeed=function(){return this.speed},e.prototype.getQualityLevelCount=function(){return 4},e.prototype.getCameraPath=function(){return this.cameraPath},e.prototype.setCameraPath=function(e){if(this.cameraPath!==e){var t=this.cameraPath;this.cameraPath=e,this.propertyChangeSupport.firePropertyChange("CAMERA_PATH",t,e),this.home.getEnvironment().setVideoCameraPath(this.cameraPath)}},e.prototype.setTime=function(e){if(this.time!==e){var t=this.time;this.time=e,this.propertyChangeSupport.firePropertyChange("TIME",t,e),this.home.getCamera().setTime(e)}},e.prototype.getTime=function(){return this.time},e.prototype.setRenderer=function(e,t){if(void 0===t&&(t=!0),this.renderer!==e){var i=this.renderer;this.renderer=e,this.propertyChangeSupport.firePropertyChange("RENDERER",i,e);var n=this.home.getEnvironment().getVideoCameraPath();0!=n.length&&((n=n.slice(0))[0].setRenderer(e),this.setCameraPath(n)),t&&this.preferences.setPhotoRenderer(e)}},e.prototype.getRenderer=function(){return this.renderer},e.prototype.setCeilingLightColor=function(e){if(this.ceilingLightColor!==e){var t=this.ceilingLightColor;this.ceilingLightColor=e,this.propertyChangeSupport.firePropertyChange("CEILING_LIGHT_COLOR",t,e),this.home.getEnvironment().setCeillingLightColor(e)}},e.prototype.getCeilingLightColor=function(){return this.ceilingLightColor},e.prototype.setVisualProperty=function(e,t){this.home.setVisualProperty(e,t)},e.prototype.setHomeProperty=function(e,t){this.home.setProperty(e,t)},e}();VideoController.__class="com.eteks.sweethome3d.viewcontroller.VideoController",VideoController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"],function(e){var t=function(){function e(e){void 0===this.videoController&&(this.videoController=null),this.videoController=e}return e.prototype.propertyChange=function(e){var t=this.videoController;null==t?e.getSource().removePropertyChangeListener("CEILING_LIGHT_COLOR",this):t.updateProperties()},e}();e.HomeEnvironmentChangeListener=t,t.__class="com.eteks.sweethome3d.viewcontroller.VideoController.HomeEnvironmentChangeListener"}(VideoController||(VideoController={}));var ContentManager,PlanView,LocalizedUndoableEdit=function(e){function t(t,i,n){var o=e.call(this)||this;return void 0===o.preferences&&(o.preferences=null),void 0===o.controllerClass&&(o.controllerClass=null),void 0===o.presentationNameKey&&(o.presentationNameKey=null),o.preferences=t,o.controllerClass=i,o.presentationNameKey=n,o}return __extends(t,e),t.prototype.getPresentationName=function(){return this.preferences.getLocalizedString(this.controllerClass,this.presentationNameKey)},t}(javax.swing.undo.AbstractUndoableEdit);LocalizedUndoableEdit.__class="com.eteks.sweethome3d.viewcontroller.LocalizedUndoableEdit",LocalizedUndoableEdit.__interfaces=["javax.swing.undo.UndoableEdit"],function(e){var t;(t=e.ContentType||(e.ContentType={}))[t.SWEET_HOME_3D=0]="SWEET_HOME_3D",t[t.MODEL=1]="MODEL",t[t.IMAGE=2]="IMAGE",t[t.CSV=3]="CSV",t[t.SVG=4]="SVG",t[t.OBJ=5]="OBJ",t[t.PNG=6]="PNG",t[t.JPEG=7]="JPEG",t[t.MOV=8]="MOV",t[t.PDF=9]="PDF",t[t.LANGUAGE_LIBRARY=10]="LANGUAGE_LIBRARY",t[t.TEXTURES_LIBRARY=11]="TEXTURES_LIBRARY",t[t.FURNITURE_LIBRARY=12]="FURNITURE_LIBRARY",t[t.PLUGIN=13]="PLUGIN",t[t.PHOTOS_DIRECTORY=14]="PHOTOS_DIRECTORY",t[t.USER_DEFINED=15]="USER_DEFINED"}(ContentManager||(ContentManager={})),function(e){var t;(t=e.CursorType||(e.CursorType={}))[t.SELECTION=0]="SELECTION",t[t.PANNING=1]="PANNING",t[t.DRAW=2]="DRAW",t[t.ROTATION=3]="ROTATION",t[t.ELEVATION=4]="ELEVATION",t[t.HEIGHT=5]="HEIGHT",t[t.POWER=6]="POWER",t[t.RESIZE=7]="RESIZE",t[t.DUPLICATION=8]="DUPLICATION",t[t.MOVE=9]="MOVE"}(PlanView||(PlanView={}));var ExportableView,TextureChoiceController=function(){function e(e,t,i,n,o,r){if("string"!=typeof e&&null!==e||"string"!=typeof t&&null!==t||"boolean"!=typeof i&&null!==i||!(null!=n&&n instanceof UserPreferences||null===n)||!(null!=o&&null!=o.constructor&&null!=o.constructor.__interfaces&&o.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0||null===o)||!(null!=r&&null!=r.constructor&&null!=r.constructor.__interfaces&&r.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ContentManager")>=0||null===r))if("string"!=typeof e&&null!==e||"boolean"!=typeof t&&null!==t||!(null!=i&&i instanceof UserPreferences||null===i)||!(null!=n&&null!=n.constructor&&null!=n.constructor.__interfaces&&n.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0||null===n)||!(null!=o&&null!=o.constructor&&null!=o.constructor.__interfaces&&o.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ContentManager")>=0||null===o)||void 0!==r){if("string"!=typeof e&&null!==e||!(null!=t&&t instanceof UserPreferences||null===t)||!(null!=i&&null!=i.constructor&&null!=i.constructor.__interfaces&&i.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0||null===i)||!(null!=n&&null!=n.constructor&&null!=n.constructor.__interfaces&&n.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ContentManager")>=0||null===n)||void 0!==o||void 0!==r)throw new Error("invalid overload");var l=(p=arguments)[1],a=p[2],s=p[3];void 0===this.title&&(this.title=null),void 0===this.fitAreaText&&(this.fitAreaText=null),void 0===this.rotationSupported&&(this.rotationSupported=!1),void 0===this.preferences&&(this.preferences=null),void 0===this.viewFactory&&(this.viewFactory=null),void 0===this.contentManager&&(this.contentManager=null),void 0===this.propertyChangeSupport&&(this.propertyChangeSupport=null),void 0===this.textureChoiceView&&(this.textureChoiceView=null),void 0===this.texture&&(this.texture=null),this.title=e,this.fitAreaText=null,this.rotationSupported=!0,this.preferences=l,this.viewFactory=a,this.contentManager=s,this.propertyChangeSupport=new PropertyChangeSupport(this),void 0===this.title&&(this.title=null),void 0===this.fitAreaText&&(this.fitAreaText=null),void 0===this.rotationSupported&&(this.rotationSupported=!1),void 0===this.preferences&&(this.preferences=null),void 0===this.viewFactory&&(this.viewFactory=null),void 0===this.contentManager&&(this.contentManager=null),void 0===this.propertyChangeSupport&&(this.propertyChangeSupport=null),void 0===this.textureChoiceView&&(this.textureChoiceView=null),void 0===this.texture&&(this.texture=null),void 0===this.title&&(this.title=null),void 0===this.fitAreaText&&(this.fitAreaText=null),void 0===this.rotationSupported&&(this.rotationSupported=!1),void 0===this.preferences&&(this.preferences=null),void 0===this.viewFactory&&(this.viewFactory=null),void 0===this.contentManager&&(this.contentManager=null),void 0===this.propertyChangeSupport&&(this.propertyChangeSupport=null),void 0===this.textureChoiceView&&(this.textureChoiceView=null),void 0===this.texture&&(this.texture=null)}else{var h=(p=arguments)[1],u=p[2],d=p[3],c=p[4];void 0===this.title&&(this.title=null),void 0===this.fitAreaText&&(this.fitAreaText=null),void 0===this.rotationSupported&&(this.rotationSupported=!1),void 0===this.preferences&&(this.preferences=null),void 0===this.viewFactory&&(this.viewFactory=null),void 0===this.contentManager&&(this.contentManager=null),void 0===this.propertyChangeSupport&&(this.propertyChangeSupport=null),void 0===this.textureChoiceView&&(this.textureChoiceView=null),void 0===this.texture&&(this.texture=null),this.title=e,this.fitAreaText=null,this.rotationSupported=h,this.preferences=u,this.viewFactory=d,this.contentManager=c,this.propertyChangeSupport=new PropertyChangeSupport(this),void 0===this.title&&(this.title=null),void 0===this.fitAreaText&&(this.fitAreaText=null),void 0===this.rotationSupported&&(this.rotationSupported=!1),void 0===this.preferences&&(this.preferences=null),void 0===this.viewFactory&&(this.viewFactory=null),void 0===this.contentManager&&(this.contentManager=null),void 0===this.propertyChangeSupport&&(this.propertyChangeSupport=null),void 0===this.textureChoiceView&&(this.textureChoiceView=null),void 0===this.texture&&(this.texture=null)}else{var p=arguments;void 0===this.title&&(this.title=null),void 0===this.fitAreaText&&(this.fitAreaText=null),void 0===this.rotationSupported&&(this.rotationSupported=!1),void 0===this.preferences&&(this.preferences=null),void 0===this.viewFactory&&(this.viewFactory=null),void 0===this.contentManager&&(this.contentManager=null),void 0===this.propertyChangeSupport&&(this.propertyChangeSupport=null),void 0===this.textureChoiceView&&(this.textureChoiceView=null),void 0===this.texture&&(this.texture=null),this.title=e,this.fitAreaText=t,this.rotationSupported=i,this.preferences=n,this.viewFactory=o,this.contentManager=r,this.propertyChangeSupport=new PropertyChangeSupport(this)}}return e.prototype.getView=function(){return null==this.textureChoiceView&&(this.textureChoiceView=this.viewFactory.createTextureChoiceView(this.preferences,this)),this.textureChoiceView},e.prototype.addPropertyChangeListener=function(e,t){this.propertyChangeSupport.addPropertyChangeListener(e,t)},e.prototype.removePropertyChangeListener=function(e,t){this.propertyChangeSupport.removePropertyChangeListener(e,t)},e.prototype.setTexture=function(e){if(this.texture!==e&&(null==e||!e.equals(this.texture))){var t=this.texture;this.texture=e,this.propertyChangeSupport.firePropertyChange("TEXTURE",t,e)}},e.prototype.getTexture=function(){return this.texture},e.prototype.getDialogTitle=function(){return this.title},e.prototype.getFitAreaText=function(){return this.fitAreaText},e.prototype.isRotationSupported=function(){return this.rotationSupported},e.prototype.importTexture$=function(){new ImportedTextureWizardController(this.preferences,this.viewFactory,this.contentManager).displayView(this.getView())},e.prototype.importTexture$java_lang_String=function(e){new ImportedTextureWizardController(e,this.preferences,this.viewFactory,this.contentManager).displayView(this.getView())},e.prototype.importTexture=function(e){if("string"==typeof e||null===e)return this.importTexture$java_lang_String(e);if(void 0===e)return this.importTexture$();throw new Error("invalid overload")},e.prototype.modifyTexture=function(e){new ImportedTextureWizardController(e,this.preferences,this.viewFactory,this.contentManager).displayView(this.getView())},e.prototype.deleteTexture=function(e){this.getView().confirmDeleteSelectedCatalogTexture()&&this.preferences.getTexturesCatalog().delete(e)},e.prototype.addRecentTexture=function(t){for(var i,n,o=this.preferences.getRecentTextures().slice(0),r=0;r<o.length;r++){var l=o[r];if(i=l.getImage(),n=t.getImage(),i&&i.equals?i.equals(n):i===n){if(0===r)return;o.splice(r,1)[0];break}}for(o.splice(0,0,t);o.length>e.MAX_RECENT_TEXTURES;)o.splice(o.length-1,1)[0];this.preferences.setRecentTextures(o)},e.MAX_RECENT_TEXTURES=15,e}();TextureChoiceController.__class="com.eteks.sweethome3d.viewcontroller.TextureChoiceController",TextureChoiceController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"],function(e){var t=function(){function t(e){void 0===this.__name&&(this.__name=null),this.__name=e}return t.SVG_$LI$=function(){return null==t.SVG&&(t.SVG=new e.FormatType("SVG")),t.SVG},t.CSV_$LI$=function(){return null==t.CSV&&(t.CSV=new e.FormatType("CSV")),t.CSV},t.prototype.name=function(){return this.__name},t.prototype.toString=function(){return this.__name},t}();e.FormatType=t,t.__class="com.eteks.sweethome3d.viewcontroller.ExportableView.FormatType"}(ExportableView||(ExportableView={}));var AbstractPhotoController=function(){function e(t,i,n,o){void 0===this.home&&(this.home=null),void 0===this.view3D&&(this.view3D=null),void 0===this.contentManager&&(this.contentManager=null),void 0===this.propertyChangeSupport&&(this.propertyChangeSupport=null),void 0===this.aspectRatio&&(this.aspectRatio=null),void 0===this.width&&(this.width=0),void 0===this.height&&(this.height=0),void 0===this.quality&&(this.quality=0),void 0===this.view3DAspectRatio&&(this.view3DAspectRatio=0),void 0===this.ceilingLightColor&&(this.ceilingLightColor=0),this.home=t,this.view3D=n,this.contentManager=o,this.propertyChangeSupport=new PropertyChangeSupport(this),this.view3DAspectRatio=1;var r=new e.EnvironmentChangeListener(this);t.getEnvironment().addPropertyChangeListener("PHOTO_WIDTH",r),t.getEnvironment().addPropertyChangeListener("PHOTO_HEIGHT",r),t.getEnvironment().addPropertyChangeListener("PHOTO_ASPECT_RATIO",r),t.getEnvironment().addPropertyChangeListener("PHOTO_QUALITY",r),t.getEnvironment().addPropertyChangeListener("CEILING_LIGHT_COLOR",r),this.updateProperties()}return e.prototype.getContentManager=function(){return this.contentManager},e.prototype.addPropertyChangeListener=function(e,t){this.propertyChangeSupport.addPropertyChangeListener(e,t)},e.prototype.removePropertyChangeListener=function(e,t){this.propertyChangeSupport.removePropertyChangeListener(e,t)},e.prototype.updateProperties=function(){var e=this.home.getEnvironment();this.setAspectRatio(e.getPhotoAspectRatio()),this.setWidth(e.getPhotoWidth(),!1),this.setHeight(e.getPhotoHeight(),!1),this.setQuality(e.getPhotoQuality()),this.setCeilingLightColor(e.getCeillingLightColor())},e.prototype.setAspectRatio=function(e){if(this.aspectRatio!==e){var t=this.aspectRatio;this.aspectRatio=e,this.propertyChangeSupport.firePropertyChange("ASPECT_RATIO",t,e),this.home.getEnvironment().setPhotoAspectRatio(this.aspectRatio),this.aspectRatio===AspectRatio.VIEW_3D_RATIO?this.view3DAspectRatio!==1/0&&this.setHeight(Math.round(this.width/this.view3DAspectRatio),!1):null!={FREE_RATIO:null,VIEW_3D_RATIO:null,RATIO_4_3:4/3,RATIO_3_2:1.5,RATIO_16_9:16/9,RATIO_2_1:2,SQUARE_RATIO:1}[this.aspectRatio]&&this.setHeight(Math.round(this.width/{FREE_RATIO:null,VIEW_3D_RATIO:null,RATIO_4_3:4/3,RATIO_3_2:1.5,RATIO_16_9:16/9,RATIO_2_1:2,SQUARE_RATIO:1}[this.aspectRatio]),!1)}},e.prototype.getAspectRatio=function(){return this.aspectRatio},e.prototype.setWidth=function(e,t){if(void 0===t&&(t=!0),this.width!==e){var i=this.width;this.width=e,this.propertyChangeSupport.firePropertyChange("WIDTH",i,e),t&&(this.aspectRatio===AspectRatio.VIEW_3D_RATIO?this.view3DAspectRatio!==1/0&&this.setHeight(Math.round(e/this.view3DAspectRatio),!1):null!={FREE_RATIO:null,VIEW_3D_RATIO:null,RATIO_4_3:4/3,RATIO_3_2:1.5,RATIO_16_9:16/9,RATIO_2_1:2,SQUARE_RATIO:1}[this.aspectRatio]&&this.setHeight(Math.round(e/{FREE_RATIO:null,VIEW_3D_RATIO:null,RATIO_4_3:4/3,RATIO_3_2:1.5,RATIO_16_9:16/9,RATIO_2_1:2,SQUARE_RATIO:1}[this.aspectRatio]),!1)),this.home.getEnvironment().setPhotoWidth(this.width)}},e.prototype.getWidth=function(){return this.width},e.prototype.setHeight=function(e,t){if(void 0===t&&(t=!0),this.height!==e){var i=this.height;this.height=e,this.propertyChangeSupport.firePropertyChange("HEIGHT",i,e),t&&(this.aspectRatio===AspectRatio.VIEW_3D_RATIO?this.view3DAspectRatio!==1/0&&this.setWidth(Math.round(e*this.view3DAspectRatio),!1):null!={FREE_RATIO:null,VIEW_3D_RATIO:null,RATIO_4_3:4/3,RATIO_3_2:1.5,RATIO_16_9:16/9,RATIO_2_1:2,SQUARE_RATIO:1}[this.aspectRatio]&&this.setWidth(Math.round(e*{FREE_RATIO:null,VIEW_3D_RATIO:null,RATIO_4_3:4/3,RATIO_3_2:1.5,RATIO_16_9:16/9,RATIO_2_1:2,SQUARE_RATIO:1}[this.aspectRatio]),!1)),this.home.getEnvironment().setPhotoHeight(this.height)}},e.prototype.getHeight=function(){return this.height},e.prototype.setQuality=function(e){if(this.quality!==e){var t=this.quality;this.quality=Math.min(e,this.getQualityLevelCount()-1),this.propertyChangeSupport.firePropertyChange("QUALITY",t,e),this.home.getEnvironment().setPhotoQuality(this.quality)}},e.prototype.getQuality=function(){return this.quality},e.prototype.getQualityLevelCount=function(){return 4},e.prototype.setCeilingLightColor=function(e){if(this.ceilingLightColor!==e){var t=this.ceilingLightColor;this.ceilingLightColor=e,this.propertyChangeSupport.firePropertyChange("CEILING_LIGHT_COLOR",t,e),this.home.getEnvironment().setCeillingLightColor(e)}},e.prototype.getCeilingLightColor=function(){return this.ceilingLightColor},e.prototype.set3DViewAspectRatio=function(e){if(this.view3DAspectRatio!==e){var t=this.view3DAspectRatio;this.view3DAspectRatio=e,this.propertyChangeSupport.firePropertyChange("ASPECT_RATIO",t,e),this.aspectRatio===AspectRatio.VIEW_3D_RATIO&&this.view3DAspectRatio!==1/0&&this.setHeight(Math.round(this.width/this.view3DAspectRatio),!1)}},e.prototype.get3DViewAspectRatio=function(){return this.view3DAspectRatio},e.prototype.get3DView=function(){return this.view3D},e.prototype.setVisualProperty=function(e,t){this.home.setVisualProperty(e,t)},e.prototype.setHomeProperty=function(e,t){this.home.setProperty(e,t)},e}();AbstractPhotoController.__class="com.eteks.sweethome3d.viewcontroller.AbstractPhotoController",AbstractPhotoController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"],function(e){var t=function(){function e(e){void 0===this.photoController&&(this.photoController=null),this.photoController=e}return e.prototype.propertyChange=function(e){var t=this.photoController;null==t?(e.getSource().removePropertyChangeListener("PHOTO_WIDTH",this),e.getSource().removePropertyChangeListener("PHOTO_HEIGHT",this),e.getSource().removePropertyChangeListener("PHOTO_ASPECT_RATIO",this),e.getSource().removePropertyChangeListener("PHOTO_QUALITY",this),e.getSource().removePropertyChangeListener("CEILING_LIGHT_COLOR",this)):"PHOTO_WIDTH"===e.getPropertyName()?t.setWidth(e.getNewValue(),!1):"PHOTO_HEIGHT"===e.getPropertyName()?t.setHeight(e.getNewValue(),!1):"PHOTO_ASPECT_RATIO"===e.getPropertyName()?t.setAspectRatio(e.getNewValue()):"PHOTO_QUALITY"===e.getPropertyName()?t.setQuality(e.getNewValue()):"CEILING_LIGHT_COLOR"===e.getPropertyName()&&t.setCeilingLightColor(e.getNewValue())},e}();e.EnvironmentChangeListener=t,t.__class="com.eteks.sweethome3d.viewcontroller.AbstractPhotoController.EnvironmentChangeListener"}(AbstractPhotoController||(AbstractPhotoController={}));var HomeXMLExporter=function(e){function t(){var t=e.call(this)||this;return void 0===t.savedContentNames&&(t.savedContentNames=null),t.levelIds={},t.wallIds={},t}return __extends(t,e),t.prototype.setSavedContentNames=function(e){this.savedContentNames=e},t.prototype.getId=function(e){if(null==e)return null;if(null!=e&&e instanceof Level)return function(e,t){null==e.entries&&(e.entries=[]);for(var i=0;i<e.entries.length;i++)if(null==e.entries[i].key&&null==t||null!=e.entries[i].key.equals&&e.entries[i].key.equals(t)||e.entries[i].key===t)return e.entries[i].value;return null}(this.levelIds,e);if(null!=e&&e instanceof Wall)return function(e,t){null==e.entries&&(e.entries=[]);for(var i=0;i<e.entries.length;i++)if(null==e.entries[i].key&&null==t||null!=e.entries[i].key.equals&&e.entries[i].key.equals(t)||e.entries[i].key===t)return e.entries[i].value;return null}(this.wallIds,e);throw new IllegalArgumentException("No Id provided for object of class "+("string"==typeof(t=e.constructor)?t:t.__class?t.__class:t.name));var t},t.prototype.writeElement$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Home=function(t,i){for(var n=i.getLevels(),o=0;o<n.length;o++){var r=n[o];!function(e,t,i){null==e.entries&&(e.entries=[]);for(var n=0;n<e.entries.length;n++)if(null==e.entries[n].key&&null==t||null!=e.entries[n].key.equals&&e.entries[n].key.equals(t)||e.entries[n].key===t)return void(e.entries[n].value=i);e.entries.push({key:t,value:i,getKey:function(){return this.key},getValue:function(){return this.value}})}(this.levelIds,r,r.getId())}for(n=i.getWalls(),o=0;o<n.length;o++){var l=n[o];!function(e,t,i){null==e.entries&&(e.entries=[]);for(var n=0;n<e.entries.length;n++)if(null==e.entries[n].key&&null==t||null!=e.entries[n].key.equals&&e.entries[n].key.equals(t)||e.entries[n].key===t)return void(e.entries[n].value=i);e.entries.push({key:t,value:i,getKey:function(){return this.key},getValue:function(){return this.value}})}(this.wallIds,l,l.getId())}e.prototype.writeElement.call(this,t,i)},t.prototype.writeElement=function(t,i){if((null!=t&&t instanceof XMLWriter||null===t)&&(null!=i&&i instanceof Home||null===i))return this.writeElement$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Home(t,i);if(!(null!=t&&t instanceof XMLWriter||null===t)||null==i&&null!==i)throw new Error("invalid overload");e.prototype.writeElement.call(this,t,i)},t.prototype.writeAttributes$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Home=function(e,t){t.setVersion(Home.CURRENT_VERSION),e.writeAttribute$java_lang_String$java_lang_String("version",String(t.getVersion()).toString()),e.writeAttribute$java_lang_String$java_lang_String$java_lang_String("name",t.getName(),null),e.writeAttribute$java_lang_String$java_lang_String("camera",t.getCamera()===t.getObserverCamera()?"observerCamera":"topCamera"),e.writeAttribute$java_lang_String$java_lang_String$java_lang_String("selectedLevel",this.getId(t.getSelectedLevel()),null),e.writeFloatAttribute$java_lang_String$float("wallHeight",t.getWallHeight()),e.writeBooleanAttribute("basePlanLocked",t.isBasePlanLocked(),!1),null!=t.getFurnitureSortedPropertyName()&&e.writeAttribute$java_lang_String$java_lang_String("furnitureSortedProperty",t.getFurnitureSortedPropertyName()),e.writeBooleanAttribute("furnitureDescendingSorted",t.isFurnitureDescendingSorted(),!1)},t.prototype.writeAttributes=function(t,i){if((null!=t&&t instanceof XMLWriter||null===t)&&(null!=i&&i instanceof Home||null===i))return this.writeAttributes$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Home(t,i);if(!(null!=t&&t instanceof XMLWriter||null===t)||null==i&&null!==i)throw new Error("invalid overload");e.prototype.writeAttributes.call(this,t,i)},t.prototype.writeChildren$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Home=function(e,t){var i=t.getPropertyNames().slice(0);i.sort();for(var n=0;n<i.length;n++){var o=i[n];this.writeProperty(e,t,o,t.getProperty(o),!1)}var r=t.getFurnitureVisiblePropertyNames();for(n=0;n<r.length;n++){var l=r[n];e.writeStartElement("furnitureVisibleProperty"),e.writeAttribute$java_lang_String$java_lang_String("name",l),e.writeEndElement()}this.writeEnvironment(e,t.getEnvironment()),this.writeBackgroundImage(e,t.getBackgroundImage()),this.writePrint(e,t.getPrint()),this.writeCompass(e,t.getCompass()),this.writeCamera(e,t.getObserverCamera(),"observerCamera"),this.writeCamera(e,t.getTopCamera(),"topCamera");for(r=t.getStoredCameras(),n=0;n<r.length;n++){var a=r[n];this.writeCamera(e,a,"storedCamera")}for(r=t.getLevels(),n=0;n<r.length;n++){var s=r[n];this.writeLevel(e,s)}for(r=t.getFurniture(),n=0;n<r.length;n++){var h=r[n];this.writePieceOfFurniture(e,h)}for(r=t.getWalls(),n=0;n<r.length;n++){var u=r[n];this.writeWall(e,u)}for(r=t.getRooms(),n=0;n<r.length;n++){var d=r[n];this.writeRoom(e,d)}for(r=t.getPolylines(),n=0;n<r.length;n++){var c=r[n];this.writePolyline(e,c)}for(r=t.getDimensionLines(),n=0;n<r.length;n++){var p=r[n];this.writeDimensionLine(e,p)}for(r=t.getLabels(),n=0;n<r.length;n++){var g=r[n];this.writeLabel(e,g)}},t.prototype.writeChildren=function(t,i){if((null!=t&&t instanceof XMLWriter||null===t)&&(null!=i&&i instanceof Home||null===i))return this.writeChildren$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Home(t,i);if(!(null!=t&&t instanceof XMLWriter||null===t)||null==i&&null!==i)throw new Error("invalid overload");e.prototype.writeChildren.call(this,t,i)},t.prototype.writeEnvironment=function(e,i){new t.HomeXMLExporter$0(this).writeElement(e,i)},t.prototype.writeBackgroundImage=function(e,i){null!=i&&new t.HomeXMLExporter$1(this).writeElement(e,i)},t.prototype.writePrint=function(e,i){null!=i&&new t.HomeXMLExporter$2(this).writeElement(e,i)},t.prototype.writeCompass=function(e,i){new t.HomeXMLExporter$3(this).writeElement(e,i)},t.prototype.writeCamera=function(e,i,n){null!=i&&new t.HomeXMLExporter$4(this,n).writeElement(e,i)},t.prototype.writeLevel=function(e,i){new t.HomeXMLExporter$5(this).writeElement(e,i)},t.prototype.writePieceOfFurniture=function(e,i){new t.PieceOfFurnitureExporter(this).writeElement(e,i)},t.prototype.writeMaterial=function(e,i,n){null!=i&&new t.HomeXMLExporter$6(this).writeElement(e,i)},t.prototype.writeWall=function(e,i){new t.HomeXMLExporter$7(this).writeElement(e,i)},t.prototype.writeRoom=function(e,i){new t.HomeXMLExporter$8(this).writeElement(e,i)},t.prototype.writePolyline=function(e,i){new t.HomeXMLExporter$9(this).writeElement(e,i)},t.prototype.writeDimensionLine=function(e,i){new t.HomeXMLExporter$10(this).writeElement(e,i)},t.prototype.writeLabel=function(e,i){new t.HomeXMLExporter$11(this).writeElement(e,i)},t.prototype.writeTextStyle=function(e,i,n){null!=i&&new t.HomeXMLExporter$12(this,n).writeElement(e,i)},t.prototype.writeBaseboard=function(e,i,n){null!=i&&new t.HomeXMLExporter$13(this,n).writeElement(e,i)},t.prototype.writeTexture=function(e,i,n){null!=i&&new t.HomeXMLExporter$14(this,n).writeElement(e,i)},t.prototype.writeProperties=function(e,t){var i=t.getPropertyNames().slice(0);i.sort();for(var n=0;n<i.length;n++){var o=i[n],r=t.isContentProperty(o);this.writeProperty(e,t,o,r?t.getContentProperty(o):t.getProperty(o),r)}},t.prototype.writeProperty=function(e,t,i,n,o){null!=n&&(e.writeStartElement("property"),e.writeAttribute$java_lang_String$java_lang_String("name",i),e.writeAttribute$java_lang_String$java_lang_String("value",o?this.getExportedContentName(t,n):n.toString()),o&&e.writeAttribute$java_lang_String$java_lang_String("type",ObjectProperty.Type[ObjectProperty.Type.CONTENT]),e.writeEndElement())},t.floatToString=function(e){return Math.abs(e)<1e-6?"0":Math.abs(e-1)<1e-6?"1":Math.abs(e+1)<1e-6?"-1":String(e).toString()},t.prototype.getExportedContentName=function(e,t){if(null==t)return null;if(null!=this.savedContentNames){var i=this.savedContentNames[t.getURL()];if(null!=i)return i}return t.getURL()},t}(ObjectXMLExporter);HomeXMLExporter.__class="com.eteks.sweethome3d.io.HomeXMLExporter",function(e){var t=function(t){function i(e){var i=t.call(this)||this;return i.__parent=e,i}return __extends(i,t),i.prototype.writeAttributes$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_HomePieceOfFurniture=function(t,i){t.writeAttribute$java_lang_String$java_lang_String("id",i.getId()),null!=i.getLevel()&&t.writeAttribute$java_lang_String$java_lang_String("level",this.__parent.getId(i.getLevel())),t.writeAttribute$java_lang_String$java_lang_String$java_lang_String("catalogId",i.getCatalogId(),null),t.writeAttribute$java_lang_String$java_lang_String("name",i.getName()),t.writeAttribute$java_lang_String$java_lang_String$java_lang_String("creator",i.getCreator(),null),t.writeAttribute$java_lang_String$java_lang_String$java_lang_String("model",this.__parent.getExportedContentName(i,i.getModel()),null),t.writeAttribute$java_lang_String$java_lang_String$java_lang_String("icon",this.__parent.getExportedContentName(i,i.getIcon()),null),t.writeAttribute$java_lang_String$java_lang_String$java_lang_String("planIcon",this.__parent.getExportedContentName(i,i.getPlanIcon()),null),t.writeFloatAttribute$java_lang_String$float("x",i.getX()),t.writeFloatAttribute$java_lang_String$float("y",i.getY()),t.writeFloatAttribute$java_lang_String$float$float("elevation",i.getElevation(),0),t.writeFloatAttribute$java_lang_String$float$float("angle",i.getAngle(),0),t.writeFloatAttribute$java_lang_String$float$float("pitch",i.getPitch(),0),t.writeFloatAttribute$java_lang_String$float$float("roll",i.getRoll(),0),t.writeFloatAttribute$java_lang_String$float("width",i.getWidth()),t.writeFloatAttribute$java_lang_String$float$float("widthInPlan",i.getWidthInPlan(),i.getWidth()),t.writeFloatAttribute$java_lang_String$float("depth",i.getDepth()),t.writeFloatAttribute$java_lang_String$float$float("depthInPlan",i.getDepthInPlan(),i.getDepth()),t.writeFloatAttribute$java_lang_String$float("height",i.getHeight()),t.writeFloatAttribute$java_lang_String$float$float("heightInPlan",i.getHeightInPlan(),i.getHeight()),t.writeIntegerAttribute$java_lang_String$int$int("modelFlags",i.getModelFlags(),0),t.writeBooleanAttribute("modelMirrored",i.isModelMirrored(),!1),t.writeBooleanAttribute("visible",i.isVisible(),!0),t.writeColorAttribute("color",i.getColor()),null!=i.getShininess()&&t.writeFloatAttribute$java_lang_String$java_lang_Float("shininess",i.getShininess());var n=i.getModelRotation(),o=e.floatToString(n[0][0])+" "+e.floatToString(n[0][1])+" "+e.floatToString(n[0][2])+" "+e.floatToString(n[1][0])+" "+e.floatToString(n[1][1])+" "+e.floatToString(n[1][2])+" "+e.floatToString(n[2][0])+" "+e.floatToString(n[2][1])+" "+e.floatToString(n[2][2]);if(t.writeAttribute$java_lang_String$java_lang_String$java_lang_String("modelRotation",o,"1 0 0 0 1 0 0 0 1"),t.writeBooleanAttribute("modelCenteredAtOrigin",i.isModelCenteredAtOrigin(),!0),t.writeLongAttribute$java_lang_String$java_lang_Long("modelSize",i.getModelSize()),t.writeAttribute$java_lang_String$java_lang_String$java_lang_String("description",i.getDescription(),null),t.writeAttribute$java_lang_String$java_lang_String$java_lang_String("information",i.getInformation(),null),t.writeAttribute$java_lang_String$java_lang_String$java_lang_String("license",i.getLicense(),null),t.writeBooleanAttribute("movable",i.isMovable(),!0),null!=i&&i instanceof HomeFurnitureGroup||(null!=i&&i instanceof HomeDoorOrWindow||(t.writeBooleanAttribute("doorOrWindow",i.isDoorOrWindow(),!1),t.writeBooleanAttribute("horizontallyRotatable",i.isHorizontallyRotatable(),!0)),t.writeBooleanAttribute("resizable",i.isResizable(),!0),t.writeBooleanAttribute("deformable",i.isDeformable(),!0),t.writeBooleanAttribute("texturable",i.isTexturable(),!0)),null!=i&&i instanceof HomeFurnitureGroup){for(var r=i.getPrice(),l=i.getFurniture(),a=0;a<l.length;a++){if(null!=l[a].getPrice()){r=null;break}}t.writeBigDecimalAttribute("price",r)}else t.writeBigDecimalAttribute("price",i.getPrice()),t.writeBigDecimalAttribute("valueAddedTaxPercentage",i.getValueAddedTaxPercentage()),t.writeAttribute$java_lang_String$java_lang_String$java_lang_String("currency",i.getCurrency(),null);if(t.writeAttribute$java_lang_String$java_lang_String$java_lang_String("staircaseCutOutShape",i.getStaircaseCutOutShape(),null),t.writeFloatAttribute$java_lang_String$float$float("dropOnTopElevation",i.getDropOnTopElevation(),1),t.writeBooleanAttribute("nameVisible",i.isNameVisible(),!1),t.writeFloatAttribute$java_lang_String$float$float("nameAngle",i.getNameAngle(),0),t.writeFloatAttribute$java_lang_String$float$float("nameXOffset",i.getNameXOffset(),0),t.writeFloatAttribute$java_lang_String$float$float("nameYOffset",i.getNameYOffset(),0),null!=i&&i instanceof HomeDoorOrWindow){var s=i;t.writeFloatAttribute$java_lang_String$float$float("wallThickness",s.getWallThickness(),1),t.writeFloatAttribute$java_lang_String$float$float("wallDistance",s.getWallDistance(),0),t.writeFloatAttribute$java_lang_String$float$float("wallWidth",s.getWallWidth(),1),t.writeFloatAttribute$java_lang_String$float$float("wallLeft",s.getWallLeft(),0),t.writeFloatAttribute$java_lang_String$float$float("wallHeight",s.getWallHeight(),1),t.writeFloatAttribute$java_lang_String$float$float("wallTop",s.getWallTop(),0),t.writeAttribute$java_lang_String$java_lang_String$java_lang_String("cutOutShape",s.getCutOutShape(),null),t.writeBooleanAttribute("wallCutOutOnBothSides",s.isWallCutOutOnBothSides(),!1),t.writeBooleanAttribute("widthDepthDeformable",s.isWidthDepthDeformable(),!0),t.writeBooleanAttribute("boundToWall",s.isBoundToWall(),!0)}else null!=i&&i instanceof HomeLight&&t.writeFloatAttribute$java_lang_String$float("power",i.getPower())},i.prototype.writeAttributes=function(e,i){if((null!=e&&e instanceof XMLWriter||null===e)&&(null!=i&&i instanceof HomePieceOfFurniture||null===i))return this.writeAttributes$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_HomePieceOfFurniture(e,i);if(!(null!=e&&e instanceof XMLWriter||null===e)||null==i&&null!==i)throw new Error("invalid overload");t.prototype.writeAttributes.call(this,e,i)},i.prototype.writeChildren$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_HomePieceOfFurniture=function(t,i){if(null!=i&&i instanceof HomeFurnitureGroup)for(var n=i.getFurniture(),o=0;o<n.length;o++){var r=n[o];this.__parent.writePieceOfFurniture(t,r)}else if(null!=i&&i instanceof HomeLight){for(n=i.getLightSources(),o=0;o<n.length;o++){var l=n[o];t.writeStartElement("lightSource"),t.writeFloatAttribute$java_lang_String$float("x",l.getX()),t.writeFloatAttribute$java_lang_String$float("y",l.getY()),t.writeFloatAttribute$java_lang_String$float("z",l.getZ()),t.writeColorAttribute("color",l.getColor()),t.writeFloatAttribute$java_lang_String$java_lang_Float("diameter",l.getDiameter()),t.writeEndElement()}for(n=i.getLightSourceMaterialNames(),o=0;o<n.length;o++){var a=n[o];t.writeStartElement("lightSourceMaterial"),t.writeAttribute$java_lang_String$java_lang_String("name",a),t.writeEndElement()}}else if(null!=i&&i instanceof HomeDoorOrWindow)for(n=i.getSashes(),o=0;o<n.length;o++){var s=n[o];t.writeStartElement("sash"),t.writeFloatAttribute$java_lang_String$float("xAxis",s.getXAxis()),t.writeFloatAttribute$java_lang_String$float("yAxis",s.getYAxis()),t.writeFloatAttribute$java_lang_String$float("width",s.getWidth()),t.writeFloatAttribute$java_lang_String$float("startAngle",s.getStartAngle()),t.writeFloatAttribute$java_lang_String$float("endAngle",s.getEndAngle()),t.writeEndElement()}else if(null!=i&&i instanceof HomeShelfUnit){var h=i,u=h.getShelfElevations();if(null!=u)for(var d=0;d<u.length;d++)t.writeStartElement("shelf"),t.writeFloatAttribute$java_lang_String$float("elevation",u[d]),t.writeEndElement();var c=h.getShelfBoxes();if(null!=c)for(d=0;d<c.length;d++)t.writeStartElement("shelf"),t.writeFloatAttribute$java_lang_String$float("xLower",c[d].getXLower()),t.writeFloatAttribute$java_lang_String$float("yLower",c[d].getYLower()),t.writeFloatAttribute$java_lang_String$float("zLower",c[d].getZLower()),t.writeFloatAttribute$java_lang_String$float("xUpper",c[d].getXUpper()),t.writeFloatAttribute$java_lang_String$float("yUpper",c[d].getYUpper()),t.writeFloatAttribute$java_lang_String$float("zUpper",c[d].getZUpper()),t.writeEndElement()}if(this.__parent.writeProperties(t,i),this.__parent.writeTextStyle(t,i.getNameStyle(),"nameStyle"),this.__parent.writeTexture(t,i.getTexture(),null),null!=i.getModelMaterials())for(n=i.getModelMaterials(),o=0;o<n.length;o++){var p=n[o];this.__parent.writeMaterial(t,p,i.getModel())}if(null!=i.getModelTransformations())for(n=i.getModelTransformations(),o=0;o<n.length;o++){var g=n[o];t.writeStartElement("transformation"),t.writeAttribute$java_lang_String$java_lang_String$java_lang_String("name",g.getName(),null);var m=g.getMatrix(),f=e.floatToString(m[0][0])+" "+e.floatToString(m[0][1])+" "+e.floatToString(m[0][2])+" "+e.floatToString(m[0][3])+" "+e.floatToString(m[1][0])+" "+e.floatToString(m[1][1])+" "+e.floatToString(m[1][2])+" "+e.floatToString(m[1][3])+" "+e.floatToString(m[2][0])+" "+e.floatToString(m[2][1])+" "+e.floatToString(m[2][2])+" "+e.floatToString(m[2][3]);t.writeAttribute$java_lang_String$java_lang_String("matrix",f),t.writeEndElement()}},i.prototype.writeChildren=function(e,i){if((null!=e&&e instanceof XMLWriter||null===e)&&(null!=i&&i instanceof HomePieceOfFurniture||null===i))return this.writeChildren$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_HomePieceOfFurniture(e,i);if(!(null!=e&&e instanceof XMLWriter||null===e)||null==i&&null!==i)throw new Error("invalid overload");t.prototype.writeChildren.call(this,e,i)},i}(ObjectXMLExporter);e.PieceOfFurnitureExporter=t,t.__class="com.eteks.sweethome3d.io.HomeXMLExporter.PieceOfFurnitureExporter";var i=function(e){function t(t){var i=e.call(this)||this;return i.__parent=t,i}return __extends(t,e),t.prototype.writeAttributes$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_HomeEnvironment=function(e,t){e.writeColorAttribute("groundColor",t.getGroundColor()),e.writeBooleanAttribute("backgroundImageVisibleOnGround3D",t.isBackgroundImageVisibleOnGround3D(),!1),e.writeColorAttribute("skyColor",t.getSkyColor()),e.writeColorAttribute("lightColor",t.getLightColor()),e.writeFloatAttribute$java_lang_String$float$float("wallsAlpha",t.getWallsAlpha(),0),e.writeBooleanAttribute("allLevelsVisible",t.isAllLevelsVisible(),!1),e.writeBooleanAttribute("observerCameraElevationAdjusted",t.isObserverCameraElevationAdjusted(),!0),e.writeColorAttribute("ceillingLightColor",t.getCeillingLightColor()),e.writeAttribute$java_lang_String$java_lang_String$java_lang_String("drawingMode",HomeEnvironment.DrawingMode[t.getDrawingMode()],HomeEnvironment.DrawingMode[HomeEnvironment.DrawingMode.FILL]),e.writeFloatAttribute$java_lang_String$float$float("subpartSizeUnderLight",t.getSubpartSizeUnderLight(),0),e.writeIntegerAttribute$java_lang_String$int("photoWidth",t.getPhotoWidth()),e.writeIntegerAttribute$java_lang_String$int("photoHeight",t.getPhotoHeight()),e.writeAttribute$java_lang_String$java_lang_String("photoAspectRatio",AspectRatio[t.getPhotoAspectRatio()]),e.writeIntegerAttribute$java_lang_String$int("photoQuality",t.getPhotoQuality()),e.writeIntegerAttribute$java_lang_String$int("videoWidth",t.getVideoWidth()),e.writeAttribute$java_lang_String$java_lang_String("videoAspectRatio",AspectRatio[t.getVideoAspectRatio()]),e.writeIntegerAttribute$java_lang_String$int("videoQuality",t.getVideoQuality()),e.writeFloatAttribute$java_lang_String$float$float("videoSpeed",t.getVideoSpeed(),2400/3600),e.writeIntegerAttribute$java_lang_String$int("videoFrameRate",t.getVideoFrameRate())},t.prototype.writeAttributes=function(t,i){if((null!=t&&t instanceof XMLWriter||null===t)&&(null!=i&&i instanceof HomeEnvironment||null===i))return this.writeAttributes$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_HomeEnvironment(t,i);if(!(null!=t&&t instanceof XMLWriter||null===t)||null==i&&null!==i)throw new Error("invalid overload");e.prototype.writeAttributes.call(this,t,i)},t.prototype.writeChildren$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_HomeEnvironment=function(e,t){if(this.__parent.writeProperties(e,t),0!=t.getVideoCameraPath().length)for(var i=t.getVideoCameraPath(),n=0;n<i.length;n++){var o=i[n];this.__parent.writeCamera(e,o,"cameraPath")}this.__parent.writeTexture(e,t.getGroundTexture(),"groundTexture"),this.__parent.writeTexture(e,t.getSkyTexture(),"skyTexture")},t.prototype.writeChildren=function(t,i){if((null!=t&&t instanceof XMLWriter||null===t)&&(null!=i&&i instanceof HomeEnvironment||null===i))return this.writeChildren$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_HomeEnvironment(t,i);if(!(null!=t&&t instanceof XMLWriter||null===t)||null==i&&null!==i)throw new Error("invalid overload");e.prototype.writeChildren.call(this,t,i)},t}(ObjectXMLExporter);e.HomeXMLExporter$0=i;var n=function(e){function t(t){var i=e.call(this)||this;return i.__parent=t,i}return __extends(t,e),t.prototype.writeAttributes$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_BackgroundImage=function(e,t){e.writeAttribute$java_lang_String$java_lang_String$java_lang_String("image",this.__parent.getExportedContentName(t,t.getImage()),null),e.writeFloatAttribute$java_lang_String$float("scaleDistance",t.getScaleDistance()),e.writeFloatAttribute$java_lang_String$float("scaleDistanceXStart",t.getScaleDistanceXStart()),e.writeFloatAttribute$java_lang_String$float("scaleDistanceYStart",t.getScaleDistanceYStart()),e.writeFloatAttribute$java_lang_String$float("scaleDistanceXEnd",t.getScaleDistanceXEnd()),e.writeFloatAttribute$java_lang_String$float("scaleDistanceYEnd",t.getScaleDistanceYEnd()),e.writeFloatAttribute$java_lang_String$float$float("xOrigin",t.getXOrigin(),0),e.writeFloatAttribute$java_lang_String$float$float("yOrigin",t.getYOrigin(),0),e.writeBooleanAttribute("visible",t.isVisible(),!0)},t.prototype.writeAttributes=function(t,i){if((null!=t&&t instanceof XMLWriter||null===t)&&(null!=i&&i instanceof BackgroundImage||null===i))return this.writeAttributes$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_BackgroundImage(t,i);if(!(null!=t&&t instanceof XMLWriter||null===t)||null==i&&null!==i)throw new Error("invalid overload");e.prototype.writeAttributes.call(this,t,i)},t}(ObjectXMLExporter);e.HomeXMLExporter$1=n;var o=function(e){function t(t){var i=e.call(this)||this;return i.__parent=t,i}return __extends(t,e),t.prototype.writeAttributes$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_HomePrint=function(e,t){e.writeAttribute$java_lang_String$java_lang_String$java_lang_String("headerFormat",t.getHeaderFormat(),null),e.writeAttribute$java_lang_String$java_lang_String$java_lang_String("footerFormat",t.getFooterFormat(),null),e.writeBooleanAttribute("furniturePrinted",t.isFurniturePrinted(),!0),e.writeBooleanAttribute("planPrinted",t.isPlanPrinted(),!0),e.writeBooleanAttribute("view3DPrinted",t.isView3DPrinted(),!0),e.writeFloatAttribute$java_lang_String$java_lang_Float("planScale",t.getPlanScale()),e.writeFloatAttribute$java_lang_String$float("paperWidth",t.getPaperWidth()),e.writeFloatAttribute$java_lang_String$float("paperHeight",t.getPaperHeight()),e.writeFloatAttribute$java_lang_String$float("paperTopMargin",t.getPaperTopMargin()),e.writeFloatAttribute$java_lang_String$float("paperLeftMargin",t.getPaperLeftMargin()),e.writeFloatAttribute$java_lang_String$float("paperBottomMargin",t.getPaperBottomMargin()),e.writeFloatAttribute$java_lang_String$float("paperRightMargin",t.getPaperRightMargin()),e.writeAttribute$java_lang_String$java_lang_String("paperOrientation",HomePrint.PaperOrientation[t.getPaperOrientation()])},t.prototype.writeAttributes=function(t,i){if((null!=t&&t instanceof XMLWriter||null===t)&&(null!=i&&i instanceof HomePrint||null===i))return this.writeAttributes$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_HomePrint(t,i);if(!(null!=t&&t instanceof XMLWriter||null===t)||null==i&&null!==i)throw new Error("invalid overload");e.prototype.writeAttributes.call(this,t,i)},t.prototype.writeChildren$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_HomePrint=function(e,t){var i=t.getPrintedLevels();if(null!=i)for(var n=0;n<i.length;n++){var o=i[n];e.writeStartElement("printedLevel"),e.writeAttribute$java_lang_String$java_lang_String("level",this.__parent.getId(o)),e.writeEndElement()}},t.prototype.writeChildren=function(t,i){if((null!=t&&t instanceof XMLWriter||null===t)&&(null!=i&&i instanceof HomePrint||null===i))return this.writeChildren$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_HomePrint(t,i);if(!(null!=t&&t instanceof XMLWriter||null===t)||null==i&&null!==i)throw new Error("invalid overload");e.prototype.writeChildren.call(this,t,i)},t}(ObjectXMLExporter);e.HomeXMLExporter$2=o;var r=function(e){function t(t){var i=e.call(this)||this;return i.__parent=t,i}return __extends(t,e),t.prototype.writeAttributes$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Compass=function(e,t){e.writeFloatAttribute$java_lang_String$float("x",t.getX()),e.writeFloatAttribute$java_lang_String$float("y",t.getY()),e.writeFloatAttribute$java_lang_String$float("diameter",t.getDiameter()),e.writeFloatAttribute$java_lang_String$float("northDirection",t.getNorthDirection()),e.writeFloatAttribute$java_lang_String$float("longitude",t.getLongitude()),e.writeFloatAttribute$java_lang_String$float("latitude",t.getLatitude()),e.writeAttribute$java_lang_String$java_lang_String("timeZone",t.getTimeZone()),e.writeBooleanAttribute("visible",t.isVisible(),!0)},t.prototype.writeAttributes=function(t,i){if((null!=t&&t instanceof XMLWriter||null===t)&&(null!=i&&i instanceof Compass||null===i))return this.writeAttributes$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Compass(t,i);if(!(null!=t&&t instanceof XMLWriter||null===t)||null==i&&null!==i)throw new Error("invalid overload");e.prototype.writeAttributes.call(this,t,i)},t.prototype.writeChildren$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Compass=function(e,t){this.__parent.writeProperties(e,t)},t.prototype.writeChildren=function(t,i){if((null!=t&&t instanceof XMLWriter||null===t)&&(null!=i&&i instanceof Compass||null===i))return this.writeChildren$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Compass(t,i);if(!(null!=t&&t instanceof XMLWriter||null===t)||null==i&&null!==i)throw new Error("invalid overload");e.prototype.writeChildren.call(this,t,i)},t}(ObjectXMLExporter);e.HomeXMLExporter$3=r;var l=function(e){function t(t,i){var n=e.call(this)||this;return n.attributeName=i,n.__parent=t,n}return __extends(t,e),t.prototype.writeAttributes$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Camera=function(e,t){e.writeAttribute$java_lang_String$java_lang_String$java_lang_String("attribute",this.attributeName,null),"observerCamera"!==this.attributeName&&"topCamera"!==this.attributeName&&e.writeAttribute$java_lang_String$java_lang_String("id",t.getId()),e.writeAttribute$java_lang_String$java_lang_String$java_lang_String("name",t.getName(),null),e.writeAttribute$java_lang_String$java_lang_String("lens",Camera.Lens[t.getLens()]),e.writeFloatAttribute$java_lang_String$float("x",t.getX()),e.writeFloatAttribute$java_lang_String$float("y",t.getY()),e.writeFloatAttribute$java_lang_String$float("z",t.getZ()),e.writeFloatAttribute$java_lang_String$float("yaw",t.getYaw()),e.writeFloatAttribute$java_lang_String$float("pitch",t.getPitch()),e.writeFloatAttribute$java_lang_String$float("fieldOfView",t.getFieldOfView()),e.writeLongAttribute$java_lang_String$long("time",t.getTime()),null!=t&&t instanceof ObserverCamera&&e.writeBooleanAttribute("fixedSize",t.isFixedSize(),!1),e.writeAttribute$java_lang_String$java_lang_String$java_lang_String("renderer",t.getRenderer(),null)},t.prototype.writeAttributes=function(t,i){if((null!=t&&t instanceof XMLWriter||null===t)&&(null!=i&&i instanceof Camera||null===i))return this.writeAttributes$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Camera(t,i);if(!(null!=t&&t instanceof XMLWriter||null===t)||null==i&&null!==i)throw new Error("invalid overload");e.prototype.writeAttributes.call(this,t,i)},t.prototype.writeChildren$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Camera=function(e,t){this.__parent.writeProperties(e,t)},t.prototype.writeChildren=function(t,i){if((null!=t&&t instanceof XMLWriter||null===t)&&(null!=i&&i instanceof Camera||null===i))return this.writeChildren$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Camera(t,i);if(!(null!=t&&t instanceof XMLWriter||null===t)||null==i&&null!==i)throw new Error("invalid overload");e.prototype.writeChildren.call(this,t,i)},t}(ObjectXMLExporter);e.HomeXMLExporter$4=l;var a=function(e){function t(t){var i=e.call(this)||this;return i.__parent=t,i}return __extends(t,e),t.prototype.writeAttributes$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Level=function(e,t){e.writeAttribute$java_lang_String$java_lang_String("id",t.getId()),e.writeAttribute$java_lang_String$java_lang_String("name",t.getName()),e.writeFloatAttribute$java_lang_String$float("elevation",t.getElevation()),e.writeFloatAttribute$java_lang_String$float("floorThickness",t.getFloorThickness()),e.writeFloatAttribute$java_lang_String$float("height",t.getHeight()),e.writeIntegerAttribute$java_lang_String$int("elevationIndex",t.getElevationIndex()),e.writeBooleanAttribute("visible",t.isVisible(),!0),e.writeBooleanAttribute("viewable",t.isViewable(),!0)},t.prototype.writeAttributes=function(t,i){if((null!=t&&t instanceof XMLWriter||null===t)&&(null!=i&&i instanceof Level||null===i))return this.writeAttributes$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Level(t,i);if(!(null!=t&&t instanceof XMLWriter||null===t)||null==i&&null!==i)throw new Error("invalid overload");e.prototype.writeAttributes.call(this,t,i)},t.prototype.writeChildren$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Level=function(e,t){this.__parent.writeProperties(e,t),this.__parent.writeBackgroundImage(e,t.getBackgroundImage())},t.prototype.writeChildren=function(t,i){if((null!=t&&t instanceof XMLWriter||null===t)&&(null!=i&&i instanceof Level||null===i))return this.writeChildren$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Level(t,i);if(!(null!=t&&t instanceof XMLWriter||null===t)||null==i&&null!==i)throw new Error("invalid overload");e.prototype.writeChildren.call(this,t,i)},t}(ObjectXMLExporter);e.HomeXMLExporter$5=a;var s=function(e){function t(t){var i=e.call(this)||this;return i.__parent=t,i}return __extends(t,e),t.prototype.writeAttributes$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_HomeMaterial=function(e,t){e.writeAttribute$java_lang_String$java_lang_String("name",t.getName()),e.writeAttribute$java_lang_String$java_lang_String$java_lang_String("key",t.getKey(),null),e.writeColorAttribute("color",t.getColor()),null!=t.getShininess()&&e.writeFloatAttribute$java_lang_String$java_lang_Float("shininess",t.getShininess())},t.prototype.writeAttributes=function(t,i){if((null!=t&&t instanceof XMLWriter||null===t)&&(null!=i&&i instanceof HomeMaterial||null===i))return this.writeAttributes$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_HomeMaterial(t,i);if(!(null!=t&&t instanceof XMLWriter||null===t)||null==i&&null!==i)throw new Error("invalid overload");e.prototype.writeAttributes.call(this,t,i)},t.prototype.writeChildren$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_HomeMaterial=function(e,t){this.__parent.writeTexture(e,t.getTexture(),null)},t.prototype.writeChildren=function(t,i){if((null!=t&&t instanceof XMLWriter||null===t)&&(null!=i&&i instanceof HomeMaterial||null===i))return this.writeChildren$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_HomeMaterial(t,i);if(!(null!=t&&t instanceof XMLWriter||null===t)||null==i&&null!==i)throw new Error("invalid overload");e.prototype.writeChildren.call(this,t,i)},t}(ObjectXMLExporter);e.HomeXMLExporter$6=s;var h=function(e){function t(t){var i=e.call(this)||this;return i.__parent=t,i}return __extends(t,e),t.prototype.writeAttributes$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Wall=function(e,t){var i;(e.writeAttribute$java_lang_String$java_lang_String("id",t.getId()),null!=t.getLevel()&&e.writeAttribute$java_lang_String$java_lang_String("level",this.__parent.getId(t.getLevel())),null!=t.getWallAtStart())&&(null!=(i=this.__parent.getId(t.getWallAtStart()))&&e.writeAttribute$java_lang_String$java_lang_String("wallAtStart",i));null!=t.getWallAtEnd()&&(null!=(i=this.__parent.getId(t.getWallAtEnd()))&&e.writeAttribute$java_lang_String$java_lang_String("wallAtEnd",i));e.writeFloatAttribute$java_lang_String$float("xStart",t.getXStart()),e.writeFloatAttribute$java_lang_String$float("yStart",t.getYStart()),e.writeFloatAttribute$java_lang_String$float("xEnd",t.getXEnd()),e.writeFloatAttribute$java_lang_String$float("yEnd",t.getYEnd()),e.writeFloatAttribute$java_lang_String$java_lang_Float("height",t.getHeight()),e.writeFloatAttribute$java_lang_String$java_lang_Float("heightAtEnd",t.getHeightAtEnd()),e.writeFloatAttribute$java_lang_String$float("thickness",t.getThickness()),e.writeFloatAttribute$java_lang_String$java_lang_Float("arcExtent",t.getArcExtent()),null!=t.getPattern()&&e.writeAttribute$java_lang_String$java_lang_String("pattern",t.getPattern().getName()),e.writeColorAttribute("topColor",t.getTopColor()),e.writeColorAttribute("leftSideColor",t.getLeftSideColor()),e.writeFloatAttribute$java_lang_String$float$float("leftSideShininess",t.getLeftSideShininess(),0),e.writeColorAttribute("rightSideColor",t.getRightSideColor()),e.writeFloatAttribute$java_lang_String$float$float("rightSideShininess",t.getRightSideShininess(),0)},t.prototype.writeAttributes=function(t,i){if((null!=t&&t instanceof XMLWriter||null===t)&&(null!=i&&i instanceof Wall||null===i))return this.writeAttributes$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Wall(t,i);if(!(null!=t&&t instanceof XMLWriter||null===t)||null==i&&null!==i)throw new Error("invalid overload");e.prototype.writeAttributes.call(this,t,i)},t.prototype.writeChildren$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Wall=function(e,t){this.__parent.writeProperties(e,t),this.__parent.writeTexture(e,t.getLeftSideTexture(),"leftSideTexture"),this.__parent.writeTexture(e,t.getRightSideTexture(),"rightSideTexture"),this.__parent.writeBaseboard(e,t.getLeftSideBaseboard(),"leftSideBaseboard"),this.__parent.writeBaseboard(e,t.getRightSideBaseboard(),"rightSideBaseboard")},t.prototype.writeChildren=function(t,i){if((null!=t&&t instanceof XMLWriter||null===t)&&(null!=i&&i instanceof Wall||null===i))return this.writeChildren$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Wall(t,i);if(!(null!=t&&t instanceof XMLWriter||null===t)||null==i&&null!==i)throw new Error("invalid overload");e.prototype.writeChildren.call(this,t,i)},t}(ObjectXMLExporter);e.HomeXMLExporter$7=h;var u=function(e){function t(t){var i=e.call(this)||this;return i.__parent=t,i}return __extends(t,e),t.prototype.writeAttributes$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Room=function(e,t){e.writeAttribute$java_lang_String$java_lang_String("id",t.getId()),null!=t.getLevel()&&e.writeAttribute$java_lang_String$java_lang_String("level",this.__parent.getId(t.getLevel())),e.writeAttribute$java_lang_String$java_lang_String$java_lang_String("name",t.getName(),null),e.writeFloatAttribute$java_lang_String$float$float("nameAngle",t.getNameAngle(),0),e.writeFloatAttribute$java_lang_String$float$float("nameXOffset",t.getNameXOffset(),0),e.writeFloatAttribute$java_lang_String$float$float("nameYOffset",t.getNameYOffset(),-40),e.writeBooleanAttribute("areaVisible",t.isAreaVisible(),!1),e.writeFloatAttribute$java_lang_String$float$float("areaAngle",t.getAreaAngle(),0),e.writeFloatAttribute$java_lang_String$float$float("areaXOffset",t.getAreaXOffset(),0),e.writeFloatAttribute$java_lang_String$float$float("areaYOffset",t.getAreaYOffset(),0),e.writeBooleanAttribute("floorVisible",t.isFloorVisible(),!0),e.writeColorAttribute("floorColor",t.getFloorColor()),e.writeFloatAttribute$java_lang_String$float$float("floorShininess",t.getFloorShininess(),0),e.writeBooleanAttribute("ceilingVisible",t.isCeilingVisible(),!0),e.writeColorAttribute("ceilingColor",t.getCeilingColor()),e.writeFloatAttribute$java_lang_String$float$float("ceilingShininess",t.getCeilingShininess(),0),e.writeBooleanAttribute("ceilingFlat",t.isCeilingFlat(),!1)},t.prototype.writeAttributes=function(t,i){if((null!=t&&t instanceof XMLWriter||null===t)&&(null!=i&&i instanceof Room||null===i))return this.writeAttributes$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Room(t,i);if(!(null!=t&&t instanceof XMLWriter||null===t)||null==i&&null!==i)throw new Error("invalid overload");e.prototype.writeAttributes.call(this,t,i)},t.prototype.writeChildren$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Room=function(e,t){this.__parent.writeProperties(e,t),this.__parent.writeTextStyle(e,t.getNameStyle(),"nameStyle"),this.__parent.writeTextStyle(e,t.getAreaStyle(),"areaStyle"),this.__parent.writeTexture(e,t.getFloorTexture(),"floorTexture"),this.__parent.writeTexture(e,t.getCeilingTexture(),"ceilingTexture");for(var i=t.getPoints(),n=0;n<i.length;n++){var o=i[n];e.writeStartElement("point"),e.writeFloatAttribute$java_lang_String$float("x",o[0]),e.writeFloatAttribute$java_lang_String$float("y",o[1]),e.writeEndElement()}},t.prototype.writeChildren=function(t,i){if((null!=t&&t instanceof XMLWriter||null===t)&&(null!=i&&i instanceof Room||null===i))return this.writeChildren$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Room(t,i);if(!(null!=t&&t instanceof XMLWriter||null===t)||null==i&&null!==i)throw new Error("invalid overload");e.prototype.writeChildren.call(this,t,i)},t}(ObjectXMLExporter);e.HomeXMLExporter$8=u;var d=function(t){function i(e){var i=t.call(this)||this;return i.__parent=e,i}return __extends(i,t),i.prototype.writeAttributes$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Polyline=function(t,i){if(t.writeAttribute$java_lang_String$java_lang_String("id",i.getId()),null!=i.getLevel()&&t.writeAttribute$java_lang_String$java_lang_String("level",this.__parent.getId(i.getLevel())),t.writeFloatAttribute$java_lang_String$float$float("thickness",i.getThickness(),1),t.writeAttribute$java_lang_String$java_lang_String$java_lang_String("capStyle",Polyline.CapStyle[i.getCapStyle()],Polyline.CapStyle[Polyline.CapStyle.BUTT]),t.writeAttribute$java_lang_String$java_lang_String$java_lang_String("joinStyle",Polyline.JoinStyle[i.getJoinStyle()],Polyline.JoinStyle[Polyline.JoinStyle.MITER]),t.writeAttribute$java_lang_String$java_lang_String$java_lang_String("dashStyle",Polyline.DashStyle[i.getDashStyle()],Polyline.DashStyle[Polyline.DashStyle.SOLID]),i.getDashStyle()===Polyline.DashStyle.CUSTOMIZED){for(var n={str:"",toString:function(){return this.str}},o=i.getDashPattern(),r=0;r<o.length;r++)l=void 0,l=o[r],n.str+=e.floatToString(l),n.str+=" ";!function(e,t){e.str=e.str.substring(0,t)}(n,n.str.length-1),t.writeAttribute$java_lang_String$java_lang_String("dashPattern",n.str)}var l;t.writeFloatAttribute$java_lang_String$float$float("dashOffset",i.getDashOffset(),0),t.writeAttribute$java_lang_String$java_lang_String$java_lang_String("startArrowStyle",Polyline.ArrowStyle[i.getStartArrowStyle()],Polyline.ArrowStyle[Polyline.ArrowStyle.NONE]),t.writeAttribute$java_lang_String$java_lang_String$java_lang_String("endArrowStyle",Polyline.ArrowStyle[i.getEndArrowStyle()],Polyline.ArrowStyle[Polyline.ArrowStyle.NONE]),i.isVisibleIn3D()&&t.writeFloatAttribute$java_lang_String$float("elevation",i.getElevation()),t.writeColorAttribute("color",i.getColor()),t.writeBooleanAttribute("closedPath",i.isClosedPath(),!1)},i.prototype.writeAttributes=function(e,i){if((null!=e&&e instanceof XMLWriter||null===e)&&(null!=i&&i instanceof Polyline||null===i))return this.writeAttributes$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Polyline(e,i);if(!(null!=e&&e instanceof XMLWriter||null===e)||null==i&&null!==i)throw new Error("invalid overload");t.prototype.writeAttributes.call(this,e,i)},i.prototype.writeChildren$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Polyline=function(e,t){this.__parent.writeProperties(e,t);for(var i=t.getPoints(),n=0;n<i.length;n++){var o=i[n];e.writeStartElement("point"),e.writeFloatAttribute$java_lang_String$float("x",o[0]),e.writeFloatAttribute$java_lang_String$float("y",o[1]),e.writeEndElement()}},i.prototype.writeChildren=function(e,i){if((null!=e&&e instanceof XMLWriter||null===e)&&(null!=i&&i instanceof Polyline||null===i))return this.writeChildren$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Polyline(e,i);if(!(null!=e&&e instanceof XMLWriter||null===e)||null==i&&null!==i)throw new Error("invalid overload");t.prototype.writeChildren.call(this,e,i)},i}(ObjectXMLExporter);e.HomeXMLExporter$9=d;var c=function(e){function t(t){var i=e.call(this)||this;return i.__parent=t,i}return __extends(t,e),t.prototype.writeAttributes$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_DimensionLine=function(e,t){e.writeAttribute$java_lang_String$java_lang_String("id",t.getId()),null!=t.getLevel()&&e.writeAttribute$java_lang_String$java_lang_String("level",this.__parent.getId(t.getLevel())),e.writeFloatAttribute$java_lang_String$float("xStart",t.getXStart()),e.writeFloatAttribute$java_lang_String$float("yStart",t.getYStart()),e.writeFloatAttribute$java_lang_String$float$float("elevationStart",t.getElevationStart(),0),e.writeFloatAttribute$java_lang_String$float("xEnd",t.getXEnd()),e.writeFloatAttribute$java_lang_String$float("yEnd",t.getYEnd()),e.writeFloatAttribute$java_lang_String$float$float("elevationEnd",t.getElevationEnd(),0),e.writeFloatAttribute$java_lang_String$float("offset",t.getOffset()),e.writeFloatAttribute$java_lang_String$float$float("endMarkSize",t.getEndMarkSize(),10),e.writeFloatAttribute$java_lang_String$float$float("pitch",t.getPitch(),0),e.writeColorAttribute("color",t.getColor()),e.writeBooleanAttribute("visibleIn3D",t.isVisibleIn3D(),!1)},t.prototype.writeAttributes=function(t,i){if((null!=t&&t instanceof XMLWriter||null===t)&&(null!=i&&i instanceof DimensionLine||null===i))return this.writeAttributes$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_DimensionLine(t,i);if(!(null!=t&&t instanceof XMLWriter||null===t)||null==i&&null!==i)throw new Error("invalid overload");e.prototype.writeAttributes.call(this,t,i)},t.prototype.writeChildren$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_DimensionLine=function(e,t){this.__parent.writeProperties(e,t),this.__parent.writeTextStyle(e,t.getLengthStyle(),"lengthStyle")},t.prototype.writeChildren=function(t,i){if((null!=t&&t instanceof XMLWriter||null===t)&&(null!=i&&i instanceof DimensionLine||null===i))return this.writeChildren$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_DimensionLine(t,i);if(!(null!=t&&t instanceof XMLWriter||null===t)||null==i&&null!==i)throw new Error("invalid overload");e.prototype.writeChildren.call(this,t,i)},t}(ObjectXMLExporter);e.HomeXMLExporter$10=c;var p=function(e){function t(t){var i=e.call(this)||this;return i.__parent=t,i}return __extends(t,e),t.prototype.writeAttributes$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Label=function(e,t){e.writeAttribute$java_lang_String$java_lang_String("id",t.getId()),null!=t.getLevel()&&e.writeAttribute$java_lang_String$java_lang_String("level",this.__parent.getId(t.getLevel())),e.writeFloatAttribute$java_lang_String$float("x",t.getX()),e.writeFloatAttribute$java_lang_String$float("y",t.getY()),e.writeFloatAttribute$java_lang_String$float$float("angle",t.getAngle(),0),e.writeFloatAttribute$java_lang_String$float$float("elevation",t.getElevation(),0),e.writeFloatAttribute$java_lang_String$java_lang_Float("pitch",t.getPitch()),e.writeColorAttribute("color",t.getColor()),e.writeColorAttribute("outlineColor",t.getOutlineColor())},t.prototype.writeAttributes=function(t,i){if((null!=t&&t instanceof XMLWriter||null===t)&&(null!=i&&i instanceof Label||null===i))return this.writeAttributes$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Label(t,i);if(!(null!=t&&t instanceof XMLWriter||null===t)||null==i&&null!==i)throw new Error("invalid overload");e.prototype.writeAttributes.call(this,t,i)},t.prototype.writeChildren$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Label=function(e,t){this.__parent.writeProperties(e,t),this.__parent.writeTextStyle(e,t.getStyle(),null),e.writeStartElement("text"),e.writeText(t.getText()),e.writeEndElement()},t.prototype.writeChildren=function(t,i){if((null!=t&&t instanceof XMLWriter||null===t)&&(null!=i&&i instanceof Label||null===i))return this.writeChildren$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Label(t,i);if(!(null!=t&&t instanceof XMLWriter||null===t)||null==i&&null!==i)throw new Error("invalid overload");e.prototype.writeChildren.call(this,t,i)},t}(ObjectXMLExporter);e.HomeXMLExporter$11=p;var g=function(e){function t(t,i){var n=e.call(this)||this;return n.attributeName=i,n.__parent=t,n}return __extends(t,e),t.prototype.writeAttributes$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_TextStyle=function(e,t){e.writeAttribute$java_lang_String$java_lang_String$java_lang_String("attribute",this.attributeName,null),e.writeAttribute$java_lang_String$java_lang_String$java_lang_String("fontName",t.getFontName(),null),e.writeFloatAttribute$java_lang_String$float("fontSize",t.getFontSize()),e.writeBooleanAttribute("bold",t.isBold(),!1),e.writeBooleanAttribute("italic",t.isItalic(),!1),e.writeAttribute$java_lang_String$java_lang_String$java_lang_String("alignment",TextStyle.Alignment[t.getAlignment()],TextStyle.Alignment[TextStyle.Alignment.CENTER])},t.prototype.writeAttributes=function(t,i){if((null!=t&&t instanceof XMLWriter||null===t)&&(null!=i&&i instanceof TextStyle||null===i))return this.writeAttributes$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_TextStyle(t,i);if(!(null!=t&&t instanceof XMLWriter||null===t)||null==i&&null!==i)throw new Error("invalid overload");e.prototype.writeAttributes.call(this,t,i)},t}(ObjectXMLExporter);e.HomeXMLExporter$12=g;var m=function(e){function t(t,i){var n=e.call(this)||this;return n.attributeName=i,n.__parent=t,n}return __extends(t,e),t.prototype.writeAttributes$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Baseboard=function(e,t){e.writeAttribute$java_lang_String$java_lang_String$java_lang_String("attribute",this.attributeName,null),e.writeFloatAttribute$java_lang_String$float("thickness",t.getThickness()),e.writeFloatAttribute$java_lang_String$float("height",t.getHeight()),e.writeColorAttribute("color",t.getColor())},t.prototype.writeAttributes=function(t,i){if((null!=t&&t instanceof XMLWriter||null===t)&&(null!=i&&i instanceof Baseboard||null===i))return this.writeAttributes$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Baseboard(t,i);if(!(null!=t&&t instanceof XMLWriter||null===t)||null==i&&null!==i)throw new Error("invalid overload");e.prototype.writeAttributes.call(this,t,i)},t.prototype.writeChildren$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Baseboard=function(e,t){this.__parent.writeTexture(e,t.getTexture(),null)},t.prototype.writeChildren=function(t,i){if((null!=t&&t instanceof XMLWriter||null===t)&&(null!=i&&i instanceof Baseboard||null===i))return this.writeChildren$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Baseboard(t,i);if(!(null!=t&&t instanceof XMLWriter||null===t)||null==i&&null!==i)throw new Error("invalid overload");e.prototype.writeChildren.call(this,t,i)},t}(ObjectXMLExporter);e.HomeXMLExporter$13=m;var f=function(e){function t(t,i){var n=e.call(this)||this;return n.attributeName=i,n.__parent=t,n}return __extends(t,e),t.prototype.writeAttributes$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_HomeTexture=function(e,t){e.writeAttribute$java_lang_String$java_lang_String$java_lang_String("attribute",this.attributeName,null),e.writeAttribute$java_lang_String$java_lang_String$java_lang_String("name",t.getName(),null),e.writeAttribute$java_lang_String$java_lang_String$java_lang_String("creator",t.getCreator(),null),e.writeAttribute$java_lang_String$java_lang_String$java_lang_String("catalogId",t.getCatalogId(),null),e.writeFloatAttribute$java_lang_String$float("width",t.getWidth()),e.writeFloatAttribute$java_lang_String$float("height",t.getHeight()),e.writeFloatAttribute$java_lang_String$float$float("xOffset",t.getXOffset(),0),e.writeFloatAttribute$java_lang_String$float$float("yOffset",t.getYOffset(),0),e.writeFloatAttribute$java_lang_String$float$float("angle",t.getAngle(),0),e.writeFloatAttribute$java_lang_String$float$float("scale",t.getScale(),1),e.writeBooleanAttribute("fittingArea",t.isFittingArea(),!1),e.writeBooleanAttribute("leftToRightOriented",t.isLeftToRightOriented(),!0),e.writeAttribute$java_lang_String$java_lang_String$java_lang_String("image",this.__parent.getExportedContentName(t,t.getImage()),null)},t.prototype.writeAttributes=function(t,i){if((null!=t&&t instanceof XMLWriter||null===t)&&(null!=i&&i instanceof HomeTexture||null===i))return this.writeAttributes$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_HomeTexture(t,i);if(!(null!=t&&t instanceof XMLWriter||null===t)||null==i&&null!==i)throw new Error("invalid overload");e.prototype.writeAttributes.call(this,t,i)},t}(ObjectXMLExporter);e.HomeXMLExporter$14=f}(HomeXMLExporter||(HomeXMLExporter={}));var InterruptedRecorderException=function(e){function t(t){var i=this;if("string"==typeof t||null===t){i=e.call(this,t)||this}else{if(void 0!==t)throw new Error("invalid overload");i=e.call(this)||this}return i}return __extends(t,e),t}(RecorderException);InterruptedRecorderException.__class="com.eteks.sweethome3d.model.InterruptedRecorderException";var NotEnoughSpaceRecorderException=function(e){function t(i,n){var o=e.call(this,i)||this;return Object.setPrototypeOf(o,t.prototype),void 0===o.missingSpace&&(o.missingSpace=0),o.missingSpace=n,o}return __extends(t,e),t.prototype.getMissingSpace=function(){return this.missingSpace},t}(RecorderException);NotEnoughSpaceRecorderException.__class="com.eteks.sweethome3d.model.NotEnoughSpaceRecorderException";var DamagedHomeRecorderException=function(e){function t(t,i,n){var o=this;if((null!=t&&t instanceof Home||null===t)&&(null!=i&&i instanceof Array||null===i)&&("string"==typeof n||null===n)){void 0===(o=e.call(this,n)||this).damagedHome&&(o.damagedHome=null),void 0===o.invalidContent&&(o.invalidContent=null),o.damagedHome=t,o.invalidContent=i}else{if(!(null!=t&&t instanceof Home||null===t)||!(null!=i&&i instanceof Array||null===i)||void 0!==n)throw new Error("invalid overload");void 0===(o=e.call(this)||this).damagedHome&&(o.damagedHome=null),void 0===o.invalidContent&&(o.invalidContent=null),o.damagedHome=t,o.invalidContent=i}return o}return __extends(t,e),t.prototype.getDamagedHome=function(){return this.damagedHome},t.prototype.getInvalidContent=function(){return this.invalidContent},t}(RecorderException);DamagedHomeRecorderException.__class="com.eteks.sweethome3d.model.DamagedHomeRecorderException";var Room=function(e){function t(t,i){var n=this;if("string"!=typeof t&&null!==t||!(null!=i&&i instanceof Array&&(0==i.length||null==i[0]||i[0]instanceof Array)||null===i)){if(!(null!=t&&t instanceof Array&&(0==t.length||null==t[0]||t[0]instanceof Array)||null===t)||void 0!==i)throw new Error("invalid overload");var o=arguments[0],r=HomeObject.createId("room");if(void 0===(n=e.call(this,r)||this).name&&(n.name=null),void 0===n.nameXOffset&&(n.nameXOffset=0),void 0===n.nameYOffset&&(n.nameYOffset=0),void 0===n.nameStyle&&(n.nameStyle=null),void 0===n.nameAngle&&(n.nameAngle=0),void 0===n.points&&(n.points=null),void 0===n.areaVisible&&(n.areaVisible=!1),void 0===n.areaXOffset&&(n.areaXOffset=0),void 0===n.areaYOffset&&(n.areaYOffset=0),void 0===n.areaStyle&&(n.areaStyle=null),void 0===n.areaAngle&&(n.areaAngle=0),void 0===n.floorVisible&&(n.floorVisible=!1),void 0===n.floorColor&&(n.floorColor=null),void 0===n.floorTexture&&(n.floorTexture=null),void 0===n.floorShininess&&(n.floorShininess=0),void 0===n.ceilingVisible&&(n.ceilingVisible=!1),void 0===n.ceilingColor&&(n.ceilingColor=null),void 0===n.ceilingTexture&&(n.ceilingTexture=null),void 0===n.ceilingShininess&&(n.ceilingShininess=0),void 0===n.ceilingFlat&&(n.ceilingFlat=!1),void 0===n.level&&(n.level=null),void 0===n.shapeCache&&(n.shapeCache=null),void 0===n.boundsCache&&(n.boundsCache=null),void 0===n.areaCache&&(n.areaCache=null),o.length<=1)throw new IllegalStateException("Room points must containt at least two points");n.points=n.deepCopy(o),n.areaVisible=!0,n.nameYOffset=-40,n.floorVisible=!0,n.ceilingVisible=!0,n.ceilingFlat=!0,void 0===n.name&&(n.name=null),void 0===n.nameXOffset&&(n.nameXOffset=0),void 0===n.nameYOffset&&(n.nameYOffset=0),void 0===n.nameStyle&&(n.nameStyle=null),void 0===n.nameAngle&&(n.nameAngle=0),void 0===n.points&&(n.points=null),void 0===n.areaVisible&&(n.areaVisible=!1),void 0===n.areaXOffset&&(n.areaXOffset=0),void 0===n.areaYOffset&&(n.areaYOffset=0),void 0===n.areaStyle&&(n.areaStyle=null),void 0===n.areaAngle&&(n.areaAngle=0),void 0===n.floorVisible&&(n.floorVisible=!1),void 0===n.floorColor&&(n.floorColor=null),void 0===n.floorTexture&&(n.floorTexture=null),void 0===n.floorShininess&&(n.floorShininess=0),void 0===n.ceilingVisible&&(n.ceilingVisible=!1),void 0===n.ceilingColor&&(n.ceilingColor=null),void 0===n.ceilingTexture&&(n.ceilingTexture=null),void 0===n.ceilingShininess&&(n.ceilingShininess=0),void 0===n.ceilingFlat&&(n.ceilingFlat=!1),void 0===n.level&&(n.level=null),void 0===n.shapeCache&&(n.shapeCache=null),void 0===n.boundsCache&&(n.boundsCache=null),void 0===n.areaCache&&(n.areaCache=null)}else{if(void 0===(n=e.call(this,t)||this).name&&(n.name=null),void 0===n.nameXOffset&&(n.nameXOffset=0),void 0===n.nameYOffset&&(n.nameYOffset=0),void 0===n.nameStyle&&(n.nameStyle=null),void 0===n.nameAngle&&(n.nameAngle=0),void 0===n.points&&(n.points=null),void 0===n.areaVisible&&(n.areaVisible=!1),void 0===n.areaXOffset&&(n.areaXOffset=0),void 0===n.areaYOffset&&(n.areaYOffset=0),void 0===n.areaStyle&&(n.areaStyle=null),void 0===n.areaAngle&&(n.areaAngle=0),void 0===n.floorVisible&&(n.floorVisible=!1),void 0===n.floorColor&&(n.floorColor=null),void 0===n.floorTexture&&(n.floorTexture=null),void 0===n.floorShininess&&(n.floorShininess=0),void 0===n.ceilingVisible&&(n.ceilingVisible=!1),void 0===n.ceilingColor&&(n.ceilingColor=null),void 0===n.ceilingTexture&&(n.ceilingTexture=null),void 0===n.ceilingShininess&&(n.ceilingShininess=0),void 0===n.ceilingFlat&&(n.ceilingFlat=!1),void 0===n.level&&(n.level=null),void 0===n.shapeCache&&(n.shapeCache=null),void 0===n.boundsCache&&(n.boundsCache=null),void 0===n.areaCache&&(n.areaCache=null),i.length<=1)throw new IllegalStateException("Room points must containt at least two points");n.points=n.deepCopy(i),n.areaVisible=!0,n.nameYOffset=-40,n.floorVisible=!0,n.ceilingVisible=!0,n.ceilingFlat=!0}return n}return __extends(t,e),t.TWICE_PI_$LI$=function(){return null==t.TWICE_PI&&(t.TWICE_PI=2*Math.PI),t.TWICE_PI},t.prototype.getName=function(){return this.name},t.prototype.setName=function(e){if(e!==this.name&&(null==e||e!==this.name)){var t=this.name;this.name=e,this.firePropertyChange("NAME",t,e)}},t.prototype.getNameXOffset=function(){return this.nameXOffset},t.prototype.setNameXOffset=function(e){if(e!==this.nameXOffset){var t=this.nameXOffset;this.nameXOffset=e,this.firePropertyChange("NAME_X_OFFSET",t,e)}},t.prototype.getNameYOffset=function(){return this.nameYOffset},t.prototype.setNameYOffset=function(e){if(e!==this.nameYOffset){var t=this.nameYOffset;this.nameYOffset=e,this.firePropertyChange("NAME_Y_OFFSET",t,e)}},t.prototype.getNameStyle=function(){return this.nameStyle},t.prototype.setNameStyle=function(e){if(e!==this.nameStyle){var t=this.nameStyle;this.nameStyle=e,this.firePropertyChange("NAME_STYLE",t,e)}},t.prototype.getNameAngle=function(){return this.nameAngle},t.prototype.setNameAngle=function(e){if((e=(e%t.TWICE_PI_$LI$()+t.TWICE_PI_$LI$())%t.TWICE_PI_$LI$())!==this.nameAngle){var i=this.nameAngle;this.nameAngle=e,this.firePropertyChange("NAME_ANGLE",i,e)}},t.prototype.getPoints=function(){return this.deepCopy(this.points)},t.prototype.getPointCount=function(){return this.points.length},t.prototype.deepCopy=function(e){for(var t=function(e){for(var t=[];e-- >0;)t.push(null);return t}(e.length),i=0;i<e.length;i++)t[i]=e[i].slice(0);return t},t.prototype.setPoints=function(e){JSON.stringify(this.points)!==JSON.stringify(e)&&this.updatePoints(e)},t.prototype.updatePoints=function(e){var t=this.points;this.points=this.deepCopy(e),this.shapeCache=null,this.boundsCache=null,this.areaCache=null,this.firePropertyChange("POINTS",t,e)},t.prototype.addPoint$float$float=function(e,t){this.addPoint$float$float$int(e,t,this.points.length)},t.prototype.addPoint$float$float$int=function(e,t,i){if(i<0||i>this.points.length)throw Object.defineProperty(new Error("Invalid index "+i),"__classes",{configurable:!0,value:["java.lang.Throwable","java.lang.IndexOutOfBoundsException","java.lang.Object","java.lang.RuntimeException","java.lang.Exception"]});var n=function(e){for(var t=[];e-- >0;)t.push(null);return t}(this.points.length+1);!function(e,t,i,n,o){if(e!==i||n>=t+o)for(;--o>=0;)i[n++]=e[t++];else for(var r=e.slice(t,t+o),l=0;l<o;l++)i[n++]=r[l]}(this.points,0,n,0,i),n[i]=[e,t],function(e,t,i,n,o){if(e!==i||n>=t+o)for(;--o>=0;)i[n++]=e[t++];else for(var r=e.slice(t,t+o),l=0;l<o;l++)i[n++]=r[l]}(this.points,i,n,i+1,this.points.length-i);var o=this.points;this.points=n,this.shapeCache=null,this.boundsCache=null,this.areaCache=null,this.firePropertyChange("POINTS",o,this.deepCopy(this.points))},t.prototype.addPoint=function(e,t,i){if("number"!=typeof e&&null!==e||"number"!=typeof t&&null!==t||"number"!=typeof i&&null!==i){if("number"!=typeof e&&null!==e||"number"!=typeof t&&null!==t||void 0!==i)throw new Error("invalid overload");return this.addPoint$float$float(e,t)}return this.addPoint$float$float$int(e,t,i)},t.prototype.setPoint=function(e,t,i){if(i<0||i>=this.points.length)throw Object.defineProperty(new Error("Invalid index "+i),"__classes",{configurable:!0,value:["java.lang.Throwable","java.lang.IndexOutOfBoundsException","java.lang.Object","java.lang.RuntimeException","java.lang.Exception"]});if(this.points[i][0]!==e||this.points[i][1]!==t){var n=this.points;this.points=this.deepCopy(this.points),this.points[i][0]=e,this.points[i][1]=t,this.shapeCache=null,this.boundsCache=null,this.areaCache=null,this.firePropertyChange("POINTS",n,this.deepCopy(this.points))}},t.prototype.removePoint=function(e){if(e<0||e>=this.points.length)throw Object.defineProperty(new Error("Invalid index "+e),"__classes",{configurable:!0,value:["java.lang.Throwable","java.lang.IndexOutOfBoundsException","java.lang.Object","java.lang.RuntimeException","java.lang.Exception"]});if(this.points.length<=1)throw new IllegalStateException("Room points must containt at least one point");var t=function(e){for(var t=[];e-- >0;)t.push(null);return t}(this.points.length-1);!function(e,t,i,n,o){if(e!==i||n>=t+o)for(;--o>=0;)i[n++]=e[t++];else for(var r=e.slice(t,t+o),l=0;l<o;l++)i[n++]=r[l]}(this.points,0,t,0,e),function(e,t,i,n,o){if(e!==i||n>=t+o)for(;--o>=0;)i[n++]=e[t++];else for(var r=e.slice(t,t+o),l=0;l<o;l++)i[n++]=r[l]}(this.points,e+1,t,e,this.points.length-e-1);var i=this.points;this.points=t,this.shapeCache=null,this.boundsCache=null,this.areaCache=null,this.firePropertyChange("POINTS",i,this.deepCopy(this.points))},t.prototype.getBoundsMinimumCoordinates=function(){return null==this.boundsCache&&(this.boundsCache=this.getShape().getBounds2D()),[this.boundsCache.getMinX(),this.boundsCache.getMinY()]},t.prototype.getBoundsMaximumCoordinates=function(){return null==this.boundsCache&&(this.boundsCache=this.getShape().getBounds2D()),[this.boundsCache.getMaxX(),this.boundsCache.getMaxY()]},t.prototype.isAreaVisible=function(){return this.areaVisible},t.prototype.setAreaVisible=function(e){e!==this.areaVisible&&(this.areaVisible=e,this.firePropertyChange("AREA_VISIBLE",!e,e))},t.prototype.getAreaXOffset=function(){return this.areaXOffset},t.prototype.setAreaXOffset=function(e){if(e!==this.areaXOffset){var t=this.areaXOffset;this.areaXOffset=e,this.firePropertyChange("AREA_X_OFFSET",t,e)}},t.prototype.getAreaYOffset=function(){return this.areaYOffset},t.prototype.setAreaYOffset=function(e){if(e!==this.areaYOffset){var t=this.areaYOffset;this.areaYOffset=e,this.firePropertyChange("AREA_Y_OFFSET",t,e)}},t.prototype.getAreaStyle=function(){return this.areaStyle},t.prototype.setAreaStyle=function(e){if(e!==this.areaStyle){var t=this.areaStyle;this.areaStyle=e,this.firePropertyChange("AREA_STYLE",t,e)}},t.prototype.getAreaAngle=function(){return this.areaAngle},t.prototype.setAreaAngle=function(e){if((e=(e%t.TWICE_PI_$LI$()+t.TWICE_PI_$LI$())%t.TWICE_PI_$LI$())!==this.areaAngle){var i=this.areaAngle;this.areaAngle=e,this.firePropertyChange("AREA_ANGLE",i,e)}},t.prototype.getXCenter=function(){for(var e=this.points[0][0],t=this.points[0][0],i=1;i<this.points.length;i++)e=Math.min(e,this.points[i][0]),t=Math.max(t,this.points[i][0]);return(e+t)/2},t.prototype.getYCenter=function(){for(var e=this.points[0][1],t=this.points[0][1],i=1;i<this.points.length;i++)e=Math.min(e,this.points[i][1]),t=Math.max(t,this.points[i][1]);return(e+t)/2},t.prototype.getFloorColor=function(){return this.floorColor},t.prototype.setFloorColor=function(e){if(e!==this.floorColor&&(null==e||e!==this.floorColor)){var t=this.floorColor;this.floorColor=e,this.firePropertyChange("FLOOR_COLOR",t,e)}},t.prototype.getFloorTexture=function(){return this.floorTexture},t.prototype.setFloorTexture=function(e){if(e!==this.floorTexture&&(null==e||!e.equals(this.floorTexture))){var t=this.floorTexture;this.floorTexture=e,this.firePropertyChange("FLOOR_TEXTURE",t,e)}},t.prototype.isFloorVisible=function(){return this.floorVisible},t.prototype.setFloorVisible=function(e){e!==this.floorVisible&&(this.floorVisible=e,this.firePropertyChange("FLOOR_VISIBLE",!e,e))},t.prototype.getFloorShininess=function(){return this.floorShininess},t.prototype.setFloorShininess=function(e){if(e!==this.floorShininess){var t=this.floorShininess;this.floorShininess=e,this.firePropertyChange("FLOOR_SHININESS",t,e)}},t.prototype.getCeilingColor=function(){return this.ceilingColor},t.prototype.setCeilingColor=function(e){if(e!==this.ceilingColor&&(null==e||e!==this.ceilingColor)){var t=this.ceilingColor;this.ceilingColor=e,this.firePropertyChange("CEILING_COLOR",t,e)}},t.prototype.getCeilingTexture=function(){return this.ceilingTexture},t.prototype.setCeilingTexture=function(e){if(e!==this.ceilingTexture&&(null==e||!e.equals(this.ceilingTexture))){var t=this.ceilingTexture;this.ceilingTexture=e,this.firePropertyChange("CEILING_TEXTURE",t,e)}},t.prototype.isCeilingVisible=function(){return this.ceilingVisible},t.prototype.setCeilingVisible=function(e){e!==this.ceilingVisible&&(this.ceilingVisible=e,this.firePropertyChange("CEILING_VISIBLE",!e,e))},t.prototype.getCeilingShininess=function(){return this.ceilingShininess},t.prototype.setCeilingShininess=function(e){if(e!==this.ceilingShininess){var t=this.ceilingShininess;this.ceilingShininess=e,this.firePropertyChange("CEILING_SHININESS",t,e)}},t.prototype.isCeilingFlat=function(){return this.ceilingFlat},t.prototype.setCeilingFlat=function(e){e!==this.ceilingFlat&&(this.ceilingFlat=e,this.firePropertyChange("CEILING_FLAT",!e,e))},t.prototype.getLevel=function(){return this.level},t.prototype.setLevel=function(e){if(e!==this.level){var t=this.level;this.level=e,this.firePropertyChange("LEVEL",t,e)}},t.prototype.isAtLevel=function(e){return this.level===e||null!=this.level&&null!=e&&this.level.getElevation()===e.getElevation()&&this.level.getElevationIndex()<e.getElevationIndex()},t.prototype.getArea=function(){if(null==this.areaCache){var e=new java.awt.geom.Area(this.getShape());if(e.isSingular())this.areaCache=Math.abs(this.getSignedArea(this.getPoints()));else{for(var t=0,i=[],n=e.getPathIterator(null);!n.isDone();){var o=[0,0];switch(n.currentSegment(o)){case java.awt.geom.PathIterator.SEG_MOVETO:case java.awt.geom.PathIterator.SEG_LINETO:i.push(o);break;case java.awt.geom.PathIterator.SEG_CLOSE:var r=i.slice(0);t+=this.getSignedArea(r),i.length=0}n.next()}this.areaCache=t}}return this.areaCache},t.prototype.getSignedArea=function(e){for(var t=0,i=1;i<e.length;i++)t+=e[i][0]*e[i-1][1],t-=e[i][1]*e[i-1][0];return t+=e[0][0]*e[e.length-1][1],(t-=e[0][1]*e[e.length-1][0])/2},t.prototype.isClockwise=function(){return this.getSignedArea(this.getPoints())<0},t.prototype.isSingular=function(){return new java.awt.geom.Area(this.getShape()).isSingular()},t.prototype.intersectsRectangle=function(e,t,i,n){var o=new java.awt.geom.Rectangle2D.Float(e,t,0,0);return o.add(i,n),this.getShape().intersects(o)},t.prototype.containsPoint=function(e,t,i){return this.containsShapeAtWithMargin(this.getShape(),e,t,i)},t.prototype.getPointIndexAt=function(e,t,i){for(var n=0;n<this.points.length;n++)if(Math.abs(e-this.points[n][0])<=i&&Math.abs(t-this.points[n][1])<=i)return n;return-1},t.prototype.isNameCenterPointAt=function(e,t,i){return Math.abs(e-this.getXCenter()-this.getNameXOffset())<=i&&Math.abs(t-this.getYCenter()-this.getNameYOffset())<=i},t.prototype.isAreaCenterPointAt=function(e,t,i){return Math.abs(e-this.getXCenter()-this.getAreaXOffset())<=i&&Math.abs(t-this.getYCenter()-this.getAreaYOffset())<=i},t.prototype.containsShapeAtWithMargin=function(e,t,i,n){return 0===n?e.contains(t,i):e.intersects(t-n,i-n,2*n,2*n)},t.prototype.getShape=function(){if(null==this.shapeCache){var e=new java.awt.geom.GeneralPath;e.moveTo(this.points[0][0],this.points[0][1]);for(var t=1;t<this.points.length;t++)e.lineTo(this.points[t][0],this.points[t][1]);e.closePath(),this.shapeCache=e}return this.shapeCache},t.prototype.move=function(e,t){if(0!==e||0!==t){for(var i=this.getPoints(),n=0;n<i.length;n++)i[n][0]+=e,i[n][1]+=t;this.updatePoints(i)}},t.prototype.clone=function(){var t=this,i=function(i){if(null!=e.prototype.clone)return e.prototype.clone.call(t);var n=Object.create(i);for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o]);return n}(this);return i.level=null,i},t}(HomeObject);Room.__class="com.eteks.sweethome3d.model.Room",Room.__interfaces=["com.eteks.sweethome3d.model.Selectable","com.eteks.sweethome3d.model.Elevatable"],Room.__transients=["shapeCache","boundsCache","areaCache","propertyChangeSupport"];var Label=function(e){function t(t,i,n,o){var r=this;if("string"!=typeof t&&null!==t||"string"!=typeof i&&null!==i||"number"!=typeof n&&null!==n||"number"!=typeof o&&null!==o){if("string"!=typeof t&&null!==t||"number"!=typeof i&&null!==i||"number"!=typeof n&&null!==n||void 0!==o)throw new Error("invalid overload");var l=(u=arguments)[0],a=u[1],s=u[2],h=HomeObject.createId("label");void 0===(r=e.call(this,h)||this).text&&(r.text=null),void 0===r.x&&(r.x=0),void 0===r.y&&(r.y=0),void 0===r.style&&(r.style=null),void 0===r.color&&(r.color=null),void 0===r.outlineColor&&(r.outlineColor=null),void 0===r.angle&&(r.angle=0),void 0===r.pitch&&(r.pitch=null),void 0===r.elevation&&(r.elevation=0),void 0===r.level&&(r.level=null),r.text=l,r.x=a,r.y=s,void 0===r.text&&(r.text=null),void 0===r.x&&(r.x=0),void 0===r.y&&(r.y=0),void 0===r.style&&(r.style=null),void 0===r.color&&(r.color=null),void 0===r.outlineColor&&(r.outlineColor=null),void 0===r.angle&&(r.angle=0),void 0===r.pitch&&(r.pitch=null),void 0===r.elevation&&(r.elevation=0),void 0===r.level&&(r.level=null)}else{var u=arguments;void 0===(r=e.call(this,t)||this).text&&(r.text=null),void 0===r.x&&(r.x=0),void 0===r.y&&(r.y=0),void 0===r.style&&(r.style=null),void 0===r.color&&(r.color=null),void 0===r.outlineColor&&(r.outlineColor=null),void 0===r.angle&&(r.angle=0),void 0===r.pitch&&(r.pitch=null),void 0===r.elevation&&(r.elevation=0),void 0===r.level&&(r.level=null),r.text=i,r.x=n,r.y=o}return r}return __extends(t,e),t.TWICE_PI_$LI$=function(){return null==t.TWICE_PI&&(t.TWICE_PI=2*Math.PI),t.TWICE_PI},t.prototype.getText=function(){return this.text},t.prototype.setText=function(e){if(e!==this.text&&(null==e||e!==this.text)){var t=this.text;this.text=e,this.firePropertyChange("TEXT",t,e)}},t.prototype.getX=function(){return this.x},t.prototype.setX=function(e){if(e!==this.x){var t=this.x;this.x=e,this.firePropertyChange("X",t,e)}},t.prototype.getY=function(){return this.y},t.prototype.setY=function(e){if(e!==this.y){var t=this.y;this.y=e,this.firePropertyChange("Y",t,e)}},t.prototype.getGroundElevation=function(){return null!=this.level?this.elevation+this.level.getElevation():this.elevation},t.prototype.getElevation=function(){return this.elevation},t.prototype.setElevation=function(e){if(e!==this.elevation){var t=this.elevation;this.elevation=e,this.firePropertyChange("ELEVATION",t,e)}},t.prototype.getStyle=function(){return this.style},t.prototype.setStyle=function(e){if(e!==this.style){var t=this.style;this.style=e,this.firePropertyChange("STYLE",t,e)}},t.prototype.getColor=function(){return this.color},t.prototype.setColor=function(e){if(e!==this.color){var t=this.color;this.color=e,this.firePropertyChange("COLOR",t,e)}},t.prototype.getOutlineColor=function(){return this.outlineColor},t.prototype.setOutlineColor=function(e){if(e!==this.outlineColor){var t=this.outlineColor;this.outlineColor=e,this.firePropertyChange("OUTLINE_COLOR",t,e)}},t.prototype.getAngle=function(){return this.angle},t.prototype.setAngle=function(e){if((e=(e%t.TWICE_PI_$LI$()+t.TWICE_PI_$LI$())%t.TWICE_PI_$LI$())!==this.angle){var i=this.angle;this.angle=e,this.firePropertyChange("ANGLE",i,e)}},t.prototype.getPitch=function(){return this.pitch},t.prototype.setPitch=function(e){if(null!=e&&(e=(e%t.TWICE_PI_$LI$()+t.TWICE_PI_$LI$())%t.TWICE_PI_$LI$()),e!==this.pitch&&(null==e||e!==this.pitch)){var i=this.pitch;this.pitch=e,this.firePropertyChange("PITCH",i,e)}},t.prototype.getLevel=function(){return this.level},t.prototype.setLevel=function(e){if(e!==this.level){var t=this.level;this.level=e,this.firePropertyChange("LEVEL",t,e)}},t.prototype.isAtLevel=function(e){if(this.level===e)return!0;if(null!=this.level&&null!=e){var t=this.level.getElevation(),i=e.getElevation();return t===i&&this.level.getElevationIndex()<e.getElevationIndex()||t<i&&t+this.elevation>i}return!1},t.prototype.getPoints=function(){return[[this.x,this.y]]},t.prototype.intersectsRectangle=function(e,t,i,n){var o=new java.awt.geom.Rectangle2D.Float(e,t,0,0);return o.add(i,n),o.contains(this.x,this.y)},t.prototype.containsPoint=function(e,t,i){return Math.abs(e-this.x)<=i&&Math.abs(t-this.y)<=i},t.prototype.move=function(e,t){this.setX(this.getX()+e),this.setY(this.getY()+t)},t.prototype.clone=function(){var t=this,i=function(i){if(null!=e.prototype.clone)return e.prototype.clone.call(t);var n=Object.create(i);for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o]);return n}(this);return i.level=null,i},t}(HomeObject);Label.__class="com.eteks.sweethome3d.model.Label",Label.__interfaces=["com.eteks.sweethome3d.model.Selectable","com.eteks.sweethome3d.model.Elevatable"],Label.__transients=["propertyChangeSupport"];var HomeEnvironment=function(e){function t(i,n,o,r,l,a,s){var h=this;if("string"!=typeof i&&null!==i||"number"!=typeof n&&null!==n||!(null!=o&&o instanceof HomeTexture||null===o)||"number"!=typeof r&&null!==r||!(null!=l&&l instanceof HomeTexture||null===l)||"number"!=typeof a&&null!==a||"number"!=typeof s&&null!==s)if("number"!=typeof i&&null!==i||!(null!=n&&n instanceof HomeTexture||null===n)||"number"!=typeof o&&null!==o||!(null!=r&&r instanceof HomeTexture||null===r)||"number"!=typeof l&&null!==l||"number"!=typeof a&&null!==a||void 0!==s)if("number"!=typeof i&&null!==i||!(null!=n&&n instanceof HomeTexture||null===n)||"number"!=typeof o&&null!==o||"number"!=typeof r&&null!==r||"number"!=typeof l&&null!==l||void 0!==a||void 0!==s)if("string"!=typeof i&&null!==i||void 0!==n||void 0!==o||void 0!==r||void 0!==l||void 0!==a||void 0!==s){if(void 0!==i||void 0!==n||void 0!==o||void 0!==r||void 0!==l||void 0!==a||void 0!==s)throw new Error("invalid overload");w=arguments;var u=HomeObject.createId("environment");void 0===(h=e.call(this,u)||this).observerCameraElevationAdjusted&&(h.observerCameraElevationAdjusted=!1),void 0===h.groundColor&&(h.groundColor=0),void 0===h.groundTexture&&(h.groundTexture=null),void 0===h.backgroundImageVisibleOnGround3D&&(h.backgroundImageVisibleOnGround3D=!1),void 0===h.skyColor&&(h.skyColor=0),void 0===h.skyTexture&&(h.skyTexture=null),void 0===h.lightColor&&(h.lightColor=0),void 0===h.ceilingLightColor&&(h.ceilingLightColor=0),void 0===h.wallsAlpha&&(h.wallsAlpha=0),void 0===h.drawingMode&&(h.drawingMode=null),void 0===h.subpartSizeUnderLight&&(h.subpartSizeUnderLight=0),void 0===h.allLevelsVisible&&(h.allLevelsVisible=!1),void 0===h.photoWidth&&(h.photoWidth=0),void 0===h.photoHeight&&(h.photoHeight=0),void 0===h.photoAspectRatio&&(h.photoAspectRatio=null),void 0===h.photoAspectRatioName&&(h.photoAspectRatioName=null),void 0===h.photoQuality&&(h.photoQuality=0),void 0===h.videoWidth&&(h.videoWidth=0),void 0===h.videoAspectRatio&&(h.videoAspectRatio=null),void 0===h.videoAspectRatioName&&(h.videoAspectRatioName=null),void 0===h.videoQuality&&(h.videoQuality=0),void 0===h.videoSpeed&&(h.videoSpeed=0),void 0===h.videoFrameRate&&(h.videoFrameRate=0),void 0===h.cameraPath&&(h.cameraPath=null),h.observerCameraElevationAdjusted=!0,h.groundColor=11053224,h.groundTexture=null,h.skyColor=13427964,h.skyTexture=null,h.lightColor=13684944,h.ceilingLightColor=13684944,h.wallsAlpha=0,h.drawingMode=t.DrawingMode.FILL,h.photoWidth=400,h.photoHeight=300,h.photoAspectRatio=AspectRatio.VIEW_3D_RATIO,h.videoWidth=320,h.videoAspectRatio=AspectRatio.RATIO_4_3,h.videoSpeed=2400/3600,h.videoFrameRate=25,h.cameraPath=[],void 0===h.observerCameraElevationAdjusted&&(h.observerCameraElevationAdjusted=!1),void 0===h.groundColor&&(h.groundColor=0),void 0===h.groundTexture&&(h.groundTexture=null),void 0===h.backgroundImageVisibleOnGround3D&&(h.backgroundImageVisibleOnGround3D=!1),void 0===h.skyColor&&(h.skyColor=0),void 0===h.skyTexture&&(h.skyTexture=null),void 0===h.lightColor&&(h.lightColor=0),void 0===h.ceilingLightColor&&(h.ceilingLightColor=0),void 0===h.wallsAlpha&&(h.wallsAlpha=0),void 0===h.drawingMode&&(h.drawingMode=null),void 0===h.subpartSizeUnderLight&&(h.subpartSizeUnderLight=0),void 0===h.allLevelsVisible&&(h.allLevelsVisible=!1),void 0===h.photoWidth&&(h.photoWidth=0),void 0===h.photoHeight&&(h.photoHeight=0),void 0===h.photoAspectRatio&&(h.photoAspectRatio=null),void 0===h.photoAspectRatioName&&(h.photoAspectRatioName=null),void 0===h.photoQuality&&(h.photoQuality=0),void 0===h.videoWidth&&(h.videoWidth=0),void 0===h.videoAspectRatio&&(h.videoAspectRatio=null),void 0===h.videoAspectRatioName&&(h.videoAspectRatioName=null),void 0===h.videoQuality&&(h.videoQuality=0),void 0===h.videoSpeed&&(h.videoSpeed=0),void 0===h.videoFrameRate&&(h.videoFrameRate=0),void 0===h.cameraPath&&(h.cameraPath=null),void 0===h.observerCameraElevationAdjusted&&(h.observerCameraElevationAdjusted=!1),void 0===h.groundColor&&(h.groundColor=0),void 0===h.groundTexture&&(h.groundTexture=null),void 0===h.backgroundImageVisibleOnGround3D&&(h.backgroundImageVisibleOnGround3D=!1),void 0===h.skyColor&&(h.skyColor=0),void 0===h.skyTexture&&(h.skyTexture=null),void 0===h.lightColor&&(h.lightColor=0),void 0===h.ceilingLightColor&&(h.ceilingLightColor=0),void 0===h.wallsAlpha&&(h.wallsAlpha=0),void 0===h.drawingMode&&(h.drawingMode=null),void 0===h.subpartSizeUnderLight&&(h.subpartSizeUnderLight=0),void 0===h.allLevelsVisible&&(h.allLevelsVisible=!1),void 0===h.photoWidth&&(h.photoWidth=0),void 0===h.photoHeight&&(h.photoHeight=0),void 0===h.photoAspectRatio&&(h.photoAspectRatio=null),void 0===h.photoAspectRatioName&&(h.photoAspectRatioName=null),void 0===h.photoQuality&&(h.photoQuality=0),void 0===h.videoWidth&&(h.videoWidth=0),void 0===h.videoAspectRatio&&(h.videoAspectRatio=null),void 0===h.videoAspectRatioName&&(h.videoAspectRatioName=null),void 0===h.videoQuality&&(h.videoQuality=0),void 0===h.videoSpeed&&(h.videoSpeed=0),void 0===h.videoFrameRate&&(h.videoFrameRate=0),void 0===h.cameraPath&&(h.cameraPath=null)}else{w=arguments;void 0===(h=e.call(this,i)||this).observerCameraElevationAdjusted&&(h.observerCameraElevationAdjusted=!1),void 0===h.groundColor&&(h.groundColor=0),void 0===h.groundTexture&&(h.groundTexture=null),void 0===h.backgroundImageVisibleOnGround3D&&(h.backgroundImageVisibleOnGround3D=!1),void 0===h.skyColor&&(h.skyColor=0),void 0===h.skyTexture&&(h.skyTexture=null),void 0===h.lightColor&&(h.lightColor=0),void 0===h.ceilingLightColor&&(h.ceilingLightColor=0),void 0===h.wallsAlpha&&(h.wallsAlpha=0),void 0===h.drawingMode&&(h.drawingMode=null),void 0===h.subpartSizeUnderLight&&(h.subpartSizeUnderLight=0),void 0===h.allLevelsVisible&&(h.allLevelsVisible=!1),void 0===h.photoWidth&&(h.photoWidth=0),void 0===h.photoHeight&&(h.photoHeight=0),void 0===h.photoAspectRatio&&(h.photoAspectRatio=null),void 0===h.photoAspectRatioName&&(h.photoAspectRatioName=null),void 0===h.photoQuality&&(h.photoQuality=0),void 0===h.videoWidth&&(h.videoWidth=0),void 0===h.videoAspectRatio&&(h.videoAspectRatio=null),void 0===h.videoAspectRatioName&&(h.videoAspectRatioName=null),void 0===h.videoQuality&&(h.videoQuality=0),void 0===h.videoSpeed&&(h.videoSpeed=0),void 0===h.videoFrameRate&&(h.videoFrameRate=0),void 0===h.cameraPath&&(h.cameraPath=null),h.observerCameraElevationAdjusted=!0,h.groundColor=11053224,h.groundTexture=null,h.skyColor=13427964,h.skyTexture=null,h.lightColor=13684944,h.ceilingLightColor=13684944,h.wallsAlpha=0,h.drawingMode=t.DrawingMode.FILL,h.photoWidth=400,h.photoHeight=300,h.photoAspectRatio=AspectRatio.VIEW_3D_RATIO,h.videoWidth=320,h.videoAspectRatio=AspectRatio.RATIO_4_3,h.videoSpeed=2400/3600,h.videoFrameRate=25,h.cameraPath=[],void 0===h.observerCameraElevationAdjusted&&(h.observerCameraElevationAdjusted=!1),void 0===h.groundColor&&(h.groundColor=0),void 0===h.groundTexture&&(h.groundTexture=null),void 0===h.backgroundImageVisibleOnGround3D&&(h.backgroundImageVisibleOnGround3D=!1),void 0===h.skyColor&&(h.skyColor=0),void 0===h.skyTexture&&(h.skyTexture=null),void 0===h.lightColor&&(h.lightColor=0),void 0===h.ceilingLightColor&&(h.ceilingLightColor=0),void 0===h.wallsAlpha&&(h.wallsAlpha=0),void 0===h.drawingMode&&(h.drawingMode=null),void 0===h.subpartSizeUnderLight&&(h.subpartSizeUnderLight=0),void 0===h.allLevelsVisible&&(h.allLevelsVisible=!1),void 0===h.photoWidth&&(h.photoWidth=0),void 0===h.photoHeight&&(h.photoHeight=0),void 0===h.photoAspectRatio&&(h.photoAspectRatio=null),void 0===h.photoAspectRatioName&&(h.photoAspectRatioName=null),void 0===h.photoQuality&&(h.photoQuality=0),void 0===h.videoWidth&&(h.videoWidth=0),void 0===h.videoAspectRatio&&(h.videoAspectRatio=null),void 0===h.videoAspectRatioName&&(h.videoAspectRatioName=null),void 0===h.videoQuality&&(h.videoQuality=0),void 0===h.videoSpeed&&(h.videoSpeed=0),void 0===h.videoFrameRate&&(h.videoFrameRate=0),void 0===h.cameraPath&&(h.cameraPath=null)}else{var d=(w=arguments)[0],c=w[1],p=w[2],g=w[3],m=w[4],f=HomeObject.createId("environment");void 0===(h=e.call(this,f)||this).observerCameraElevationAdjusted&&(h.observerCameraElevationAdjusted=!1),void 0===h.groundColor&&(h.groundColor=0),void 0===h.groundTexture&&(h.groundTexture=null),void 0===h.backgroundImageVisibleOnGround3D&&(h.backgroundImageVisibleOnGround3D=!1),void 0===h.skyColor&&(h.skyColor=0),void 0===h.skyTexture&&(h.skyTexture=null),void 0===h.lightColor&&(h.lightColor=0),void 0===h.ceilingLightColor&&(h.ceilingLightColor=0),void 0===h.wallsAlpha&&(h.wallsAlpha=0),void 0===h.drawingMode&&(h.drawingMode=null),void 0===h.subpartSizeUnderLight&&(h.subpartSizeUnderLight=0),void 0===h.allLevelsVisible&&(h.allLevelsVisible=!1),void 0===h.photoWidth&&(h.photoWidth=0),void 0===h.photoHeight&&(h.photoHeight=0),void 0===h.photoAspectRatio&&(h.photoAspectRatio=null),void 0===h.photoAspectRatioName&&(h.photoAspectRatioName=null),void 0===h.photoQuality&&(h.photoQuality=0),void 0===h.videoWidth&&(h.videoWidth=0),void 0===h.videoAspectRatio&&(h.videoAspectRatio=null),void 0===h.videoAspectRatioName&&(h.videoAspectRatioName=null),void 0===h.videoQuality&&(h.videoQuality=0),void 0===h.videoSpeed&&(h.videoSpeed=0),void 0===h.videoFrameRate&&(h.videoFrameRate=0),void 0===h.cameraPath&&(h.cameraPath=null),h.observerCameraElevationAdjusted=!0,h.groundColor=d,h.groundTexture=c,h.skyColor=p,h.skyTexture=null,h.lightColor=g,h.ceilingLightColor=13684944,h.wallsAlpha=m,h.drawingMode=t.DrawingMode.FILL,h.photoWidth=400,h.photoHeight=300,h.photoAspectRatio=AspectRatio.VIEW_3D_RATIO,h.videoWidth=320,h.videoAspectRatio=AspectRatio.RATIO_4_3,h.videoSpeed=2400/3600,h.videoFrameRate=25,h.cameraPath=[],void 0===h.observerCameraElevationAdjusted&&(h.observerCameraElevationAdjusted=!1),void 0===h.groundColor&&(h.groundColor=0),void 0===h.groundTexture&&(h.groundTexture=null),void 0===h.backgroundImageVisibleOnGround3D&&(h.backgroundImageVisibleOnGround3D=!1),void 0===h.skyColor&&(h.skyColor=0),void 0===h.skyTexture&&(h.skyTexture=null),void 0===h.lightColor&&(h.lightColor=0),void 0===h.ceilingLightColor&&(h.ceilingLightColor=0),void 0===h.wallsAlpha&&(h.wallsAlpha=0),void 0===h.drawingMode&&(h.drawingMode=null),void 0===h.subpartSizeUnderLight&&(h.subpartSizeUnderLight=0),void 0===h.allLevelsVisible&&(h.allLevelsVisible=!1),void 0===h.photoWidth&&(h.photoWidth=0),void 0===h.photoHeight&&(h.photoHeight=0),void 0===h.photoAspectRatio&&(h.photoAspectRatio=null),void 0===h.photoAspectRatioName&&(h.photoAspectRatioName=null),void 0===h.photoQuality&&(h.photoQuality=0),void 0===h.videoWidth&&(h.videoWidth=0),void 0===h.videoAspectRatio&&(h.videoAspectRatio=null),void 0===h.videoAspectRatioName&&(h.videoAspectRatioName=null),void 0===h.videoQuality&&(h.videoQuality=0),void 0===h.videoSpeed&&(h.videoSpeed=0),void 0===h.videoFrameRate&&(h.videoFrameRate=0),void 0===h.cameraPath&&(h.cameraPath=null),void 0===h.observerCameraElevationAdjusted&&(h.observerCameraElevationAdjusted=!1),void 0===h.groundColor&&(h.groundColor=0),void 0===h.groundTexture&&(h.groundTexture=null),void 0===h.backgroundImageVisibleOnGround3D&&(h.backgroundImageVisibleOnGround3D=!1),void 0===h.skyColor&&(h.skyColor=0),void 0===h.skyTexture&&(h.skyTexture=null),void 0===h.lightColor&&(h.lightColor=0),void 0===h.ceilingLightColor&&(h.ceilingLightColor=0),void 0===h.wallsAlpha&&(h.wallsAlpha=0),void 0===h.drawingMode&&(h.drawingMode=null),void 0===h.subpartSizeUnderLight&&(h.subpartSizeUnderLight=0),void 0===h.allLevelsVisible&&(h.allLevelsVisible=!1),void 0===h.photoWidth&&(h.photoWidth=0),void 0===h.photoHeight&&(h.photoHeight=0),void 0===h.photoAspectRatio&&(h.photoAspectRatio=null),void 0===h.photoAspectRatioName&&(h.photoAspectRatioName=null),void 0===h.photoQuality&&(h.photoQuality=0),void 0===h.videoWidth&&(h.videoWidth=0),void 0===h.videoAspectRatio&&(h.videoAspectRatio=null),void 0===h.videoAspectRatioName&&(h.videoAspectRatioName=null),void 0===h.videoQuality&&(h.videoQuality=0),void 0===h.videoSpeed&&(h.videoSpeed=0),void 0===h.videoFrameRate&&(h.videoFrameRate=0),void 0===h.cameraPath&&(h.cameraPath=null)}else{var v=(w=arguments)[0],_=w[1],S=w[2],y=w[3],E=w[4],C=w[5],P=HomeObject.createId("environment");void 0===(h=e.call(this,P)||this).observerCameraElevationAdjusted&&(h.observerCameraElevationAdjusted=!1),void 0===h.groundColor&&(h.groundColor=0),void 0===h.groundTexture&&(h.groundTexture=null),void 0===h.backgroundImageVisibleOnGround3D&&(h.backgroundImageVisibleOnGround3D=!1),void 0===h.skyColor&&(h.skyColor=0),void 0===h.skyTexture&&(h.skyTexture=null),void 0===h.lightColor&&(h.lightColor=0),void 0===h.ceilingLightColor&&(h.ceilingLightColor=0),void 0===h.wallsAlpha&&(h.wallsAlpha=0),void 0===h.drawingMode&&(h.drawingMode=null),void 0===h.subpartSizeUnderLight&&(h.subpartSizeUnderLight=0),void 0===h.allLevelsVisible&&(h.allLevelsVisible=!1),void 0===h.photoWidth&&(h.photoWidth=0),void 0===h.photoHeight&&(h.photoHeight=0),void 0===h.photoAspectRatio&&(h.photoAspectRatio=null),void 0===h.photoAspectRatioName&&(h.photoAspectRatioName=null),void 0===h.photoQuality&&(h.photoQuality=0),void 0===h.videoWidth&&(h.videoWidth=0),void 0===h.videoAspectRatio&&(h.videoAspectRatio=null),void 0===h.videoAspectRatioName&&(h.videoAspectRatioName=null),void 0===h.videoQuality&&(h.videoQuality=0),void 0===h.videoSpeed&&(h.videoSpeed=0),void 0===h.videoFrameRate&&(h.videoFrameRate=0),void 0===h.cameraPath&&(h.cameraPath=null),h.observerCameraElevationAdjusted=!0,h.groundColor=v,h.groundTexture=_,h.skyColor=S,h.skyTexture=y,h.lightColor=E,h.ceilingLightColor=13684944,h.wallsAlpha=C,h.drawingMode=t.DrawingMode.FILL,h.photoWidth=400,h.photoHeight=300,h.photoAspectRatio=AspectRatio.VIEW_3D_RATIO,h.videoWidth=320,h.videoAspectRatio=AspectRatio.RATIO_4_3,h.videoSpeed=2400/3600,h.videoFrameRate=25,h.cameraPath=[],void 0===h.observerCameraElevationAdjusted&&(h.observerCameraElevationAdjusted=!1),void 0===h.groundColor&&(h.groundColor=0),void 0===h.groundTexture&&(h.groundTexture=null),void 0===h.backgroundImageVisibleOnGround3D&&(h.backgroundImageVisibleOnGround3D=!1),void 0===h.skyColor&&(h.skyColor=0),void 0===h.skyTexture&&(h.skyTexture=null),void 0===h.lightColor&&(h.lightColor=0),void 0===h.ceilingLightColor&&(h.ceilingLightColor=0),void 0===h.wallsAlpha&&(h.wallsAlpha=0),void 0===h.drawingMode&&(h.drawingMode=null),void 0===h.subpartSizeUnderLight&&(h.subpartSizeUnderLight=0),void 0===h.allLevelsVisible&&(h.allLevelsVisible=!1),void 0===h.photoWidth&&(h.photoWidth=0),void 0===h.photoHeight&&(h.photoHeight=0),void 0===h.photoAspectRatio&&(h.photoAspectRatio=null),void 0===h.photoAspectRatioName&&(h.photoAspectRatioName=null),void 0===h.photoQuality&&(h.photoQuality=0),void 0===h.videoWidth&&(h.videoWidth=0),void 0===h.videoAspectRatio&&(h.videoAspectRatio=null),void 0===h.videoAspectRatioName&&(h.videoAspectRatioName=null),void 0===h.videoQuality&&(h.videoQuality=0),void 0===h.videoSpeed&&(h.videoSpeed=0),void 0===h.videoFrameRate&&(h.videoFrameRate=0),void 0===h.cameraPath&&(h.cameraPath=null)}else{var w=arguments;void 0===(h=e.call(this,i)||this).observerCameraElevationAdjusted&&(h.observerCameraElevationAdjusted=!1),void 0===h.groundColor&&(h.groundColor=0),void 0===h.groundTexture&&(h.groundTexture=null),void 0===h.backgroundImageVisibleOnGround3D&&(h.backgroundImageVisibleOnGround3D=!1),void 0===h.skyColor&&(h.skyColor=0),void 0===h.skyTexture&&(h.skyTexture=null),void 0===h.lightColor&&(h.lightColor=0),void 0===h.ceilingLightColor&&(h.ceilingLightColor=0),void 0===h.wallsAlpha&&(h.wallsAlpha=0),void 0===h.drawingMode&&(h.drawingMode=null),void 0===h.subpartSizeUnderLight&&(h.subpartSizeUnderLight=0),void 0===h.allLevelsVisible&&(h.allLevelsVisible=!1),void 0===h.photoWidth&&(h.photoWidth=0),void 0===h.photoHeight&&(h.photoHeight=0),void 0===h.photoAspectRatio&&(h.photoAspectRatio=null),void 0===h.photoAspectRatioName&&(h.photoAspectRatioName=null),void 0===h.photoQuality&&(h.photoQuality=0),void 0===h.videoWidth&&(h.videoWidth=0),void 0===h.videoAspectRatio&&(h.videoAspectRatio=null),void 0===h.videoAspectRatioName&&(h.videoAspectRatioName=null),void 0===h.videoQuality&&(h.videoQuality=0),void 0===h.videoSpeed&&(h.videoSpeed=0),void 0===h.videoFrameRate&&(h.videoFrameRate=0),void 0===h.cameraPath&&(h.cameraPath=null),h.observerCameraElevationAdjusted=!0,h.groundColor=n,h.groundTexture=o,h.skyColor=r,h.skyTexture=l,h.lightColor=a,h.ceilingLightColor=13684944,h.wallsAlpha=s,h.drawingMode=t.DrawingMode.FILL,h.photoWidth=400,h.photoHeight=300,h.photoAspectRatio=AspectRatio.VIEW_3D_RATIO,h.videoWidth=320,h.videoAspectRatio=AspectRatio.RATIO_4_3,h.videoSpeed=2400/3600,h.videoFrameRate=25,h.cameraPath=[]}return h}return __extends(t,e),t.prototype.isObserverCameraElevationAdjusted=function(){return this.observerCameraElevationAdjusted},t.prototype.setObserverCameraElevationAdjusted=function(e){this.observerCameraElevationAdjusted!==e&&(this.observerCameraElevationAdjusted=e,this.firePropertyChange("OBSERVER_CAMERA_ELEVATION_ADJUSTED",!e,e))},t.prototype.getGroundColor=function(){return this.groundColor},t.prototype.setGroundColor=function(e){if(e!==this.groundColor){var t=this.groundColor;this.groundColor=e,this.firePropertyChange("GROUND_COLOR",t,e)}},t.prototype.getGroundTexture=function(){return this.groundTexture},t.prototype.setGroundTexture=function(e){if(e!==this.groundTexture){var t=this.groundTexture;this.groundTexture=e,this.firePropertyChange("GROUND_TEXTURE",t,e)}},t.prototype.isBackgroundImageVisibleOnGround3D=function(){return this.backgroundImageVisibleOnGround3D},t.prototype.setBackgroundImageVisibleOnGround3D=function(e){this.backgroundImageVisibleOnGround3D!==e&&(this.backgroundImageVisibleOnGround3D=e,this.firePropertyChange("BACKGROUND_IMAGE_VISIBLE_ON_GROUND_3D",!e,e))},t.prototype.getSkyColor=function(){return this.skyColor},t.prototype.setSkyColor=function(e){if(e!==this.skyColor){var t=this.skyColor;this.skyColor=e,this.firePropertyChange("SKY_COLOR",t,e)}},t.prototype.getSkyTexture=function(){return this.skyTexture},t.prototype.setSkyTexture=function(e){if(e!==this.skyTexture){var t=this.skyTexture;this.skyTexture=e,this.firePropertyChange("SKY_TEXTURE",t,e)}},t.prototype.getLightColor=function(){return this.lightColor},t.prototype.setLightColor=function(e){if(e!==this.lightColor){var t=this.lightColor;this.lightColor=e,this.firePropertyChange("LIGHT_COLOR",t,e)}},t.prototype.getCeillingLightColor=function(){return this.ceilingLightColor},t.prototype.setCeillingLightColor=function(e){if(e!==this.ceilingLightColor){var t=this.ceilingLightColor;this.ceilingLightColor=e,this.firePropertyChange("CEILING_LIGHT_COLOR",t,e)}},t.prototype.getWallsAlpha=function(){return this.wallsAlpha},t.prototype.setWallsAlpha=function(e){if(e!==this.wallsAlpha){var t=this.wallsAlpha;this.wallsAlpha=e,this.firePropertyChange("WALLS_ALPHA",t,e)}},t.prototype.getDrawingMode=function(){return this.drawingMode},t.prototype.setDrawingMode=function(e){if(e!==this.drawingMode){var t=this.drawingMode;this.drawingMode=e,this.firePropertyChange("DRAWING_MODE",t,e)}},t.prototype.getSubpartSizeUnderLight=function(){return this.subpartSizeUnderLight},t.prototype.setSubpartSizeUnderLight=function(e){if(e!==this.subpartSizeUnderLight){var t=this.subpartSizeUnderLight;this.subpartSizeUnderLight=e,this.firePropertyChange("SUBPART_SIZE_UNDER_LIGHT",t,e)}},t.prototype.isAllLevelsVisible=function(){return this.allLevelsVisible},t.prototype.setAllLevelsVisible=function(e){e!==this.allLevelsVisible&&(this.allLevelsVisible=e,this.firePropertyChange("ALL_LEVELS_VISIBLE",!e,e))},t.prototype.getPhotoWidth=function(){return this.photoWidth},t.prototype.setPhotoWidth=function(e){if(this.photoWidth!==e){var t=this.photoWidth;this.photoWidth=e,this.firePropertyChange("PHOTO_WIDTH",t,e)}},t.prototype.getPhotoHeight=function(){return this.photoHeight},t.prototype.setPhotoHeight=function(e){if(this.photoHeight!==e){var t=this.photoHeight;this.photoHeight=e,this.firePropertyChange("PHOTO_HEIGHT",t,e)}},t.prototype.getPhotoAspectRatio=function(){return this.photoAspectRatio},t.prototype.setPhotoAspectRatio=function(e){if(this.photoAspectRatio!==e){var t=this.photoAspectRatio;this.photoAspectRatio=e,this.photoAspectRatioName=AspectRatio[this.photoAspectRatio],this.firePropertyChange("PHOTO_ASPECT_RATIO",t,e)}},t.prototype.getPhotoQuality=function(){return this.photoQuality},t.prototype.setPhotoQuality=function(e){if(this.photoQuality!==e){var t=this.photoQuality;this.photoQuality=e,this.firePropertyChange("PHOTO_QUALITY",t,e)}},t.prototype.getVideoWidth=function(){return this.videoWidth},t.prototype.setVideoWidth=function(e){if(this.videoWidth!==e){var t=this.videoWidth;this.videoWidth=e,this.firePropertyChange("VIDEO_WIDTH",t,e)}},t.prototype.getVideoHeight=function(){return Math.round(this.getVideoWidth()/{FREE_RATIO:null,VIEW_3D_RATIO:null,RATIO_4_3:4/3,RATIO_3_2:1.5,RATIO_16_9:16/9,RATIO_2_1:2,SQUARE_RATIO:1}[this.getVideoAspectRatio()])},t.prototype.getVideoAspectRatio=function(){return this.videoAspectRatio},t.prototype.setVideoAspectRatio=function(e){if(this.videoAspectRatio!==e){if(null=={FREE_RATIO:null,VIEW_3D_RATIO:null,RATIO_4_3:4/3,RATIO_3_2:1.5,RATIO_16_9:16/9,RATIO_2_1:2,SQUARE_RATIO:1}[e])throw new IllegalArgumentException("Unsupported aspect ratio "+e);var t=this.videoAspectRatio;this.videoAspectRatio=e,this.videoAspectRatioName=AspectRatio[this.videoAspectRatio],this.firePropertyChange("VIDEO_ASPECT_RATIO",t,e)}},t.prototype.getVideoQuality=function(){return this.videoQuality},t.prototype.setVideoQuality=function(e){if(this.videoQuality!==e){var t=this.videoQuality;this.videoQuality=e,this.firePropertyChange("VIDEO_QUALITY",t,e)}},t.prototype.getVideoSpeed=function(){return this.videoSpeed},t.prototype.setVideoSpeed=function(e){if(this.videoSpeed!==e){var t=this.videoSpeed;this.videoSpeed=e,this.firePropertyChange("VIDEO_SPEED",t,e)}},t.prototype.getVideoFrameRate=function(){return this.videoFrameRate},t.prototype.setVideoFrameRate=function(e){if(this.videoFrameRate!==e){var t=this.videoFrameRate;this.videoFrameRate=e,this.firePropertyChange("VIDEO_FRAME_RATE",t,e)}},t.prototype.getVideoCameraPath=function(){return this.cameraPath.slice(0)},t.prototype.setVideoCameraPath=function(e){if(this.cameraPath!==e){var t=this.cameraPath;this.cameraPath=null!=e?e.slice(0):[],this.firePropertyChange("VIDEO_CAMERA_PATH",t,e)}},t.prototype.clone=function(){var t=this,i=function(i){if(null!=e.prototype.clone)return e.prototype.clone.call(t);var n=Object.create(i);for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o]);return n}(this);i.cameraPath=[];for(var n=0;n<this.cameraPath.length;n++){var o=this.cameraPath[n];i.cameraPath.push(function(e){if(null!=e.clone)return e.clone();var t=Object.create(e);for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t}(o))}return i},t}(HomeObject);HomeEnvironment.__class="com.eteks.sweethome3d.model.HomeEnvironment",function(e){var t;(t=e.DrawingMode||(e.DrawingMode={}))[t.FILL=0]="FILL",t[t.OUTLINE=1]="OUTLINE",t[t.FILL_AND_OUTLINE=2]="FILL_AND_OUTLINE"}(HomeEnvironment||(HomeEnvironment={})),HomeEnvironment.__transients=["photoAspectRatio","videoAspectRatio","propertyChangeSupport"];var HomePieceOfFurniture=function(e){function t(i,n,o){var r=this;if(("string"==typeof i||null===i)&&(null!=n&&null!=n.constructor&&null!=n.constructor.__interfaces&&n.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.PieceOfFurniture")>=0||null===n)&&(null!=o&&o instanceof Array&&(0==o.length||null==o[0]||"string"==typeof o[0])||null===o)){var l=arguments;if(void 0===(r=e.call(this,i)||this).catalogId&&(r.catalogId=null),void 0===r.name&&(r.name=null),void 0===r.nameVisible&&(r.nameVisible=!1),void 0===r.nameXOffset&&(r.nameXOffset=0),void 0===r.nameYOffset&&(r.nameYOffset=0),void 0===r.nameStyle&&(r.nameStyle=null),void 0===r.nameAngle&&(r.nameAngle=0),void 0===r.description&&(r.description=null),void 0===r.information&&(r.information=null),void 0===r.creator&&(r.creator=null),void 0===r.license&&(r.license=null),void 0===r.icon&&(r.icon=null),void 0===r.planIcon&&(r.planIcon=null),void 0===r.model&&(r.model=null),void 0===r.modelSize&&(r.modelSize=null),void 0===r.width&&(r.width=0),void 0===r.widthInPlan&&(r.widthInPlan=0),void 0===r.depth&&(r.depth=0),void 0===r.depthInPlan&&(r.depthInPlan=0),void 0===r.height&&(r.height=0),void 0===r.heightInPlan&&(r.heightInPlan=0),void 0===r.elevation&&(r.elevation=0),void 0===r.dropOnTopElevation&&(r.dropOnTopElevation=0),void 0===r.movable&&(r.movable=!1),void 0===r.doorOrWindow&&(r.doorOrWindow=!1),void 0===r.modelMaterials&&(r.modelMaterials=null),void 0===r.color&&(r.color=null),void 0===r.texture&&(r.texture=null),void 0===r.shininess&&(r.shininess=null),void 0===r.modelRotation&&(r.modelRotation=null),void 0===r.modelFlags&&(r.modelFlags=0),void 0===r.modelCenteredAtOrigin&&(r.modelCenteredAtOrigin=!1),void 0===r.modelTransformations&&(r.modelTransformations=null),void 0===r.staircaseCutOutShape&&(r.staircaseCutOutShape=null),void 0===r.backFaceShown&&(r.backFaceShown=!1),void 0===r.resizable&&(r.resizable=!1),void 0===r.deformable&&(r.deformable=!1),void 0===r.texturable&&(r.texturable=!1),void 0===r.horizontallyRotatable&&(r.horizontallyRotatable=!1),void 0===r.price&&(r.price=null),void 0===r.valueAddedTaxPercentage&&(r.valueAddedTaxPercentage=null),void 0===r.currency&&(r.currency=null),void 0===r.visible&&(r.visible=!1),void 0===r.x&&(r.x=0),void 0===r.y&&(r.y=0),void 0===r.angle&&(r.angle=0),void 0===r.pitch&&(r.pitch=0),void 0===r.roll&&(r.roll=0),void 0===r.modelMirrored&&(r.modelMirrored=!1),void 0===r.level&&(r.level=null),void 0===r.shapeCache&&(r.shapeCache=null),r.name=n.getName(),r.description=n.getDescription(),r.information=n.getInformation(),r.creator=n.getCreator(),r.license=n.getLicense(),r.icon=n.getIcon(),r.planIcon=n.getPlanIcon(),r.model=n.getModel(),r.modelSize=n.getModelSize(),r.width=n.getWidth(),r.depth=n.getDepth(),r.height=n.getHeight(),r.elevation=n.getElevation(),r.dropOnTopElevation=n.getDropOnTopElevation(),r.movable=n.isMovable(),r.doorOrWindow=n.isDoorOrWindow(),r.color=n.getColor(),r.modelRotation=n.getModelRotation(),r.staircaseCutOutShape=n.getStaircaseCutOutShape(),r.modelFlags=n.getModelFlags(),r.resizable=n.isResizable(),r.deformable=n.isDeformable(),r.texturable=n.isTexturable(),r.horizontallyRotatable=n.isHorizontallyRotatable(),r.price=n.getPrice(),r.valueAddedTaxPercentage=n.getValueAddedTaxPercentage(),r.currency=n.getCurrency(),null!=n&&n instanceof t){var a=n;r.catalogId=a.getCatalogId(),r.nameVisible=a.isNameVisible(),r.nameXOffset=a.getNameXOffset(),r.nameYOffset=a.getNameYOffset(),r.nameAngle=a.getNameAngle(),r.nameStyle=a.getNameStyle(),r.visible=a.isVisible(),r.widthInPlan=a.getWidthInPlan(),r.depthInPlan=a.getDepthInPlan(),r.heightInPlan=a.getHeightInPlan(),r.modelCenteredAtOrigin=a.isModelCenteredAtOrigin(),r.modelTransformations=a.getModelTransformations(),r.angle=a.getAngle(),r.pitch=a.getPitch(),r.roll=a.getRoll(),r.x=a.getX(),r.y=a.getY(),r.modelMirrored=a.isModelMirrored(),r.texture=a.getTexture(),r.shininess=a.getShininess(),r.modelMaterials=a.getModelMaterials();for(var s=null!=o?o.slice(0):a.getPropertyNames(),h=0;h<s.length;h++){var u=s[h];null!=(S=a.isContentProperty(u)?a.getContentProperty(u):a.getProperty(u))&&r.setProperty$java_lang_String$java_lang_Object(u,S)}}else{if(null!=n&&n instanceof CatalogPieceOfFurniture){var d=n;r.catalogId=d.getId();for(s=null!=o?o.slice(0):d.getPropertyNames(),h=0;h<s.length;h++){u=s[h];null!=(S=d.isContentProperty(u)?d.getContentProperty(u):d.getProperty(u))&&r.setProperty$java_lang_String$java_lang_Object(u,S)}}r.visible=!0,r.widthInPlan=r.width,r.depthInPlan=r.depth,r.heightInPlan=r.height,r.modelCenteredAtOrigin=!0,r.x=r.width/2,r.y=r.depth/2}}else if((null!=i&&null!=i.constructor&&null!=i.constructor.__interfaces&&i.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.PieceOfFurniture")>=0||null===i)&&(null!=n&&n instanceof Array&&(0==n.length||null==n[0]||"string"==typeof n[0])||null===n)&&void 0===o){var c=(l=arguments)[0],p=l[1],g=HomeObject.createId("pieceOfFurniture");if(void 0===(r=e.call(this,g)||this).catalogId&&(r.catalogId=null),void 0===r.name&&(r.name=null),void 0===r.nameVisible&&(r.nameVisible=!1),void 0===r.nameXOffset&&(r.nameXOffset=0),void 0===r.nameYOffset&&(r.nameYOffset=0),void 0===r.nameStyle&&(r.nameStyle=null),void 0===r.nameAngle&&(r.nameAngle=0),void 0===r.description&&(r.description=null),void 0===r.information&&(r.information=null),void 0===r.creator&&(r.creator=null),void 0===r.license&&(r.license=null),void 0===r.icon&&(r.icon=null),void 0===r.planIcon&&(r.planIcon=null),void 0===r.model&&(r.model=null),void 0===r.modelSize&&(r.modelSize=null),void 0===r.width&&(r.width=0),void 0===r.widthInPlan&&(r.widthInPlan=0),void 0===r.depth&&(r.depth=0),void 0===r.depthInPlan&&(r.depthInPlan=0),void 0===r.height&&(r.height=0),void 0===r.heightInPlan&&(r.heightInPlan=0),void 0===r.elevation&&(r.elevation=0),void 0===r.dropOnTopElevation&&(r.dropOnTopElevation=0),void 0===r.movable&&(r.movable=!1),void 0===r.doorOrWindow&&(r.doorOrWindow=!1),void 0===r.modelMaterials&&(r.modelMaterials=null),void 0===r.color&&(r.color=null),void 0===r.texture&&(r.texture=null),void 0===r.shininess&&(r.shininess=null),void 0===r.modelRotation&&(r.modelRotation=null),void 0===r.modelFlags&&(r.modelFlags=0),void 0===r.modelCenteredAtOrigin&&(r.modelCenteredAtOrigin=!1),void 0===r.modelTransformations&&(r.modelTransformations=null),void 0===r.staircaseCutOutShape&&(r.staircaseCutOutShape=null),void 0===r.backFaceShown&&(r.backFaceShown=!1),void 0===r.resizable&&(r.resizable=!1),void 0===r.deformable&&(r.deformable=!1),void 0===r.texturable&&(r.texturable=!1),void 0===r.horizontallyRotatable&&(r.horizontallyRotatable=!1),void 0===r.price&&(r.price=null),void 0===r.valueAddedTaxPercentage&&(r.valueAddedTaxPercentage=null),void 0===r.currency&&(r.currency=null),void 0===r.visible&&(r.visible=!1),void 0===r.x&&(r.x=0),void 0===r.y&&(r.y=0),void 0===r.angle&&(r.angle=0),void 0===r.pitch&&(r.pitch=0),void 0===r.roll&&(r.roll=0),void 0===r.modelMirrored&&(r.modelMirrored=!1),void 0===r.level&&(r.level=null),void 0===r.shapeCache&&(r.shapeCache=null),r.name=c.getName(),r.description=c.getDescription(),r.information=c.getInformation(),r.creator=c.getCreator(),r.license=c.getLicense(),r.icon=c.getIcon(),r.planIcon=c.getPlanIcon(),r.model=c.getModel(),r.modelSize=c.getModelSize(),r.width=c.getWidth(),r.depth=c.getDepth(),r.height=c.getHeight(),r.elevation=c.getElevation(),r.dropOnTopElevation=c.getDropOnTopElevation(),r.movable=c.isMovable(),r.doorOrWindow=c.isDoorOrWindow(),r.color=c.getColor(),r.modelRotation=c.getModelRotation(),r.staircaseCutOutShape=c.getStaircaseCutOutShape(),r.modelFlags=c.getModelFlags(),r.resizable=c.isResizable(),r.deformable=c.isDeformable(),r.texturable=c.isTexturable(),r.horizontallyRotatable=c.isHorizontallyRotatable(),r.price=c.getPrice(),r.valueAddedTaxPercentage=c.getValueAddedTaxPercentage(),r.currency=c.getCurrency(),null!=c&&c instanceof t){a=c;r.catalogId=a.getCatalogId(),r.nameVisible=a.isNameVisible(),r.nameXOffset=a.getNameXOffset(),r.nameYOffset=a.getNameYOffset(),r.nameAngle=a.getNameAngle(),r.nameStyle=a.getNameStyle(),r.visible=a.isVisible(),r.widthInPlan=a.getWidthInPlan(),r.depthInPlan=a.getDepthInPlan(),r.heightInPlan=a.getHeightInPlan(),r.modelCenteredAtOrigin=a.isModelCenteredAtOrigin(),r.modelTransformations=a.getModelTransformations(),r.angle=a.getAngle(),r.pitch=a.getPitch(),r.roll=a.getRoll(),r.x=a.getX(),r.y=a.getY(),r.modelMirrored=a.isModelMirrored(),r.texture=a.getTexture(),r.shininess=a.getShininess(),r.modelMaterials=a.getModelMaterials();for(s=null!=p?p.slice(0):a.getPropertyNames(),h=0;h<s.length;h++){u=s[h];null!=(S=a.isContentProperty(u)?a.getContentProperty(u):a.getProperty(u))&&r.setProperty$java_lang_String$java_lang_Object(u,S)}}else{if(null!=c&&c instanceof CatalogPieceOfFurniture){d=c;r.catalogId=d.getId();for(s=null!=p?p.slice(0):d.getPropertyNames(),h=0;h<s.length;h++){u=s[h];null!=(S=d.isContentProperty(u)?d.getContentProperty(u):d.getProperty(u))&&r.setProperty$java_lang_String$java_lang_Object(u,S)}}r.visible=!0,r.widthInPlan=r.width,r.depthInPlan=r.depth,r.heightInPlan=r.height,r.modelCenteredAtOrigin=!0,r.x=r.width/2,r.y=r.depth/2}void 0===r.catalogId&&(r.catalogId=null),void 0===r.name&&(r.name=null),void 0===r.nameVisible&&(r.nameVisible=!1),void 0===r.nameXOffset&&(r.nameXOffset=0),void 0===r.nameYOffset&&(r.nameYOffset=0),void 0===r.nameStyle&&(r.nameStyle=null),void 0===r.nameAngle&&(r.nameAngle=0),void 0===r.description&&(r.description=null),void 0===r.information&&(r.information=null),void 0===r.creator&&(r.creator=null),void 0===r.license&&(r.license=null),void 0===r.icon&&(r.icon=null),void 0===r.planIcon&&(r.planIcon=null),void 0===r.model&&(r.model=null),void 0===r.modelSize&&(r.modelSize=null),void 0===r.width&&(r.width=0),void 0===r.widthInPlan&&(r.widthInPlan=0),void 0===r.depth&&(r.depth=0),void 0===r.depthInPlan&&(r.depthInPlan=0),void 0===r.height&&(r.height=0),void 0===r.heightInPlan&&(r.heightInPlan=0),void 0===r.elevation&&(r.elevation=0),void 0===r.dropOnTopElevation&&(r.dropOnTopElevation=0),void 0===r.movable&&(r.movable=!1),void 0===r.doorOrWindow&&(r.doorOrWindow=!1),void 0===r.modelMaterials&&(r.modelMaterials=null),void 0===r.color&&(r.color=null),void 0===r.texture&&(r.texture=null),void 0===r.shininess&&(r.shininess=null),void 0===r.modelRotation&&(r.modelRotation=null),void 0===r.modelFlags&&(r.modelFlags=0),void 0===r.modelCenteredAtOrigin&&(r.modelCenteredAtOrigin=!1),void 0===r.modelTransformations&&(r.modelTransformations=null),void 0===r.staircaseCutOutShape&&(r.staircaseCutOutShape=null),void 0===r.backFaceShown&&(r.backFaceShown=!1),void 0===r.resizable&&(r.resizable=!1),void 0===r.deformable&&(r.deformable=!1),void 0===r.texturable&&(r.texturable=!1),void 0===r.horizontallyRotatable&&(r.horizontallyRotatable=!1),void 0===r.price&&(r.price=null),void 0===r.valueAddedTaxPercentage&&(r.valueAddedTaxPercentage=null),void 0===r.currency&&(r.currency=null),void 0===r.visible&&(r.visible=!1),void 0===r.x&&(r.x=0),void 0===r.y&&(r.y=0),void 0===r.angle&&(r.angle=0),void 0===r.pitch&&(r.pitch=0),void 0===r.roll&&(r.roll=0),void 0===r.modelMirrored&&(r.modelMirrored=!1),void 0===r.level&&(r.level=null),void 0===r.shapeCache&&(r.shapeCache=null)}else if("string"!=typeof i&&null!==i||!(null!=n&&null!=n.constructor&&null!=n.constructor.__interfaces&&n.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.PieceOfFurniture")>=0||null===n)||void 0!==o){if(!(null!=i&&null!=i.constructor&&null!=i.constructor.__interfaces&&i.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.PieceOfFurniture")>=0||null===i)||void 0!==n||void 0!==o)throw new Error("invalid overload");var m=(l=arguments)[0],f=t.EMPTY_PROPERTY_ARRAY_$LI$(),v=HomeObject.createId("pieceOfFurniture");if(void 0===(r=e.call(this,v)||this).catalogId&&(r.catalogId=null),void 0===r.name&&(r.name=null),void 0===r.nameVisible&&(r.nameVisible=!1),void 0===r.nameXOffset&&(r.nameXOffset=0),void 0===r.nameYOffset&&(r.nameYOffset=0),void 0===r.nameStyle&&(r.nameStyle=null),void 0===r.nameAngle&&(r.nameAngle=0),void 0===r.description&&(r.description=null),void 0===r.information&&(r.information=null),void 0===r.creator&&(r.creator=null),void 0===r.license&&(r.license=null),void 0===r.icon&&(r.icon=null),void 0===r.planIcon&&(r.planIcon=null),void 0===r.model&&(r.model=null),void 0===r.modelSize&&(r.modelSize=null),void 0===r.width&&(r.width=0),void 0===r.widthInPlan&&(r.widthInPlan=0),void 0===r.depth&&(r.depth=0),void 0===r.depthInPlan&&(r.depthInPlan=0),void 0===r.height&&(r.height=0),void 0===r.heightInPlan&&(r.heightInPlan=0),void 0===r.elevation&&(r.elevation=0),void 0===r.dropOnTopElevation&&(r.dropOnTopElevation=0),void 0===r.movable&&(r.movable=!1),void 0===r.doorOrWindow&&(r.doorOrWindow=!1),void 0===r.modelMaterials&&(r.modelMaterials=null),void 0===r.color&&(r.color=null),void 0===r.texture&&(r.texture=null),void 0===r.shininess&&(r.shininess=null),void 0===r.modelRotation&&(r.modelRotation=null),void 0===r.modelFlags&&(r.modelFlags=0),void 0===r.modelCenteredAtOrigin&&(r.modelCenteredAtOrigin=!1),void 0===r.modelTransformations&&(r.modelTransformations=null),void 0===r.staircaseCutOutShape&&(r.staircaseCutOutShape=null),void 0===r.backFaceShown&&(r.backFaceShown=!1),void 0===r.resizable&&(r.resizable=!1),void 0===r.deformable&&(r.deformable=!1),void 0===r.texturable&&(r.texturable=!1),void 0===r.horizontallyRotatable&&(r.horizontallyRotatable=!1),void 0===r.price&&(r.price=null),void 0===r.valueAddedTaxPercentage&&(r.valueAddedTaxPercentage=null),void 0===r.currency&&(r.currency=null),void 0===r.visible&&(r.visible=!1),void 0===r.x&&(r.x=0),void 0===r.y&&(r.y=0),void 0===r.angle&&(r.angle=0),void 0===r.pitch&&(r.pitch=0),void 0===r.roll&&(r.roll=0),void 0===r.modelMirrored&&(r.modelMirrored=!1),void 0===r.level&&(r.level=null),void 0===r.shapeCache&&(r.shapeCache=null),r.name=m.getName(),r.description=m.getDescription(),r.information=m.getInformation(),r.creator=m.getCreator(),r.license=m.getLicense(),r.icon=m.getIcon(),r.planIcon=m.getPlanIcon(),r.model=m.getModel(),r.modelSize=m.getModelSize(),r.width=m.getWidth(),r.depth=m.getDepth(),r.height=m.getHeight(),r.elevation=m.getElevation(),r.dropOnTopElevation=m.getDropOnTopElevation(),r.movable=m.isMovable(),r.doorOrWindow=m.isDoorOrWindow(),r.color=m.getColor(),r.modelRotation=m.getModelRotation(),r.staircaseCutOutShape=m.getStaircaseCutOutShape(),r.modelFlags=m.getModelFlags(),r.resizable=m.isResizable(),r.deformable=m.isDeformable(),r.texturable=m.isTexturable(),r.horizontallyRotatable=m.isHorizontallyRotatable(),r.price=m.getPrice(),r.valueAddedTaxPercentage=m.getValueAddedTaxPercentage(),r.currency=m.getCurrency(),null!=m&&m instanceof t){a=m;r.catalogId=a.getCatalogId(),r.nameVisible=a.isNameVisible(),r.nameXOffset=a.getNameXOffset(),r.nameYOffset=a.getNameYOffset(),r.nameAngle=a.getNameAngle(),r.nameStyle=a.getNameStyle(),r.visible=a.isVisible(),r.widthInPlan=a.getWidthInPlan(),r.depthInPlan=a.getDepthInPlan(),r.heightInPlan=a.getHeightInPlan(),r.modelCenteredAtOrigin=a.isModelCenteredAtOrigin(),r.modelTransformations=a.getModelTransformations(),r.angle=a.getAngle(),r.pitch=a.getPitch(),r.roll=a.getRoll(),r.x=a.getX(),r.y=a.getY(),r.modelMirrored=a.isModelMirrored(),r.texture=a.getTexture(),r.shininess=a.getShininess(),r.modelMaterials=a.getModelMaterials();for(s=null!=f?f.slice(0):a.getPropertyNames(),h=0;h<s.length;h++){u=s[h];null!=(S=a.isContentProperty(u)?a.getContentProperty(u):a.getProperty(u))&&r.setProperty$java_lang_String$java_lang_Object(u,S)}}else{if(null!=m&&m instanceof CatalogPieceOfFurniture){d=m;r.catalogId=d.getId();for(s=null!=f?f.slice(0):d.getPropertyNames(),h=0;h<s.length;h++){u=s[h];null!=(S=d.isContentProperty(u)?d.getContentProperty(u):d.getProperty(u))&&r.setProperty$java_lang_String$java_lang_Object(u,S)}}r.visible=!0,r.widthInPlan=r.width,r.depthInPlan=r.depth,r.heightInPlan=r.height,r.modelCenteredAtOrigin=!0,r.x=r.width/2,r.y=r.depth/2}void 0===r.catalogId&&(r.catalogId=null),void 0===r.name&&(r.name=null),void 0===r.nameVisible&&(r.nameVisible=!1),void 0===r.nameXOffset&&(r.nameXOffset=0),void 0===r.nameYOffset&&(r.nameYOffset=0),void 0===r.nameStyle&&(r.nameStyle=null),void 0===r.nameAngle&&(r.nameAngle=0),void 0===r.description&&(r.description=null),void 0===r.information&&(r.information=null),void 0===r.creator&&(r.creator=null),void 0===r.license&&(r.license=null),void 0===r.icon&&(r.icon=null),void 0===r.planIcon&&(r.planIcon=null),void 0===r.model&&(r.model=null),void 0===r.modelSize&&(r.modelSize=null),void 0===r.width&&(r.width=0),void 0===r.widthInPlan&&(r.widthInPlan=0),void 0===r.depth&&(r.depth=0),void 0===r.depthInPlan&&(r.depthInPlan=0),void 0===r.height&&(r.height=0),void 0===r.heightInPlan&&(r.heightInPlan=0),void 0===r.elevation&&(r.elevation=0),void 0===r.dropOnTopElevation&&(r.dropOnTopElevation=0),void 0===r.movable&&(r.movable=!1),void 0===r.doorOrWindow&&(r.doorOrWindow=!1),void 0===r.modelMaterials&&(r.modelMaterials=null),void 0===r.color&&(r.color=null),void 0===r.texture&&(r.texture=null),void 0===r.shininess&&(r.shininess=null),void 0===r.modelRotation&&(r.modelRotation=null),void 0===r.modelFlags&&(r.modelFlags=0),void 0===r.modelCenteredAtOrigin&&(r.modelCenteredAtOrigin=!1),void 0===r.modelTransformations&&(r.modelTransformations=null),void 0===r.staircaseCutOutShape&&(r.staircaseCutOutShape=null),void 0===r.backFaceShown&&(r.backFaceShown=!1),void 0===r.resizable&&(r.resizable=!1),void 0===r.deformable&&(r.deformable=!1),void 0===r.texturable&&(r.texturable=!1),void 0===r.horizontallyRotatable&&(r.horizontallyRotatable=!1),void 0===r.price&&(r.price=null),void 0===r.valueAddedTaxPercentage&&(r.valueAddedTaxPercentage=null),void 0===r.currency&&(r.currency=null),void 0===r.visible&&(r.visible=!1),void 0===r.x&&(r.x=0),void 0===r.y&&(r.y=0),void 0===r.angle&&(r.angle=0),void 0===r.pitch&&(r.pitch=0),void 0===r.roll&&(r.roll=0),void 0===r.modelMirrored&&(r.modelMirrored=!1),void 0===r.level&&(r.level=null),void 0===r.shapeCache&&(r.shapeCache=null),void 0===r.catalogId&&(r.catalogId=null),void 0===r.name&&(r.name=null),void 0===r.nameVisible&&(r.nameVisible=!1),void 0===r.nameXOffset&&(r.nameXOffset=0),void 0===r.nameYOffset&&(r.nameYOffset=0),void 0===r.nameStyle&&(r.nameStyle=null),void 0===r.nameAngle&&(r.nameAngle=0),void 0===r.description&&(r.description=null),void 0===r.information&&(r.information=null),void 0===r.creator&&(r.creator=null),void 0===r.license&&(r.license=null),void 0===r.icon&&(r.icon=null),void 0===r.planIcon&&(r.planIcon=null),void 0===r.model&&(r.model=null),void 0===r.modelSize&&(r.modelSize=null),void 0===r.width&&(r.width=0),void 0===r.widthInPlan&&(r.widthInPlan=0),void 0===r.depth&&(r.depth=0),void 0===r.depthInPlan&&(r.depthInPlan=0),void 0===r.height&&(r.height=0),void 0===r.heightInPlan&&(r.heightInPlan=0),void 0===r.elevation&&(r.elevation=0),void 0===r.dropOnTopElevation&&(r.dropOnTopElevation=0),void 0===r.movable&&(r.movable=!1),void 0===r.doorOrWindow&&(r.doorOrWindow=!1),void 0===r.modelMaterials&&(r.modelMaterials=null),void 0===r.color&&(r.color=null),void 0===r.texture&&(r.texture=null),void 0===r.shininess&&(r.shininess=null),void 0===r.modelRotation&&(r.modelRotation=null),void 0===r.modelFlags&&(r.modelFlags=0),void 0===r.modelCenteredAtOrigin&&(r.modelCenteredAtOrigin=!1),void 0===r.modelTransformations&&(r.modelTransformations=null),void 0===r.staircaseCutOutShape&&(r.staircaseCutOutShape=null),void 0===r.backFaceShown&&(r.backFaceShown=!1),void 0===r.resizable&&(r.resizable=!1),void 0===r.deformable&&(r.deformable=!1),void 0===r.texturable&&(r.texturable=!1),void 0===r.horizontallyRotatable&&(r.horizontallyRotatable=!1),void 0===r.price&&(r.price=null),void 0===r.valueAddedTaxPercentage&&(r.valueAddedTaxPercentage=null),void 0===r.currency&&(r.currency=null),void 0===r.visible&&(r.visible=!1),void 0===r.x&&(r.x=0),void 0===r.y&&(r.y=0),void 0===r.angle&&(r.angle=0),void 0===r.pitch&&(r.pitch=0),void 0===r.roll&&(r.roll=0),void 0===r.modelMirrored&&(r.modelMirrored=!1),void 0===r.level&&(r.level=null),void 0===r.shapeCache&&(r.shapeCache=null)}else{var l=arguments,_=t.EMPTY_PROPERTY_ARRAY_$LI$();if(void 0===(r=e.call(this,i)||this).catalogId&&(r.catalogId=null),void 0===r.name&&(r.name=null),void 0===r.nameVisible&&(r.nameVisible=!1),void 0===r.nameXOffset&&(r.nameXOffset=0),void 0===r.nameYOffset&&(r.nameYOffset=0),void 0===r.nameStyle&&(r.nameStyle=null),void 0===r.nameAngle&&(r.nameAngle=0),void 0===r.description&&(r.description=null),void 0===r.information&&(r.information=null),void 0===r.creator&&(r.creator=null),void 0===r.license&&(r.license=null),void 0===r.icon&&(r.icon=null),void 0===r.planIcon&&(r.planIcon=null),void 0===r.model&&(r.model=null),void 0===r.modelSize&&(r.modelSize=null),void 0===r.width&&(r.width=0),void 0===r.widthInPlan&&(r.widthInPlan=0),void 0===r.depth&&(r.depth=0),void 0===r.depthInPlan&&(r.depthInPlan=0),void 0===r.height&&(r.height=0),void 0===r.heightInPlan&&(r.heightInPlan=0),void 0===r.elevation&&(r.elevation=0),void 0===r.dropOnTopElevation&&(r.dropOnTopElevation=0),void 0===r.movable&&(r.movable=!1),void 0===r.doorOrWindow&&(r.doorOrWindow=!1),void 0===r.modelMaterials&&(r.modelMaterials=null),void 0===r.color&&(r.color=null),void 0===r.texture&&(r.texture=null),void 0===r.shininess&&(r.shininess=null),void 0===r.modelRotation&&(r.modelRotation=null),void 0===r.modelFlags&&(r.modelFlags=0),void 0===r.modelCenteredAtOrigin&&(r.modelCenteredAtOrigin=!1),void 0===r.modelTransformations&&(r.modelTransformations=null),void 0===r.staircaseCutOutShape&&(r.staircaseCutOutShape=null),void 0===r.backFaceShown&&(r.backFaceShown=!1),void 0===r.resizable&&(r.resizable=!1),void 0===r.deformable&&(r.deformable=!1),void 0===r.texturable&&(r.texturable=!1),void 0===r.horizontallyRotatable&&(r.horizontallyRotatable=!1),void 0===r.price&&(r.price=null),void 0===r.valueAddedTaxPercentage&&(r.valueAddedTaxPercentage=null),void 0===r.currency&&(r.currency=null),void 0===r.visible&&(r.visible=!1),void 0===r.x&&(r.x=0),void 0===r.y&&(r.y=0),void 0===r.angle&&(r.angle=0),void 0===r.pitch&&(r.pitch=0),void 0===r.roll&&(r.roll=0),void 0===r.modelMirrored&&(r.modelMirrored=!1),void 0===r.level&&(r.level=null),void 0===r.shapeCache&&(r.shapeCache=null),r.name=n.getName(),r.description=n.getDescription(),r.information=n.getInformation(),r.creator=n.getCreator(),r.license=n.getLicense(),r.icon=n.getIcon(),r.planIcon=n.getPlanIcon(),r.model=n.getModel(),r.modelSize=n.getModelSize(),r.width=n.getWidth(),r.depth=n.getDepth(),r.height=n.getHeight(),r.elevation=n.getElevation(),r.dropOnTopElevation=n.getDropOnTopElevation(),r.movable=n.isMovable(),r.doorOrWindow=n.isDoorOrWindow(),r.color=n.getColor(),r.modelRotation=n.getModelRotation(),r.staircaseCutOutShape=n.getStaircaseCutOutShape(),r.modelFlags=n.getModelFlags(),r.resizable=n.isResizable(),r.deformable=n.isDeformable(),r.texturable=n.isTexturable(),r.horizontallyRotatable=n.isHorizontallyRotatable(),r.price=n.getPrice(),r.valueAddedTaxPercentage=n.getValueAddedTaxPercentage(),r.currency=n.getCurrency(),null!=n&&n instanceof t){var a=n;r.catalogId=a.getCatalogId(),r.nameVisible=a.isNameVisible(),r.nameXOffset=a.getNameXOffset(),r.nameYOffset=a.getNameYOffset(),r.nameAngle=a.getNameAngle(),r.nameStyle=a.getNameStyle(),r.visible=a.isVisible(),r.widthInPlan=a.getWidthInPlan(),r.depthInPlan=a.getDepthInPlan(),r.heightInPlan=a.getHeightInPlan(),r.modelCenteredAtOrigin=a.isModelCenteredAtOrigin(),r.modelTransformations=a.getModelTransformations(),r.angle=a.getAngle(),r.pitch=a.getPitch(),r.roll=a.getRoll(),r.x=a.getX(),r.y=a.getY(),r.modelMirrored=a.isModelMirrored(),r.texture=a.getTexture(),r.shininess=a.getShininess(),r.modelMaterials=a.getModelMaterials();for(var s=null!=_?_.slice(0):a.getPropertyNames(),h=0;h<s.length;h++){var u=s[h];null!=(S=a.isContentProperty(u)?a.getContentProperty(u):a.getProperty(u))&&r.setProperty$java_lang_String$java_lang_Object(u,S)}}else{if(null!=n&&n instanceof CatalogPieceOfFurniture){var d=n;r.catalogId=d.getId();for(var s=null!=_?_.slice(0):d.getPropertyNames(),h=0;h<s.length;h++){var S,u=s[h];null!=(S=d.isContentProperty(u)?d.getContentProperty(u):d.getProperty(u))&&r.setProperty$java_lang_String$java_lang_Object(u,S)}}r.visible=!0,r.widthInPlan=r.width,r.depthInPlan=r.depth,r.heightInPlan=r.height,r.modelCenteredAtOrigin=!0,r.x=r.width/2,r.y=r.depth/2}void 0===r.catalogId&&(r.catalogId=null),void 0===r.name&&(r.name=null),void 0===r.nameVisible&&(r.nameVisible=!1),void 0===r.nameXOffset&&(r.nameXOffset=0),void 0===r.nameYOffset&&(r.nameYOffset=0),void 0===r.nameStyle&&(r.nameStyle=null),void 0===r.nameAngle&&(r.nameAngle=0),void 0===r.description&&(r.description=null),void 0===r.information&&(r.information=null),void 0===r.creator&&(r.creator=null),void 0===r.license&&(r.license=null),void 0===r.icon&&(r.icon=null),void 0===r.planIcon&&(r.planIcon=null),void 0===r.model&&(r.model=null),void 0===r.modelSize&&(r.modelSize=null),void 0===r.width&&(r.width=0),void 0===r.widthInPlan&&(r.widthInPlan=0),void 0===r.depth&&(r.depth=0),void 0===r.depthInPlan&&(r.depthInPlan=0),void 0===r.height&&(r.height=0),void 0===r.heightInPlan&&(r.heightInPlan=0),void 0===r.elevation&&(r.elevation=0),void 0===r.dropOnTopElevation&&(r.dropOnTopElevation=0),void 0===r.movable&&(r.movable=!1),void 0===r.doorOrWindow&&(r.doorOrWindow=!1),void 0===r.modelMaterials&&(r.modelMaterials=null),void 0===r.color&&(r.color=null),void 0===r.texture&&(r.texture=null),void 0===r.shininess&&(r.shininess=null),void 0===r.modelRotation&&(r.modelRotation=null),void 0===r.modelFlags&&(r.modelFlags=0),void 0===r.modelCenteredAtOrigin&&(r.modelCenteredAtOrigin=!1),void 0===r.modelTransformations&&(r.modelTransformations=null),void 0===r.staircaseCutOutShape&&(r.staircaseCutOutShape=null),void 0===r.backFaceShown&&(r.backFaceShown=!1),void 0===r.resizable&&(r.resizable=!1),void 0===r.deformable&&(r.deformable=!1),void 0===r.texturable&&(r.texturable=!1),void 0===r.horizontallyRotatable&&(r.horizontallyRotatable=!1),void 0===r.price&&(r.price=null),void 0===r.valueAddedTaxPercentage&&(r.valueAddedTaxPercentage=null),void 0===r.currency&&(r.currency=null),void 0===r.visible&&(r.visible=!1),void 0===r.x&&(r.x=0),void 0===r.y&&(r.y=0),void 0===r.angle&&(r.angle=0),void 0===r.pitch&&(r.pitch=0),void 0===r.roll&&(r.roll=0),void 0===r.modelMirrored&&(r.modelMirrored=!1),void 0===r.level&&(r.level=null),void 0===r.shapeCache&&(r.shapeCache=null)}return r}return __extends(t,e),t.__static_initialize=function(){t.__static_initialized||(t.__static_initialized=!0,t.__static_initializer_0())},t.TWICE_PI_$LI$=function(){return t.__static_initialize(),null==t.TWICE_PI&&(t.TWICE_PI=2*Math.PI),t.TWICE_PI},t.STRAIGHT_WALL_ANGLE_MARGIN_$LI$=function(){return t.__static_initialize(),null==t.STRAIGHT_WALL_ANGLE_MARGIN&&(t.STRAIGHT_WALL_ANGLE_MARGIN=1*Math.PI/180),t.STRAIGHT_WALL_ANGLE_MARGIN},t.ROUND_WALL_ANGLE_MARGIN_$LI$=function(){return t.__static_initialize(),null==t.ROUND_WALL_ANGLE_MARGIN&&(t.ROUND_WALL_ANGLE_MARGIN=10*Math.PI/180),t.ROUND_WALL_ANGLE_MARGIN},t.EMPTY_PROPERTY_ARRAY_$LI$=function(){return t.__static_initialize(),null==t.EMPTY_PROPERTY_ARRAY&&(t.EMPTY_PROPERTY_ARRAY=[]),t.EMPTY_PROPERTY_ARRAY},t.SORTABLE_PROPERTY_COMPARATORS_$LI$=function(){return t.__static_initialize(),t.SORTABLE_PROPERTY_COMPARATORS},t.__static_initializer_0=function(){var e={compare:function(e,t){return e.toString().localeCompare(t.toString())},equals:function(e,t){return 0===e.toString().localeCompare(t.toString())}};t.SORTABLE_PROPERTY_COMPARATORS={},function(e,t,i){null==e.entries&&(e.entries=[]);for(var n=0;n<e.entries.length;n++)if(e.entries[n].key,null!=e.entries[n].key.equals&&e.entries[n].key.equals(t)||e.entries[n].key===t)return void(e.entries[n].value=i);e.entries.push({key:t,value:i,getKey:function(){return this.key},getValue:function(){return this.value}})}(t.SORTABLE_PROPERTY_COMPARATORS_$LI$(),"CATALOG_ID",new t.HomePieceOfFurniture$0(e)),function(e,t,i){null==e.entries&&(e.entries=[]);for(var n=0;n<e.entries.length;n++)if(e.entries[n].key,null!=e.entries[n].key.equals&&e.entries[n].key.equals(t)||e.entries[n].key===t)return void(e.entries[n].value=i);e.entries.push({key:t,value:i,getKey:function(){return this.key},getValue:function(){return this.value}})}(t.SORTABLE_PROPERTY_COMPARATORS_$LI$(),"NAME",new t.HomePieceOfFurniture$1(e)),function(e,t,i){null==e.entries&&(e.entries=[]);for(var n=0;n<e.entries.length;n++)if(e.entries[n].key,null!=e.entries[n].key.equals&&e.entries[n].key.equals(t)||e.entries[n].key===t)return void(e.entries[n].value=i);e.entries.push({key:t,value:i,getKey:function(){return this.key},getValue:function(){return this.value}})}(t.SORTABLE_PROPERTY_COMPARATORS_$LI$(),"DESCRIPTION",new t.HomePieceOfFurniture$2(e)),function(e,t,i){null==e.entries&&(e.entries=[]);for(var n=0;n<e.entries.length;n++)if(e.entries[n].key,null!=e.entries[n].key.equals&&e.entries[n].key.equals(t)||e.entries[n].key===t)return void(e.entries[n].value=i);e.entries.push({key:t,value:i,getKey:function(){return this.key},getValue:function(){return this.value}})}(t.SORTABLE_PROPERTY_COMPARATORS_$LI$(),"CREATOR",new t.HomePieceOfFurniture$3(e)),function(e,t,i){null==e.entries&&(e.entries=[]);for(var n=0;n<e.entries.length;n++)if(e.entries[n].key,null!=e.entries[n].key.equals&&e.entries[n].key.equals(t)||e.entries[n].key===t)return void(e.entries[n].value=i);e.entries.push({key:t,value:i,getKey:function(){return this.key},getValue:function(){return this.value}})}(t.SORTABLE_PROPERTY_COMPARATORS_$LI$(),"LICENSE",new t.HomePieceOfFurniture$4(e)),function(e,t,i){null==e.entries&&(e.entries=[]);for(var n=0;n<e.entries.length;n++)if(e.entries[n].key,null!=e.entries[n].key.equals&&e.entries[n].key.equals(t)||e.entries[n].key===t)return void(e.entries[n].value=i);e.entries.push({key:t,value:i,getKey:function(){return this.key},getValue:function(){return this.value}})}(t.SORTABLE_PROPERTY_COMPARATORS_$LI$(),"WIDTH",new t.HomePieceOfFurniture$5),function(e,t,i){null==e.entries&&(e.entries=[]);for(var n=0;n<e.entries.length;n++)if(e.entries[n].key,null!=e.entries[n].key.equals&&e.entries[n].key.equals(t)||e.entries[n].key===t)return void(e.entries[n].value=i);e.entries.push({key:t,value:i,getKey:function(){return this.key},getValue:function(){return this.value}})}(t.SORTABLE_PROPERTY_COMPARATORS_$LI$(),"HEIGHT",new t.HomePieceOfFurniture$6),function(e,t,i){null==e.entries&&(e.entries=[]);for(var n=0;n<e.entries.length;n++)if(e.entries[n].key,null!=e.entries[n].key.equals&&e.entries[n].key.equals(t)||e.entries[n].key===t)return void(e.entries[n].value=i);e.entries.push({key:t,value:i,getKey:function(){return this.key},getValue:function(){return this.value}})}(t.SORTABLE_PROPERTY_COMPARATORS_$LI$(),"DEPTH",new t.HomePieceOfFurniture$7),function(e,t,i){null==e.entries&&(e.entries=[]);for(var n=0;n<e.entries.length;n++)if(e.entries[n].key,null!=e.entries[n].key.equals&&e.entries[n].key.equals(t)||e.entries[n].key===t)return void(e.entries[n].value=i);e.entries.push({key:t,value:i,getKey:function(){return this.key},getValue:function(){return this.value}})}(t.SORTABLE_PROPERTY_COMPARATORS_$LI$(),"MOVABLE",new t.HomePieceOfFurniture$8),function(e,t,i){null==e.entries&&(e.entries=[]);for(var n=0;n<e.entries.length;n++)if(e.entries[n].key,null!=e.entries[n].key.equals&&e.entries[n].key.equals(t)||e.entries[n].key===t)return void(e.entries[n].value=i);e.entries.push({key:t,value:i,getKey:function(){return this.key},getValue:function(){return this.value}})}(t.SORTABLE_PROPERTY_COMPARATORS_$LI$(),"DOOR_OR_WINDOW",new t.HomePieceOfFurniture$9),function(e,t,i){null==e.entries&&(e.entries=[]);for(var n=0;n<e.entries.length;n++)if(e.entries[n].key,null!=e.entries[n].key.equals&&e.entries[n].key.equals(t)||e.entries[n].key===t)return void(e.entries[n].value=i);e.entries.push({key:t,value:i,getKey:function(){return this.key},getValue:function(){return this.value}})}(t.SORTABLE_PROPERTY_COMPARATORS_$LI$(),"COLOR",new t.HomePieceOfFurniture$10),function(e,t,i){null==e.entries&&(e.entries=[]);for(var n=0;n<e.entries.length;n++)if(e.entries[n].key,null!=e.entries[n].key.equals&&e.entries[n].key.equals(t)||e.entries[n].key===t)return void(e.entries[n].value=i);e.entries.push({key:t,value:i,getKey:function(){return this.key},getValue:function(){return this.value}})}(t.SORTABLE_PROPERTY_COMPARATORS_$LI$(),"TEXTURE",new t.HomePieceOfFurniture$11(e)),function(e,t,i){null==e.entries&&(e.entries=[]);for(var n=0;n<e.entries.length;n++)if(e.entries[n].key,null!=e.entries[n].key.equals&&e.entries[n].key.equals(t)||e.entries[n].key===t)return void(e.entries[n].value=i);e.entries.push({key:t,value:i,getKey:function(){return this.key},getValue:function(){return this.value}})}(t.SORTABLE_PROPERTY_COMPARATORS_$LI$(),"VISIBLE",new t.HomePieceOfFurniture$12),function(e,t,i){null==e.entries&&(e.entries=[]);for(var n=0;n<e.entries.length;n++)if(e.entries[n].key,null!=e.entries[n].key.equals&&e.entries[n].key.equals(t)||e.entries[n].key===t)return void(e.entries[n].value=i);e.entries.push({key:t,value:i,getKey:function(){return this.key},getValue:function(){return this.value}})}(t.SORTABLE_PROPERTY_COMPARATORS_$LI$(),"X",new t.HomePieceOfFurniture$13),function(e,t,i){null==e.entries&&(e.entries=[]);for(var n=0;n<e.entries.length;n++)if(e.entries[n].key,null!=e.entries[n].key.equals&&e.entries[n].key.equals(t)||e.entries[n].key===t)return void(e.entries[n].value=i);e.entries.push({key:t,value:i,getKey:function(){return this.key},getValue:function(){return this.value}})}(t.SORTABLE_PROPERTY_COMPARATORS_$LI$(),"Y",new t.HomePieceOfFurniture$14),function(e,t,i){null==e.entries&&(e.entries=[]);for(var n=0;n<e.entries.length;n++)if(e.entries[n].key,null!=e.entries[n].key.equals&&e.entries[n].key.equals(t)||e.entries[n].key===t)return void(e.entries[n].value=i);e.entries.push({key:t,value:i,getKey:function(){return this.key},getValue:function(){return this.value}})}(t.SORTABLE_PROPERTY_COMPARATORS_$LI$(),"ELEVATION",new t.HomePieceOfFurniture$15),function(e,t,i){null==e.entries&&(e.entries=[]);for(var n=0;n<e.entries.length;n++)if(e.entries[n].key,null!=e.entries[n].key.equals&&e.entries[n].key.equals(t)||e.entries[n].key===t)return void(e.entries[n].value=i);e.entries.push({key:t,value:i,getKey:function(){return this.key},getValue:function(){return this.value}})}(t.SORTABLE_PROPERTY_COMPARATORS_$LI$(),"ANGLE",new t.HomePieceOfFurniture$16),function(e,t,i){null==e.entries&&(e.entries=[]);for(var n=0;n<e.entries.length;n++)if(e.entries[n].key,null!=e.entries[n].key.equals&&e.entries[n].key.equals(t)||e.entries[n].key===t)return void(e.entries[n].value=i);e.entries.push({key:t,value:i,getKey:function(){return this.key},getValue:function(){return this.value}})}(t.SORTABLE_PROPERTY_COMPARATORS_$LI$(),"MODEL_SIZE",new t.HomePieceOfFurniture$17),function(e,t,i){null==e.entries&&(e.entries=[]);for(var n=0;n<e.entries.length;n++)if(e.entries[n].key,null!=e.entries[n].key.equals&&e.entries[n].key.equals(t)||e.entries[n].key===t)return void(e.entries[n].value=i);e.entries.push({key:t,value:i,getKey:function(){return this.key},getValue:function(){return this.value}})}(t.SORTABLE_PROPERTY_COMPARATORS_$LI$(),"LEVEL",new t.HomePieceOfFurniture$18),function(e,t,i){null==e.entries&&(e.entries=[]);for(var n=0;n<e.entries.length;n++)if(e.entries[n].key,null!=e.entries[n].key.equals&&e.entries[n].key.equals(t)||e.entries[n].key===t)return void(e.entries[n].value=i);e.entries.push({key:t,value:i,getKey:function(){return this.key},getValue:function(){return this.value}})}(t.SORTABLE_PROPERTY_COMPARATORS_$LI$(),"PRICE",new t.HomePieceOfFurniture$19),function(e,t,i){null==e.entries&&(e.entries=[]);for(var n=0;n<e.entries.length;n++)if(e.entries[n].key,null!=e.entries[n].key.equals&&e.entries[n].key.equals(t)||e.entries[n].key===t)return void(e.entries[n].value=i);e.entries.push({key:t,value:i,getKey:function(){return this.key},getValue:function(){return this.value}})}(t.SORTABLE_PROPERTY_COMPARATORS_$LI$(),"VALUE_ADDED_TAX_PERCENTAGE",new t.HomePieceOfFurniture$20),function(e,t,i){null==e.entries&&(e.entries=[]);for(var n=0;n<e.entries.length;n++)if(e.entries[n].key,null!=e.entries[n].key.equals&&e.entries[n].key.equals(t)||e.entries[n].key===t)return void(e.entries[n].value=i);e.entries.push({key:t,value:i,getKey:function(){return this.key},getValue:function(){return this.value}})}(t.SORTABLE_PROPERTY_COMPARATORS_$LI$(),"VALUE_ADDED_TAX",new t.HomePieceOfFurniture$21),function(e,t,i){null==e.entries&&(e.entries=[]);for(var n=0;n<e.entries.length;n++)if(e.entries[n].key,null!=e.entries[n].key.equals&&e.entries[n].key.equals(t)||e.entries[n].key===t)return void(e.entries[n].value=i);e.entries.push({key:t,value:i,getKey:function(){return this.key},getValue:function(){return this.value}})}(t.SORTABLE_PROPERTY_COMPARATORS_$LI$(),"PRICE_VALUE_ADDED_TAX_INCLUDED",new t.HomePieceOfFurniture$22)},t.compare$float$float=function(e,t){return e-t},t.compare$boolean$boolean=function(e,t){return e===t?0:e?-1:1},t.compare$java_math_BigDecimal$java_math_BigDecimal=function(e,t){return e===t?0:null==e?-1:null==t?1:e.cmp(t)},t.compare=function(e,i){if((null!=e&&e instanceof Big||null===e)&&(null!=i&&i instanceof Big||null===i))return t.compare$java_math_BigDecimal$java_math_BigDecimal(e,i);if((null!=e&&e instanceof Level||null===e)&&(null!=i&&i instanceof Level||null===i))return t.compare$com_eteks_sweethome3d_model_Level$com_eteks_sweethome3d_model_Level(e,i);if("number"!=typeof e&&null!==e||"number"!=typeof i&&null!==i){if("boolean"!=typeof e&&null!==e||"boolean"!=typeof i&&null!==i)throw new Error("invalid overload");return t.compare$boolean$boolean(e,i)}return t.compare$float$float(e,i)},t.compare$com_eteks_sweethome3d_model_Level$com_eteks_sweethome3d_model_Level=function(e,t){if(e===t)return 0;if(null==e)return-1;if(null==t)return 1;var i=e.getElevation()-t.getElevation();return 0!==i?i:e.getElevationIndex()-t.getElevationIndex()},t.getComparableModelSize=function(e){if(null!=e&&e instanceof HomeFurnitureGroup){for(var i=null,n=e.getFurniture(),o=0;o<n.length;o++){var r=n[o],l=t.getComparableModelSize(r);null!=l&&(null==i||i<l)&&(i=l)}return i}return e.modelSize},t.prototype.getCatalogId=function(){return this.catalogId},t.prototype.setCatalogId=function(e){if(e!==this.catalogId&&(null==e||e!==this.catalogId)){var t=this.catalogId;this.catalogId=e,this.firePropertyChange("CATALOG_ID",t,e)}},t.prototype.getName=function(){return this.name},t.prototype.setName=function(e){if(e!==this.name&&(null==e||e!==this.name)){var t=this.name;this.name=e,this.firePropertyChange("NAME",t,e)}},t.prototype.isNameVisible=function(){return this.nameVisible},t.prototype.setNameVisible=function(e){e!==this.nameVisible&&(this.nameVisible=e,this.firePropertyChange("NAME_VISIBLE",!e,e))},t.prototype.getNameXOffset=function(){return this.nameXOffset},t.prototype.setNameXOffset=function(e){if(e!==this.nameXOffset){var t=this.nameXOffset;this.nameXOffset=e,this.firePropertyChange("NAME_X_OFFSET",t,e)}},t.prototype.getNameYOffset=function(){return this.nameYOffset},t.prototype.setNameYOffset=function(e){if(e!==this.nameYOffset){var t=this.nameYOffset;this.nameYOffset=e,this.firePropertyChange("NAME_Y_OFFSET",t,e)}},t.prototype.getNameStyle=function(){return this.nameStyle},t.prototype.setNameStyle=function(e){if(e!==this.nameStyle){var t=this.nameStyle;this.nameStyle=e,this.firePropertyChange("NAME_STYLE",t,e)}},t.prototype.getNameAngle=function(){return this.nameAngle},t.prototype.setNameAngle=function(e){if((e=(e%t.TWICE_PI_$LI$()+t.TWICE_PI_$LI$())%t.TWICE_PI_$LI$())!==this.nameAngle){var i=this.nameAngle;this.nameAngle=e,this.firePropertyChange("NAME_ANGLE",i,e)}},t.prototype.getDescription=function(){return this.description},t.prototype.setDescription=function(e){if(e!==this.description&&(null==e||e!==this.description)){var t=this.description;this.description=e,this.firePropertyChange("DESCRIPTION",t,e)}},t.prototype.getInformation=function(){return this.information},t.prototype.setInformation=function(e){if(e!==this.information&&(null==e||e!==this.information)){var t=this.information;this.information=e,this.firePropertyChange("INFORMATION",t,e)}},t.prototype.getCreator=function(){return this.creator},t.prototype.setCreator=function(e){if(e!==this.creator&&(null==e||e!==this.creator)){var t=this.creator;this.creator=e,this.firePropertyChange("CREATOR",t,e)}},t.prototype.getLicense=function(){return this.license},t.prototype.setLicense=function(e){if(e!==this.license&&(null==e||e!==this.license)){var t=this.license;this.license=e,this.firePropertyChange("LICENSE",t,e)}},t.prototype.getDepth=function(){return this.depth},t.prototype.setDepth=function(e){if(!this.isResizable())throw new IllegalStateException("Piece isn't resizable");if(e!==this.depth){var t=this.depth;this.depth=e,this.shapeCache=null,this.firePropertyChange("DEPTH",t,e)}},t.prototype.getDepthInPlan=function(){return this.depthInPlan},t.prototype.setDepthInPlan=function(e){if(e!==this.depthInPlan){var t=this.depthInPlan;this.depthInPlan=e,this.shapeCache=null,this.firePropertyChange("DEPTH_IN_PLAN",t,e)}},t.prototype.getHeight=function(){return this.height},t.prototype.setHeight=function(e){if(!this.isResizable())throw new IllegalStateException("Piece isn't resizable");if(e!==this.height){var t=this.height;this.height=e,this.firePropertyChange("HEIGHT",t,e)}},t.prototype.getHeightInPlan=function(){return this.heightInPlan},t.prototype.setHeightInPlan=function(e){if(e!==this.heightInPlan){var t=this.heightInPlan;this.heightInPlan=e,this.firePropertyChange("HEIGHT_IN_PLAN",t,e)}},t.prototype.getWidth=function(){return this.width},t.prototype.setWidth=function(e){if(!this.isResizable())throw new IllegalStateException("Piece isn't resizable");if(e!==this.width){var t=this.width;this.width=e,this.shapeCache=null,this.firePropertyChange("WIDTH",t,e)}},t.prototype.getWidthInPlan=function(){return this.widthInPlan},t.prototype.setWidthInPlan=function(e){if(e!==this.widthInPlan){var t=this.widthInPlan;this.widthInPlan=e,this.shapeCache=null,this.firePropertyChange("WIDTH_IN_PLAN",t,e)}},t.prototype.scale=function(e){this.setWidth(this.getWidth()*e),this.setDepth(this.getDepth()*e),this.setHeight(this.getHeight()*e)},t.prototype.getElevation=function(){return this.elevation},t.prototype.getDropOnTopElevation=function(){return this.dropOnTopElevation},t.prototype.getGroundElevation=function(){return null!=this.level?this.elevation+this.level.getElevation():this.elevation},t.prototype.setElevation=function(e){if(e!==this.elevation){var t=this.elevation;this.elevation=e,this.firePropertyChange("ELEVATION",t,e)}},t.prototype.isMovable=function(){return this.movable},t.prototype.setMovable=function(e){e!==this.movable&&(this.movable=e,this.firePropertyChange("MOVABLE",!e,e))},t.prototype.isDoorOrWindow=function(){return this.doorOrWindow},t.prototype.getIcon=function(){return this.icon},t.prototype.setIcon=function(e){if(e!==this.icon&&(null==e||(i=e,n=this.icon,!(i&&i.equals?i.equals(n):i===n)))){var t=this.icon;this.icon=e,this.firePropertyChange("ICON",t,e)}var i,n},t.prototype.getPlanIcon=function(){return this.planIcon},t.prototype.setPlanIcon=function(e){if(e!==this.planIcon&&(null==e||(i=e,n=this.planIcon,!(i&&i.equals?i.equals(n):i===n)))){var t=this.planIcon;this.planIcon=e,this.firePropertyChange("PLAN_ICON",t,e)}var i,n},t.prototype.getModel=function(){return this.model},t.prototype.setModel=function(e){if(e!==this.model&&(null==e||(i=e,n=this.model,!(i&&i.equals?i.equals(n):i===n)))){var t=this.model;this.model=e,this.firePropertyChange("MODEL",t,e)}var i,n},t.prototype.getModelSize=function(){return this.modelSize},t.prototype.setModelSize=function(e){this.modelSize=e},t.prototype.getModelMaterials=function(){return null!=this.modelMaterials?this.modelMaterials.slice(0):null},t.prototype.setModelMaterials=function(e){if(!this.isTexturable())throw new IllegalStateException("Piece isn't texturable");if(!function(e,t){if(null==e&&null==t)return!0;if(null==e||null==t)return!1;if(e.length!=t.length)return!1;for(var i=0;i<e.length;i++)if(e[i]!=t[i])return!1;return!0}(e,this.modelMaterials)){var t=this.modelMaterials;this.modelMaterials=null!=e?e.slice(0):null,this.firePropertyChange("MODEL_MATERIALS",t,e)}},t.prototype.getColor=function(){return this.color},t.prototype.setColor=function(e){if(!this.isTexturable())throw new IllegalStateException("Piece isn't texturable");if(e!==this.color&&(null==e||e!==this.color)){var t=this.color;this.color=e,this.firePropertyChange("COLOR",t,e)}},t.prototype.getTexture=function(){return this.texture},t.prototype.setTexture=function(e){if(!this.isTexturable())throw new IllegalStateException("Piece isn't texturable");if(e!==this.texture&&(null==e||!e.equals(this.texture))){var t=this.texture;this.texture=e,this.firePropertyChange("TEXTURE",t,e)}},t.prototype.getShininess=function(){return this.shininess},t.prototype.setShininess=function(e){if(!this.isTexturable())throw new IllegalStateException("Piece isn't texturable");if(e!==this.shininess&&(null==e||e!==this.shininess)){var t=this.shininess;this.shininess=e,this.firePropertyChange("SHININESS",t,e)}},t.prototype.isResizable=function(){return this.resizable},t.prototype.isDeformable=function(){return this.deformable},t.prototype.isWidthDepthDeformable=function(){return this.isDeformable()},t.prototype.isTexturable=function(){return this.texturable},t.prototype.isHorizontallyRotatable=function(){return this.horizontallyRotatable},t.prototype.getPrice=function(){return this.price},t.prototype.setPrice=function(e){if(e!==this.price&&(null==e||!(null!=this.price?e.eq(this.price):e===this.price))){var t=this.price;this.price=e,this.firePropertyChange("PRICE",t,e)}},t.prototype.getValueAddedTaxPercentage=function(){return this.valueAddedTaxPercentage},t.prototype.setValueAddedTaxPercentage=function(e){if(e!==this.valueAddedTaxPercentage&&(null==e||!(null!=this.valueAddedTaxPercentage?e.eq(this.valueAddedTaxPercentage):e===this.valueAddedTaxPercentage))){var t=this.valueAddedTaxPercentage;this.valueAddedTaxPercentage=e,this.firePropertyChange("VALUE_ADDED_TAX_PERCENTAGE",t,e)}},t.prototype.getValueAddedTax=function(){return null!=this.price&&null!=this.valueAddedTaxPercentage?this.price.times(this.valueAddedTaxPercentage).round(2):null},t.prototype.getPriceValueAddedTaxIncluded=function(){return null!=this.price&&null!=this.valueAddedTaxPercentage?this.price.plus(this.getValueAddedTax()):this.price},t.prototype.getCurrency=function(){return this.currency},t.prototype.setCurrency=function(e){if(e!==this.currency&&(null==e||e!==this.currency)){var t=this.currency;this.currency=e,this.firePropertyChange("CURRENCY",t,e)}},t.prototype.isVisible=function(){return this.visible},t.prototype.setVisible=function(e){e!==this.visible&&(this.visible=e,this.firePropertyChange("VISIBLE",!e,e))},t.prototype.getX=function(){return this.x},t.prototype.setX=function(e){if(e!==this.x){var t=this.x;this.x=e,this.shapeCache=null,this.firePropertyChange("X",t,e)}},t.prototype.getY=function(){return this.y},t.prototype.setY=function(e){if(e!==this.y){var t=this.y;this.y=e,this.shapeCache=null,this.firePropertyChange("Y",t,e)}},t.prototype.getAngle=function(){return this.angle},t.prototype.setAngle=function(e){if((e=(e%t.TWICE_PI_$LI$()+t.TWICE_PI_$LI$())%t.TWICE_PI_$LI$())!==this.angle){var i=this.angle;this.angle=e,this.shapeCache=null,this.firePropertyChange("ANGLE",i,e)}},t.prototype.getPitch=function(){return this.pitch},t.prototype.setPitch=function(e){if(!this.isHorizontallyRotatable())throw new IllegalStateException("Piece can't be rotated around an horizontal axis");if((e=(e%t.TWICE_PI_$LI$()+t.TWICE_PI_$LI$())%t.TWICE_PI_$LI$())!==this.pitch){var i=this.pitch;this.pitch=e,this.shapeCache=null,this.firePropertyChange("PITCH",i,e)}},t.prototype.getRoll=function(){return this.roll},t.prototype.setRoll=function(e){if(!this.isHorizontallyRotatable())throw new IllegalStateException("Piece can't be rotated around an horizontal axis");if((e=(e%t.TWICE_PI_$LI$()+t.TWICE_PI_$LI$())%t.TWICE_PI_$LI$())!==this.roll){var i=this.roll;this.roll=e,this.shapeCache=null,this.firePropertyChange("ROLL",i,e)}},t.prototype.isHorizontallyRotated=function(){return 0!==this.roll||0!==this.pitch},t.prototype.getModelRotation=function(){return CatalogPieceOfFurniture.deepClone(this.modelRotation)},t.prototype.setModelRotation=function(e){if(JSON.stringify(e)!==JSON.stringify(this.modelRotation)){var t=CatalogPieceOfFurniture.deepClone(this.modelRotation);this.modelRotation=CatalogPieceOfFurniture.deepClone(e),this.firePropertyChange("MODEL_ROTATION",t,e)}},t.prototype.isModelMirrored=function(){return this.modelMirrored},t.prototype.setModelMirrored=function(e){if(!this.isResizable())throw new IllegalStateException("Piece isn't resizable");e!==this.modelMirrored&&(this.modelMirrored=e,this.firePropertyChange("MODEL_MIRRORED",!e,e))},t.prototype.isModelCenteredAtOrigin=function(){return this.modelCenteredAtOrigin},t.prototype.setModelCenteredAtOrigin=function(e){this.modelCenteredAtOrigin=e},t.prototype.isBackFaceShown=function(){return(this.modelFlags&PieceOfFurniture.SHOW_BACK_FACE)===PieceOfFurniture.SHOW_BACK_FACE},t.prototype.setBackFaceShown=function(e){this.setModelFlags(this.getModelFlags()&~PieceOfFurniture.SHOW_BACK_FACE|(e?PieceOfFurniture.SHOW_BACK_FACE:0))},t.prototype.getModelFlags=function(){return this.modelFlags},t.prototype.setModelFlags=function(e){if(e!==this.modelFlags){var t=this.modelFlags;this.modelFlags=e,this.backFaceShown=(e&PieceOfFurniture.SHOW_BACK_FACE)===PieceOfFurniture.SHOW_BACK_FACE,this.firePropertyChange("MODEL_FLAGS",t,e)}},t.prototype.getModelTransformations=function(){return null!=this.modelTransformations?this.modelTransformations.slice(0):null},t.prototype.setModelTransformations=function(e){if(!function(e,t){if(null==e&&null==t)return!0;if(null==e||null==t)return!1;if(e.length!=t.length)return!1;for(var i=0;i<e.length;i++)if(e[i]!=t[i])return!1;return!0}(e,this.modelTransformations)){var t=this.modelTransformations;this.modelTransformations=null!=e&&e.length>0?e.slice(0):null,this.firePropertyChange("MODEL_MATERIALS",t,e)}},t.prototype.getStaircaseCutOutShape=function(){return this.staircaseCutOutShape},t.prototype.setStaircaseCutOutShape=function(e){if(e!==this.staircaseCutOutShape&&(null==e||e!==this.staircaseCutOutShape)){var t=this.staircaseCutOutShape;this.staircaseCutOutShape=e,this.firePropertyChange("STAIRCASE_CUT_OUT_SHAPE",t,e)}},t.prototype.getLevel=function(){return this.level},t.prototype.setLevel=function(e){if(e!==this.level){var t=this.level;this.level=e,this.firePropertyChange("LEVEL",t,e)}},t.prototype.isAtLevel=function(e){if(this.level===e)return!0;if(null!=this.level&&null!=e){var t=this.level.getElevation(),i=e.getElevation();return t===i&&this.level.getElevationIndex()<e.getElevationIndex()||t<i&&this.isTopAtLevel(e)}return!1},t.prototype.isTopAtLevel=function(e){var t=this.level.getElevation()+this.elevation+this.heightInPlan;return null!=this.staircaseCutOutShape?t>=e.getElevation():t>e.getElevation()},t.prototype.getPoints=function(){for(var e,t=(e=function(t){if(0===t.length)return 0;for(var i=[],n=0;n<t[0];n++)i.push(e(t.slice(1)));return i})([4,2]),i=this.getShape().getPathIterator(null),n=0;n<t.length;n++)i.currentSegment(t[n]),i.next();return t},t.prototype.intersectsRectangle=function(e,t,i,n){var o=new java.awt.geom.Rectangle2D.Float(e,t,0,0);return o.add(i,n),this.getShape().intersects(o)},t.prototype.containsPoint=function(e,t,i){return 0===i?this.getShape().contains(e,t):this.getShape().intersects(e-i,t-i,2*i,2*i)},t.prototype.isPointAt=function(e,t,i){for(var n=this.getPoints(),o=0;o<n.length;o++){var r=n[o];if(Math.abs(e-r[0])<=i&&Math.abs(t-r[1])<=i)return!0}return!1},t.prototype.isTopLeftPointAt=function(e,t,i){var n=this.getPoints(),o=java.awt.geom.Point2D.distanceSq(e,t,n[0][0],n[0][1]);return o<=i*i&&o<java.awt.geom.Point2D.distanceSq(e,t,n[1][0],n[1][1])&&o<java.awt.geom.Point2D.distanceSq(e,t,n[3][0],n[3][1])},t.prototype.isTopRightPointAt=function(e,t,i){var n=this.getPoints(),o=java.awt.geom.Point2D.distanceSq(e,t,n[1][0],n[1][1]);return o<=i*i&&o<java.awt.geom.Point2D.distanceSq(e,t,n[0][0],n[0][1])&&o<java.awt.geom.Point2D.distanceSq(e,t,n[2][0],n[2][1])},t.prototype.isBottomLeftPointAt=function(e,t,i){var n=this.getPoints(),o=java.awt.geom.Point2D.distanceSq(e,t,n[3][0],n[3][1]);return o<=i*i&&o<java.awt.geom.Point2D.distanceSq(e,t,n[0][0],n[0][1])&&o<java.awt.geom.Point2D.distanceSq(e,t,n[2][0],n[2][1])},t.prototype.isBottomRightPointAt=function(e,t,i){var n=this.getPoints(),o=java.awt.geom.Point2D.distanceSq(e,t,n[2][0],n[2][1]);return o<=i*i&&o<java.awt.geom.Point2D.distanceSq(e,t,n[1][0],n[1][1])&&o<java.awt.geom.Point2D.distanceSq(e,t,n[3][0],n[3][1])},t.prototype.isNameCenterPointAt=function(e,t,i){return Math.abs(e-this.getX()-this.getNameXOffset())<=i&&Math.abs(t-this.getY()-this.getNameYOffset())<=i},t.prototype.isParallelToWall=function(e){if(null==e.getArcExtent()){var i=e.getYEnd()-e.getYStart(),n=e.getXEnd()-e.getXStart();if(0===n&&0===i)return!1;var o=Math.atan2(i,n);return(r=Math.abs(o-this.getAngle())%Math.PI)<=t.STRAIGHT_WALL_ANGLE_MARGIN_$LI$()||Math.PI-r<=t.STRAIGHT_WALL_ANGLE_MARGIN_$LI$()}var r,l=Math.PI/2+Math.atan2(e.getYArcCircleCenter()-this.getY(),e.getXArcCircleCenter()-this.getX());return(r=Math.abs(l-this.getAngle())%Math.PI)<=t.ROUND_WALL_ANGLE_MARGIN_$LI$()||Math.PI-r<=t.ROUND_WALL_ANGLE_MARGIN_$LI$()},t.prototype.getShape=function(){if(null==this.shapeCache){var e=new java.awt.geom.Rectangle2D.Float(this.getX()-this.getWidthInPlan()/2,this.getY()-this.getDepthInPlan()/2,this.getWidthInPlan(),this.getDepthInPlan()),t=java.awt.geom.AffineTransform.getRotateInstance(this.getAngle(),this.getX(),this.getY()),i=e.getPathIterator(t),n=new java.awt.geom.GeneralPath;n.append(i,!1),this.shapeCache=n}return this.shapeCache},t.prototype.move=function(e,t){this.setX(this.getX()+e),this.setY(this.getY()+t)},t.prototype.clone=function(){var t=this,i=function(i){if(null!=e.prototype.clone)return e.prototype.clone.call(t);var n=Object.create(i);for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o]);return n}(this);return i.level=null,i},t.getFurnitureComparator=function(e){return null==(i=function(e,t){null==e.entries&&(e.entries=[]);for(var i=0;i<e.entries.length;i++)if(null==e.entries[i].key&&null==t||null!=e.entries[i].key.equals&&e.entries[i].key.equals(t)||e.entries[i].key===t)return e.entries[i].value;return null}(t.SORTABLE_PROPERTY_COMPARATORS_$LI$(),e))||"function"==typeof i?i:function(e,t){return(i.compare?i.compare:i).call(i,e,t)};var i},t.__static_initialized=!1,t}(HomeObject);HomePieceOfFurniture.__class="com.eteks.sweethome3d.model.HomePieceOfFurniture",HomePieceOfFurniture.__interfaces=["com.eteks.sweethome3d.model.Selectable","com.eteks.sweethome3d.model.PieceOfFurniture","com.eteks.sweethome3d.model.Elevatable"],function(e){var t=function(){function e(e){this.collator=e}return e.prototype.compare=function(e,t){return e.catalogId===t.catalogId?0:null==e.catalogId?-1:null==t.catalogId?1:this.collator.compare(e.catalogId,t.catalogId)},e}();e.HomePieceOfFurniture$0=t;var i=function(){function e(e){this.collator=e}return e.prototype.compare=function(e,t){return e.name===t.name?0:null==e.name?-1:null==t.name?1:this.collator.compare(e.name,t.name)},e}();e.HomePieceOfFurniture$1=i;var n=function(){function e(e){this.collator=e}return e.prototype.compare=function(e,t){return e.description===t.description?0:null==e.description?-1:null==t.description?1:this.collator.compare(e.description,t.description)},e}();e.HomePieceOfFurniture$2=n;var o=function(){function e(e){this.collator=e}return e.prototype.compare=function(e,t){return e.creator===t.creator?0:null==e.creator?-1:null==t.creator?1:this.collator.compare(e.creator,t.creator)},e}();e.HomePieceOfFurniture$3=o;var r=function(){function e(e){this.collator=e}return e.prototype.compare=function(e,t){return e.license===t.license?0:null==e.license?-1:null==t.license?1:this.collator.compare(e.license,t.license)},e}();e.HomePieceOfFurniture$4=r;var l=function(){function t(){}return t.prototype.compare=function(t,i){return e.compare$float$float(t.width,i.width)},t}();e.HomePieceOfFurniture$5=l;var a=function(){function t(){}return t.prototype.compare=function(t,i){return e.compare$float$float(t.height,i.height)},t}();e.HomePieceOfFurniture$6=a;var s=function(){function t(){}return t.prototype.compare=function(t,i){return e.compare$float$float(t.depth,i.depth)},t}();e.HomePieceOfFurniture$7=s;var h=function(){function t(){}return t.prototype.compare=function(t,i){return e.compare$boolean$boolean(t.movable,i.movable)},t}();e.HomePieceOfFurniture$8=h;var u=function(){function t(){}return t.prototype.compare=function(t,i){return e.compare$boolean$boolean(t.doorOrWindow,i.doorOrWindow)},t}();e.HomePieceOfFurniture$9=u;var d=function(){function e(){}return e.prototype.compare=function(e,t){return e.color===t.color?0:null==e.color?-1:null==t.color?1:e.color-t.color},e}();e.HomePieceOfFurniture$10=d;var c=function(){function e(e){this.collator=e}return e.prototype.compare=function(e,t){return e.texture===t.texture?0:null==e.texture?-1:null==t.texture?1:this.collator.compare(e.texture.getName(),t.texture.getName())},e}();e.HomePieceOfFurniture$11=c;var p=function(){function t(){}return t.prototype.compare=function(t,i){return e.compare$boolean$boolean(t.visible,i.visible)},t}();e.HomePieceOfFurniture$12=p;var g=function(){function t(){}return t.prototype.compare=function(t,i){return e.compare$float$float(t.x,i.x)},t}();e.HomePieceOfFurniture$13=g;var m=function(){function t(){}return t.prototype.compare=function(t,i){return e.compare$float$float(t.y,i.y)},t}();e.HomePieceOfFurniture$14=m;var f=function(){function t(){}return t.prototype.compare=function(t,i){return e.compare$float$float(t.elevation,i.elevation)},t}();e.HomePieceOfFurniture$15=f;var v=function(){function t(){}return t.prototype.compare=function(t,i){return e.compare$float$float(t.angle,i.angle)},t}();e.HomePieceOfFurniture$16=v;var _=function(){function t(){}return t.prototype.compare=function(t,i){var n=e.getComparableModelSize(t),o=e.getComparableModelSize(i);return n===o?0:null==n?-1:null==o?1:n<o?-1:n===o?0:1},t}();e.HomePieceOfFurniture$17=_;var S=function(){function t(){}return t.prototype.compare=function(t,i){return e.compare$com_eteks_sweethome3d_model_Level$com_eteks_sweethome3d_model_Level(t.getLevel(),i.getLevel())},t}();e.HomePieceOfFurniture$18=S;var y=function(){function t(){}return t.prototype.compare=function(t,i){return e.compare$java_math_BigDecimal$java_math_BigDecimal(t.price,i.price)},t}();e.HomePieceOfFurniture$19=y;var E=function(){function t(){}return t.prototype.compare=function(t,i){return e.compare$java_math_BigDecimal$java_math_BigDecimal(t.valueAddedTaxPercentage,i.valueAddedTaxPercentage)},t}();e.HomePieceOfFurniture$20=E;var C=function(){function t(){}return t.prototype.compare=function(t,i){return e.compare$java_math_BigDecimal$java_math_BigDecimal(t.getValueAddedTax(),i.getValueAddedTax())},t}();e.HomePieceOfFurniture$21=C;var P=function(){function t(){}return t.prototype.compare=function(t,i){return e.compare$java_math_BigDecimal$java_math_BigDecimal(t.getPriceValueAddedTaxIncluded(),i.getPriceValueAddedTaxIncluded())},t}();e.HomePieceOfFurniture$22=P}(HomePieceOfFurniture||(HomePieceOfFurniture={})),HomePieceOfFurniture.__transients=["shapeCache","propertyChangeSupport"];var Compass=function(e){function t(t,i,n,o){var r=this;if("string"!=typeof t&&null!==t||"number"!=typeof i&&null!==i||"number"!=typeof n&&null!==n||"number"!=typeof o&&null!==o){if("number"!=typeof t&&null!==t||"number"!=typeof i&&null!==i||"number"!=typeof n&&null!==n||void 0!==o)throw new Error("invalid overload");var l=(u=arguments)[0],a=u[1],s=u[2],h=HomeObject.createId("compass");void 0===(r=e.call(this,h)||this).x&&(r.x=0),void 0===r.y&&(r.y=0),void 0===r.diameter&&(r.diameter=0),void 0===r.visible&&(r.visible=!1),void 0===r.northDirection&&(r.northDirection=0),void 0===r.latitude&&(r.latitude=0),void 0===r.longitude&&(r.longitude=0),void 0===r.timeZone&&(r.timeZone=null),void 0===r.pointsCache&&(r.pointsCache=null),void 0===r.dateCache&&(r.dateCache=null),void 0===r.sunElevationCache&&(r.sunElevationCache=0),void 0===r.sunAzimuthCache&&(r.sunAzimuthCache=0),r.x=l,r.y=a,r.diameter=s,r.visible=!0,r.timeZone="UTC",r.initGeographicPoint(),void 0===r.x&&(r.x=0),void 0===r.y&&(r.y=0),void 0===r.diameter&&(r.diameter=0),void 0===r.visible&&(r.visible=!1),void 0===r.northDirection&&(r.northDirection=0),void 0===r.latitude&&(r.latitude=0),void 0===r.longitude&&(r.longitude=0),void 0===r.timeZone&&(r.timeZone=null),void 0===r.pointsCache&&(r.pointsCache=null),void 0===r.dateCache&&(r.dateCache=null),void 0===r.sunElevationCache&&(r.sunElevationCache=0),void 0===r.sunAzimuthCache&&(r.sunAzimuthCache=0)}else{var u=arguments;void 0===(r=e.call(this,t)||this).x&&(r.x=0),void 0===r.y&&(r.y=0),void 0===r.diameter&&(r.diameter=0),void 0===r.visible&&(r.visible=!1),void 0===r.northDirection&&(r.northDirection=0),void 0===r.latitude&&(r.latitude=0),void 0===r.longitude&&(r.longitude=0),void 0===r.timeZone&&(r.timeZone=null),void 0===r.pointsCache&&(r.pointsCache=null),void 0===r.dateCache&&(r.dateCache=null),void 0===r.sunElevationCache&&(r.sunElevationCache=0),void 0===r.sunAzimuthCache&&(r.sunAzimuthCache=0),r.x=i,r.y=n,r.diameter=o,r.visible=!0,r.timeZone="UTC",r.initGeographicPoint()}return r}return __extends(t,e),t.prototype.getX=function(){return this.x},t.prototype.setX=function(e){if(e!==this.x){var t=this.x;this.x=e,this.pointsCache=null,this.firePropertyChange("X",t,e)}},t.prototype.getY=function(){return this.y},t.prototype.setY=function(e){if(e!==this.y){var t=this.y;this.y=e,this.pointsCache=null,this.firePropertyChange("Y",t,e)}},t.prototype.getDiameter=function(){return this.diameter},t.prototype.setDiameter=function(e){if(e!==this.diameter){var t=this.diameter;this.diameter=e,this.pointsCache=null,this.firePropertyChange("DIAMETER",t,e)}},t.prototype.isVisible=function(){return this.visible},t.prototype.setVisible=function(e){e!==this.visible&&(this.visible=e,this.firePropertyChange("VISIBLE",!e,e))},t.prototype.getNorthDirection=function(){return this.northDirection},t.prototype.setNorthDirection=function(e){if(e!==this.northDirection){var t=this.northDirection;this.northDirection=e,this.pointsCache=null,this.firePropertyChange("NORTH_DIRECTION",t,e)}},t.prototype.getLatitude=function(){return this.latitude},t.prototype.setLatitude=function(e){if(e!==this.latitude){var t=this.latitude;this.latitude=e,this.dateCache=null,this.firePropertyChange("LATITUDE",t,e)}},t.prototype.getLongitude=function(){return this.longitude},t.prototype.setLongitude=function(e){if(e!==this.longitude){var t=this.longitude;this.longitude=e,this.dateCache=null,this.firePropertyChange("LONGITUDE",t,e)}},t.prototype.getTimeZone=function(){return this.timeZone},t.prototype.setTimeZone=function(e){if(this.timeZone!==e){if(null==e)throw new IllegalArgumentException("Time zone ID can't be null");var t=this.timeZone;this.timeZone=e,this.dateCache=null,this.firePropertyChange("TIME_ZONE",t,e)}},t.prototype.getPoints=function(){if(null==this.pointsCache){var e=new java.awt.geom.Rectangle2D.Float(this.getX()-this.getDiameter()/2,this.getY()-this.getDiameter()/2,this.getDiameter(),this.getDiameter()),t=java.awt.geom.AffineTransform.getRotateInstance(this.getNorthDirection(),this.getX(),this.getY());this.pointsCache=(o=function(e){if(0===e.length)return 0;for(var t=[],i=0;i<e[0];i++)t.push(o(e.slice(1)));return t})([4,2]);for(var i=e.getPathIterator(t),n=0;n<this.pointsCache.length;n++)i.currentSegment(this.pointsCache[n]),i.next()}var o;return[this.pointsCache[0].slice(0),this.pointsCache[1].slice(0),this.pointsCache[2].slice(0),this.pointsCache[3].slice(0)]},t.prototype.intersectsRectangle=function(e,t,i,n){var o=new java.awt.geom.Rectangle2D.Float(e,t,0,0);return o.add(i,n),new java.awt.geom.Ellipse2D.Float(this.getX()-this.getDiameter()/2,this.getY()-this.getDiameter()/2,this.getDiameter(),this.getDiameter()).intersects(o)},t.prototype.containsPoint=function(e,t,i){var n=new java.awt.geom.Ellipse2D.Float(this.getX()-this.getDiameter()/2,this.getY()-this.getDiameter()/2,this.getDiameter(),this.getDiameter());return 0===i?n.contains(e,t):n.intersects(e-i,t-i,2*i,2*i)},t.prototype.move=function(e,t){this.setX(this.getX()+e),this.setY(this.getY()+t)},t.prototype.clone=function(){var t=this;return function(i){if(null!=e.prototype.clone)return e.prototype.clone.call(t);var n=Object.create(i);for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o]);return n}(this)},t.prototype.computeJulianDay=function(e,t,i,n,o,r,l,a){1!==t&&2!==t||(e-=1,t+=12);var s=e/100|0,h=(365.25*(e+4716)|0)+(30.6001*(t+1)|0)+(i+n/24+o/1440+r/86400)+(2-s+(s/4|0))-1524.5;return h-=(l+a)/24,h-=2451545},t.prototype.toSiderealTime=function(e){var t=e/36525,i=(24110.54841+8640184.812866*t+.093104*Math.pow(t,2)-62e-7*Math.pow(t,3))/3600;return 24*(i/24-(i/24|0))},t.prototype.initGeographicPoint=function(){var e;if(null==(e=null!=t.timeZoneGeographicPointsReference?t.timeZoneGeographicPointsReference:null)){e={};var i=new t.GeographicPoint(-13.833333,-171.73334);e["Etc/GMT+11"]=i,e["Pacific/Apia"]=i,e["Pacific/Midway"]=new t.GeographicPoint(28.2,-177.35),e["Pacific/Niue"]=new t.GeographicPoint(-19.055,-169.92),e["Pacific/Pago_Pago"]=new t.GeographicPoint(-14.278055,-170.7025),e["Pacific/Samoa"]=i,e["US/Samoa"]=i,e["America/Adak"]=new t.GeographicPoint(51.88,-176.65805),e["America/Atka"]=new t.GeographicPoint(52.19611,-174.20056);var n=new t.GeographicPoint(21.306944,-157.85834);e["Etc/GMT+10"]=n,e["Pacific/Fakaofo"]=new t.GeographicPoint(-9.3653,-171.215),e["Pacific/Honolulu"]=n,e["Pacific/Johnston"]=new t.GeographicPoint(16.75,-169.517),e["Pacific/Rarotonga"]=new t.GeographicPoint(-21.233,-159.783),e["Pacific/Tahiti"]=new t.GeographicPoint(-17.533333,-149.56667),e["SystemV/HST10"]=n,e["US/Aleutian"]=new t.GeographicPoint(54.817,164.033),e["US/Hawaii"]=n,e["Pacific/Marquesas"]=new t.GeographicPoint(-9.45,-139.38);var o=new t.GeographicPoint(61.218056,-149.90028);e["America/Anchorage"]=o,e["America/Juneau"]=new t.GeographicPoint(58.301945,-134.41972),e["America/Nome"]=new t.GeographicPoint(64.501114,-165.40639),e["America/Yakutat"]=new t.GeographicPoint(59.546944,-139.72722),e["Etc/GMT+9"]=o,e["Pacific/Gambier"]=new t.GeographicPoint(-23.1178,-134.97),e["SystemV/YST9"]=o,e["SystemV/YST9YDT"]=o,e["US/Alaska"]=o,e["America/Dawson"]=new t.GeographicPoint(64.066666,-139.41667),e["America/Ensenada"]=new t.GeographicPoint(31.866667,-116.61667);var r=new t.GeographicPoint(34.052223,-118.242775);e["America/Los_Angeles"]=r,e["America/Santa_Isabel"]=new t.GeographicPoint(28.383333,-113.35),e["America/Tijuana"]=new t.GeographicPoint(32.533333,-117.01667),e["America/Vancouver"]=new t.GeographicPoint(49.25,-123.13333),e["America/Whitehorse"]=new t.GeographicPoint(60.716667,-135.05),e["Canada/Pacific"]=new t.GeographicPoint(49.25,-123.13333),e["Canada/Yukon"]=new t.GeographicPoint(60.716667,-135.05),e["Etc/GMT+8"]=r,e["Mexico/BajaNorte"]=new t.GeographicPoint(32.533333,-117.01667),e["Pacific/Pitcairn"]=new t.GeographicPoint(-25.0667,-130.1),e["SystemV/PST8"]=r,e["SystemV/PST8PDT"]=r,e["US/Pacific"]=r,e["US/Pacific-New"]=r,e["America/Boise"]=new t.GeographicPoint(43.61361,-116.2025),e["America/Cambridge_Bay"]=new t.GeographicPoint(69.11667,-105.03333),e["America/Chihuahua"]=new t.GeographicPoint(28.633333,-106.083336),e["America/Dawson_Creek"]=new t.GeographicPoint(55.766666,-120.23333);var l=new t.GeographicPoint(39.739166,-104.98417);e["America/Denver"]=l,e["America/Edmonton"]=new t.GeographicPoint(53.55,-113.5),e["America/Hermosillo"]=new t.GeographicPoint(29.066668,-110.96667),e["America/Inuvik"]=new t.GeographicPoint(68.35,-133.7),e["America/Mazatlan"]=new t.GeographicPoint(23.216667,-106.416664),e["America/Ojinaga"]=new t.GeographicPoint(29.566668,-104.416664),e["America/Phoenix"]=new t.GeographicPoint(33.448334,-112.07333),e["America/Shiprock"]=new t.GeographicPoint(36.785557,-108.686386),e["America/Yellowknife"]=new t.GeographicPoint(62.45,-114.35),e["Canada/Mountain"]=new t.GeographicPoint(53.55,-113.5),e["Etc/GMT+7"]=l,e["Mexico/BajaSur"]=new t.GeographicPoint(32.567,-116.633),e["SystemV/MST7"]=l,e["SystemV/MST7MDT"]=l,e["US/Arizona"]=new t.GeographicPoint(33.448334,-112.07333),e["US/Mountain"]=l,e["America/Belize"]=new t.GeographicPoint(17.483334,-88.183334),e["America/Cancun"]=new t.GeographicPoint(21.166668,-86.833336);var a=new t.GeographicPoint(41.85,-87.65);e["America/Chicago"]=a,e["America/Costa_Rica"]=new t.GeographicPoint(9.933333,-84.083336),e["America/El_Salvador"]=new t.GeographicPoint(13.7086115,-89.20306),e["America/Guatemala"]=new t.GeographicPoint(14.621111,-90.52695),e["America/Knox_IN"]=new t.GeographicPoint(41.295834,-86.625),e["America/Managua"]=new t.GeographicPoint(12.150833,-86.26833),e["America/Matamoros"]=new t.GeographicPoint(25.883333,-97.5),e["America/Menominee"]=new t.GeographicPoint(45.107777,-87.61417),e["America/Merida"]=new t.GeographicPoint(20.966667,-89.61667),e["America/Mexico_City"]=new t.GeographicPoint(19.434168,-99.13861),e["America/Monterrey"]=new t.GeographicPoint(25.666668,-100.316666),e["America/Rainy_River"]=new t.GeographicPoint(48.716667,-94.566666),e["America/Rankin_Inlet"]=new t.GeographicPoint(62.816666,-92.083336),e["America/Regina"]=new t.GeographicPoint(50.45,-104.61667),e["America/Swift_Current"]=new t.GeographicPoint(50.283333,-107.76667),e["America/Tegucigalpa"]=new t.GeographicPoint(14.1,-87.21667),e["America/Winnipeg"]=new t.GeographicPoint(49.88333,-97.166664),e["Canada/Central"]=new t.GeographicPoint(50.45,-104.61667),e["Canada/East-Saskatchewan"]=new t.GeographicPoint(51.216667,-102.46667),e["Canada/Saskatchewan"]=new t.GeographicPoint(50.45,-104.61667),e["Chile/EasterIsland"]=new t.GeographicPoint(-27.15,-109.425),e["Etc/GMT+6"]=a,e["Mexico/General"]=new t.GeographicPoint(19.434168,-99.13861),e["Pacific/Easter"]=new t.GeographicPoint(-27.15,-109.425),e["Pacific/Galapagos"]=new t.GeographicPoint(-.667,-90.55),e["SystemV/CST6"]=a,e["SystemV/CST6CDT"]=a,e["US/Central"]=a,e["US/Indiana-Starke"]=new t.GeographicPoint(41.295834,-86.625),e["America/Atikokan"]=new t.GeographicPoint(48.75,-91.61667),e["America/Bogota"]=new t.GeographicPoint(4.6,-74.083336),e["America/Cayman"]=new t.GeographicPoint(19.3,-81.38333),e["America/Coral_Harbour"]=new t.GeographicPoint(64.13333,-83.166664),e["America/Detroit"]=new t.GeographicPoint(42.33139,-83.04583),e["America/Fort_Wayne"]=new t.GeographicPoint(41.130554,-85.12889),e["America/Grand_Turk"]=new t.GeographicPoint(21.466667,-71.13333),e["America/Guayaquil"]=new t.GeographicPoint(-2.1666667,-79.9),e["America/Havana"]=new t.GeographicPoint(23.131945,-82.36417),e["America/Indianapolis"]=new t.GeographicPoint(39.768333,-86.15806),e["America/Iqaluit"]=new t.GeographicPoint(63.733334,-68.5),e["America/Jamaica"]=new t.GeographicPoint(18,-76.8),e["America/Lima"]=new t.GeographicPoint(-12.05,-77.05),e["America/Louisville"]=new t.GeographicPoint(38.254166,-85.759445),e["America/Montreal"]=new t.GeographicPoint(45.5,-73.583336),e["America/Nassau"]=new t.GeographicPoint(25.083334,-77.35);var s=new t.GeographicPoint(40.71417,-74.006386);e["America/New_York"]=s,e["America/Nipigon"]=new t.GeographicPoint(49.016666,-88.25),e["America/Panama"]=new t.GeographicPoint(8.966667,-79.53333),e["America/Pangnirtung"]=new t.GeographicPoint(66.13333,-65.75),e["America/Port-au-Prince"]=new t.GeographicPoint(18.539167,-72.335),e["America/Resolute"]=new t.GeographicPoint(74.683334,-94.9),e["America/Thunder_Bay"]=new t.GeographicPoint(48.4,-89.23333),e["America/Toronto"]=new t.GeographicPoint(43.666668,-79.416664),e["Canada/Eastern"]=new t.GeographicPoint(43.666668,-79.416664),e["Etc/GMT+5"]=s,e["SystemV/EST5"]=s,e["SystemV/EST5EDT"]=s,e["US/East-Indiana"]=new t.GeographicPoint(36.8381,-84.85),e["US/Eastern"]=s,e["US/Michigan"]=new t.GeographicPoint(42.33139,-83.04583),e["America/Caracas"]=new t.GeographicPoint(10.5,-66.916664),e["America/Anguilla"]=new t.GeographicPoint(18.216667,-63.05),e["America/Antigua"]=new t.GeographicPoint(17.116667,-61.85),e["America/Aruba"]=new t.GeographicPoint(10.541111,-72.9175),e["America/Asuncion"]=new t.GeographicPoint(-25.266666,-57.666668),e["America/Barbados"]=new t.GeographicPoint(13.1,-59.616665),e["America/Blanc-Sablon"]=new t.GeographicPoint(51.433334,-57.11667),e["America/Boa_Vista"]=new t.GeographicPoint(2.8166666,-60.666668),e["America/Campo_Grande"]=new t.GeographicPoint(-20.45,-54.616665),e["America/Cuiaba"]=new t.GeographicPoint(-15.583333,-56.083332),e["America/Curacao"]=new t.GeographicPoint(12.1167,-68.933),e["America/Dominica"]=new t.GeographicPoint(15.3,-61.4),e["America/Eirunepe"]=new t.GeographicPoint(-6.6666665,-69.86667),e["America/Glace_Bay"]=new t.GeographicPoint(46.2,-59.966667),e["America/Goose_Bay"]=new t.GeographicPoint(53.333332,-60.416668),e["America/Grenada"]=new t.GeographicPoint(12.05,-61.75),e["America/Guadeloupe"]=new t.GeographicPoint(16.233334,-61.516666),e["America/Guyana"]=new t.GeographicPoint(6.8,-58.166668),e["America/Halifax"]=new t.GeographicPoint(44.65,-63.6),e["America/La_Paz"]=new t.GeographicPoint(-16.5,-68.15),e["America/Manaus"]=new t.GeographicPoint(-3.1133332,-60.025276),e["America/Marigot"]=new t.GeographicPoint(18.073,63.0844),e["America/Martinique"]=new t.GeographicPoint(14.6,-61.083332),e["America/Moncton"]=new t.GeographicPoint(46.083332,-64.76667),e["America/Montserrat"]=new t.GeographicPoint(16.7,-62.216667),e["America/Port_of_Spain"]=new t.GeographicPoint(10.65,-61.516666),e["America/Porto_Acre"]=new t.GeographicPoint(-9.587778,-67.53555),e["America/Porto_Velho"]=new t.GeographicPoint(-8.766666,-63.9),e["America/Puerto_Rico"]=new t.GeographicPoint(18.467,66.117),e["America/Rio_Branco"]=new t.GeographicPoint(-9.966667,-67.8);var h=new t.GeographicPoint(-33.45,-70.666664);e["America/Santiago"]=h,e["America/Santo_Domingo"]=new t.GeographicPoint(18.466667,-69.9),e["America/St_Barthelemy"]=new t.GeographicPoint(17.8978,-62.851),e["America/St_Kitts"]=new t.GeographicPoint(17.3,-62.733),e["America/St_Lucia"]=new t.GeographicPoint(14.0167,-60.9833),e["America/St_Thomas"]=new t.GeographicPoint(18.3333,-64.9167),e["America/St_Vincent"]=new t.GeographicPoint(13.1667,-61.2333),e["America/Thule"]=new t.GeographicPoint(-54.27667,-36.511665),e["America/Tortola"]=new t.GeographicPoint(18.416666,-64.61667),e["America/Virgin"]=new t.GeographicPoint(18.34389,-64.931114),e["Antarctica/Palmer"]=new t.GeographicPoint(-64.25,-62.833),e["Atlantic/Bermuda"]=new t.GeographicPoint(32.294167,-64.78389),e["Atlantic/Stanley"]=new t.GeographicPoint(-51.7,-57.85),e["Brazil/Acre"]=new t.GeographicPoint(-10.883333,-45.083332),e["Brazil/West"]=new t.GeographicPoint(-10.883333,-45.083332),e["Canada/Atlantic"]=new t.GeographicPoint(44.65,-63.6),e["Chile/Continental"]=h,e["Etc/GMT+4"]=h,e["SystemV/AST4"]=new t.GeographicPoint(44.65,-63.6),e["SystemV/AST4ADT"]=new t.GeographicPoint(44.65,-63.6),e["America/St_Johns"]=new t.GeographicPoint(47.5675,-52.7072),e["Canada/Newfoundland"]=new t.GeographicPoint(47.5675,-52.7072),e["America/Araguaina"]=new t.GeographicPoint(-7.16,-48.0575),e["America/Bahia"]=new t.GeographicPoint(-12.983334,-38.516666),e["America/Belem"]=new t.GeographicPoint(-1.45,-48.483334),e["America/Buenos_Aires"]=new t.GeographicPoint(-34.5875,-58.6725),e["America/Catamarca"]=new t.GeographicPoint(-28.466667,-65.78333),e["America/Cayenne"]=new t.GeographicPoint(4.9333334,-52.333332),e["America/Cordoba"]=new t.GeographicPoint(-31.4,-64.183334),e["America/Fortaleza"]=new t.GeographicPoint(-3.7166667,-38.5),e["America/Godthab"]=new t.GeographicPoint(64.183334,-51.75),e["America/Jujuy"]=new t.GeographicPoint(-24.183332,-65.3),e["America/Maceio"]=new t.GeographicPoint(-9.666667,-35.716667),e["America/Mendoza"]=new t.GeographicPoint(-32.883335,-68.816666),e["America/Miquelon"]=new t.GeographicPoint(47.0975,-56.38139),e["America/Montevideo"]=new t.GeographicPoint(-34.858055,-56.170834),e["America/Paramaribo"]=new t.GeographicPoint(5.8333335,-55.166668),e["America/Recife"]=new t.GeographicPoint(-8.05,-34.9),e["America/Rosario"]=new t.GeographicPoint(-32.95111,-60.66639),e["America/Santarem"]=new t.GeographicPoint(-2.4333334,-54.7);var u=new t.GeographicPoint(-23.533333,-46.616665);e["America/Sao_Paulo"]=u,e["Antarctica/Rothera"]=new t.GeographicPoint(67.567,68.133),e["Brazil/East"]=u,e["Etc/GMT+3"]=u,e["America/Noronha"]=new t.GeographicPoint(3.85,25.417);var d=new t.GeographicPoint(54.25,36.75);e["Atlantic/South_Georgia"]=d,e["Brazil/DeNoronha"]=new t.GeographicPoint(3.85,25.417),e["Etc/GMT+2"]=d,e["America/Scoresbysund"]=new t.GeographicPoint(70.48333,-21.966667);var c=new t.GeographicPoint(37.483334,-2.5666666);e["Atlantic/Azores"]=c,e["Atlantic/Cape_Verde"]=new t.GeographicPoint(14.916667,-23.516666),e["Etc/GMT+1"]=c,e["Africa/Abidjan"]=new t.GeographicPoint(5.341111,-4.028056),e["Africa/Accra"]=new t.GeographicPoint(5.55,-.2166667),e["Africa/Bamako"]=new t.GeographicPoint(12.65,-8),e["Africa/Banjul"]=new t.GeographicPoint(13.453055,-16.5775),e["Africa/Bissau"]=new t.GeographicPoint(11.85,-15.583333),e["Africa/Casablanca"]=new t.GeographicPoint(33.593056,-7.616389),e["Africa/Conakry"]=new t.GeographicPoint(9.509167,-13.712222),e["Africa/Dakar"]=new t.GeographicPoint(14.670834,-17.438055),e["Africa/El_Aaiun"]=new t.GeographicPoint(27.15361,-13.203333),e["Africa/Freetown"]=new t.GeographicPoint(8.49,-13.234167),e["Africa/Lome"]=new t.GeographicPoint(6.131944,1.2227778),e["Africa/Monrovia"]=new t.GeographicPoint(6.3105555,-10.804722),e["Africa/Nouakchott"]=new t.GeographicPoint(18.08639,-15.975278),e["Africa/Ouagadougou"]=new t.GeographicPoint(12.370277,-1.5247222),e["Africa/Sao_Tome"]=new t.GeographicPoint(.3333333,6.733333),e["Africa/Timbuktu"]=new t.GeographicPoint(16.766666,-3.0166667),e["America/Danmarkshavn"]=new t.GeographicPoint(76.767,18.667),e["Atlantic/Canary"]=new t.GeographicPoint(28.45,-16.233334),e["Atlantic/Faeroe"]=new t.GeographicPoint(62.016666,-6.766667),e["Atlantic/Faroe"]=new t.GeographicPoint(62.016666,-6.766667),e["Atlantic/Madeira"]=new t.GeographicPoint(32.633335,-16.9),e["Atlantic/Reykjavik"]=new t.GeographicPoint(64.15,-21.95),e["Atlantic/St_Helena"]=new t.GeographicPoint(-15.933333,-5.7166667);var p=new t.GeographicPoint(51.466667,0);e["Etc/GMT"]=p,e["Etc/GMT+0"]=p,e["Etc/GMT-0"]=p,e["Etc/GMT0"]=p,e["Etc/Greenwich"]=p,e["Etc/UCT"]=p,e["Etc/UTC"]=p,e["Etc/Universal"]=p,e["Etc/Zulu"]=p,e["Europe/Belfast"]=new t.GeographicPoint(54.583332,-5.933333),e["Europe/Dublin"]=new t.GeographicPoint(53.333057,-6.248889),e["Europe/Guernsey"]=new t.GeographicPoint(49.45,-2.533),e["Europe/Isle_of_Man"]=new t.GeographicPoint(54.14521,-4.48172),e["Europe/Jersey"]=new t.GeographicPoint(49.2,-2.117),e["Europe/Lisbon"]=new t.GeographicPoint(38.716667,-9.133333),e["Europe/London"]=new t.GeographicPoint(51.5,-.116667),e["Africa/Algiers"]=new t.GeographicPoint(36.763054,3.0505557),e["Africa/Bangui"]=new t.GeographicPoint(4.366667,18.583334),e["Africa/Brazzaville"]=new t.GeographicPoint(-4.2591667,15.284722),e["Africa/Ceuta"]=new t.GeographicPoint(35.890278,-5.3075),e["Africa/Douala"]=new t.GeographicPoint(4.0502777,9.7),e["Africa/Kinshasa"]=new t.GeographicPoint(-4.3,15.3),e["Africa/Lagos"]=new t.GeographicPoint(6.4530554,3.3958333),e["Africa/Libreville"]=new t.GeographicPoint(.3833333,9.45),e["Africa/Luanda"]=new t.GeographicPoint(-8.838333,13.234445),e["Africa/Malabo"]=new t.GeographicPoint(3.75,8.783333),e["Africa/Ndjamena"]=new t.GeographicPoint(12.113055,15.049167),e["Africa/Niamey"]=new t.GeographicPoint(13.516666,2.1166668),e["Africa/Porto-Novo"]=new t.GeographicPoint(6.483333,2.6166668),e["Africa/Tunis"]=new t.GeographicPoint(36.802776,10.179722),e["Africa/Windhoek"]=new t.GeographicPoint(-22.57,17.08361),e["Arctic/Longyearbyen"]=new t.GeographicPoint(78.21667,15.633333),e["Atlantic/Jan_Mayen"]=new t.GeographicPoint(71,-8.333);var g=new t.GeographicPoint(48.86667,2.333333);e["Etc/GMT-1"]=g,e["Europe/Amsterdam"]=new t.GeographicPoint(52.35,4.9166665),e["Europe/Andorra"]=new t.GeographicPoint(42.5,1.5166667),e["Europe/Belgrade"]=new t.GeographicPoint(44.81861,20.468056),e["Europe/Berlin"]=new t.GeographicPoint(52.516666,13.4),e["Europe/Bratislava"]=new t.GeographicPoint(48.15,17.116667),e["Europe/Brussels"]=new t.GeographicPoint(50.833332,4.333333),e["Europe/Budapest"]=new t.GeographicPoint(47.5,19.083334),e["Europe/Copenhagen"]=new t.GeographicPoint(55.666668,12.583333),e["Europe/Gibraltar"]=new t.GeographicPoint(36.133335,-5.35),e["Europe/Ljubljana"]=new t.GeographicPoint(46.05528,14.514444),e["Europe/Luxembourg"]=new t.GeographicPoint(49.611668,6.13),e["Europe/Madrid"]=new t.GeographicPoint(40.4,-3.6833334),e["Europe/Malta"]=new t.GeographicPoint(35.899723,14.514722),e["Europe/Monaco"]=new t.GeographicPoint(43.733334,7.4166665),e["Europe/Oslo"]=new t.GeographicPoint(59.916668,10.75),e["Europe/Paris"]=g,e["Europe/Podgorica"]=new t.GeographicPoint(42.441113,19.26361),e["Europe/Prague"]=new t.GeographicPoint(50.083332,14.466667),e["Europe/Rome"]=new t.GeographicPoint(41.9,12.483334),e["Europe/San_Marino"]=new t.GeographicPoint(43.933334,12.45),e["Europe/Sarajevo"]=new t.GeographicPoint(43.85,18.383333),e["Europe/Skopje"]=new t.GeographicPoint(42,21.433332),e["Europe/Stockholm"]=new t.GeographicPoint(59.333332,18.05),e["Europe/Tirane"]=new t.GeographicPoint(41.3275,19.81889),e["Europe/Vaduz"]=new t.GeographicPoint(47.133335,9.516666),e["Europe/Vatican"]=new t.GeographicPoint(41.9,12.45),e["Europe/Vienna"]=new t.GeographicPoint(48.2,16.366667),e["Europe/Warsaw"]=new t.GeographicPoint(52.25,21),e["Europe/Zagreb"]=new t.GeographicPoint(45.8,16),e["Europe/Zurich"]=new t.GeographicPoint(47.366665,8.55),e["Africa/Blantyre"]=new t.GeographicPoint(-15.783333,35),e["Africa/Bujumbura"]=new t.GeographicPoint(-3.376111,29.36),e["Africa/Cairo"]=new t.GeographicPoint(30.05,31.25),e["Africa/Gaborone"]=new t.GeographicPoint(-24.646389,25.911945),e["Africa/Harare"]=new t.GeographicPoint(-17.817778,31.044722),e["Africa/Johannesburg"]=new t.GeographicPoint(-26.2,28.083334),e["Africa/Kigali"]=new t.GeographicPoint(-1.9536111,30.060556),e["Africa/Lubumbashi"]=new t.GeographicPoint(-11.666667,27.466667),e["Africa/Lusaka"]=new t.GeographicPoint(-15.416667,28.283333),e["Africa/Maputo"]=new t.GeographicPoint(-25.965279,32.58917),e["Africa/Maseru"]=new t.GeographicPoint(-29.316668,27.483334),e["Africa/Mbabane"]=new t.GeographicPoint(-26.316668,31.133333),e["Africa/Tripoli"]=new t.GeographicPoint(32.8925,13.18),e["Asia/Amman"]=new t.GeographicPoint(31.95,35.933334),e["Asia/Beirut"]=new t.GeographicPoint(33.871944,35.509724),e["Asia/Damascus"]=new t.GeographicPoint(33.5,36.3),e["Asia/Gaza"]=new t.GeographicPoint(31.5,34.466667),e["Asia/Istanbul"]=new t.GeographicPoint(41.018612,28.964722),e["Asia/Jerusalem"]=new t.GeographicPoint(31.78,35.23),e["Asia/Nicosia"]=new t.GeographicPoint(35.166668,33.366665),e["Asia/Tel_Aviv"]=new t.GeographicPoint(32.066666,34.766666);var m=new t.GeographicPoint(37.983334,23.733334);e["Etc/GMT-2"]=m,e["Europe/Athens"]=new t.GeographicPoint(37.983334,23.733334),e["Europe/Bucharest"]=new t.GeographicPoint(44.433334,26.1),e["Europe/Chisinau"]=new t.GeographicPoint(47.005554,28.8575),e["Europe/Helsinki"]=new t.GeographicPoint(60.175556,24.934166),e["Europe/Istanbul"]=new t.GeographicPoint(41.018612,28.964722),e["Europe/Kaliningrad"]=new t.GeographicPoint(54.71,20.5),e["Europe/Kiev"]=new t.GeographicPoint(50.433334,30.516666),e["Europe/Mariehamn"]=new t.GeographicPoint(60.1,19.95),e["Europe/Minsk"]=new t.GeographicPoint(53.9,27.566668),e["Europe/Nicosia"]=new t.GeographicPoint(35.166668,33.366665),e["Europe/Riga"]=new t.GeographicPoint(56.95,24.1),e["Europe/Simferopol"]=new t.GeographicPoint(44.95,34.1),e["Europe/Sofia"]=new t.GeographicPoint(42.683334,23.316668),e["Europe/Tallinn"]=new t.GeographicPoint(59.433887,24.728056),e["Europe/Tiraspol"]=new t.GeographicPoint(46.84028,29.643333),e["Europe/Uzhgorod"]=new t.GeographicPoint(48.616665,22.3),e["Europe/Vilnius"]=new t.GeographicPoint(54.683334,25.316668),e["Europe/Zaporozhye"]=new t.GeographicPoint(47.833,35.1667),e["Africa/Addis_Ababa"]=new t.GeographicPoint(9.033333,38.7),e["Africa/Asmara"]=new t.GeographicPoint(15.333333,38.933334),e["Africa/Asmera"]=new t.GeographicPoint(15.333333,38.933334),e["Africa/Dar_es_Salaam"]=new t.GeographicPoint(-6.8,39.283333),e["Africa/Djibouti"]=new t.GeographicPoint(11.595,43.148056),e["Africa/Kampala"]=new t.GeographicPoint(.3155556,32.565556),e["Africa/Khartoum"]=new t.GeographicPoint(15.588056,32.53417),e["Africa/Mogadishu"]=new t.GeographicPoint(2.0666666,45.366665),e["Africa/Nairobi"]=new t.GeographicPoint(-1.2833333,36.816666),e["Antarctica/Syowa"]=new t.GeographicPoint(-69,39.5833),e["Asia/Aden"]=new t.GeographicPoint(12.779445,45.036667),e["Asia/Baghdad"]=new t.GeographicPoint(33.33861,44.39389),e["Asia/Bahrain"]=new t.GeographicPoint(26.23611,50.583057),e["Asia/Kuwait"]=new t.GeographicPoint(29.369722,47.978333),e["Asia/Qatar"]=new t.GeographicPoint(25.286667,51.533333),e["Asia/Riyadh"]=new t.GeographicPoint(24.640833,46.772778);var f=new t.GeographicPoint(55.752224,37.615555);e["Etc/GMT-3"]=f,e["Europe/Moscow"]=f,e["Europe/Volgograd"]=new t.GeographicPoint(48.80472,44.585835),e["Indian/Antananarivo"]=new t.GeographicPoint(-18.916666,47.516666),e["Indian/Comoro"]=new t.GeographicPoint(-11.704166,43.240276),e["Indian/Mayotte"]=new t.GeographicPoint(-12.779445,45.227222),e["Asia/Riyadh87"]=new t.GeographicPoint(24.640833,46.772778),e["Asia/Riyadh88"]=new t.GeographicPoint(24.640833,46.772778),e["Asia/Riyadh89"]=new t.GeographicPoint(24.640833,46.772778),e["Mideast/Riyadh87"]=new t.GeographicPoint(24.640833,46.772778),e["Mideast/Riyadh88"]=new t.GeographicPoint(24.640833,46.772778),e["Mideast/Riyadh89"]=new t.GeographicPoint(24.640833,46.772778),e["Asia/Tehran"]=new t.GeographicPoint(35.671944,51.424446),e["Asia/Baku"]=new t.GeographicPoint(40.39528,49.88222);var v=new t.GeographicPoint(25.252222,55.28);e["Asia/Dubai"]=v,e["Asia/Muscat"]=new t.GeographicPoint(23.613333,58.593334),e["Asia/Tbilisi"]=new t.GeographicPoint(41.725,44.790833),e["Asia/Yerevan"]=new t.GeographicPoint(40.18111,44.51361),e["Etc/GMT-4"]=v,e["Europe/Samara"]=new t.GeographicPoint(53.2,50.15),e["Indian/Mahe"]=new t.GeographicPoint(-4.616667,55.45),e["Indian/Mauritius"]=new t.GeographicPoint(-20.161945,57.49889),e["Indian/Reunion"]=new t.GeographicPoint(-20.866667,55.466667),e["Asia/Kabul"]=new t.GeographicPoint(34.516666,69.183334),e["Antarctica/Davis"]=new t.GeographicPoint(-68.5764,77.9689),e["Antarctica/Mawson"]=new t.GeographicPoint(-53.104,73.514),e["Asia/Aqtau"]=new t.GeographicPoint(43.65,51.2),e["Asia/Aqtobe"]=new t.GeographicPoint(50.298054,57.18139),e["Asia/Ashgabat"]=new t.GeographicPoint(37.95,58.383335),e["Asia/Ashkhabad"]=new t.GeographicPoint(37.95,58.383335),e["Asia/Dushanbe"]=new t.GeographicPoint(38.56,68.77389),e["Asia/Karachi"]=new t.GeographicPoint(24.866667,67.05),e["Asia/Oral"]=new t.GeographicPoint(51.233334,51.366665),e["Asia/Samarkand"]=new t.GeographicPoint(39.654167,66.959724),e["Asia/Tashkent"]=new t.GeographicPoint(41.316666,69.25),e["Asia/Yekaterinburg"]=new t.GeographicPoint(56.85,60.6);var _=new t.GeographicPoint(22.569721,88.36972);e["Etc/GMT-5"]=_,e["Indian/Kerguelen"]=new t.GeographicPoint(-49.25,69.583),e["Indian/Maldives"]=new t.GeographicPoint(4.1666665,73.5),e["Asia/Calcutta"]=_,e["Asia/Colombo"]=new t.GeographicPoint(6.9319444,79.84778),e["Asia/Kolkata"]=_,e["Asia/Kathmandu"]=new t.GeographicPoint(27.716667,85.316666),e["Asia/Katmandu"]=new t.GeographicPoint(27.716667,85.316666),e["Antarctica/Vostok"]=new t.GeographicPoint(-78.4644,106.8372),e["Asia/Almaty"]=new t.GeographicPoint(43.25,76.95),e["Asia/Bishkek"]=new t.GeographicPoint(42.873055,74.60028);var S=new t.GeographicPoint(23.723055,90.40861);e["Asia/Dacca"]=S,e["Asia/Dhaka"]=S,e["Asia/Novokuznetsk"]=new t.GeographicPoint(53.75,87.1),e["Asia/Novosibirsk"]=new t.GeographicPoint(55.04111,82.93444),e["Asia/Omsk"]=new t.GeographicPoint(55,73.4),e["Asia/Qyzylorda"]=new t.GeographicPoint(44.85278,65.50916),e["Asia/Thimbu"]=new t.GeographicPoint(27.483334,89.6),e["Asia/Thimphu"]=new t.GeographicPoint(27.483334,89.6),e["Etc/GMT-6"]=S,e["Indian/Chagos"]=new t.GeographicPoint(-6,71.5),e["Asia/Rangoon"]=new t.GeographicPoint(16.783333,96.166664),e["Indian/Cocos"]=new t.GeographicPoint(-12.1167,96.9);var y=new t.GeographicPoint(13.75,100.51667);e["Asia/Bangkok"]=y,e["Asia/Ho_Chi_Minh"]=new t.GeographicPoint(10.75,106.666664),e["Asia/Hovd"]=new t.GeographicPoint(48.016666,91.63333),e["Asia/Jakarta"]=new t.GeographicPoint(-6.174444,106.829445),e["Asia/Krasnoyarsk"]=new t.GeographicPoint(56.009724,92.791664),e["Asia/Phnom_Penh"]=new t.GeographicPoint(11.55,104.916664),e["Asia/Pontianak"]=new t.GeographicPoint(-.0333333,109.333336),e["Asia/Saigon"]=new t.GeographicPoint(10.75,106.666664),e["Asia/Vientiane"]=new t.GeographicPoint(17.966667,102.6),e["Etc/GMT-7"]=y,e["Indian/Christmas"]=new t.GeographicPoint(-10.416667,105.71667),e["Asia/Brunei"]=new t.GeographicPoint(4.883333,114.933334),e["Asia/Choibalsan"]=new t.GeographicPoint(48.066666,114.5),e["Asia/Chongqing"]=new t.GeographicPoint(29.562778,106.55278),e["Asia/Chungking"]=new t.GeographicPoint(29.562778,106.55278),e["Asia/Harbin"]=new t.GeographicPoint(45.75,126.65),e["Asia/Hong_Kong"]=new t.GeographicPoint(22.283333,114.15),e["Asia/Irkutsk"]=new t.GeographicPoint(52.266666,104.333336),e["Asia/Kashgar"]=new t.GeographicPoint(39.391388,76.04),e["Asia/Kuala_Lumpur"]=new t.GeographicPoint(3.1666667,101.7),e["Asia/Kuching"]=new t.GeographicPoint(1.55,110.333336),e["Asia/Macao"]=new t.GeographicPoint(22.2,113.55),e["Asia/Macau"]=new t.GeographicPoint(22.2,113.55),e["Asia/Makassar"]=new t.GeographicPoint(2.45,99.78333),e["Asia/Manila"]=new t.GeographicPoint(14.604167,120.98222);var E=new t.GeographicPoint(31.005,121.40861);e["Asia/Shanghai"]=E,e["Asia/Singapore"]=new t.GeographicPoint(1.2930557,103.855835),e["Asia/Taipei"]=new t.GeographicPoint(25.039167,121.525),e["Asia/Ujung_Pandang"]=new t.GeographicPoint(-5.1305556,119.406944),e["Asia/Ulaanbaatar"]=new t.GeographicPoint(47.916668,106.916664),e["Asia/Ulan_Bator"]=new t.GeographicPoint(47.916668,106.916664),e["Asia/Urumqi"]=new t.GeographicPoint(43.8,87.583336),e["Australia/Perth"]=new t.GeographicPoint(-31.933332,115.833336),e["Australia/West"]=new t.GeographicPoint(-31.933332,115.833336),e["Etc/GMT-8"]=E,e["Australia/Eucla"]=new t.GeographicPoint(-31.716667,128.86667),e["Asia/Dili"]=new t.GeographicPoint(-8.55,125.5833),e["Asia/Jayapura"]=new t.GeographicPoint(-2.5333333,140.7),e["Asia/Pyongyang"]=new t.GeographicPoint(39.019444,125.75472),e["Asia/Seoul"]=new t.GeographicPoint(37.566387,126.999725);var C=new t.GeographicPoint(35.685,139.75139);e["Asia/Tokyo"]=C,e["Asia/Yakutsk"]=new t.GeographicPoint(62.03389,129.73306),e["Etc/GMT-9"]=C,e["Pacific/Palau"]=new t.GeographicPoint(7.5,134.6241),e["Australia/Adelaide"]=new t.GeographicPoint(-34.933334,138.6),e["Australia/Broken_Hill"]=new t.GeographicPoint(-31.95,141.43333),e["Australia/Darwin"]=new t.GeographicPoint(-12.466667,130.83333),e["Australia/North"]=new t.GeographicPoint(-12.466667,130.83333),e["Australia/South"]=new t.GeographicPoint(-34.933334,138.6),e["Australia/Yancowinna"]=new t.GeographicPoint(-31.7581,141.7178),e["Antarctica/DumontDUrville"]=new t.GeographicPoint(-66.66277,140.0014),e["Asia/Sakhalin"]=new t.GeographicPoint(51,143),e["Asia/Vladivostok"]=new t.GeographicPoint(43.133335,131.9),e["Australia/ACT"]=new t.GeographicPoint(-35.283333,149.21666),e["Australia/Brisbane"]=new t.GeographicPoint(-27.5,153.01666),e["Australia/Canberra"]=new t.GeographicPoint(-35.283333,149.21666),e["Australia/Currie"]=new t.GeographicPoint(-39.933334,143.86667),e["Australia/Hobart"]=new t.GeographicPoint(-42.916668,147.33333),e["Australia/Lindeman"]=new t.GeographicPoint(-20.45,149.0333),e["Australia/Melbourne"]=new t.GeographicPoint(-37.816666,144.96666);var P=new t.GeographicPoint(-33.88333,151.21666);e["Australia/NSW"]=P,e["Australia/Queensland"]=new t.GeographicPoint(-27.5,153.01666),e["Australia/Sydney"]=P,e["Australia/Tasmania"]=new t.GeographicPoint(-42.916668,147.33333),e["Australia/Victoria"]=new t.GeographicPoint(-37.816666,144.96666),e["Etc/GMT-10"]=P,e["Pacific/Guam"]=new t.GeographicPoint(13.467,144.75),e["Pacific/Port_Moresby"]=new t.GeographicPoint(-9.464723,147.1925),e["Pacific/Saipan"]=new t.GeographicPoint(15.1833,145.75),e["Pacific/Truk"]=new t.GeographicPoint(7.4167,151.7833),e["Pacific/Yap"]=new t.GeographicPoint(9.514444,138.12917),e["Australia/LHI"]=new t.GeographicPoint(-31.55,159.083),e["Australia/Lord_Howe"]=new t.GeographicPoint(-31.55,159.083),e["Antarctica/Casey"]=new t.GeographicPoint(-66.2833,110.5333),e["Asia/Magadan"]=new t.GeographicPoint(59.566666,150.8);var w=new t.GeographicPoint(-22.266666,166.45);e["Etc/GMT-11"]=w,e["Pacific/Efate"]=new t.GeographicPoint(-17.667,168.417),e["Pacific/Guadalcanal"]=new t.GeographicPoint(-9.617,160.183),e["Pacific/Kosrae"]=new t.GeographicPoint(5.317,162.983),e["Pacific/Noumea"]=w,e["Pacific/Ponape"]=new t.GeographicPoint(6.963889,158.20833),e["Pacific/Norfolk"]=new t.GeographicPoint(-29.05,167.95),e["Antarctica/McMurdo"]=new t.GeographicPoint(-77.85,166.667),e["Antarctica/South_Pole"]=new t.GeographicPoint(-90,0),e["Asia/Anadyr"]=new t.GeographicPoint(64.75,177.48334),e["Asia/Kamchatka"]=new t.GeographicPoint(57,160);var L=new t.GeographicPoint(-36.86667,174.76666);e["Etc/GMT-12"]=L,e["Pacific/Auckland"]=L,e["Pacific/Fiji"]=new t.GeographicPoint(-18.133333,178.41667),e["Pacific/Funafuti"]=new t.GeographicPoint(-8.516666,179.21666),e["Pacific/Kwajalein"]=new t.GeographicPoint(9.1939,167.4597),e["Pacific/Majuro"]=new t.GeographicPoint(7.1,171.38333),e["Pacific/Nauru"]=new t.GeographicPoint(-.5322,166.9328),e["Pacific/Tarawa"]=new t.GeographicPoint(1.4167,173.0333),e["Pacific/Wake"]=new t.GeographicPoint(19.2833,166.6),e["Pacific/Wallis"]=new t.GeographicPoint(-13.273,-176.205),e["Pacific/Chatham"]=new t.GeographicPoint(-43.883,-176.517);var T=new t.GeographicPoint(-3.133,-171.0833);e["Etc/GMT-13"]=T,e["Pacific/Enderbury"]=T,e["Pacific/Tongatapu"]=new t.GeographicPoint(-21.2114,-175.153);var A=new t.GeographicPoint(1.883,-157.4);e["Etc/GMT-14"]=A,e["Pacific/Kiritimati"]=A,e.MIT=i,e.HST=n,e.PST=r,e.PST8PDT=r,e.MST=l,e.MST7MDT=l,e.Navajo=new t.GeographicPoint(35.6728,-109.0622),e.PNT=new t.GeographicPoint(33.448334,-112.07333),e["America/Indiana/Knox"]=new t.GeographicPoint(41.295834,-86.625),e["America/Indiana/Tell_City"]=new t.GeographicPoint(37.953,-86.7614),e["America/North_Dakota/Center"]=new t.GeographicPoint(47.115,-101.3003),e["America/North_Dakota/New_Salem"]=new t.GeographicPoint(46.843,101.4119),e.CST=a,e.CST6CDT=a,e["America/Indiana/Indianapolis"]=new t.GeographicPoint(39.768333,-86.15806),e["America/Indiana/Marengo"]=new t.GeographicPoint(36.3706,-86.3433),e["America/Indiana/Petersburg"]=new t.GeographicPoint(38.4917,-87.2803),e["America/Indiana/Vevay"]=new t.GeographicPoint(38.7458,-85.0711),e["America/Indiana/Vincennes"]=new t.GeographicPoint(38.6783,-87.5164),e["America/Indiana/Winamac"]=new t.GeographicPoint(41.0525,-86.6044),e["America/Kentucky/Louisville"]=new t.GeographicPoint(38.2542,-85.7603),e["America/Kentucky/Monticello"]=new t.GeographicPoint(36.8381,-84.85),e.Cuba=new t.GeographicPoint(23.131945,-82.36417),e.EST=s,e.EST5EDT=s,e.IET=s,e.AST=new t.GeographicPoint(44.65,-63.6),e.Jamaica=new t.GeographicPoint(18,-76.8),e["America/Argentina/San_Luis"]=new t.GeographicPoint(-33.3,-66.333),e.PRT=new t.GeographicPoint(18.467,66.117),e.CNT=new t.GeographicPoint(47.5675,-52.7072),e.AGT=new t.GeographicPoint(-34.5875,-58.6725),e["America/Argentina/Buenos_Aires"]=new t.GeographicPoint(-34.5875,-58.6725),e["America/Argentina/Catamarca"]=new t.GeographicPoint(-28.466667,-65.78333),e["America/Argentina/ComodRivadavia"]=new t.GeographicPoint(-42.7578,-65.0297),e["America/Argentina/Cordoba"]=new t.GeographicPoint(-31.4,-64.183334),e["America/Argentina/Jujuy"]=new t.GeographicPoint(-24.183332,-65.3),e["America/Argentina/La_Rioja"]=new t.GeographicPoint(-29.4144,-66.8552),e["America/Argentina/Mendoza"]=new t.GeographicPoint(-32.883335,-68.816666),e["America/Argentina/Rio_Gallegos"]=new t.GeographicPoint(-51.625,-69.2286),e["America/Argentina/Salta"]=new t.GeographicPoint(-24.783333,-65.416664),e["America/Argentina/San_Juan"]=new t.GeographicPoint(-31.5333,-68.5167),e["America/Argentina/Tucuman"]=new t.GeographicPoint(-26.8167,65.2167),e["America/Argentina/Ushuaia"]=new t.GeographicPoint(-54.6,-68.3),e.BET=u,e.Eire=new t.GeographicPoint(53.333057,-6.248889),e.GB=p,e["GB-Eire"]=new t.GeographicPoint(53.333057,-6.248889),e.GMT=p,e.GMT0=p,e.Greenwich=p,e.Iceland=new t.GeographicPoint(64.1333,-21.9333),e.Portugal=new t.GeographicPoint(38.716667,-9.133333),e.UCT=p,e.UTC=p,e.Universal=p,e.WET=p,e.Zulu=p,e.CET=g,e.ECT=g,e.MET=new t.GeographicPoint(35.671944,51.424446),e.Poland=new t.GeographicPoint(52.25,21),e.ART=new t.GeographicPoint(-34.5875,-58.6725),e.CAT=new t.GeographicPoint(-1.9536111,30.060556),e.EET=new t.GeographicPoint(37.983334,23.733334),e.Egypt=new t.GeographicPoint(30.05,31.25),e.Israel=new t.GeographicPoint(32.066666,34.766666),e.Libya=new t.GeographicPoint(32.8925,13.18),e.Turkey=new t.GeographicPoint(41.018612,28.964722),e.EAT=new t.GeographicPoint(-1.2833333,36.816666),e["W-SU"]=f,e.Iran=new t.GeographicPoint(35.671944,51.424446),e.NET=new t.GeographicPoint(40.18111,44.51361),e.PLT=new t.GeographicPoint(24.866667,67.05),e.IST=_,e.BST=S,e.VST=y,e.CTT=E,e.Hongkong=new t.GeographicPoint(22.283333,114.15),e.PRC=E,e.Singapore=new t.GeographicPoint(1.2930557,103.855835),e.JST=C,e.Japan=C,e.ROK=new t.GeographicPoint(37.566387,126.999725),e.ACT=new t.GeographicPoint(-35.283333,149.21666),e.AET=P,e.SST=new t.GeographicPoint(-28.4667,159.8167),e.Kwajalein=new t.GeographicPoint(9.1939,167.4597),e.NST=L,e.NZ=L,e["NZ-CHAT"]=new t.GeographicPoint(-43.883,-176.517),t.timeZoneGeographicPointsReference=e}var I,b=void 0===(I=e).UTC?null:I.UTC;null==b&&(b=function(e,t){return void 0===e[t]?null:e[t]}(e,"Etc/GMT")),this.latitude=function(e){return e*Math.PI/180}(b.getLatitudeInDegrees()),this.longitude=function(e){return e*Math.PI/180}(b.getLongitudeInDegrees())},t.timeZoneGeographicPointsReference=null,t}(HomeObject);Compass.__class="com.eteks.sweethome3d.model.Compass",Compass.__interfaces=["com.eteks.sweethome3d.model.Selectable"],function(e){var t=function(){function e(e,t){void 0===this.latitudeInDegrees&&(this.latitudeInDegrees=0),void 0===this.longitudeInDegrees&&(this.longitudeInDegrees=0),this.latitudeInDegrees=e,this.longitudeInDegrees=t}return e.prototype.getLatitudeInDegrees=function(){return this.latitudeInDegrees},e.prototype.getLongitudeInDegrees=function(){return this.longitudeInDegrees},e}();e.GeographicPoint=t,t.__class="com.eteks.sweethome3d.model.Compass.GeographicPoint"}(Compass||(Compass={})),Compass.__transients=["pointsCache","dateCache","sunElevationCache","sunAzimuthCache","propertyChangeSupport"];var Wall=function(e){function t(t,i,n,o,r,l,a,s){var h=this;if("string"!=typeof t&&null!==t||"number"!=typeof i&&null!==i||"number"!=typeof n&&null!==n||"number"!=typeof o&&null!==o||"number"!=typeof r&&null!==r||"number"!=typeof l&&null!==l||"number"!=typeof a&&null!==a||!(null!=s&&null!=s.constructor&&null!=s.constructor.__interfaces&&s.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.TextureImage")>=0||null===s))if("string"!=typeof t&&null!==t||"number"!=typeof i&&null!==i||"number"!=typeof n&&null!==n||"number"!=typeof o&&null!==o||"number"!=typeof r&&null!==r||"number"!=typeof l&&null!==l||"number"!=typeof a&&null!==a||void 0!==s)if("number"!=typeof t&&null!==t||"number"!=typeof i&&null!==i||"number"!=typeof n&&null!==n||"number"!=typeof o&&null!==o||"number"!=typeof r&&null!==r||"number"!=typeof l&&null!==l||!(null!=a&&null!=a.constructor&&null!=a.constructor.__interfaces&&a.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.TextureImage")>=0||null===a)||void 0!==s)if("number"!=typeof t&&null!==t||"number"!=typeof i&&null!==i||"number"!=typeof n&&null!==n||"number"!=typeof o&&null!==o||"number"!=typeof r&&null!==r||"number"!=typeof l&&null!==l||void 0!==a||void 0!==s){if("number"!=typeof t&&null!==t||"number"!=typeof i&&null!==i||"number"!=typeof n&&null!==n||"number"!=typeof o&&null!==o||"number"!=typeof r&&null!==r||void 0!==l||void 0!==a||void 0!==s)throw new Error("invalid overload");var u=(M=arguments)[0],d=M[1],c=M[2],p=M[3],g=M[4],m=HomeObject.createId("wall");void 0===(h=e.call(this,m)||this).xStart&&(h.xStart=0),void 0===h.yStart&&(h.yStart=0),void 0===h.xEnd&&(h.xEnd=0),void 0===h.yEnd&&(h.yEnd=0),void 0===h.arcExtent&&(h.arcExtent=null),void 0===h.wallAtStart&&(h.wallAtStart=null),void 0===h.wallAtEnd&&(h.wallAtEnd=null),void 0===h.thickness&&(h.thickness=0),void 0===h.height&&(h.height=null),void 0===h.heightAtEnd&&(h.heightAtEnd=null),void 0===h.leftSideColor&&(h.leftSideColor=null),void 0===h.leftSideTexture&&(h.leftSideTexture=null),void 0===h.leftSideShininess&&(h.leftSideShininess=0),void 0===h.leftSideBaseboard&&(h.leftSideBaseboard=null),void 0===h.rightSideColor&&(h.rightSideColor=null),void 0===h.rightSideTexture&&(h.rightSideTexture=null),void 0===h.rightSideShininess&&(h.rightSideShininess=0),void 0===h.rightSideBaseboard&&(h.rightSideBaseboard=null),void 0===h.pattern&&(h.pattern=null),void 0===h.topColor&&(h.topColor=null),void 0===h.level&&(h.level=null),void 0===h.shapeCache&&(h.shapeCache=null),void 0===h.arcCircleCenterCache&&(h.arcCircleCenterCache=null),void 0===h.pointsCache&&(h.pointsCache=null),void 0===h.pointsIncludingBaseboardsCache&&(h.pointsIncludingBaseboardsCache=null),h.symmetric=!0,h.xStart=u,h.yStart=d,h.xEnd=c,h.yEnd=p,h.thickness=g,h.height=0,h.pattern=null,void 0===h.xStart&&(h.xStart=0),void 0===h.yStart&&(h.yStart=0),void 0===h.xEnd&&(h.xEnd=0),void 0===h.yEnd&&(h.yEnd=0),void 0===h.arcExtent&&(h.arcExtent=null),void 0===h.wallAtStart&&(h.wallAtStart=null),void 0===h.wallAtEnd&&(h.wallAtEnd=null),void 0===h.thickness&&(h.thickness=0),void 0===h.height&&(h.height=null),void 0===h.heightAtEnd&&(h.heightAtEnd=null),void 0===h.leftSideColor&&(h.leftSideColor=null),void 0===h.leftSideTexture&&(h.leftSideTexture=null),void 0===h.leftSideShininess&&(h.leftSideShininess=0),void 0===h.leftSideBaseboard&&(h.leftSideBaseboard=null),void 0===h.rightSideColor&&(h.rightSideColor=null),void 0===h.rightSideTexture&&(h.rightSideTexture=null),void 0===h.rightSideShininess&&(h.rightSideShininess=0),void 0===h.rightSideBaseboard&&(h.rightSideBaseboard=null),void 0===h.pattern&&(h.pattern=null),void 0===h.topColor&&(h.topColor=null),void 0===h.level&&(h.level=null),void 0===h.shapeCache&&(h.shapeCache=null),void 0===h.arcCircleCenterCache&&(h.arcCircleCenterCache=null),void 0===h.pointsCache&&(h.pointsCache=null),void 0===h.pointsIncludingBaseboardsCache&&(h.pointsIncludingBaseboardsCache=null),h.symmetric=!0,void 0===h.xStart&&(h.xStart=0),void 0===h.yStart&&(h.yStart=0),void 0===h.xEnd&&(h.xEnd=0),void 0===h.yEnd&&(h.yEnd=0),void 0===h.arcExtent&&(h.arcExtent=null),void 0===h.wallAtStart&&(h.wallAtStart=null),void 0===h.wallAtEnd&&(h.wallAtEnd=null),void 0===h.thickness&&(h.thickness=0),void 0===h.height&&(h.height=null),void 0===h.heightAtEnd&&(h.heightAtEnd=null),void 0===h.leftSideColor&&(h.leftSideColor=null),void 0===h.leftSideTexture&&(h.leftSideTexture=null),void 0===h.leftSideShininess&&(h.leftSideShininess=0),void 0===h.leftSideBaseboard&&(h.leftSideBaseboard=null),void 0===h.rightSideColor&&(h.rightSideColor=null),void 0===h.rightSideTexture&&(h.rightSideTexture=null),void 0===h.rightSideShininess&&(h.rightSideShininess=0),void 0===h.rightSideBaseboard&&(h.rightSideBaseboard=null),void 0===h.pattern&&(h.pattern=null),void 0===h.topColor&&(h.topColor=null),void 0===h.level&&(h.level=null),void 0===h.shapeCache&&(h.shapeCache=null),void 0===h.arcCircleCenterCache&&(h.arcCircleCenterCache=null),void 0===h.pointsCache&&(h.pointsCache=null),void 0===h.pointsIncludingBaseboardsCache&&(h.pointsIncludingBaseboardsCache=null),h.symmetric=!0,void 0===h.xStart&&(h.xStart=0),void 0===h.yStart&&(h.yStart=0),void 0===h.xEnd&&(h.xEnd=0),void 0===h.yEnd&&(h.yEnd=0),void 0===h.arcExtent&&(h.arcExtent=null),void 0===h.wallAtStart&&(h.wallAtStart=null),void 0===h.wallAtEnd&&(h.wallAtEnd=null),void 0===h.thickness&&(h.thickness=0),void 0===h.height&&(h.height=null),void 0===h.heightAtEnd&&(h.heightAtEnd=null),void 0===h.leftSideColor&&(h.leftSideColor=null),void 0===h.leftSideTexture&&(h.leftSideTexture=null),void 0===h.leftSideShininess&&(h.leftSideShininess=0),void 0===h.leftSideBaseboard&&(h.leftSideBaseboard=null),void 0===h.rightSideColor&&(h.rightSideColor=null),void 0===h.rightSideTexture&&(h.rightSideTexture=null),void 0===h.rightSideShininess&&(h.rightSideShininess=0),void 0===h.rightSideBaseboard&&(h.rightSideBaseboard=null),void 0===h.pattern&&(h.pattern=null),void 0===h.topColor&&(h.topColor=null),void 0===h.level&&(h.level=null),void 0===h.shapeCache&&(h.shapeCache=null),void 0===h.arcCircleCenterCache&&(h.arcCircleCenterCache=null),void 0===h.pointsCache&&(h.pointsCache=null),void 0===h.pointsIncludingBaseboardsCache&&(h.pointsIncludingBaseboardsCache=null),h.symmetric=!0}else{var f=(M=arguments)[0],v=M[1],_=M[2],S=M[3],y=M[4],E=M[5],C=HomeObject.createId("wall");void 0===(h=e.call(this,C)||this).xStart&&(h.xStart=0),void 0===h.yStart&&(h.yStart=0),void 0===h.xEnd&&(h.xEnd=0),void 0===h.yEnd&&(h.yEnd=0),void 0===h.arcExtent&&(h.arcExtent=null),void 0===h.wallAtStart&&(h.wallAtStart=null),void 0===h.wallAtEnd&&(h.wallAtEnd=null),void 0===h.thickness&&(h.thickness=0),void 0===h.height&&(h.height=null),void 0===h.heightAtEnd&&(h.heightAtEnd=null),void 0===h.leftSideColor&&(h.leftSideColor=null),void 0===h.leftSideTexture&&(h.leftSideTexture=null),void 0===h.leftSideShininess&&(h.leftSideShininess=0),void 0===h.leftSideBaseboard&&(h.leftSideBaseboard=null),void 0===h.rightSideColor&&(h.rightSideColor=null),void 0===h.rightSideTexture&&(h.rightSideTexture=null),void 0===h.rightSideShininess&&(h.rightSideShininess=0),void 0===h.rightSideBaseboard&&(h.rightSideBaseboard=null),void 0===h.pattern&&(h.pattern=null),void 0===h.topColor&&(h.topColor=null),void 0===h.level&&(h.level=null),void 0===h.shapeCache&&(h.shapeCache=null),void 0===h.arcCircleCenterCache&&(h.arcCircleCenterCache=null),void 0===h.pointsCache&&(h.pointsCache=null),void 0===h.pointsIncludingBaseboardsCache&&(h.pointsIncludingBaseboardsCache=null),h.symmetric=!0,h.xStart=f,h.yStart=v,h.xEnd=_,h.yEnd=S,h.thickness=y,h.height=E,h.pattern=null,void 0===h.xStart&&(h.xStart=0),void 0===h.yStart&&(h.yStart=0),void 0===h.xEnd&&(h.xEnd=0),void 0===h.yEnd&&(h.yEnd=0),void 0===h.arcExtent&&(h.arcExtent=null),void 0===h.wallAtStart&&(h.wallAtStart=null),void 0===h.wallAtEnd&&(h.wallAtEnd=null),void 0===h.thickness&&(h.thickness=0),void 0===h.height&&(h.height=null),void 0===h.heightAtEnd&&(h.heightAtEnd=null),void 0===h.leftSideColor&&(h.leftSideColor=null),void 0===h.leftSideTexture&&(h.leftSideTexture=null),void 0===h.leftSideShininess&&(h.leftSideShininess=0),void 0===h.leftSideBaseboard&&(h.leftSideBaseboard=null),void 0===h.rightSideColor&&(h.rightSideColor=null),void 0===h.rightSideTexture&&(h.rightSideTexture=null),void 0===h.rightSideShininess&&(h.rightSideShininess=0),void 0===h.rightSideBaseboard&&(h.rightSideBaseboard=null),void 0===h.pattern&&(h.pattern=null),void 0===h.topColor&&(h.topColor=null),void 0===h.level&&(h.level=null),void 0===h.shapeCache&&(h.shapeCache=null),void 0===h.arcCircleCenterCache&&(h.arcCircleCenterCache=null),void 0===h.pointsCache&&(h.pointsCache=null),void 0===h.pointsIncludingBaseboardsCache&&(h.pointsIncludingBaseboardsCache=null),h.symmetric=!0,void 0===h.xStart&&(h.xStart=0),void 0===h.yStart&&(h.yStart=0),void 0===h.xEnd&&(h.xEnd=0),void 0===h.yEnd&&(h.yEnd=0),void 0===h.arcExtent&&(h.arcExtent=null),void 0===h.wallAtStart&&(h.wallAtStart=null),void 0===h.wallAtEnd&&(h.wallAtEnd=null),void 0===h.thickness&&(h.thickness=0),void 0===h.height&&(h.height=null),void 0===h.heightAtEnd&&(h.heightAtEnd=null),void 0===h.leftSideColor&&(h.leftSideColor=null),void 0===h.leftSideTexture&&(h.leftSideTexture=null),void 0===h.leftSideShininess&&(h.leftSideShininess=0),void 0===h.leftSideBaseboard&&(h.leftSideBaseboard=null),void 0===h.rightSideColor&&(h.rightSideColor=null),void 0===h.rightSideTexture&&(h.rightSideTexture=null),void 0===h.rightSideShininess&&(h.rightSideShininess=0),void 0===h.rightSideBaseboard&&(h.rightSideBaseboard=null),void 0===h.pattern&&(h.pattern=null),void 0===h.topColor&&(h.topColor=null),void 0===h.level&&(h.level=null),void 0===h.shapeCache&&(h.shapeCache=null),void 0===h.arcCircleCenterCache&&(h.arcCircleCenterCache=null),void 0===h.pointsCache&&(h.pointsCache=null),void 0===h.pointsIncludingBaseboardsCache&&(h.pointsIncludingBaseboardsCache=null),h.symmetric=!0}else{var P=(M=arguments)[0],w=M[1],L=M[2],T=M[3],A=M[4],I=M[5],b=M[6],O=HomeObject.createId("wall");void 0===(h=e.call(this,O)||this).xStart&&(h.xStart=0),void 0===h.yStart&&(h.yStart=0),void 0===h.xEnd&&(h.xEnd=0),void 0===h.yEnd&&(h.yEnd=0),void 0===h.arcExtent&&(h.arcExtent=null),void 0===h.wallAtStart&&(h.wallAtStart=null),void 0===h.wallAtEnd&&(h.wallAtEnd=null),void 0===h.thickness&&(h.thickness=0),void 0===h.height&&(h.height=null),void 0===h.heightAtEnd&&(h.heightAtEnd=null),void 0===h.leftSideColor&&(h.leftSideColor=null),void 0===h.leftSideTexture&&(h.leftSideTexture=null),void 0===h.leftSideShininess&&(h.leftSideShininess=0),void 0===h.leftSideBaseboard&&(h.leftSideBaseboard=null),void 0===h.rightSideColor&&(h.rightSideColor=null),void 0===h.rightSideTexture&&(h.rightSideTexture=null),void 0===h.rightSideShininess&&(h.rightSideShininess=0),void 0===h.rightSideBaseboard&&(h.rightSideBaseboard=null),void 0===h.pattern&&(h.pattern=null),void 0===h.topColor&&(h.topColor=null),void 0===h.level&&(h.level=null),void 0===h.shapeCache&&(h.shapeCache=null),void 0===h.arcCircleCenterCache&&(h.arcCircleCenterCache=null),void 0===h.pointsCache&&(h.pointsCache=null),void 0===h.pointsIncludingBaseboardsCache&&(h.pointsIncludingBaseboardsCache=null),h.symmetric=!0,h.xStart=P,h.yStart=w,h.xEnd=L,h.yEnd=T,h.thickness=A,h.height=I,h.pattern=b,void 0===h.xStart&&(h.xStart=0),void 0===h.yStart&&(h.yStart=0),void 0===h.xEnd&&(h.xEnd=0),void 0===h.yEnd&&(h.yEnd=0),void 0===h.arcExtent&&(h.arcExtent=null),void 0===h.wallAtStart&&(h.wallAtStart=null),void 0===h.wallAtEnd&&(h.wallAtEnd=null),void 0===h.thickness&&(h.thickness=0),void 0===h.height&&(h.height=null),void 0===h.heightAtEnd&&(h.heightAtEnd=null),void 0===h.leftSideColor&&(h.leftSideColor=null),void 0===h.leftSideTexture&&(h.leftSideTexture=null),void 0===h.leftSideShininess&&(h.leftSideShininess=0),void 0===h.leftSideBaseboard&&(h.leftSideBaseboard=null),void 0===h.rightSideColor&&(h.rightSideColor=null),void 0===h.rightSideTexture&&(h.rightSideTexture=null),void 0===h.rightSideShininess&&(h.rightSideShininess=0),void 0===h.rightSideBaseboard&&(h.rightSideBaseboard=null),void 0===h.pattern&&(h.pattern=null),void 0===h.topColor&&(h.topColor=null),void 0===h.level&&(h.level=null),void 0===h.shapeCache&&(h.shapeCache=null),void 0===h.arcCircleCenterCache&&(h.arcCircleCenterCache=null),void 0===h.pointsCache&&(h.pointsCache=null),void 0===h.pointsIncludingBaseboardsCache&&(h.pointsIncludingBaseboardsCache=null),h.symmetric=!0}else{var M=arguments;void 0===(h=e.call(this,t)||this).xStart&&(h.xStart=0),void 0===h.yStart&&(h.yStart=0),void 0===h.xEnd&&(h.xEnd=0),void 0===h.yEnd&&(h.yEnd=0),void 0===h.arcExtent&&(h.arcExtent=null),void 0===h.wallAtStart&&(h.wallAtStart=null),void 0===h.wallAtEnd&&(h.wallAtEnd=null),void 0===h.thickness&&(h.thickness=0),void 0===h.height&&(h.height=null),void 0===h.heightAtEnd&&(h.heightAtEnd=null),void 0===h.leftSideColor&&(h.leftSideColor=null),void 0===h.leftSideTexture&&(h.leftSideTexture=null),void 0===h.leftSideShininess&&(h.leftSideShininess=0),void 0===h.leftSideBaseboard&&(h.leftSideBaseboard=null),void 0===h.rightSideColor&&(h.rightSideColor=null),void 0===h.rightSideTexture&&(h.rightSideTexture=null),void 0===h.rightSideShininess&&(h.rightSideShininess=0),void 0===h.rightSideBaseboard&&(h.rightSideBaseboard=null),void 0===h.pattern&&(h.pattern=null),void 0===h.topColor&&(h.topColor=null),void 0===h.level&&(h.level=null),void 0===h.shapeCache&&(h.shapeCache=null),void 0===h.arcCircleCenterCache&&(h.arcCircleCenterCache=null),void 0===h.pointsCache&&(h.pointsCache=null),void 0===h.pointsIncludingBaseboardsCache&&(h.pointsIncludingBaseboardsCache=null),h.symmetric=!0,h.xStart=i,h.yStart=n,h.xEnd=o,h.yEnd=r,h.thickness=l,h.height=a,h.pattern=null,void 0===h.xStart&&(h.xStart=0),void 0===h.yStart&&(h.yStart=0),void 0===h.xEnd&&(h.xEnd=0),void 0===h.yEnd&&(h.yEnd=0),void 0===h.arcExtent&&(h.arcExtent=null),void 0===h.wallAtStart&&(h.wallAtStart=null),void 0===h.wallAtEnd&&(h.wallAtEnd=null),void 0===h.thickness&&(h.thickness=0),void 0===h.height&&(h.height=null),void 0===h.heightAtEnd&&(h.heightAtEnd=null),void 0===h.leftSideColor&&(h.leftSideColor=null),void 0===h.leftSideTexture&&(h.leftSideTexture=null),void 0===h.leftSideShininess&&(h.leftSideShininess=0),void 0===h.leftSideBaseboard&&(h.leftSideBaseboard=null),void 0===h.rightSideColor&&(h.rightSideColor=null),void 0===h.rightSideTexture&&(h.rightSideTexture=null),void 0===h.rightSideShininess&&(h.rightSideShininess=0),void 0===h.rightSideBaseboard&&(h.rightSideBaseboard=null),void 0===h.pattern&&(h.pattern=null),void 0===h.topColor&&(h.topColor=null),void 0===h.level&&(h.level=null),void 0===h.shapeCache&&(h.shapeCache=null),void 0===h.arcCircleCenterCache&&(h.arcCircleCenterCache=null),void 0===h.pointsCache&&(h.pointsCache=null),void 0===h.pointsIncludingBaseboardsCache&&(h.pointsIncludingBaseboardsCache=null),h.symmetric=!0}else{var M=arguments;void 0===(h=e.call(this,t)||this).xStart&&(h.xStart=0),void 0===h.yStart&&(h.yStart=0),void 0===h.xEnd&&(h.xEnd=0),void 0===h.yEnd&&(h.yEnd=0),void 0===h.arcExtent&&(h.arcExtent=null),void 0===h.wallAtStart&&(h.wallAtStart=null),void 0===h.wallAtEnd&&(h.wallAtEnd=null),void 0===h.thickness&&(h.thickness=0),void 0===h.height&&(h.height=null),void 0===h.heightAtEnd&&(h.heightAtEnd=null),void 0===h.leftSideColor&&(h.leftSideColor=null),void 0===h.leftSideTexture&&(h.leftSideTexture=null),void 0===h.leftSideShininess&&(h.leftSideShininess=0),void 0===h.leftSideBaseboard&&(h.leftSideBaseboard=null),void 0===h.rightSideColor&&(h.rightSideColor=null),void 0===h.rightSideTexture&&(h.rightSideTexture=null),void 0===h.rightSideShininess&&(h.rightSideShininess=0),void 0===h.rightSideBaseboard&&(h.rightSideBaseboard=null),void 0===h.pattern&&(h.pattern=null),void 0===h.topColor&&(h.topColor=null),void 0===h.level&&(h.level=null),void 0===h.shapeCache&&(h.shapeCache=null),void 0===h.arcCircleCenterCache&&(h.arcCircleCenterCache=null),void 0===h.pointsCache&&(h.pointsCache=null),void 0===h.pointsIncludingBaseboardsCache&&(h.pointsIncludingBaseboardsCache=null),h.symmetric=!0,h.xStart=i,h.yStart=n,h.xEnd=o,h.yEnd=r,h.thickness=l,h.height=a,h.pattern=s}return h}return __extends(t,e),t.prototype.getXStart=function(){return this.xStart},t.prototype.setXStart=function(e){if(e!==this.xStart){var t=this.xStart;this.xStart=e,this.clearPointsCache(),this.arcCircleCenterCache=null,this.firePropertyChange("X_START",t,e)}},t.prototype.getYStart=function(){return this.yStart},t.prototype.setYStart=function(e){if(e!==this.yStart){var t=this.yStart;this.yStart=e,this.clearPointsCache(),this.arcCircleCenterCache=null,this.firePropertyChange("Y_START",t,e)}},t.prototype.getXEnd=function(){return this.xEnd},t.prototype.setXEnd=function(e){if(e!==this.xEnd){var t=this.xEnd;this.xEnd=e,this.clearPointsCache(),this.arcCircleCenterCache=null,this.firePropertyChange("X_END",t,e)}},t.prototype.getYEnd=function(){return this.yEnd},t.prototype.setYEnd=function(e){if(e!==this.yEnd){var t=this.yEnd;this.yEnd=e,this.clearPointsCache(),this.arcCircleCenterCache=null,this.firePropertyChange("Y_END",t,e)}},t.prototype.getLength=function(){if(null==this.arcExtent||0===this.arcExtent)return java.awt.geom.Point2D.distance(this.xStart,this.yStart,this.xEnd,this.yEnd);var e=this.getArcCircleCenter(),t=java.awt.geom.Point2D.distance(this.xStart,this.yStart,e[0],e[1]);return Math.abs(this.arcExtent)*t},t.prototype.getStartPointToEndPointDistance=function(){return java.awt.geom.Point2D.distance(this.xStart,this.yStart,this.xEnd,this.yEnd)},t.prototype.setArcExtent=function(e){if(e!==this.arcExtent&&(null==e||e!==this.arcExtent)){var t=this.arcExtent;this.arcExtent=e,this.clearPointsCache(),this.arcCircleCenterCache=null,this.firePropertyChange("ARC_EXTENT",t,e)}},t.prototype.getArcExtent=function(){return this.arcExtent},t.prototype.getXArcCircleCenter=function(){return null==this.arcExtent?(this.xStart+this.xEnd)/2:this.getArcCircleCenter()[0]},t.prototype.getYArcCircleCenter=function(){return null==this.arcExtent?(this.yStart+this.yEnd)/2:this.getArcCircleCenter()[1]},t.prototype.getArcCircleCenter=function(){if(null==this.arcCircleCenterCache){var e=java.awt.geom.Point2D.distance(this.xStart,this.yStart,this.xEnd,this.yEnd),t=Math.abs(this.arcExtent)>Math.PI?-(Math.PI+this.arcExtent)/2:(Math.PI-this.arcExtent)/2,i=-Math.tan(t)*e/2,n=(this.xStart+this.xEnd)/2,o=(this.yStart+this.yEnd)/2,r=Math.atan2(this.xStart-this.xEnd,this.yEnd-this.yStart);this.arcCircleCenterCache=[n+i*Math.cos(r),o+i*Math.sin(r)]}return this.arcCircleCenterCache},t.prototype.getWallAtStart=function(){return this.wallAtStart},t.prototype.setWallAtStart=function(e,t){if(void 0===t&&(t=!0),e!==this.wallAtStart){var i=this.wallAtStart;this.wallAtStart=e,this.clearPointsCache(),this.firePropertyChange("WALL_AT_START",i,e),t&&this.detachJoinedWall(i)}},t.prototype.getWallAtEnd=function(){return this.wallAtEnd},t.prototype.setWallAtEnd=function(e,t){if(void 0===t&&(t=!0),e!==this.wallAtEnd){var i=this.wallAtEnd;this.wallAtEnd=e,this.clearPointsCache(),this.firePropertyChange("WALL_AT_END",i,e),t&&this.detachJoinedWall(i)}},t.prototype.detachJoinedWall=function(e){null!=e&&(e.getWallAtStart()===this?e.setWallAtStart(null,!1):e.getWallAtEnd()===this&&e.setWallAtEnd(null,!1))},t.prototype.getThickness=function(){return this.thickness},t.prototype.setThickness=function(e){if(e!==this.thickness){var t=this.thickness;this.thickness=e,this.clearPointsCache(),this.firePropertyChange("THICKNESS",t,e)}},t.prototype.getHeight=function(){return this.height},t.prototype.setHeight=function(e){if(e!==this.height&&(null==e||e!==this.height)){var t=this.height;this.height=e,this.firePropertyChange("HEIGHT",t,e)}},t.prototype.getHeightAtEnd=function(){return this.heightAtEnd},t.prototype.setHeightAtEnd=function(e){if(e!==this.heightAtEnd&&(null==e||e!==this.heightAtEnd)){var t=this.heightAtEnd;this.heightAtEnd=e,this.firePropertyChange("HEIGHT_AT_END",t,e)}},t.prototype.isTrapezoidal=function(){return null!=this.height&&null!=this.heightAtEnd&&!(this.height===this.heightAtEnd)},t.prototype.getLeftSideColor=function(){return this.leftSideColor},t.prototype.setLeftSideColor=function(e){if(e!==this.leftSideColor&&(null==e||e!==this.leftSideColor)){var t=this.leftSideColor;this.leftSideColor=e,this.firePropertyChange("LEFT_SIDE_COLOR",t,e)}},t.prototype.getRightSideColor=function(){return this.rightSideColor},t.prototype.setRightSideColor=function(e){if(e!==this.rightSideColor&&(null==e||e!==this.rightSideColor)){var t=this.rightSideColor;this.rightSideColor=e,this.firePropertyChange("RIGHT_SIDE_COLOR",t,e)}},t.prototype.getLeftSideTexture=function(){return this.leftSideTexture},t.prototype.setLeftSideTexture=function(e){if(e!==this.leftSideTexture&&(null==e||!e.equals(this.leftSideTexture))){var t=this.leftSideTexture;this.leftSideTexture=e,this.firePropertyChange("LEFT_SIDE_TEXTURE",t,e)}},t.prototype.getRightSideTexture=function(){return this.rightSideTexture},t.prototype.setRightSideTexture=function(e){if(e!==this.rightSideTexture&&(null==e||!e.equals(this.rightSideTexture))){var t=this.rightSideTexture;this.rightSideTexture=e,this.firePropertyChange("RIGHT_SIDE_TEXTURE",t,e)}},t.prototype.getLeftSideShininess=function(){return this.leftSideShininess},t.prototype.setLeftSideShininess=function(e){if(e!==this.leftSideShininess){var t=this.leftSideShininess;this.leftSideShininess=e,this.firePropertyChange("LEFT_SIDE_SHININESS",t,e)}},t.prototype.getRightSideShininess=function(){return this.rightSideShininess},t.prototype.setRightSideShininess=function(e){if(e!==this.rightSideShininess){var t=this.rightSideShininess;this.rightSideShininess=e,this.firePropertyChange("RIGHT_SIDE_SHININESS",t,e)}},t.prototype.getLeftSideBaseboard=function(){return this.leftSideBaseboard},t.prototype.setLeftSideBaseboard=function(e){if(e!==this.leftSideBaseboard&&(null==e||!e.equals(this.leftSideBaseboard))){var t=this.leftSideBaseboard;this.leftSideBaseboard=e,this.clearPointsCache(),this.firePropertyChange("LEFT_SIDE_BASEBOARD",t,e)}},t.prototype.getRightSideBaseboard=function(){return this.rightSideBaseboard},t.prototype.setRightSideBaseboard=function(e){if(e!==this.rightSideBaseboard&&(null==e||!e.equals(this.rightSideBaseboard))){var t=this.rightSideBaseboard;this.rightSideBaseboard=e,this.clearPointsCache(),this.firePropertyChange("RIGHT_SIDE_BASEBOARD",t,e)}},t.prototype.getPattern=function(){return this.pattern},t.prototype.setPattern=function(e){if(this.pattern!==e){var t=this.pattern;this.pattern=e,this.firePropertyChange("PATTERN",t,e)}},t.prototype.getTopColor=function(){return this.topColor},t.prototype.setTopColor=function(e){if(this.topColor!==e&&(null==e||e!==this.topColor)){var t=this.topColor;this.topColor=e,this.firePropertyChange("TOP_COLOR",t,e)}},t.prototype.getLevel=function(){return this.level},t.prototype.setLevel=function(e){if(e!==this.level){var t=this.level;this.level=e,this.firePropertyChange("LEVEL",t,e)}},t.prototype.isAtLevel=function(e){if(this.level===e)return!0;if(null!=this.level&&null!=e){var t=this.level.getElevation(),i=e.getElevation();return t===i&&this.level.getElevationIndex()<e.getElevationIndex()||t<i&&t+this.getWallMaximumHeight()>i}return!1},t.prototype.getWallMaximumHeight=function(){return null==this.height?0:this.isTrapezoidal()?Math.max(this.height,this.heightAtEnd):this.height},t.prototype.clearPointsCache=function(){this.shapeCache=null,this.pointsCache=null,this.pointsIncludingBaseboardsCache=null,null!=this.wallAtStart&&(this.wallAtStart.pointsCache=null,this.wallAtStart.pointsIncludingBaseboardsCache=null),null!=this.wallAtEnd&&(this.wallAtEnd.pointsCache=null,this.wallAtEnd.pointsIncludingBaseboardsCache=null)},t.prototype.getPoints$=function(){return this.getPoints$boolean(!1)},t.prototype.getPoints$boolean=function(e){return!e||null==this.leftSideBaseboard&&null==this.rightSideBaseboard?(null==this.pointsCache&&(this.pointsCache=this.getShapePoints(!1)),this.clonePoints(this.pointsCache)):(null==this.pointsIncludingBaseboardsCache&&(this.pointsIncludingBaseboardsCache=this.getShapePoints(!0)),this.clonePoints(this.pointsIncludingBaseboardsCache))},t.prototype.getPoints=function(e){if("boolean"==typeof e||null===e)return this.getPoints$boolean(e);if(void 0===e)return this.getPoints$();throw new Error("invalid overload")},t.prototype.clonePoints=function(e){for(var t=function(e){for(var t=[];e-- >0;)t.push(null);return t}(e.length),i=0;i<e.length;i++)t[i]=e[i].slice(0);return t},t.prototype.getShapePoints=function(e){var t=.01,i=this.getUnjoinedShapePoints(e),n=i.length-1,o=(i.length/2|0)-1,r=i.length/2|0;if(null!=this.wallAtStart){var l=this.wallAtStart.getUnjoinedShapePoints(e),a=l.length-1,s=(l.length/2|0)-1,h=l.length/2|0,u=this.wallAtStart.getWallAtEnd()===this&&(this.wallAtStart.getWallAtStart()!==this||this.wallAtStart.xEnd===this.xStart&&this.wallAtStart.yEnd===this.yStart),d=this.wallAtStart.getWallAtStart()===this&&(this.wallAtStart.getWallAtEnd()!==this||this.wallAtStart.xStart===this.xStart&&this.wallAtStart.yStart===this.yStart),c=e?this.wallAtStart.pointsIncludingBaseboardsCache:this.wallAtStart.pointsCache,p=2*Math.max(this.thickness,this.wallAtStart.getThickness());u?(this.computeIntersection(i[0],i[1],l[s],l[s-1],p),this.computeIntersection(i[n],i[n-1],l[h],l[h+1],p),null!=c&&(Math.abs(i[0][0]-c[s][0])<t&&Math.abs(i[0][1]-c[s][1])<t&&(i[0]=c[s]),Math.abs(i[n][0]-c[h][0])<t&&Math.abs(i[n][1]-c[h][1])<t&&(i[n]=c[h]))):d&&(this.computeIntersection(i[0],i[1],l[a],l[a-1],p),this.computeIntersection(i[n],i[n-1],l[0],l[1],p),null!=c&&(Math.abs(i[0][0]-c[a][0])<t&&Math.abs(i[0][1]-c[a][1])<t&&(i[0]=c[a]),null!=c&&Math.abs(i[n][0]-c[0][0])<t&&Math.abs(i[n][1]-c[0][1])<t&&(i[n]=c[0])))}if(null!=this.wallAtEnd){var g=this.wallAtEnd.getUnjoinedShapePoints(e),m=g.length-1,f=(g.length/2|0)-1,v=g.length/2|0,_=this.wallAtEnd.getWallAtStart()===this&&(this.wallAtEnd.getWallAtEnd()!==this||this.wallAtEnd.xStart===this.xEnd&&this.wallAtEnd.yStart===this.yEnd),S=this.wallAtEnd.getWallAtEnd()===this&&(this.wallAtEnd.getWallAtStart()!==this||this.wallAtEnd.xEnd===this.xEnd&&this.wallAtEnd.yEnd===this.yEnd),y=e?this.wallAtEnd.pointsIncludingBaseboardsCache:this.wallAtEnd.pointsCache;p=2*Math.max(this.thickness,this.wallAtEnd.getThickness());_?(this.computeIntersection(i[o],i[o-1],g[0],g[1],p),this.computeIntersection(i[r],i[r+1],g[m],g[m-1],p),null!=y&&(Math.abs(i[o][0]-y[0][0])<t&&Math.abs(i[o][1]-y[0][1])<t&&(i[o]=y[0]),Math.abs(i[r][0]-y[m][0])<t&&Math.abs(i[r][1]-y[m][1])<t&&(i[r]=y[m]))):S&&(this.computeIntersection(i[o],i[o-1],g[v],g[v+1],p),this.computeIntersection(i[r],i[r+1],g[f],g[f-1],p),null!=y&&(Math.abs(i[o][0]-y[v][0])<t&&Math.abs(i[o][1]-y[v][1])<t&&(i[o]=y[v]),Math.abs(i[r][0]-y[f][0])<t&&Math.abs(i[r][1]-y[f][1])<t&&(i[r]=y[f])))}return i},t.prototype.getUnjoinedShapePoints=function(e){if(null!=this.arcExtent&&0!==this.arcExtent&&java.awt.geom.Point2D.distanceSq(this.xStart,this.yStart,this.xEnd,this.yEnd)>1e-10){var t=this.getArcCircleCenter(),i=Math.atan2(t[1]-this.yStart,t[0]-this.xStart);i+=2*Math.atan2(this.yStart-this.yEnd,this.xEnd-this.xStart);var n=java.awt.geom.Point2D.distance(t[0],t[1],this.xStart,this.yStart),o=n+this.thickness/2,r=Math.max(0,n-this.thickness/2),l=o*Math.abs(this.arcExtent),a=this.arcExtent/Math.sqrt(l),s=this.arcExtent/a|0;e&&(a>0?(null!=this.leftSideBaseboard&&(o+=this.leftSideBaseboard.getThickness()),null!=this.rightSideBaseboard&&(r-=this.rightSideBaseboard.getThickness())):(null!=this.leftSideBaseboard&&(r-=this.leftSideBaseboard.getThickness()),null!=this.rightSideBaseboard&&(o+=this.rightSideBaseboard.getThickness())));var h=[];if(this.symmetric){Math.abs(this.arcExtent-s*a)>1e-6&&(a=this.arcExtent/++s);for(var u=0;u<=s;u++)this.computeRoundWallShapePoint(h,i+this.arcExtent-u*a,u,a,t,o,r)}else{u=0;for(var d=this.arcExtent;a>0?d>=.1*a:d<=.1*-a;d-=a,u++)this.computeRoundWallShapePoint(h,i+d,u,a,t,o,r);this.computeRoundWallShapePoint(h,i,u,a,t,o,r)}return h.slice(0)}d=Math.atan2(this.yEnd-this.yStart,this.xEnd-this.xStart);var c=Math.sin(d),p=Math.cos(d),g=this.thickness/2;e&&null!=this.leftSideBaseboard&&(g+=this.leftSideBaseboard.getThickness());var m=c*g,f=p*g,v=this.thickness/2;e&&null!=this.rightSideBaseboard&&(v+=this.rightSideBaseboard.getThickness());var _=c*v,S=p*v;return[[this.xStart+m,this.yStart-f],[this.xEnd+m,this.yEnd-f],[this.xEnd-_,this.yEnd+S],[this.xStart-_,this.yStart+S]]},t.prototype.computeRoundWallShapePoint=function(e,t,i,n,o,r,l){var a=Math.cos(t),s=Math.sin(t),h=[o[0]+l*a,o[1]-l*s],u=[o[0]+r*a,o[1]-r*s];n>0?(e.splice(i,0,h),e.splice(e.length-1-i,0,u)):(e.splice(i,0,u),e.splice(e.length-1-i,0,h))},t.prototype.computeIntersection=function(e,t,i,n,o){var r,l=(t[1]-e[1])/(t[0]-e[0]),a=(n[1]-i[1])/(n[0]-i[0]);if(l!==a){var s=e[0],h=e[1];if(Math.abs(l)>4e3){if(Math.abs(a)<4e3)h=a*(s=e[0])+(n[1]-a*n[0])}else if(Math.abs(a)>4e3){if(Math.abs(l)<4e3)h=l*(s=i[0])+(d=t[1]-l*t[0])}else{var u=((r=l)>0?1:r<0?-1:0)===function(e){return e>0?1:e<0?-1:0}(a);if(Math.abs(l-a)>1e-5&&(!u||(Math.abs(l)>Math.abs(a)?l/a:a/l)>1.004)){var d=t[1]-l*t[0];h=l*(s=(n[1]-a*n[0]-d)/(l-a))+d}}java.awt.geom.Point2D.distanceSq(s,h,e[0],e[1])<o*o&&(e[0]=s,e[1]=h)}},t.prototype.intersectsRectangle=function(e,t,i,n){var o=new java.awt.geom.Rectangle2D.Float(e,t,0,0);return o.add(i,n),this.getShape(!1).intersects(o)},t.prototype.containsPoint$float$float$float=function(e,t,i){return this.containsPoint$float$float$boolean$float(e,t,!1,i)},t.prototype.containsPoint$float$float$boolean$float=function(e,t,i,n){return this.containsShapeAtWithMargin(this.getShape(i),e,t,n)},t.prototype.containsPoint=function(e,t,i,n){if("number"!=typeof e&&null!==e||"number"!=typeof t&&null!==t||"boolean"!=typeof i&&null!==i||"number"!=typeof n&&null!==n){if("number"!=typeof e&&null!==e||"number"!=typeof t&&null!==t||"number"!=typeof i&&null!==i||void 0!==n)throw new Error("invalid overload");return this.containsPoint$float$float$float(e,t,i)}return this.containsPoint$float$float$boolean$float(e,t,i,n)},t.prototype.isMiddlePointAt=function(e,t,i){var n=this.getPoints$(),o=n.length/4|0,r=n.length-1-o,l=n.length%4==0?new java.awt.geom.Line2D.Float((n[o-1][0]+n[o][0])/2,(n[o-1][1]+n[o][1])/2,(n[r][0]+n[r+1][0])/2,(n[r][1]+n[r+1][1])/2):new java.awt.geom.Line2D.Float(n[o][0],n[o][1],n[r][0],n[r][1]);return this.containsShapeAtWithMargin(l,e,t,i)},t.prototype.containsWallStartAt=function(e,t,i){var n=this.getPoints$(),o=new java.awt.geom.Line2D.Float(n[0][0],n[0][1],n[n.length-1][0],n[n.length-1][1]);return this.containsShapeAtWithMargin(o,e,t,i)},t.prototype.containsWallEndAt=function(e,t,i){var n=this.getPoints$(),o=new java.awt.geom.Line2D.Float(n[(n.length/2|0)-1][0],n[(n.length/2|0)-1][1],n[n.length/2|0][0],n[n.length/2|0][1]);return this.containsShapeAtWithMargin(o,e,t,i)},t.prototype.containsShapeAtWithMargin=function(e,t,i,n){return 0===n?e.contains(t,i):e.intersects(t-n,i-n,2*n,2*n)},t.prototype.getShape=function(e){if(null==this.shapeCache){var t=this.getPoints$boolean(e),i=new java.awt.geom.GeneralPath;i.moveTo(t[0][0],t[0][1]);for(var n=1;n<t.length;n++)i.lineTo(t[n][0],t[n][1]);i.closePath(),this.shapeCache=i}return this.shapeCache},t.prototype.move=function(e,t){this.setXStart(this.getXStart()+e),this.setYStart(this.getYStart()+t),this.setXEnd(this.getXEnd()+e),this.setYEnd(this.getYEnd()+t)},t.duplicate=function(e){for(var i=[],n=0;n<e.length;n++){var o=e[n];i.push(o.duplicate())}return t.updateBoundWalls(i,e),i},t.clone=function(e){for(var i=[],n=0;n<e.length;n++){var o=e[n];i.push(function(e){if(null!=e.clone)return e.clone();var t=Object.create(e);for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t}(o))}return t.updateBoundWalls(i,e),i},t.updateBoundWalls=function(e,t){for(var i=0;i<t.length;i++){var n=t[i],o=t.indexOf(n.getWallAtStart());-1!==o&&e[i].setWallAtStart(e[o]);var r=t.indexOf(n.getWallAtEnd());-1!==r&&e[i].setWallAtEnd(e[r])}},t.prototype.clone=function(){var t=this,i=function(i){if(null!=e.prototype.clone)return e.prototype.clone.call(t);var n=Object.create(i);for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o]);return n}(this);return i.wallAtStart=null,i.wallAtEnd=null,i.level=null,i.shapeCache=null,i.pointsCache=null,i.pointsIncludingBaseboardsCache=null,i},t}(HomeObject);Wall.__class="com.eteks.sweethome3d.model.Wall",Wall.__interfaces=["com.eteks.sweethome3d.model.Selectable","com.eteks.sweethome3d.model.Elevatable"],Wall.__transients=["shapeCache","arcCircleCenterCache","pointsCache","pointsIncludingBaseboardsCache","propertyChangeSupport"];var DimensionLine=function(e){function t(t,i,n,o,r,l,a,s){var h=this;if("string"!=typeof t&&null!==t||"number"!=typeof i&&null!==i||"number"!=typeof n&&null!==n||"number"!=typeof o&&null!==o||"number"!=typeof r&&null!==r||"number"!=typeof l&&null!==l||"number"!=typeof a&&null!==a||"number"!=typeof s&&null!==s)if("number"!=typeof t&&null!==t||"number"!=typeof i&&null!==i||"number"!=typeof n&&null!==n||"number"!=typeof o&&null!==o||"number"!=typeof r&&null!==r||"number"!=typeof l&&null!==l||"number"!=typeof a&&null!==a||void 0!==s)if("string"!=typeof t&&null!==t||"number"!=typeof i&&null!==i||"number"!=typeof n&&null!==n||"number"!=typeof o&&null!==o||"number"!=typeof r&&null!==r||"number"!=typeof l&&null!==l||void 0!==a||void 0!==s){if("number"!=typeof t&&null!==t||"number"!=typeof i&&null!==i||"number"!=typeof n&&null!==n||"number"!=typeof o&&null!==o||"number"!=typeof r&&null!==r||void 0!==l||void 0!==a||void 0!==s)throw new Error("invalid overload");var u=(A=arguments)[0],d=A[1],c=A[2],p=A[3],g=A[4],m=HomeObject.createId("dimensionLine");void 0===(h=e.call(this,m)||this).xStart&&(h.xStart=0),void 0===h.yStart&&(h.yStart=0),void 0===h.elevationStart&&(h.elevationStart=0),void 0===h.xEnd&&(h.xEnd=0),void 0===h.yEnd&&(h.yEnd=0),void 0===h.elevationEnd&&(h.elevationEnd=0),void 0===h.offset&&(h.offset=0),void 0===h.endMarkSize&&(h.endMarkSize=0),void 0===h.pitch&&(h.pitch=0),void 0===h.lengthStyle&&(h.lengthStyle=null),void 0===h.color&&(h.color=null),void 0===h.visibleIn3D&&(h.visibleIn3D=!1),void 0===h.level&&(h.level=null),void 0===h.shapeCache&&(h.shapeCache=null),h.xStart=u,h.yStart=d,h.elevationStart=0,h.xEnd=c,h.yEnd=p,h.elevationEnd=0,h.offset=g,h.endMarkSize=10,void 0===h.xStart&&(h.xStart=0),void 0===h.yStart&&(h.yStart=0),void 0===h.elevationStart&&(h.elevationStart=0),void 0===h.xEnd&&(h.xEnd=0),void 0===h.yEnd&&(h.yEnd=0),void 0===h.elevationEnd&&(h.elevationEnd=0),void 0===h.offset&&(h.offset=0),void 0===h.endMarkSize&&(h.endMarkSize=0),void 0===h.pitch&&(h.pitch=0),void 0===h.lengthStyle&&(h.lengthStyle=null),void 0===h.color&&(h.color=null),void 0===h.visibleIn3D&&(h.visibleIn3D=!1),void 0===h.level&&(h.level=null),void 0===h.shapeCache&&(h.shapeCache=null),void 0===h.xStart&&(h.xStart=0),void 0===h.yStart&&(h.yStart=0),void 0===h.elevationStart&&(h.elevationStart=0),void 0===h.xEnd&&(h.xEnd=0),void 0===h.yEnd&&(h.yEnd=0),void 0===h.elevationEnd&&(h.elevationEnd=0),void 0===h.offset&&(h.offset=0),void 0===h.endMarkSize&&(h.endMarkSize=0),void 0===h.pitch&&(h.pitch=0),void 0===h.lengthStyle&&(h.lengthStyle=null),void 0===h.color&&(h.color=null),void 0===h.visibleIn3D&&(h.visibleIn3D=!1),void 0===h.level&&(h.level=null),void 0===h.shapeCache&&(h.shapeCache=null)}else{var f=(A=arguments)[3],v=A[4],_=A[5];void 0===(h=e.call(this,t)||this).xStart&&(h.xStart=0),void 0===h.yStart&&(h.yStart=0),void 0===h.elevationStart&&(h.elevationStart=0),void 0===h.xEnd&&(h.xEnd=0),void 0===h.yEnd&&(h.yEnd=0),void 0===h.elevationEnd&&(h.elevationEnd=0),void 0===h.offset&&(h.offset=0),void 0===h.endMarkSize&&(h.endMarkSize=0),void 0===h.pitch&&(h.pitch=0),void 0===h.lengthStyle&&(h.lengthStyle=null),void 0===h.color&&(h.color=null),void 0===h.visibleIn3D&&(h.visibleIn3D=!1),void 0===h.level&&(h.level=null),void 0===h.shapeCache&&(h.shapeCache=null),h.xStart=i,h.yStart=n,h.elevationStart=0,h.xEnd=f,h.yEnd=v,h.elevationEnd=0,h.offset=_,h.endMarkSize=10,void 0===h.xStart&&(h.xStart=0),void 0===h.yStart&&(h.yStart=0),void 0===h.elevationStart&&(h.elevationStart=0),void 0===h.xEnd&&(h.xEnd=0),void 0===h.yEnd&&(h.yEnd=0),void 0===h.elevationEnd&&(h.elevationEnd=0),void 0===h.offset&&(h.offset=0),void 0===h.endMarkSize&&(h.endMarkSize=0),void 0===h.pitch&&(h.pitch=0),void 0===h.lengthStyle&&(h.lengthStyle=null),void 0===h.color&&(h.color=null),void 0===h.visibleIn3D&&(h.visibleIn3D=!1),void 0===h.level&&(h.level=null),void 0===h.shapeCache&&(h.shapeCache=null)}else{var S=(A=arguments)[0],y=A[1],E=A[2],C=A[3],P=A[4],w=A[5],L=A[6],T=HomeObject.createId("dimensionLine");void 0===(h=e.call(this,T)||this).xStart&&(h.xStart=0),void 0===h.yStart&&(h.yStart=0),void 0===h.elevationStart&&(h.elevationStart=0),void 0===h.xEnd&&(h.xEnd=0),void 0===h.yEnd&&(h.yEnd=0),void 0===h.elevationEnd&&(h.elevationEnd=0),void 0===h.offset&&(h.offset=0),void 0===h.endMarkSize&&(h.endMarkSize=0),void 0===h.pitch&&(h.pitch=0),void 0===h.lengthStyle&&(h.lengthStyle=null),void 0===h.color&&(h.color=null),void 0===h.visibleIn3D&&(h.visibleIn3D=!1),void 0===h.level&&(h.level=null),void 0===h.shapeCache&&(h.shapeCache=null),h.xStart=S,h.yStart=y,h.elevationStart=E,h.xEnd=C,h.yEnd=P,h.elevationEnd=w,h.offset=L,h.endMarkSize=10,void 0===h.xStart&&(h.xStart=0),void 0===h.yStart&&(h.yStart=0),void 0===h.elevationStart&&(h.elevationStart=0),void 0===h.xEnd&&(h.xEnd=0),void 0===h.yEnd&&(h.yEnd=0),void 0===h.elevationEnd&&(h.elevationEnd=0),void 0===h.offset&&(h.offset=0),void 0===h.endMarkSize&&(h.endMarkSize=0),void 0===h.pitch&&(h.pitch=0),void 0===h.lengthStyle&&(h.lengthStyle=null),void 0===h.color&&(h.color=null),void 0===h.visibleIn3D&&(h.visibleIn3D=!1),void 0===h.level&&(h.level=null),void 0===h.shapeCache&&(h.shapeCache=null)}else{var A=arguments;void 0===(h=e.call(this,t)||this).xStart&&(h.xStart=0),void 0===h.yStart&&(h.yStart=0),void 0===h.elevationStart&&(h.elevationStart=0),void 0===h.xEnd&&(h.xEnd=0),void 0===h.yEnd&&(h.yEnd=0),void 0===h.elevationEnd&&(h.elevationEnd=0),void 0===h.offset&&(h.offset=0),void 0===h.endMarkSize&&(h.endMarkSize=0),void 0===h.pitch&&(h.pitch=0),void 0===h.lengthStyle&&(h.lengthStyle=null),void 0===h.color&&(h.color=null),void 0===h.visibleIn3D&&(h.visibleIn3D=!1),void 0===h.level&&(h.level=null),void 0===h.shapeCache&&(h.shapeCache=null),h.xStart=i,h.yStart=n,h.elevationStart=o,h.xEnd=r,h.yEnd=l,h.elevationEnd=a,h.offset=s,h.endMarkSize=10}return h}return __extends(t,e),t.prototype.getXStart=function(){return this.xStart},t.prototype.setXStart=function(e){if(e!==this.xStart){var t=this.xStart;this.xStart=e,this.shapeCache=null,this.firePropertyChange("X_START",t,e)}},t.prototype.getYStart=function(){return this.yStart},t.prototype.setYStart=function(e){if(e!==this.yStart){var t=this.yStart;this.yStart=e,this.shapeCache=null,this.firePropertyChange("Y_START",t,e)}},t.prototype.getElevationStart=function(){return this.elevationStart},t.prototype.setElevationStart=function(e){if(e!==this.elevationStart){var t=this.elevationStart;this.elevationStart=e,this.shapeCache=null,this.firePropertyChange("ELEVATION_START",t,e)}},t.prototype.getXEnd=function(){return this.xEnd},t.prototype.setXEnd=function(e){if(e!==this.xEnd){var t=this.xEnd;this.xEnd=e,this.shapeCache=null,this.firePropertyChange("X_END",t,e)}},t.prototype.getYEnd=function(){return this.yEnd},t.prototype.setYEnd=function(e){if(e!==this.yEnd){var t=this.yEnd;this.yEnd=e,this.shapeCache=null,this.firePropertyChange("Y_END",t,e)}},t.prototype.getElevationEnd=function(){return this.elevationEnd},t.prototype.setElevationEnd=function(e){if(e!==this.elevationEnd){var t=this.elevationEnd;this.elevationEnd=e,this.shapeCache=null,this.firePropertyChange("ELEVATION_END",t,e)}},t.prototype.isElevationDimensionLine=function(){return this.xStart===this.xEnd&&this.yStart===this.yEnd&&this.elevationStart!==this.elevationEnd},t.prototype.getOffset=function(){return this.offset},t.prototype.setOffset=function(e){if(e!==this.offset){var t=this.offset;this.offset=e,this.shapeCache=null,this.firePropertyChange("OFFSET",t,e)}},t.prototype.getPitch=function(){return this.pitch},t.prototype.setPitch=function(e){if(e!==this.pitch){var t=this.pitch;this.pitch=e,this.shapeCache=null,this.firePropertyChange("PITCH",t,e)}},t.prototype.getLength=function(){var e=this.xEnd-this.xStart,t=this.yEnd-this.yStart,i=this.elevationEnd-this.elevationStart;return Math.sqrt(e*e+t*t+i*i)},t.prototype.getLengthStyle=function(){return this.lengthStyle},t.prototype.setLengthStyle=function(e){if(e!==this.lengthStyle){var t=this.lengthStyle;this.lengthStyle=e,this.firePropertyChange("LENGTH_STYLE",t,e)}},t.prototype.getColor=function(){return this.color},t.prototype.setColor=function(e){if(e!==this.color){var t=this.color;this.color=e,this.firePropertyChange("COLOR",t,e)}},t.prototype.getEndMarkSize=function(){return this.endMarkSize},t.prototype.setEndMarkSize=function(e){if(e!==this.endMarkSize){var t=this.endMarkSize;this.endMarkSize=e,this.shapeCache=null,this.firePropertyChange("END_MARK_SIZE",t,e)}},t.prototype.isVisibleIn3D=function(){return this.visibleIn3D},t.prototype.setVisibleIn3D=function(e){e!==this.visibleIn3D&&(this.visibleIn3D=e,this.firePropertyChange("VISIBLE_IN_3D",!e,e))},t.prototype.getLevel=function(){return this.level},t.prototype.setLevel=function(e){if(e!==this.level){var t=this.level;this.level=e,this.firePropertyChange("LEVEL",t,e)}},t.prototype.isAtLevel=function(e){if(this.level===e)return!0;if(null!=this.level&&null!=e){var t=this.level.getElevation(),i=e.getElevation();return t===i&&this.level.getElevationIndex()<e.getElevationIndex()||t<i&&t+Math.max(this.elevationStart,this.elevationEnd)>i}return!1},t.prototype.getPoints=function(){var e=this.isElevationDimensionLine()?this.pitch:Math.atan2(this.yEnd-this.yStart,this.xEnd-this.xStart),t=-Math.sin(e)*this.offset,i=Math.cos(e)*this.offset;return[[this.xStart,this.yStart],[this.xStart+t,this.yStart+i],[this.xEnd+t,this.yEnd+i],[this.xEnd,this.yEnd]]},t.prototype.intersectsRectangle=function(e,t,i,n){var o=new java.awt.geom.Rectangle2D.Float(e,t,0,0);return o.add(i,n),this.getShape().intersects(o)},t.prototype.containsPoint=function(e,t,i){return this.containsShapeAtWithMargin(this.getShape(),e,t,i)},t.prototype.isMiddlePointAt=function(e,t,i){if(this.elevationStart===this.elevationEnd){var n=Math.atan2(this.yEnd-this.yStart,this.xEnd-this.xStart),o=-Math.sin(n)*this.offset,r=Math.cos(n)*this.offset,l=(this.xStart+this.xEnd)/2+o,a=(this.yStart+this.yEnd)/2+r;return Math.abs(e-l)<=i&&Math.abs(t-a)<=i}return!1},t.prototype.containsStartExtensionLinetAt=function(e,t,i){if(this.elevationStart===this.elevationEnd){var n=Math.atan2(this.yEnd-this.yStart,this.xEnd-this.xStart),o=new java.awt.geom.Line2D.Float(this.xStart,this.yStart,this.xStart+-Math.sin(n)*this.offset,this.yStart+Math.cos(n)*this.offset);return this.containsShapeAtWithMargin(o,e,t,i)}return!1},t.prototype.containsEndExtensionLineAt=function(e,t,i){if(this.elevationStart===this.elevationEnd){var n=Math.atan2(this.yEnd-this.yStart,this.xEnd-this.xStart),o=new java.awt.geom.Line2D.Float(this.xEnd,this.yEnd,this.xEnd+-Math.sin(n)*this.offset,this.yEnd+Math.cos(n)*this.offset);return this.containsShapeAtWithMargin(o,e,t,i)}return!1},t.prototype.isTopPointAt=function(e,t,i){if(this.elevationStart!==this.elevationEnd){var n=this.yEnd!==this.yStart||this.xEnd!==this.xStart?Math.atan2(this.yEnd-this.yStart,this.xEnd-this.xStart):this.pitch,o=-Math.sin(n)*(this.offset-this.endMarkSize/2*(0==((l=this.offset)>0?1:l<0?-1:0)?-1:function(e){return e>0?1:e<0?-1:0}(this.offset))),r=Math.cos(n)*(this.offset-this.endMarkSize/2*(0===function(e){return e>0?1:e<0?-1:0}(this.offset)?-1:function(e){return e>0?1:e<0?-1:0}(this.offset)));return java.awt.geom.Point2D.distanceSq(e,t,this.xStart+o,this.yStart+r)<=i*i}return!1;var l},t.prototype.isRightPointAt=function(e,t,i){if(this.elevationStart!==this.elevationEnd){var n=this.yEnd!==this.yStart||this.xEnd!==this.xStart?Math.atan2(this.yEnd-this.yStart,this.xEnd-this.xStart):this.pitch,o=Math.sin(n),r=Math.cos(n),l=-o*this.offset+r*this.endMarkSize/2,a=r*this.offset+o*this.endMarkSize/2;return java.awt.geom.Point2D.distanceSq(e,t,this.xStart+l,this.yStart+a)<=i*i}return!1},t.prototype.isBottomPointAt=function(e,t,i){if(this.elevationStart!==this.elevationEnd){var n=this.yEnd!==this.yStart||this.xEnd!==this.xStart?Math.atan2(this.yEnd-this.yStart,this.xEnd-this.xStart):this.pitch,o=-Math.sin(n)*(this.offset+this.endMarkSize/2*(0==((l=this.offset)>0?1:l<0?-1:0)?-1:function(e){return e>0?1:e<0?-1:0}(this.offset))),r=Math.cos(n)*(this.offset+this.endMarkSize/2*(0===function(e){return e>0?1:e<0?-1:0}(this.offset)?-1:function(e){return e>0?1:e<0?-1:0}(this.offset)));return java.awt.geom.Point2D.distanceSq(e,t,this.xStart+o,this.yStart+r)<=i*i}return!1;var l},t.prototype.isLeftPointAt=function(e,t,i){if(this.elevationStart!==this.elevationEnd){var n=this.yEnd!==this.yStart||this.xEnd!==this.xStart?Math.atan2(this.yEnd-this.yStart,this.xEnd-this.xStart):this.pitch,o=Math.sin(n),r=Math.cos(n),l=-o*this.offset-r*this.endMarkSize/2,a=r*this.offset-o*this.endMarkSize/2;return java.awt.geom.Point2D.distanceSq(e,t,this.xStart+l,this.yStart+a)<=i*i}return!1},t.prototype.containsShapeAtWithMargin=function(e,t,i,n){return 0===n?e.contains(t,i):e.intersects(t-n,i-n,2*n,2*n)},t.prototype.getShape=function(){if(null==this.shapeCache){var e=this.yEnd!==this.yStart||this.xEnd!==this.xStart?Math.atan2(this.yEnd-this.yStart,this.xEnd-this.xStart):this.pitch,t=this.elevationStart===this.elevationEnd,i=-Math.sin(e)*this.offset,n=Math.cos(e)*this.offset,o=new java.awt.geom.GeneralPath;t?(o.append(new java.awt.geom.Line2D.Float(this.xStart+i,this.yStart+n,this.xEnd+i,this.yEnd+n),!1),o.append(new java.awt.geom.Line2D.Float(this.xEnd,this.yEnd,this.xEnd+i,this.yEnd+n),!1)):o.append(new java.awt.geom.Ellipse2D.Float(this.xStart+i-this.endMarkSize/2,this.yStart+n-this.endMarkSize/2,this.endMarkSize,this.endMarkSize),!1),o.append(new java.awt.geom.Line2D.Float(this.xStart,this.yStart,this.xStart+i,this.yStart+n),!1),this.shapeCache=o}return this.shapeCache},t.prototype.move=function(e,t){this.setXStart(this.getXStart()+e),this.setYStart(this.getYStart()+t),this.setXEnd(this.getXEnd()+e),this.setYEnd(this.getYEnd()+t)},t.prototype.clone=function(){var t=this,i=function(i){if(null!=e.prototype.clone)return e.prototype.clone.call(t);var n=Object.create(i);for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o]);return n}(this);return i.level=null,i},t}(HomeObject);DimensionLine.__class="com.eteks.sweethome3d.model.DimensionLine",DimensionLine.__interfaces=["com.eteks.sweethome3d.model.Selectable","com.eteks.sweethome3d.model.Elevatable"],DimensionLine.__transients=["shapeCache","propertyChangeSupport"];var Camera=function(e){function t(i,n,o,r,l,a,s,h,u){var d=this;if("string"!=typeof i&&null!==i||"number"!=typeof n&&null!==n||"number"!=typeof o&&null!==o||"number"!=typeof r&&null!==r||"number"!=typeof l&&null!==l||"number"!=typeof a&&null!==a||"number"!=typeof s&&null!==s||"number"!=typeof h&&null!==h||"number"!=typeof u&&null!==u)if("number"!=typeof i&&null!==i||"number"!=typeof n&&null!==n||"number"!=typeof o&&null!==o||"number"!=typeof r&&null!==r||"number"!=typeof l&&null!==l||"number"!=typeof a&&null!==a||"number"!=typeof s&&null!==s||"number"!=typeof h&&null!==h||void 0!==u)if("string"!=typeof i&&null!==i||"number"!=typeof n&&null!==n||"number"!=typeof o&&null!==o||"number"!=typeof r&&null!==r||"number"!=typeof l&&null!==l||"number"!=typeof a&&null!==a||"number"!=typeof s&&null!==s||void 0!==h||void 0!==u){if("number"!=typeof i&&null!==i||"number"!=typeof n&&null!==n||"number"!=typeof o&&null!==o||"number"!=typeof r&&null!==r||"number"!=typeof l&&null!==l||"number"!=typeof a&&null!==a||void 0!==s||void 0!==h||void 0!==u)throw new Error("invalid overload");var c=(D=arguments)[0],p=D[1],g=D[2],m=D[3],f=D[4],v=D[5],_=t.midday(),S=t.Lens.PINHOLE,y=HomeObject.createId("camera");void 0===(d=e.call(this,y)||this).name&&(d.name=null),void 0===d.x&&(d.x=0),void 0===d.y&&(d.y=0),void 0===d.z&&(d.z=0),void 0===d.yaw&&(d.yaw=0),void 0===d.pitch&&(d.pitch=0),void 0===d.fieldOfView&&(d.fieldOfView=0),void 0===d.time&&(d.time=0),void 0===d.lens&&(d.lens=null),void 0===d.lensName&&(d.lensName=null),void 0===d.renderer&&(d.renderer=null),d.x=c,d.y=p,d.z=g,d.yaw=m,d.pitch=f,d.fieldOfView=v,d.time=_,d.lens=S,void 0===d.name&&(d.name=null),void 0===d.x&&(d.x=0),void 0===d.y&&(d.y=0),void 0===d.z&&(d.z=0),void 0===d.yaw&&(d.yaw=0),void 0===d.pitch&&(d.pitch=0),void 0===d.fieldOfView&&(d.fieldOfView=0),void 0===d.time&&(d.time=0),void 0===d.lens&&(d.lens=null),void 0===d.lensName&&(d.lensName=null),void 0===d.renderer&&(d.renderer=null),void 0===d.name&&(d.name=null),void 0===d.x&&(d.x=0),void 0===d.y&&(d.y=0),void 0===d.z&&(d.z=0),void 0===d.yaw&&(d.yaw=0),void 0===d.pitch&&(d.pitch=0),void 0===d.fieldOfView&&(d.fieldOfView=0),void 0===d.time&&(d.time=0),void 0===d.lens&&(d.lens=null),void 0===d.lensName&&(d.lensName=null),void 0===d.renderer&&(d.renderer=null)}else{D=arguments;var E=t.midday(),C=t.Lens.PINHOLE;void 0===(d=e.call(this,i)||this).name&&(d.name=null),void 0===d.x&&(d.x=0),void 0===d.y&&(d.y=0),void 0===d.z&&(d.z=0),void 0===d.yaw&&(d.yaw=0),void 0===d.pitch&&(d.pitch=0),void 0===d.fieldOfView&&(d.fieldOfView=0),void 0===d.time&&(d.time=0),void 0===d.lens&&(d.lens=null),void 0===d.lensName&&(d.lensName=null),void 0===d.renderer&&(d.renderer=null),d.x=n,d.y=o,d.z=r,d.yaw=l,d.pitch=a,d.fieldOfView=s,d.time=E,d.lens=C,void 0===d.name&&(d.name=null),void 0===d.x&&(d.x=0),void 0===d.y&&(d.y=0),void 0===d.z&&(d.z=0),void 0===d.yaw&&(d.yaw=0),void 0===d.pitch&&(d.pitch=0),void 0===d.fieldOfView&&(d.fieldOfView=0),void 0===d.time&&(d.time=0),void 0===d.lens&&(d.lens=null),void 0===d.lensName&&(d.lensName=null),void 0===d.renderer&&(d.renderer=null)}else{var P=(D=arguments)[0],w=D[1],L=D[2],T=D[3],A=D[4],I=D[5],b=D[6],O=D[7],M=HomeObject.createId("camera");void 0===(d=e.call(this,M)||this).name&&(d.name=null),void 0===d.x&&(d.x=0),void 0===d.y&&(d.y=0),void 0===d.z&&(d.z=0),void 0===d.yaw&&(d.yaw=0),void 0===d.pitch&&(d.pitch=0),void 0===d.fieldOfView&&(d.fieldOfView=0),void 0===d.time&&(d.time=0),void 0===d.lens&&(d.lens=null),void 0===d.lensName&&(d.lensName=null),void 0===d.renderer&&(d.renderer=null),d.x=P,d.y=w,d.z=L,d.yaw=T,d.pitch=A,d.fieldOfView=I,d.time=b,d.lens=O,void 0===d.name&&(d.name=null),void 0===d.x&&(d.x=0),void 0===d.y&&(d.y=0),void 0===d.z&&(d.z=0),void 0===d.yaw&&(d.yaw=0),void 0===d.pitch&&(d.pitch=0),void 0===d.fieldOfView&&(d.fieldOfView=0),void 0===d.time&&(d.time=0),void 0===d.lens&&(d.lens=null),void 0===d.lensName&&(d.lensName=null),void 0===d.renderer&&(d.renderer=null)}else{var D=arguments;void 0===(d=e.call(this,i)||this).name&&(d.name=null),void 0===d.x&&(d.x=0),void 0===d.y&&(d.y=0),void 0===d.z&&(d.z=0),void 0===d.yaw&&(d.yaw=0),void 0===d.pitch&&(d.pitch=0),void 0===d.fieldOfView&&(d.fieldOfView=0),void 0===d.time&&(d.time=0),void 0===d.lens&&(d.lens=null),void 0===d.lensName&&(d.lensName=null),void 0===d.renderer&&(d.renderer=null),d.x=n,d.y=o,d.z=r,d.yaw=l,d.pitch=a,d.fieldOfView=s,d.time=h,d.lens=u}return d}return __extends(t,e),t.midday=function(){var e,t=new Date;return(e=t).UTC?e.setUTCHours(12):e.setHours(12),function(e,t){e.UTC?e.setUTCMinutes(0):e.setMinutes(0)}(t),function(e,t){e.UTC?e.setUTCSeconds(0):e.setSeconds(0)}(t),function(e,t){e.UTC?e.setUTCMilliseconds(0):e.setMilliseconds(0)}(t),t.getTime()},t.prototype.getName=function(){return this.name},t.prototype.setName=function(e){if(e!==this.name&&(null==e||e!==this.name)){var t=this.name;this.name=e,this.firePropertyChange("NAME",t,e)}},t.prototype.getYaw=function(){return this.yaw},t.prototype.setYaw=function(e){if(e!==this.yaw){var t=this.yaw;this.yaw=e,this.firePropertyChange("YAW",t,e)}},t.prototype.getPitch=function(){return this.pitch},t.prototype.setPitch=function(e){if(e!==this.pitch){var t=this.pitch;this.pitch=e,this.firePropertyChange("PITCH",t,e)}},t.prototype.getFieldOfView=function(){return this.fieldOfView},t.prototype.setFieldOfView=function(e){if(e!==this.fieldOfView){var t=this.fieldOfView;this.fieldOfView=e,this.firePropertyChange("FIELD_OF_VIEW",t,e)}},t.prototype.getX=function(){return this.x},t.prototype.setX=function(e){if(e!==this.x){var t=this.x;this.x=e,this.firePropertyChange("X",t,e)}},t.prototype.getY=function(){return this.y},t.prototype.setY=function(e){if(e!==this.y){var t=this.y;this.y=e,this.firePropertyChange("Y",t,e)}},t.prototype.getZ=function(){return this.z},t.prototype.setZ=function(e){if(e!==this.z){var t=this.z;this.z=e,this.firePropertyChange("Z",t,e)}},t.prototype.getTime=function(){return this.time},t.prototype.setTime=function(e){if(this.time!==e){var t=this.time;this.time=e,this.firePropertyChange("TIME",t,e)}},t.convertTimeToTimeZone=function(e,t){var i=new Date;i.setTime(e);var n,o=new Date;return function(e,t){e.UTC?e.setUTCFullYear(t):e.setFullYear(t)}(o,(n=i).UTC?n.getUTCFullYear():n.getFullYear()),function(e,t){e.UTC?e.setUTCMonth(t):e.setMonth(t)}(o,function(e){return e.UTC?e.getUTCMonth():e.getMonth()}(i)),function(e,t){e.UTC?e.setUTCDate(t):e.setDate(t)}(o,function(e){return e.UTC?e.getUTCDate():e.getDate()}(i)),function(e,t){e.UTC?e.setUTCHours(t):e.setHours(t)}(o,function(e){return e.UTC?e.getUTCHours():e.getHours()}(i)),function(e,t){e.UTC?e.setUTCMinutes(t):e.setMinutes(t)}(o,function(e){return e.UTC?e.getUTCMinutes():e.getMinutes()}(i)),function(e,t){e.UTC?e.setUTCSeconds(t):e.setSeconds(t)}(o,function(e){return e.UTC?e.getUTCSeconds():e.getSeconds()}(i)),function(e,t){e.UTC?e.setUTCMilliseconds(t):e.setMilliseconds(t)}(o,function(e){return e.UTC?e.getUTCMilliseconds():e.getMilliseconds()}(i)),o.getTime()},t.prototype.getLens=function(){return this.lens},t.prototype.setLens=function(e){if(e!==this.lens){var i=this.lens;this.lens=e,this.lensName=t.Lens[this.lens],this.firePropertyChange("LENS",i,e)}},t.prototype.setRenderer=function(e){if(e!==this.renderer&&(null==e||e!==this.renderer)){var t=this.renderer;this.renderer=e,this.firePropertyChange("RENDERER",t,e)}},t.prototype.getRenderer=function(){return this.renderer},t.prototype.setCamera=function(e){this.setX(e.getX()),this.setY(e.getY()),this.setZ(e.getZ()),this.setYaw(e.getYaw()),this.setPitch(e.getPitch()),this.setFieldOfView(e.getFieldOfView())},t.prototype.clone=function(){var t=this;return function(i){if(null!=e.prototype.clone)return e.prototype.clone.call(t);var n=Object.create(i);for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o]);return n}(this)},t}(HomeObject);Camera.__class="com.eteks.sweethome3d.model.Camera",function(e){var t;(t=e.Lens||(e.Lens={}))[t.PINHOLE=0]="PINHOLE",t[t.NORMAL=1]="NORMAL",t[t.FISHEYE=2]="FISHEYE",t[t.SPHERICAL=3]="SPHERICAL"}(Camera||(Camera={})),Camera.__transients=["lens","propertyChangeSupport"];var Level=function(e){function t(t,i,n,o,r){var l=this;if("string"!=typeof t&&null!==t||"string"!=typeof i&&null!==i||"number"!=typeof n&&null!==n||"number"!=typeof o&&null!==o||"number"!=typeof r&&null!==r){if("string"!=typeof t&&null!==t||"number"!=typeof i&&null!==i||"number"!=typeof n&&null!==n||"number"!=typeof o&&null!==o||void 0!==r)throw new Error("invalid overload");var a=(c=arguments)[0],s=c[1],h=c[2],u=c[3],d=HomeObject.createId("level");void 0===(l=e.call(this,d)||this).name&&(l.name=null),void 0===l.elevation&&(l.elevation=0),void 0===l.floorThickness&&(l.floorThickness=0),void 0===l.height&&(l.height=0),void 0===l.backgroundImage&&(l.backgroundImage=null),void 0===l.visible&&(l.visible=!1),void 0===l.viewable&&(l.viewable=!1),void 0===l.elevationIndex&&(l.elevationIndex=0),l.name=a,l.elevation=s,l.floorThickness=h,l.height=u,l.visible=!0,l.viewable=!0,l.elevationIndex=-1,void 0===l.name&&(l.name=null),void 0===l.elevation&&(l.elevation=0),void 0===l.floorThickness&&(l.floorThickness=0),void 0===l.height&&(l.height=0),void 0===l.backgroundImage&&(l.backgroundImage=null),void 0===l.visible&&(l.visible=!1),void 0===l.viewable&&(l.viewable=!1),void 0===l.elevationIndex&&(l.elevationIndex=0)}else{var c=arguments;void 0===(l=e.call(this,t)||this).name&&(l.name=null),void 0===l.elevation&&(l.elevation=0),void 0===l.floorThickness&&(l.floorThickness=0),void 0===l.height&&(l.height=0),void 0===l.backgroundImage&&(l.backgroundImage=null),void 0===l.visible&&(l.visible=!1),void 0===l.viewable&&(l.viewable=!1),void 0===l.elevationIndex&&(l.elevationIndex=0),l.name=i,l.elevation=n,l.floorThickness=o,l.height=r,l.visible=!0,l.viewable=!0,l.elevationIndex=-1}return l}return __extends(t,e),t.prototype.getName=function(){return this.name},t.prototype.setName=function(e){if(e!==this.name&&(null==e||e!==this.name)){var t=this.name;this.name=e,this.firePropertyChange("NAME",t,e)}},t.prototype.getElevation=function(){return this.elevation},t.prototype.setElevation=function(e){if(e!==this.elevation){var t=this.elevation;this.elevation=e,this.firePropertyChange("ELEVATION",t,e)}},t.prototype.getFloorThickness=function(){return this.floorThickness},t.prototype.setFloorThickness=function(e){if(e!==this.floorThickness){var t=this.floorThickness;this.floorThickness=e,this.firePropertyChange("FLOOR_THICKNESS",t,e)}},t.prototype.getHeight=function(){return this.height},t.prototype.setHeight=function(e){if(e!==this.height){var t=this.height;this.height=e,this.firePropertyChange("HEIGHT",t,e)}},t.prototype.getBackgroundImage=function(){return this.backgroundImage},t.prototype.setBackgroundImage=function(e){if(e!==this.backgroundImage){var t=this.backgroundImage;this.backgroundImage=e,this.firePropertyChange("BACKGROUND_IMAGE",t,e)}},t.prototype.isVisible=function(){return this.visible},t.prototype.setVisible=function(e){e!==this.visible&&(this.visible=e,this.firePropertyChange("VISIBLE",!e,e))},t.prototype.isViewable=function(){return this.viewable},t.prototype.setViewable=function(e){e!==this.viewable&&(this.viewable=e,this.firePropertyChange("VIEWABLE",!e,e))},t.prototype.isViewableAndVisible=function(){return this.viewable&&this.visible},t.prototype.getElevationIndex=function(){return this.elevationIndex},t.prototype.setElevationIndex=function(e){if(e!==this.elevationIndex){var t=this.elevationIndex;this.elevationIndex=e,this.firePropertyChange("ELEVATION_INDEX",t,e)}},t.prototype.clone=function(){var t=this;return function(i){if(null!=e.prototype.clone)return e.prototype.clone.call(t);var n=Object.create(i);for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o]);return n}(this)},t}(HomeObject);Level.__class="com.eteks.sweethome3d.model.Level",Level.__transients=["propertyChangeSupport"];var Polyline=function(e){function t(i,n,o,r,l,a,s,h,u,d,c){var p=this;if("string"!=typeof i&&null!==i||!(null!=n&&n instanceof Array&&(0==n.length||null==n[0]||n[0]instanceof Array)||null===n)||"number"!=typeof o&&null!==o||"number"!=typeof r&&null!==r||"number"!=typeof l&&null!==l||"number"!=typeof a&&null!==a||"number"!=typeof s&&null!==s||"number"!=typeof h&&null!==h||"number"!=typeof u&&null!==u||"boolean"!=typeof d&&null!==d||"number"!=typeof c&&null!==c)if(!(null!=i&&i instanceof Array&&(0==i.length||null==i[0]||i[0]instanceof Array)||null===i)||"number"!=typeof n&&null!==n||"number"!=typeof o&&null!==o||"number"!=typeof r&&null!==r||"number"!=typeof l&&null!==l||"number"!=typeof a&&null!==a||"number"!=typeof s&&null!==s||"number"!=typeof h&&null!==h||"boolean"!=typeof u&&null!==u||"number"!=typeof d&&null!==d||void 0!==c)if(!(null!=i&&i instanceof Array&&(0==i.length||null==i[0]||i[0]instanceof Array)||null===i)||"number"!=typeof n&&null!==n||"number"!=typeof o&&null!==o||"number"!=typeof r&&null!==r||"number"!=typeof l&&null!==l||"number"!=typeof a&&null!==a||"number"!=typeof s&&null!==s||"boolean"!=typeof h&&null!==h||"number"!=typeof u&&null!==u||void 0!==d||void 0!==c)if("string"!=typeof i&&null!==i||!(null!=n&&n instanceof Array&&(0==n.length||null==n[0]||n[0]instanceof Array)||null===n)||void 0!==o||void 0!==r||void 0!==l||void 0!==a||void 0!==s||void 0!==h||void 0!==u||void 0!==d||void 0!==c){if(!(null!=i&&i instanceof Array&&(0==i.length||null==i[0]||i[0]instanceof Array)||null===i)||void 0!==n||void 0!==o||void 0!==r||void 0!==l||void 0!==a||void 0!==s||void 0!==h||void 0!==u||void 0!==d||void 0!==c)throw new Error("invalid overload");var g=(z=arguments)[0],m=t.CapStyle.BUTT,f=t.JoinStyle.MITER,v=t.DashStyle.SOLID,_=t.ArrowStyle.NONE,S=t.ArrowStyle.NONE,y=HomeObject.createId("polyline");void 0===(p=e.call(this,y)||this).points&&(p.points=null),void 0===p.thickness&&(p.thickness=0),void 0===p.capStyle&&(p.capStyle=null),void 0===p.capStyleName&&(p.capStyleName=null),void 0===p.joinStyle&&(p.joinStyle=null),void 0===p.joinStyleName&&(p.joinStyleName=null),void 0===p.dashStyle&&(p.dashStyle=null),void 0===p.dashStyleName&&(p.dashStyleName=null),void 0===p.dashPattern&&(p.dashPattern=null),void 0===p.dashOffset&&(p.dashOffset=0),void 0===p.startArrowStyle&&(p.startArrowStyle=null),void 0===p.startArrowStyleName&&(p.startArrowStyleName=null),void 0===p.endArrowStyle&&(p.endArrowStyle=null),void 0===p.endArrowStyleName&&(p.endArrowStyleName=null),void 0===p.closedPath&&(p.closedPath=!1),void 0===p.color&&(p.color=0),void 0===p.elevation&&(p.elevation=null),void 0===p.level&&(p.level=null),void 0===p.polylinePathCache&&(p.polylinePathCache=null),void 0===p.shapeCache&&(p.shapeCache=null),p.points=p.deepCopy(g),p.thickness=1,p.capStyle=m,p.joinStyle=f,p.dashStyle=v,p.dashOffset=0,p.startArrowStyle=_,p.endArrowStyle=S,p.closedPath=!1,p.color=-16777216,void 0===p.points&&(p.points=null),void 0===p.thickness&&(p.thickness=0),void 0===p.capStyle&&(p.capStyle=null),void 0===p.capStyleName&&(p.capStyleName=null),void 0===p.joinStyle&&(p.joinStyle=null),void 0===p.joinStyleName&&(p.joinStyleName=null),void 0===p.dashStyle&&(p.dashStyle=null),void 0===p.dashStyleName&&(p.dashStyleName=null),void 0===p.dashPattern&&(p.dashPattern=null),void 0===p.dashOffset&&(p.dashOffset=0),void 0===p.startArrowStyle&&(p.startArrowStyle=null),void 0===p.startArrowStyleName&&(p.startArrowStyleName=null),void 0===p.endArrowStyle&&(p.endArrowStyle=null),void 0===p.endArrowStyleName&&(p.endArrowStyleName=null),void 0===p.closedPath&&(p.closedPath=!1),void 0===p.color&&(p.color=0),void 0===p.elevation&&(p.elevation=null),void 0===p.level&&(p.level=null),void 0===p.polylinePathCache&&(p.polylinePathCache=null),void 0===p.shapeCache&&(p.shapeCache=null),void 0===p.points&&(p.points=null),void 0===p.thickness&&(p.thickness=0),void 0===p.capStyle&&(p.capStyle=null),void 0===p.capStyleName&&(p.capStyleName=null),void 0===p.joinStyle&&(p.joinStyle=null),void 0===p.joinStyleName&&(p.joinStyleName=null),void 0===p.dashStyle&&(p.dashStyle=null),void 0===p.dashStyleName&&(p.dashStyleName=null),void 0===p.dashPattern&&(p.dashPattern=null),void 0===p.dashOffset&&(p.dashOffset=0),void 0===p.startArrowStyle&&(p.startArrowStyle=null),void 0===p.startArrowStyleName&&(p.startArrowStyleName=null),void 0===p.endArrowStyle&&(p.endArrowStyle=null),void 0===p.endArrowStyleName&&(p.endArrowStyleName=null),void 0===p.closedPath&&(p.closedPath=!1),void 0===p.color&&(p.color=0),void 0===p.elevation&&(p.elevation=null),void 0===p.level&&(p.level=null),void 0===p.polylinePathCache&&(p.polylinePathCache=null),void 0===p.shapeCache&&(p.shapeCache=null),void 0===p.points&&(p.points=null),void 0===p.thickness&&(p.thickness=0),void 0===p.capStyle&&(p.capStyle=null),void 0===p.capStyleName&&(p.capStyleName=null),void 0===p.joinStyle&&(p.joinStyle=null),void 0===p.joinStyleName&&(p.joinStyleName=null),void 0===p.dashStyle&&(p.dashStyle=null),void 0===p.dashStyleName&&(p.dashStyleName=null),void 0===p.dashPattern&&(p.dashPattern=null),void 0===p.dashOffset&&(p.dashOffset=0),void 0===p.startArrowStyle&&(p.startArrowStyle=null),void 0===p.startArrowStyleName&&(p.startArrowStyleName=null),void 0===p.endArrowStyle&&(p.endArrowStyle=null),void 0===p.endArrowStyleName&&(p.endArrowStyleName=null),void 0===p.closedPath&&(p.closedPath=!1),void 0===p.color&&(p.color=0),void 0===p.elevation&&(p.elevation=null),void 0===p.level&&(p.level=null),void 0===p.polylinePathCache&&(p.polylinePathCache=null),void 0===p.shapeCache&&(p.shapeCache=null)}else{z=arguments;var E=t.CapStyle.BUTT,C=t.JoinStyle.MITER,P=t.DashStyle.SOLID,w=t.ArrowStyle.NONE,L=t.ArrowStyle.NONE;void 0===(p=e.call(this,i)||this).points&&(p.points=null),void 0===p.thickness&&(p.thickness=0),void 0===p.capStyle&&(p.capStyle=null),void 0===p.capStyleName&&(p.capStyleName=null),void 0===p.joinStyle&&(p.joinStyle=null),void 0===p.joinStyleName&&(p.joinStyleName=null),void 0===p.dashStyle&&(p.dashStyle=null),void 0===p.dashStyleName&&(p.dashStyleName=null),void 0===p.dashPattern&&(p.dashPattern=null),void 0===p.dashOffset&&(p.dashOffset=0),void 0===p.startArrowStyle&&(p.startArrowStyle=null),void 0===p.startArrowStyleName&&(p.startArrowStyleName=null),void 0===p.endArrowStyle&&(p.endArrowStyle=null),void 0===p.endArrowStyleName&&(p.endArrowStyleName=null),void 0===p.closedPath&&(p.closedPath=!1),void 0===p.color&&(p.color=0),void 0===p.elevation&&(p.elevation=null),void 0===p.level&&(p.level=null),void 0===p.polylinePathCache&&(p.polylinePathCache=null),void 0===p.shapeCache&&(p.shapeCache=null),p.points=p.deepCopy(n),p.thickness=1,p.capStyle=E,p.joinStyle=C,p.dashStyle=P,p.dashOffset=0,p.startArrowStyle=w,p.endArrowStyle=L,p.closedPath=!1,p.color=-16777216,void 0===p.points&&(p.points=null),void 0===p.thickness&&(p.thickness=0),void 0===p.capStyle&&(p.capStyle=null),void 0===p.capStyleName&&(p.capStyleName=null),void 0===p.joinStyle&&(p.joinStyle=null),void 0===p.joinStyleName&&(p.joinStyleName=null),void 0===p.dashStyle&&(p.dashStyle=null),void 0===p.dashStyleName&&(p.dashStyleName=null),void 0===p.dashPattern&&(p.dashPattern=null),void 0===p.dashOffset&&(p.dashOffset=0),void 0===p.startArrowStyle&&(p.startArrowStyle=null),void 0===p.startArrowStyleName&&(p.startArrowStyleName=null),void 0===p.endArrowStyle&&(p.endArrowStyle=null),void 0===p.endArrowStyleName&&(p.endArrowStyleName=null),void 0===p.closedPath&&(p.closedPath=!1),void 0===p.color&&(p.color=0),void 0===p.elevation&&(p.elevation=null),void 0===p.level&&(p.level=null),void 0===p.polylinePathCache&&(p.polylinePathCache=null),void 0===p.shapeCache&&(p.shapeCache=null)}else{var T=(z=arguments)[0],A=z[1],I=z[2],b=z[3],O=z[4],M=z[5],D=z[6],R=z[7],F=z[8],x=HomeObject.createId("polyline");void 0===(p=e.call(this,x)||this).points&&(p.points=null),void 0===p.thickness&&(p.thickness=0),void 0===p.capStyle&&(p.capStyle=null),void 0===p.capStyleName&&(p.capStyleName=null),void 0===p.joinStyle&&(p.joinStyle=null),void 0===p.joinStyleName&&(p.joinStyleName=null),void 0===p.dashStyle&&(p.dashStyle=null),void 0===p.dashStyleName&&(p.dashStyleName=null),void 0===p.dashPattern&&(p.dashPattern=null),void 0===p.dashOffset&&(p.dashOffset=0),void 0===p.startArrowStyle&&(p.startArrowStyle=null),void 0===p.startArrowStyleName&&(p.startArrowStyleName=null),void 0===p.endArrowStyle&&(p.endArrowStyle=null),void 0===p.endArrowStyleName&&(p.endArrowStyleName=null),void 0===p.closedPath&&(p.closedPath=!1),void 0===p.color&&(p.color=0),void 0===p.elevation&&(p.elevation=null),void 0===p.level&&(p.level=null),void 0===p.polylinePathCache&&(p.polylinePathCache=null),void 0===p.shapeCache&&(p.shapeCache=null),p.points=p.deepCopy(T),p.thickness=A,p.capStyle=I,p.joinStyle=b,p.dashStyle=O,p.dashOffset=0,p.startArrowStyle=M,p.endArrowStyle=D,p.closedPath=R,p.color=F,void 0===p.points&&(p.points=null),void 0===p.thickness&&(p.thickness=0),void 0===p.capStyle&&(p.capStyle=null),void 0===p.capStyleName&&(p.capStyleName=null),void 0===p.joinStyle&&(p.joinStyle=null),void 0===p.joinStyleName&&(p.joinStyleName=null),void 0===p.dashStyle&&(p.dashStyle=null),void 0===p.dashStyleName&&(p.dashStyleName=null),void 0===p.dashPattern&&(p.dashPattern=null),void 0===p.dashOffset&&(p.dashOffset=0),void 0===p.startArrowStyle&&(p.startArrowStyle=null),void 0===p.startArrowStyleName&&(p.startArrowStyleName=null),void 0===p.endArrowStyle&&(p.endArrowStyle=null),void 0===p.endArrowStyleName&&(p.endArrowStyleName=null),void 0===p.closedPath&&(p.closedPath=!1),void 0===p.color&&(p.color=0),void 0===p.elevation&&(p.elevation=null),void 0===p.level&&(p.level=null),void 0===p.polylinePathCache&&(p.polylinePathCache=null),void 0===p.shapeCache&&(p.shapeCache=null),void 0===p.points&&(p.points=null),void 0===p.thickness&&(p.thickness=0),void 0===p.capStyle&&(p.capStyle=null),void 0===p.capStyleName&&(p.capStyleName=null),void 0===p.joinStyle&&(p.joinStyle=null),void 0===p.joinStyleName&&(p.joinStyleName=null),void 0===p.dashStyle&&(p.dashStyle=null),void 0===p.dashStyleName&&(p.dashStyleName=null),void 0===p.dashPattern&&(p.dashPattern=null),void 0===p.dashOffset&&(p.dashOffset=0),void 0===p.startArrowStyle&&(p.startArrowStyle=null),void 0===p.startArrowStyleName&&(p.startArrowStyleName=null),void 0===p.endArrowStyle&&(p.endArrowStyle=null),void 0===p.endArrowStyleName&&(p.endArrowStyleName=null),void 0===p.closedPath&&(p.closedPath=!1),void 0===p.color&&(p.color=0),void 0===p.elevation&&(p.elevation=null),void 0===p.level&&(p.level=null),void 0===p.polylinePathCache&&(p.polylinePathCache=null),void 0===p.shapeCache&&(p.shapeCache=null)}else{var N=(z=arguments)[0],k=z[1],H=z[2],V=z[3],U=z[4],W=z[5],B=z[6],G=z[7],Y=z[8],$=z[9],X=HomeObject.createId("polyline");void 0===(p=e.call(this,X)||this).points&&(p.points=null),void 0===p.thickness&&(p.thickness=0),void 0===p.capStyle&&(p.capStyle=null),void 0===p.capStyleName&&(p.capStyleName=null),void 0===p.joinStyle&&(p.joinStyle=null),void 0===p.joinStyleName&&(p.joinStyleName=null),void 0===p.dashStyle&&(p.dashStyle=null),void 0===p.dashStyleName&&(p.dashStyleName=null),void 0===p.dashPattern&&(p.dashPattern=null),void 0===p.dashOffset&&(p.dashOffset=0),void 0===p.startArrowStyle&&(p.startArrowStyle=null),void 0===p.startArrowStyleName&&(p.startArrowStyleName=null),void 0===p.endArrowStyle&&(p.endArrowStyle=null),void 0===p.endArrowStyleName&&(p.endArrowStyleName=null),void 0===p.closedPath&&(p.closedPath=!1),void 0===p.color&&(p.color=0),void 0===p.elevation&&(p.elevation=null),void 0===p.level&&(p.level=null),void 0===p.polylinePathCache&&(p.polylinePathCache=null),void 0===p.shapeCache&&(p.shapeCache=null),p.points=p.deepCopy(N),p.thickness=k,p.capStyle=H,p.joinStyle=V,p.dashStyle=U,p.dashOffset=W,p.startArrowStyle=B,p.endArrowStyle=G,p.closedPath=Y,p.color=$,void 0===p.points&&(p.points=null),void 0===p.thickness&&(p.thickness=0),void 0===p.capStyle&&(p.capStyle=null),void 0===p.capStyleName&&(p.capStyleName=null),void 0===p.joinStyle&&(p.joinStyle=null),void 0===p.joinStyleName&&(p.joinStyleName=null),void 0===p.dashStyle&&(p.dashStyle=null),void 0===p.dashStyleName&&(p.dashStyleName=null),void 0===p.dashPattern&&(p.dashPattern=null),void 0===p.dashOffset&&(p.dashOffset=0),void 0===p.startArrowStyle&&(p.startArrowStyle=null),void 0===p.startArrowStyleName&&(p.startArrowStyleName=null),void 0===p.endArrowStyle&&(p.endArrowStyle=null),void 0===p.endArrowStyleName&&(p.endArrowStyleName=null),void 0===p.closedPath&&(p.closedPath=!1),void 0===p.color&&(p.color=0),void 0===p.elevation&&(p.elevation=null),void 0===p.level&&(p.level=null),void 0===p.polylinePathCache&&(p.polylinePathCache=null),void 0===p.shapeCache&&(p.shapeCache=null)}else{var z=arguments;void 0===(p=e.call(this,i)||this).points&&(p.points=null),void 0===p.thickness&&(p.thickness=0),void 0===p.capStyle&&(p.capStyle=null),void 0===p.capStyleName&&(p.capStyleName=null),void 0===p.joinStyle&&(p.joinStyle=null),void 0===p.joinStyleName&&(p.joinStyleName=null),void 0===p.dashStyle&&(p.dashStyle=null),void 0===p.dashStyleName&&(p.dashStyleName=null),void 0===p.dashPattern&&(p.dashPattern=null),void 0===p.dashOffset&&(p.dashOffset=0),void 0===p.startArrowStyle&&(p.startArrowStyle=null),void 0===p.startArrowStyleName&&(p.startArrowStyleName=null),void 0===p.endArrowStyle&&(p.endArrowStyle=null),void 0===p.endArrowStyleName&&(p.endArrowStyleName=null),void 0===p.closedPath&&(p.closedPath=!1),void 0===p.color&&(p.color=0),void 0===p.elevation&&(p.elevation=null),void 0===p.level&&(p.level=null),void 0===p.polylinePathCache&&(p.polylinePathCache=null),void 0===p.shapeCache&&(p.shapeCache=null),p.points=p.deepCopy(n),p.thickness=o,p.capStyle=r,p.joinStyle=l,p.dashStyle=a,p.dashOffset=s,p.startArrowStyle=h,p.endArrowStyle=u,p.closedPath=d,p.color=c}return p}return __extends(t,e),t.prototype.getPoints=function(){return this.deepCopy(this.points)},t.prototype.getPointCount=function(){return this.points.length},t.prototype.deepCopy=function(e){for(var t=function(e){for(var t=[];e-- >0;)t.push(null);return t}(e.length),i=0;i<e.length;i++)t[i]=e[i].slice(0);return t},t.prototype.setPoints=function(e){JSON.stringify(this.points)!==JSON.stringify(e)&&this.updatePoints(e)},t.prototype.updatePoints=function(e){var t=this.points;this.points=this.deepCopy(e),this.polylinePathCache=null,this.shapeCache=null,this.firePropertyChange("POINTS",t,e)},t.prototype.addPoint$float$float=function(e,t){this.addPoint$float$float$int(e,t,this.points.length)},t.prototype.addPoint$float$float$int=function(e,t,i){if(i<0||i>this.points.length)throw Object.defineProperty(new Error("Invalid index "+i),"__classes",{configurable:!0,value:["java.lang.Throwable","java.lang.IndexOutOfBoundsException","java.lang.Object","java.lang.RuntimeException","java.lang.Exception"]});var n=function(e){for(var t=[];e-- >0;)t.push(null);return t}(this.points.length+1);!function(e,t,i,n,o){if(e!==i||n>=t+o)for(;--o>=0;)i[n++]=e[t++];else for(var r=e.slice(t,t+o),l=0;l<o;l++)i[n++]=r[l]}(this.points,0,n,0,i),n[i]=[e,t],function(e,t,i,n,o){if(e!==i||n>=t+o)for(;--o>=0;)i[n++]=e[t++];else for(var r=e.slice(t,t+o),l=0;l<o;l++)i[n++]=r[l]}(this.points,i,n,i+1,this.points.length-i);var o=this.points;this.points=n,this.polylinePathCache=null,this.shapeCache=null,this.firePropertyChange("POINTS",o,this.deepCopy(this.points))},t.prototype.addPoint=function(e,t,i){if("number"!=typeof e&&null!==e||"number"!=typeof t&&null!==t||"number"!=typeof i&&null!==i){if("number"!=typeof e&&null!==e||"number"!=typeof t&&null!==t||void 0!==i)throw new Error("invalid overload");return this.addPoint$float$float(e,t)}return this.addPoint$float$float$int(e,t,i)},t.prototype.setPoint=function(e,t,i){if(i<0||i>=this.points.length)throw Object.defineProperty(new Error("Invalid index "+i),"__classes",{configurable:!0,value:["java.lang.Throwable","java.lang.IndexOutOfBoundsException","java.lang.Object","java.lang.RuntimeException","java.lang.Exception"]});if(this.points[i][0]!==e||this.points[i][1]!==t){var n=this.points;this.points=this.deepCopy(this.points),this.points[i][0]=e,this.points[i][1]=t,this.polylinePathCache=null,this.shapeCache=null,this.firePropertyChange("POINTS",n,this.deepCopy(this.points))}},t.prototype.removePoint=function(e){if(e<0||e>=this.points.length)throw Object.defineProperty(new Error("Invalid index "+e),"__classes",{configurable:!0,value:["java.lang.Throwable","java.lang.IndexOutOfBoundsException","java.lang.Object","java.lang.RuntimeException","java.lang.Exception"]});var t=function(e){for(var t=[];e-- >0;)t.push(null);return t}(this.points.length-1);!function(e,t,i,n,o){if(e!==i||n>=t+o)for(;--o>=0;)i[n++]=e[t++];else for(var r=e.slice(t,t+o),l=0;l<o;l++)i[n++]=r[l]}(this.points,0,t,0,e),function(e,t,i,n,o){if(e!==i||n>=t+o)for(;--o>=0;)i[n++]=e[t++];else for(var r=e.slice(t,t+o),l=0;l<o;l++)i[n++]=r[l]}(this.points,e+1,t,e,this.points.length-e-1);var i=this.points;this.points=t,this.polylinePathCache=null,this.shapeCache=null,this.firePropertyChange("POINTS",i,this.deepCopy(this.points))},t.prototype.getThickness=function(){return this.thickness},t.prototype.setThickness=function(e){if(e!==this.thickness){var t=this.thickness;this.thickness=e,this.firePropertyChange("THICKNESS",t,e)}},t.prototype.getCapStyle=function(){return this.capStyle},t.prototype.setCapStyle=function(e){if(e!==this.capStyle){var i=this.capStyle;this.capStyle=e,this.capStyleName=t.CapStyle[this.capStyle],this.firePropertyChange("CAP_STYLE",i,e)}},t.prototype.getJoinStyle=function(){return this.joinStyle},t.prototype.setJoinStyle=function(e){if(e!==this.joinStyle){var i=this.joinStyle;this.joinStyle=e,this.joinStyleName=t.JoinStyle[this.joinStyle],this.polylinePathCache=null,this.shapeCache=null,this.firePropertyChange("JOIN_STYLE",i,e)}},t.prototype.getDashStyle=function(){return this.dashStyle},t.prototype.setDashStyle=function(e){if(e!==this.dashStyle){var i=this.getDashPattern(),n=this.dashStyle;this.dashStyle=e,this.dashStyleName=t.DashStyle[this.dashStyle],e!==t.DashStyle.CUSTOMIZED&&(this.dashPattern=null),this.firePropertyChange("DASH_PATTERN",i,this.getDashPattern()),this.firePropertyChange("DASH_STYLE",n,e)}},t.prototype.getDashPattern=function(){var e=null;return this.dashStyle!==t.DashStyle.CUSTOMIZED?t.DashStyle._$wrappers[this.dashStyle].getDashPattern():(null!=this.dashPattern&&(e=this.dashPattern.slice(0)),e)},t.prototype.setDashPattern=function(e){for(var i=function(){var e=[];for(var i in t.DashStyle)isNaN(i)||e.push(parseInt(i,10));return e}(),n=0;n<i.length;n++){var o=i[n];if(this.dashStyle!==t.DashStyle.CUSTOMIZED&&function(e,t){if(null==e&&null==t)return!0;if(null==e||null==t)return!1;if(e.length!=t.length)return!1;for(var i=0;i<e.length;i++)if(e[i]!=t[i])return!1;return!0}(e,t.DashStyle._$wrappers[o].getDashPattern()))return void this.setDashStyle(o)}if(!function(e,t){if(null==e&&null==t)return!0;if(null==e||null==t)return!1;if(e.length!=t.length)return!1;for(var i=0;i<e.length;i++)if(e[i]!=t[i])return!1;return!0}(e,this.dashPattern)){var r=this.getDashPattern();this.dashPattern=e.slice(0),this.firePropertyChange("DASH_PATTERN",r,e);var l=this.dashStyle;this.dashStyle=t.DashStyle.CUSTOMIZED,this.dashStyleName=t.DashStyle[this.dashStyle],this.firePropertyChange("DASH_STYLE",l,t.DashStyle.CUSTOMIZED)}},t.prototype.getDashOffset=function(){return this.dashOffset},t.prototype.setDashOffset=function(e){if(e!==this.dashOffset){var t=this.dashOffset;this.dashOffset=e,this.firePropertyChange("DASH_OFFSET",t,e)}},t.prototype.getStartArrowStyle=function(){return this.startArrowStyle},t.prototype.setStartArrowStyle=function(e){if(e!==this.startArrowStyle){var i=this.startArrowStyle;this.startArrowStyle=e,this.startArrowStyleName=t.ArrowStyle[this.startArrowStyle],this.firePropertyChange("START_ARROW_STYLE",i,e)}},t.prototype.getEndArrowStyle=function(){return this.endArrowStyle},t.prototype.setEndArrowStyle=function(e){if(e!==this.endArrowStyle){var i=this.endArrowStyle;this.endArrowStyle=e,this.endArrowStyleName=t.ArrowStyle[this.endArrowStyle],this.firePropertyChange("END_ARROW_STYLE",i,e)}},t.prototype.isClosedPath=function(){return this.closedPath},t.prototype.setClosedPath=function(e){e!==this.closedPath&&(this.closedPath=e,this.firePropertyChange("CLOSED_PATH",!e,e))},t.prototype.getColor=function(){return this.color},t.prototype.setColor=function(e){if(e!==this.color){var t=this.color;this.color=e,this.firePropertyChange("COLOR",t,e)}},t.prototype.getGroundElevation=function(){var e=this.getElevation();return null!=this.level?e+this.level.getElevation():e},t.prototype.getElevation=function(){return null!=this.elevation?this.elevation:0},t.prototype.setElevation=function(e){if(null!=this.elevation&&e!==this.elevation){var t=this.elevation;this.elevation=e,this.firePropertyChange("ELEVATION",t,e)}},t.prototype.isVisibleIn3D=function(){return null!=this.elevation},t.prototype.setVisibleIn3D=function(e){e!==(null!=this.elevation)&&(this.elevation=e?0:null,this.firePropertyChange("VISIBLE_IN_3D",!e,e))},t.prototype.getLevel=function(){return this.level},t.prototype.setLevel=function(e){if(e!==this.level){var t=this.level;this.level=e,this.firePropertyChange("LEVEL",t,e)}},t.prototype.isAtLevel=function(e){return this.level===e||null!=this.level&&null!=e&&this.level.getElevation()===e.getElevation()&&this.level.getElevationIndex()<e.getElevationIndex()},t.prototype.getLength=function(){for(var e=[0,0],t=[0,0],i=[0,0],n=0,o=this.getPolylinePath().getPathIterator(null,.1);!o.isDone();o.next())switch(o.currentSegment(i)){case java.awt.geom.PathIterator.SEG_CLOSE:n+=java.awt.geom.Point2D.distance(e[0],e[1],t[0],t[1]);break;case java.awt.geom.PathIterator.SEG_MOVETO:!function(e,t,i,n,o){if(e!==i||n>=t+o)for(;--o>=0;)i[n++]=e[t++];else for(var r=e.slice(t,t+o),l=0;l<o;l++)i[n++]=r[l]}(i,0,e,0,2),function(e,t,i,n,o){if(e!==i||n>=t+o)for(;--o>=0;)i[n++]=e[t++];else for(var r=e.slice(t,t+o),l=0;l<o;l++)i[n++]=r[l]}(i,0,t,0,2);break;case java.awt.geom.PathIterator.SEG_LINETO:n+=java.awt.geom.Point2D.distance(t[0],t[1],i[0],i[1]),function(e,t,i,n,o){if(e!==i||n>=t+o)for(;--o>=0;)i[n++]=e[t++];else for(var r=e.slice(t,t+o),l=0;l<o;l++)i[n++]=r[l]}(i,0,t,0,2)}return n},t.prototype.intersectsRectangle=function(e,t,i,n){var o=new java.awt.geom.Rectangle2D.Float(e,t,0,0);return o.add(i,n),this.getShape().intersects(o)},t.prototype.containsPoint=function(e,t,i){return this.containsShapeAtWithMargin(this.getShape(),e,t,i)},t.prototype.getPointIndexAt=function(e,t,i){for(var n=0;n<this.points.length;n++)if(Math.abs(e-this.points[n][0])<=i&&Math.abs(t-this.points[n][1])<=i)return n;return-1},t.prototype.containsShapeAtWithMargin=function(e,t,i,n){return 0===n?e.contains(t,i):e.intersects(t-n,i-n,2*n,2*n)},t.prototype.getPolylinePath=function(){if(null==this.polylinePathCache){var e=new java.awt.geom.GeneralPath;if(this.joinStyle===t.JoinStyle.CURVED)for(var i=0,n=this.closedPath?this.points.length:this.points.length-1;i<n;i++){var o=new java.awt.geom.CubicCurve2D.Float,r=this.points[0===i?this.points.length-1:i-1],l=this.points[i],a=this.points[i===this.points.length-1?0:i+1],s=[a[0]-r[0],a[1]-r[1]],h=this.points[(i+2)%this.points.length],u=[l[0]-h[0],l[1]-h[1]];o.setCurve(l[0],l[1],l[0]+(0!==i||this.closedPath?s[0]/3.625:0),l[1]+(0!==i||this.closedPath?s[1]/3.625:0),a[0]+(i!==this.points.length-2||this.closedPath?u[0]/3.625:0),a[1]+(i!==this.points.length-2||this.closedPath?u[1]/3.625:0),a[0],a[1]),e.append(o,!0)}else{e.moveTo(this.points[0][0],this.points[0][1]);for(i=1;i<this.points.length;i++)e.lineTo(this.points[i][0],this.points[i][1]);this.closedPath&&e.closePath()}this.polylinePathCache=e}return this.polylinePathCache},t.prototype.getShape=function(){return null==this.shapeCache&&(this.shapeCache=new java.awt.BasicStroke(this.thickness).createStrokedShape(this.getPolylinePath())),this.shapeCache},t.prototype.move=function(e,t){if(0!==e||0!==t){for(var i=this.getPoints(),n=0;n<i.length;n++)i[n][0]+=e,i[n][1]+=t;this.updatePoints(i)}},t.prototype.clone=function(){var t=this,i=function(i){if(null!=e.prototype.clone)return e.prototype.clone.call(t);var n=Object.create(i);for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o]);return n}(this);return i.level=null,i},t}(HomeObject);Polyline.__class="com.eteks.sweethome3d.model.Polyline",Polyline.__interfaces=["com.eteks.sweethome3d.model.Selectable","com.eteks.sweethome3d.model.Elevatable"],function(e){var t,i;(t=e.CapStyle||(e.CapStyle={}))[t.BUTT=0]="BUTT",t[t.SQUARE=1]="SQUARE",t[t.ROUND=2]="ROUND",function(e){e[e.BEVEL=0]="BEVEL",e[e.MITER=1]="MITER",e[e.ROUND=2]="ROUND",e[e.CURVED=3]="CURVED"}(e.JoinStyle||(e.JoinStyle={})),function(e){e[e.NONE=0]="NONE",e[e.DELTA=1]="DELTA",e[e.OPEN=2]="OPEN",e[e.DISC=3]="DISC"}(e.ArrowStyle||(e.ArrowStyle={})),function(e){e[e.SOLID=0]="SOLID",e[e.DOT=1]="DOT",e[e.DASH=2]="DASH",e[e.DASH_DOT=3]="DASH_DOT",e[e.DASH_DOT_DOT=4]="DASH_DOT_DOT",e[e.CUSTOMIZED=5]="CUSTOMIZED"}(i=e.DashStyle||(e.DashStyle={}));var n=function(){function t(e,t){this._$ordinal=e,this._$name=t}return t.prototype.getDashPattern=function(){switch(this._$ordinal){case e.DashStyle.SOLID:return[1,0];case e.DashStyle.DOT:return[1,1];case e.DashStyle.DASH:return[4,2];case e.DashStyle.DASH_DOT:return[8,2,2,2];case e.DashStyle.DASH_DOT_DOT:return[8,2,2,2,2,2];default:return null}},t.prototype.name=function(){return this._$name},t.prototype.ordinal=function(){return this._$ordinal},t.prototype.compareTo=function(e){return this._$ordinal-(isNaN(e)?e._$ordinal:e)},t}();e.DashStyle_$WRAPPER=n,i.__class="com.eteks.sweethome3d.model.Polyline.DashStyle",i._$wrappers={0:new n(0,"SOLID"),1:new n(1,"DOT"),2:new n(2,"DASH"),3:new n(3,"DASH_DOT"),4:new n(4,"DASH_DOT_DOT"),5:new n(5,"CUSTOMIZED")}}(Polyline||(Polyline={})),Polyline.__transients=["capStyle","joinStyle","dashStyle","startArrowStyle","endArrowStyle","polylinePathCache","shapeCache","propertyChangeSupport"];var CatalogDoorOrWindow=function(e){function t(t,i,n,o,r,l,a,s,h,u,d,c,p,g,m,f,v,_,S,y,E,C,P,w,L,T,A,I,b,O,M,D,R,F,x){var N=this;if("string"!=typeof t&&null!==t||"string"!=typeof i&&null!==i||"string"!=typeof n&&null!==n||"string"!=typeof o&&null!==o||"string"!=typeof r&&null!==r||!(null!=l&&l instanceof Array&&(0==l.length||null==l[0]||"string"==typeof l[0])||null===l)||"number"!=typeof a&&null!==a||"number"!=typeof s&&null!==s||!(null!=h&&null!=h.constructor&&null!=h.constructor.__interfaces&&h.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0||null===h)||!(null!=u&&null!=u.constructor&&null!=u.constructor.__interfaces&&u.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0||null===u)||!(null!=d&&null!=d.constructor&&null!=d.constructor.__interfaces&&d.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0||null===d)||"number"!=typeof c&&null!==c||"number"!=typeof p&&null!==p||"number"!=typeof g&&null!==g||"number"!=typeof m&&null!==m||"number"!=typeof f&&null!==f||"boolean"!=typeof v&&null!==v||"string"!=typeof _&&null!==_||"number"!=typeof S&&null!==S||"number"!=typeof y&&null!==y||"boolean"!=typeof E&&null!==E||"boolean"!=typeof C&&null!==C||!(null!=P&&P instanceof Array&&(0==P.length||null==P[0]||null!=P[0]&&P[0]instanceof Sash)||null===P)||!(null!=w&&w instanceof Array&&(0==w.length||null==w[0]||w[0]instanceof Array)||null===w)||"number"!=typeof L&&null!==L||"number"!=typeof T&&null!==T||"string"!=typeof A&&null!==A||"boolean"!=typeof I&&null!==I||"boolean"!=typeof b&&null!==b||"boolean"!=typeof O&&null!==O||!(null!=M&&M instanceof Big||null===M)||!(null!=D&&D instanceof Big||null===D)||"string"!=typeof R&&null!==R||!(null!=F&&F instanceof Object||null===F)||!(null!=x&&x instanceof Object||null===x))if("string"!=typeof t&&null!==t||"string"!=typeof i&&null!==i||"string"!=typeof n&&null!==n||"string"!=typeof o&&null!==o||!(null!=r&&r instanceof Array&&(0==r.length||null==r[0]||"string"==typeof r[0])||null===r)||"number"!=typeof l&&null!==l||"number"!=typeof a&&null!==a||!(null!=s&&null!=s.constructor&&null!=s.constructor.__interfaces&&s.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0||null===s)||!(null!=h&&null!=h.constructor&&null!=h.constructor.__interfaces&&h.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0||null===h)||!(null!=u&&null!=u.constructor&&null!=u.constructor.__interfaces&&u.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0||null===u)||"number"!=typeof d&&null!==d||"number"!=typeof c&&null!==c||"number"!=typeof p&&null!==p||"number"!=typeof g&&null!==g||"number"!=typeof m&&null!==m||"boolean"!=typeof f&&null!==f||"string"!=typeof v&&null!==v||"number"!=typeof _&&null!==_||"number"!=typeof S&&null!==S||"boolean"!=typeof y&&null!==y||"boolean"!=typeof E&&null!==E||!(null!=C&&C instanceof Array&&(0==C.length||null==C[0]||null!=C[0]&&C[0]instanceof Sash)||null===C)||!(null!=P&&P instanceof Array&&(0==P.length||null==P[0]||P[0]instanceof Array)||null===P)||"boolean"!=typeof w&&null!==w||"number"!=typeof L&&null!==L||"string"!=typeof T&&null!==T||"boolean"!=typeof A&&null!==A||"boolean"!=typeof I&&null!==I||"boolean"!=typeof b&&null!==b||!(null!=O&&O instanceof Big||null===O)||!(null!=M&&M instanceof Big||null===M)||"string"!=typeof D&&null!==D||!(null!=R&&R instanceof Object||null===R)||void 0!==F||void 0!==x)if("string"!=typeof t&&null!==t||"string"!=typeof i&&null!==i||"string"!=typeof n&&null!==n||"string"!=typeof o&&null!==o||!(null!=r&&r instanceof Array&&(0==r.length||null==r[0]||"string"==typeof r[0])||null===r)||"number"!=typeof l&&null!==l||"number"!=typeof a&&null!==a||!(null!=s&&null!=s.constructor&&null!=s.constructor.__interfaces&&s.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0||null===s)||!(null!=h&&null!=h.constructor&&null!=h.constructor.__interfaces&&h.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0||null===h)||!(null!=u&&null!=u.constructor&&null!=u.constructor.__interfaces&&u.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0||null===u)||"number"!=typeof d&&null!==d||"number"!=typeof c&&null!==c||"number"!=typeof p&&null!==p||"number"!=typeof g&&null!==g||"number"!=typeof m&&null!==m||"boolean"!=typeof f&&null!==f||"string"!=typeof v&&null!==v||"number"!=typeof _&&null!==_||"number"!=typeof S&&null!==S||"boolean"!=typeof y&&null!==y||"boolean"!=typeof E&&null!==E||!(null!=C&&C instanceof Array&&(0==C.length||null==C[0]||null!=C[0]&&C[0]instanceof Sash)||null===C)||!(null!=P&&P instanceof Array&&(0==P.length||null==P[0]||P[0]instanceof Array)||null===P)||"number"!=typeof w&&null!==w||"number"!=typeof L&&null!==L||"string"!=typeof T&&null!==T||"boolean"!=typeof A&&null!==A||"boolean"!=typeof I&&null!==I||"boolean"!=typeof b&&null!==b||!(null!=O&&O instanceof Big||null===O)||!(null!=M&&M instanceof Big||null===M)||"string"!=typeof D&&null!==D||!(null!=R&&R instanceof Object||null===R)||void 0!==F||void 0!==x)if("string"!=typeof t&&null!==t||"string"!=typeof i&&null!==i||"string"!=typeof n&&null!==n||"string"!=typeof o&&null!==o||!(null!=r&&r instanceof Array&&(0==r.length||null==r[0]||"string"==typeof r[0])||null===r)||"number"!=typeof l&&null!==l||"number"!=typeof a&&null!==a||!(null!=s&&null!=s.constructor&&null!=s.constructor.__interfaces&&s.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0||null===s)||!(null!=h&&null!=h.constructor&&null!=h.constructor.__interfaces&&h.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0||null===h)||!(null!=u&&null!=u.constructor&&null!=u.constructor.__interfaces&&u.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0||null===u)||"number"!=typeof d&&null!==d||"number"!=typeof c&&null!==c||"number"!=typeof p&&null!==p||"number"!=typeof g&&null!==g||"number"!=typeof m&&null!==m||"boolean"!=typeof f&&null!==f||"string"!=typeof v&&null!==v||"number"!=typeof _&&null!==_||"number"!=typeof S&&null!==S||"boolean"!=typeof y&&null!==y||"boolean"!=typeof E&&null!==E||!(null!=C&&C instanceof Array&&(0==C.length||null==C[0]||null!=C[0]&&C[0]instanceof Sash)||null===C)||!(null!=P&&P instanceof Array&&(0==P.length||null==P[0]||P[0]instanceof Array)||null===P)||"boolean"!=typeof w&&null!==w||"number"!=typeof L&&null!==L||"string"!=typeof T&&null!==T||"boolean"!=typeof A&&null!==A||"boolean"!=typeof I&&null!==I||"boolean"!=typeof b&&null!==b||!(null!=O&&O instanceof Big||null===O)||!(null!=M&&M instanceof Big||null===M)||"string"!=typeof D&&null!==D||void 0!==R||void 0!==F||void 0!==x)if("string"!=typeof t&&null!==t||!(null!=i&&null!=i.constructor&&null!=i.constructor.__interfaces&&i.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0||null===i)||!(null!=n&&null!=n.constructor&&null!=n.constructor.__interfaces&&n.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0||null===n)||"number"!=typeof o&&null!==o||"number"!=typeof r&&null!==r||"number"!=typeof l&&null!==l||"number"!=typeof a&&null!==a||"boolean"!=typeof s&&null!==s||"number"!=typeof h&&null!==h||"number"!=typeof u&&null!==u||!(null!=d&&d instanceof Array&&(0==d.length||null==d[0]||null!=d[0]&&d[0]instanceof Sash)||null===d)||"number"!=typeof c&&null!==c||!(null!=p&&p instanceof Array&&(0==p.length||null==p[0]||p[0]instanceof Array)||null===p)||"boolean"!=typeof g&&null!==g||"number"!=typeof m&&null!==m||"string"!=typeof f&&null!==f||"number"!=typeof v&&null!==v||"boolean"!=typeof _&&null!==_||void 0!==S||void 0!==y||void 0!==E||void 0!==C||void 0!==P||void 0!==w||void 0!==L||void 0!==T||void 0!==A||void 0!==I||void 0!==b||void 0!==O||void 0!==M||void 0!==D||void 0!==R||void 0!==F||void 0!==x){if("string"!=typeof t&&null!==t||"string"!=typeof i&&null!==i||"string"!=typeof n&&null!==n||!(null!=o&&null!=o.constructor&&null!=o.constructor.__interfaces&&o.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0||null===o)||!(null!=r&&null!=r.constructor&&null!=r.constructor.__interfaces&&r.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0||null===r)||"number"!=typeof l&&null!==l||"number"!=typeof a&&null!==a||"number"!=typeof s&&null!==s||"number"!=typeof h&&null!==h||"boolean"!=typeof u&&null!==u||"number"!=typeof d&&null!==d||"number"!=typeof c&&null!==c||!(null!=p&&p instanceof Array&&(0==p.length||null==p[0]||null!=p[0]&&p[0]instanceof Sash)||null===p)||!(null!=g&&g instanceof Array&&(0==g.length||null==g[0]||g[0]instanceof Array)||null===g)||"string"!=typeof m&&null!==m||"boolean"!=typeof f&&null!==f||!(null!=v&&v instanceof Big||null===v)||!(null!=_&&_ instanceof Big||null===_)||void 0!==S||void 0!==y||void 0!==E||void 0!==C||void 0!==P||void 0!==w||void 0!==L||void 0!==T||void 0!==A||void 0!==I||void 0!==b||void 0!==O||void 0!==M||void 0!==D||void 0!==R||void 0!==F||void 0!==x)throw new Error("invalid overload");ft=arguments,ft[4],ft[5],ft[6],ft[7],ft[8],ft[9],ft[10],ft[11],ft[12],ft[13],ft[14],ft[15],ft[16],ft[17];void 0===N.wallThickness&&(N.wallThickness=0),void 0===N.wallDistance&&(N.wallDistance=0),void 0===N.wallCutOutOnBothSides&&(N.wallCutOutOnBothSides=!1),void 0===N.widthDepthDeformable&&(N.widthDepthDeformable=!1),void 0===N.sashes&&(N.sashes=null),void 0===N.cutOutShape&&(N.cutOutShape=null)}else{ft=arguments,ft[1],ft[2],ft[3],ft[4],ft[5],ft[6],ft[7],ft[8],ft[9],ft[10],ft[11],ft[12],ie=ft[13],ft[14],ft[15],ft[16],ft[17];void 0===N.wallThickness&&(N.wallThickness=0),void 0===N.wallDistance&&(N.wallDistance=0),void 0===N.wallCutOutOnBothSides&&(N.wallCutOutOnBothSides=!1),void 0===N.widthDepthDeformable&&(N.widthDepthDeformable=!1),void 0===N.sashes&&(N.sashes=null),void 0===N.cutOutShape&&(N.cutOutShape=null)}else{var k=(ft=arguments)[4],H=ft[5],V=ft[6],U=ft[7],W=ft[8],B=ft[9],G=ft[10],Y=ft[11],$=ft[12],X=ft[13],z=ft[14],j=ft[15],K=ft[16],J=ft[17],q=ft[18],Z=ft[19],Q=ft[20],ee=ft[21],te=ft[22],ie=ft[23],ne=ft[24],oe=ft[25],re=ft[26],le=ft[27],ae=ft[28],se=ft[29],he=ft[30],ue=ft[31],de=ie?PieceOfFurniture.SHOW_BACK_FACE:0;void 0===(N=e.call(this,t,i,n,o,null,k,H,V,U,W,B,G,Y,$,X,z,j,null,te,de,ne,oe,re,le,ae,!1,se,he,ue,null,null)||this).wallThickness&&(N.wallThickness=0),void 0===N.wallDistance&&(N.wallDistance=0),void 0===N.wallCutOutOnBothSides&&(N.wallCutOutOnBothSides=!1),void 0===N.widthDepthDeformable&&(N.widthDepthDeformable=!1),void 0===N.sashes&&(N.sashes=null),void 0===N.cutOutShape&&(N.cutOutShape=null),N.cutOutShape=K,N.wallThickness=J,N.wallDistance=q,N.wallCutOutOnBothSides=Z,N.widthDepthDeformable=Q,N.sashes=ee,void 0===N.wallThickness&&(N.wallThickness=0),void 0===N.wallDistance&&(N.wallDistance=0),void 0===N.wallCutOutOnBothSides&&(N.wallCutOutOnBothSides=!1),void 0===N.widthDepthDeformable&&(N.widthDepthDeformable=!1),void 0===N.sashes&&(N.sashes=null),void 0===N.cutOutShape&&(N.cutOutShape=null),void 0===N.wallThickness&&(N.wallThickness=0),void 0===N.wallDistance&&(N.wallDistance=0),void 0===N.wallCutOutOnBothSides&&(N.wallCutOutOnBothSides=!1),void 0===N.widthDepthDeformable&&(N.widthDepthDeformable=!1),void 0===N.sashes&&(N.sashes=null),void 0===N.cutOutShape&&(N.cutOutShape=null),void 0===N.wallThickness&&(N.wallThickness=0),void 0===N.wallDistance&&(N.wallDistance=0),void 0===N.wallCutOutOnBothSides&&(N.wallCutOutOnBothSides=!1),void 0===N.widthDepthDeformable&&(N.widthDepthDeformable=!1),void 0===N.sashes&&(N.sashes=null),void 0===N.cutOutShape&&(N.cutOutShape=null)}else{var ce=(ft=arguments)[4],pe=ft[5],ge=ft[6],me=ft[7],fe=ft[8],ve=ft[9],_e=ft[10],Se=ft[11],ye=ft[12],Ee=ft[13],Ce=ft[14],Pe=ft[15],we=ft[16],Le=ft[17],Te=ft[18],Ae=ft[19],Ie=ft[20],be=ft[21],Oe=ft[22],Me=ft[23],De=ft[24],Re=ft[25],Fe=ft[26],xe=ft[27],Ne=ft[28],ke=ft[29],He=ft[30],Ve=ft[31],Ue=ft[32];void 0===(N=e.call(this,t,i,n,o,null,ce,pe,ge,me,fe,ve,_e,Se,ye,Ee,Ce,Pe,null,Oe,Me,De,Re,Fe,xe,Ne,!1,ke,He,Ve,Ue,null)||this).wallThickness&&(N.wallThickness=0),void 0===N.wallDistance&&(N.wallDistance=0),void 0===N.wallCutOutOnBothSides&&(N.wallCutOutOnBothSides=!1),void 0===N.widthDepthDeformable&&(N.widthDepthDeformable=!1),void 0===N.sashes&&(N.sashes=null),void 0===N.cutOutShape&&(N.cutOutShape=null),N.cutOutShape=we,N.wallThickness=Le,N.wallDistance=Te,N.wallCutOutOnBothSides=Ae,N.widthDepthDeformable=Ie,N.sashes=be,void 0===N.wallThickness&&(N.wallThickness=0),void 0===N.wallDistance&&(N.wallDistance=0),void 0===N.wallCutOutOnBothSides&&(N.wallCutOutOnBothSides=!1),void 0===N.widthDepthDeformable&&(N.widthDepthDeformable=!1),void 0===N.sashes&&(N.sashes=null),void 0===N.cutOutShape&&(N.cutOutShape=null)}else{var We=(ft=arguments)[4],Be=ft[5],Ge=ft[6],Ye=ft[7],$e=ft[8],Xe=ft[9],ze=ft[10],je=ft[11],Ke=ft[12],Je=ft[13],qe=ft[14],Ze=ft[15],Qe=ft[16],et=ft[17],tt=ft[18],it=ft[19],nt=ft[20],ot=ft[21],rt=ft[22],ie=ft[23],lt=ft[24],at=ft[25],st=ft[26],ht=ft[27],ut=ft[28],dt=ft[29],ct=ft[30],pt=ft[31],gt=ft[32],mt=ie?PieceOfFurniture.SHOW_BACK_FACE:0;void 0===(N=e.call(this,t,i,n,o,null,We,Be,Ge,Ye,$e,Xe,ze,je,Ke,Je,qe,Ze,null,rt,mt,lt,at,st,ht,ut,!1,dt,ct,pt,gt,null)||this).wallThickness&&(N.wallThickness=0),void 0===N.wallDistance&&(N.wallDistance=0),void 0===N.wallCutOutOnBothSides&&(N.wallCutOutOnBothSides=!1),void 0===N.widthDepthDeformable&&(N.widthDepthDeformable=!1),void 0===N.sashes&&(N.sashes=null),void 0===N.cutOutShape&&(N.cutOutShape=null),N.cutOutShape=Qe,N.wallThickness=et,N.wallDistance=tt,N.wallCutOutOnBothSides=it,N.widthDepthDeformable=nt,N.sashes=ot,void 0===N.wallThickness&&(N.wallThickness=0),void 0===N.wallDistance&&(N.wallDistance=0),void 0===N.wallCutOutOnBothSides&&(N.wallCutOutOnBothSides=!1),void 0===N.widthDepthDeformable&&(N.widthDepthDeformable=!1),void 0===N.sashes&&(N.sashes=null),void 0===N.cutOutShape&&(N.cutOutShape=null),void 0===N.wallThickness&&(N.wallThickness=0),void 0===N.wallDistance&&(N.wallDistance=0),void 0===N.wallCutOutOnBothSides&&(N.wallCutOutOnBothSides=!1),void 0===N.widthDepthDeformable&&(N.widthDepthDeformable=!1),void 0===N.sashes&&(N.sashes=null),void 0===N.cutOutShape&&(N.cutOutShape=null)}else{var ft=arguments;void 0===(N=e.call(this,t,i,n,o,r,l,a,s,h,u,d,c,p,g,m,f,v,null,w,L,T,A,I,b,O,!1,M,D,R,F,x)||this).wallThickness&&(N.wallThickness=0),void 0===N.wallDistance&&(N.wallDistance=0),void 0===N.wallCutOutOnBothSides&&(N.wallCutOutOnBothSides=!1),void 0===N.widthDepthDeformable&&(N.widthDepthDeformable=!1),void 0===N.sashes&&(N.sashes=null),void 0===N.cutOutShape&&(N.cutOutShape=null),N.cutOutShape=_,N.wallThickness=S,N.wallDistance=y,N.wallCutOutOnBothSides=E,N.widthDepthDeformable=C,N.sashes=P}return N}return __extends(t,e),t.prototype.getWallThickness=function(){return this.wallThickness},t.prototype.getWallDistance=function(){return this.wallDistance},t.prototype.isWallCutOutOnBothSides=function(){return this.wallCutOutOnBothSides},t.prototype.isWidthDepthDeformable=function(){return this.widthDepthDeformable},t.prototype.getSashes=function(){return 0===this.sashes.length?this.sashes:this.sashes.slice(0)},t.prototype.getCutOutShape=function(){return this.cutOutShape},t.prototype.isDoorOrWindow=function(){return!0},t.prototype.isHorizontallyRotatable=function(){return!1},t}(CatalogPieceOfFurniture);CatalogDoorOrWindow.__class="com.eteks.sweethome3d.model.CatalogDoorOrWindow",CatalogDoorOrWindow.__interfaces=["com.eteks.sweethome3d.model.CatalogItem","com.eteks.sweethome3d.model.DoorOrWindow","com.eteks.sweethome3d.model.PieceOfFurniture"];var CatalogShelfUnit=function(e){function t(i,n,o,r,l,a,s,h,u,d,c,p,g,m,f,v,_,S,y,E,C,P,w,L,T,A,I,b,O,M,D,R,F){var x=e.call(this,i,n,o,r,l,a,s,h,u,d,c,p,g,m,f,v,y,E,C,P,w,L,T,A,I,b,O,M,D,R,F)||this;return void 0===x.shelfElevations&&(x.shelfElevations=null),void 0===x.shelfBoxes&&(x.shelfBoxes=null),x.shelfElevations=null!=_&&_.length>0?_.slice(0):t.EMPTY_SHELF_ELEVATIONS_$LI$(),x.shelfBoxes=null!=S&&S.length>0?S.slice(0):t.EMPTY_SHELF_BOXES_$LI$(),x}return __extends(t,e),t.EMPTY_SHELF_ELEVATIONS_$LI$=function(){return null==t.EMPTY_SHELF_ELEVATIONS&&(t.EMPTY_SHELF_ELEVATIONS=[]),t.EMPTY_SHELF_ELEVATIONS},t.EMPTY_SHELF_BOXES_$LI$=function(){return null==t.EMPTY_SHELF_BOXES&&(t.EMPTY_SHELF_BOXES=[]),t.EMPTY_SHELF_BOXES},t.prototype.getShelfElevations=function(){return null!=this.shelfElevations?this.shelfElevations.slice(0):null},t.prototype.getShelfBoxes=function(){return this.shelfBoxes.slice(0)},t}(CatalogPieceOfFurniture);CatalogShelfUnit.__class="com.eteks.sweethome3d.model.CatalogShelfUnit",CatalogShelfUnit.__interfaces=["com.eteks.sweethome3d.model.CatalogItem","com.eteks.sweethome3d.model.PieceOfFurniture","com.eteks.sweethome3d.model.ShelfUnit"];var CatalogLight=function(e){function t(i,n,o,r,l,a,s,h,u,d,c,p,g,m,f,v,_,S,y,E,C,P,w,L,T,A,I,b,O,M,D,R,F){var x=this;if("string"!=typeof i&&null!==i||"string"!=typeof n&&null!==n||"string"!=typeof o&&null!==o||"string"!=typeof r&&null!==r||"string"!=typeof l&&null!==l||!(null!=a&&a instanceof Array&&(0==a.length||null==a[0]||"string"==typeof a[0])||null===a)||"number"!=typeof s&&null!==s||"number"!=typeof h&&null!==h||!(null!=u&&null!=u.constructor&&null!=u.constructor.__interfaces&&u.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0||null===u)||!(null!=d&&null!=d.constructor&&null!=d.constructor.__interfaces&&d.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0||null===d)||!(null!=c&&null!=c.constructor&&null!=c.constructor.__interfaces&&c.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0||null===c)||"number"!=typeof p&&null!==p||"number"!=typeof g&&null!==g||"number"!=typeof m&&null!==m||"number"!=typeof f&&null!==f||"number"!=typeof v&&null!==v||"boolean"!=typeof _&&null!==_||!(null!=S&&S instanceof Array&&(0==S.length||null==S[0]||null!=S[0]&&S[0]instanceof LightSource)||null===S)||!(null!=y&&y instanceof Array&&(0==y.length||null==y[0]||"string"==typeof y[0])||null===y)||"string"!=typeof E&&null!==E||!(null!=C&&C instanceof Array&&(0==C.length||null==C[0]||C[0]instanceof Array)||null===C)||"number"!=typeof P&&null!==P||"number"!=typeof w&&null!==w||"string"!=typeof L&&null!==L||"boolean"!=typeof T&&null!==T||"boolean"!=typeof A&&null!==A||"boolean"!=typeof I&&null!==I||"boolean"!=typeof b&&null!==b||!(null!=O&&O instanceof Big||null===O)||!(null!=M&&M instanceof Big||null===M)||"string"!=typeof D&&null!==D||!(null!=R&&R instanceof Object||null===R)||!(null!=F&&F instanceof Object||null===F))if("string"!=typeof i&&null!==i||"string"!=typeof n&&null!==n||"string"!=typeof o&&null!==o||"string"!=typeof r&&null!==r||!(null!=l&&l instanceof Array&&(0==l.length||null==l[0]||"string"==typeof l[0])||null===l)||"number"!=typeof a&&null!==a||"number"!=typeof s&&null!==s||!(null!=h&&null!=h.constructor&&null!=h.constructor.__interfaces&&h.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0||null===h)||!(null!=u&&null!=u.constructor&&null!=u.constructor.__interfaces&&u.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0||null===u)||!(null!=d&&null!=d.constructor&&null!=d.constructor.__interfaces&&d.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0||null===d)||"number"!=typeof c&&null!==c||"number"!=typeof p&&null!==p||"number"!=typeof g&&null!==g||"number"!=typeof m&&null!==m||"number"!=typeof f&&null!==f||"boolean"!=typeof v&&null!==v||!(null!=_&&_ instanceof Array&&(0==_.length||null==_[0]||null!=_[0]&&_[0]instanceof LightSource)||null===_)||!(null!=S&&S instanceof Array&&(0==S.length||null==S[0]||"string"==typeof S[0])||null===S)||"string"!=typeof y&&null!==y||!(null!=E&&E instanceof Array&&(0==E.length||null==E[0]||E[0]instanceof Array)||null===E)||"number"!=typeof C&&null!==C||"number"!=typeof P&&null!==P||"string"!=typeof w&&null!==w||"boolean"!=typeof L&&null!==L||"boolean"!=typeof T&&null!==T||"boolean"!=typeof A&&null!==A||"boolean"!=typeof I&&null!==I||!(null!=b&&b instanceof Big||null===b)||!(null!=O&&O instanceof Big||null===O)||"string"!=typeof M&&null!==M||!(null!=D&&D instanceof Object||null===D)||void 0!==R||void 0!==F)if("string"!=typeof i&&null!==i||"string"!=typeof n&&null!==n||"string"!=typeof o&&null!==o||"string"!=typeof r&&null!==r||!(null!=l&&l instanceof Array&&(0==l.length||null==l[0]||"string"==typeof l[0])||null===l)||"number"!=typeof a&&null!==a||"number"!=typeof s&&null!==s||!(null!=h&&null!=h.constructor&&null!=h.constructor.__interfaces&&h.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0||null===h)||!(null!=u&&null!=u.constructor&&null!=u.constructor.__interfaces&&u.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0||null===u)||!(null!=d&&null!=d.constructor&&null!=d.constructor.__interfaces&&d.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0||null===d)||"number"!=typeof c&&null!==c||"number"!=typeof p&&null!==p||"number"!=typeof g&&null!==g||"number"!=typeof m&&null!==m||"number"!=typeof f&&null!==f||"boolean"!=typeof v&&null!==v||!(null!=_&&_ instanceof Array&&(0==_.length||null==_[0]||null!=_[0]&&_[0]instanceof LightSource)||null===_)||"string"!=typeof S&&null!==S||!(null!=y&&y instanceof Array&&(0==y.length||null==y[0]||y[0]instanceof Array)||null===y)||"boolean"!=typeof E&&null!==E||"number"!=typeof C&&null!==C||"string"!=typeof P&&null!==P||"boolean"!=typeof w&&null!==w||"boolean"!=typeof L&&null!==L||"boolean"!=typeof T&&null!==T||"boolean"!=typeof A&&null!==A||!(null!=I&&I instanceof Big||null===I)||!(null!=b&&b instanceof Big||null===b)||"string"!=typeof O&&null!==O||!(null!=M&&M instanceof Object||null===M)||void 0!==D||void 0!==R||void 0!==F){if("string"!=typeof i&&null!==i||"string"!=typeof n&&null!==n||"string"!=typeof o&&null!==o||"string"!=typeof r&&null!==r||!(null!=l&&l instanceof Array&&(0==l.length||null==l[0]||"string"==typeof l[0])||null===l)||"number"!=typeof a&&null!==a||"number"!=typeof s&&null!==s||!(null!=h&&null!=h.constructor&&null!=h.constructor.__interfaces&&h.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0||null===h)||!(null!=u&&null!=u.constructor&&null!=u.constructor.__interfaces&&u.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0||null===u)||!(null!=d&&null!=d.constructor&&null!=d.constructor.__interfaces&&d.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0||null===d)||"number"!=typeof c&&null!==c||"number"!=typeof p&&null!==p||"number"!=typeof g&&null!==g||"number"!=typeof m&&null!==m||"number"!=typeof f&&null!==f||"boolean"!=typeof v&&null!==v||!(null!=_&&_ instanceof Array&&(0==_.length||null==_[0]||null!=_[0]&&_[0]instanceof LightSource)||null===_)||"string"!=typeof S&&null!==S||!(null!=y&&y instanceof Array&&(0==y.length||null==y[0]||y[0]instanceof Array)||null===y)||"boolean"!=typeof E&&null!==E||"number"!=typeof C&&null!==C||"string"!=typeof P&&null!==P||"boolean"!=typeof w&&null!==w||"boolean"!=typeof L&&null!==L||"boolean"!=typeof T&&null!==T||"boolean"!=typeof A&&null!==A||!(null!=I&&I instanceof Big||null===I)||!(null!=b&&b instanceof Big||null===b)||"string"!=typeof O&&null!==O||void 0!==M||void 0!==D||void 0!==R||void 0!==F)throw new Error("invalid overload");var N=(at=arguments)[4],k=at[5],H=at[6],V=at[7],U=at[8],W=at[9],B=at[10],G=at[11],Y=at[12],$=at[13],X=at[14],z=at[15],j=at[16],K=at[17],J=at[18],q=(Ce=at[19],at[20]),Z=at[21],Q=at[22],ee=at[23],te=at[24],ie=at[25],ne=at[26],oe=at[27],re=at[28],le=Ce?PieceOfFurniture.SHOW_BACK_FACE:0;void 0===(x=e.call(this,i,n,o,r,null,N,k,H,V,U,W,B,G,Y,$,X,z,K,J,le,q,Z,Q,ee,te,ie,ne,oe,re,null,null)||this).lightSources&&(x.lightSources=null),void 0===x.lightSourceMaterialNames&&(x.lightSourceMaterialNames=null),x.lightSources=null!=j&&j.length>0?j.slice(0):t.EMPTY_LIGHT_SOURCES_$LI$(),x.lightSourceMaterialNames=t.EMPTY_LIGHT_SOURCE_MATERIAL_NAMES_$LI$(),void 0===x.lightSources&&(x.lightSources=null),void 0===x.lightSourceMaterialNames&&(x.lightSourceMaterialNames=null),void 0===x.lightSources&&(x.lightSources=null),void 0===x.lightSourceMaterialNames&&(x.lightSourceMaterialNames=null),void 0===x.lightSources&&(x.lightSources=null),void 0===x.lightSourceMaterialNames&&(x.lightSourceMaterialNames=null)}else{var ae=(at=arguments)[4],se=at[5],he=at[6],ue=at[7],de=at[8],ce=at[9],pe=at[10],ge=at[11],me=at[12],fe=at[13],ve=at[14],_e=at[15],Se=at[16],ye=at[17],Ee=at[18],Ce=at[19],Pe=at[20],we=at[21],Le=at[22],Te=at[23],Ae=at[24],Ie=at[25],be=at[26],Oe=at[27],Me=at[28],De=at[29],Re=Ce?PieceOfFurniture.SHOW_BACK_FACE:0;void 0===(x=e.call(this,i,n,o,r,null,ae,se,he,ue,de,ce,pe,ge,me,fe,ve,_e,ye,Ee,Re,Pe,we,Le,Te,Ae,Ie,be,Oe,Me,De,null)||this).lightSources&&(x.lightSources=null),void 0===x.lightSourceMaterialNames&&(x.lightSourceMaterialNames=null),x.lightSources=null!=Se&&Se.length>0?Se.slice(0):t.EMPTY_LIGHT_SOURCES_$LI$(),x.lightSourceMaterialNames=t.EMPTY_LIGHT_SOURCE_MATERIAL_NAMES_$LI$(),void 0===x.lightSources&&(x.lightSources=null),void 0===x.lightSourceMaterialNames&&(x.lightSourceMaterialNames=null),void 0===x.lightSources&&(x.lightSources=null),void 0===x.lightSourceMaterialNames&&(x.lightSourceMaterialNames=null)}else{var Fe=(at=arguments)[4],xe=at[5],Ne=at[6],ke=at[7],He=at[8],Ve=at[9],Ue=at[10],We=at[11],Be=at[12],Ge=at[13],Ye=at[14],$e=at[15],Xe=at[16],ze=at[17],je=at[18],Ke=at[19],Je=at[20],qe=at[21],Ze=at[22],Qe=at[23],et=at[24],tt=at[25],it=at[26],nt=at[27],ot=at[28],rt=at[29],lt=at[30];void 0===(x=e.call(this,i,n,o,r,null,Fe,xe,Ne,ke,He,Ve,Ue,We,Be,Ge,Ye,$e,je,Ke,Je,qe,Ze,Qe,et,tt,it,nt,ot,rt,lt,null)||this).lightSources&&(x.lightSources=null),void 0===x.lightSourceMaterialNames&&(x.lightSourceMaterialNames=null),x.lightSources=null!=Xe&&Xe.length>0?Xe.slice(0):t.EMPTY_LIGHT_SOURCES_$LI$(),x.lightSourceMaterialNames=null!=ze&&ze.length>0?ze.slice(0):t.EMPTY_LIGHT_SOURCE_MATERIAL_NAMES_$LI$(),void 0===x.lightSources&&(x.lightSources=null),void 0===x.lightSourceMaterialNames&&(x.lightSourceMaterialNames=null)}else{var at=arguments;void 0===(x=e.call(this,i,n,o,r,l,a,s,h,u,d,c,p,g,m,f,v,_,E,C,P,w,L,T,A,I,b,O,M,D,R,F)||this).lightSources&&(x.lightSources=null),void 0===x.lightSourceMaterialNames&&(x.lightSourceMaterialNames=null),x.lightSources=null!=S&&S.length>0?S.slice(0):t.EMPTY_LIGHT_SOURCES_$LI$(),x.lightSourceMaterialNames=null!=y&&y.length>0?y.slice(0):t.EMPTY_LIGHT_SOURCE_MATERIAL_NAMES_$LI$()}return x}return __extends(t,e),t.EMPTY_LIGHT_SOURCES_$LI$=function(){return null==t.EMPTY_LIGHT_SOURCES&&(t.EMPTY_LIGHT_SOURCES=[]),t.EMPTY_LIGHT_SOURCES},t.EMPTY_LIGHT_SOURCE_MATERIAL_NAMES_$LI$=function(){return null==t.EMPTY_LIGHT_SOURCE_MATERIAL_NAMES&&(t.EMPTY_LIGHT_SOURCE_MATERIAL_NAMES=[]),t.EMPTY_LIGHT_SOURCE_MATERIAL_NAMES},t.prototype.getLightSources=function(){return 0===this.lightSources.length?this.lightSources:this.lightSources.slice(0)},t.prototype.getLightSourceMaterialNames=function(){return 0===this.lightSourceMaterialNames.length?this.lightSourceMaterialNames:this.lightSourceMaterialNames.slice(0)},t}(CatalogPieceOfFurniture);CatalogLight.__class="com.eteks.sweethome3d.model.CatalogLight",CatalogLight.__interfaces=["com.eteks.sweethome3d.model.CatalogItem","com.eteks.sweethome3d.model.PieceOfFurniture","com.eteks.sweethome3d.model.Light"];var ImportedTextureWizardController=function(e){function t(i,n,o,r,l){var a=this;if((null!=i&&i instanceof CatalogTexture||null===i)&&("string"==typeof n||null===n)&&(null!=o&&o instanceof UserPreferences||null===o)&&(null!=r&&null!=r.constructor&&null!=r.constructor.__interfaces&&r.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0||null===r)&&(null!=l&&null!=l.constructor&&null!=l.constructor.__interfaces&&l.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ContentManager")>=0||null===l)){var s=arguments;void 0===(a=e.call(this,o,r)||this).texture&&(a.texture=null),void 0===a.textureName&&(a.textureName=null),void 0===a.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences&&(a.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences=null),void 0===a.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_viewFactory&&(a.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_viewFactory=null),void 0===a.contentManager&&(a.contentManager=null),void 0===a.textureImageStepState&&(a.textureImageStepState=null),void 0===a.textureAttributesStepState&&(a.textureAttributesStepState=null),void 0===a.stepsView&&(a.stepsView=null),void 0===a.step&&(a.step=null),void 0===a.image&&(a.image=null),void 0===a.name&&(a.name=null),void 0===a.category&&(a.category=null),void 0===a.creator&&(a.creator=null),void 0===a.width&&(a.width=0),void 0===a.height&&(a.height=0),a.texture=i,a.textureName=n,a.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences=o,a.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_viewFactory=r,a.contentManager=l,a.setTitle(a.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences.getLocalizedString(t,null==i?"importTextureWizard.title":"modifyTextureWizard.title")),a.textureImageStepState=new t.TextureImageStepState(a),a.textureAttributesStepState=new t.TextureAttributesStepState(a),a.setStepState(a.textureImageStepState)}else if(("string"==typeof i||null===i)&&(null!=n&&n instanceof UserPreferences||null===n)&&(null!=o&&null!=o.constructor&&null!=o.constructor.__interfaces&&o.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0||null===o)&&(null!=r&&null!=r.constructor&&null!=r.constructor.__interfaces&&r.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ContentManager")>=0||null===r)&&void 0===l){var h=(s=arguments)[0],u=s[1],d=s[2],c=s[3];void 0===(a=e.call(this,u,d)||this).texture&&(a.texture=null),void 0===a.textureName&&(a.textureName=null),void 0===a.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences&&(a.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences=null),void 0===a.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_viewFactory&&(a.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_viewFactory=null),void 0===a.contentManager&&(a.contentManager=null),void 0===a.textureImageStepState&&(a.textureImageStepState=null),void 0===a.textureAttributesStepState&&(a.textureAttributesStepState=null),void 0===a.stepsView&&(a.stepsView=null),void 0===a.step&&(a.step=null),void 0===a.image&&(a.image=null),void 0===a.name&&(a.name=null),void 0===a.category&&(a.category=null),void 0===a.creator&&(a.creator=null),void 0===a.width&&(a.width=0),void 0===a.height&&(a.height=0),a.texture=null,a.textureName=h,a.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences=u,a.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_viewFactory=d,a.contentManager=c,a.setTitle(a.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences.getLocalizedString(t,"importTextureWizard.title")),a.textureImageStepState=new t.TextureImageStepState(a),a.textureAttributesStepState=new t.TextureAttributesStepState(a),a.setStepState(a.textureImageStepState),void 0===a.texture&&(a.texture=null),void 0===a.textureName&&(a.textureName=null),void 0===a.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences&&(a.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences=null),void 0===a.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_viewFactory&&(a.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_viewFactory=null),void 0===a.contentManager&&(a.contentManager=null),void 0===a.textureImageStepState&&(a.textureImageStepState=null),void 0===a.textureAttributesStepState&&(a.textureAttributesStepState=null),void 0===a.stepsView&&(a.stepsView=null),void 0===a.step&&(a.step=null),void 0===a.image&&(a.image=null),void 0===a.name&&(a.name=null),void 0===a.category&&(a.category=null),void 0===a.creator&&(a.creator=null),void 0===a.width&&(a.width=0),void 0===a.height&&(a.height=0)}else if((null!=i&&i instanceof CatalogTexture||null===i)&&(null!=n&&n instanceof UserPreferences||null===n)&&(null!=o&&null!=o.constructor&&null!=o.constructor.__interfaces&&o.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0||null===o)&&(null!=r&&null!=r.constructor&&null!=r.constructor.__interfaces&&r.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ContentManager")>=0||null===r)&&void 0===l){var p=(s=arguments)[1],g=s[2],m=s[3];void 0===(a=e.call(this,p,g)||this).texture&&(a.texture=null),void 0===a.textureName&&(a.textureName=null),void 0===a.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences&&(a.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences=null),void 0===a.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_viewFactory&&(a.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_viewFactory=null),void 0===a.contentManager&&(a.contentManager=null),void 0===a.textureImageStepState&&(a.textureImageStepState=null),void 0===a.textureAttributesStepState&&(a.textureAttributesStepState=null),void 0===a.stepsView&&(a.stepsView=null),void 0===a.step&&(a.step=null),void 0===a.image&&(a.image=null),void 0===a.name&&(a.name=null),void 0===a.category&&(a.category=null),void 0===a.creator&&(a.creator=null),void 0===a.width&&(a.width=0),void 0===a.height&&(a.height=0),a.texture=i,a.textureName=null,a.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences=p,a.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_viewFactory=g,a.contentManager=m,a.setTitle(a.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences.getLocalizedString(t,null==i?"importTextureWizard.title":"modifyTextureWizard.title")),a.textureImageStepState=new t.TextureImageStepState(a),a.textureAttributesStepState=new t.TextureAttributesStepState(a),a.setStepState(a.textureImageStepState),void 0===a.texture&&(a.texture=null),void 0===a.textureName&&(a.textureName=null),void 0===a.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences&&(a.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences=null),void 0===a.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_viewFactory&&(a.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_viewFactory=null),void 0===a.contentManager&&(a.contentManager=null),void 0===a.textureImageStepState&&(a.textureImageStepState=null),void 0===a.textureAttributesStepState&&(a.textureAttributesStepState=null),void 0===a.stepsView&&(a.stepsView=null),void 0===a.step&&(a.step=null),void 0===a.image&&(a.image=null),void 0===a.name&&(a.name=null),void 0===a.category&&(a.category=null),void 0===a.creator&&(a.creator=null),void 0===a.width&&(a.width=0),void 0===a.height&&(a.height=0)}else{if(!((null!=i&&i instanceof UserPreferences||null===i)&&(null!=n&&null!=n.constructor&&null!=n.constructor.__interfaces&&n.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0||null===n)&&(null!=o&&null!=o.constructor&&null!=o.constructor.__interfaces&&o.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ContentManager")>=0||null===o)&&void 0===r&&void 0===l))throw new Error("invalid overload");var f=(s=arguments)[0],v=s[1],_=s[2];void 0===(a=e.call(this,f,v)||this).texture&&(a.texture=null),void 0===a.textureName&&(a.textureName=null),void 0===a.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences&&(a.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences=null),void 0===a.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_viewFactory&&(a.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_viewFactory=null),void 0===a.contentManager&&(a.contentManager=null),void 0===a.textureImageStepState&&(a.textureImageStepState=null),void 0===a.textureAttributesStepState&&(a.textureAttributesStepState=null),void 0===a.stepsView&&(a.stepsView=null),void 0===a.step&&(a.step=null),void 0===a.image&&(a.image=null),void 0===a.name&&(a.name=null),void 0===a.category&&(a.category=null),void 0===a.creator&&(a.creator=null),void 0===a.width&&(a.width=0),void 0===a.height&&(a.height=0),a.texture=null,a.textureName=null,a.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences=f,a.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_viewFactory=v,a.contentManager=_,a.setTitle(a.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences.getLocalizedString(t,"importTextureWizard.title")),a.textureImageStepState=new t.TextureImageStepState(a),a.textureAttributesStepState=new t.TextureAttributesStepState(a),a.setStepState(a.textureImageStepState),void 0===a.texture&&(a.texture=null),void 0===a.textureName&&(a.textureName=null),void 0===a.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences&&(a.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences=null),void 0===a.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_viewFactory&&(a.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_viewFactory=null),void 0===a.contentManager&&(a.contentManager=null),void 0===a.textureImageStepState&&(a.textureImageStepState=null),void 0===a.textureAttributesStepState&&(a.textureAttributesStepState=null),void 0===a.stepsView&&(a.stepsView=null),void 0===a.step&&(a.step=null),void 0===a.image&&(a.image=null),void 0===a.name&&(a.name=null),void 0===a.category&&(a.category=null),void 0===a.creator&&(a.creator=null),void 0===a.width&&(a.width=0),void 0===a.height&&(a.height=0)}return a}return __extends(t,e),t.prototype.finish=function(){var e=new CatalogTexture(null,this.getName(),this.getImage(),this.getWidth(),this.getHeight(),this.getCreator(),!0),t=this.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences.getTexturesCatalog();null!=this.texture&&t.delete(this.texture),t.add(this.category,e)},t.prototype.getContentManager=function(){return this.contentManager},t.prototype.getStepState=function(){return e.prototype.getStepState.call(this)},t.prototype.getTextureImageStepState=function(){return this.textureImageStepState},t.prototype.getTextureAttributesStepState=function(){return this.textureAttributesStepState},t.prototype.getStepsView=function(){return null==this.stepsView&&(this.stepsView=this.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_viewFactory.createImportedTextureWizardStepsView(this.texture,this.textureName,this.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences,this)),this.stepsView},t.prototype.setStep=function(e){if(e!==this.step){var t=this.step;this.step=e,this.propertyChangeSupport.firePropertyChange("STEP",t,e)}},t.prototype.getStep=function(){return this.step},t.prototype.setImage=function(e){if(e!==this.image){var t=this.image;this.image=e,this.propertyChangeSupport.firePropertyChange("IMAGE",t,e)}},t.prototype.getImage=function(){return this.image},t.prototype.getName=function(){return this.name},t.prototype.setName=function(e){if(e!==this.name){var t=this.name;this.name=e,null!=this.propertyChangeSupport&&this.propertyChangeSupport.firePropertyChange("NAME",t,e)}},t.prototype.getCategory=function(){return this.category},t.prototype.setCategory=function(e){if(e!==this.category){var t=this.category;this.category=e,this.propertyChangeSupport.firePropertyChange("CATEGORY",t,e)}},t.prototype.getCreator=function(){return this.creator},t.prototype.setCreator=function(e){if(e!==this.creator){var t=this.creator;this.creator=e,null!=this.propertyChangeSupport&&this.propertyChangeSupport.firePropertyChange("CREATOR",t,e)}},t.prototype.getWidth=function(){return this.width},t.prototype.setWidth=function(e){if(e!==this.width){var t=this.width;this.width=e,this.propertyChangeSupport.firePropertyChange("WIDTH",t,e)}},t.prototype.getHeight=function(){return this.height},t.prototype.setHeight=function(e){if(e!==this.height){var t=this.height;this.height=e,this.propertyChangeSupport.firePropertyChange("HEIGHT",t,e)}},t.prototype.isTextureNameValid=function(){return null!=this.name&&this.name.length>0&&null!=this.category},t}(WizardController);ImportedTextureWizardController.__class="com.eteks.sweethome3d.viewcontroller.ImportedTextureWizardController",ImportedTextureWizardController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"],function(e){var t;(t=e.Step||(e.Step={}))[t.IMAGE=0]="IMAGE",t[t.ATTRIBUTES=1]="ATTRIBUTES";var i=function(e){function t(t){var i=e.call(this)||this;return i.__parent=t,i.icon="resources/importedTextureWizard.png",i}return __extends(t,e),t.prototype.enter=function(){this.__parent.setStep(this.getStep())},t.prototype.getView=function(){return this.__parent.getStepsView()},t.prototype.getIcon=function(){return this.icon},t}(WizardController.WizardControllerStepState);e.ImportedTextureWizardStepState=i,i.__class="com.eteks.sweethome3d.viewcontroller.ImportedTextureWizardController.ImportedTextureWizardStepState";var n=function(t){function i(e){var n=t.call(this,e)||this;return n.__parent=e,e.addPropertyChangeListener("IMAGE",new i.TextureImageStepState$0(n)),n}return __extends(i,t),i.prototype.enter=function(){t.prototype.enter.call(this),this.setFirstStep(!0),this.setNextStepEnabled(null!=this.__parent.getImage())},i.prototype.getStep=function(){return e.Step.IMAGE},i.prototype.goToNextStep=function(){this.__parent.setStepState(this.__parent.getTextureAttributesStepState())},i}(e.ImportedTextureWizardStepState);e.TextureImageStepState=n,n.__class="com.eteks.sweethome3d.viewcontroller.ImportedTextureWizardController.TextureImageStepState",function(e){var t=function(){function e(e){this.__parent=e}return e.prototype.propertyChange=function(e){this.__parent.setNextStepEnabled(null!=this.__parent.__parent.getImage())},e}();e.TextureImageStepState$0=t}(n=e.TextureImageStepState||(e.TextureImageStepState={}));var o=function(t){function i(e){var n=t.call(this,e)||this;return n.__parent=e,void 0===n.widthChangeListener&&(n.widthChangeListener=null),void 0===n.heightChangeListener&&(n.heightChangeListener=null),void 0===n.nameAndCategoryChangeListener&&(n.nameAndCategoryChangeListener=null),n.widthChangeListener=new i.TextureAttributesStepState$0(n),n.heightChangeListener=new i.TextureAttributesStepState$1(n),n.nameAndCategoryChangeListener=new i.TextureAttributesStepState$2(n),n}return __extends(i,t),i.prototype.enter=function(){t.prototype.enter.call(this),this.setLastStep(!0),this.__parent.addPropertyChangeListener("WIDTH",this.widthChangeListener),this.__parent.addPropertyChangeListener("HEIGHT",this.heightChangeListener),this.__parent.addPropertyChangeListener("NAME",this.nameAndCategoryChangeListener),this.__parent.addPropertyChangeListener("CATEGORY",this.nameAndCategoryChangeListener),this.setNextStepEnabled(this.__parent.isTextureNameValid())},i.prototype.getStep=function(){return e.Step.ATTRIBUTES},i.prototype.goBackToPreviousStep=function(){this.__parent.setStepState(this.__parent.getTextureImageStepState())},i.prototype.exit=function(){this.__parent.removePropertyChangeListener("WIDTH",this.widthChangeListener),this.__parent.removePropertyChangeListener("HEIGHT",this.heightChangeListener),this.__parent.removePropertyChangeListener("NAME",this.nameAndCategoryChangeListener),this.__parent.removePropertyChangeListener("CATEGORY",this.nameAndCategoryChangeListener)},i}(e.ImportedTextureWizardStepState);e.TextureAttributesStepState=o,o.__class="com.eteks.sweethome3d.viewcontroller.ImportedTextureWizardController.TextureAttributesStepState",function(e){var t=function(){function e(e){this.__parent=e}return e.prototype.propertyChange=function(e){this.__parent.__parent.removePropertyChangeListener("HEIGHT",this.__parent.heightChangeListener);var t=e.getNewValue()/e.getOldValue();this.__parent.__parent.setHeight(this.__parent.__parent.getHeight()*t),this.__parent.__parent.addPropertyChangeListener("HEIGHT",this.__parent.heightChangeListener)},e}();e.TextureAttributesStepState$0=t;var i=function(){function e(e){this.__parent=e}return e.prototype.propertyChange=function(e){this.__parent.__parent.removePropertyChangeListener("WIDTH",this.__parent.widthChangeListener);var t=e.getNewValue()/e.getOldValue();this.__parent.__parent.setWidth(this.__parent.__parent.getWidth()*t),this.__parent.__parent.addPropertyChangeListener("WIDTH",this.__parent.widthChangeListener)},e}();e.TextureAttributesStepState$1=i;var n=function(){function e(e){this.__parent=e}return e.prototype.propertyChange=function(e){this.__parent.setNextStepEnabled(this.__parent.__parent.isTextureNameValid())},e}();e.TextureAttributesStepState$2=n}(o=e.TextureAttributesStepState||(e.TextureAttributesStepState={}))}(ImportedTextureWizardController||(ImportedTextureWizardController={}));var DimensionLineController=function(){function e(t,i,n,o,r,l){if((null!=t&&t instanceof Home||null===t)&&("number"==typeof i||null===i)&&("number"==typeof n||null===n)&&(null!=o&&o instanceof UserPreferences||null===o)&&(null!=r&&null!=r.constructor&&null!=r.constructor.__interfaces&&r.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0||null===r)&&(null!=l&&l instanceof javax.swing.undo.UndoableEditSupport||null===l)){var a=arguments;void 0===this.home&&(this.home=null),void 0===this.preferences&&(this.preferences=null),void 0===this.viewFactory&&(this.viewFactory=null),void 0===this.undoSupport&&(this.undoSupport=null),void 0===this.propertyChangeSupport&&(this.propertyChangeSupport=null),void 0===this.dimensionLineView&&(this.dimensionLineView=null),void 0===this.dimensionLineModification&&(this.dimensionLineModification=!1),void 0===this.editableDistance&&(this.editableDistance=!1),void 0===this.xStart&&(this.xStart=null),void 0===this.yStart&&(this.yStart=null),void 0===this.elevationStart&&(this.elevationStart=null),void 0===this.xEnd&&(this.xEnd=null),void 0===this.yEnd&&(this.yEnd=null),void 0===this.elevationEnd&&(this.elevationEnd=null),void 0===this.distanceToEndPoint&&(this.distanceToEndPoint=null),void 0===this.orientation&&(this.orientation=null),void 0===this.offset&&(this.offset=null),void 0===this.lengthFontSize&&(this.lengthFontSize=null),void 0===this.color&&(this.color=null),void 0===this.visibleIn3D&&(this.visibleIn3D=null),void 0===this.pitch&&(this.pitch=null),this.home=t,this.preferences=o,this.viewFactory=r,this.undoSupport=l,this.propertyChangeSupport=new PropertyChangeSupport(this),this.dimensionLineModification=!1,this.xStart=this.xEnd=i,this.yStart=this.yEnd=n,this.editableDistance=!0,this.elevationStart=0,this.elevationEnd=this.distanceToEndPoint=t.getWallHeight(),this.offset=20,this.orientation=e.DimensionLineOrientation.ELEVATION,this.lengthFontSize=o.getDefaultTextStyle(DimensionLine).getFontSize(),this.visibleIn3D=!0,this.pitch=-Math.PI/2}else{if(!((null!=t&&t instanceof Home||null===t)&&(null!=i&&i instanceof UserPreferences||null===i)&&(null!=n&&null!=n.constructor&&null!=n.constructor.__interfaces&&n.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0||null===n)&&(null!=o&&o instanceof javax.swing.undo.UndoableEditSupport||null===o)&&void 0===r&&void 0===l))throw new Error("invalid overload");var s=(a=arguments)[1],h=a[2],u=a[3];void 0===this.home&&(this.home=null),void 0===this.preferences&&(this.preferences=null),void 0===this.viewFactory&&(this.viewFactory=null),void 0===this.undoSupport&&(this.undoSupport=null),void 0===this.propertyChangeSupport&&(this.propertyChangeSupport=null),void 0===this.dimensionLineView&&(this.dimensionLineView=null),void 0===this.dimensionLineModification&&(this.dimensionLineModification=!1),void 0===this.editableDistance&&(this.editableDistance=!1),void 0===this.xStart&&(this.xStart=null),void 0===this.yStart&&(this.yStart=null),void 0===this.elevationStart&&(this.elevationStart=null),void 0===this.xEnd&&(this.xEnd=null),void 0===this.yEnd&&(this.yEnd=null),void 0===this.elevationEnd&&(this.elevationEnd=null),void 0===this.distanceToEndPoint&&(this.distanceToEndPoint=null),void 0===this.orientation&&(this.orientation=null),void 0===this.offset&&(this.offset=null),void 0===this.lengthFontSize&&(this.lengthFontSize=null),void 0===this.color&&(this.color=null),void 0===this.visibleIn3D&&(this.visibleIn3D=null),void 0===this.pitch&&(this.pitch=null),this.home=t,this.preferences=s,this.viewFactory=h,this.undoSupport=u,this.propertyChangeSupport=new PropertyChangeSupport(this),this.dimensionLineModification=!0,this.updateProperties()}}return e.prototype.getView=function(){return null==this.dimensionLineView&&(this.dimensionLineView=this.viewFactory.createDimensionLineView(this.dimensionLineModification,this.preferences,this)),this.dimensionLineView},e.prototype.displayView=function(e){this.getView().displayView(e)},e.prototype.addPropertyChangeListener=function(e,t){this.propertyChangeSupport.addPropertyChangeListener(e,t)},e.prototype.removePropertyChangeListener=function(e,t){this.propertyChangeSupport.removePropertyChangeListener(e,t)},e.prototype.updateProperties=function(){var t=Home.getDimensionLinesSubList(this.home.getSelectedItems());if(0==t.length)this.setXStart(null),this.setYStart(null),this.setElevationStart(null),this.setXEnd(null),this.setYEnd(null),this.setElevationEnd(null),this.setEditableDistance(!1),this.setOrientation(null),this.setOffset(null),this.setLengthFontSize(null),this.setColor(null),this.setVisibleIn3D(null),this.setPitch(null);else{for(var i=t[0],n=i.getXStart(),o=1;o<t.length;o++)if(n!==t[o].getXStart()){n=null;break}this.setXStart(n);var r=i.getYStart();for(o=1;o<t.length;o++)if(r!==t[o].getYStart()){r=null;break}this.setYStart(r);var l=i.getElevationStart();for(o=1;o<t.length;o++)if(l!==t[o].getElevationStart()){l=null;break}this.setElevationStart(l);var a=i.getXEnd();for(o=1;o<t.length;o++)if(a!==t[o].getXEnd()){a=null;break}this.setXEnd(a);var s=i.getYEnd();for(o=1;o<t.length;o++)if(s!==t[o].getYEnd()){s=null;break}this.setYEnd(s);var h=i.getElevationEnd(),u=i.isElevationDimensionLine();for(o=1;o<t.length;o++)if(h!==t[o].getElevationEnd()||u!==t[o].isElevationDimensionLine()){h=null;break}this.setElevationEnd(h),this.setEditableDistance(null!=this.getXStart()&&null!=this.getYStart()&&null!=this.getElevationStart()&&null!=this.getXEnd()&&null!=this.getYEnd()&&null!=this.getElevationEnd());var d=null;i.isElevationDimensionLine()?d=e.DimensionLineOrientation.ELEVATION:i.getElevationStart()===i.getElevationEnd()&&(d=e.DimensionLineOrientation.PLAN);for(o=1;o<t.length;o++){if((m=t[o]).isElevationDimensionLine()&&d!==e.DimensionLineOrientation.ELEVATION||m.getElevationStart()===m.getElevationEnd()&&d!==e.DimensionLineOrientation.PLAN){d=null;break}}this.setOrientation(d,!1);var c=i.getOffset();for(o=1;o<t.length;o++)if(c!==t[o].getOffset()){c=null;break}this.setOffset(c);var p=this.preferences.getDefaultTextStyle(DimensionLine).getFontSize(),g=null!=i.getLengthStyle()?i.getLengthStyle().getFontSize():p;for(o=1;o<t.length;o++){var m;if(g!==(null!=(m=t[o]).getLengthStyle()?m.getLengthStyle().getFontSize():p)){g=null;break}}this.setLengthFontSize(g);var f=i.getColor();if(null!=f)for(o=1;o<t.length;o++)if(f!==t[o].getColor()){f=null;break}this.setColor(f);var v=i.isVisibleIn3D();for(o=1;o<t.length;o++)if(v!==t[o].isVisibleIn3D()){v=null;break}this.setVisibleIn3D(v);var _=i.getPitch();for(o=1;o<t.length;o++)if(_!==t[o].getPitch()){_=null;break}this.setPitch(_)}},e.prototype.setXStart=function(t,i){if(void 0===i&&(i=!0),t!==this.xStart){var n=this.xStart;this.xStart=t,this.propertyChangeSupport.firePropertyChange("X_START",n,t),i&&this.orientation===e.DimensionLineOrientation.ELEVATION?this.setXEnd(t,!1):this.updateDistanceToEndPoint()}},e.prototype.getXStart=function(){return this.xStart},e.prototype.setYStart=function(t,i){if(void 0===i&&(i=!0),t!==this.yStart){var n=this.yStart;this.yStart=t,this.propertyChangeSupport.firePropertyChange("Y_START",n,t),i&&this.orientation===e.DimensionLineOrientation.ELEVATION?this.setYEnd(t,!1):this.updateDistanceToEndPoint()}},e.prototype.getYStart=function(){return this.yStart},e.prototype.setElevationStart=function(t,i){if(void 0===i&&(i=!0),t!==this.elevationStart){var n=this.elevationStart;this.elevationStart=t,this.propertyChangeSupport.firePropertyChange("ELEVATION_START",n,t),i&&this.orientation===e.DimensionLineOrientation.PLAN?this.setElevationEnd(t,!1):this.updateDistanceToEndPoint()}},e.prototype.getElevationStart=function(){return this.elevationStart},e.prototype.setXEnd=function(t,i){if(void 0===i&&(i=!0),t!==this.xEnd){var n=this.xEnd;this.xEnd=t,this.propertyChangeSupport.firePropertyChange("X_END",n,t),i&&this.orientation===e.DimensionLineOrientation.ELEVATION?this.setXStart(t,!1):this.updateDistanceToEndPoint()}},e.prototype.getXEnd=function(){return this.xEnd},e.prototype.setYEnd=function(t,i){if(void 0===i&&(i=!0),t!==this.yEnd){var n=this.yEnd;this.yEnd=t,this.propertyChangeSupport.firePropertyChange("Y_END",n,t),i&&this.orientation===e.DimensionLineOrientation.ELEVATION?this.setYStart(t,!1):this.updateDistanceToEndPoint()}},e.prototype.getYEnd=function(){return this.yEnd},e.prototype.setElevationEnd=function(t,i){if(void 0===i&&(i=!0),t!==this.elevationEnd){var n=this.elevationEnd;this.elevationEnd=t,this.propertyChangeSupport.firePropertyChange("ELEVATION_END",n,t),i&&this.orientation===e.DimensionLineOrientation.PLAN?this.setElevationStart(t,!1):this.updateDistanceToEndPoint()}},e.prototype.getElevationEnd=function(){return this.elevationEnd},e.prototype.updateDistanceToEndPoint=function(){var e=this.getXStart(),t=this.getYStart(),i=this.getElevationStart(),n=this.getXEnd(),o=this.getYEnd(),r=this.getElevationEnd();if(null!=e&&null!=t&&null!=i&&null!=n&&null!=o&&null!=r){var l=new DimensionLine(e,t,i,n,o,r,0);this.setDistanceToEndPoint(l.getLength(),!1)}else this.setDistanceToEndPoint(null,!1)},e.prototype.setDistanceToEndPoint=function(e,t){if(void 0===t&&(t=!0),e!==this.distanceToEndPoint){var i=this.distanceToEndPoint;if(this.distanceToEndPoint=e,this.propertyChangeSupport.firePropertyChange("DISTANCE_TO_END_POINT",i,e),t){var n=this.getXStart(),o=this.getYStart(),r=this.getElevationStart(),l=this.getXEnd(),a=this.getYEnd(),s=this.getElevationEnd();if(null!=n&&null!=o&&null!=r&&null!=l&&null!=a&&null!=s&&null!=e){var h=Math.atan2(o-a,l-n),u=Math.atan2(s-r,l-n);this.setXEnd(n+e*Math.cos(h)*Math.cos(u)),this.setYEnd(o-e*Math.sin(h)*Math.cos(u)),this.setElevationEnd(r+e*Math.sin(u))}else this.setXEnd(null),this.setYEnd(null),this.setElevationEnd(null)}}},e.prototype.getDistanceToEndPoint=function(){return this.distanceToEndPoint},e.prototype.setOrientation=function(t,i){if(void 0===i&&(i=!0),t!==this.orientation){var n=this.orientation;if(this.orientation=t,this.propertyChangeSupport.firePropertyChange("ORIENTATION",n,t),i&&(t===e.DimensionLineOrientation.PLAN&&0!==this.pitch&&this.pitch!==Math.PI/2&&this.setPitch(0),null!=this.distanceToEndPoint)){var o=this.distanceToEndPoint,r=this.getXStart(),l=this.getYStart(),a=this.getElevationStart();t===e.DimensionLineOrientation.PLAN?(this.setElevationEnd(a,!1),this.setYEnd(l,!1),this.setXEnd(r+o,!1)):t===e.DimensionLineOrientation.ELEVATION&&(this.setXEnd(r,!1),this.setYEnd(l,!1),this.setElevationEnd(a+o,!1))}}},e.prototype.getOrientation=function(){return this.orientation},e.prototype.setEditableDistance=function(e){e!==this.editableDistance&&(this.editableDistance=e,this.propertyChangeSupport.firePropertyChange("EDITABLE_DISTANCE",!e,e))},e.prototype.isEditableDistance=function(){return this.editableDistance},e.prototype.setOffset=function(e){if(e!==this.offset){var t=this.offset;this.offset=e,this.propertyChangeSupport.firePropertyChange("OFFSET",t,e)}},e.prototype.getOffset=function(){return this.offset},e.prototype.setLengthFontSize=function(e){if(e!==this.lengthFontSize){var t=this.lengthFontSize;this.lengthFontSize=e,this.propertyChangeSupport.firePropertyChange("LENGTH_FONT_SIZE",t,e)}},e.prototype.getLengthFontSize=function(){return this.lengthFontSize},e.prototype.setColor=function(e){if(e!==this.color){var t=this.color;this.color=e,this.propertyChangeSupport.firePropertyChange("COLOR",t,e)}},e.prototype.getColor=function(){return this.color},e.prototype.setVisibleIn3D=function(e){if(e!==this.visibleIn3D){var t=this.visibleIn3D;this.visibleIn3D=e,this.propertyChangeSupport.firePropertyChange("VISIBLE_IN_3D",t,e)}},e.prototype.isVisibleIn3D=function(){return this.visibleIn3D},e.prototype.setPitch=function(e){if(e!==this.pitch){var t=this.pitch;this.pitch=e,this.propertyChangeSupport.firePropertyChange("PITCH",t,e)}},e.prototype.getPitch=function(){return this.pitch},e.prototype.createDimensionLine$float$float$float$float$float$float$float=function(e,t,i,n,o,r,l){var a=new DimensionLine(this.getXStart(),this.getYStart(),this.getElevationStart(),this.getXEnd(),this.getYEnd(),this.getElevationEnd(),this.getOffset());return this.home.addDimensionLine(a),a},e.prototype.createDimensionLine=function(e,t,i,n,o,r,l){if("number"!=typeof e&&null!==e||"number"!=typeof t&&null!==t||"number"!=typeof i&&null!==i||"number"!=typeof n&&null!==n||"number"!=typeof o&&null!==o||"number"!=typeof r&&null!==r||"number"!=typeof l&&null!==l){if(void 0===e&&void 0===t&&void 0===i&&void 0===n&&void 0===o&&void 0===r&&void 0===l)return this.createDimensionLine$();throw new Error("invalid overload")}return this.createDimensionLine$float$float$float$float$float$float$float(e,t,i,n,o,r,l)},e.prototype.createDimensionLine$=function(){var t=this.home.getSelectedItems(),i=this.home.isBasePlanLocked(),n=this.home.isAllLevelsSelection(),o=this.createDimensionLine$float$float$float$float$float$float$float(this.getXStart(),this.getYStart(),this.getElevationStart(),this.getXEnd(),this.getYEnd(),this.getElevationEnd(),this.getOffset()),r=this.getLengthFontSize();if(null!=r){var l=this.preferences.getDefaultTextStyle(DimensionLine).deriveStyle$float(r);o.setLengthStyle(l)}if(o.setColor(this.getColor()),o.setVisibleIn3D(this.isVisibleIn3D()),o.setPitch(this.getPitch()),e.doAddAndSelectDimensionLine(this.home,o,!1),null!=this.undoSupport){var a=new e.DimensionLineCreationUndoableEdit(this.home,this.preferences,t.slice(0),i,n,o);this.undoSupport.postEdit(a)}},e.doAddAndSelectDimensionLine=function(e,t,i){i&&e.addDimensionLine(t),e.setBasePlanLocked(!1),e.setSelectedItems([t].slice(0)),e.setAllLevelsSelection(!1)},e.doDeleteDimensionLine=function(e,t,i){e.deleteDimensionLine(t),e.setBasePlanLocked(i)},e.prototype.modifyDimensionLines=function(){var t=this.home.getSelectedItems(),i=Home.getDimensionLinesSubList(t);if(0!=i.length){for(var n=this.getXStart(),o=this.getYStart(),r=this.getElevationStart(),l=this.getXEnd(),a=this.getYEnd(),s=this.getElevationEnd(),h=this.getOffset(),u=this.getLengthFontSize(),d=this.getColor(),c=this.isVisibleIn3D(),p=this.getPitch(),g=function(e){for(var t=[];e-- >0;)t.push(null);return t}(i.length),m=0;m<g.length;m++)g[m]=new e.ModifiedDimensionLine(i[m]);var f=this.preferences.getDefaultTextStyle(DimensionLine);if(e.doModifyDimensionLines(g,n,o,r,l,a,s,h,u,f,d,c,p),null!=this.undoSupport){var v=new e.DimensionLinesModificationUndoableEdit(this.home,this.preferences,t.slice(0),g,n,o,r,l,a,s,h,u,f,d,c,p);this.undoSupport.postEdit(v)}}},e.doModifyDimensionLines=function(e,t,i,n,o,r,l,a,s,h,u,d,c){for(var p=0;p<e.length;p++){var g=e[p].getDimensionLine();null!=t&&g.setXStart(t),null!=i&&g.setYStart(i),null!=n&&(null==l&&(g.isElevationDimensionLine()?g.setElevationEnd(n+g.getElevationEnd()-g.getElevationStart()):g.setElevationEnd(n)),g.setElevationStart(n)),null!=o&&g.setXEnd(o),null!=r&&g.setYEnd(r),null!=l&&g.setElevationEnd(l),null!=a&&g.setOffset(a),null!=s&&g.setLengthStyle(null!=g.getLengthStyle()?g.getLengthStyle().deriveStyle$float(s):h.deriveStyle$float(s)),null!=u&&g.setColor(u),null!=d&&g.setVisibleIn3D(d),null!=c&&g.setPitch(c)}},e.undoModifyDimensionLines=function(e){for(var t=0;t<e.length;t++){e[t].reset()}},e}();DimensionLineController.__class="com.eteks.sweethome3d.viewcontroller.DimensionLineController",DimensionLineController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"],function(e){var t;(t=e.DimensionLineOrientation||(e.DimensionLineOrientation={}))[t.PLAN=0]="PLAN",t[t.ELEVATION=1]="ELEVATION",t[t.DIAGONAL=2]="DIAGONAL";var i=function(t){function i(i,n,o,r,l,a){var s=t.call(this,n,e,"undoCreateDimensionLineName")||this;return void 0===s.home&&(s.home=null),void 0===s.oldSelection&&(s.oldSelection=null),void 0===s.oldBasePlanLocked&&(s.oldBasePlanLocked=!1),void 0===s.oldAllLevelsSelection&&(s.oldAllLevelsSelection=!1),void 0===s.dimensionLine&&(s.dimensionLine=null),s.home=i,s.oldSelection=o,s.oldBasePlanLocked=r,s.oldAllLevelsSelection=l,s.dimensionLine=a,s}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),e.doDeleteDimensionLine(this.home,this.dimensionLine,this.oldBasePlanLocked),this.home.setSelectedItems(this.oldSelection.slice(0)),this.home.setAllLevelsSelection(this.oldAllLevelsSelection)},i.prototype.redo=function(){t.prototype.redo.call(this),e.doAddAndSelectDimensionLine(this.home,this.dimensionLine,!0)},i}(LocalizedUndoableEdit);e.DimensionLineCreationUndoableEdit=i,i.__class="com.eteks.sweethome3d.viewcontroller.DimensionLineController.DimensionLineCreationUndoableEdit",i.__interfaces=["javax.swing.undo.UndoableEdit"];var n=function(t){function i(i,n,o,r,l,a,s,h,u,d,c,p,g,m,f,v){var _=t.call(this,n,e,"undoModifyDimensionLinesName")||this;return void 0===_.home&&(_.home=null),void 0===_.oldSelection&&(_.oldSelection=null),void 0===_.modifiedDimensionLines&&(_.modifiedDimensionLines=null),void 0===_.xStart&&(_.xStart=null),void 0===_.yStart&&(_.yStart=null),void 0===_.elevationStart&&(_.elevationStart=null),void 0===_.xEnd&&(_.xEnd=null),void 0===_.yEnd&&(_.yEnd=null),void 0===_.elevationEnd&&(_.elevationEnd=null),void 0===_.offset&&(_.offset=null),void 0===_.lengthFontSize&&(_.lengthFontSize=null),void 0===_.defaultStyle&&(_.defaultStyle=null),void 0===_.color&&(_.color=null),void 0===_.visibleIn3D&&(_.visibleIn3D=null),void 0===_.pitch&&(_.pitch=null),_.home=i,_.oldSelection=o,_.modifiedDimensionLines=r,_.xStart=l,_.yStart=a,_.elevationStart=s,_.xEnd=h,_.yEnd=u,_.elevationEnd=d,_.offset=c,_.lengthFontSize=p,_.defaultStyle=g,_.color=m,_.visibleIn3D=f,_.pitch=v,_}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),e.undoModifyDimensionLines(this.modifiedDimensionLines),this.home.setSelectedItems(this.oldSelection.slice(0))},i.prototype.redo=function(){t.prototype.redo.call(this),e.doModifyDimensionLines(this.modifiedDimensionLines,this.xStart,this.yStart,this.elevationStart,this.xEnd,this.yEnd,this.elevationEnd,this.offset,this.lengthFontSize,this.defaultStyle,this.color,this.visibleIn3D,this.pitch),this.home.setSelectedItems(this.oldSelection.slice(0))},i}(LocalizedUndoableEdit);e.DimensionLinesModificationUndoableEdit=n,n.__class="com.eteks.sweethome3d.viewcontroller.DimensionLineController.DimensionLinesModificationUndoableEdit",n.__interfaces=["javax.swing.undo.UndoableEdit"];var o=function(){function e(e){void 0===this.dimensionLine&&(this.dimensionLine=null),void 0===this.xStart&&(this.xStart=0),void 0===this.yStart&&(this.yStart=0),void 0===this.elevationStart&&(this.elevationStart=0),void 0===this.xEnd&&(this.xEnd=0),void 0===this.yEnd&&(this.yEnd=0),void 0===this.elevationEnd&&(this.elevationEnd=0),void 0===this.offset&&(this.offset=0),void 0===this.lengthStyle&&(this.lengthStyle=null),void 0===this.color&&(this.color=null),void 0===this.visibleIn3D&&(this.visibleIn3D=!1),void 0===this.pitch&&(this.pitch=0),this.dimensionLine=e,this.xStart=e.getXStart(),this.yStart=e.getYStart(),this.elevationStart=e.getElevationStart(),this.xEnd=e.getXEnd(),this.yEnd=e.getYEnd(),this.elevationEnd=e.getElevationEnd(),this.offset=e.getOffset(),this.lengthStyle=e.getLengthStyle(),this.color=e.getColor(),this.visibleIn3D=e.isVisibleIn3D(),this.pitch=e.getPitch()}return e.prototype.getDimensionLine=function(){return this.dimensionLine},e.prototype.reset=function(){this.dimensionLine.setXStart(this.xStart),this.dimensionLine.setYStart(this.yStart),this.dimensionLine.setElevationStart(this.elevationStart),this.dimensionLine.setXEnd(this.xEnd),this.dimensionLine.setYEnd(this.yEnd),this.dimensionLine.setElevationEnd(this.elevationEnd),this.dimensionLine.setOffset(this.offset),this.dimensionLine.setLengthStyle(this.lengthStyle),this.dimensionLine.setColor(this.color),this.dimensionLine.setVisibleIn3D(this.visibleIn3D),this.dimensionLine.setPitch(this.pitch)},e}();e.ModifiedDimensionLine=o,o.__class="com.eteks.sweethome3d.viewcontroller.DimensionLineController.ModifiedDimensionLine"}(DimensionLineController||(DimensionLineController={}));var BackgroundImageWizardController=function(e){function t(i,n,o,r,l){var a=e.call(this,n,o)||this;void 0===a.home&&(a.home=null),void 0===a.__com_eteks_sweethome3d_viewcontroller_BackgroundImageWizardController_preferences&&(a.__com_eteks_sweethome3d_viewcontroller_BackgroundImageWizardController_preferences=null),void 0===a.__com_eteks_sweethome3d_viewcontroller_BackgroundImageWizardController_viewFactory&&(a.__com_eteks_sweethome3d_viewcontroller_BackgroundImageWizardController_viewFactory=null),void 0===a.contentManager&&(a.contentManager=null),void 0===a.undoSupport&&(a.undoSupport=null),void 0===a.imageChoiceStepState&&(a.imageChoiceStepState=null),void 0===a.imageScaleStepState&&(a.imageScaleStepState=null),void 0===a.imageOriginStepState&&(a.imageOriginStepState=null),void 0===a.stepsView&&(a.stepsView=null),void 0===a.step&&(a.step=null),void 0===a.referenceBackgroundImage&&(a.referenceBackgroundImage=null),void 0===a.image&&(a.image=null),void 0===a.scaleDistance&&(a.scaleDistance=null),void 0===a.scaleDistanceXStart&&(a.scaleDistanceXStart=0),void 0===a.scaleDistanceYStart&&(a.scaleDistanceYStart=0),void 0===a.scaleDistanceXEnd&&(a.scaleDistanceXEnd=0),void 0===a.scaleDistanceYEnd&&(a.scaleDistanceYEnd=0),void 0===a.xOrigin&&(a.xOrigin=0),void 0===a.yOrigin&&(a.yOrigin=0),a.home=i,a.__com_eteks_sweethome3d_viewcontroller_BackgroundImageWizardController_preferences=n,a.__com_eteks_sweethome3d_viewcontroller_BackgroundImageWizardController_viewFactory=o,a.contentManager=r,a.undoSupport=l,a.setTitle(n.getLocalizedString(t,"wizard.title")),a.setResizable(!0),a.imageChoiceStepState=new t.ImageChoiceStepState(a),a.imageScaleStepState=new t.ImageScaleStepState(a),a.imageOriginStepState=new t.ImageOriginStepState(a),a.setStepState(a.imageChoiceStepState);var s=a.home.getSelectedLevel();if(null!=s){for(var h=a.home.getLevels(),u=h.indexOf(s),d=u-1;d>=0&&null==a.referenceBackgroundImage;d--)a.referenceBackgroundImage=h[d].getBackgroundImage();for(d=u+1;d<h.length&&null==a.referenceBackgroundImage;d++)a.referenceBackgroundImage=h[d].getBackgroundImage()}return a}return __extends(t,e),t.prototype.finish=function(){var e=this.home.getSelectedLevel(),i=null!=e?e.getBackgroundImage():this.home.getBackgroundImage(),n=this.getScaleDistancePoints(),o=new BackgroundImage(this.getImage(),this.getScaleDistance(),n[0][0],n[0][1],n[1][0],n[1][1],this.getXOrigin(),this.getYOrigin());null!=e?e.setBackgroundImage(o):this.home.setBackgroundImage(o);var r=null==i;this.undoSupport.postEdit(new t.BackgroundImageUndoableEdit(this.home,this.__com_eteks_sweethome3d_viewcontroller_BackgroundImageWizardController_preferences,e,i,o,r))},t.prototype.getContentManager=function(){return this.contentManager},t.prototype.getStepState=function(){return e.prototype.getStepState.call(this)},t.prototype.getImageChoiceStepState=function(){return this.imageChoiceStepState},t.prototype.getImageOriginStepState=function(){return this.imageOriginStepState},t.prototype.getImageScaleStepState=function(){return this.imageScaleStepState},t.prototype.getStepsView=function(){if(null==this.stepsView){var e=null!=this.home.getSelectedLevel()?this.home.getSelectedLevel().getBackgroundImage():this.home.getBackgroundImage();this.stepsView=this.__com_eteks_sweethome3d_viewcontroller_BackgroundImageWizardController_viewFactory.createBackgroundImageWizardStepsView(e,this.__com_eteks_sweethome3d_viewcontroller_BackgroundImageWizardController_preferences,this)}return this.stepsView},t.prototype.setStep=function(e){if(e!==this.step){var t=this.step;this.step=e,this.propertyChangeSupport.firePropertyChange("STEP",t,e)}},t.prototype.getStep=function(){return this.step},t.prototype.getReferenceBackgroundImage=function(){return this.referenceBackgroundImage},t.prototype.setImage=function(e){if(e!==this.image){var t=this.image;this.image=e,this.propertyChangeSupport.firePropertyChange("IMAGE",t,e)}},t.prototype.getImage=function(){return this.image},t.prototype.setScaleDistance=function(e){if(e!==this.scaleDistance){var t=this.scaleDistance;this.scaleDistance=e,this.propertyChangeSupport.firePropertyChange("SCALE_DISTANCE",t,e)}},t.prototype.getScaleDistance=function(){return this.scaleDistance},t.prototype.setScaleDistancePoints=function(e,t,i,n){if(e!==this.scaleDistanceXStart||t!==this.scaleDistanceYStart||i!==this.scaleDistanceXEnd||n!==this.scaleDistanceYEnd){var o=[[this.scaleDistanceXStart,this.scaleDistanceYStart],[this.scaleDistanceXEnd,this.scaleDistanceYEnd]];this.scaleDistanceXStart=e,this.scaleDistanceYStart=t,this.scaleDistanceXEnd=i,this.scaleDistanceYEnd=n,this.propertyChangeSupport.firePropertyChange("SCALE_DISTANCE_POINTS",o,[[e,t],[i,n]])}},t.prototype.getScaleDistancePoints=function(){return[[this.scaleDistanceXStart,this.scaleDistanceYStart],[this.scaleDistanceXEnd,this.scaleDistanceYEnd]]},t.prototype.setOrigin=function(e,t){if(e!==this.xOrigin){var i=this.xOrigin;this.xOrigin=e,this.propertyChangeSupport.firePropertyChange("X_ORIGIN",i,e)}if(t!==this.yOrigin){var n=this.yOrigin;this.yOrigin=t,this.propertyChangeSupport.firePropertyChange("Y_ORIGIN",n,t)}},t.prototype.getXOrigin=function(){return this.xOrigin},t.prototype.getYOrigin=function(){return this.yOrigin},t}(WizardController);BackgroundImageWizardController.__class="com.eteks.sweethome3d.viewcontroller.BackgroundImageWizardController",BackgroundImageWizardController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"],function(e){var t;(t=e.Step||(e.Step={}))[t.CHOICE=0]="CHOICE",t[t.SCALE=1]="SCALE",t[t.ORIGIN=2]="ORIGIN";var i=function(t){function i(i,n,o,r,l,a){var s=t.call(this,n,e,a?"undoImportBackgroundImageName":"undoModifyBackgroundImageName")||this;return void 0===s.home&&(s.home=null),void 0===s.level&&(s.level=null),void 0===s.oldImage&&(s.oldImage=null),void 0===s.image&&(s.image=null),s.home=i,s.level=o,s.oldImage=r,s.image=l,s}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),this.home.setSelectedLevel(this.level),null!=this.level?this.level.setBackgroundImage(this.oldImage):this.home.setBackgroundImage(this.oldImage)},i.prototype.redo=function(){t.prototype.redo.call(this),this.home.setSelectedLevel(this.level),null!=this.level?this.level.setBackgroundImage(this.image):this.home.setBackgroundImage(this.image)},i}(LocalizedUndoableEdit);e.BackgroundImageUndoableEdit=i,i.__class="com.eteks.sweethome3d.viewcontroller.BackgroundImageWizardController.BackgroundImageUndoableEdit",i.__interfaces=["javax.swing.undo.UndoableEdit"];var n=function(e){function t(t){var i=e.call(this)||this;return i.__parent=t,i.icon="resources/backgroundImageWizard.png",i}return __extends(t,e),t.prototype.enter=function(){this.__parent.setStep(this.getStep())},t.prototype.getView=function(){return this.__parent.getStepsView()},t.prototype.getIcon=function(){return this.icon},t}(WizardController.WizardControllerStepState);e.BackgroundImageWizardStepState=n,n.__class="com.eteks.sweethome3d.viewcontroller.BackgroundImageWizardController.BackgroundImageWizardStepState";var o=function(t){function i(e){var n=t.call(this,e)||this;return n.__parent=e,e.addPropertyChangeListener("IMAGE",new i.ImageChoiceStepState$0(n)),n}return __extends(i,t),i.prototype.enter=function(){t.prototype.enter.call(this),this.setFirstStep(!0),this.setNextStepEnabled(null!=this.__parent.getImage())},i.prototype.getStep=function(){return e.Step.CHOICE},i.prototype.goToNextStep=function(){this.__parent.setStepState(this.__parent.getImageScaleStepState())},i}(e.BackgroundImageWizardStepState);e.ImageChoiceStepState=o,o.__class="com.eteks.sweethome3d.viewcontroller.BackgroundImageWizardController.ImageChoiceStepState",function(e){var t=function(){function e(e){this.__parent=e}return e.prototype.propertyChange=function(e){this.__parent.setNextStepEnabled(null!=this.__parent.__parent.getImage())},e}();e.ImageChoiceStepState$0=t}(o=e.ImageChoiceStepState||(e.ImageChoiceStepState={}));var r=function(t){function i(e){var n=t.call(this,e)||this;return n.__parent=e,e.addPropertyChangeListener("SCALE_DISTANCE",new i.ImageScaleStepState$0(n)),n}return __extends(i,t),i.prototype.enter=function(){t.prototype.enter.call(this),this.setNextStepEnabled(null!=this.__parent.getScaleDistance())},i.prototype.getStep=function(){return e.Step.SCALE},i.prototype.goBackToPreviousStep=function(){this.__parent.setStepState(this.__parent.getImageChoiceStepState())},i.prototype.goToNextStep=function(){this.__parent.setStepState(this.__parent.getImageOriginStepState())},i}(e.BackgroundImageWizardStepState);e.ImageScaleStepState=r,r.__class="com.eteks.sweethome3d.viewcontroller.BackgroundImageWizardController.ImageScaleStepState",function(e){var t=function(){function e(e){this.__parent=e}return e.prototype.propertyChange=function(e){this.__parent.setNextStepEnabled(null!=this.__parent.__parent.getScaleDistance())},e}();e.ImageScaleStepState$0=t}(r=e.ImageScaleStepState||(e.ImageScaleStepState={}));var l=function(t){function i(e){var i=t.call(this,e)||this;return i.__parent=e,i}return __extends(i,t),i.prototype.enter=function(){t.prototype.enter.call(this),this.setLastStep(!0),this.setNextStepEnabled(!0)},i.prototype.getStep=function(){return e.Step.ORIGIN},i.prototype.goBackToPreviousStep=function(){this.__parent.setStepState(this.__parent.getImageScaleStepState())},i}(e.BackgroundImageWizardStepState);e.ImageOriginStepState=l,l.__class="com.eteks.sweethome3d.viewcontroller.BackgroundImageWizardController.ImageOriginStepState"}(BackgroundImageWizardController||(BackgroundImageWizardController={}));var RoomController=function(){function e(e,t,i,n,o){void 0===this.home&&(this.home=null),void 0===this.preferences&&(this.preferences=null),void 0===this.viewFactory&&(this.viewFactory=null),void 0===this.contentManager&&(this.contentManager=null),void 0===this.undoSupport&&(this.undoSupport=null),void 0===this.floorTextureController&&(this.floorTextureController=null),void 0===this.ceilingTextureController&&(this.ceilingTextureController=null),void 0===this.wallSidesTextureController&&(this.wallSidesTextureController=null),void 0===this.wallSidesBaseboardController&&(this.wallSidesBaseboardController=null),void 0===this.propertyChangeSupport&&(this.propertyChangeSupport=null),void 0===this.roomView&&(this.roomView=null),void 0===this.name&&(this.name=null),void 0===this.areaVisible&&(this.areaVisible=null),void 0===this.floorVisible&&(this.floorVisible=null),void 0===this.floorColor&&(this.floorColor=null),void 0===this.floorPaint&&(this.floorPaint=null),void 0===this.floorShininess&&(this.floorShininess=null),void 0===this.ceilingVisible&&(this.ceilingVisible=null),void 0===this.ceilingColor&&(this.ceilingColor=null),void 0===this.ceilingPaint&&(this.ceilingPaint=null),void 0===this.ceilingShininess&&(this.ceilingShininess=null),void 0===this.ceilingFlat&&(this.ceilingFlat=null),void 0===this.wallSidesEditable&&(this.wallSidesEditable=!1),void 0===this.splitSurroundingWalls&&(this.splitSurroundingWalls=!1),void 0===this.splitSurroundingWallsNeeded&&(this.splitSurroundingWallsNeeded=!1),void 0===this.wallSidesColor&&(this.wallSidesColor=null),void 0===this.wallSidesPaint&&(this.wallSidesPaint=null),void 0===this.wallSidesShininess&&(this.wallSidesShininess=null),this.home=e,this.preferences=t,this.viewFactory=i,this.contentManager=n,this.undoSupport=o,this.propertyChangeSupport=new PropertyChangeSupport(this),this.updateProperties()}return e.prototype.getFloorTextureController=function(){return null==this.floorTextureController&&(this.floorTextureController=new TextureChoiceController(this.preferences.getLocalizedString(e,"floorTextureTitle"),this.preferences,this.viewFactory,this.contentManager),this.floorTextureController.addPropertyChangeListener("TEXTURE",new e.RoomController$0(this))),this.floorTextureController},e.prototype.getCeilingTextureController=function(){return null==this.ceilingTextureController&&(this.ceilingTextureController=new TextureChoiceController(this.preferences.getLocalizedString(e,"ceilingTextureTitle"),this.preferences,this.viewFactory,this.contentManager),this.ceilingTextureController.addPropertyChangeListener("TEXTURE",new e.RoomController$1(this))),this.ceilingTextureController},e.prototype.getWallSidesTextureController=function(){return null==this.wallSidesTextureController&&(this.wallSidesTextureController=new TextureChoiceController(this.preferences.getLocalizedString(e,"wallSidesTextureTitle"),this.preferences,this.viewFactory,this.contentManager),this.wallSidesTextureController.addPropertyChangeListener("TEXTURE",new e.RoomController$2(this))),this.wallSidesTextureController},e.prototype.getWallSidesBaseboardController=function(){return null==this.wallSidesBaseboardController&&(this.wallSidesBaseboardController=new BaseboardChoiceController(this.preferences,this.viewFactory,this.contentManager)),this.wallSidesBaseboardController},e.prototype.getView=function(){return null==this.roomView&&(this.roomView=this.viewFactory.createRoomView(this.preferences,this)),this.roomView},e.prototype.displayView=function(e){this.getView().displayView(e)},e.prototype.addPropertyChangeListener=function(e,t){this.propertyChangeSupport.addPropertyChangeListener(e,t)},e.prototype.removePropertyChangeListener=function(e,t){this.propertyChangeSupport.removePropertyChangeListener(e,t)},e.prototype.isPropertyEditable=function(e){switch(e){case"SPLIT_SURROUNDING_WALLS":case"WALL_SIDES_COLOR":case"WALL_SIDES_PAINT":case"WALL_SIDES_SHININESS":case"WALL_SIDES_BASEBOARD":return this.wallSidesEditable;default:return!0}},e.prototype.updateProperties=function(){var t=Home.getRoomsSubList(this.home.getSelectedItems());if(0==t.length)this.setAreaVisible(null),this.setFloorColor(null),this.getFloorTextureController().setTexture(null),this.setFloorPaint(null),this.setFloorShininess(null),this.setCeilingColor(null),this.getCeilingTextureController().setTexture(null),this.setCeilingPaint(null),this.setCeilingShininess(null),this.setCeilingFlat(null);else{var i=t[0],n=i.getName();if(null!=n)for(var o=1;o<t.length;o++)if(n!==t[o].getName()){n=null;break}this.setName(n);var r=i.isAreaVisible();for(o=1;o<t.length;o++)if(r!==t[o].isAreaVisible()){r=null;break}this.setAreaVisible(r);var l=i.isFloorVisible();for(o=1;o<t.length;o++)if(l!==t[o].isFloorVisible()){l=null;break}this.setFloorVisible(l);var a=i.getFloorColor();if(null!=a)for(o=1;o<t.length;o++)if(a!==t[o].getFloorColor()){a=null;break}this.setFloorColor(a);var s=i.getFloorTexture();if(null!=s)for(o=1;o<t.length;o++)if(!s.equals(t[o].getFloorTexture())){s=null;break}this.getFloorTextureController().setTexture(s);var h=!0;for(o=0;o<t.length;o++){if(null!=(g=t[o]).getFloorColor()||null!=g.getFloorTexture()){h=!1;break}}null!=a?this.setFloorPaint(e.RoomPaint.COLORED):null!=s?this.setFloorPaint(e.RoomPaint.TEXTURED):h?this.setFloorPaint(e.RoomPaint.DEFAULT):this.setFloorPaint(null);var u=i.getFloorShininess();for(o=1;o<t.length;o++)if(u!==t[o].getFloorShininess()){u=null;break}this.setFloorShininess(u);var d=i.isCeilingVisible();for(o=1;o<t.length;o++)if(d!==t[o].isCeilingVisible()){d=null;break}this.setCeilingVisible(d);var c=i.getCeilingColor();if(null!=c)for(o=1;o<t.length;o++)if(c!==t[o].getCeilingColor()){c=null;break}this.setCeilingColor(c);var p=i.getCeilingTexture();if(null!=p)for(o=1;o<t.length;o++)if(!p.equals(t[o].getCeilingTexture())){p=null;break}this.getCeilingTextureController().setTexture(p),h=!0;for(o=0;o<t.length;o++){var g;if(null!=(g=t[o]).getCeilingColor()||null!=g.getCeilingTexture()){h=!1;break}}null!=c?this.setCeilingPaint(e.RoomPaint.COLORED):null!=p?this.setCeilingPaint(e.RoomPaint.TEXTURED):h?this.setCeilingPaint(e.RoomPaint.DEFAULT):this.setCeilingPaint(null);var m=i.getCeilingShininess();for(o=1;o<t.length;o++)if(m!==t[o].getCeilingShininess()){m=null;break}this.setCeilingShininess(m);var f=i.isCeilingFlat();for(o=1;o<t.length;o++)if(f!==t[o].isCeilingFlat()){f=null;break}this.setCeilingFlat(f)}var v=this.getRoomsWallSides(t,null);if(0==v.length)this.wallSidesEditable=this.splitSurroundingWallsNeeded=this.splitSurroundingWalls=!1,this.setWallSidesColor(null),this.setWallSidesPaint(null),this.setWallSidesShininess(null),this.getWallSidesBaseboardController().setVisible(null),this.getWallSidesBaseboardController().setThickness(null),this.getWallSidesBaseboardController().setHeight(null),this.getWallSidesBaseboardController().setColor(null),this.getWallSidesBaseboardController().getTextureController().setTexture(null),this.getWallSidesBaseboardController().setPaint(null);else{this.wallSidesEditable=!0,this.splitSurroundingWallsNeeded=this.splitWalls(v,null,null,null),this.splitSurroundingWalls=!1;var _=v[0],S=_.getSide()===e.WallSide.LEFT_SIDE?_.getWall().getLeftSideColor():_.getWall().getRightSideColor();if(null!=S)for(o=1;o<v.length;o++){if(S!==((E=v[o]).getSide()===e.WallSide.LEFT_SIDE?E.getWall().getLeftSideColor():E.getWall().getRightSideColor())){S=null;break}}this.setWallSidesColor(S);var y=_.getSide()===e.WallSide.LEFT_SIDE?_.getWall().getLeftSideTexture():_.getWall().getRightSideTexture();if(null!=y)for(o=1;o<v.length;o++){var E=v[o];if(!y.equals(E.getSide()===e.WallSide.LEFT_SIDE?E.getWall().getLeftSideTexture():E.getWall().getRightSideTexture())){y=null;break}}this.getWallSidesTextureController().setTexture(y);for(h=!0,o=0;o<v.length;o++){if(null!=((E=v[o]).getSide()===e.WallSide.LEFT_SIDE?E.getWall().getLeftSideColor():E.getWall().getRightSideColor())||null!=(E.getSide()===e.WallSide.LEFT_SIDE?E.getWall().getLeftSideTexture():E.getWall().getRightSideTexture())){h=!1;break}}null!=S?this.setWallSidesPaint(e.RoomPaint.COLORED):null!=y?this.setWallSidesPaint(e.RoomPaint.TEXTURED):h?this.setWallSidesPaint(e.RoomPaint.DEFAULT):this.setWallSidesPaint(null);var C=_.getSide()===e.WallSide.LEFT_SIDE?_.getWall().getLeftSideShininess():_.getWall().getRightSideShininess();if(null!=C)for(o=1;o<v.length;o++){if(C!==((E=v[o]).getSide()===e.WallSide.LEFT_SIDE?E.getWall().getLeftSideShininess():E.getWall().getRightSideShininess())){C=null;break}}this.setWallSidesShininess(C);var P=_.getSide()===e.WallSide.LEFT_SIDE?_.getWall().getLeftSideBaseboard():_.getWall().getRightSideBaseboard(),w=null!=P;for(o=1;o<v.length;o++){if(w!==((E=v[o]).getSide()===e.WallSide.LEFT_SIDE?null!=E.getWall().getLeftSideBaseboard():null!=E.getWall().getRightSideBaseboard())){w=null;break}}this.getWallSidesBaseboardController().setVisible(w);var L=null!=P?P.getThickness():this.preferences.getNewWallBaseboardThickness();for(o=1;o<v.length;o++){if(L!==(null!=(M=(E=v[o]).getSide()===e.WallSide.LEFT_SIDE?E.getWall().getLeftSideBaseboard():E.getWall().getRightSideBaseboard())?M.getThickness():this.preferences.getNewWallBaseboardThickness())){L=null;break}}this.getWallSidesBaseboardController().setThickness(L);var T=null!=P?P.getHeight():this.preferences.getNewWallBaseboardHeight();for(o=1;o<v.length;o++){if(T!==(null!=(M=(E=v[o]).getSide()===e.WallSide.LEFT_SIDE?E.getWall().getLeftSideBaseboard():E.getWall().getRightSideBaseboard())?M.getHeight():this.preferences.getNewWallBaseboardHeight())){T=null;break}}this.getWallSidesBaseboardController().setHeight(T);var A=_.getWall().isTrapezoidal()?Math.max(_.getWall().getHeight(),_.getWall().getHeightAtEnd()):_.getWall().getHeight();for(o=1;o<v.length;o++){var I=v[o].getWall();A=Math.max(A,I.isTrapezoidal()?Math.max(I.getHeight(),I.getHeightAtEnd()):I.getHeight())}this.getWallSidesBaseboardController().setMaxHeight(A);var b=null!=P?P.getColor():null;if(null!=b)for(o=1;o<v.length;o++){if(null==(M=(E=v[o]).getSide()===e.WallSide.LEFT_SIDE?E.getWall().getLeftSideBaseboard():E.getWall().getRightSideBaseboard())||b!==M.getColor()){b=null;break}}this.getWallSidesBaseboardController().setColor(b);var O=null!=P?P.getTexture():null;if(null!=O)for(o=1;o<v.length;o++){if(null==(M=(E=v[o]).getSide()===e.WallSide.LEFT_SIDE?E.getWall().getLeftSideBaseboard():E.getWall().getRightSideBaseboard())||!O.equals(M.getTexture())){O=null;break}}this.getWallSidesBaseboardController().getTextureController().setTexture(O),h=!0;for(o=0;o<v.length;o++){var M;if(null!=(M=(E=v[o]).getSide()===e.WallSide.LEFT_SIDE?E.getWall().getLeftSideBaseboard():E.getWall().getRightSideBaseboard())&&(null!=M.getColor()||null!=M.getTexture())){h=!1;break}}null!=b?this.getWallSidesBaseboardController().setPaint(BaseboardChoiceController.BaseboardPaint.COLORED):null!=O?this.getWallSidesBaseboardController().setPaint(BaseboardChoiceController.BaseboardPaint.TEXTURED):h?this.getWallSidesBaseboardController().setPaint(BaseboardChoiceController.BaseboardPaint.DEFAULT):this.getWallSidesBaseboardController().setPaint(null)}},e.prototype.getRoomsWallSides=function(t,i){for(var n=[],o=0;o<t.length;o++){var r=t[o],l=new java.awt.geom.Area(this.getPath(r.getPoints(),!0));if(null!=i)for(var a=0;a<i.length;a++){var s=i[a];this.isRoomItersectingWallSide(s.getWall().getPoints$(),s.getSide(),l)&&n.push(s)}else{var h=this.home.getWalls();for(a=0;a<h.length;a++){var u=h[a];if((null==u.getLevel()||u.getLevel().isViewable())&&u.isAtLevel(this.home.getSelectedLevel())){var d=u.getPoints$();this.isRoomItersectingWallSide(d,e.WallSide.LEFT_SIDE,l)&&n.push(new e.WallSide(u,e.WallSide.LEFT_SIDE)),this.isRoomItersectingWallSide(d,e.WallSide.RIGHT_SIDE,l)&&n.push(new e.WallSide(u,e.WallSide.RIGHT_SIDE))}}}}return n},e.prototype.isRoomItersectingWallSide=function(e,t,i){var n=this.getWallSideArea(e,t),o=this.getSurface(n);if((n.intersect(i),!n.isEmpty())&&this.getSurface(n)>.02*o)return!0;return!1},e.prototype.getWallSideArea=function(t,i){if(4===t.length)return i===e.WallSide.LEFT_SIDE?new java.awt.geom.Area(this.getPath(new Wall(t[0][0],t[0][1],t[1][0],t[1][1],2,0).getPoints$(),!0)):new java.awt.geom.Area(this.getPath(new Wall(t[2][0],t[2][1],t[3][0],t[3][1],2,0).getPoints$(),!0));var n=function(e){for(var t=[];e-- >0;)t.push(null);return t}(t.length/2|0);!function(e,t,i,n,o){if(e!==i||n>=t+o)for(;--o>=0;)i[n++]=e[t++];else for(var r=e.slice(t,t+o),l=0;l<o;l++)i[n++]=r[l]}(t,i===e.WallSide.LEFT_SIDE?0:n.length,n,0,n.length);for(var o=function(e){for(var t=[];e-- >0;)t.push(null);return t}(n.length-1),r=0;r<o.length;r++)o[r]=new Wall(n[r][0],n[r][1],n[r+1][0],n[r+1][1],2,0),r>0&&(o[r].setWallAtStart(o[r-1]),o[r-1].setWallAtEnd(o[r]));n=function(e){for(var t=[];e-- >0;)t.push(null);return t}(t.length);var l=null;for(r=0;r<o.length;r++)l=o[r].getPoints$(),n[r]=l[0],n[n.length-r-1]=l[3];return n[(n.length/2|0)-1]=l[1],n[n.length/2|0]=l[2],new java.awt.geom.Area(this.getPath(n,!0))},e.prototype.getPath=function(e,t){var i=new java.awt.geom.GeneralPath;i.moveTo(e[0][0],e[0][1]);for(var n=1;n<e.length;n++)i.lineTo(e[n][0],e[n][1]);return t&&i.closePath(),i},e.prototype.getSurface=function(e){for(var t=0,i=[],n=e.getPathIterator(null);!n.isDone();){var o=[0,0];switch(n.currentSegment(o)){case java.awt.geom.PathIterator.SEG_MOVETO:case java.awt.geom.PathIterator.SEG_LINETO:i.push(o);break;case java.awt.geom.PathIterator.SEG_CLOSE:var r=i.slice(0);t+=Math.abs(this.getSignedSurface(r)),i.length=0}n.next()}return t},e.prototype.getSignedSurface=function(e){for(var t=0,i=1;i<e.length;i++)t+=e[i][0]*e[i-1][1],t-=e[i][1]*e[i-1][0];return t+=e[0][0]*e[e.length-1][1],(t-=e[0][1]*e[e.length-1][0])/2},e.prototype.setName=function(e){if(e!==this.name){var t=this.name;this.name=e,this.propertyChangeSupport.firePropertyChange("NAME",t,e)}},e.prototype.getName=function(){return this.name},e.prototype.setAreaVisible=function(e){if(e!==this.areaVisible){var t=this.areaVisible;this.areaVisible=e,this.propertyChangeSupport.firePropertyChange("AREA_VISIBLE",t,e)}},e.prototype.getAreaVisible=function(){return this.areaVisible},e.prototype.setFloorVisible=function(e){if(e!==this.floorVisible){var t=this.floorVisible;this.floorVisible=e,this.propertyChangeSupport.firePropertyChange("FLOOR_VISIBLE",t,e)}},e.prototype.getFloorVisible=function(){return this.floorVisible},e.prototype.setFloorColor=function(t){if(t!==this.floorColor){var i=this.floorColor;this.floorColor=t,this.propertyChangeSupport.firePropertyChange("FLOOR_COLOR",i,t),this.setFloorPaint(e.RoomPaint.COLORED)}},e.prototype.getFloorColor=function(){return this.floorColor},e.prototype.setFloorPaint=function(e){if(e!==this.floorPaint){var t=this.floorPaint;this.floorPaint=e,this.propertyChangeSupport.firePropertyChange("FLOOR_PAINT",t,e)}},e.prototype.getFloorPaint=function(){return this.floorPaint},e.prototype.setFloorShininess=function(e){if(e!==this.floorShininess){var t=this.floorShininess;this.floorShininess=e,this.propertyChangeSupport.firePropertyChange("FLOOR_SHININESS",t,e)}},e.prototype.getFloorShininess=function(){return this.floorShininess},e.prototype.setCeilingVisible=function(e){if(e!==this.ceilingVisible){var t=this.ceilingVisible;this.ceilingVisible=e,this.propertyChangeSupport.firePropertyChange("CEILING_VISIBLE",t,e)}},e.prototype.getCeilingVisible=function(){return this.ceilingVisible},e.prototype.setCeilingColor=function(t){if(t!==this.ceilingColor){var i=this.ceilingColor;this.ceilingColor=t,this.propertyChangeSupport.firePropertyChange("CEILING_COLOR",i,t),this.setCeilingPaint(e.RoomPaint.COLORED)}},e.prototype.getCeilingColor=function(){return this.ceilingColor},e.prototype.setCeilingPaint=function(e){if(e!==this.ceilingPaint){var t=this.ceilingPaint;this.ceilingPaint=e,this.propertyChangeSupport.firePropertyChange("CEILING_PAINT",t,e)}},e.prototype.getCeilingPaint=function(){return this.ceilingPaint},e.prototype.setCeilingShininess=function(e){if(e!==this.ceilingShininess){var t=this.ceilingShininess;this.ceilingShininess=e,this.propertyChangeSupport.firePropertyChange("CEILING_SHININESS",t,e)}},e.prototype.getCeilingShininess=function(){return this.ceilingShininess},e.prototype.setCeilingFlat=function(e){if(e!==this.ceilingFlat){var t=this.ceilingFlat;this.ceilingFlat=e,this.propertyChangeSupport.firePropertyChange("CEILING_FLAT",t,e)}},e.prototype.getCeilingFlat=function(){return this.ceilingFlat},e.prototype.isSplitSurroundingWalls=function(){return this.splitSurroundingWalls},e.prototype.setSplitSurroundingWalls=function(e){e!==this.splitSurroundingWalls&&(this.splitSurroundingWalls=e,this.propertyChangeSupport.firePropertyChange("SPLIT_SURROUNDING_WALLS",!e,e))},e.prototype.isSplitSurroundingWallsNeeded=function(){return this.splitSurroundingWallsNeeded},e.prototype.setWallSidesColor=function(t){if(t!==this.wallSidesColor){var i=this.wallSidesColor;this.wallSidesColor=t,this.propertyChangeSupport.firePropertyChange("WALL_SIDES_COLOR",i,t),this.setWallSidesPaint(e.RoomPaint.COLORED)}},e.prototype.getWallSidesColor=function(){return this.wallSidesColor},e.prototype.setWallSidesPaint=function(e){if(e!==this.wallSidesPaint){var t=this.wallSidesPaint;this.wallSidesPaint=e,this.propertyChangeSupport.firePropertyChange("WALL_SIDES_PAINT",t,e)}},e.prototype.getWallSidesPaint=function(){return this.wallSidesPaint},e.prototype.setWallSidesShininess=function(e){if(e!==this.wallSidesShininess){var t=this.wallSidesShininess;this.wallSidesShininess=e,this.propertyChangeSupport.firePropertyChange("WALL_SIDES_SHININESS",t,e)}},e.prototype.getWallSidesShininess=function(){return this.wallSidesShininess},e.prototype.modifyRooms=function(){var t=this.home.getSelectedItems(),i=Home.getRoomsSubList(t);if(0!=i.length){for(var n=this.getName(),o=this.getAreaVisible(),r=this.getFloorVisible(),l=this.getFloorPaint(),a=l===e.RoomPaint.COLORED?this.getFloorColor():null,s=l===e.RoomPaint.TEXTURED?this.getFloorTextureController().getTexture():null,h=this.getFloorShininess(),u=this.getCeilingVisible(),d=this.getCeilingPaint(),c=d===e.RoomPaint.COLORED?this.getCeilingColor():null,p=d===e.RoomPaint.TEXTURED?this.getCeilingTextureController().getTexture():null,g=this.getCeilingShininess(),m=this.getCeilingFlat(),f=this.getWallSidesPaint(),v=f===e.RoomPaint.COLORED?this.getWallSidesColor():null,_=f===e.RoomPaint.TEXTURED?this.getWallSidesTextureController().getTexture():null,S=this.getWallSidesShininess(),y=this.getWallSidesBaseboardController().getVisible(),E=this.getWallSidesBaseboardController().getThickness(),C=this.getWallSidesBaseboardController().getHeight(),P=this.getWallSidesBaseboardController().getPaint(),w=P===BaseboardChoiceController.BaseboardPaint.COLORED?this.getWallSidesBaseboardController().getColor():null,L=P===BaseboardChoiceController.BaseboardPaint.TEXTURED?this.getWallSidesBaseboardController().getTextureController().getTexture():null,T=this.getRoomsWallSides(i,null),A=function(e){for(var t=[];e-- >0;)t.push(null);return t}(i.length),I=0;I<A.length;I++)A[I]=new e.ModifiedRoom(i[I]);var b=[],O=[],M=t.slice(0);this.splitSurroundingWalls&&this.splitWalls(T,b,O,M)&&(this.home.setSelectedItems(M),T=this.getRoomsWallSides(i,T));var D=function(e){for(var t=[];e-- >0;)t.push(null);return t}(T.length);for(I=0;I<D.length;I++)D[I]=new e.ModifiedWallSide(T[I]);e.doModifyRoomsAndWallSides(this.home,A,n,o,r,l,a,s,h,u,d,c,p,g,m,D,this.preferences.getNewWallBaseboardThickness(),this.preferences.getNewWallBaseboardHeight(),f,v,_,S,y,E,C,P,w,L,null,null),null!=this.undoSupport&&this.undoSupport.postEdit(new e.RoomsAndWallSidesModificationUndoableEdit(this.home,this.preferences,t.slice(0),M.slice(0),A,n,o,r,l,a,s,h,u,d,c,p,g,m,D,this.preferences.getNewWallBaseboardThickness(),this.preferences.getNewWallBaseboardHeight(),f,v,_,S,y,E,C,P,w,L,b.slice(0),O.slice(0))),null!=n&&this.preferences.addAutoCompletionString("RoomName",n)}},e.prototype.splitWalls=function(t,i,n,o){var r,l=null,a=[],s=function(){r=null;for(var n,s,u=null,d=null,c=null,p=0;p<t.length&&null==r;p++){var g=(I=t[p]).getWall(),m=g.getArcExtent();if(null==m||0===m)for(var f=new java.awt.geom.Area(h.getPath(g.getPoints$(),!0)),v=0;v<t.length;v++){var _=t[v].getWall();if(g!==_){var S=new java.awt.geom.Area(h.getPath(_.getPoints$(),!0));if(S.intersect(f),!S.isEmpty()&&S.isSingular()){var y=h.computeIntersection(g.getXStart(),g.getYStart(),g.getXEnd(),g.getYEnd(),_.getXStart(),_.getYStart(),_.getXEnd(),_.getYEnd());if(null!=y&&(u=g.duplicate(),d=g.duplicate(),u.setLevel(g.getLevel()),d.setLevel(g.getLevel()),u.setXEnd(y[0]),u.setYEnd(y[1]),d.setXStart(y[0]),d.setYStart(y[1]),u.getLength()>_.getThickness()/2&&d.getLength()>_.getThickness()/2)){if(null==i)return{value:!0};if(null==l){l={};for(var E=0;E<t.length;E++){var C=t[E];(function(e,t){null==e.entries&&(e.entries=[]);for(var i=0;i<e.entries.length;i++)if(null==e.entries[i].key&&null==t||null!=e.entries[i].key.equals&&e.entries[i].key.equals(t)||e.entries[i].key===t)return!0;return!1})(l,C.getWall())||function(e,t,i){null==e.entries&&(e.entries=[]);for(var n=0;n<e.entries.length;n++)if(null==e.entries[n].key&&null==t||null!=e.entries[n].key.equals&&e.entries[n].key.equals(t)||e.entries[n].key===t)return void(e.entries[n].value=i);e.entries.push({key:t,value:i,getKey:function(){return this.key},getValue:function(){return this.value}})}(l,C.getWall(),new e.ModifiedWall(C.getWall()))}}c=function(e,t){null==e.entries&&(e.entries=[]);for(var i=0;i<e.entries.length;i++)if(null==e.entries[i].key&&null==t||null!=e.entries[i].key.equals&&e.entries[i].key.equals(t)||e.entries[i].key===t)return e.entries[i].value;return null}(l,g);var P=g.getWallAtStart();null!=P&&(u.setWallAtStart(P),P.getWallAtEnd()===g?P.setWallAtEnd(u):P.setWallAtStart(u));var w=g.getWallAtEnd();if(null!=w&&(d.setWallAtEnd(w),w.getWallAtEnd()===g?w.setWallAtEnd(d):w.setWallAtStart(d)),u.setWallAtEnd(d),d.setWallAtStart(u),null!=g.getHeightAtEnd()){var L=g.getHeight()+(g.getHeightAtEnd()-g.getHeight())*java.awt.geom.Point2D.distance(g.getXStart(),g.getYStart(),y[0],y[1])/g.getLength();u.setHeightAtEnd(L),d.setHeight(L)}r=I;break}}}}}if(null!=r){a.push(u),a.push(d);var T=r.getWall();if(h.home.getWalls().indexOf(T)>=0)i.push(c);else for(p=a.length-1;p>=0;p--)if(a[p]===T){a.splice(p,1)[0];break}(s=(n=o).indexOf(T))>=0&&(n.splice(s,1),1)&&(o.push(u),o.push(d)),function(e){var t=e.indexOf(r);t>=0&&e.splice(t,1)}(t),t.push(new e.WallSide(u,r.getSide())),t.push(new e.WallSide(d,r.getSide()));var A=[];for(p=t.length-1;p>=0;p--){var I;(I=t[p]).getWall()===T&&(t.splice(p,1)[0],A.push(new e.WallSide(u,I.getSide())),A.push(new e.WallSide(d,I.getSide())))}!function(e,t){e.push.apply(e,t)}(t,A)}},h=this;do{var u=s();if("object"==typeof u)return u.value}while(null!=r);if(null==i)return!1;for(var d=0;d<a.length;d++){var c=a[d],p=new e.ModifiedWall(c);n.push(p),this.home.addWall(c),c.setLevel(p.getLevel())}for(d=0;d<i.length;d++){var g=i[d];this.home.deleteWall(g.getWall())}return!(0==i.length)},e.prototype.computeIntersection=function(e,t,i,n,o,r,l,a){var s=PlanController.computeIntersection$float$float$float$float$float$float$float$float(e,t,i,n,o,r,l,a);return java.awt.geom.Line2D.ptSegDistSq(e,t,i,n,s[0],s[1])<1e-7&&(Math.abs(e-s[0])>1e-4||Math.abs(t-s[1])>1e-4)&&(Math.abs(i-s[0])>1e-4||Math.abs(n-s[1])>1e-4)?s:null},e.doModifyRoomsAndWallSides=function(t,i,n,o,r,l,a,s,h,u,d,c,p,g,m,f,v,_,S,y,E,C,P,w,L,T,A,I,b,O){if(null!=b){for(var M=0;M<O.length;M++){var D=O[M];D.resetJoinedWalls(),t.addWall(D.getWall()),D.getWall().setLevel(D.getLevel())}for(M=0;M<b.length;M++){var R=b[M];t.deleteWall(R.getWall())}}for(M=0;M<i.length;M++){var F=i[M].getRoom();if(null!=n&&F.setName(n),null!=o&&F.setAreaVisible(o),null!=r&&F.setFloorVisible(r),null!=l)switch(l){case e.RoomPaint.DEFAULT:F.setFloorColor(null),F.setFloorTexture(null);break;case e.RoomPaint.COLORED:F.setFloorColor(a),F.setFloorTexture(null);break;case e.RoomPaint.TEXTURED:F.setFloorColor(null),F.setFloorTexture(s)}if(null!=h&&F.setFloorShininess(h),null!=u&&F.setCeilingVisible(u),null!=d)switch(d){case e.RoomPaint.DEFAULT:F.setCeilingColor(null),F.setCeilingTexture(null);break;case e.RoomPaint.COLORED:F.setCeilingColor(c),F.setCeilingTexture(null);break;case e.RoomPaint.TEXTURED:F.setCeilingColor(null),F.setCeilingTexture(p)}null!=g&&F.setCeilingShininess(g),null!=m&&F.setCeilingFlat(m)}for(M=0;M<f.length;M++){var x=f[M].getWallSide(),N=x.getWall();if(x.getSide()===e.WallSide.LEFT_SIDE){if(null!=S)switch(S){case e.RoomPaint.DEFAULT:N.setLeftSideColor(null),N.setLeftSideTexture(null);break;case e.RoomPaint.COLORED:N.setLeftSideColor(y),N.setLeftSideTexture(null);break;case e.RoomPaint.TEXTURED:N.setLeftSideColor(null),N.setLeftSideTexture(E)}null!=C&&N.setLeftSideShininess(C)}else{if(null!=S)switch(S){case e.RoomPaint.DEFAULT:N.setRightSideColor(null),N.setRightSideTexture(null);break;case e.RoomPaint.COLORED:N.setRightSideColor(y),N.setRightSideTexture(null);break;case e.RoomPaint.TEXTURED:N.setRightSideColor(null),N.setRightSideTexture(E)}null!=C&&N.setRightSideShininess(C)}if(!1===P)x.getSide()===e.WallSide.LEFT_SIDE?N.setLeftSideBaseboard(null):N.setRightSideBaseboard(null);else{var k=x.getSide()===e.WallSide.LEFT_SIDE?N.getLeftSideBaseboard():N.getRightSideBaseboard();if(!0===P||null!=k){var H=null!=k?k.getThickness():v,V=null!=k?k.getHeight():_,U=null!=k?k.getColor():null,W=null!=k?k.getTexture():null;if(null!=T)switch(T){case BaseboardChoiceController.BaseboardPaint.DEFAULT:U=null,W=null;break;case BaseboardChoiceController.BaseboardPaint.COLORED:null!=A&&(U=A),W=null;break;case BaseboardChoiceController.BaseboardPaint.TEXTURED:U=null,null!=I&&(W=I)}k=Baseboard.getInstance(null!=w?w:H,null!=L?L:V,U,W),x.getSide()===e.WallSide.LEFT_SIDE?N.setLeftSideBaseboard(k):N.setRightSideBaseboard(k)}}}},e.undoModifyRoomsAndWallSides=function(e,t,i,n,o){for(var r=0;r<t.length;r++){t[r].reset()}for(r=0;r<i.length;r++){i[r].reset()}for(r=0;r<o.length;r++){var l=o[r];e.deleteWall(l.getWall())}for(r=0;r<n.length;r++){var a=n[r];a.resetJoinedWalls(),e.addWall(a.getWall()),a.getWall().setLevel(a.getLevel())}},e}();RoomController.__class="com.eteks.sweethome3d.viewcontroller.RoomController",RoomController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"],function(e){var t;(t=e.RoomPaint||(e.RoomPaint={}))[t.DEFAULT=0]="DEFAULT",t[t.COLORED=1]="COLORED",t[t.TEXTURED=2]="TEXTURED";var i=function(t){function i(i,n,o,r,l,a,s,h,u,d,c,p,g,m,f,v,_,S,y,E,C,P,w,L,T,A,I,b,O,M,D,R,F){var x=t.call(this,n,e,"undoModifyRoomsName")||this;return void 0===x.home&&(x.home=null),void 0===x.oldSelection&&(x.oldSelection=null),void 0===x.newSelection&&(x.newSelection=null),void 0===x.modifiedRooms&&(x.modifiedRooms=null),void 0===x.name&&(x.name=null),void 0===x.areaVisible&&(x.areaVisible=null),void 0===x.floorVisible&&(x.floorVisible=null),void 0===x.floorPaint&&(x.floorPaint=null),void 0===x.floorColor&&(x.floorColor=null),void 0===x.floorTexture&&(x.floorTexture=null),void 0===x.floorShininess&&(x.floorShininess=null),void 0===x.ceilingVisible&&(x.ceilingVisible=null),void 0===x.ceilingPaint&&(x.ceilingPaint=null),void 0===x.ceilingColor&&(x.ceilingColor=null),void 0===x.ceilingTexture&&(x.ceilingTexture=null),void 0===x.ceilingShininess&&(x.ceilingShininess=null),void 0===x.ceilingFlat&&(x.ceilingFlat=null),void 0===x.modifiedWallSides&&(x.modifiedWallSides=null),void 0===x.newWallBaseboardHeight&&(x.newWallBaseboardHeight=0),void 0===x.newWallBaseboardThickness&&(x.newWallBaseboardThickness=0),void 0===x.wallSidesPaint&&(x.wallSidesPaint=null),void 0===x.wallSidesColor&&(x.wallSidesColor=null),void 0===x.wallSidesTexture&&(x.wallSidesTexture=null),void 0===x.wallSidesShininess&&(x.wallSidesShininess=null),void 0===x.wallSidesBaseboardVisible&&(x.wallSidesBaseboardVisible=null),void 0===x.wallSidesBaseboardThickness&&(x.wallSidesBaseboardThickness=null),void 0===x.wallSidesBaseboardHeight&&(x.wallSidesBaseboardHeight=null),void 0===x.wallSidesBaseboardPaint&&(x.wallSidesBaseboardPaint=null),void 0===x.wallSidesBaseboardColor&&(x.wallSidesBaseboardColor=null),void 0===x.wallSidesBaseboardTexture&&(x.wallSidesBaseboardTexture=null),void 0===x.deletedWalls&&(x.deletedWalls=null),void 0===x.addedWalls&&(x.addedWalls=null),x.home=i,x.oldSelection=o,x.newSelection=r,x.modifiedRooms=l,x.name=a,x.areaVisible=s,x.floorVisible=h,x.floorPaint=u,x.floorColor=d,x.floorTexture=c,x.floorShininess=p,x.ceilingVisible=g,x.ceilingPaint=m,x.ceilingColor=f,x.ceilingTexture=v,x.ceilingShininess=_,x.ceilingFlat=S,x.modifiedWallSides=y,x.newWallBaseboardThickness=E,x.newWallBaseboardHeight=C,x.wallSidesPaint=P,x.wallSidesColor=w,x.wallSidesTexture=L,x.wallSidesShininess=T,x.wallSidesBaseboardVisible=A,x.wallSidesBaseboardThickness=I,x.wallSidesBaseboardHeight=b,x.wallSidesBaseboardPaint=O,x.wallSidesBaseboardColor=M,x.wallSidesBaseboardTexture=D,x.deletedWalls=R,x.addedWalls=F,x}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),e.undoModifyRoomsAndWallSides(this.home,this.modifiedRooms,this.modifiedWallSides,this.deletedWalls,this.addedWalls),this.home.setSelectedItems(this.oldSelection.slice(0))},i.prototype.redo=function(){t.prototype.redo.call(this),e.doModifyRoomsAndWallSides(this.home,this.modifiedRooms,this.name,this.areaVisible,this.floorVisible,this.floorPaint,this.floorColor,this.floorTexture,this.floorShininess,this.ceilingVisible,this.ceilingPaint,this.ceilingColor,this.ceilingTexture,this.ceilingShininess,this.ceilingFlat,this.modifiedWallSides,this.newWallBaseboardThickness,this.newWallBaseboardHeight,this.wallSidesPaint,this.wallSidesColor,this.wallSidesTexture,this.wallSidesShininess,this.wallSidesBaseboardVisible,this.wallSidesBaseboardThickness,this.wallSidesBaseboardHeight,this.wallSidesBaseboardPaint,this.wallSidesBaseboardColor,this.wallSidesBaseboardTexture,this.deletedWalls,this.addedWalls),this.home.setSelectedItems(this.newSelection.slice(0))},i}(LocalizedUndoableEdit);e.RoomsAndWallSidesModificationUndoableEdit=i,i.__class="com.eteks.sweethome3d.viewcontroller.RoomController.RoomsAndWallSidesModificationUndoableEdit",i.__interfaces=["javax.swing.undo.UndoableEdit"];var n=function(){function e(e){void 0===this.room&&(this.room=null),void 0===this.name&&(this.name=null),void 0===this.areaVisible&&(this.areaVisible=!1),void 0===this.floorVisible&&(this.floorVisible=!1),void 0===this.floorColor&&(this.floorColor=null),void 0===this.floorTexture&&(this.floorTexture=null),void 0===this.floorShininess&&(this.floorShininess=0),void 0===this.ceilingVisible&&(this.ceilingVisible=!1),void 0===this.ceilingColor&&(this.ceilingColor=null),void 0===this.ceilingTexture&&(this.ceilingTexture=null),void 0===this.ceilingShininess&&(this.ceilingShininess=0),void 0===this.ceilingFlat&&(this.ceilingFlat=!1),this.room=e,this.name=e.getName(),this.areaVisible=e.isAreaVisible(),this.floorVisible=e.isFloorVisible(),this.floorColor=e.getFloorColor(),this.floorTexture=e.getFloorTexture(),this.floorShininess=e.getFloorShininess(),this.ceilingVisible=e.isCeilingVisible(),this.ceilingColor=e.getCeilingColor(),this.ceilingTexture=e.getCeilingTexture(),this.ceilingShininess=e.getCeilingShininess(),this.ceilingFlat=e.isCeilingFlat()}return e.prototype.getRoom=function(){return this.room},e.prototype.reset=function(){this.room.setName(this.name),this.room.setAreaVisible(this.areaVisible),this.room.setFloorVisible(this.floorVisible),this.room.setFloorColor(this.floorColor),this.room.setFloorTexture(this.floorTexture),this.room.setFloorShininess(this.floorShininess),this.room.setCeilingVisible(this.ceilingVisible),this.room.setCeilingColor(this.ceilingColor),this.room.setCeilingTexture(this.ceilingTexture),this.room.setCeilingShininess(this.ceilingShininess),this.room.setCeilingFlat(this.ceilingFlat)},e}();e.ModifiedRoom=n,n.__class="com.eteks.sweethome3d.viewcontroller.RoomController.ModifiedRoom";var o=function(){function e(e,t){void 0===this.wall&&(this.wall=null),void 0===this.side&&(this.side=0),void 0===this.wallAtStart&&(this.wallAtStart=null),void 0===this.wallAtEnd&&(this.wallAtEnd=null),void 0===this.joinedAtEndOfWallAtStart&&(this.joinedAtEndOfWallAtStart=!1),void 0===this.joinedAtStartOfWallAtEnd&&(this.joinedAtStartOfWallAtEnd=!1),this.wall=e,this.side=t,this.wallAtStart=e.getWallAtStart(),this.joinedAtEndOfWallAtStart=null!=this.wallAtStart&&this.wallAtStart.getWallAtEnd()===e,this.wallAtEnd=e.getWallAtEnd(),this.joinedAtStartOfWallAtEnd=null!=this.wallAtEnd&&this.wallAtEnd.getWallAtStart()===e}return e.prototype.getWall=function(){return this.wall},e.prototype.getSide=function(){return this.side},e.prototype.getWallAtStart=function(){return this.wallAtStart},e.prototype.getWallAtEnd=function(){return this.wallAtEnd},e.prototype.isJoinedAtEndOfWallAtStart=function(){return this.joinedAtEndOfWallAtStart},e.prototype.isJoinedAtStartOfWallAtEnd=function(){return this.joinedAtStartOfWallAtEnd},e.LEFT_SIDE=0,e.RIGHT_SIDE=1,e}();e.WallSide=o,o.__class="com.eteks.sweethome3d.viewcontroller.RoomController.WallSide";var r=function(){function e(e){void 0===this.wall&&(this.wall=null),void 0===this.level&&(this.level=null),void 0===this.wallAtStart&&(this.wallAtStart=null),void 0===this.wallAtEnd&&(this.wallAtEnd=null),void 0===this.joinedAtEndOfWallAtStart&&(this.joinedAtEndOfWallAtStart=!1),void 0===this.joinedAtStartOfWallAtEnd&&(this.joinedAtStartOfWallAtEnd=!1),this.wall=e,this.level=e.getLevel(),this.wallAtStart=e.getWallAtStart(),this.joinedAtEndOfWallAtStart=null!=this.wallAtStart&&this.wallAtStart.getWallAtEnd()===e,this.wallAtEnd=e.getWallAtEnd(),this.joinedAtStartOfWallAtEnd=null!=this.wallAtEnd&&this.wallAtEnd.getWallAtStart()===e}return e.prototype.getWall=function(){return this.wall},e.prototype.getLevel=function(){return this.level},e.prototype.resetJoinedWalls=function(){null!=this.wallAtStart&&(this.wall.setWallAtStart(this.wallAtStart),this.joinedAtEndOfWallAtStart?this.wallAtStart.setWallAtEnd(this.wall):this.wallAtStart.setWallAtStart(this.wall)),null!=this.wallAtEnd&&(this.wall.setWallAtEnd(this.wallAtEnd),this.joinedAtStartOfWallAtEnd?this.wallAtEnd.setWallAtStart(this.wall):this.wallAtEnd.setWallAtEnd(this.wall))},e}();e.ModifiedWall=r,r.__class="com.eteks.sweethome3d.viewcontroller.RoomController.ModifiedWall";var l=function(){function t(t){void 0===this.wallSide&&(this.wallSide=null),void 0===this.wallColor&&(this.wallColor=null),void 0===this.wallTexture&&(this.wallTexture=null),void 0===this.wallShininess&&(this.wallShininess=null),void 0===this.wallBaseboard&&(this.wallBaseboard=null),this.wallSide=t;var i=t.getWall();t.getSide()===e.WallSide.LEFT_SIDE?(this.wallColor=i.getLeftSideColor(),this.wallTexture=i.getLeftSideTexture(),this.wallShininess=i.getLeftSideShininess(),this.wallBaseboard=i.getLeftSideBaseboard()):(this.wallColor=i.getRightSideColor(),this.wallTexture=i.getRightSideTexture(),this.wallShininess=i.getRightSideShininess(),this.wallBaseboard=i.getRightSideBaseboard())}return t.prototype.getWallSide=function(){return this.wallSide},t.prototype.reset=function(){var t=this.wallSide.getWall();this.wallSide.getSide()===e.WallSide.LEFT_SIDE?(t.setLeftSideColor(this.wallColor),t.setLeftSideTexture(this.wallTexture),t.setLeftSideShininess(this.wallShininess),t.setLeftSideBaseboard(this.wallBaseboard)):(t.setRightSideColor(this.wallColor),t.setRightSideTexture(this.wallTexture),t.setRightSideShininess(this.wallShininess),t.setRightSideBaseboard(this.wallBaseboard));var i=this.wallSide.getWallAtStart();null!=i&&(t.setWallAtStart(i),this.wallSide.isJoinedAtEndOfWallAtStart()?i.setWallAtEnd(t):i.setWallAtStart(t));var n=this.wallSide.getWallAtEnd();null!=n&&(t.setWallAtEnd(n),this.wallSide.isJoinedAtStartOfWallAtEnd()?n.setWallAtStart(t):n.setWallAtEnd(t))},t}();e.ModifiedWallSide=l,l.__class="com.eteks.sweethome3d.viewcontroller.RoomController.ModifiedWallSide";var a=function(){function t(e){this.__parent=e}return t.prototype.propertyChange=function(t){this.__parent.setFloorPaint(e.RoomPaint.TEXTURED)},t}();e.RoomController$0=a;var s=function(){function t(e){this.__parent=e}return t.prototype.propertyChange=function(t){this.__parent.setCeilingPaint(e.RoomPaint.TEXTURED)},t}();e.RoomController$1=s;var h=function(){function t(e){this.__parent=e}return t.prototype.propertyChange=function(t){this.__parent.setWallSidesPaint(e.RoomPaint.TEXTURED)},t}();e.RoomController$2=h}(RoomController||(RoomController={}));var CompassController=function(){function e(e,t,i,n){void 0===this.home&&(this.home=null),void 0===this.preferences&&(this.preferences=null),void 0===this.viewFactory&&(this.viewFactory=null),void 0===this.undoSupport&&(this.undoSupport=null),void 0===this.propertyChangeSupport&&(this.propertyChangeSupport=null),void 0===this.compassView&&(this.compassView=null),void 0===this.x&&(this.x=0),void 0===this.y&&(this.y=0),void 0===this.diameter&&(this.diameter=0),void 0===this.visible&&(this.visible=!1),void 0===this.northDirectionInDegrees&&(this.northDirectionInDegrees=0),void 0===this.latitudeInDegrees&&(this.latitudeInDegrees=0),void 0===this.longitudeInDegrees&&(this.longitudeInDegrees=0),void 0===this.timeZone&&(this.timeZone=null),this.home=e,this.preferences=t,this.viewFactory=i,this.undoSupport=n,this.propertyChangeSupport=new PropertyChangeSupport(this),this.updateProperties()}return e.prototype.getView=function(){return null==this.compassView&&(this.compassView=this.viewFactory.createCompassView(this.preferences,this)),this.compassView},e.prototype.displayView=function(e){this.getView().displayView(e)},e.prototype.addPropertyChangeListener=function(e,t){this.propertyChangeSupport.addPropertyChangeListener(e,t)},e.prototype.removePropertyChangeListener=function(e,t){this.propertyChangeSupport.removePropertyChangeListener(e,t)},e.prototype.updateProperties=function(){var e=this.home.getCompass();this.setX(e.getX()),this.setY(e.getY()),this.setDiameter(e.getDiameter()),this.setVisible(e.isVisible()),this.setNorthDirectionInDegrees(180*e.getNorthDirection()/Math.PI),this.setLatitudeInDegrees(function(e){return 180*e/Math.PI}(e.getLatitude())),this.setLongitudeInDegrees(function(e){return 180*e/Math.PI}(e.getLongitude())),this.setTimeZone(e.getTimeZone())},e.prototype.getX=function(){return this.x},e.prototype.setX=function(e){if(e!==this.x){var t=this.x;this.x=e,this.propertyChangeSupport.firePropertyChange("X",t,e)}},e.prototype.getY=function(){return this.y},e.prototype.setY=function(e){if(e!==this.y){var t=this.y;this.y=e,this.propertyChangeSupport.firePropertyChange("Y",t,e)}},e.prototype.getDiameter=function(){return this.diameter},e.prototype.setDiameter=function(e){if(e!==this.diameter){var t=this.diameter;this.diameter=e,this.propertyChangeSupport.firePropertyChange("DIAMETER",t,e)}},e.prototype.isVisible=function(){return this.visible},e.prototype.setVisible=function(e){e!==this.visible&&(this.visible=e,this.propertyChangeSupport.firePropertyChange("VISIBLE",!e,e))},e.prototype.getNorthDirectionInDegrees=function(){return this.northDirectionInDegrees},e.prototype.setNorthDirectionInDegrees=function(e){if(e!==this.northDirectionInDegrees){var t=this.northDirectionInDegrees;this.northDirectionInDegrees=e,this.propertyChangeSupport.firePropertyChange("NORTH_DIRECTION_IN_DEGREES",t,e)}},e.prototype.getLatitudeInDegrees=function(){return this.latitudeInDegrees},e.prototype.setLatitudeInDegrees=function(e){if(e!==this.latitudeInDegrees){var t=this.latitudeInDegrees;this.latitudeInDegrees=e,this.propertyChangeSupport.firePropertyChange("LATITUDE_IN_DEGREES",t,e)}},e.prototype.getLongitudeInDegrees=function(){return this.longitudeInDegrees},e.prototype.setLongitudeInDegrees=function(e){if(e!==this.longitudeInDegrees){var t=this.longitudeInDegrees;this.longitudeInDegrees=e,this.propertyChangeSupport.firePropertyChange("LONGITUDE_IN_DEGREES",t,e)}},e.prototype.getTimeZone=function(){return this.timeZone},e.prototype.setTimeZone=function(e){if(e!==this.timeZone){var t=this.timeZone;this.timeZone=e,this.propertyChangeSupport.firePropertyChange("TIME_ZONE",t,e)}},e.prototype.modifyCompass=function(){var t=this.getX(),i=this.getY(),n=this.getDiameter(),o=this.isVisible(),r=this.getNorthDirectionInDegrees()*Math.PI/180,l=function(e){return e*Math.PI/180}(this.getLatitudeInDegrees()),a=function(e){return e*Math.PI/180}(this.getLongitudeInDegrees()),s=this.getTimeZone(),h=new e.CompassUndoableEdit(this.home.getCompass(),this.preferences,t,i,n,o,r,l,a,s);e.doModifyCompass(this.home.getCompass(),t,i,n,o,r,l,a,s),this.undoSupport.postEdit(h)},e.doModifyCompass=function(e,t,i,n,o,r,l,a,s){e.setX(t),e.setY(i),e.setDiameter(n),e.setVisible(o),e.setNorthDirection(r),e.setLatitude(l),e.setLongitude(a),e.setTimeZone(s)},e}();CompassController.__class="com.eteks.sweethome3d.viewcontroller.CompassController",CompassController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"],function(e){var t=function(t){function i(i,n,o,r,l,a,s,h,u,d){var c=t.call(this,n,e,"undoModifyCompassName")||this;return void 0===c.compass&&(c.compass=null),void 0===c.oldX&&(c.oldX=0),void 0===c.oldY&&(c.oldY=0),void 0===c.oldDiameter&&(c.oldDiameter=0),void 0===c.oldNorthDirection&&(c.oldNorthDirection=0),void 0===c.oldLatitude&&(c.oldLatitude=0),void 0===c.oldLongitude&&(c.oldLongitude=0),void 0===c.oldTimeZone&&(c.oldTimeZone=null),void 0===c.oldVisible&&(c.oldVisible=!1),void 0===c.newX&&(c.newX=0),void 0===c.newY&&(c.newY=0),void 0===c.newDiameter&&(c.newDiameter=0),void 0===c.newNorthDirection&&(c.newNorthDirection=0),void 0===c.newLatitude&&(c.newLatitude=0),void 0===c.newLongitude&&(c.newLongitude=0),void 0===c.newTimeZone&&(c.newTimeZone=null),void 0===c.newVisible&&(c.newVisible=!1),c.compass=i,c.oldX=i.getX(),c.oldY=i.getY(),c.oldDiameter=i.getDiameter(),c.oldVisible=i.isVisible(),c.oldNorthDirection=i.getNorthDirection(),c.oldLatitude=i.getLatitude(),c.oldLongitude=i.getLongitude(),c.oldTimeZone=i.getTimeZone(),c.newX=o,c.newY=r,c.newDiameter=l,c.newVisible=a,c.newNorthDirection=s,c.newLatitude=h,c.newLongitude=u,c.newTimeZone=d,c}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),e.doModifyCompass(this.compass,this.oldX,this.oldY,this.oldDiameter,this.oldVisible,this.oldNorthDirection,this.oldLatitude,this.oldLongitude,this.oldTimeZone)},i.prototype.redo=function(){t.prototype.redo.call(this),e.doModifyCompass(this.compass,this.newX,this.newY,this.newDiameter,this.newVisible,this.newNorthDirection,this.newLatitude,this.newLongitude,this.newTimeZone)},i}(LocalizedUndoableEdit);e.CompassUndoableEdit=t,t.__class="com.eteks.sweethome3d.viewcontroller.CompassController.CompassUndoableEdit",t.__interfaces=["javax.swing.undo.UndoableEdit"]}(CompassController||(CompassController={}));var PolylineController=function(){function e(e,t,i,n,o){void 0===this.home&&(this.home=null),void 0===this.preferences&&(this.preferences=null),void 0===this.viewFactory&&(this.viewFactory=null),void 0===this.undoSupport&&(this.undoSupport=null),void 0===this.propertyChangeSupport&&(this.propertyChangeSupport=null),void 0===this.polylineView&&(this.polylineView=null),void 0===this.thickness&&(this.thickness=null),void 0===this.capStyleEditable&&(this.capStyleEditable=!1),void 0===this.capStyle&&(this.capStyle=null),void 0===this.joinStyle&&(this.joinStyle=null),void 0===this.joinStyleEditable&&(this.joinStyleEditable=!1),void 0===this.dashStyle&&(this.dashStyle=null),void 0===this.dashPattern&&(this.dashPattern=null),void 0===this.dashOffset&&(this.dashOffset=null),void 0===this.arrowsStyleEditable&&(this.arrowsStyleEditable=!1),void 0===this.startArrowStyle&&(this.startArrowStyle=null),void 0===this.endArrowStyle&&(this.endArrowStyle=null),void 0===this.color&&(this.color=null),void 0===this.elevation&&(this.elevation=null),void 0===this.elevationEnabled&&(this.elevationEnabled=null),this.home=e,this.preferences=t,this.viewFactory=i,this.undoSupport=o,this.propertyChangeSupport=new PropertyChangeSupport(this),this.updateProperties()}return e.prototype.getView=function(){return null==this.polylineView&&(this.polylineView=this.viewFactory.createPolylineView(this.preferences,this)),this.polylineView},e.prototype.displayView=function(e){this.getView().displayView(e)},e.prototype.addPropertyChangeListener=function(e,t){this.propertyChangeSupport.addPropertyChangeListener(e,t)},e.prototype.removePropertyChangeListener=function(e,t){this.propertyChangeSupport.removePropertyChangeListener(e,t)},e.prototype.updateProperties=function(){var e=Home.getPolylinesSubList(this.home.getSelectedItems());if(0==e.length)this.setThickness(null),this.capStyleEditable=!1,this.setCapStyle(null),this.joinStyleEditable=!1,this.setJoinStyle(null),this.setDashStyle(null),this.dashPattern=null,this.setDashOffset(null),this.arrowsStyleEditable=!1,this.setStartArrowStyle(null),this.setEndArrowStyle(null),this.setColor(null),this.elevationEnabled=!1;else{for(var t=e[0],i=t.getThickness(),n=1;n<e.length;n++)if(i!==e[n].getThickness()){i=null;break}this.setThickness(i),this.capStyleEditable=!1;for(n=0;n<e.length;n++)if(!e[n].isClosedPath()){this.capStyleEditable=!0;break}if(this.capStyleEditable){var o=t.getCapStyle();if(null!=o)for(n=1;n<e.length;n++)if(o!==e[n].getCapStyle()){o=null;break}this.setCapStyle(o)}else this.setCapStyle(null);this.joinStyleEditable=!1;for(n=0;n<e.length;n++)if(e[n].getPointCount()>2){this.joinStyleEditable=!0;break}if(this.joinStyleEditable){var r=t.getJoinStyle();if(null!=r)for(n=1;n<e.length;n++)if(r!==e[n].getJoinStyle()){r=null;break}this.setJoinStyle(r)}else this.setJoinStyle(null);var l=t.getDashPattern();if(null!=l)for(n=1;n<e.length;n++)if(!function(e,t){if(null==e&&null==t)return!0;if(null==e||null==t)return!1;if(e.length!=t.length)return!1;for(var i=0;i<e.length;i++)if(e[i]!=t[i])return!1;return!0}(l,e[n].getDashPattern())){l=null;break}if(this.setDashPattern(l),null!=l){var a=t.getDashStyle();if(null!=a)for(n=1;n<e.length;n++)if(a!==e[n].getDashStyle()){a=null;break}Polyline.DashStyle.CUSTOMIZED,this.setDashStyle(a)}else this.setDashStyle(null);var s=t.getDashOffset();for(n=1;n<e.length;n++)if(s!==e[n].getDashOffset()){s=null;break}if(this.setDashOffset(s),this.arrowsStyleEditable=this.capStyleEditable,this.arrowsStyleEditable){var h=t.getStartArrowStyle();if(null!=h)for(n=1;n<e.length;n++)if(h!==e[n].getStartArrowStyle()){h=null;break}this.setStartArrowStyle(h);var u=t.getEndArrowStyle();if(null!=u)for(n=1;n<e.length;n++)if(u!==e[n].getEndArrowStyle()){u=null;break}this.setEndArrowStyle(u)}else this.setStartArrowStyle(null),this.setEndArrowStyle(null);var d=t.getColor();if(null!=d)for(n=1;n<e.length;n++)if(d!==e[n].getColor()){d=null;break}this.setColor(d);var c=t.getElevation();for(n=1;n<e.length;n++)if(c!==e[n].getElevation()){c=null;break}this.setElevation(c);var p=t.isVisibleIn3D();for(n=1;n<e.length;n++)if(p!==e[n].isVisibleIn3D()){p=null;break}this.elevationEnabled=p}},e.prototype.setThickness=function(e){if(e!==this.thickness){var t=this.thickness;this.thickness=e,this.propertyChangeSupport.firePropertyChange("THICKNESS",t,e)}},e.prototype.getThickness=function(){return this.thickness},e.prototype.setCapStyle=function(e){if(e!==this.capStyle){var t=this.capStyle;this.capStyle=e,this.propertyChangeSupport.firePropertyChange("CAP_STYLE",t,e)}},e.prototype.getCapStyle=function(){return this.capStyle},e.prototype.isCapStyleEditable=function(){return this.capStyleEditable},e.prototype.setJoinStyle=function(e){if(e!==this.joinStyle){var t=this.joinStyle;this.joinStyle=e,this.propertyChangeSupport.firePropertyChange("JOIN_STYLE",t,e)}},e.prototype.getJoinStyle=function(){return this.joinStyle},e.prototype.isJoinStyleEditable=function(){return this.joinStyleEditable},e.prototype.setDashStyle=function(e){if(e!==this.dashStyle){var t=this.dashStyle;this.dashStyle=e,this.propertyChangeSupport.firePropertyChange("DASH_STYLE",t,e)}},e.prototype.getDashStyle=function(){return this.dashStyle},e.prototype.setDashPattern=function(e){if(!function(e,t){if(null==e&&null==t)return!0;if(null==e||null==t)return!1;if(e.length!=t.length)return!1;for(var i=0;i<e.length;i++)if(e[i]!=t[i])return!1;return!0}(e,this.dashPattern)){var t=this.dashPattern;this.dashPattern=e,this.propertyChangeSupport.firePropertyChange("DASH_PATTERN",t,e)}},e.prototype.getDashPattern=function(){return this.dashPattern},e.prototype.setDashOffset=function(e){if(e!==this.dashOffset){var t=this.dashOffset;this.dashOffset=e,this.propertyChangeSupport.firePropertyChange("DASH_OFFSET",t,e)}},e.prototype.getDashOffset=function(){return this.dashOffset},e.prototype.setStartArrowStyle=function(e){if(e!==this.startArrowStyle){var t=this.startArrowStyle;this.startArrowStyle=e,this.propertyChangeSupport.firePropertyChange("START_ARROW_STYLE",t,e)}},e.prototype.getStartArrowStyle=function(){return this.startArrowStyle},e.prototype.setEndArrowStyle=function(e){if(e!==this.endArrowStyle){var t=this.endArrowStyle;this.endArrowStyle=e,this.propertyChangeSupport.firePropertyChange("END_ARROW_STYLE",t,e)}},e.prototype.getEndArrowStyle=function(){return this.endArrowStyle},e.prototype.isArrowsStyleEditable=function(){return this.arrowsStyleEditable},e.prototype.setColor=function(e){if(e!==this.color){var t=this.color;this.color=e,this.propertyChangeSupport.firePropertyChange("COLOR",t,e)}},e.prototype.getColor=function(){return this.color},e.prototype.setElevation=function(e){if(e!==this.elevation){var t=this.elevation;this.elevation=e,this.propertyChangeSupport.firePropertyChange("ELEVATION",t,e)}this.elevationEnabled=null!=e},e.prototype.getElevation=function(){return this.elevation},e.prototype.isElevationEnabled=function(){return this.elevationEnabled},e.prototype.modifyPolylines=function(){var t=this.home.getSelectedItems(),i=Home.getPolylinesSubList(t);if(0!=i.length){for(var n=this.getThickness(),o=this.getCapStyle(),r=this.getJoinStyle(),l=this.getDashStyle(),a=this.getDashPattern(),s=this.getDashOffset(),h=this.getStartArrowStyle(),u=this.getEndArrowStyle(),d=this.getColor(),c=this.getElevation(),p=this.isElevationEnabled(),g=function(e){for(var t=[];e-- >0;)t.push(null);return t}(i.length),m=0;m<g.length;m++)g[m]=new e.ModifiedPolyline(i[m]);if(e.doModifyPolylines(g,n,o,r,l,a,s,h,u,d,c,p),null!=this.undoSupport){var f=new e.PolylinesModificationUndoableEdit(this.home,this.preferences,t.slice(0),g,n,o,r,l,a,s,h,u,d,c,p);this.undoSupport.postEdit(f)}}},e.doModifyPolylines=function(e,t,i,n,o,r,l,a,s,h,u,d){for(var c=0;c<e.length;c++){var p=e[c].getPolyline();null!=t&&p.setThickness(t),null!=i&&p.setCapStyle(i),null!=n&&p.setJoinStyle(n),null!=o&&p.setDashStyle(o),o===Polyline.DashStyle.CUSTOMIZED&&null!=r&&p.setDashPattern(r),null!=l&&p.setDashOffset(p.getDashStyle()!==Polyline.DashStyle.SOLID?l:0),null!=a&&p.setStartArrowStyle(a),null!=s&&p.setEndArrowStyle(s),null!=h&&p.setColor(h),null!=d&&(!1===d?p.setVisibleIn3D(!1):null!=u&&(p.setVisibleIn3D(!0),p.setElevation(u)))}},e.undoModifyPolylines=function(e){for(var t=0;t<e.length;t++){e[t].reset()}},e}();PolylineController.__class="com.eteks.sweethome3d.viewcontroller.PolylineController",PolylineController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"],function(e){var t=function(t){function i(i,n,o,r,l,a,s,h,u,d,c,p,g,m,f){var v=t.call(this,n,e,"undoModifyPolylinesName")||this;return void 0===v.home&&(v.home=null),void 0===v.oldSelection&&(v.oldSelection=null),void 0===v.modifiedPolylines&&(v.modifiedPolylines=null),void 0===v.thickness&&(v.thickness=null),void 0===v.capStyle&&(v.capStyle=null),void 0===v.joinStyle&&(v.joinStyle=null),void 0===v.dashStyle&&(v.dashStyle=null),void 0===v.dashPattern&&(v.dashPattern=null),void 0===v.dashOffset&&(v.dashOffset=null),void 0===v.startArrowStyle&&(v.startArrowStyle=null),void 0===v.endArrowStyle&&(v.endArrowStyle=null),void 0===v.color&&(v.color=null),void 0===v.elevation&&(v.elevation=null),void 0===v.elevationEnabled&&(v.elevationEnabled=null),v.home=i,v.oldSelection=o,v.modifiedPolylines=r,v.thickness=l,v.capStyle=a,v.joinStyle=s,v.dashStyle=h,v.dashPattern=u,v.dashOffset=d,v.startArrowStyle=c,v.endArrowStyle=p,v.color=g,v.elevation=m,v.elevationEnabled=f,v}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),e.undoModifyPolylines(this.modifiedPolylines),this.home.setSelectedItems(this.oldSelection.slice(0))},i.prototype.redo=function(){t.prototype.redo.call(this),e.doModifyPolylines(this.modifiedPolylines,this.thickness,this.capStyle,this.joinStyle,this.dashStyle,this.dashPattern,this.dashOffset,this.startArrowStyle,this.endArrowStyle,this.color,this.elevation,this.elevationEnabled),this.home.setSelectedItems(this.oldSelection.slice(0))},i}(LocalizedUndoableEdit);e.PolylinesModificationUndoableEdit=t,t.__class="com.eteks.sweethome3d.viewcontroller.PolylineController.PolylinesModificationUndoableEdit",t.__interfaces=["javax.swing.undo.UndoableEdit"];var i=function(){function e(e){void 0===this.polyline&&(this.polyline=null),void 0===this.thickness&&(this.thickness=0),void 0===this.capStyle&&(this.capStyle=null),void 0===this.joinStyle&&(this.joinStyle=null),void 0===this.dashPattern&&(this.dashPattern=null),void 0===this.dashOffset&&(this.dashOffset=null),void 0===this.startArrowStyle&&(this.startArrowStyle=null),void 0===this.endArrowStyle&&(this.endArrowStyle=null),void 0===this.color&&(this.color=0),void 0===this.visibleIn3D&&(this.visibleIn3D=!1),void 0===this.elevation&&(this.elevation=0),this.polyline=e,this.thickness=e.getThickness(),this.capStyle=e.getCapStyle(),this.joinStyle=e.getJoinStyle(),this.dashPattern=e.getDashPattern(),this.dashOffset=e.getDashOffset(),this.startArrowStyle=e.getStartArrowStyle(),this.endArrowStyle=e.getEndArrowStyle(),this.color=e.getColor(),this.visibleIn3D=e.isVisibleIn3D(),this.elevation=e.getElevation()}return e.prototype.getPolyline=function(){return this.polyline},e.prototype.reset=function(){this.polyline.setThickness(this.thickness),this.polyline.setCapStyle(this.capStyle),this.polyline.setJoinStyle(this.joinStyle),this.polyline.setDashPattern(this.dashPattern),this.polyline.setDashOffset(this.dashOffset),this.polyline.setStartArrowStyle(this.startArrowStyle),this.polyline.setEndArrowStyle(this.endArrowStyle),this.polyline.setColor(this.color),this.polyline.setVisibleIn3D(this.visibleIn3D),this.polyline.setElevation(this.elevation)},e}();e.ModifiedPolyline=i,i.__class="com.eteks.sweethome3d.viewcontroller.PolylineController.ModifiedPolyline"}(PolylineController||(PolylineController={}));var HomeFurnitureController=function(){function e(e,t,i,n,o){if((null!=e&&e instanceof Home||null===e)&&(null!=t&&t instanceof UserPreferences||null===t)&&(null!=i&&null!=i.constructor&&null!=i.constructor.__interfaces&&i.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0||null===i)&&(null!=n&&null!=n.constructor&&null!=n.constructor.__interfaces&&n.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ContentManager")>=0||null===n)&&(null!=o&&o instanceof javax.swing.undo.UndoableEditSupport||null===o)){void 0===this.home&&(this.home=null),void 0===this.preferences&&(this.preferences=null),void 0===this.viewFactory&&(this.viewFactory=null),void 0===this.contentManager&&(this.contentManager=null),void 0===this.undoSupport&&(this.undoSupport=null),void 0===this.propertyChangeSupport&&(this.propertyChangeSupport=null),void 0===this.textureController&&(this.textureController=null),void 0===this.modelMaterialsController&&(this.modelMaterialsController=null),void 0===this.homeFurnitureView&&(this.homeFurnitureView=null),void 0===this.icon&&(this.icon=null),void 0===this.name&&(this.name=null),void 0===this.description&&(this.description=null),void 0===this.additionalProperties&&(this.additionalProperties=null),void 0===this.priceEditable&&(this.priceEditable=!1),void 0===this.price&&(this.price=null),void 0===this.valueAddedTaxPercentageEditable&&(this.valueAddedTaxPercentageEditable=!1),void 0===this.valueAddedTaxPercentage&&(this.valueAddedTaxPercentage=null),void 0===this.nameVisible&&(this.nameVisible=null),void 0===this.x&&(this.x=null),void 0===this.y&&(this.y=null),void 0===this.elevation&&(this.elevation=null),void 0===this.angleInDegrees&&(this.angleInDegrees=null),void 0===this.angle&&(this.angle=null),void 0===this.rollAndPitchEditable&&(this.rollAndPitchEditable=!1),void 0===this.roll&&(this.roll=null),void 0===this.pitch&&(this.pitch=null),void 0===this.horizontalAxis&&(this.horizontalAxis=null),void 0===this.width&&(this.width=null),void 0===this.proportionalWidth&&(this.proportionalWidth=null),void 0===this.depth&&(this.depth=null),void 0===this.proportionalDepth&&(this.proportionalDepth=null),void 0===this.height&&(this.height=null),void 0===this.proportionalHeight&&(this.proportionalHeight=null),void 0===this.proportional&&(this.proportional=!1),void 0===this.modelTransformations&&(this.modelTransformations=null),void 0===this.modelPresetTransformationsNames&&(this.modelPresetTransformationsNames=null),void 0===this.modelPresetTransformations&&(this.modelPresetTransformations=null),void 0===this.color&&(this.color=null),void 0===this.paint&&(this.paint=null),void 0===this.shininess&&(this.shininess=null),void 0===this.visible&&(this.visible=null),void 0===this.modelMirrored&&(this.modelMirrored=null),void 0===this.basePlanItem&&(this.basePlanItem=null),void 0===this.basePlanItemEnabled&&(this.basePlanItemEnabled=!1),void 0===this.lightPowerEditable&&(this.lightPowerEditable=!1),void 0===this.lightPower&&(this.lightPower=null),void 0===this.resizable&&(this.resizable=!1),void 0===this.deformable&&(this.deformable=!1),void 0===this.widthDepthDeformable&&(this.widthDepthDeformable=!1),void 0===this.texturable&&(this.texturable=!1),void 0===this.visibleEditable&&(this.visibleEditable=!1),void 0===this.doorOrWindow&&(this.doorOrWindow=!1),void 0===this.wallThickness&&(this.wallThickness=0),void 0===this.wallDistance&&(this.wallDistance=0),void 0===this.wallWidth&&(this.wallWidth=0),void 0===this.wallLeft&&(this.wallLeft=0),void 0===this.wallHeight&&(this.wallHeight=0),void 0===this.wallTop&&(this.wallTop=0),void 0===this.sashes&&(this.sashes=null),this.home=e,this.preferences=t,this.viewFactory=i,this.contentManager=n,this.undoSupport=o,this.propertyChangeSupport=new PropertyChangeSupport(this),this.updateProperties()}else{if(!((null!=e&&e instanceof Home||null===e)&&(null!=t&&t instanceof UserPreferences||null===t)&&(null!=i&&null!=i.constructor&&null!=i.constructor.__interfaces&&i.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0||null===i)&&(null!=n&&n instanceof javax.swing.undo.UndoableEditSupport||null===n)&&void 0===o))throw new Error("invalid overload");var r=arguments[3];void 0===this.home&&(this.home=null),void 0===this.preferences&&(this.preferences=null),void 0===this.viewFactory&&(this.viewFactory=null),void 0===this.contentManager&&(this.contentManager=null),void 0===this.undoSupport&&(this.undoSupport=null),void 0===this.propertyChangeSupport&&(this.propertyChangeSupport=null),void 0===this.textureController&&(this.textureController=null),void 0===this.modelMaterialsController&&(this.modelMaterialsController=null),void 0===this.homeFurnitureView&&(this.homeFurnitureView=null),void 0===this.icon&&(this.icon=null),void 0===this.name&&(this.name=null),void 0===this.description&&(this.description=null),void 0===this.additionalProperties&&(this.additionalProperties=null),void 0===this.priceEditable&&(this.priceEditable=!1),void 0===this.price&&(this.price=null),void 0===this.valueAddedTaxPercentageEditable&&(this.valueAddedTaxPercentageEditable=!1),void 0===this.valueAddedTaxPercentage&&(this.valueAddedTaxPercentage=null),void 0===this.nameVisible&&(this.nameVisible=null),void 0===this.x&&(this.x=null),void 0===this.y&&(this.y=null),void 0===this.elevation&&(this.elevation=null),void 0===this.angleInDegrees&&(this.angleInDegrees=null),void 0===this.angle&&(this.angle=null),void 0===this.rollAndPitchEditable&&(this.rollAndPitchEditable=!1),void 0===this.roll&&(this.roll=null),void 0===this.pitch&&(this.pitch=null),void 0===this.horizontalAxis&&(this.horizontalAxis=null),void 0===this.width&&(this.width=null),void 0===this.proportionalWidth&&(this.proportionalWidth=null),void 0===this.depth&&(this.depth=null),void 0===this.proportionalDepth&&(this.proportionalDepth=null),void 0===this.height&&(this.height=null),void 0===this.proportionalHeight&&(this.proportionalHeight=null),void 0===this.proportional&&(this.proportional=!1),void 0===this.modelTransformations&&(this.modelTransformations=null),void 0===this.modelPresetTransformationsNames&&(this.modelPresetTransformationsNames=null),void 0===this.modelPresetTransformations&&(this.modelPresetTransformations=null),void 0===this.color&&(this.color=null),void 0===this.paint&&(this.paint=null),void 0===this.shininess&&(this.shininess=null),void 0===this.visible&&(this.visible=null),void 0===this.modelMirrored&&(this.modelMirrored=null),void 0===this.basePlanItem&&(this.basePlanItem=null),void 0===this.basePlanItemEnabled&&(this.basePlanItemEnabled=!1),void 0===this.lightPowerEditable&&(this.lightPowerEditable=!1),void 0===this.lightPower&&(this.lightPower=null),void 0===this.resizable&&(this.resizable=!1),void 0===this.deformable&&(this.deformable=!1),void 0===this.widthDepthDeformable&&(this.widthDepthDeformable=!1),void 0===this.texturable&&(this.texturable=!1),void 0===this.visibleEditable&&(this.visibleEditable=!1),void 0===this.doorOrWindow&&(this.doorOrWindow=!1),void 0===this.wallThickness&&(this.wallThickness=0),void 0===this.wallDistance&&(this.wallDistance=0),void 0===this.wallWidth&&(this.wallWidth=0),void 0===this.wallLeft&&(this.wallLeft=0),void 0===this.wallHeight&&(this.wallHeight=0),void 0===this.wallTop&&(this.wallTop=0),void 0===this.sashes&&(this.sashes=null),this.home=e,this.preferences=t,this.viewFactory=i,this.contentManager=null,this.undoSupport=r,this.propertyChangeSupport=new PropertyChangeSupport(this),this.updateProperties(),void 0===this.home&&(this.home=null),void 0===this.preferences&&(this.preferences=null),void 0===this.viewFactory&&(this.viewFactory=null),void 0===this.contentManager&&(this.contentManager=null),void 0===this.undoSupport&&(this.undoSupport=null),void 0===this.propertyChangeSupport&&(this.propertyChangeSupport=null),void 0===this.textureController&&(this.textureController=null),void 0===this.modelMaterialsController&&(this.modelMaterialsController=null),void 0===this.homeFurnitureView&&(this.homeFurnitureView=null),void 0===this.icon&&(this.icon=null),void 0===this.name&&(this.name=null),void 0===this.description&&(this.description=null),void 0===this.additionalProperties&&(this.additionalProperties=null),void 0===this.priceEditable&&(this.priceEditable=!1),void 0===this.price&&(this.price=null),void 0===this.valueAddedTaxPercentageEditable&&(this.valueAddedTaxPercentageEditable=!1),void 0===this.valueAddedTaxPercentage&&(this.valueAddedTaxPercentage=null),void 0===this.nameVisible&&(this.nameVisible=null),void 0===this.x&&(this.x=null),void 0===this.y&&(this.y=null),void 0===this.elevation&&(this.elevation=null),void 0===this.angleInDegrees&&(this.angleInDegrees=null),void 0===this.angle&&(this.angle=null),void 0===this.rollAndPitchEditable&&(this.rollAndPitchEditable=!1),void 0===this.roll&&(this.roll=null),void 0===this.pitch&&(this.pitch=null),void 0===this.horizontalAxis&&(this.horizontalAxis=null),void 0===this.width&&(this.width=null),void 0===this.proportionalWidth&&(this.proportionalWidth=null),void 0===this.depth&&(this.depth=null),void 0===this.proportionalDepth&&(this.proportionalDepth=null),void 0===this.height&&(this.height=null),void 0===this.proportionalHeight&&(this.proportionalHeight=null),void 0===this.proportional&&(this.proportional=!1),void 0===this.modelTransformations&&(this.modelTransformations=null),void 0===this.modelPresetTransformationsNames&&(this.modelPresetTransformationsNames=null),void 0===this.modelPresetTransformations&&(this.modelPresetTransformations=null),void 0===this.color&&(this.color=null),void 0===this.paint&&(this.paint=null),void 0===this.shininess&&(this.shininess=null),void 0===this.visible&&(this.visible=null),void 0===this.modelMirrored&&(this.modelMirrored=null),void 0===this.basePlanItem&&(this.basePlanItem=null),void 0===this.basePlanItemEnabled&&(this.basePlanItemEnabled=!1),void 0===this.lightPowerEditable&&(this.lightPowerEditable=!1),void 0===this.lightPower&&(this.lightPower=null),void 0===this.resizable&&(this.resizable=!1),void 0===this.deformable&&(this.deformable=!1),void 0===this.widthDepthDeformable&&(this.widthDepthDeformable=!1),void 0===this.texturable&&(this.texturable=!1),void 0===this.visibleEditable&&(this.visibleEditable=!1),void 0===this.doorOrWindow&&(this.doorOrWindow=!1),void 0===this.wallThickness&&(this.wallThickness=0),void 0===this.wallDistance&&(this.wallDistance=0),void 0===this.wallWidth&&(this.wallWidth=0),void 0===this.wallLeft&&(this.wallLeft=0),void 0===this.wallHeight&&(this.wallHeight=0),void 0===this.wallTop&&(this.wallTop=0),void 0===this.sashes&&(this.sashes=null)}}return e.prototype.getTextureController=function(){return null==this.textureController&&(this.textureController=new TextureChoiceController(this.preferences.getLocalizedString(e,"textureTitle"),this.preferences,this.viewFactory,this.contentManager),this.textureController.addPropertyChangeListener("TEXTURE",new e.HomeFurnitureController$0(this))),this.textureController},e.prototype.getModelMaterialsController=function(){if(null==this.modelMaterialsController){this.modelMaterialsController=new ModelMaterialsController(this.preferences.getLocalizedString(e,"modelMaterialsTitle"),this.preferences,this.viewFactory,this.contentManager),this.modelMaterialsController.addPropertyChangeListener("MATERIALS",new e.HomeFurnitureController$1(this));var t=new e.HomeFurnitureController$2(this);this.addPropertyChangeListener("WIDTH",t),this.addPropertyChangeListener("DEPTH",t),this.addPropertyChangeListener("HEIGHT",t),this.addPropertyChangeListener("MODEL_TRANSFORMATIONS",new e.HomeFurnitureController$3(this))}return this.modelMaterialsController},e.prototype.getView=function(){return null==this.homeFurnitureView&&(this.homeFurnitureView=this.viewFactory.createHomeFurnitureView(this.preferences,this)),this.homeFurnitureView},e.prototype.getContentManager=function(){return this.contentManager},e.prototype.displayView=function(e){this.getView().displayView(e)},e.prototype.addPropertyChangeListener=function(e,t){this.propertyChangeSupport.addPropertyChangeListener(e,t)},e.prototype.removePropertyChangeListener=function(e,t){this.propertyChangeSupport.removePropertyChangeListener(e,t)},e.prototype.updateProperties=function(){var t,i,n=Home.getFurnitureSubList(this.home.getSelectedItems()),o=this.getTextureController(),r=this.getModelMaterialsController();if(0==n.length)this.setIcon(null),this.setName(null),this.setNameVisible(null),this.setDescription(null),this.setAdditionalProperties(null),this.setPrice(null,!1),this.priceEditable=!1,this.setValueAddedTaxPercentage(null),this.valueAddedTaxPercentageEditable=!1,this.setX(null),this.setY(null),this.setElevation(null),this.basePlanItemEnabled=!1,this.setAngleInDegrees(null),this.setRoll(null),this.setPitch(null),this.setHorizontalAxis(null),this.rollAndPitchEditable=!1,this.setWidth$java_lang_Float$boolean$boolean$boolean(null,!0,!1,!1),this.setDepth$java_lang_Float$boolean$boolean$boolean(null,!0,!1,!1),this.setHeight$java_lang_Float$boolean$boolean(null,!0,!1),this.setColor(null),null!=o&&o.setTexture(null),null!=r&&(r.setMaterials(null),r.setModel(null),r.setModelCreator(null)),this.setPaint(null),this.setModelTransformations$com_eteks_sweethome3d_model_Transformation_A(null),this.modelPresetTransformationsNames=[],this.modelPresetTransformations=[],this.doorOrWindow=!1,this.wallThickness=1,this.wallDistance=0,this.wallWidth=1,this.wallLeft=0,this.wallHeight=1,this.wallTop=0,this.sashes=[],this.setShininess(null),this.visibleEditable=!1,this.setVisible(null),this.setModelMirrored(null),this.lightPowerEditable=!1,this.setLightPower(null),this.setResizable(!0),this.setDeformable(!0),this.setTexturable(!0),this.setProportional(!1);else{var l=n[0],a=l.getIcon();if(null!=a)for(var s=1;s<n.length;s++)if(t=a,i=n[s].getIcon(),!(t&&t.equals?t.equals(i):t===i)){a=null;break}this.setIcon(a);var h=l.getName();if(null!=h)for(s=1;s<n.length;s++)if(h!==n[s].getName()){h=null;break}this.setName(h);var u=l.isNameVisible();for(s=1;s<n.length;s++)if(u!==n[s].isNameVisible()){u=null;break}this.setNameVisible(u);var d=l.getDescription();if(null!=d)for(s=1;s<n.length;s++)if(d!==n[s].getDescription()){d=null;break}if(this.setDescription(d),1===n.length){for(var c={},p=this.home.getFurnitureAdditionalProperties(),g=0;g<p.length;g++){var m=p[g],f=m.getName();m.isModifiable()&&function(e,t,i){null==e.entries&&(e.entries=[]);for(var n=0;n<e.entries.length;n++)if(null==e.entries[n].key&&null==t||null!=e.entries[n].key.equals&&e.entries[n].key.equals(t)||e.entries[n].key===t)return void(e.entries[n].value=i);e.entries.push({key:t,value:i,getKey:function(){return this.key},getValue:function(){return this.value}})}(c,m,l.isContentProperty(f)?l.getContentProperty(f):l.getProperty(f))}this.setAdditionalProperties(function(e){return null==e.entries&&(e.entries=[]),e.entries.length}(c)>0?c:null)}else this.setAdditionalProperties(null);var v=null!=this.preferences.getCurrency();if(v)for(s=0;s<n.length;s++)if(null!=n[s]&&n[s]instanceof HomeFurnitureGroup){v=!1;break}if(this.priceEditable=v,v){var _=l.getPrice();if(null!=_)for(s=1;s<n.length;s++)if(!(null!=n[s].getPrice()?_.eq(n[s].getPrice()):_===n[s].getPrice())){_=null;break}this.setPrice(_,!1),this.valueAddedTaxPercentageEditable=this.preferences.isValueAddedTaxEnabled();var S=l.getValueAddedTaxPercentage();if(null!=S)for(s=1;s<n.length;s++)if(!(null!=n[s].getValueAddedTaxPercentage()?S.eq(n[s].getValueAddedTaxPercentage()):S===n[s].getValueAddedTaxPercentage())){S=null;break}this.setValueAddedTaxPercentage(S)}else this.setPrice(null,!1),this.setValueAddedTaxPercentage(null),this.valueAddedTaxPercentageEditable=!1;var y=l.getX();for(s=1;s<n.length;s++)if(y!==n[s].getX()){y=null;break}this.setX(y);var E=l.getY();for(s=1;s<n.length;s++)if(E!==n[s].getY()){E=null;break}this.setY(E);var C=l.getElevation();for(s=1;s<n.length;s++)if(C!==n[s].getElevation()){C=null;break}this.setElevation(C);var P=!l.isDoorOrWindow();for(s=1;!P&&s<n.length;s++)n[s].isDoorOrWindow()||(P=!0);this.basePlanItemEnabled=P;var w=!l.isMovable();for(s=1;s<n.length;s++)if(w!==!n[s].isMovable()){w=null;break}this.setBasePlanItem(w);var L=l.getAngle();for(s=1;s<n.length;s++)if(L!==n[s].getAngle()){L=null;break}this.setAngle(L);var T=!0;for(s=0;T&&s<n.length;s++){T=(ee=n[s]).isHorizontallyRotatable()&&null==ee.getStaircaseCutOutShape()}if(this.rollAndPitchEditable=T,this.rollAndPitchEditable){var A=l.getRoll();for(s=1;s<n.length;s++)if(A!==n[s].getRoll()){A=null;break}this.setRoll(A);var I=l.getPitch();for(s=1;s<n.length;s++)if(I!==n[s].getPitch()){I=null;break}this.setPitch(I),null==A&&null==I||null!=A&&0!==A&&null!=I&&0!==I||null!=A&&0===A&&null!=I&&0===I?this.setHorizontalAxis(null):null==A&&null!=I&&0===I||null!=A&&0!==A?this.setHorizontalAxis(e.FurnitureHorizontalAxis.ROLL):this.setHorizontalAxis(e.FurnitureHorizontalAxis.PITCH)}else this.setRoll(null),this.setPitch(null),this.setHorizontalAxis(null);var b=l.getWidth();for(s=1;s<n.length;s++)if(b!==n[s].getWidth()){b=null;break}this.setWidth$java_lang_Float$boolean$boolean$boolean(b,!0,!1,!1);var O=l.getDepth();for(s=1;s<n.length;s++)if(O!==n[s].getDepth()){O=null;break}this.setDepth$java_lang_Float$boolean$boolean$boolean(O,!0,!1,!1);var M=l.getHeight();for(s=1;s<n.length;s++)if(M!==n[s].getHeight()){M=null;break}this.setHeight$java_lang_Float$boolean$boolean(M,!0,!1);var D=this.getFurnitureWithoutGroups(n),R=D[0],F=R.getColor();if(null!=F)for(s=1;s<D.length;s++)if(F!==D[s].getColor()){F=null;break}this.setColor(F);var x=R.getTexture();if(null!=x)for(s=1;s<D.length;s++)if(!x.equals(D[s].getTexture())){x=null;break}null!=o&&o.setTexture(x);var N=R.getModelMaterials(),k=R.getModel(),H=R.getCreator();if(null!=k)for(s=1;s<D.length;s++){if(!function(e,t){if(null==e&&null==t)return!0;if(null==e||null==t)return!1;if(e.length!=t.length)return!1;for(var i=0;i<e.length;i++)if(e[i]!=t[i])return!1;return!0}(N,(ee=D[s]).getModelMaterials())||k!==ee.getModel()){N=null,k=null,H=null;break}}null!=r&&(r.setMaterials(N),r.setModel(k),r.setModelCreator(H),r.setModelSize(R.getWidth(),R.getDepth(),R.getHeight()),r.setModelRotation(R.getModelRotation()),r.setModelTransformations(R.getModelTransformations()),r.setModelFlags(R.getModelFlags()));var V=!0;for(s=0;s<D.length;s++){if(null!=(ee=D[s]).getColor()||null!=ee.getTexture()||null!=ee.getModelMaterials()){V=!1;break}}null!=F?this.setPaint(e.FurniturePaint.COLORED):null!=x?this.setPaint(e.FurniturePaint.TEXTURED):null!=N?this.setPaint(e.FurniturePaint.MODEL_MATERIALS):V?this.setPaint(e.FurniturePaint.DEFAULT):this.setPaint(null);var U=l.getModelTransformations();if(1!==n.length||null!=l&&l instanceof HomeFurnitureGroup)U=null;else if(null==U&&(U=[]),null!=l&&l instanceof HomeDoorOrWindow){var W=l;this.doorOrWindow=!0,this.wallThickness=W.getWallThickness(),this.wallDistance=W.getWallDistance(),this.wallWidth=W.getWallWidth(),this.wallLeft=W.getWallLeft(),this.wallHeight=W.getWallHeight(),this.wallTop=W.getWallTop(),this.sashes=W.getSashes()}if(this.setModelTransformations$com_eteks_sweethome3d_model_Transformation_A(U),this.modelPresetTransformationsNames=[],this.modelPresetTransformations=[],1===n.length&&!(null!=l&&l instanceof HomeFurnitureGroup)&&null!=l.getCatalogId()){var B=this.preferences.getFurnitureCatalog().getPieceOfFurnitureWithId(l.getCatalogId());if(null!=B){s=1;for(var G=B.getProperty("modelPresetTransformationsName_"+s);null!=G;G=B.getProperty("modelPresetTransformationsName_"+ ++s)){var Y=B.getProperty("modelPresetTransformations_"+s);if(null!=Y){var $=Y.trim().split(/\s+/);if($.length%13==0){var X=function(e){for(var t=[];e-- >0;)t.push(null);return t}($.length/13|0);try{for(var z=0;z<$.length;z+=12){var j=$[z++],K=[[parseFloat($[z+0]),parseFloat($[z+1]),parseFloat($[z+2]),parseFloat($[z+3])],[parseFloat($[z+4]),parseFloat($[z+5]),parseFloat($[z+6]),parseFloat($[z+7])],[parseFloat($[z+8]),parseFloat($[z+9]),parseFloat($[z+10]),parseFloat($[z+11])]];X[z/13|0]=new Transformation(j,K)}this.modelPresetTransformationsNames.push(G),this.modelPresetTransformations.push(X)}catch(e){console.info("Invalid value in preset transformations matrices for "+l.getCatalogId()+"\n"+e)}}}}}}var J=R.getShininess(),q=null==J?e.FurnitureShininess.DEFAULT:0===J?e.FurnitureShininess.MATT:e.FurnitureShininess.SHINY;for(s=1;s<D.length;s++){if(J!==(ee=D[s]).getShininess()||null!=J&&J!==ee.getShininess()){q=null;break}}this.setShininess(q);var Z=!0,Q=this.home.getFurniture();for(g=0;g<n.length;g++){var ee=n[g];if(!(Q.indexOf(ee)>=0)){Z=!1;break}}if(this.visibleEditable=Z,Z){var te=l.isVisible();for(s=1;s<n.length;s++)if(te!==n[s].isVisible()){te=null;break}this.setVisible(te)}else this.setVisible(null);var ie=l.isModelMirrored();for(s=1;s<n.length;s++)if(ie!==n[s].isModelMirrored()){ie=null;break}this.setModelMirrored(ie);var ne=null!=l&&l instanceof HomeLight;for(s=1;ne&&s<n.length;s++)ne=null!=n[s]&&n[s]instanceof HomeLight;if(this.lightPowerEditable=ne,ne){var oe=l.getPower();for(s=1;s<n.length;s++)if(oe!==n[s].getPower()){oe=null;break}this.setLightPower(oe)}else this.setLightPower(null);var re=l.isResizable();for(s=1;s<n.length;s++)if(re!==n[s].isResizable()){re=null;break}this.setResizable(null!=re&&re);var le=!0;for(s=0;le&&s<n.length;s++){if(null!=(ee=n[s])&&ee instanceof HomeFurnitureGroup)for(p=ee.getAllFurniture(),g=0;g<p.length;g++){var ae=p[g];if(!ae.isDeformable()||ae.isHorizontallyRotated()||null!=ae.getModelTransformations()){le=!1;break}}else le=ee.isDeformable()&&null==ee.getModelTransformations()}this.setDeformable(le),this.isDeformable()||this.setProportional(!0),this.widthDepthDeformable=!0;for(s=0;this.widthDepthDeformable&&s<n.length;s++){ee=n[s];this.widthDepthDeformable=ee.isWidthDepthDeformable()}var se=l.isTexturable();for(s=1;s<n.length;s++)if(se!==n[s].isTexturable()){se=null;break}this.setTexturable(null==se||se)}},e.prototype.getFurnitureWithoutGroups=function(e){for(var t,i,n=[],o=0;o<e.length;o++){var r=e[o];null!=r&&r instanceof HomeFurnitureGroup?(t=n,i=this.getFurnitureWithoutGroups(r.getFurniture()),t.push.apply(t,i)):n.push(r)}return n},e.prototype.isPropertyEditable=function(e){switch(e){case"ADDITIONAL_PROPERTIES":return null!=this.getAdditionalProperties();case"PRICE":return this.isPriceEditable();case"VALUE_ADDED_TAX_PERCENTAGE":return this.isValueAddedTaxPercentageEditable();case"ROLL":case"PITCH":return this.isRollAndPitchEditable();case"MODEL_TRANSFORMATIONS":return null!=this.getModelTransformations();case"LIGHT_POWER":return this.isLightPowerEditable();case"VISIBLE":return this.visibleEditable;default:return!0}},e.prototype.setIcon=function(e){if(e!==this.icon){var t=this.icon;this.icon=e,this.propertyChangeSupport.firePropertyChange("ICON",t,e)}},e.prototype.getIcon=function(){return this.icon},e.prototype.setName=function(e){if(e!==this.name){var t=this.name;this.name=e,this.propertyChangeSupport.firePropertyChange("NAME",t,e)}},e.prototype.getName=function(){return this.name},e.prototype.setNameVisible=function(e){if(e!==this.nameVisible){var t=this.nameVisible;this.nameVisible=e,this.propertyChangeSupport.firePropertyChange("NAME_VISIBLE",t,e)}},e.prototype.getNameVisible=function(){return this.nameVisible},e.prototype.setDescription=function(e){if(e!==this.description){var t=this.description;this.description=e,this.propertyChangeSupport.firePropertyChange("DESCRIPTION",t,e)}},e.prototype.getDescription=function(){return this.description},e.prototype.setAdditionalProperties=function(e){if(e!==this.additionalProperties&&(null==e||(i=e,n=this.additionalProperties,!(i&&i.equals?i.equals(n):i===n)))){var t=this.additionalProperties;this.additionalProperties=null!=e?function(e){var t={};return t.entries=null!=e.entries?e.entries.slice():null,t}(e):null,this.propertyChangeSupport.firePropertyChange("ADDITIONAL_PROPERTIES",t,e)}var i,n},e.prototype.getAdditionalProperties=function(){return this.additionalProperties},e.prototype.setPrice=function(e,t){if(void 0===t&&(t=!0),e!==this.price&&(null==e||!(null!=this.price?e.eq(this.price):e===this.price))){var i=this.price;this.price=e,this.propertyChangeSupport.firePropertyChange("PRICE",i,e),t&&null!=e&&this.isValueAddedTaxPercentageEditable()&&null==this.getValueAddedTaxPercentage()&&1===Home.getFurnitureSubList(this.home.getSelectedItems()).length&&this.setValueAddedTaxPercentage(this.preferences.getDefaultValueAddedTaxPercentage())}},e.prototype.getPrice=function(){return this.price},e.prototype.isPriceEditable=function(){return this.priceEditable},e.prototype.setValueAddedTaxPercentage=function(e){if(e!==this.valueAddedTaxPercentage&&(null==e||!(null!=this.valueAddedTaxPercentage?e.eq(this.valueAddedTaxPercentage):e===this.valueAddedTaxPercentage))){var t=this.valueAddedTaxPercentage;this.valueAddedTaxPercentage=e,this.propertyChangeSupport.firePropertyChange("VALUE_ADDED_TAX_PERCENTAGE",t,e)}},e.prototype.getValueAddedTaxPercentage=function(){return this.valueAddedTaxPercentage},e.prototype.isValueAddedTaxPercentageEditable=function(){return this.valueAddedTaxPercentageEditable},e.prototype.setX=function(e){if(e!==this.x){var t=this.x;this.x=e,this.propertyChangeSupport.firePropertyChange("X",t,e)}},e.prototype.getX=function(){return this.x},e.prototype.setY=function(e){if(e!==this.y){var t=this.y;this.y=e,this.propertyChangeSupport.firePropertyChange("Y",t,e)}},e.prototype.getY=function(){return this.y},e.prototype.setElevation=function(e){if(e!==this.elevation){var t=this.elevation;this.elevation=e,this.propertyChangeSupport.firePropertyChange("ELEVATION",t,e)}},e.prototype.getElevation=function(){return this.elevation},e.prototype.setAngleInDegrees=function(e,t){if(void 0===t&&(t=!0),e!==this.angleInDegrees){var i=this.angleInDegrees;this.angleInDegrees=e,this.propertyChangeSupport.firePropertyChange("ANGLE_IN_DEGREES",i,e),t&&(null==this.angleInDegrees?this.setAngle(null,!1):this.setAngle(new Number((n=this.angleInDegrees,n*Math.PI/180)).valueOf(),!1))}var n},e.prototype.getAngleInDegrees=function(){return this.angleInDegrees},e.prototype.setAngle=function(e,t){if(void 0===t&&(t=!0),e!==this.angle){var i=this.angle;this.angle=e,this.propertyChangeSupport.firePropertyChange("ANGLE",i,e),t&&(null==e?this.setAngleInDegrees(null,!1):this.setAngleInDegrees((Math.round(180*e/Math.PI)+360|0)%360,!1))}},e.prototype.getAngle=function(){return this.angle},e.prototype.isRollAndPitchEditable=function(){return this.rollAndPitchEditable},e.prototype.setRoll=function(e){if(e!==this.roll){var t=this.roll;this.roll=e,this.propertyChangeSupport.firePropertyChange("ROLL",t,e)}},e.prototype.getRoll=function(){return this.roll},e.prototype.setPitch=function(e){if(e!==this.pitch){var t=this.pitch;this.pitch=e,this.propertyChangeSupport.firePropertyChange("PITCH",t,e)}},e.prototype.getPitch=function(){return this.pitch},e.prototype.setHorizontalAxis=function(e){if(e!==this.horizontalAxis){var t=this.horizontalAxis;this.horizontalAxis=e,this.propertyChangeSupport.firePropertyChange("HORIZONTAL_AXIS",t,e)}},e.prototype.getHorizontalAxis=function(){return this.horizontalAxis},e.prototype.isBasePlanItemEnabled=function(){return this.basePlanItemEnabled},e.prototype.isBasePlanItemEditable=function(){return this.basePlanItemEnabled},e.prototype.setBasePlanItem=function(e){if(e!==this.basePlanItem){var t=this.basePlanItem;this.basePlanItem=e,this.propertyChangeSupport.firePropertyChange("BASE_PLAN_ITEM",t,e)}},e.prototype.getBasePlanItem=function(){return this.basePlanItem},e.prototype.setWidth$java_lang_Float=function(e){this.setWidth$java_lang_Float$boolean$boolean$boolean(e,!1,this.isProportional()||!this.widthDepthDeformable,this.isProportional())},e.prototype.setWidth$java_lang_Float$boolean$boolean$boolean=function(e,t,i,n){var o=null!=e?Math.max(e,.001):null;if((o===e||null!=o&&o===e||!t)&&(this.proportionalWidth=e),null==o&&null!=this.width||null!=o&&o!==this.width){var r=this.width;if(this.width=o,this.propertyChangeSupport.firePropertyChange("WIDTH",r,o),null!=r&&null!=o){var l=o/r;i&&null!=this.proportionalDepth&&this.setDepth$java_lang_Float$boolean$boolean$boolean(this.proportionalDepth*l,!0,!1,!1),n&&null!=this.proportionalHeight&&this.setHeight$java_lang_Float$boolean$boolean(this.proportionalHeight*l,!0,!1)}else i&&this.setDepth$java_lang_Float$boolean$boolean$boolean(null,!1,!1,!1),n&&this.setHeight$java_lang_Float$boolean$boolean(null,!1,!1)}},e.prototype.setWidth=function(e,t,i,n){if("number"!=typeof e&&null!==e||"boolean"!=typeof t&&null!==t||"boolean"!=typeof i&&null!==i||"boolean"!=typeof n&&null!==n){if("number"!=typeof e&&null!==e||void 0!==t||void 0!==i||void 0!==n)throw new Error("invalid overload");return this.setWidth$java_lang_Float(e)}return this.setWidth$java_lang_Float$boolean$boolean$boolean(e,t,i,n)},e.prototype.getWidth=function(){return this.width},e.prototype.setDepth$java_lang_Float=function(e){this.setDepth$java_lang_Float$boolean$boolean$boolean(e,!1,this.isProportional()||!this.widthDepthDeformable,this.isProportional())},e.prototype.setDepth$java_lang_Float$boolean$boolean$boolean=function(e,t,i,n){var o=null!=e?Math.max(e,.001):null;if((o===e||null!=o&&o===e||!t)&&(this.proportionalDepth=e),null==o&&null!=this.depth||null!=o&&o!==this.depth){var r=this.depth;if(this.depth=o,this.propertyChangeSupport.firePropertyChange("DEPTH",r,o),null!=r&&null!=o){var l=o/r;i&&null!=this.proportionalWidth&&this.setWidth$java_lang_Float$boolean$boolean$boolean(this.proportionalWidth*l,!0,!1,!1),n&&null!=this.proportionalHeight&&this.setHeight$java_lang_Float$boolean$boolean(this.proportionalHeight*l,!0,!1)}else i&&this.setWidth$java_lang_Float$boolean$boolean$boolean(null,!1,!1,!1),n&&this.setHeight$java_lang_Float$boolean$boolean(null,!1,!1)}},e.prototype.setDepth=function(e,t,i,n){if("number"!=typeof e&&null!==e||"boolean"!=typeof t&&null!==t||"boolean"!=typeof i&&null!==i||"boolean"!=typeof n&&null!==n){if("number"!=typeof e&&null!==e||void 0!==t||void 0!==i||void 0!==n)throw new Error("invalid overload");return this.setDepth$java_lang_Float(e)}return this.setDepth$java_lang_Float$boolean$boolean$boolean(e,t,i,n)},e.prototype.getDepth=function(){return this.depth},e.prototype.setHeight$java_lang_Float=function(e){this.setHeight$java_lang_Float$boolean$boolean(e,!1,this.isProportional())},e.prototype.setHeight$java_lang_Float$boolean$boolean=function(e,t,i){var n=null!=e?Math.max(e,.001):null;if((n===e||null!=n&&n===e||!t)&&(this.proportionalHeight=e),null==n&&null!=this.height||null!=n&&n!==this.height){var o=this.height;if(this.height=n,this.propertyChangeSupport.firePropertyChange("HEIGHT",o,n),i)if(null!=o&&null!=n){var r=n/o;null!=this.proportionalWidth&&this.setWidth$java_lang_Float$boolean$boolean$boolean(this.proportionalWidth*r,!0,!1,!1),null!=this.proportionalDepth&&this.setDepth$java_lang_Float$boolean$boolean$boolean(this.proportionalDepth*r,!0,!1,!1)}else this.setWidth$java_lang_Float$boolean$boolean$boolean(null,!1,!1,!1),this.setDepth$java_lang_Float$boolean$boolean$boolean(null,!1,!1,!1)}},e.prototype.setHeight=function(e,t,i){if("number"!=typeof e&&null!==e||"boolean"!=typeof t&&null!==t||"boolean"!=typeof i&&null!==i){if("number"!=typeof e&&null!==e||void 0!==t||void 0!==i)throw new Error("invalid overload");return this.setHeight$java_lang_Float(e)}return this.setHeight$java_lang_Float$boolean$boolean(e,t,i)},e.prototype.getHeight=function(){return this.height},e.prototype.setProportional=function(e){if(e!==this.proportional){var t=this.proportional;this.proportional=e,this.propertyChangeSupport.firePropertyChange("PROPORTIONAL",t,e)}},e.prototype.isProportional=function(){return this.proportional},e.prototype.setColor=function(e){if(e!==this.color){var t=this.color;this.color=e,this.propertyChangeSupport.firePropertyChange("COLOR",t,e)}},e.prototype.getColor=function(){return this.color},e.prototype.setPaint=function(e){if(e!==this.paint){var t=this.paint;this.paint=e,this.propertyChangeSupport.firePropertyChange("PAINT",t,e)}},e.prototype.getPaint=function(){return this.paint},e.prototype.setModelTransformations$com_eteks_sweethome3d_model_Transformation_A=function(e){if(!function(e,t){if(null==e&&null==t)return!0;if(null==e||null==t)return!1;if(e.length!=t.length)return!1;for(var i=0;i<e.length;i++)if(e[i]!=t[i])return!1;return!0}(e,this.modelTransformations)){var t=this.modelTransformations;this.modelTransformations=e,this.propertyChangeSupport.firePropertyChange("MODEL_TRANSFORMATIONS",t,e),this.setDeformable(null==e||0===e.length),this.setProportional(null!=e&&e.length>0)}},e.prototype.setModelTransformations$com_eteks_sweethome3d_model_Transformation_A$float$float$float$float$float$float=function(e,t,i,n,o,r,l){if(this.doorOrWindow){var a=this.getX(),s=this.getY(),h=this.getElevation(),u=this.getWidth(),d=this.getDepth(),c=this.getHeight(),p=-this.getAngle(),g=a*Math.cos(p)-s*Math.sin(p),m=t*Math.cos(p)-i*Math.sin(p),f=this.wallLeft*u,v=this.wallWidth*u,_=void 0;if(this.getModelMirrored())_=f-g-u/2+m+o/2;else _=f+g-u/2-m+o/2;for(var S=a*Math.sin(p)+s*Math.cos(p),y=t*Math.sin(p)+i*Math.cos(p),E=this.wallDistance*d,C=this.wallThickness*d,P=S-d/2+E-y+r/2,w=this.wallTop*c,L=this.wallHeight*c,T=w+n+l-(h+c),A=this.sashes,I=0;I<A.length;I++){var b=A[I],O=b.getXAxis()*u;O+=_-f;var M=b.getYAxis()*d;M+=P-E,A[I]=new Sash(O/o,M/r,b.getWidth()*u/o,b.getStartAngle(),b.getEndAngle())}this.wallThickness=C/r,this.wallDistance=P/r,this.wallWidth=v/o,this.wallLeft=_/o,this.wallHeight=L/l,this.wallTop=T/l,this.sashes=A}this.setModelTransformations$com_eteks_sweethome3d_model_Transformation_A(e),this.setX(t),this.setY(i),this.setWidth$java_lang_Float$boolean$boolean$boolean(o,!1,!1,!1),this.setDepth$java_lang_Float$boolean$boolean$boolean(r,!1,!1,!1),this.setHeight$java_lang_Float$boolean$boolean(l,!1,!1)},e.prototype.setModelTransformations=function(e,t,i,n,o,r,l){if(!(null!=e&&e instanceof Array&&(0==e.length||null==e[0]||null!=e[0]&&e[0]instanceof Transformation)||null===e)||"number"!=typeof t&&null!==t||"number"!=typeof i&&null!==i||"number"!=typeof n&&null!==n||"number"!=typeof o&&null!==o||"number"!=typeof r&&null!==r||"number"!=typeof l&&null!==l){if((null!=e&&e instanceof Array&&(0==e.length||null==e[0]||null!=e[0]&&e[0]instanceof Transformation)||null===e)&&void 0===t&&void 0===i&&void 0===n&&void 0===o&&void 0===r&&void 0===l)return this.setModelTransformations$com_eteks_sweethome3d_model_Transformation_A(e);throw new Error("invalid overload")}return this.setModelTransformations$com_eteks_sweethome3d_model_Transformation_A$float$float$float$float$float$float(e,t,i,n,o,r,l)},e.prototype.getModelTransformations=function(){return this.modelTransformations},e.prototype.getModelPresetTransformationsNames=function(){return this.modelPresetTransformationsNames.slice(0)},e.prototype.getModelPresetTransformations=function(e){return this.modelPresetTransformations[e]},e.prototype.setShininess=function(e){if(e!==this.shininess){var t=this.shininess;this.shininess=e,this.propertyChangeSupport.firePropertyChange("SHININESS",t,e)}},e.prototype.getShininess=function(){return this.shininess},e.prototype.setVisible=function(e){if(e!==this.visible){var t=this.visible;this.visible=e,this.propertyChangeSupport.firePropertyChange("VISIBLE",t,e)}},e.prototype.getVisible=function(){return this.visible},e.prototype.setModelMirrored=function(e){if(e!==this.modelMirrored){var t=this.modelMirrored;this.modelMirrored=e,this.propertyChangeSupport.firePropertyChange("MODEL_MIRRORED",t,e)}},e.prototype.getModelMirrored=function(){return this.modelMirrored},e.prototype.isLightPowerEditable=function(){return this.lightPowerEditable},e.prototype.getLightPower=function(){return this.lightPower},e.prototype.setLightPower=function(e){if(e!==this.lightPower){var t=this.lightPower;this.lightPower=e,this.propertyChangeSupport.firePropertyChange("LIGHT_POWER",t,e)}},e.prototype.setResizable=function(e){if(e!==this.resizable){var t=this.resizable;this.resizable=e,this.propertyChangeSupport.firePropertyChange("RESIZABLE",t,e)}},e.prototype.isResizable=function(){return this.resizable},e.prototype.setDeformable=function(e){if(e!==this.deformable){var t=this.deformable;this.deformable=e,this.propertyChangeSupport.firePropertyChange("DEFORMABLE",t,e)}},e.prototype.isDeformable=function(){return this.deformable},e.prototype.setTexturable=function(e){if(e!==this.texturable){var t=this.texturable;this.texturable=e,this.propertyChangeSupport.firePropertyChange("TEXTURABLE",t,e)}},e.prototype.isTexturable=function(){return this.texturable},e.prototype.modifyFurniture=function(){var t,i=this.home.getSelectedItems(),n=Home.getFurnitureSubList(i);if(0!=n.length){var o=this.getName(),r=this.getNameVisible(),l=this.getDescription(),a=this.getAdditionalProperties(),s=void 0;if(null==a)s=null;else{s={};for(var h=(null==(t=a).entries&&(t.entries=[]),t.entries),u=0;u<h.length;u++){var d=h[u];s[d.getKey().getName()]=d.getValue()}}var c=this.getPrice(),p=1===n.length&&null==c,g=this.getValueAddedTaxPercentage(),m=1===n.length&&null==g,f=this.preferences.getCurrency(),v=this.getX(),_=this.getY(),S=this.getElevation(),y=this.getAngle(),E=this.getRoll(),C=this.getPitch(),P=this.getHorizontalAxis(),w=this.getBasePlanItem(),L=this.getWidth(),T=this.getDepth(),A=this.getHeight(),I=this.isProportional()&&(null==L||null==T||null==A),b=this.getPaint(),O=b===e.FurniturePaint.COLORED?this.getColor():null,M=this.getTextureController(),D=void 0;D=null!=M&&b===e.FurniturePaint.TEXTURED?M.getTexture():null;var R=this.getModelMaterialsController(),F=void 0;F=null!=R&&b===e.FurniturePaint.MODEL_MATERIALS?R.getMaterials():null;for(var x=this.getModelTransformations(),N=this.getShininess()===e.FurnitureShininess.DEFAULT,k=this.getShininess()===e.FurnitureShininess.SHINY?new Number(.5).valueOf():this.getShininess()===e.FurnitureShininess.MATT?new Number(0).valueOf():null,H=this.getVisible(),V=this.getModelMirrored(),U=this.getLightPower(),W=function(e){for(var t=[];e-- >0;)t.push(null);return t}(n.length),B=0;B<W.length;B++){var G=n[B];W[B]=null!=G&&G instanceof HomeLight?new e.ModifiedLight(G):null!=G&&G instanceof HomeDoorOrWindow?new e.ModifiedDoorOrWindow(G):null!=G&&G instanceof HomeFurnitureGroup?new e.ModifiedFurnitureGroup(G):new e.ModifiedPieceOfFurniture(G)}if(e.doModifyFurniture(W,o,r,l,s,c,p,g,m,f,v,_,S,y,E,C,P,w,L,T,A,I,x,this.wallThickness,this.wallDistance,this.wallWidth,this.wallLeft,this.wallHeight,this.wallTop,this.sashes,b,O,D,F,N,k,H,V,U),null!=this.undoSupport){var Y=this.home.getSelectedItems();this.undoSupport.postEdit(new e.FurnitureModificationUndoableEdit(this.home,this.preferences,i.slice(0),Y.slice(0),W,o,r,l,s,c,p,g,m,f,v,_,S,y,E,C,P,w,L,T,A,I,x,this.wallThickness,this.wallDistance,this.wallWidth,this.wallLeft,this.wallHeight,this.wallTop,this.sashes,b,O,D,F,N,k,H,V,U))}null!=o&&this.preferences.addAutoCompletionString("HomePieceOfFurnitureName",o),null!=l&&this.preferences.addAutoCompletionString("HomePieceOfFurnitureDescription",l),null!=g&&this.preferences.setDefaultValueAddedTaxPercentage(g)}},e.doModifyFurniture=function(t,i,n,o,r,l,a,s,h,u,d,c,p,g,m,f,v,_,S,y,E,C,P,w,L,T,A,I,b,O,M,D,R,F,x,N,k,H,V){for(var U=0;U<t.length;U++){var W=t[U].getPieceOfFurniture();if(null!=i&&W.setName(i),null!=n&&W.setNameVisible(n),null!=r)for(var B=function(e){var t=[];for(var i in e)t.push({k:i,v:e[i],getKey:function(){return this.k},getValue:function(){return this.v}});return t}(r),G=0;G<B.length;G++){var Y=B[G];W.setProperty$java_lang_String$java_lang_Object(Y.getKey(),Y.getValue())}if(1!==t.length&&null==o||W.setDescription(o),!(null!=W&&W instanceof HomeFurnitureGroup)){if(null!=l||a){if(l===W.getPrice()||null!=l&&(null!=W.getPrice()?l.eq(W.getPrice()):l===W.getPrice())||W.setCurrency(null!=l?u:null),null!=l)try{l=l.round(["JPY","VND"].indexOf(u)>=0?0:2)}catch(e){}W.setPrice(l)}(null!=s||h)&&W.setValueAddedTaxPercentage(s)}if(null!=d&&W.setX(d),null!=c&&W.setY(c),null!=p&&W.setElevation(p),null!=g&&W.setAngle(g),null!=v)switch(v){case e.FurnitureHorizontalAxis.ROLL:null!=m&&(W.setRoll(m),W.setPitch(0));break;case e.FurnitureHorizontalAxis.PITCH:null!=f&&(W.setPitch(f),W.setRoll(0))}if(null==_||W.isDoorOrWindow()||W.setMovable(!_),W.isResizable()){var $=W.getWidth(),X=W.getDepth();if(!C&&W.isDeformable()?(null!=S?W.setWidth(S):null==y||W.isWidthDepthDeformable()||W.setWidth(W.getWidth()*y/X),null!=y?W.setDepth(y):null==S||W.isWidthDepthDeformable()||W.setDepth(W.getDepth()*S/$),null!=E&&W.setHeight(E)):null!=S?W.scale(S/W.getWidth()):null!=y?W.scale(y/W.getDepth()):null!=E&&W.scale(E/W.getHeight()),null!=H&&W.setModelMirrored(H),null!=W&&W instanceof HomeDoorOrWindow&&1===t.length&&JSON.stringify(W.getModelTransformations())!==JSON.stringify(null!=P&&P.length>0?P:null)){var z=W;z.setWallThickness(w),z.setWallDistance(L),z.setWallWidth(T),z.setWallLeft(A),z.setWallHeight(I),z.setWallTop(b),z.setSashes(O)}}if(W.isTexturable()){if(null!=M)switch(M){case e.FurniturePaint.DEFAULT:W.setColor(null),W.setTexture(null),W.setModelMaterials(null);break;case e.FurniturePaint.COLORED:W.setColor(D),W.setTexture(null),W.setModelMaterials(null);break;case e.FurniturePaint.TEXTURED:W.setColor(null),W.setTexture(R),W.setModelMaterials(null);break;case e.FurniturePaint.MODEL_MATERIALS:W.setColor(null),W.setTexture(null),W.setModelMaterials(F)}x?W.setShininess(null):null!=N&&W.setShininess(N)}null!=P&&W.setModelTransformations(P.length>0?P:null),null!=k&&W.setVisible(k),null!=V&&W.setPower(V)}},e.undoModifyFurniture=function(e){for(var t=0;t<e.length;t++){e[t].reset()}},e}();HomeFurnitureController.__class="com.eteks.sweethome3d.viewcontroller.HomeFurnitureController",HomeFurnitureController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"],function(e){var t;(t=e.FurniturePaint||(e.FurniturePaint={}))[t.DEFAULT=0]="DEFAULT",t[t.COLORED=1]="COLORED",t[t.TEXTURED=2]="TEXTURED",t[t.MODEL_MATERIALS=3]="MODEL_MATERIALS",function(e){e[e.DEFAULT=0]="DEFAULT",e[e.MATT=1]="MATT",e[e.SHINY=2]="SHINY"}(e.FurnitureShininess||(e.FurnitureShininess={})),function(e){e[e.ROLL=0]="ROLL",e[e.PITCH=1]="PITCH"}(e.FurnitureHorizontalAxis||(e.FurnitureHorizontalAxis={}));var i=function(t){function i(i,n,o,r,l,a,s,h,u,d,c,p,g,m,f,v,_,S,y,E,C,P,w,L,T,A,I,b,O,M,D,R,F,x,N,k,H,V,U,W,B,G,Y){var $=t.call(this,n,e,"undoModifyFurnitureName")||this;void 0===$.home&&($.home=null),void 0===$.modifiedFurniture&&($.modifiedFurniture=null),void 0===$.oldSelection&&($.oldSelection=null),void 0===$.newSelection&&($.newSelection=null),void 0===$.name&&($.name=null),void 0===$.nameVisible&&($.nameVisible=null),void 0===$.description&&($.description=null),void 0===$.additionalProperties&&($.additionalProperties=null),void 0===$.price&&($.price=null),void 0===$.removePrice&&($.removePrice=!1),void 0===$.currency&&($.currency=null),void 0===$.valueAddedTaxPercentage&&($.valueAddedTaxPercentage=null),void 0===$.removeValueAddedTaxPercentage&&($.removeValueAddedTaxPercentage=!1),void 0===$.x&&($.x=null),void 0===$.y&&($.y=null),void 0===$.elevation&&($.elevation=null),void 0===$.angle&&($.angle=null),void 0===$.roll&&($.roll=null),void 0===$.pitch&&($.pitch=null),void 0===$.horizontalAxis&&($.horizontalAxis=null),void 0===$.basePlanItem&&($.basePlanItem=null),void 0===$.width&&($.width=null),void 0===$.depth&&($.depth=null),void 0===$.height&&($.height=null),void 0===$.proportional&&($.proportional=!1),void 0===$.modelTransformations&&($.modelTransformations=null),void 0===$.paint&&($.paint=null),void 0===$.color&&($.color=null),void 0===$.texture&&($.texture=null),void 0===$.modelMaterials&&($.modelMaterials=null),void 0===$.defaultShininess&&($.defaultShininess=!1),void 0===$.shininess&&($.shininess=null),void 0===$.visible&&($.visible=null),void 0===$.modelMirrored&&($.modelMirrored=null),void 0===$.lightPower&&($.lightPower=null),void 0===$.wallThickness&&($.wallThickness=0),void 0===$.wallDistance&&($.wallDistance=0),void 0===$.wallWidth&&($.wallWidth=0),void 0===$.wallLeft&&($.wallLeft=0),void 0===$.wallHeight&&($.wallHeight=0),void 0===$.wallTop&&($.wallTop=0),void 0===$.sashes&&($.sashes=null),void 0===$.widthsInPlan&&($.widthsInPlan=null),void 0===$.depthsInPlan&&($.depthsInPlan=null),void 0===$.heightsInPlan&&($.heightsInPlan=null),$.home=i,$.oldSelection=o,$.newSelection=r,$.modifiedFurniture=l,$.name=a,$.nameVisible=s,$.description=h,$.additionalProperties=u,$.price=d,$.removePrice=c,$.valueAddedTaxPercentage=p,$.removeValueAddedTaxPercentage=g,$.currency=m,$.x=f,$.y=v,$.elevation=_,$.angle=S,$.roll=y,$.pitch=E,$.horizontalAxis=C,$.basePlanItem=P,$.width=w,$.depth=L,$.height=T,$.proportional=A,$.modelTransformations=I,$.wallThickness=b,$.wallDistance=O,$.wallWidth=M,$.wallLeft=D,$.wallHeight=R,$.wallTop=F,$.sashes=x,$.paint=N,$.color=k,$.texture=H,$.modelMaterials=V,$.defaultShininess=U,$.shininess=W,$.visible=B,$.modelMirrored=G,$.lightPower=Y,$.widthsInPlan=function(e){for(var t=[];e-- >0;)t.push(0);return t}(l.length),$.depthsInPlan=function(e){for(var t=[];e-- >0;)t.push(0);return t}(l.length),$.heightsInPlan=function(e){for(var t=[];e-- >0;)t.push(0);return t}(l.length);for(var X=0;X<l.length;X++){var z=l[X].getPieceOfFurniture();$.widthsInPlan[X]=z.getWidthInPlan(),$.depthsInPlan[X]=z.getDepthInPlan(),$.heightsInPlan[X]=z.getHeightInPlan()}return $}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),e.undoModifyFurniture(this.modifiedFurniture),this.home.setSelectedItems(this.oldSelection.slice(0))},i.prototype.redo=function(){t.prototype.redo.call(this),e.doModifyFurniture(this.modifiedFurniture,this.name,this.nameVisible,this.description,this.additionalProperties,this.price,this.removePrice,this.valueAddedTaxPercentage,this.removeValueAddedTaxPercentage,this.currency,this.x,this.y,this.elevation,this.angle,this.roll,this.pitch,this.horizontalAxis,this.basePlanItem,this.width,this.depth,this.height,this.proportional,this.modelTransformations,this.wallThickness,this.wallDistance,this.wallWidth,this.wallLeft,this.wallHeight,this.wallTop,this.sashes,this.paint,this.color,this.texture,this.modelMaterials,this.defaultShininess,this.shininess,this.visible,this.modelMirrored,this.lightPower);for(var i=0;i<this.modifiedFurniture.length;i++){var n=this.modifiedFurniture[i].getPieceOfFurniture();n.setWidthInPlan(this.widthsInPlan[i]),n.setDepthInPlan(this.depthsInPlan[i]),n.setHeightInPlan(this.heightsInPlan[i])}this.home.setSelectedItems(this.newSelection.slice(0))},i}(LocalizedUndoableEdit);e.FurnitureModificationUndoableEdit=i,i.__class="com.eteks.sweethome3d.viewcontroller.HomeFurnitureController.FurnitureModificationUndoableEdit",i.__interfaces=["javax.swing.undo.UndoableEdit"];var n=function(){function e(e){void 0===this.piece&&(this.piece=null),void 0===this.name&&(this.name=null),void 0===this.nameVisible&&(this.nameVisible=!1),void 0===this.description&&(this.description=null),void 0===this.properties&&(this.properties=null),void 0===this.price&&(this.price=null),void 0===this.valueAddedTaxPercentage&&(this.valueAddedTaxPercentage=null),void 0===this.currency&&(this.currency=null),void 0===this.x&&(this.x=0),void 0===this.y&&(this.y=0),void 0===this.elevation&&(this.elevation=0),void 0===this.angle&&(this.angle=0),void 0===this.roll&&(this.roll=0),void 0===this.pitch&&(this.pitch=0),void 0===this.movable&&(this.movable=!1),void 0===this.width&&(this.width=0),void 0===this.depth&&(this.depth=0),void 0===this.height&&(this.height=0),void 0===this.widthInPlan&&(this.widthInPlan=0),void 0===this.depthInPlan&&(this.depthInPlan=0),void 0===this.heightInPlan&&(this.heightInPlan=0),void 0===this.modelTransformations&&(this.modelTransformations=null),void 0===this.color&&(this.color=null),void 0===this.texture&&(this.texture=null),void 0===this.modelMaterials&&(this.modelMaterials=null),void 0===this.shininess&&(this.shininess=null),void 0===this.visible&&(this.visible=!1),void 0===this.modelMirrored&&(this.modelMirrored=!1),this.piece=e,this.name=e.getName(),this.nameVisible=e.isNameVisible(),this.description=e.getDescription();var t,i,n=e.getPropertyNames();if(0===n.length)this.properties={};else if(1===n.length){var o=(t=n,i=0,{next:function(){return i<t.length?t[i++]:null},hasNext:function(){return i<t.length}}).next();this.properties=function(t){var i={};return i[t]=e.isContentProperty(o)?e.getContentProperty(o):e.getProperty(o),i}(o)}else{this.properties={};for(var r=0;r<n.length;r++){var l=n[r];this.properties[l]=e.isContentProperty(l)?e.getContentProperty(l):e.getProperty(l)}}this.price=e.getPrice(),this.valueAddedTaxPercentage=e.getValueAddedTaxPercentage(),this.currency=e.getCurrency(),this.x=e.getX(),this.y=e.getY(),this.elevation=e.getElevation(),this.angle=e.getAngle(),this.roll=e.getRoll(),this.pitch=e.getPitch(),this.movable=e.isMovable(),this.width=e.getWidth(),this.depth=e.getDepth(),this.height=e.getHeight(),this.widthInPlan=e.getWidthInPlan(),this.depthInPlan=e.getDepthInPlan(),this.heightInPlan=e.getHeightInPlan(),this.modelTransformations=e.getModelTransformations(),this.color=e.getColor(),this.texture=e.getTexture(),this.modelMaterials=e.getModelMaterials(),this.shininess=e.getShininess(),this.visible=e.isVisible(),this.modelMirrored=e.isModelMirrored()}return e.prototype.getPieceOfFurniture=function(){return this.piece},e.prototype.reset=function(){this.piece.setName(this.name),this.piece.setNameVisible(this.nameVisible),this.piece.setDescription(this.description);for(var e,t,i=this.piece.getPropertyNames(),n=0;n<i.length;n++){var o=i[n];this.piece.setProperty$java_lang_String$java_lang_Object(o,void 0===(e=this.properties)[t=o]?null:e[t])}var r=function(e){var t=[];for(var i in e)t.push({k:i,v:e[i],getKey:function(){return this.k},getValue:function(){return this.v}});return t}(this.properties);for(n=0;n<r.length;n++){var l=r[n];i.indexOf(l.getKey())>=0||this.piece.setProperty$java_lang_String$java_lang_Object(l.getKey(),l.getValue())}null!=this.piece&&this.piece instanceof HomeFurnitureGroup||(this.piece.setPrice(this.price),this.piece.setValueAddedTaxPercentage(this.valueAddedTaxPercentage),this.piece.setCurrency(this.currency)),this.piece.setX(this.x),this.piece.setY(this.y),this.piece.setElevation(this.elevation),this.piece.setAngle(this.angle),this.piece.isHorizontallyRotatable()&&(this.piece.setRoll(this.roll),this.piece.setPitch(this.pitch)),this.piece.setMovable(this.movable),this.piece.isResizable()&&(this.piece.setWidth(this.width),this.piece.setDepth(this.depth),this.piece.setHeight(this.height),this.piece.setModelMirrored(this.modelMirrored)),this.piece.setWidthInPlan(this.widthInPlan),this.piece.setDepthInPlan(this.depthInPlan),this.piece.setHeightInPlan(this.heightInPlan),this.piece.setModelTransformations(this.modelTransformations),this.piece.isTexturable()&&(this.piece.setColor(this.color),this.piece.setTexture(this.texture),this.piece.setModelMaterials(this.modelMaterials),this.piece.setShininess(this.shininess)),this.piece.setVisible(this.visible)},e}();e.ModifiedPieceOfFurniture=n,n.__class="com.eteks.sweethome3d.viewcontroller.HomeFurnitureController.ModifiedPieceOfFurniture";var o=function(e){function t(t){var i=e.call(this,t)||this;return void 0===i.boundToWall&&(i.boundToWall=!1),void 0===i.wallThickness&&(i.wallThickness=0),void 0===i.wallDistance&&(i.wallDistance=0),void 0===i.wallWidth&&(i.wallWidth=0),void 0===i.wallLeft&&(i.wallLeft=0),void 0===i.wallHeight&&(i.wallHeight=0),void 0===i.wallTop&&(i.wallTop=0),void 0===i.sashes&&(i.sashes=null),i.boundToWall=t.isBoundToWall(),i.wallThickness=t.getWallThickness(),i.wallDistance=t.getWallDistance(),i.wallWidth=t.getWallWidth(),i.wallLeft=t.getWallLeft(),i.wallHeight=t.getWallHeight(),i.wallTop=t.getWallTop(),i.sashes=t.getSashes(),i}return __extends(t,e),t.prototype.reset=function(){e.prototype.reset.call(this);var t=this.getPieceOfFurniture();t.setBoundToWall(this.boundToWall),t.setWallThickness(this.wallThickness),t.setWallDistance(this.wallDistance),t.setWallWidth(this.wallWidth),t.setWallLeft(this.wallLeft),t.setWallHeight(this.wallHeight),t.setWallTop(this.wallTop),t.setSashes(this.sashes)},t}(e.ModifiedPieceOfFurniture);e.ModifiedDoorOrWindow=o,o.__class="com.eteks.sweethome3d.viewcontroller.HomeFurnitureController.ModifiedDoorOrWindow";var r=function(e){function t(t){var i=e.call(this,t)||this;return void 0===i.power&&(i.power=0),i.power=t.getPower(),i}return __extends(t,e),t.prototype.reset=function(){e.prototype.reset.call(this),this.getPieceOfFurniture().setPower(this.power)},t}(e.ModifiedPieceOfFurniture);e.ModifiedLight=r,r.__class="com.eteks.sweethome3d.viewcontroller.HomeFurnitureController.ModifiedLight";var l=function(e){function t(t){var i=e.call(this,t)||this;void 0===i.groupFurnitureX&&(i.groupFurnitureX=null),void 0===i.groupFurnitureY&&(i.groupFurnitureY=null),void 0===i.groupFurnitureWidth&&(i.groupFurnitureWidth=null),void 0===i.groupFurnitureDepth&&(i.groupFurnitureDepth=null),void 0===i.groupFurnitureColor&&(i.groupFurnitureColor=null),void 0===i.groupFurnitureTexture&&(i.groupFurnitureTexture=null),void 0===i.groupFurnitureModelMaterials&&(i.groupFurnitureModelMaterials=null),void 0===i.groupFurnitureShininess&&(i.groupFurnitureShininess=null);var n=i.getGroupFurniture(t);i.groupFurnitureX=function(e){for(var t=[];e-- >0;)t.push(0);return t}(n.length),i.groupFurnitureY=function(e){for(var t=[];e-- >0;)t.push(0);return t}(n.length),i.groupFurnitureWidth=function(e){for(var t=[];e-- >0;)t.push(0);return t}(n.length),i.groupFurnitureDepth=function(e){for(var t=[];e-- >0;)t.push(0);return t}(n.length),i.groupFurnitureColor=function(e){for(var t=[];e-- >0;)t.push(null);return t}(n.length),i.groupFurnitureTexture=function(e){for(var t=[];e-- >0;)t.push(null);return t}(n.length),i.groupFurnitureShininess=function(e){for(var t=[];e-- >0;)t.push(null);return t}(n.length),i.groupFurnitureModelMaterials=function(e){for(var t=[];e-- >0;)t.push(null);return t}(n.length);for(var o=0;o<n.length;o++){var r=n[o];i.groupFurnitureX[o]=r.getX(),i.groupFurnitureY[o]=r.getY(),i.groupFurnitureWidth[o]=r.getWidth(),i.groupFurnitureDepth[o]=r.getDepth(),i.groupFurnitureColor[o]=r.getColor(),i.groupFurnitureTexture[o]=r.getTexture(),i.groupFurnitureShininess[o]=r.getShininess(),i.groupFurnitureModelMaterials[o]=r.getModelMaterials()}return i}return __extends(t,e),t.prototype.reset=function(){e.prototype.reset.call(this);for(var t=this.getPieceOfFurniture(),i=this.getGroupFurniture(t),n=0;n<i.length;n++){var o=i[n];t.isResizable()&&(o.setX(this.groupFurnitureX[n]),o.setY(this.groupFurnitureY[n]),o.setWidth(this.groupFurnitureWidth[n]),o.setDepth(this.groupFurnitureDepth[n])),!t.isTexturable()||null!=o&&o instanceof HomeFurnitureGroup||(o.setColor(this.groupFurnitureColor[n]),o.setTexture(this.groupFurnitureTexture[n]),o.setModelMaterials(this.groupFurnitureModelMaterials[n]),o.setShininess(this.groupFurnitureShininess[n]))}},t.prototype.getGroupFurniture=function(e){for(var t,i,n=[],o=e.getFurniture(),r=0;r<o.length;r++){var l=o[r];n.push(l),null!=l&&l instanceof HomeFurnitureGroup&&(t=n,i=this.getGroupFurniture(l),t.push.apply(t,i))}return n},t}(e.ModifiedPieceOfFurniture);e.ModifiedFurnitureGroup=l,l.__class="com.eteks.sweethome3d.viewcontroller.HomeFurnitureController.ModifiedFurnitureGroup";var a=function(){function t(e){this.__parent=e}return t.prototype.propertyChange=function(t){this.__parent.setPaint(e.FurniturePaint.TEXTURED)},t}();e.HomeFurnitureController$0=a;var s=function(){function t(e){this.__parent=e}return t.prototype.propertyChange=function(t){this.__parent.setPaint(e.FurniturePaint.MODEL_MATERIALS)},t}();e.HomeFurnitureController$1=s;var h=function(){function e(e){this.__parent=e}return e.prototype.propertyChange=function(e){null!=this.__parent.getWidth()&&null!=this.__parent.getDepth()&&null!=this.__parent.getHeight()&&this.__parent.modelMaterialsController.setModelSize(this.__parent.getWidth(),this.__parent.getDepth(),this.__parent.getHeight())},e}();e.HomeFurnitureController$2=h;var u=function(){function e(e){this.__parent=e}return e.prototype.propertyChange=function(e){null!=this.__parent.getModelTransformations()&&this.__parent.modelMaterialsController.setModelTransformations(this.__parent.getModelTransformations())},e}();e.HomeFurnitureController$3=u}(HomeFurnitureController||(HomeFurnitureController={}));var HomeController=function(){function e(t,i,n,o,r){if((null!=t&&t instanceof Home||null===t)&&(null!=i&&i instanceof HomeApplication||null===i)&&(null!=n&&n instanceof UserPreferences||null===n)&&(null!=o&&null!=o.constructor&&null!=o.constructor.__interfaces&&o.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0||null===o)&&(null!=r&&null!=r.constructor&&null!=r.constructor.__interfaces&&r.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ContentManager")>=0||null===r)){var l=arguments;if(void 0===this.home&&(this.home=null),void 0===this.preferences&&(this.preferences=null),void 0===this.application&&(this.application=null),void 0===this.viewFactory&&(this.viewFactory=null),void 0===this.contentManager&&(this.contentManager=null),void 0===this.undoSupport&&(this.undoSupport=null),void 0===this.undoManager&&(this.undoManager=null),void 0===this.homeView&&(this.homeView=null),void 0===this.childControllers&&(this.childControllers=null),void 0===this.furnitureCatalogController&&(this.furnitureCatalogController=null),void 0===this.furnitureController&&(this.furnitureController=null),void 0===this.planController&&(this.planController=null),void 0===this.homeController3D&&(this.homeController3D=null),void 0===this.saveUndoLevel&&(this.saveUndoLevel=0),void 0===this.notUndoableModifications&&(this.notUndoableModifications=!1),void 0===this.focusedView&&(this.focusedView=null),this.home=t,this.preferences=n,this.viewFactory=o,this.contentManager=r,this.application=i,this.undoSupport=new e.HomeController$0(this),this.undoManager=new javax.swing.undo.UndoManager,this.undoSupport.addUndoableEditListener(this.undoManager),this.notUndoableModifications=t.isModified(),null!=t.getName()){var a=this.preferences.getRecentHomes().slice(0);(S=(_=a).indexOf(t.getName()))>=0&&_.splice(S,1),a.splice(0,0,t.getName()),this.updateUserPreferencesRecentHomes(a)}}else if((null!=t&&t instanceof Home||null===t)&&(null!=i&&i instanceof HomeApplication||null===i)&&(null!=n&&null!=n.constructor&&null!=n.constructor.__interfaces&&n.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0||null===n)&&(null!=o&&null!=o.constructor&&null!=o.constructor.__interfaces&&o.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ContentManager")>=0||null===o)&&void 0===r){var s=(l=arguments)[2],h=l[3],u=arguments[1].getUserPreferences();if(void 0===this.home&&(this.home=null),void 0===this.preferences&&(this.preferences=null),void 0===this.application&&(this.application=null),void 0===this.viewFactory&&(this.viewFactory=null),void 0===this.contentManager&&(this.contentManager=null),void 0===this.undoSupport&&(this.undoSupport=null),void 0===this.undoManager&&(this.undoManager=null),void 0===this.homeView&&(this.homeView=null),void 0===this.childControllers&&(this.childControllers=null),void 0===this.furnitureCatalogController&&(this.furnitureCatalogController=null),void 0===this.furnitureController&&(this.furnitureController=null),void 0===this.planController&&(this.planController=null),void 0===this.homeController3D&&(this.homeController3D=null),void 0===this.saveUndoLevel&&(this.saveUndoLevel=0),void 0===this.notUndoableModifications&&(this.notUndoableModifications=!1),void 0===this.focusedView&&(this.focusedView=null),this.home=t,this.preferences=u,this.viewFactory=s,this.contentManager=h,this.application=i,this.undoSupport=new e.HomeController$0(this),this.undoManager=new javax.swing.undo.UndoManager,this.undoSupport.addUndoableEditListener(this.undoManager),this.notUndoableModifications=t.isModified(),null!=t.getName())!function(e){var i=e.indexOf(t.getName());i>=0&&e.splice(i,1)}(a=this.preferences.getRecentHomes().slice(0)),a.splice(0,0,t.getName()),this.updateUserPreferencesRecentHomes(a);void 0===this.home&&(this.home=null),void 0===this.preferences&&(this.preferences=null),void 0===this.application&&(this.application=null),void 0===this.viewFactory&&(this.viewFactory=null),void 0===this.contentManager&&(this.contentManager=null),void 0===this.undoSupport&&(this.undoSupport=null),void 0===this.undoManager&&(this.undoManager=null),void 0===this.homeView&&(this.homeView=null),void 0===this.childControllers&&(this.childControllers=null),void 0===this.furnitureCatalogController&&(this.furnitureCatalogController=null),void 0===this.furnitureController&&(this.furnitureController=null),void 0===this.planController&&(this.planController=null),void 0===this.homeController3D&&(this.homeController3D=null),void 0===this.saveUndoLevel&&(this.saveUndoLevel=0),void 0===this.notUndoableModifications&&(this.notUndoableModifications=!1),void 0===this.focusedView&&(this.focusedView=null)}else if((null!=t&&t instanceof Home||null===t)&&(null!=i&&i instanceof UserPreferences||null===i)&&(null!=n&&null!=n.constructor&&null!=n.constructor.__interfaces&&n.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0||null===n)&&(null!=o&&null!=o.constructor&&null!=o.constructor.__interfaces&&o.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ContentManager")>=0||null===o)&&void 0===r){var d=(l=arguments)[1],c=l[2],p=l[3];if(void 0===this.home&&(this.home=null),void 0===this.preferences&&(this.preferences=null),void 0===this.application&&(this.application=null),void 0===this.viewFactory&&(this.viewFactory=null),void 0===this.contentManager&&(this.contentManager=null),void 0===this.undoSupport&&(this.undoSupport=null),void 0===this.undoManager&&(this.undoManager=null),void 0===this.homeView&&(this.homeView=null),void 0===this.childControllers&&(this.childControllers=null),void 0===this.furnitureCatalogController&&(this.furnitureCatalogController=null),void 0===this.furnitureController&&(this.furnitureController=null),void 0===this.planController&&(this.planController=null),void 0===this.homeController3D&&(this.homeController3D=null),void 0===this.saveUndoLevel&&(this.saveUndoLevel=0),void 0===this.notUndoableModifications&&(this.notUndoableModifications=!1),void 0===this.focusedView&&(this.focusedView=null),this.home=t,this.preferences=d,this.viewFactory=c,this.contentManager=p,this.application=null,this.undoSupport=new e.HomeController$0(this),this.undoManager=new javax.swing.undo.UndoManager,this.undoSupport.addUndoableEditListener(this.undoManager),this.notUndoableModifications=t.isModified(),null!=t.getName())!function(e){var i=e.indexOf(t.getName());i>=0&&e.splice(i,1)}(a=this.preferences.getRecentHomes().slice(0)),a.splice(0,0,t.getName()),this.updateUserPreferencesRecentHomes(a);void 0===this.home&&(this.home=null),void 0===this.preferences&&(this.preferences=null),void 0===this.application&&(this.application=null),void 0===this.viewFactory&&(this.viewFactory=null),void 0===this.contentManager&&(this.contentManager=null),void 0===this.undoSupport&&(this.undoSupport=null),void 0===this.undoManager&&(this.undoManager=null),void 0===this.homeView&&(this.homeView=null),void 0===this.childControllers&&(this.childControllers=null),void 0===this.furnitureCatalogController&&(this.furnitureCatalogController=null),void 0===this.furnitureController&&(this.furnitureController=null),void 0===this.planController&&(this.planController=null),void 0===this.homeController3D&&(this.homeController3D=null),void 0===this.saveUndoLevel&&(this.saveUndoLevel=0),void 0===this.notUndoableModifications&&(this.notUndoableModifications=!1),void 0===this.focusedView&&(this.focusedView=null)}else if((null!=t&&t instanceof Home||null===t)&&(null!=i&&i instanceof HomeApplication||null===i)&&(null!=n&&null!=n.constructor&&null!=n.constructor.__interfaces&&n.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0||null===n)&&void 0===o&&void 0===r){var g=(l=arguments)[2],m=arguments[1].getUserPreferences();if(void 0===this.home&&(this.home=null),void 0===this.preferences&&(this.preferences=null),void 0===this.application&&(this.application=null),void 0===this.viewFactory&&(this.viewFactory=null),void 0===this.contentManager&&(this.contentManager=null),void 0===this.undoSupport&&(this.undoSupport=null),void 0===this.undoManager&&(this.undoManager=null),void 0===this.homeView&&(this.homeView=null),void 0===this.childControllers&&(this.childControllers=null),void 0===this.furnitureCatalogController&&(this.furnitureCatalogController=null),void 0===this.furnitureController&&(this.furnitureController=null),void 0===this.planController&&(this.planController=null),void 0===this.homeController3D&&(this.homeController3D=null),void 0===this.saveUndoLevel&&(this.saveUndoLevel=0),void 0===this.notUndoableModifications&&(this.notUndoableModifications=!1),void 0===this.focusedView&&(this.focusedView=null),this.home=t,this.preferences=m,this.viewFactory=g,this.contentManager=null,this.application=i,this.undoSupport=new e.HomeController$0(this),this.undoManager=new javax.swing.undo.UndoManager,this.undoSupport.addUndoableEditListener(this.undoManager),this.notUndoableModifications=t.isModified(),null!=t.getName())!function(e){var i=e.indexOf(t.getName());i>=0&&e.splice(i,1)}(a=this.preferences.getRecentHomes().slice(0)),a.splice(0,0,t.getName()),this.updateUserPreferencesRecentHomes(a);void 0===this.home&&(this.home=null),void 0===this.preferences&&(this.preferences=null),void 0===this.application&&(this.application=null),void 0===this.viewFactory&&(this.viewFactory=null),void 0===this.contentManager&&(this.contentManager=null),void 0===this.undoSupport&&(this.undoSupport=null),void 0===this.undoManager&&(this.undoManager=null),void 0===this.homeView&&(this.homeView=null),void 0===this.childControllers&&(this.childControllers=null),void 0===this.furnitureCatalogController&&(this.furnitureCatalogController=null),void 0===this.furnitureController&&(this.furnitureController=null),void 0===this.planController&&(this.planController=null),void 0===this.homeController3D&&(this.homeController3D=null),void 0===this.saveUndoLevel&&(this.saveUndoLevel=0),void 0===this.notUndoableModifications&&(this.notUndoableModifications=!1),void 0===this.focusedView&&(this.focusedView=null)}else{if(!((null!=t&&t instanceof Home||null===t)&&(null!=i&&i instanceof UserPreferences||null===i)&&(null!=n&&null!=n.constructor&&null!=n.constructor.__interfaces&&n.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0||null===n)&&void 0===o&&void 0===r))throw new Error("invalid overload");var f=(l=arguments)[1],v=l[2];void 0===this.home&&(this.home=null),void 0===this.preferences&&(this.preferences=null),void 0===this.application&&(this.application=null),void 0===this.viewFactory&&(this.viewFactory=null),void 0===this.contentManager&&(this.contentManager=null),void 0===this.undoSupport&&(this.undoSupport=null),void 0===this.undoManager&&(this.undoManager=null),void 0===this.homeView&&(this.homeView=null),void 0===this.childControllers&&(this.childControllers=null),void 0===this.furnitureCatalogController&&(this.furnitureCatalogController=null),void 0===this.furnitureController&&(this.furnitureController=null),void 0===this.planController&&(this.planController=null),void 0===this.homeController3D&&(this.homeController3D=null),void 0===this.saveUndoLevel&&(this.saveUndoLevel=0),void 0===this.notUndoableModifications&&(this.notUndoableModifications=!1),void 0===this.focusedView&&(this.focusedView=null),this.home=t,this.preferences=f,this.viewFactory=v,this.contentManager=null,this.application=null,this.undoSupport=new e.HomeController$0(this),this.undoManager=new javax.swing.undo.UndoManager,this.undoSupport.addUndoableEditListener(this.undoManager),this.notUndoableModifications=t.isModified(),null!=t.getName()&&(!function(e){var i=e.indexOf(t.getName());i>=0&&e.splice(i,1)}(a=this.preferences.getRecentHomes().slice(0)),a.splice(0,0,t.getName()),this.updateUserPreferencesRecentHomes(a)),void 0===this.home&&(this.home=null),void 0===this.preferences&&(this.preferences=null),void 0===this.application&&(this.application=null),void 0===this.viewFactory&&(this.viewFactory=null),void 0===this.contentManager&&(this.contentManager=null),void 0===this.undoSupport&&(this.undoSupport=null),void 0===this.undoManager&&(this.undoManager=null),void 0===this.homeView&&(this.homeView=null),void 0===this.childControllers&&(this.childControllers=null),void 0===this.furnitureCatalogController&&(this.furnitureCatalogController=null),void 0===this.furnitureController&&(this.furnitureController=null),void 0===this.planController&&(this.planController=null),void 0===this.homeController3D&&(this.homeController3D=null),void 0===this.saveUndoLevel&&(this.saveUndoLevel=0),void 0===this.notUndoableModifications&&(this.notUndoableModifications=!1),void 0===this.focusedView&&(this.focusedView=null)}var _,S}return e.prototype.enableDefaultActions=function(e){var t=null!=this.application;e.setEnabled(HomeView.ActionType.NEW_HOME,t),e.setEnabled(HomeView.ActionType.NEW_HOME_FROM_EXAMPLE,t),e.setEnabled(HomeView.ActionType.OPEN,t),e.setEnabled(HomeView.ActionType.DELETE_RECENT_HOMES,t&&!(0==this.preferences.getRecentHomes().length)),e.setEnabled(HomeView.ActionType.CLOSE,t),e.setEnabled(HomeView.ActionType.SAVE,t),e.setEnabled(HomeView.ActionType.SAVE_AS,t),e.setEnabled(HomeView.ActionType.SAVE_AND_COMPRESS,t),e.setEnabled(HomeView.ActionType.PAGE_SETUP,!0),e.setEnabled(HomeView.ActionType.PRINT_PREVIEW,!0),e.setEnabled(HomeView.ActionType.PRINT,!0),e.setEnabled(HomeView.ActionType.PRINT_TO_PDF,!0),e.setEnabled(HomeView.ActionType.PREFERENCES,!0),e.setEnabled(HomeView.ActionType.EXIT,t),e.setEnabled(HomeView.ActionType.IMPORT_FURNITURE,!0),e.setEnabled(HomeView.ActionType.IMPORT_FURNITURE_LIBRARY,!0),e.setEnabled(HomeView.ActionType.IMPORT_TEXTURE,!0),e.setEnabled(HomeView.ActionType.IMPORT_TEXTURES_LIBRARY,!0),e.setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_CATALOG_ID,!0),e.setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_NAME,!0),e.setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_DESCRIPTION,!0),e.setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_CREATOR,!0),e.setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_LICENSE,!0),e.setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_WIDTH,!0),e.setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_HEIGHT,!0),e.setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_DEPTH,!0),e.setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_X,!0),e.setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_Y,!0),e.setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_ELEVATION,!0),e.setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_ANGLE,!0),e.setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_LEVEL,!0),e.setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_MODEL_SIZE,!0),e.setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_COLOR,!0),e.setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_TEXTURE,!0),e.setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_MOVABILITY,!0),e.setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_TYPE,!0),e.setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_VISIBILITY,!0),e.setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_PRICE,!0),e.setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_VALUE_ADDED_TAX_PERCENTAGE,!0),e.setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_VALUE_ADDED_TAX,!0),e.setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_PRICE_VALUE_ADDED_TAX_INCLUDED,!0),e.setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_DESCENDING_ORDER,null!=this.home.getFurnitureSortedPropertyName()),e.setEnabled(HomeView.ActionType.DISPLAY_HOME_FURNITURE_CATALOG_ID,!0),e.setEnabled(HomeView.ActionType.DISPLAY_HOME_FURNITURE_NAME,!0),e.setEnabled(HomeView.ActionType.DISPLAY_HOME_FURNITURE_DESCRIPTION,!0),e.setEnabled(HomeView.ActionType.DISPLAY_HOME_FURNITURE_CREATOR,!0),e.setEnabled(HomeView.ActionType.DISPLAY_HOME_FURNITURE_LICENSE,!0),e.setEnabled(HomeView.ActionType.DISPLAY_HOME_FURNITURE_WIDTH,!0),e.setEnabled(HomeView.ActionType.DISPLAY_HOME_FURNITURE_DEPTH,!0),e.setEnabled(HomeView.ActionType.DISPLAY_HOME_FURNITURE_HEIGHT,!0),e.setEnabled(HomeView.ActionType.DISPLAY_HOME_FURNITURE_X,!0),e.setEnabled(HomeView.ActionType.DISPLAY_HOME_FURNITURE_Y,!0),e.setEnabled(HomeView.ActionType.DISPLAY_HOME_FURNITURE_ELEVATION,!0),e.setEnabled(HomeView.ActionType.DISPLAY_HOME_FURNITURE_ANGLE,!0),e.setEnabled(HomeView.ActionType.DISPLAY_HOME_FURNITURE_LEVEL,!0),e.setEnabled(HomeView.ActionType.DISPLAY_HOME_FURNITURE_MODEL_SIZE,!0),e.setEnabled(HomeView.ActionType.DISPLAY_HOME_FURNITURE_COLOR,!0),e.setEnabled(HomeView.ActionType.DISPLAY_HOME_FURNITURE_TEXTURE,!0),e.setEnabled(HomeView.ActionType.DISPLAY_HOME_FURNITURE_MOVABLE,!0),e.setEnabled(HomeView.ActionType.DISPLAY_HOME_FURNITURE_DOOR_OR_WINDOW,!0),e.setEnabled(HomeView.ActionType.DISPLAY_HOME_FURNITURE_VISIBLE,!0),e.setEnabled(HomeView.ActionType.DISPLAY_HOME_FURNITURE_PRICE,!0),e.setEnabled(HomeView.ActionType.DISPLAY_HOME_FURNITURE_VALUE_ADDED_TAX_PERCENTAGE,!0),e.setEnabled(HomeView.ActionType.DISPLAY_HOME_FURNITURE_VALUE_ADDED_TAX,!0),e.setEnabled(HomeView.ActionType.DISPLAY_HOME_FURNITURE_PRICE_VALUE_ADDED_TAX_INCLUDED,!0);for(var i=this.home.getFurnitureAdditionalProperties(),n=0;n<i.length;n++){var o=i[n];e.setActionEnabled(HomeView.SORT_HOME_FURNITURE_ADDITIONAL_PROPERTY_ACTION_PREFIX+o.getName(),!0),e.setActionEnabled(HomeView.DISPLAY_HOME_FURNITURE_ADDITIONAL_PROPERTY_ACTION_PREFIX+o.getName(),!0)}e.setEnabled(HomeView.ActionType.EXPORT_TO_CSV,!0),e.setEnabled(HomeView.ActionType.SELECT,!0),e.setEnabled(HomeView.ActionType.PAN,!0),e.setEnabled(HomeView.ActionType.LOCK_BASE_PLAN,!0),e.setEnabled(HomeView.ActionType.UNLOCK_BASE_PLAN,!0),e.setEnabled(HomeView.ActionType.ENABLE_MAGNETISM,!0),e.setEnabled(HomeView.ActionType.DISABLE_MAGNETISM,!0),e.setEnabled(HomeView.ActionType.MODIFY_COMPASS,!0);var r=this.home.getSelectedLevel();this.enableBackgroungImageActions(e,null!=r?r.getBackgroundImage():this.home.getBackgroundImage()),this.enableLevelActions(e),e.setEnabled(HomeView.ActionType.ZOOM_IN,!0),e.setEnabled(HomeView.ActionType.ZOOM_OUT,!0),e.setEnabled(HomeView.ActionType.EXPORT_TO_SVG,!0),e.setEnabled(HomeView.ActionType.VIEW_FROM_TOP,!0),e.setEnabled(HomeView.ActionType.VIEW_FROM_OBSERVER,!0),e.setEnabled(HomeView.ActionType.MODIFY_OBSERVER,this.home.getCamera()===this.home.getObserverCamera()),e.setEnabled(HomeView.ActionType.STORE_POINT_OF_VIEW,!0);var l=0==this.home.getStoredCameras().length;e.setEnabled(HomeView.ActionType.DELETE_POINTS_OF_VIEW,!l),e.setEnabled(HomeView.ActionType.CREATE_PHOTOS_AT_POINTS_OF_VIEW,!l),e.setEnabled(HomeView.ActionType.DETACH_3D_VIEW,!0),e.setEnabled(HomeView.ActionType.ATTACH_3D_VIEW,!0),e.setEnabled(HomeView.ActionType.VIEW_FROM_OBSERVER,!0),e.setEnabled(HomeView.ActionType.MODIFY_3D_ATTRIBUTES,!0),e.setEnabled(HomeView.ActionType.CREATE_PHOTO,!0),e.setEnabled(HomeView.ActionType.CREATE_VIDEO,!0),e.setEnabled(HomeView.ActionType.EXPORT_TO_OBJ,!0),e.setEnabled(HomeView.ActionType.HELP,!0),e.setEnabled(HomeView.ActionType.ABOUT,!0),this.enableCreationToolsActions(e),e.setTransferEnabled(!0)},e.prototype.enableLevelActions=function(e){var t=this.getPlanController().isModificationState();e.setEnabled(HomeView.ActionType.ADD_LEVEL,!t),e.setEnabled(HomeView.ActionType.ADD_LEVEL_AT_SAME_ELEVATION,!t);var i=this.home.getLevels(),n=this.home.getSelectedLevel(),o=i.length>1&&null!=n;e.setEnabled(HomeView.ActionType.SELECT_ALL_AT_ALL_LEVELS,!t&&i.length>1),e.setEnabled(HomeView.ActionType.MAKE_LEVEL_VIEWABLE,!t&&o),e.setEnabled(HomeView.ActionType.MAKE_LEVEL_UNVIEWABLE,!t&&o),e.setEnabled(HomeView.ActionType.MAKE_LEVEL_ONLY_VIEWABLE_ONE,o),e.setEnabled(HomeView.ActionType.MAKE_ALL_LEVELS_VIEWABLE,i.length>1),e.setEnabled(HomeView.ActionType.MODIFY_LEVEL,o),e.setEnabled(HomeView.ActionType.DELETE_LEVEL,!t&&o),e.setEnabled(HomeView.ActionType.DISPLAY_ALL_LEVELS,i.length>1),e.setEnabled(HomeView.ActionType.DISPLAY_SELECTED_LEVEL,i.length>1)},e.prototype.enableCreationToolsActions=function(e){var t=this.home.getSelectedLevel(),i=null==t||t.isViewable();e.setEnabled(HomeView.ActionType.CREATE_WALLS,i),e.setEnabled(HomeView.ActionType.CREATE_ROOMS,i),e.setEnabled(HomeView.ActionType.CREATE_POLYLINES,i),e.setEnabled(HomeView.ActionType.CREATE_DIMENSION_LINES,i),e.setEnabled(HomeView.ActionType.CREATE_LABELS,i)},e.prototype.getView=function(){var t=this;return null==this.homeView&&(this.homeView=this.viewFactory.createHomeView(this.home,this.preferences,this),this.enableDefaultActions(this.homeView),this.addListeners(),null!=this.home.getName()&&this.home.getVersion()>Home.CURRENT_VERSION&&this.homeView.invokeLater((function(){var i=t.preferences.getLocalizedString(e,"moreRecentVersionHome",t.home.getName());t.getView().showMessage(i)}))),this.homeView},e.prototype.getContentManager=function(){return this.contentManager},e.prototype.getFurnitureCatalogController=function(){return null==this.furnitureCatalogController&&(this.furnitureCatalogController=new FurnitureCatalogController(this.preferences.getFurnitureCatalog(),this.preferences,this.viewFactory,this.contentManager)),this.furnitureCatalogController},e.prototype.getFurnitureController=function(){return null==this.furnitureController&&(this.furnitureController=new FurnitureController(this.home,this.preferences,this.viewFactory,this.contentManager,this.getUndoableEditSupport())),this.furnitureController},e.prototype.getPlanController=function(){return null==this.planController&&(this.planController=new PlanController(this.home,this.preferences,this.viewFactory,this.contentManager,this.getUndoableEditSupport())),this.planController},e.prototype.getHomeController3D=function(){return null==this.homeController3D&&(this.homeController3D=new HomeController3D(this.home,this.getPlanController(),this.preferences,this.viewFactory,this.contentManager,this.getUndoableEditSupport())),this.homeController3D},e.prototype.getUndoableEditSupport=function(){return this.undoSupport},e.prototype.addListeners=function(){var t;this.preferences.getFurnitureCatalog().addFurnitureListener(null==(t=new e.FurnitureCatalogChangeListener(this))||"function"==typeof t?t:function(e){return(t.collectionChanged?t.collectionChanged:t).call(t,e)}),this.preferences.getTexturesCatalog().addTexturesListener(function(e){return null==e||"function"==typeof e?e:function(t){return(e.collectionChanged?e.collectionChanged:e).call(e,t)}}(new e.TexturesCatalogChangeListener(this))),this.preferences.addPropertyChangeListener(new e.UserPreferencesPropertiesChangeListener(this)),this.addCatalogSelectionListener(),this.addHomeBackgroundImageListener(),this.addNotUndoableModificationListeners(),this.addHomeSelectionListener(),this.addFurnitureSortListener(),this.addUndoSupportListener(),this.addHomeItemsListener(),this.addLevelListeners(),this.addStoredCamerasListener(),this.addPlanControllerListeners(),this.addLanguageListener()},e.prototype.addCatalogSelectionListener=function(){this.getFurnitureCatalogController().addSelectionListener(new e.HomeController$1(this))},e.prototype.addLanguageListener=function(){this.preferences.addPropertyChangeListener("LANGUAGE",new e.LanguageChangeListener(this))},e.prototype.addHomeSelectionListener=function(){null!=this.home&&this.home.addSelectionListener(new e.HomeController$2(this))},e.prototype.addFurnitureSortListener=function(){null!=this.home&&this.home.addPropertyChangeListener("FURNITURE_SORTED_PROPERTY",new e.HomeController$3(this))},e.prototype.addHomeBackgroundImageListener=function(){null!=this.home&&this.home.addPropertyChangeListener("BACKGROUND_IMAGE",new e.HomeController$4(this))},e.prototype.enableBackgroungImageActions=function(e,t){var i=this.home.getSelectedLevel(),n=null!=t&&(null==i||i.isViewable());this.getView().setEnabled(HomeView.ActionType.IMPORT_BACKGROUND_IMAGE,!n),this.getView().setEnabled(HomeView.ActionType.MODIFY_BACKGROUND_IMAGE,n),this.getView().setEnabled(HomeView.ActionType.HIDE_BACKGROUND_IMAGE,n&&t.isVisible()),this.getView().setEnabled(HomeView.ActionType.SHOW_BACKGROUND_IMAGE,n&&!t.isVisible()),this.getView().setEnabled(HomeView.ActionType.DELETE_BACKGROUND_IMAGE,n)},e.prototype.addNotUndoableModificationListeners=function(){if(null!=this.home){var t=new e.HomeController$5(this);this.home.addPropertyChangeListener("STORED_CAMERAS",t),this.home.getEnvironment().addPropertyChangeListener("OBSERVER_CAMERA_ELEVATION_ADJUSTED",t),this.home.getEnvironment().addPropertyChangeListener("VIDEO_WIDTH",t),this.home.getEnvironment().addPropertyChangeListener("VIDEO_ASPECT_RATIO",t),this.home.getEnvironment().addPropertyChangeListener("VIDEO_FRAME_RATE",t),this.home.getEnvironment().addPropertyChangeListener("VIDEO_QUALITY",t),this.home.getEnvironment().addPropertyChangeListener("VIDEO_CAMERA_PATH",t),this.home.getEnvironment().addPropertyChangeListener("CEILING_LIGHT_COLOR",t),this.home.getEnvironment().addPropertyChangeListener("PHOTO_QUALITY",t),this.home.getEnvironment().addPropertyChangeListener("PHOTO_ASPECT_RATIO",t);var i=new e.HomeController$6(this,t);this.home.getEnvironment().addPropertyChangeListener("PHOTO_WIDTH",i),this.home.getEnvironment().addPropertyChangeListener("PHOTO_HEIGHT",i);var n=new e.HomeController$7(this,t);this.home.getObserverCamera().addPropertyChangeListener(n),this.home.getTopCamera().addPropertyChangeListener(n)}},e.prototype.enableActionsBoundToSelection=function(){var e=this.getPlanController().isModificationState(),t=this.getFurnitureCatalogController().getSelectedFurniture(),i=!(0==t.length),n=1===t.length&&t[0].isModifiable(),o=this.home.getSelectedItems(),r=!1,l=!1,a=!1,s=!1,h=!1,u=!1,d=!1,c=!1,p=1===o.length&&null!=o[0]&&o[0]instanceof HomeFurnitureGroup,g=!1,m=!1,f=!1,v=!1,_=!1,S=!1,y=!1,E=!1,C=!1,P=!1,w=!1,L=!1,T=this.getFurnitureController();if(!e){for(var A=0;A<o.length;A++){var I=o[A];if(this.getPlanController().isItemDeletable(I)){r=!0;break}}var b=Home.getFurnitureSubList(o);l=!(0==b.length);for(A=0;A<b.length;A++){var O=b[A];if(T.isPieceOfFurnitureDeletable(O)){a=!0;break}}for(A=0;A<b.length;A++){if(null!=(O=b[A])&&O instanceof HomeFurnitureGroup){g=!0;break}}var M=0;for(A=0;A<b.length;A++){O=b[A];if(T.isPieceOfFurnitureMovable(O)&&(h=!0,++M>=2&&(u=!0),M>=3)){c=!0;break}}if(u){d=!0;var D=this.home.getFurniture();for(A=0;A<b.length;A++){O=b[A];if(!(T.isPieceOfFurnitureMovable(O)&&D.indexOf(O)>=0)){d=!1;break}}}var R=Home.getWallsSubList(o);if(m=!(0==R.length),f=1===R.length,R.length>=2){var F=[null,null,null];for(A=0;A<R.length;A++){var x=R[A];if(!(null!=x.getArcExtent()&&0!==x.getArcExtent()||null!=x.getWallAtStart()&&null!=x.getWallAtEnd())){for(var N=0;N<F.length;N++)if(null==F[N]){F[N]=x;break}if(null!=F[2])break}}v=!(null!=F[2]||null==F[0]||(null!=F[1]||R.indexOf(F[0].getWallAtStart())>=0||R.indexOf(F[0].getWallAtEnd())>=0)&&(F[0].getWallAtEnd()===F[1]||F[0].getWallAtStart()===F[1]))}var k=Home.getRoomsSubList(o);_=!(0==k.length),y=(S=1===o.length&&1===k.length)&&k[0].getPointCount()>=4,C=!(0==Home.getDimensionLinesSubList(o).length),E=!(0==Home.getPolylinesSubList(o).length),P=!(0==Home.getLabelsSubList(o).length),L=o.indexOf(this.home.getCompass())>=0,s=l||m||_||C||E||P||L,w=l||_||C||P}var H=this.getView();if(this.focusedView===this.getFurnitureCatalogController().getView()){H.setEnabled(HomeView.ActionType.COPY,!e&&i),H.setEnabled(HomeView.ActionType.CUT,!1),H.setEnabled(HomeView.ActionType.DELETE,!1);for(A=0;A<t.length;A++){if((O=t[A]).isModifiable()){H.setEnabled(HomeView.ActionType.DELETE,!0);break}}}else this.focusedView===T.getView()?(H.setEnabled(HomeView.ActionType.COPY,l),H.setEnabled(HomeView.ActionType.CUT,a),H.setEnabled(HomeView.ActionType.DELETE,a)):this.focusedView===this.getPlanController().getView()||this.focusedView===this.getHomeController3D().getView()&&this.preferences.isEditingIn3DViewEnabled()?(H.setEnabled(HomeView.ActionType.COPY,s),H.setEnabled(HomeView.ActionType.CUT,r),H.setEnabled(HomeView.ActionType.DELETE,r)):(H.setEnabled(HomeView.ActionType.COPY,!1),H.setEnabled(HomeView.ActionType.CUT,!1),H.setEnabled(HomeView.ActionType.DELETE,!1));this.enablePasteToGroupAction(),this.enablePasteStyleAction();var V=this.home.getSelectedLevel(),U=null==V||V.isViewable();H.setEnabled(HomeView.ActionType.ADD_HOME_FURNITURE,i&&U),H.setEnabled(HomeView.ActionType.ADD_FURNITURE_TO_GROUP,i&&U&&p),H.setEnabled(HomeView.ActionType.DELETE_HOME_FURNITURE,a),H.setEnabled(HomeView.ActionType.DELETE_SELECTION,i&&this.focusedView===this.getFurnitureCatalogController().getView()||r&&(this.focusedView===T.getView()||this.focusedView===this.getPlanController().getView()||this.focusedView===this.getHomeController3D().getView())),H.setEnabled(HomeView.ActionType.MODIFY_FURNITURE,n&&this.focusedView===this.getFurnitureCatalogController().getView()||l&&(this.focusedView===T.getView()||this.focusedView===this.getPlanController().getView()||this.focusedView===this.getHomeController3D().getView())),H.setEnabled(HomeView.ActionType.MODIFY_WALL,m),H.setEnabled(HomeView.ActionType.FLIP_HORIZONTALLY,s),H.setEnabled(HomeView.ActionType.FLIP_VERTICALLY,s),H.setEnabled(HomeView.ActionType.JOIN_WALLS,v),H.setEnabled(HomeView.ActionType.REVERSE_WALL_DIRECTION,m),H.setEnabled(HomeView.ActionType.SPLIT_WALL,f),H.setEnabled(HomeView.ActionType.MODIFY_ROOM,_),H.setEnabled(HomeView.ActionType.MODIFY_POLYLINE,E),H.setEnabled(HomeView.ActionType.MODIFY_DIMENSION_LINE,C),H.setEnabled(HomeView.ActionType.MODIFY_LABEL,P),H.setEnabled(HomeView.ActionType.TOGGLE_BOLD_STYLE,w),H.setEnabled(HomeView.ActionType.TOGGLE_ITALIC_STYLE,w),H.setEnabled(HomeView.ActionType.INCREASE_TEXT_SIZE,w),H.setEnabled(HomeView.ActionType.DECREASE_TEXT_SIZE,w),H.setEnabled(HomeView.ActionType.ALIGN_FURNITURE_ON_TOP,u),H.setEnabled(HomeView.ActionType.ALIGN_FURNITURE_ON_BOTTOM,u),H.setEnabled(HomeView.ActionType.ALIGN_FURNITURE_ON_LEFT,u),H.setEnabled(HomeView.ActionType.ALIGN_FURNITURE_ON_RIGHT,u),H.setEnabled(HomeView.ActionType.ALIGN_FURNITURE_ON_FRONT_SIDE,u),H.setEnabled(HomeView.ActionType.ALIGN_FURNITURE_ON_BACK_SIDE,u),H.setEnabled(HomeView.ActionType.ALIGN_FURNITURE_ON_LEFT_SIDE,u),H.setEnabled(HomeView.ActionType.ALIGN_FURNITURE_ON_RIGHT_SIDE,u),H.setEnabled(HomeView.ActionType.ALIGN_FURNITURE_SIDE_BY_SIDE,u),H.setEnabled(HomeView.ActionType.DISTRIBUTE_FURNITURE_HORIZONTALLY,c),H.setEnabled(HomeView.ActionType.DISTRIBUTE_FURNITURE_VERTICALLY,c),H.setEnabled(HomeView.ActionType.RESET_FURNITURE_ELEVATION,h),H.setEnabled(HomeView.ActionType.GROUP_FURNITURE,d&&U),H.setEnabled(HomeView.ActionType.UNGROUP_FURNITURE,g);var W=null!=this.getPlanController()&&this.getPlanController().getMode()===PlanController.Mode.SELECTION_$LI$();H.setEnabled(HomeView.ActionType.ADD_ROOM_POINT,S&&W),H.setEnabled(HomeView.ActionType.DELETE_ROOM_POINT,y&&W),H.setEnabled(HomeView.ActionType.RECOMPUTE_ROOM_POINTS,y&&W)},e.prototype.enablePasteAction=function(){var e=this.getView(),t=!1;if(this.focusedView===this.getFurnitureController().getView()||this.focusedView===this.getPlanController().getView()||this.focusedView===this.getHomeController3D().getView()&&this.preferences.isEditingIn3DViewEnabled()){var i=this.home.getSelectedLevel();t=(null==i||i.isViewable())&&!this.getPlanController().isModificationState()&&!e.isClipboardEmpty()}e.setEnabled(HomeView.ActionType.PASTE,t),this.enablePasteToGroupAction(),this.enablePasteStyleAction()},e.prototype.enablePasteToGroupAction=function(){var e=this.getView(),t=!1;if(this.focusedView===this.getFurnitureController().getView()||this.focusedView===this.getPlanController().getView()){var i=this.home.getSelectedLevel();if((null==i||i.isViewable())&&!this.getPlanController().isModificationState()){var n=this.home.getSelectedItems();if(1===n.length&&null!=n[0]&&n[0]instanceof HomeFurnitureGroup){var o=e.getClipboardItems();if(null!=o){t=!0;for(var r=0;r<o.length;r++){var l=o[r];if(!(null!=l&&l instanceof HomePieceOfFurniture)){t=!1;break}}}}}}e.setEnabled(HomeView.ActionType.PASTE_TO_GROUP,t)},e.prototype.enablePasteStyleAction=function(){var e=this.getView(),t=!1;if((this.focusedView===this.getFurnitureController().getView()||this.focusedView===this.getPlanController().getView()||this.focusedView===this.getHomeController3D().getView()&&this.preferences.isEditingIn3DViewEnabled())&&!this.getPlanController().isModificationState()){var i=e.getClipboardItems();if(null!=i&&1===i.length)for(var n=i[0],o=this.home.getSelectedItems(),r=0;r<o.length;r++){var l=o[r];if(null!=l&&l instanceof HomePieceOfFurniture&&null!=n&&n instanceof HomePieceOfFurniture||null!=l&&l instanceof Wall&&null!=n&&n instanceof Wall||null!=l&&l instanceof Room&&null!=n&&n instanceof Room||null!=l&&l instanceof Polyline&&null!=n&&n instanceof Polyline||null!=l&&l instanceof Label&&null!=n&&n instanceof Label){t=!0;break}}}e.setEnabled(HomeView.ActionType.PASTE_STYLE,t)},e.prototype.enableSelectAllAction=function(){var e=this.getView(),t=this.getPlanController().isModificationState();if(this.focusedView===this.getFurnitureController().getView())e.setEnabled(HomeView.ActionType.SELECT_ALL,!t&&this.home.getFurniture().length>0);else if(this.focusedView===this.getPlanController().getView()||this.focusedView===this.getHomeController3D().getView()){var i=!this.home.isEmpty()||this.home.getCompass().isVisible();e.setEnabled(HomeView.ActionType.SELECT_ALL,!t&&i)}else e.setEnabled(HomeView.ActionType.SELECT_ALL,!1)},e.prototype.enableZoomActions=function(){var e=this.getPlanController(),t=e.getScale(),i=this.getView();i.setEnabled(HomeView.ActionType.ZOOM_IN,t<e.getMaximumScale()),i.setEnabled(HomeView.ActionType.ZOOM_OUT,t>e.getMinimumScale())},e.prototype.addUndoSupportListener=function(){this.getUndoableEditSupport().addUndoableEditListener(new e.HomeController$8(this)),this.home.addPropertyChangeListener("MODIFIED",new e.HomeController$9(this))},e.prototype.addHomeItemsListener=function(){var t,i=this,n=function(e){e.getType()!==CollectionEvent.Type.ADD&&e.getType()!==CollectionEvent.Type.DELETE||i.enableSelectAllAction()};this.home.addFurnitureListener(function(e){return null==e||"function"==typeof e?e:function(t){return(e.collectionChanged?e.collectionChanged:e).call(e,t)}}(null==(t=n)||"function"==typeof t?t:function(e){return(t.collectionChanged?t.collectionChanged:t).call(t,e)})),this.home.addWallsListener(function(e){return null==e||"function"==typeof e?e:function(t){return(e.collectionChanged?e.collectionChanged:e).call(e,t)}}(function(e){return null==e||"function"==typeof e?e:function(t){return(e.collectionChanged?e.collectionChanged:e).call(e,t)}}(n))),this.home.addRoomsListener(function(e){return null==e||"function"==typeof e?e:function(t){return(e.collectionChanged?e.collectionChanged:e).call(e,t)}}(function(e){return null==e||"function"==typeof e?e:function(t){return(e.collectionChanged?e.collectionChanged:e).call(e,t)}}(n))),this.home.addPolylinesListener(function(e){return null==e||"function"==typeof e?e:function(t){return(e.collectionChanged?e.collectionChanged:e).call(e,t)}}(function(e){return null==e||"function"==typeof e?e:function(t){return(e.collectionChanged?e.collectionChanged:e).call(e,t)}}(n))),this.home.addDimensionLinesListener(function(e){return null==e||"function"==typeof e?e:function(t){return(e.collectionChanged?e.collectionChanged:e).call(e,t)}}(function(e){return null==e||"function"==typeof e?e:function(t){return(e.collectionChanged?e.collectionChanged:e).call(e,t)}}(n))),this.home.addLabelsListener(function(e){return null==e||"function"==typeof e?e:function(t){return(e.collectionChanged?e.collectionChanged:e).call(e,t)}}(function(e){return null==e||"function"==typeof e?e:function(t){return(e.collectionChanged?e.collectionChanged:e).call(e,t)}}(n))),this.home.getCompass().addPropertyChangeListener(new e.HomeController$10(this)),this.home.addPropertyChangeListener("CAMERA",new e.HomeController$11(this))},e.prototype.addLevelListeners=function(){var t=this,i=new e.HomeController$12(this);this.home.addPropertyChangeListener("SELECTED_LEVEL",i);for(var n=new e.HomeController$13(this),o=this.home.getLevels(),r=0;r<o.length;r++){o[r].addPropertyChangeListener(n)}this.home.addLevelsListener((function(e){switch(e.getType()){case CollectionEvent.Type.ADD:t.home.setSelectedLevel(e.getItem()),e.getItem().addPropertyChangeListener(n);break;case CollectionEvent.Type.DELETE:i.propertyChange(null),e.getItem().removePropertyChangeListener(n)}}))},e.prototype.addStoredCamerasListener=function(){this.home.addPropertyChangeListener("STORED_CAMERAS",new e.HomeController$14(this))},e.prototype.addPlanControllerListeners=function(){this.getPlanController().addPropertyChangeListener("MODIFICATION_STATE",new e.HomeController$15(this)),this.getPlanController().addPropertyChangeListener("MODE",new e.HomeController$16(this)),this.getPlanController().addPropertyChangeListener("SCALE",new e.HomeController$17(this))},e.prototype.addHomeFurniture=function(){this.addFurniture(null)},e.prototype.addFurnitureToGroup=function(){this.addFurniture(this.home.getSelectedItems()[0])},e.prototype.addFurniture=function(e){this.getPlanController().setMode(PlanController.Mode.SELECTION_$LI$());var t=this.getFurnitureCatalogController().getSelectedFurniture();if(0!=t.length){for(var i=[],n=0;n<t.length;n++){var o=t[n];i.push(this.getFurnitureController().createHomePieceOfFurniture(o))}null!=e?this.getFurnitureController().addFurnitureToGroup(i,e):this.getFurnitureController().addFurniture$java_util_List(i),this.adjustFurnitureSizeAndElevation(i,!1)}},e.prototype.modifySelectedFurniture=function(){this.focusedView===this.getFurnitureCatalogController().getView()?this.getFurnitureCatalogController().modifySelectedFurniture():this.focusedView!==this.getFurnitureController().getView()&&this.focusedView!==this.getPlanController().getView()&&this.focusedView!==this.getHomeController3D().getView()||this.getFurnitureController().modifySelectedFurniture()},e.prototype.importLanguageLibrary$=function(){var e=this;this.getView().invokeLater((function(){var t=e.getView().showImportLanguageLibraryDialog();null!=t&&e.importLanguageLibrary$java_lang_String(t)}))},e.prototype.importLanguageLibrary$java_lang_String=function(t){try{this.preferences.languageLibraryExists(t)&&!this.getView().confirmReplaceLanguageLibrary(t)||this.preferences.addLanguageLibrary(t)}catch(n){var i=this.preferences.getLocalizedString(e,"importLanguageLibraryError",t);this.getView().showError(i)}},e.prototype.importLanguageLibrary=function(e){if("string"==typeof e||null===e)return this.importLanguageLibrary$java_lang_String(e);if(void 0===e)return this.importLanguageLibrary$();throw new Error("invalid overload")},e.prototype.importFurniture=function(){this.getPlanController().setMode(PlanController.Mode.SELECTION_$LI$()),this.focusedView===this.getFurnitureCatalogController().getView()?this.getFurnitureCatalogController().importFurniture$():this.getFurnitureController().importFurniture$()},e.prototype.importFurnitureLibrary$=function(){var e=this;this.getView().invokeLater((function(){var t=e.getView().showImportFurnitureLibraryDialog();null!=t&&e.importFurnitureLibrary$java_lang_String(t)}))},e.prototype.importFurnitureLibrary$java_lang_String=function(t){try{this.preferences.furnitureLibraryExists(t)&&!this.getView().confirmReplaceFurnitureLibrary(t)||(this.preferences.addFurnitureLibrary(t),this.getView().showMessage(this.preferences.getLocalizedString(e,"importedFurnitureLibraryMessage",null!=this.contentManager?this.contentManager.getPresentationName(t,ContentManager.ContentType.FURNITURE_LIBRARY):t)))}catch(n){var i=this.preferences.getLocalizedString(e,"importFurnitureLibraryError",t);this.getView().showError(i)}},e.prototype.importFurnitureLibrary=function(e){if("string"==typeof e||null===e)return this.importFurnitureLibrary$java_lang_String(e);if(void 0===e)return this.importFurnitureLibrary$();throw new Error("invalid overload")},e.prototype.importTexture=function(){new ImportedTextureWizardController(this.preferences,this.viewFactory,this.contentManager).displayView(this.getView())},e.prototype.importTexturesLibrary$=function(){var e=this;this.getView().invokeLater((function(){var t=e.getView().showImportTexturesLibraryDialog();null!=t&&e.importTexturesLibrary$java_lang_String(t)}))},e.prototype.importTexturesLibrary$java_lang_String=function(t){try{this.preferences.texturesLibraryExists(t)&&!this.getView().confirmReplaceTexturesLibrary(t)||(this.preferences.addTexturesLibrary(t),this.getView().showMessage(this.preferences.getLocalizedString(e,"importedTexturesLibraryMessage",null!=this.contentManager?this.contentManager.getPresentationName(t,ContentManager.ContentType.TEXTURES_LIBRARY):t)))}catch(n){var i=this.preferences.getLocalizedString(e,"importTexturesLibraryError",t);this.getView().showError(i)}},e.prototype.importTexturesLibrary=function(e){if("string"==typeof e||null===e)return this.importTexturesLibrary$java_lang_String(e);if(void 0===e)return this.importTexturesLibrary$();throw new Error("invalid overload")},e.prototype.undo=function(){this.undoManager.undo();var e=this.getView(),t=this.undoManager.canUndo();e.setEnabled(HomeView.ActionType.UNDO,t),e.setEnabled(HomeView.ActionType.REDO,!0),t?e.setUndoRedoName(this.undoManager.getUndoPresentationName(),this.undoManager.getRedoPresentationName()):e.setUndoRedoName(null,this.undoManager.getRedoPresentationName()),this.saveUndoLevel--,this.home.setModified(0!==this.saveUndoLevel||this.notUndoableModifications)},e.prototype.redo=function(){this.undoManager.redo();var e=this.getView(),t=this.undoManager.canRedo();e.setEnabled(HomeView.ActionType.UNDO,!0),e.setEnabled(HomeView.ActionType.REDO,t),t?e.setUndoRedoName(this.undoManager.getUndoPresentationName(),this.undoManager.getRedoPresentationName()):e.setUndoRedoName(this.undoManager.getUndoPresentationName(),null),this.saveUndoLevel++,this.home.setModified(0!==this.saveUndoLevel||this.notUndoableModifications)},e.prototype.cut=function(t){var i=this.getUndoableEditSupport();i.beginUpdate(),this.getPlanController().deleteItems(t),i.postEdit(new LocalizedUndoableEdit(this.preferences,e,"undoCutName")),i.endUpdate()},e.prototype.paste=function(e){var t=this.home.getSelectedItems(),i=0;if(e.length===t.length){i=20;for(var n=0;n<e.length;n++){for(var o=e[n].getPoints(),r=!1,l=0;l<t.length;l++){var a=t[l];if(JSON.stringify(o)===JSON.stringify(a.getPoints())){r=!0;break}}if(!r){i=0;break}}}this.addPastedItems(e,null,i,i,null,"undoPasteName")},e.prototype.drop$java_util_List$float$float=function(e,t,i){this.drop$java_util_List$com_eteks_sweethome3d_viewcontroller_View$float$float(e,null,t,i)},e.prototype.drop$java_util_List$com_eteks_sweethome3d_viewcontroller_View$float$float=function(e,t,i,n){this.addPastedItems(e,t,i,n,null,"undoDropName")},e.prototype.drop$java_util_List$com_eteks_sweethome3d_viewcontroller_View$com_eteks_sweethome3d_model_Level$float$float$java_lang_Float=function(t,i,n,o,r,l){var a=this.home.getSelectedLevel();if(n!==a||null!=l&&1===t.length&&null!=t[0]&&t[0]instanceof HomePieceOfFurniture&&this.application.getUserPreferences().isMagnetismEnabled()){var s=this.getUndoableEditSupport();if(s.beginUpdate(),t[0].setElevation(Math.max(0,l)),n!==a){var h=this.home.getSelectedItems().slice(0),u=this.home.isAllLevelsSelection();this.home.setSelectedLevel(n),s.postEdit(new e.LevelModificationUndoableEdit(this.home,this.preferences,a,n,h,u))}this.drop$java_util_List$com_eteks_sweethome3d_viewcontroller_View$float$float(t,i,o,r),s.postEdit(new LocalizedUndoableEdit(this.preferences,e,"undoDropName")),s.endUpdate()}else this.drop$java_util_List$com_eteks_sweethome3d_viewcontroller_View$float$float(t,i,o,r)},e.prototype.drop=function(e,t,i,n,o,r){if(!((null!=e&&e instanceof Array||null===e)&&(null!=t&&null!=t.constructor&&null!=t.constructor.__interfaces&&t.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.View")>=0||null===t)&&(null!=i&&i instanceof Level||null===i))||"number"!=typeof n&&null!==n||"number"!=typeof o&&null!==o||"number"!=typeof r&&null!==r){if(!(null!=e&&e instanceof Array||null===e)||!(null!=t&&null!=t.constructor&&null!=t.constructor.__interfaces&&t.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.View")>=0||null===t)||"number"!=typeof i&&null!==i||"number"!=typeof n&&null!==n||void 0!==o||void 0!==r){if((null!=e&&e instanceof Array||null===e)&&(null!=t&&null!=t.constructor&&null!=t.constructor.__interfaces&&t.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.View")>=0||null===t)&&(null!=i&&null!=i.constructor&&null!=i.constructor.__interfaces&&i.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Selectable")>=0||null===i)&&void 0===n&&void 0===o&&void 0===r)return this.drop$java_util_List$com_eteks_sweethome3d_viewcontroller_View$com_eteks_sweethome3d_model_Selectable(e,t,i);if(!(null!=e&&e instanceof Array||null===e)||"number"!=typeof t&&null!==t||"number"!=typeof i&&null!==i||void 0!==n||void 0!==o||void 0!==r)throw new Error("invalid overload");return this.drop$java_util_List$float$float(e,t,i)}return this.drop$java_util_List$com_eteks_sweethome3d_viewcontroller_View$float$float(e,t,i,n)}return this.drop$java_util_List$com_eteks_sweethome3d_viewcontroller_View$com_eteks_sweethome3d_model_Level$float$float$java_lang_Float(e,t,i,n,o,r)},e.prototype.drop$java_util_List$com_eteks_sweethome3d_viewcontroller_View$com_eteks_sweethome3d_model_Selectable=function(e,t,i){this.addPastedItems(e,t,0,0,i,"undoDropName")},e.prototype.addPastedItems=function(t,i,n,o,r,l){if(t.length>1||1===t.length&&!(null!=t[0]&&t[0]instanceof Compass)){var a=Home.getSubList(t,Compass);0!==a.length&&function(e,t){for(var i=!1,n=0;n<t.length;n++){var o=e.indexOf(t[n]);o>=0&&(e.splice(o,1),i=!0)}}(t=t.slice(0),a),this.getPlanController().setMode(PlanController.Mode.SELECTION_$LI$());var s=this.getUndoableEditSupport();s.beginUpdate(),null!=i&&i===this.getFurnitureController().getView()?this.getFurnitureController().addFurniture$java_util_List$com_eteks_sweethome3d_model_HomePieceOfFurniture(Home.getFurnitureSubList(t),r):this.getPlanController().addItems(t);var h=Home.getFurnitureSubList(t);this.adjustFurnitureSizeAndElevation(h,0===n&&0===o&&null==i),this.getPlanController().moveItems(t,n,o),i!==this.getPlanController().getView()&&i!==this.getHomeController3D().getView()||this.preferences.isMagnetismEnabled()&&1===t.length&&1===h.length&&this.getPlanController().adjustMagnetizedPieceOfFurniture(t[0],n,o),s.postEdit(new LocalizedUndoableEdit(this.preferences,e,l)),s.endUpdate()}},e.prototype.adjustFurnitureSizeAndElevation=function(e,t){if(this.preferences.isMagnetismEnabled())for(var i=0;i<e.length;i++){var n=e[i];null!=n&&n instanceof HomeFurnitureGroup||!n.isResizable()||(n.setWidth(this.preferences.getLengthUnit().getMagnetizedLength(n.getWidth(),.1)),null!=n&&n instanceof HomeDoorOrWindow&&t||n.setDepth(this.preferences.getLengthUnit().getMagnetizedLength(n.getDepth(),.1)),n.setHeight(this.preferences.getLengthUnit().getMagnetizedLength(n.getHeight(),.1))),n.setElevation(this.preferences.getLengthUnit().getMagnetizedLength(n.getElevation(),.1))}},e.prototype.dropFiles=function(t,i,n){this.getPlanController().setMode(PlanController.Mode.SELECTION_$LI$());var o,r=[],l=function(e){r.push(e.getItem())};this.home.addFurnitureListener(null==(o=l)||"function"==typeof o?o:function(e){return(o.collectionChanged?o.collectionChanged:o).call(o,e)});var a=this.getUndoableEditSupport();a.beginUpdate();for(var s=0;s<t.length;s++){var h=t[s];this.getFurnitureController().importFurniture$java_lang_String(h)}this.home.removeFurnitureListener(function(e){return null==e||"function"==typeof e?e:function(t){return(e.collectionChanged?e.collectionChanged:e).call(e,t)}}(l)),r.length>0&&(this.getPlanController().moveItems(r,i,n),this.home.setSelectedItems(r),a.postEdit(new e.DroppingEndUndoableEdit(this.home,this.preferences,r.slice(0)))),a.endUpdate()},e.prototype.pasteToGroup=function(){var t=this.getUndoableEditSupport();t.beginUpdate();var i=Home.getFurnitureSubList(this.getView().getClipboardItems());this.getFurnitureController().addFurnitureToGroup(i,this.home.getSelectedItems()[0]),this.adjustFurnitureSizeAndElevation(i,!0),t.postEdit(new LocalizedUndoableEdit(this.preferences,e,"undoPasteToGroupName")),t.endUpdate()},e.prototype.pasteStyle=function(){var t=this.getUndoableEditSupport();t.beginUpdate();var i=this.getView().getClipboardItems()[0],n=this.home.getSelectedItems();if(null!=i&&i instanceof HomePieceOfFurniture){var o=i,r=new HomeFurnitureController(this.home,this.preferences,this.viewFactory,this.contentManager,t);null!=o.getModelMaterials()?(r.getModelMaterialsController().setMaterials(o.getModelMaterials()),r.setPaint(HomeFurnitureController.FurniturePaint.MODEL_MATERIALS)):null!=o.getTexture()?(r.getTextureController().setTexture(o.getTexture()),r.setPaint(HomeFurnitureController.FurniturePaint.TEXTURED)):null!=o.getColor()?(r.setColor(o.getColor()),r.setPaint(HomeFurnitureController.FurniturePaint.COLORED)):r.setPaint(HomeFurnitureController.FurniturePaint.DEFAULT);var l=o.getShininess();r.setShininess(null==l?HomeFurnitureController.FurnitureShininess.DEFAULT:0===l?HomeFurnitureController.FurnitureShininess.MATT:HomeFurnitureController.FurnitureShininess.SHINY),r.modifyFurniture()}else if(null!=i&&i instanceof Wall){var a=i,s=new WallController(this.home,this.preferences,this.viewFactory,this.contentManager,t);null!=a.getLeftSideColor()?(s.setLeftSideColor(a.getLeftSideColor()),s.setLeftSidePaint(WallController.WallPaint.COLORED)):null!=a.getLeftSideTexture()?(s.getLeftSideTextureController().setTexture(a.getLeftSideTexture()),s.setLeftSidePaint(WallController.WallPaint.TEXTURED)):s.setLeftSidePaint(WallController.WallPaint.DEFAULT),s.setLeftSideShininess(a.getLeftSideShininess()),s.getLeftSideBaseboardController().setBaseboard(a.getLeftSideBaseboard()),null!=a.getRightSideColor()?(s.setRightSideColor(a.getRightSideColor()),s.setRightSidePaint(WallController.WallPaint.COLORED)):null!=a.getRightSideTexture()?(s.getRightSideTextureController().setTexture(a.getRightSideTexture()),s.setRightSidePaint(WallController.WallPaint.TEXTURED)):s.setRightSidePaint(WallController.WallPaint.DEFAULT),s.setRightSideShininess(a.getRightSideShininess()),s.getRightSideBaseboardController().setBaseboard(a.getRightSideBaseboard()),s.setPattern(a.getPattern()),s.setTopColor(a.getTopColor()),s.setTopPaint(null!=a.getTopColor()?WallController.WallPaint.COLORED:WallController.WallPaint.DEFAULT),s.modifyWalls()}else if(null!=i&&i instanceof Room){var h=i,u=new RoomController(this.home,this.preferences,this.viewFactory,this.contentManager,t);null!=h.getFloorColor()?(u.setFloorColor(h.getFloorColor()),u.setFloorPaint(RoomController.RoomPaint.COLORED)):null!=h.getFloorTexture()?(u.getFloorTextureController().setTexture(h.getFloorTexture()),u.setFloorPaint(RoomController.RoomPaint.TEXTURED)):u.setFloorPaint(RoomController.RoomPaint.DEFAULT),u.setFloorShininess(h.getFloorShininess()),null!=h.getCeilingColor()?(u.setCeilingColor(h.getCeilingColor()),u.setCeilingPaint(RoomController.RoomPaint.COLORED)):null!=h.getCeilingTexture()?(u.getCeilingTextureController().setTexture(h.getCeilingTexture()),u.setCeilingPaint(RoomController.RoomPaint.TEXTURED)):u.setCeilingPaint(RoomController.RoomPaint.DEFAULT),u.setCeilingShininess(h.getCeilingShininess()),u.modifyRooms()}else if(null!=i&&i instanceof Polyline){var d=i,c=new PolylineController(this.home,this.preferences,this.viewFactory,this.contentManager,t);c.setThickness(d.getThickness()),c.setJoinStyle(d.getJoinStyle()),c.setCapStyle(d.getCapStyle()),c.setStartArrowStyle(d.getStartArrowStyle()),c.setEndArrowStyle(d.getEndArrowStyle()),c.setDashStyle(d.getDashStyle()),c.setDashPattern(d.getDashPattern()),c.setDashOffset(d.getDashOffset()),c.setColor(d.getColor()),c.modifyPolylines()}else if(null!=i&&i instanceof Label){var p=i,g=new LabelController(this.home,this.preferences,this.viewFactory,t);g.setColor(p.getColor());var m=p.getStyle();null!=m?(g.setAlignment(m.getAlignment()),g.setFontName(m.getFontName()),g.setFontSize(m.getFontSize())):(g.setAlignment(null),g.setFontName(null),g.setFontSize(this.preferences.getDefaultTextStyle(Label).getFontSize())),g.modifyLabels()}t.postEdit(new e.PastingStyleEndUndoableEdit(this.home,this.preferences,n.slice(0))),t.endUpdate()},e.prototype.createTransferData=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];for(var n=[],o=0;o<t.length;o++){null==this.childControllers&&(this.childControllers=[],this.childControllers.push(this.getFurnitureCatalogController()),this.childControllers.push(this.getFurnitureController()),this.childControllers.push(this.getPlanController()),this.childControllers.push(this.getHomeController3D()));for(var r=0;r<this.childControllers.length;r++){var l=this.childControllers[r];null!=l.getView()&&null!=l.getView().constructor&&null!=l.getView().constructor.__interfaces&&l.getView().constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.TransferableView")>=0&&n.push(l.getView().createTransferData(t[o]))}}e.dataReady(n.slice(0))},e.prototype.delete=function(){this.focusedView===this.getFurnitureCatalogController().getView()?this.getView().confirmDeleteCatalogSelection()&&this.getFurnitureCatalogController().deleteSelection():this.focusedView===this.getFurnitureController().getView()?this.getFurnitureController().deleteSelection():(this.focusedView===this.getPlanController().getView()||this.focusedView===this.getHomeController3D().getView()&&this.preferences.isEditingIn3DViewEnabled())&&this.getPlanController().deleteSelection()},e.prototype.focusedViewChanged=function(e){this.focusedView=e,this.enableActionsBoundToSelection(),this.enablePasteAction(),this.enablePasteToGroupAction(),this.enablePasteStyleAction(),this.enableSelectAllAction()},e.prototype.selectAll=function(){this.focusedView===this.getFurnitureController().getView()?this.getFurnitureController().selectAll():this.focusedView!==this.getPlanController().getView()&&this.focusedView!==this.getHomeController3D().getView()||this.getPlanController().selectAll()},e.prototype.newHome=function(){var e;e=null!=this.application?this.application.createHome():new Home(this.preferences.getNewWallHeight()),this.application.addHome(e)},e.prototype.newHomeFromExample=function(){},e.prototype.getCatalogFurnitureNames=function(e){for(var t={},i=e.getCategories(),n=0;n<i.length;n++)for(var o=i[n].getFurniture(),r=0;r<o.length;r++){var l=o[r];null!=l.getId()&&(t[l.getId()]=l.getName())}return t},e.prototype.renameToCatalogName=function(e,t,i){if(null!=e&&e instanceof HomeFurnitureGroup){e.setName(i);for(var n=e.getFurniture(),o=0;o<n.length;o++){var r=n[o];this.renameToCatalogName(r,t,i)}}else{var l=e.getCatalogId();null!=l&&e.setName(void 0===(a=t)[s=l]?null:a[s])}var a,s},e.prototype.open=function(){},e.prototype.addHomeToApplication=function(e){var t=this;this.getView().invokeLater((function(){t.application.addHome(e)}))},e.prototype.updateUserPreferencesRecentHomes=function(e){if(null!=this.application){for(var t=e.length-1;t>=0;t--)try{e.splice(t,1)[0]}catch(e){}this.preferences.setRecentHomes(e)}},e.prototype.getRecentHomes=function(){if(null!=this.application){for(var e=[],t=this.preferences.getRecentHomes(),i=0;i<t.length;i++){t[i];try{null}catch(e){}}return this.getView().setEnabled(HomeView.ActionType.DELETE_RECENT_HOMES,!(0==e.length)),e.slice(0)}return[]},e.prototype.getVersion=function(){if(null!=this.application){var e=this.application.getVersion();try{e+=" JS"}catch(e){}return e}return""},e.prototype.deleteRecentHomes=function(){this.updateUserPreferencesRecentHomes([]),this.getView().setEnabled(HomeView.ActionType.DELETE_RECENT_HOMES,!1)},e.prototype.close=function(){},e.prototype.save=function(){},e.prototype.saveAs=function(){},e.prototype.saveAndCompress=function(){},e.prototype.saveAsAndCompress=function(){},e.prototype.updateSavedHome=function(e,t,i){var n=this;this.getView().invokeLater((function(){n.home.setName(e),n.home.setModified(!1),n.home.setRecovered(!1),n.home.setRepaired(!1),n.home.setVersion(t);var o,r=n.preferences.getRecentHomes().slice(0),l=r.indexOf(e);l>=0&&r.splice(l,1)[0],r.splice(0,0,e),n.updateUserPreferencesRecentHomes(r),null!=i&&("function"==typeof(o=i)?o():o.run())}))},e.prototype.exportToCSV=function(){},e.prototype.exportToSVG=function(){},e.prototype.exportToOBJ=function(){},e.prototype.createPhotos=function(){},e.prototype.createPhoto=function(){},e.prototype.createVideo=function(){},e.prototype.setupPage=function(){},e.prototype.previewPrint=function(){},e.prototype.print=function(){},e.prototype.printToPDF=function(){},e.prototype.exit=function(){for(var e=this.application.getHomes(),t=0;t<e.length;t++){if((i=e[t]).isModified()||i.isRecovered()||i.isRepaired()){if(this.getView().confirmExit())break;return}}for(e=this.application.getHomes(),t=0;t<e.length;t++){var i;(i=e[t]).setRecovered(!1),this.application.deleteHome(i)}},e.prototype.editPreferences=function(){new UserPreferencesController(this.preferences,this.viewFactory,this.contentManager,this).displayView(this.getView())},e.prototype.enableMagnetism=function(){this.preferences.setMagnetismEnabled(!0)},e.prototype.disableMagnetism=function(){this.preferences.setMagnetismEnabled(!1)},e.prototype.setMode=function(e){var t,i=this;this.getPlanController().getMode()!==e&&(null==(t=e===PlanController.Mode.WALL_CREATION_$LI$()?HomeView.ActionType[HomeView.ActionType.CREATE_WALLS]:e===PlanController.Mode.ROOM_CREATION_$LI$()?HomeView.ActionType[HomeView.ActionType.CREATE_ROOMS]:e===PlanController.Mode.POLYLINE_CREATION_$LI$()?HomeView.ActionType[HomeView.ActionType.CREATE_POLYLINES]:e===PlanController.Mode.DIMENSION_LINE_CREATION_$LI$()?HomeView.ActionType[HomeView.ActionType.CREATE_DIMENSION_LINES]:e===PlanController.Mode.LABEL_CREATION_$LI$()?HomeView.ActionType[HomeView.ActionType.CREATE_LABELS]:null)||this.preferences.isActionTipIgnored(t)||this.getView().invokeLater((function(){i.getView().showActionTipMessage(t)&&i.preferences.setActionTipIgnored(t)})),this.getPlanController().setMode(e))},e.prototype.importBackgroundImage=function(){new BackgroundImageWizardController(this.home,this.preferences,this.viewFactory,this.contentManager,this.getUndoableEditSupport()).displayView(this.getView())},e.prototype.modifyBackgroundImage=function(){this.importBackgroundImage()},e.prototype.hideBackgroundImage=function(){this.toggleBackgroundImageVisibility("undoHideBackgroundImageName")},e.prototype.showBackgroundImage=function(){this.toggleBackgroundImageVisibility("undoShowBackgroundImageName")},e.prototype.toggleBackgroundImageVisibility=function(t){var i=this.home.getSelectedLevel();e.doToggleBackgroundImageVisibility(this.home),this.getUndoableEditSupport().postEdit(new e.BackgroundImageVisibilityTogglingUndoableEdit(this.home,this.preferences,t,i))},e.doToggleBackgroundImageVisibility=function(e){var t=null!=e.getSelectedLevel()?e.getSelectedLevel().getBackgroundImage():e.getBackgroundImage();t=new BackgroundImage(t.getImage(),t.getScaleDistance(),t.getScaleDistanceXStart(),t.getScaleDistanceYStart(),t.getScaleDistanceXEnd(),t.getScaleDistanceYEnd(),t.getXOrigin(),t.getYOrigin(),!t.isVisible()),null!=e.getSelectedLevel()?e.getSelectedLevel().setBackgroundImage(t):e.setBackgroundImage(t)},e.prototype.deleteBackgroundImage=function(){var t,i=this.home.getSelectedLevel();null!=i?(t=i.getBackgroundImage(),i.setBackgroundImage(null)):(t=this.home.getBackgroundImage(),this.home.setBackgroundImage(null)),this.getUndoableEditSupport().postEdit(new e.BackgroundImageDeletionUndoableEdit(this.home,this.preferences,i,t))},e.prototype.zoomOut=function(){var e=this.getPlanController(),t=e.getScale()/1.5;e.setScale(t),e.getView().makeSelectionVisible()},e.prototype.zoomIn=function(){var e=this.getPlanController(),t=1.5*e.getScale();e.setScale(t),e.getView().makeSelectionVisible()},e.prototype.storeCamera=function(){var e=(new Date).toLocaleDateString(this.preferences.getLanguage().replace("_","-")),t=this.getView().showStoreCameraDialog(e);null!=t&&this.getHomeController3D().storeCamera(t)},e.prototype.deleteCameras=function(){var e=this.getView().showDeletedCamerasDialog();null!=e&&this.getHomeController3D().deleteCameras(e)},e.prototype.detachView=function(e){null!=e&&(this.getView().detachView(e),this.notUndoableModifications=!0,this.home.setModified(!0))},e.prototype.attachView=function(e){null!=e&&(this.getView().attachView(e),this.notUndoableModifications=!0,this.home.setModified(!0))},e.prototype.help=function(){},e.prototype.about=function(){this.getView().showAboutDialog()},e.prototype.setVisualProperty=function(e,t){this.home.setVisualProperty(e,t)},e.prototype.setHomeProperty=function(e,t){this.home.setProperty(e,t)},e.helpController=null,e}();HomeController.__class="com.eteks.sweethome3d.viewcontroller.HomeController",HomeController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"],function(e){var t=function(){function t(){}return t.writingPreferences_$LI$=function(){return null==t.writingPreferences&&(t.writingPreferences=[]),t.writingPreferences},t.prototype.writePreferences=function(i){var n,o;t.writingPreferences_$LI$().indexOf(i.preferences)>=0||(n=t.writingPreferences_$LI$(),o=i.preferences,-1==n.indexOf(o)&&n.push(o),i.getView().invokeLater((function(){try{i.preferences.write(),function(e){var t=e.indexOf(i.preferences);t>=0&&e.splice(t,1)}(t.writingPreferences_$LI$())}catch(t){i.getView().showError(i.preferences.getLocalizedString(e,"savePreferencesError"))}})))},t}();e.UserPreferencesChangeListener=t,t.__class="com.eteks.sweethome3d.viewcontroller.HomeController.UserPreferencesChangeListener";var i=function(){function e(e){void 0===this.homeController&&(this.homeController=null),this.homeController=e}return e.prototype.propertyChange=function(e){var t=this.homeController;null==t?e.getSource().removePropertyChangeListener("LANGUAGE",this):t.getView().setUndoRedoName(t.undoManager.canUndo()?t.undoManager.getUndoPresentationName():null,t.undoManager.canRedo()?t.undoManager.getRedoPresentationName():null)},e}();e.LanguageChangeListener=i,i.__class="com.eteks.sweethome3d.viewcontroller.HomeController.LanguageChangeListener";var n=function(t){function i(i,n,o,r,l,a){var s=t.call(this,n,e,"undoDropName")||this;return void 0===s.home&&(s.home=null),void 0===s.oldSelectedLevel&&(s.oldSelectedLevel=null),void 0===s.selectedLevel&&(s.selectedLevel=null),void 0===s.selectedItems&&(s.selectedItems=null),void 0===s.allLevelsSelection&&(s.allLevelsSelection=!1),s.home=i,s.oldSelectedLevel=o,s.selectedLevel=r,s.selectedItems=l,s.allLevelsSelection=a,s}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),this.allLevelsSelection?this.home.setAllLevelsSelection(this.allLevelsSelection):this.home.setSelectedLevel(this.oldSelectedLevel),this.home.setSelectedItems(this.selectedItems.slice(0))},i.prototype.redo=function(){t.prototype.redo.call(this),this.home.setSelectedLevel(this.selectedLevel)},i}(LocalizedUndoableEdit);e.LevelModificationUndoableEdit=n,n.__class="com.eteks.sweethome3d.viewcontroller.HomeController.LevelModificationUndoableEdit",n.__interfaces=["javax.swing.undo.UndoableEdit"];var o=function(t){function i(i,n,o){var r=t.call(this,n,e,"undoDropName")||this;return void 0===r.home&&(r.home=null),void 0===r.importedFurniture&&(r.importedFurniture=null),r.home=i,r.importedFurniture=o,r}return __extends(i,t),i.prototype.redo=function(){t.prototype.redo.call(this),this.home.setSelectedItems(this.importedFurniture.slice(0))},i}(LocalizedUndoableEdit);e.DroppingEndUndoableEdit=o,o.__class="com.eteks.sweethome3d.viewcontroller.HomeController.DroppingEndUndoableEdit",o.__interfaces=["javax.swing.undo.UndoableEdit"];var r=function(t){function i(i,n,o){var r=t.call(this,n,e,"undoPasteStyleName")||this;return void 0===r.home&&(r.home=null),void 0===r.selectedItems&&(r.selectedItems=null),r.home=i,r.selectedItems=o,r}return __extends(i,t),i.prototype.redo=function(){t.prototype.redo.call(this),this.home.setSelectedItems(this.selectedItems.slice(0))},i}(LocalizedUndoableEdit);e.PastingStyleEndUndoableEdit=r,r.__class="com.eteks.sweethome3d.viewcontroller.HomeController.PastingStyleEndUndoableEdit",r.__interfaces=["javax.swing.undo.UndoableEdit"];var l=function(t){function i(i,n,o,r){var l=t.call(this,n,e,o)||this;return void 0===l.home&&(l.home=null),void 0===l.selectedLevel&&(l.selectedLevel=null),l.home=i,l.selectedLevel=r,l}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),this.home.setSelectedLevel(this.selectedLevel),e.doToggleBackgroundImageVisibility(this.home)},i.prototype.redo=function(){t.prototype.redo.call(this),this.home.setSelectedLevel(this.selectedLevel),e.doToggleBackgroundImageVisibility(this.home)},i}(LocalizedUndoableEdit);e.BackgroundImageVisibilityTogglingUndoableEdit=l,l.__class="com.eteks.sweethome3d.viewcontroller.HomeController.BackgroundImageVisibilityTogglingUndoableEdit",l.__interfaces=["javax.swing.undo.UndoableEdit"];var a=function(t){function i(i,n,o,r){var l=t.call(this,n,e,"undoDeleteBackgroundImageName")||this;return void 0===l.home&&(l.home=null),void 0===l.selectedLevel&&(l.selectedLevel=null),void 0===l.oldImage&&(l.oldImage=null),l.home=i,l.oldImage=r,l.selectedLevel=o,l}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),this.home.setSelectedLevel(this.selectedLevel),null!=this.selectedLevel?this.selectedLevel.setBackgroundImage(this.oldImage):this.home.setBackgroundImage(this.oldImage)},i.prototype.redo=function(){t.prototype.redo.call(this),this.home.setSelectedLevel(this.selectedLevel),null!=this.selectedLevel?this.selectedLevel.setBackgroundImage(null):this.home.setBackgroundImage(null)},i}(LocalizedUndoableEdit);e.BackgroundImageDeletionUndoableEdit=a,a.__class="com.eteks.sweethome3d.viewcontroller.HomeController.BackgroundImageDeletionUndoableEdit",a.__interfaces=["javax.swing.undo.UndoableEdit"];var s=function(e){function t(t){var i=e.call(this)||this;return void 0===i.homeController&&(i.homeController=null),i.homeController=t,i}return __extends(t,e),t.prototype.collectionChanged=function(e){var t,i=this.homeController;null==i?e.getSource().removeFurnitureListener(null==(t=this)||"function"==typeof t?t:function(e){return(t.collectionChanged?t.collectionChanged:t).call(t,e)}):this.writePreferences(i)},t}(e.UserPreferencesChangeListener);e.FurnitureCatalogChangeListener=s,s.__class="com.eteks.sweethome3d.viewcontroller.HomeController.FurnitureCatalogChangeListener",s.__interfaces=["com.eteks.sweethome3d.model.CollectionListener"];var h=function(e){function t(t){var i=e.call(this)||this;return void 0===i.homeController&&(i.homeController=null),i.homeController=t,i}return __extends(t,e),t.prototype.collectionChanged=function(e){var t,i=this.homeController;null==i?e.getSource().removeTexturesListener(null==(t=this)||"function"==typeof t?t:function(e){return(t.collectionChanged?t.collectionChanged:t).call(t,e)}):this.writePreferences(i)},t}(e.UserPreferencesChangeListener);e.TexturesCatalogChangeListener=h,h.__class="com.eteks.sweethome3d.viewcontroller.HomeController.TexturesCatalogChangeListener",h.__interfaces=["com.eteks.sweethome3d.model.CollectionListener"];var u=function(e){function t(t){var i=e.call(this)||this;return void 0===i.homeController&&(i.homeController=null),i.homeController=t,i}return __extends(t,e),t.prototype.propertyChange=function(e){var t=this.homeController;null==t?e.getSource().removePropertyChangeListener(e.getPropertyName(),this):this.writePreferences(t)},t}(e.UserPreferencesChangeListener);e.UserPreferencesPropertiesChangeListener=u,u.__class="com.eteks.sweethome3d.viewcontroller.HomeController.UserPreferencesPropertiesChangeListener";var d=function(e){function t(t){var i=e.call(this)||this;return i.__parent=t,i}return __extends(t,e),t.prototype._postEdit=function(t){null!=t&&t instanceof javax.swing.undo.CompoundEdit&&!t.isSignificant()||e.prototype._postEdit.call(this,t)},t}(javax.swing.undo.UndoableEditSupport);e.HomeController$0=d;var c=function(){function e(e){this.__parent=e}return e.prototype.selectionChanged=function(e){this.__parent.enableActionsBoundToSelection()},e}();e.HomeController$1=c,c.__interfaces=["com.eteks.sweethome3d.model.SelectionListener"];var p=function(){function e(e){this.__parent=e}return e.prototype.selectionChanged=function(e){this.__parent.enableActionsBoundToSelection()},e}();e.HomeController$2=p,p.__interfaces=["com.eteks.sweethome3d.model.SelectionListener"];var g=function(){function e(e){this.__parent=e}return e.prototype.propertyChange=function(e){this.__parent.getView().setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_DESCENDING_ORDER,null!=e.getNewValue())},e}();e.HomeController$3=g;var m=function(){function e(e){this.__parent=e}return e.prototype.propertyChange=function(e){this.__parent.enableBackgroungImageActions(this.__parent.getView(),e.getNewValue())},e}();e.HomeController$4=m;var f=function(){function e(e){this.__parent=e}return e.prototype.propertyChange=function(e){this.__parent.notUndoableModifications=!0,this.__parent.home.setModified(!0)},e}();e.HomeController$5=f;var v=function(){function e(e,t){this.notUndoableModificationListener=t,this.__parent=e}return e.prototype.propertyChange=function(e){this.__parent.home.getEnvironment().getPhotoAspectRatio()!==AspectRatio.VIEW_3D_RATIO&&this.notUndoableModificationListener.propertyChange(e)},e}();e.HomeController$6=v;var _=function(){function e(e,t){this.notUndoableModificationListener=t,this.__parent=e}return e.prototype.propertyChange=function(e){"TIME"!==e.getPropertyName()&&"LENS"!==e.getPropertyName()||this.notUndoableModificationListener.propertyChange(e)},e}();e.HomeController$7=_;var S=function(){function e(e){this.__parent=e}return e.prototype.undoableEditHappened=function(e){var t=this.__parent.getView();t.setEnabled(HomeView.ActionType.UNDO,!this.__parent.getPlanController().isModificationState()),t.setEnabled(HomeView.ActionType.REDO,!1),t.setUndoRedoName(e.getEdit().getUndoPresentationName(),null),this.__parent.saveUndoLevel++,this.__parent.home.setModified(!0)},e}();e.HomeController$8=S,S.__interfaces=["javax.swing.event.UndoableEditListener"];var y=function(){function e(e){this.__parent=e}return e.prototype.propertyChange=function(e){this.__parent.home.isModified()||(this.__parent.saveUndoLevel=0,this.__parent.notUndoableModifications=!1)},e}();e.HomeController$9=y;var E=function(){function e(e){this.__parent=e}return e.prototype.propertyChange=function(e){"VISIBLE"===e.getPropertyName()&&this.__parent.enableSelectAllAction()},e}();e.HomeController$10=E;var C=function(){function e(e){this.__parent=e}return e.prototype.propertyChange=function(e){this.__parent.getView().setEnabled(HomeView.ActionType.MODIFY_OBSERVER,this.__parent.home.getCamera()===this.__parent.home.getObserverCamera())},e}();e.HomeController$11=C;var P=function(){function e(e){this.__parent=e}return e.prototype.propertyChange=function(e){var t=this.__parent.home.getSelectedLevel();if(!this.__parent.home.isAllLevelsSelection()){for(var i=[],n=this.__parent.home.getSelectedItems(),o=0;o<n.length;o++){var r=n[o];null!=r&&null!=r.constructor&&null!=r.constructor.__interfaces&&r.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Elevatable")>=0&&!r.isAtLevel(t)||i.push(r)}this.__parent.home.setSelectedItems(i)}var l=this.__parent.getView();this.__parent.enableCreationToolsActions(l),this.__parent.enableBackgroungImageActions(l,null==t?this.__parent.home.getBackgroundImage():t.getBackgroundImage()),this.__parent.enableLevelActions(l)},e}();e.HomeController$12=P;var w=function(){function e(e){this.__parent=e}return e.prototype.propertyChange=function(e){if("BACKGROUND_IMAGE"===e.getPropertyName())this.__parent.enableBackgroungImageActions(this.__parent.getView(),e.getNewValue());else if("VIEWABLE"===e.getPropertyName()&&(this.__parent.enableCreationToolsActions(this.__parent.getView()),this.__parent.enableActionsBoundToSelection(),!e.getNewValue())){var t=this.__parent.getPlanController().getMode();t!==PlanController.Mode.SELECTION_$LI$()&&t!==PlanController.Mode.PANNING_$LI$()&&this.__parent.getPlanController().setMode(PlanController.Mode.SELECTION_$LI$())}},e}();e.HomeController$13=w;var L=function(){function e(e){this.__parent=e}return e.prototype.propertyChange=function(e){var t=0==this.__parent.home.getStoredCameras().length;this.__parent.getView().setEnabled(HomeView.ActionType.DELETE_POINTS_OF_VIEW,!t),this.__parent.getView().setEnabled(HomeView.ActionType.CREATE_PHOTOS_AT_POINTS_OF_VIEW,!t)},e}();e.HomeController$14=L;var T=function(){function e(e){this.__parent=e}return e.prototype.propertyChange=function(e){this.__parent.enableActionsBoundToSelection(),this.__parent.enableSelectAllAction();var t=this.__parent.getView();this.__parent.enableLevelActions(t);var i=this.__parent.getPlanController().isModificationState();i?(t.setEnabled(HomeView.ActionType.PASTE,!1),t.setEnabled(HomeView.ActionType.UNDO,!1),t.setEnabled(HomeView.ActionType.REDO,!1)):(this.__parent.enablePasteAction(),t.setEnabled(HomeView.ActionType.UNDO,this.__parent.undoManager.canUndo()),t.setEnabled(HomeView.ActionType.REDO,this.__parent.undoManager.canRedo())),t.setEnabled(HomeView.ActionType.LOCK_BASE_PLAN,!i),t.setEnabled(HomeView.ActionType.UNLOCK_BASE_PLAN,!i)},e}();e.HomeController$15=T;var A=function(){function e(e){this.__parent=e}return e.prototype.propertyChange=function(e){this.__parent.enableActionsBoundToSelection()},e}();e.HomeController$16=A;var I=function(){function e(e){this.__parent=e}return e.prototype.propertyChange=function(e){this.__parent.enableZoomActions()},e}();e.HomeController$17=I}(HomeController||(HomeController={}));var Home3DAttributesController=function(){function e(e,t,i,n,o){void 0===this.home&&(this.home=null),void 0===this.preferences&&(this.preferences=null),void 0===this.viewFactory&&(this.viewFactory=null),void 0===this.contentManager&&(this.contentManager=null),void 0===this.undoSupport&&(this.undoSupport=null),void 0===this.groundTextureController&&(this.groundTextureController=null),void 0===this.skyTextureController&&(this.skyTextureController=null),void 0===this.propertyChangeSupport&&(this.propertyChangeSupport=null),void 0===this.home3DAttributesView&&(this.home3DAttributesView=null),void 0===this.groundColor&&(this.groundColor=0),void 0===this.groundPaint&&(this.groundPaint=null),void 0===this.backgroundImageVisibleOnGround3D&&(this.backgroundImageVisibleOnGround3D=!1),void 0===this.skyColor&&(this.skyColor=0),void 0===this.skyPaint&&(this.skyPaint=null),void 0===this.lightColor&&(this.lightColor=0),void 0===this.wallsAlpha&&(this.wallsAlpha=0),this.home=e,this.preferences=t,this.viewFactory=i,this.contentManager=n,this.undoSupport=o,this.propertyChangeSupport=new PropertyChangeSupport(this),this.updateProperties()}return e.prototype.getGroundTextureController=function(){return null==this.groundTextureController&&(this.groundTextureController=new TextureChoiceController(this.preferences.getLocalizedString(e,"groundTextureTitle"),this.preferences,this.viewFactory,this.contentManager),this.groundTextureController.addPropertyChangeListener("TEXTURE",new e.Home3DAttributesController$0(this))),this.groundTextureController},e.prototype.getSkyTextureController=function(){return null==this.skyTextureController&&(this.skyTextureController=new TextureChoiceController(this.preferences.getLocalizedString(e,"skyTextureTitle"),!1,this.preferences,this.viewFactory,this.contentManager),this.skyTextureController.addPropertyChangeListener("TEXTURE",new e.Home3DAttributesController$1(this))),this.skyTextureController},e.prototype.getView=function(){return null==this.home3DAttributesView&&(this.home3DAttributesView=this.viewFactory.createHome3DAttributesView(this.preferences,this)),this.home3DAttributesView},e.prototype.displayView=function(e){this.getView().displayView(e)},e.prototype.addPropertyChangeListener=function(e,t){this.propertyChangeSupport.addPropertyChangeListener(e,t)},e.prototype.removePropertyChangeListener=function(e,t){this.propertyChangeSupport.removePropertyChangeListener(e,t)},e.prototype.updateProperties=function(){var t=this.home.getEnvironment();this.setGroundColor(t.getGroundColor());var i=t.getGroundTexture();this.getGroundTextureController().setTexture(i),null!=i?this.setGroundPaint(e.EnvironmentPaint.TEXTURED):this.setGroundPaint(e.EnvironmentPaint.COLORED),this.setBackgroundImageVisibleOnGround3D(t.isBackgroundImageVisibleOnGround3D()),this.setSkyColor(t.getSkyColor());var n=t.getSkyTexture();this.getSkyTextureController().setTexture(n),null!=n?this.setSkyPaint(e.EnvironmentPaint.TEXTURED):this.setSkyPaint(e.EnvironmentPaint.COLORED),this.setLightColor(t.getLightColor()),this.setWallsAlpha(t.getWallsAlpha())},e.prototype.setGroundColor=function(t){if(t!==this.groundColor){var i=this.groundColor;this.groundColor=t,this.propertyChangeSupport.firePropertyChange("GROUND_COLOR",i,t),this.setGroundPaint(e.EnvironmentPaint.COLORED)}},e.prototype.getGroundColor=function(){return this.groundColor},e.prototype.setGroundPaint=function(e){if(e!==this.groundPaint){var t=this.groundPaint;this.groundPaint=e,this.propertyChangeSupport.firePropertyChange("GROUND_PAINT",t,e)}},e.prototype.getGroundPaint=function(){return this.groundPaint},e.prototype.isBackgroundImageVisibleOnGround3D=function(){return this.backgroundImageVisibleOnGround3D},e.prototype.setBackgroundImageVisibleOnGround3D=function(e){this.backgroundImageVisibleOnGround3D!==e&&(this.backgroundImageVisibleOnGround3D=e,this.propertyChangeSupport.firePropertyChange("BACKGROUND_IMAGE_VISIBLE_ON_GROUND_3D",!e,e))},e.prototype.setSkyColor=function(e){if(e!==this.skyColor){var t=this.skyColor;this.skyColor=e,this.propertyChangeSupport.firePropertyChange("SKY_COLOR",t,e)}},e.prototype.getSkyColor=function(){return this.skyColor},e.prototype.setSkyPaint=function(e){if(e!==this.skyPaint){var t=this.skyPaint;this.skyPaint=e,this.propertyChangeSupport.firePropertyChange("SKY_PAINT",t,e)}},e.prototype.getSkyPaint=function(){return this.skyPaint},e.prototype.setLightColor=function(e){if(e!==this.lightColor){var t=this.lightColor;this.lightColor=e,this.propertyChangeSupport.firePropertyChange("LIGHT_COLOR",t,e)}},e.prototype.getLightColor=function(){return this.lightColor},e.prototype.setWallsAlpha=function(e){if(e!==this.wallsAlpha){var t=this.wallsAlpha;this.wallsAlpha=e,this.propertyChangeSupport.firePropertyChange("WALLS_ALPHA",t,e)}},e.prototype.getWallsAlpha=function(){return this.wallsAlpha},e.prototype.modify3DAttributes=function(){var t=this.getGroundColor(),i=this.getGroundPaint()===e.EnvironmentPaint.TEXTURED?this.getGroundTextureController().getTexture():null,n=this.isBackgroundImageVisibleOnGround3D(),o=this.getSkyColor(),r=this.getSkyPaint()===e.EnvironmentPaint.TEXTURED?this.getSkyTextureController().getTexture():null,l=this.getLightColor(),a=this.getWallsAlpha(),s=this.home.getEnvironment(),h=s.getGroundColor(),u=s.isBackgroundImageVisibleOnGround3D(),d=s.getGroundTexture(),c=s.getSkyColor(),p=s.getSkyTexture(),g=s.getLightColor(),m=s.getWallsAlpha();e.doModify3DAttributes(this.home,t,i,n,o,r,l,a),null!=this.undoSupport&&this.undoSupport.postEdit(new e.Home3DAttributesModificationUndoableEdit(this.home,this.preferences,h,d,u,c,p,g,m,t,i,n,o,r,l,a))},e.doModify3DAttributes=function(e,t,i,n,o,r,l,a){var s=e.getEnvironment();s.setGroundColor(t),s.setGroundTexture(i),s.setBackgroundImageVisibleOnGround3D(n),s.setSkyColor(o),s.setSkyTexture(r),s.setLightColor(l),s.setWallsAlpha(a)},e}();Home3DAttributesController.__class="com.eteks.sweethome3d.viewcontroller.Home3DAttributesController",Home3DAttributesController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"],function(e){var t;(t=e.EnvironmentPaint||(e.EnvironmentPaint={}))[t.COLORED=0]="COLORED",t[t.TEXTURED=1]="TEXTURED";var i=function(t){function i(i,n,o,r,l,a,s,h,u,d,c,p,g,m,f,v){var _=t.call(this,n,e,"undoModify3DAttributesName")||this;return void 0===_.home&&(_.home=null),void 0===_.oldGroundColor&&(_.oldGroundColor=0),void 0===_.oldGroundTexture&&(_.oldGroundTexture=null),void 0===_.oldBackgroundImageVisibleOnGround3D&&(_.oldBackgroundImageVisibleOnGround3D=!1),void 0===_.oldSkyColor&&(_.oldSkyColor=0),void 0===_.oldSkyTexture&&(_.oldSkyTexture=null),void 0===_.oldLightColor&&(_.oldLightColor=0),void 0===_.oldWallsAlpha&&(_.oldWallsAlpha=0),void 0===_.groundColor&&(_.groundColor=0),void 0===_.groundTexture&&(_.groundTexture=null),void 0===_.backgroundImageVisibleOnGround3D&&(_.backgroundImageVisibleOnGround3D=!1),void 0===_.skyColor&&(_.skyColor=0),void 0===_.skyTexture&&(_.skyTexture=null),void 0===_.lightColor&&(_.lightColor=0),void 0===_.wallsAlpha&&(_.wallsAlpha=0),_.home=i,_.oldGroundColor=o,_.oldGroundTexture=r,_.oldBackgroundImageVisibleOnGround3D=l,_.oldSkyColor=a,_.oldSkyTexture=s,_.oldLightColor=h,_.oldWallsAlpha=u,_.groundColor=d,_.groundTexture=c,_.backgroundImageVisibleOnGround3D=p,_.skyColor=g,_.skyTexture=m,_.lightColor=f,_.wallsAlpha=v,_}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),e.doModify3DAttributes(this.home,this.oldGroundColor,this.oldGroundTexture,this.oldBackgroundImageVisibleOnGround3D,this.oldSkyColor,this.oldSkyTexture,this.oldLightColor,this.oldWallsAlpha)},i.prototype.redo=function(){t.prototype.redo.call(this),e.doModify3DAttributes(this.home,this.groundColor,this.groundTexture,this.backgroundImageVisibleOnGround3D,this.skyColor,this.skyTexture,this.lightColor,this.wallsAlpha)},i}(LocalizedUndoableEdit);e.Home3DAttributesModificationUndoableEdit=i,i.__class="com.eteks.sweethome3d.viewcontroller.Home3DAttributesController.Home3DAttributesModificationUndoableEdit",i.__interfaces=["javax.swing.undo.UndoableEdit"];var n=function(){function t(e){this.__parent=e}return t.prototype.propertyChange=function(t){this.__parent.setGroundPaint(e.EnvironmentPaint.TEXTURED)},t}();e.Home3DAttributesController$0=n;var o=function(){function t(e){this.__parent=e}return t.prototype.propertyChange=function(t){this.__parent.setSkyPaint(e.EnvironmentPaint.TEXTURED)},t}();e.Home3DAttributesController$1=o}(Home3DAttributesController||(Home3DAttributesController={}));var ImportedFurnitureWizardController=function(e){function t(i,n,o,r,l,a,s,h){var u=this;if((null!=i&&i instanceof Home||null===i)&&(null!=n&&n instanceof CatalogPieceOfFurniture||null===n)&&("string"==typeof o||null===o)&&(null!=r&&r instanceof UserPreferences||null===r)&&(null!=l&&l instanceof FurnitureController||null===l)&&(null!=a&&null!=a.constructor&&null!=a.constructor.__interfaces&&a.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0||null===a)&&(null!=s&&null!=s.constructor&&null!=s.constructor.__interfaces&&s.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ContentManager")>=0||null===s)&&(null!=h&&h instanceof javax.swing.undo.UndoableEditSupport||null===h)){var d=arguments;void 0===(u=e.call(this,r,a)||this).home&&(u.home=null),void 0===u.piece&&(u.piece=null),void 0===u.modelName&&(u.modelName=null),void 0===u.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences&&(u.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences=null),void 0===u.furnitureController&&(u.furnitureController=null),void 0===u.contentManager&&(u.contentManager=null),void 0===u.undoSupport&&(u.undoSupport=null),void 0===u.furnitureModelStepState&&(u.furnitureModelStepState=null),void 0===u.furnitureOrientationStepState&&(u.furnitureOrientationStepState=null),void 0===u.furnitureAttributesStepState&&(u.furnitureAttributesStepState=null),void 0===u.furnitureIconStepState&&(u.furnitureIconStepState=null),void 0===u.stepsView&&(u.stepsView=null),void 0===u.step&&(u.step=null),void 0===u.name&&(u.name=null),void 0===u.creator&&(u.creator=null),void 0===u.model&&(u.model=null),void 0===u.width&&(u.width=0),void 0===u.proportionalWidth&&(u.proportionalWidth=0),void 0===u.depth&&(u.depth=0),void 0===u.proportionalDepth&&(u.proportionalDepth=0),void 0===u.height&&(u.height=0),void 0===u.proportionalHeight&&(u.proportionalHeight=0),void 0===u.elevation&&(u.elevation=0),void 0===u.movable&&(u.movable=!1),void 0===u.doorOrWindow&&(u.doorOrWindow=!1),void 0===u.staircaseCutOutShape&&(u.staircaseCutOutShape=null),void 0===u.color&&(u.color=null),void 0===u.category&&(u.category=null),void 0===u.modelSize&&(u.modelSize=0),void 0===u.modelRotation&&(u.modelRotation=null),void 0===u.edgeColorMaterialHidden&&(u.edgeColorMaterialHidden=!1),void 0===u.backFaceShown&&(u.backFaceShown=!1),void 0===u.iconYaw&&(u.iconYaw=0),void 0===u.iconPitch&&(u.iconPitch=0),void 0===u.iconScale&&(u.iconScale=0),void 0===u.proportional&&(u.proportional=!1),void 0===u.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory&&(u.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory=null),u.home=i,u.piece=n,u.modelName=o,u.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences=r,u.furnitureController=l,u.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory=a,u.undoSupport=h,u.contentManager=s,u.setTitle(u.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences.getLocalizedString(t,null==n?"importFurnitureWizard.title":"modifyFurnitureWizard.title")),u.furnitureModelStepState=new t.FurnitureModelStepState(u),u.furnitureOrientationStepState=new t.FurnitureOrientationStepState(u),u.furnitureAttributesStepState=new t.FurnitureAttributesStepState(u),u.furnitureIconStepState=new t.FurnitureIconStepState(u),u.setStepState(u.furnitureModelStepState)}else if((null!=i&&i instanceof Home||null===i)&&("string"==typeof n||null===n)&&(null!=o&&o instanceof UserPreferences||null===o)&&(null!=r&&r instanceof FurnitureController||null===r)&&(null!=l&&null!=l.constructor&&null!=l.constructor.__interfaces&&l.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0||null===l)&&(null!=a&&null!=a.constructor&&null!=a.constructor.__interfaces&&a.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ContentManager")>=0||null===a)&&(null!=s&&s instanceof javax.swing.undo.UndoableEditSupport||null===s)&&void 0===h){var c=(d=arguments)[1],p=d[2],g=d[3],m=d[4],f=d[5],v=d[6];void 0===(u=e.call(this,p,m)||this).home&&(u.home=null),void 0===u.piece&&(u.piece=null),void 0===u.modelName&&(u.modelName=null),void 0===u.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences&&(u.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences=null),void 0===u.furnitureController&&(u.furnitureController=null),void 0===u.contentManager&&(u.contentManager=null),void 0===u.undoSupport&&(u.undoSupport=null),void 0===u.furnitureModelStepState&&(u.furnitureModelStepState=null),void 0===u.furnitureOrientationStepState&&(u.furnitureOrientationStepState=null),void 0===u.furnitureAttributesStepState&&(u.furnitureAttributesStepState=null),void 0===u.furnitureIconStepState&&(u.furnitureIconStepState=null),void 0===u.stepsView&&(u.stepsView=null),void 0===u.step&&(u.step=null),void 0===u.name&&(u.name=null),void 0===u.creator&&(u.creator=null),void 0===u.model&&(u.model=null),void 0===u.width&&(u.width=0),void 0===u.proportionalWidth&&(u.proportionalWidth=0),void 0===u.depth&&(u.depth=0),void 0===u.proportionalDepth&&(u.proportionalDepth=0),void 0===u.height&&(u.height=0),void 0===u.proportionalHeight&&(u.proportionalHeight=0),void 0===u.elevation&&(u.elevation=0),void 0===u.movable&&(u.movable=!1),void 0===u.doorOrWindow&&(u.doorOrWindow=!1),void 0===u.staircaseCutOutShape&&(u.staircaseCutOutShape=null),void 0===u.color&&(u.color=null),void 0===u.category&&(u.category=null),void 0===u.modelSize&&(u.modelSize=0),void 0===u.modelRotation&&(u.modelRotation=null),void 0===u.edgeColorMaterialHidden&&(u.edgeColorMaterialHidden=!1),void 0===u.backFaceShown&&(u.backFaceShown=!1),void 0===u.iconYaw&&(u.iconYaw=0),void 0===u.iconPitch&&(u.iconPitch=0),void 0===u.iconScale&&(u.iconScale=0),void 0===u.proportional&&(u.proportional=!1),void 0===u.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory&&(u.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory=null),u.home=i,u.piece=null,u.modelName=c,u.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences=p,u.furnitureController=g,u.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory=m,u.undoSupport=v,u.contentManager=f,u.setTitle(u.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences.getLocalizedString(t,"importFurnitureWizard.title")),u.furnitureModelStepState=new t.FurnitureModelStepState(u),u.furnitureOrientationStepState=new t.FurnitureOrientationStepState(u),u.furnitureAttributesStepState=new t.FurnitureAttributesStepState(u),u.furnitureIconStepState=new t.FurnitureIconStepState(u),u.setStepState(u.furnitureModelStepState),void 0===u.home&&(u.home=null),void 0===u.piece&&(u.piece=null),void 0===u.modelName&&(u.modelName=null),void 0===u.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences&&(u.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences=null),void 0===u.furnitureController&&(u.furnitureController=null),void 0===u.contentManager&&(u.contentManager=null),void 0===u.undoSupport&&(u.undoSupport=null),void 0===u.furnitureModelStepState&&(u.furnitureModelStepState=null),void 0===u.furnitureOrientationStepState&&(u.furnitureOrientationStepState=null),void 0===u.furnitureAttributesStepState&&(u.furnitureAttributesStepState=null),void 0===u.furnitureIconStepState&&(u.furnitureIconStepState=null),void 0===u.stepsView&&(u.stepsView=null),void 0===u.step&&(u.step=null),void 0===u.name&&(u.name=null),void 0===u.creator&&(u.creator=null),void 0===u.model&&(u.model=null),void 0===u.width&&(u.width=0),void 0===u.proportionalWidth&&(u.proportionalWidth=0),void 0===u.depth&&(u.depth=0),void 0===u.proportionalDepth&&(u.proportionalDepth=0),void 0===u.height&&(u.height=0),void 0===u.proportionalHeight&&(u.proportionalHeight=0),void 0===u.elevation&&(u.elevation=0),void 0===u.movable&&(u.movable=!1),void 0===u.doorOrWindow&&(u.doorOrWindow=!1),void 0===u.staircaseCutOutShape&&(u.staircaseCutOutShape=null),void 0===u.color&&(u.color=null),void 0===u.category&&(u.category=null),void 0===u.modelSize&&(u.modelSize=0),void 0===u.modelRotation&&(u.modelRotation=null),void 0===u.edgeColorMaterialHidden&&(u.edgeColorMaterialHidden=!1),void 0===u.backFaceShown&&(u.backFaceShown=!1),void 0===u.iconYaw&&(u.iconYaw=0),void 0===u.iconPitch&&(u.iconPitch=0),void 0===u.iconScale&&(u.iconScale=0),void 0===u.proportional&&(u.proportional=!1),void 0===u.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory&&(u.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory=null)}else if((null!=i&&i instanceof Home||null===i)&&(null!=n&&n instanceof UserPreferences||null===n)&&(null!=o&&o instanceof FurnitureController||null===o)&&(null!=r&&null!=r.constructor&&null!=r.constructor.__interfaces&&r.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0||null===r)&&(null!=l&&null!=l.constructor&&null!=l.constructor.__interfaces&&l.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ContentManager")>=0||null===l)&&(null!=a&&a instanceof javax.swing.undo.UndoableEditSupport||null===a)&&void 0===s&&void 0===h){var _=(d=arguments)[1],S=d[2],y=d[3],E=d[4],C=d[5];void 0===(u=e.call(this,_,y)||this).home&&(u.home=null),void 0===u.piece&&(u.piece=null),void 0===u.modelName&&(u.modelName=null),void 0===u.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences&&(u.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences=null),void 0===u.furnitureController&&(u.furnitureController=null),void 0===u.contentManager&&(u.contentManager=null),void 0===u.undoSupport&&(u.undoSupport=null),void 0===u.furnitureModelStepState&&(u.furnitureModelStepState=null),void 0===u.furnitureOrientationStepState&&(u.furnitureOrientationStepState=null),void 0===u.furnitureAttributesStepState&&(u.furnitureAttributesStepState=null),void 0===u.furnitureIconStepState&&(u.furnitureIconStepState=null),void 0===u.stepsView&&(u.stepsView=null),void 0===u.step&&(u.step=null),void 0===u.name&&(u.name=null),void 0===u.creator&&(u.creator=null),void 0===u.model&&(u.model=null),void 0===u.width&&(u.width=0),void 0===u.proportionalWidth&&(u.proportionalWidth=0),void 0===u.depth&&(u.depth=0),void 0===u.proportionalDepth&&(u.proportionalDepth=0),void 0===u.height&&(u.height=0),void 0===u.proportionalHeight&&(u.proportionalHeight=0),void 0===u.elevation&&(u.elevation=0),void 0===u.movable&&(u.movable=!1),void 0===u.doorOrWindow&&(u.doorOrWindow=!1),void 0===u.staircaseCutOutShape&&(u.staircaseCutOutShape=null),void 0===u.color&&(u.color=null),void 0===u.category&&(u.category=null),void 0===u.modelSize&&(u.modelSize=0),void 0===u.modelRotation&&(u.modelRotation=null),void 0===u.edgeColorMaterialHidden&&(u.edgeColorMaterialHidden=!1),void 0===u.backFaceShown&&(u.backFaceShown=!1),void 0===u.iconYaw&&(u.iconYaw=0),void 0===u.iconPitch&&(u.iconPitch=0),void 0===u.iconScale&&(u.iconScale=0),void 0===u.proportional&&(u.proportional=!1),void 0===u.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory&&(u.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory=null),u.home=i,u.piece=null,u.modelName=null,u.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences=_,u.furnitureController=S,u.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory=y,u.undoSupport=C,u.contentManager=E,u.setTitle(u.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences.getLocalizedString(t,"importFurnitureWizard.title")),u.furnitureModelStepState=new t.FurnitureModelStepState(u),u.furnitureOrientationStepState=new t.FurnitureOrientationStepState(u),u.furnitureAttributesStepState=new t.FurnitureAttributesStepState(u),u.furnitureIconStepState=new t.FurnitureIconStepState(u),u.setStepState(u.furnitureModelStepState),void 0===u.home&&(u.home=null),void 0===u.piece&&(u.piece=null),void 0===u.modelName&&(u.modelName=null),void 0===u.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences&&(u.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences=null),void 0===u.furnitureController&&(u.furnitureController=null),void 0===u.contentManager&&(u.contentManager=null),void 0===u.undoSupport&&(u.undoSupport=null),void 0===u.furnitureModelStepState&&(u.furnitureModelStepState=null),void 0===u.furnitureOrientationStepState&&(u.furnitureOrientationStepState=null),void 0===u.furnitureAttributesStepState&&(u.furnitureAttributesStepState=null),void 0===u.furnitureIconStepState&&(u.furnitureIconStepState=null),void 0===u.stepsView&&(u.stepsView=null),void 0===u.step&&(u.step=null),void 0===u.name&&(u.name=null),void 0===u.creator&&(u.creator=null),void 0===u.model&&(u.model=null),void 0===u.width&&(u.width=0),void 0===u.proportionalWidth&&(u.proportionalWidth=0),void 0===u.depth&&(u.depth=0),void 0===u.proportionalDepth&&(u.proportionalDepth=0),void 0===u.height&&(u.height=0),void 0===u.proportionalHeight&&(u.proportionalHeight=0),void 0===u.elevation&&(u.elevation=0),void 0===u.movable&&(u.movable=!1),void 0===u.doorOrWindow&&(u.doorOrWindow=!1),void 0===u.staircaseCutOutShape&&(u.staircaseCutOutShape=null),void 0===u.color&&(u.color=null),void 0===u.category&&(u.category=null),void 0===u.modelSize&&(u.modelSize=0),void 0===u.modelRotation&&(u.modelRotation=null),void 0===u.edgeColorMaterialHidden&&(u.edgeColorMaterialHidden=!1),void 0===u.backFaceShown&&(u.backFaceShown=!1),void 0===u.iconYaw&&(u.iconYaw=0),void 0===u.iconPitch&&(u.iconPitch=0),void 0===u.iconScale&&(u.iconScale=0),void 0===u.proportional&&(u.proportional=!1),void 0===u.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory&&(u.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory=null)}else if(("string"==typeof i||null===i)&&(null!=n&&n instanceof UserPreferences||null===n)&&(null!=o&&null!=o.constructor&&null!=o.constructor.__interfaces&&o.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0||null===o)&&(null!=r&&null!=r.constructor&&null!=r.constructor.__interfaces&&r.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ContentManager")>=0||null===r)&&void 0===l&&void 0===a&&void 0===s&&void 0===h){var P=(d=arguments)[0],w=d[1],L=d[2],T=d[3];void 0===(u=e.call(this,w,L)||this).home&&(u.home=null),void 0===u.piece&&(u.piece=null),void 0===u.modelName&&(u.modelName=null),void 0===u.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences&&(u.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences=null),void 0===u.furnitureController&&(u.furnitureController=null),void 0===u.contentManager&&(u.contentManager=null),void 0===u.undoSupport&&(u.undoSupport=null),void 0===u.furnitureModelStepState&&(u.furnitureModelStepState=null),void 0===u.furnitureOrientationStepState&&(u.furnitureOrientationStepState=null),void 0===u.furnitureAttributesStepState&&(u.furnitureAttributesStepState=null),void 0===u.furnitureIconStepState&&(u.furnitureIconStepState=null),void 0===u.stepsView&&(u.stepsView=null),void 0===u.step&&(u.step=null),void 0===u.name&&(u.name=null),void 0===u.creator&&(u.creator=null),void 0===u.model&&(u.model=null),void 0===u.width&&(u.width=0),void 0===u.proportionalWidth&&(u.proportionalWidth=0),void 0===u.depth&&(u.depth=0),void 0===u.proportionalDepth&&(u.proportionalDepth=0),void 0===u.height&&(u.height=0),void 0===u.proportionalHeight&&(u.proportionalHeight=0),void 0===u.elevation&&(u.elevation=0),void 0===u.movable&&(u.movable=!1),void 0===u.doorOrWindow&&(u.doorOrWindow=!1),void 0===u.staircaseCutOutShape&&(u.staircaseCutOutShape=null),void 0===u.color&&(u.color=null),void 0===u.category&&(u.category=null),void 0===u.modelSize&&(u.modelSize=0),void 0===u.modelRotation&&(u.modelRotation=null),void 0===u.edgeColorMaterialHidden&&(u.edgeColorMaterialHidden=!1),void 0===u.backFaceShown&&(u.backFaceShown=!1),void 0===u.iconYaw&&(u.iconYaw=0),void 0===u.iconPitch&&(u.iconPitch=0),void 0===u.iconScale&&(u.iconScale=0),void 0===u.proportional&&(u.proportional=!1),void 0===u.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory&&(u.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory=null),u.home=null,u.piece=null,u.modelName=P,u.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences=w,u.furnitureController=null,u.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory=L,u.undoSupport=null,u.contentManager=T,u.setTitle(u.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences.getLocalizedString(t,"importFurnitureWizard.title")),u.furnitureModelStepState=new t.FurnitureModelStepState(u),u.furnitureOrientationStepState=new t.FurnitureOrientationStepState(u),u.furnitureAttributesStepState=new t.FurnitureAttributesStepState(u),u.furnitureIconStepState=new t.FurnitureIconStepState(u),u.setStepState(u.furnitureModelStepState),void 0===u.home&&(u.home=null),void 0===u.piece&&(u.piece=null),void 0===u.modelName&&(u.modelName=null),void 0===u.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences&&(u.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences=null),void 0===u.furnitureController&&(u.furnitureController=null),void 0===u.contentManager&&(u.contentManager=null),void 0===u.undoSupport&&(u.undoSupport=null),void 0===u.furnitureModelStepState&&(u.furnitureModelStepState=null),void 0===u.furnitureOrientationStepState&&(u.furnitureOrientationStepState=null),void 0===u.furnitureAttributesStepState&&(u.furnitureAttributesStepState=null),void 0===u.furnitureIconStepState&&(u.furnitureIconStepState=null),void 0===u.stepsView&&(u.stepsView=null),void 0===u.step&&(u.step=null),void 0===u.name&&(u.name=null),void 0===u.creator&&(u.creator=null),void 0===u.model&&(u.model=null),void 0===u.width&&(u.width=0),void 0===u.proportionalWidth&&(u.proportionalWidth=0),void 0===u.depth&&(u.depth=0),void 0===u.proportionalDepth&&(u.proportionalDepth=0),void 0===u.height&&(u.height=0),void 0===u.proportionalHeight&&(u.proportionalHeight=0),void 0===u.elevation&&(u.elevation=0),void 0===u.movable&&(u.movable=!1),void 0===u.doorOrWindow&&(u.doorOrWindow=!1),void 0===u.staircaseCutOutShape&&(u.staircaseCutOutShape=null),void 0===u.color&&(u.color=null),void 0===u.category&&(u.category=null),void 0===u.modelSize&&(u.modelSize=0),void 0===u.modelRotation&&(u.modelRotation=null),void 0===u.edgeColorMaterialHidden&&(u.edgeColorMaterialHidden=!1),void 0===u.backFaceShown&&(u.backFaceShown=!1),void 0===u.iconYaw&&(u.iconYaw=0),void 0===u.iconPitch&&(u.iconPitch=0),void 0===u.iconScale&&(u.iconScale=0),void 0===u.proportional&&(u.proportional=!1),void 0===u.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory&&(u.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory=null)}else if((null!=i&&i instanceof CatalogPieceOfFurniture||null===i)&&(null!=n&&n instanceof UserPreferences||null===n)&&(null!=o&&null!=o.constructor&&null!=o.constructor.__interfaces&&o.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0||null===o)&&(null!=r&&null!=r.constructor&&null!=r.constructor.__interfaces&&r.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ContentManager")>=0||null===r)&&void 0===l&&void 0===a&&void 0===s&&void 0===h){var A=(d=arguments)[0],I=d[1],b=d[2],O=d[3];void 0===(u=e.call(this,I,b)||this).home&&(u.home=null),void 0===u.piece&&(u.piece=null),void 0===u.modelName&&(u.modelName=null),void 0===u.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences&&(u.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences=null),void 0===u.furnitureController&&(u.furnitureController=null),void 0===u.contentManager&&(u.contentManager=null),void 0===u.undoSupport&&(u.undoSupport=null),void 0===u.furnitureModelStepState&&(u.furnitureModelStepState=null),void 0===u.furnitureOrientationStepState&&(u.furnitureOrientationStepState=null),void 0===u.furnitureAttributesStepState&&(u.furnitureAttributesStepState=null),void 0===u.furnitureIconStepState&&(u.furnitureIconStepState=null),void 0===u.stepsView&&(u.stepsView=null),void 0===u.step&&(u.step=null),void 0===u.name&&(u.name=null),void 0===u.creator&&(u.creator=null),void 0===u.model&&(u.model=null),void 0===u.width&&(u.width=0),void 0===u.proportionalWidth&&(u.proportionalWidth=0),void 0===u.depth&&(u.depth=0),void 0===u.proportionalDepth&&(u.proportionalDepth=0),void 0===u.height&&(u.height=0),void 0===u.proportionalHeight&&(u.proportionalHeight=0),void 0===u.elevation&&(u.elevation=0),void 0===u.movable&&(u.movable=!1),void 0===u.doorOrWindow&&(u.doorOrWindow=!1),void 0===u.staircaseCutOutShape&&(u.staircaseCutOutShape=null),void 0===u.color&&(u.color=null),void 0===u.category&&(u.category=null),void 0===u.modelSize&&(u.modelSize=0),void 0===u.modelRotation&&(u.modelRotation=null),void 0===u.edgeColorMaterialHidden&&(u.edgeColorMaterialHidden=!1),void 0===u.backFaceShown&&(u.backFaceShown=!1),void 0===u.iconYaw&&(u.iconYaw=0),void 0===u.iconPitch&&(u.iconPitch=0),void 0===u.iconScale&&(u.iconScale=0),void 0===u.proportional&&(u.proportional=!1),void 0===u.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory&&(u.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory=null),u.home=null,u.piece=A,u.modelName=null,u.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences=I,u.furnitureController=null,u.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory=b,u.undoSupport=null,u.contentManager=O,u.setTitle(u.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences.getLocalizedString(t,null==A?"importFurnitureWizard.title":"modifyFurnitureWizard.title")),u.furnitureModelStepState=new t.FurnitureModelStepState(u),u.furnitureOrientationStepState=new t.FurnitureOrientationStepState(u),u.furnitureAttributesStepState=new t.FurnitureAttributesStepState(u),u.furnitureIconStepState=new t.FurnitureIconStepState(u),u.setStepState(u.furnitureModelStepState),void 0===u.home&&(u.home=null),void 0===u.piece&&(u.piece=null),void 0===u.modelName&&(u.modelName=null),void 0===u.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences&&(u.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences=null),void 0===u.furnitureController&&(u.furnitureController=null),void 0===u.contentManager&&(u.contentManager=null),void 0===u.undoSupport&&(u.undoSupport=null),void 0===u.furnitureModelStepState&&(u.furnitureModelStepState=null),void 0===u.furnitureOrientationStepState&&(u.furnitureOrientationStepState=null),void 0===u.furnitureAttributesStepState&&(u.furnitureAttributesStepState=null),void 0===u.furnitureIconStepState&&(u.furnitureIconStepState=null),void 0===u.stepsView&&(u.stepsView=null),void 0===u.step&&(u.step=null),void 0===u.name&&(u.name=null),void 0===u.creator&&(u.creator=null),void 0===u.model&&(u.model=null),void 0===u.width&&(u.width=0),void 0===u.proportionalWidth&&(u.proportionalWidth=0),void 0===u.depth&&(u.depth=0),void 0===u.proportionalDepth&&(u.proportionalDepth=0),void 0===u.height&&(u.height=0),void 0===u.proportionalHeight&&(u.proportionalHeight=0),void 0===u.elevation&&(u.elevation=0),void 0===u.movable&&(u.movable=!1),void 0===u.doorOrWindow&&(u.doorOrWindow=!1),void 0===u.staircaseCutOutShape&&(u.staircaseCutOutShape=null),void 0===u.color&&(u.color=null),void 0===u.category&&(u.category=null),void 0===u.modelSize&&(u.modelSize=0),void 0===u.modelRotation&&(u.modelRotation=null),void 0===u.edgeColorMaterialHidden&&(u.edgeColorMaterialHidden=!1),void 0===u.backFaceShown&&(u.backFaceShown=!1),void 0===u.iconYaw&&(u.iconYaw=0),void 0===u.iconPitch&&(u.iconPitch=0),void 0===u.iconScale&&(u.iconScale=0),void 0===u.proportional&&(u.proportional=!1),void 0===u.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory&&(u.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory=null)}else{if(!((null!=i&&i instanceof UserPreferences||null===i)&&(null!=n&&null!=n.constructor&&null!=n.constructor.__interfaces&&n.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0||null===n)&&(null!=o&&null!=o.constructor&&null!=o.constructor.__interfaces&&o.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ContentManager")>=0||null===o)&&void 0===r&&void 0===l&&void 0===a&&void 0===s&&void 0===h))throw new Error("invalid overload");var M=(d=arguments)[0],D=d[1],R=d[2];void 0===(u=e.call(this,M,D)||this).home&&(u.home=null),void 0===u.piece&&(u.piece=null),void 0===u.modelName&&(u.modelName=null),void 0===u.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences&&(u.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences=null),void 0===u.furnitureController&&(u.furnitureController=null),void 0===u.contentManager&&(u.contentManager=null),void 0===u.undoSupport&&(u.undoSupport=null),void 0===u.furnitureModelStepState&&(u.furnitureModelStepState=null),void 0===u.furnitureOrientationStepState&&(u.furnitureOrientationStepState=null),void 0===u.furnitureAttributesStepState&&(u.furnitureAttributesStepState=null),void 0===u.furnitureIconStepState&&(u.furnitureIconStepState=null),void 0===u.stepsView&&(u.stepsView=null),void 0===u.step&&(u.step=null),void 0===u.name&&(u.name=null),void 0===u.creator&&(u.creator=null),void 0===u.model&&(u.model=null),void 0===u.width&&(u.width=0),void 0===u.proportionalWidth&&(u.proportionalWidth=0),void 0===u.depth&&(u.depth=0),void 0===u.proportionalDepth&&(u.proportionalDepth=0),void 0===u.height&&(u.height=0),void 0===u.proportionalHeight&&(u.proportionalHeight=0),void 0===u.elevation&&(u.elevation=0),void 0===u.movable&&(u.movable=!1),void 0===u.doorOrWindow&&(u.doorOrWindow=!1),void 0===u.staircaseCutOutShape&&(u.staircaseCutOutShape=null),void 0===u.color&&(u.color=null),void 0===u.category&&(u.category=null),void 0===u.modelSize&&(u.modelSize=0),void 0===u.modelRotation&&(u.modelRotation=null),void 0===u.edgeColorMaterialHidden&&(u.edgeColorMaterialHidden=!1),void 0===u.backFaceShown&&(u.backFaceShown=!1),void 0===u.iconYaw&&(u.iconYaw=0),void 0===u.iconPitch&&(u.iconPitch=0),void 0===u.iconScale&&(u.iconScale=0),void 0===u.proportional&&(u.proportional=!1),void 0===u.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory&&(u.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory=null),u.home=null,u.piece=null,u.modelName=null,u.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences=M,u.furnitureController=null,u.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory=D,u.undoSupport=null,u.contentManager=R,u.setTitle(u.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences.getLocalizedString(t,"importFurnitureWizard.title")),u.furnitureModelStepState=new t.FurnitureModelStepState(u),u.furnitureOrientationStepState=new t.FurnitureOrientationStepState(u),u.furnitureAttributesStepState=new t.FurnitureAttributesStepState(u),u.furnitureIconStepState=new t.FurnitureIconStepState(u),u.setStepState(u.furnitureModelStepState),void 0===u.home&&(u.home=null),void 0===u.piece&&(u.piece=null),void 0===u.modelName&&(u.modelName=null),void 0===u.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences&&(u.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences=null),void 0===u.furnitureController&&(u.furnitureController=null),void 0===u.contentManager&&(u.contentManager=null),void 0===u.undoSupport&&(u.undoSupport=null),void 0===u.furnitureModelStepState&&(u.furnitureModelStepState=null),void 0===u.furnitureOrientationStepState&&(u.furnitureOrientationStepState=null),void 0===u.furnitureAttributesStepState&&(u.furnitureAttributesStepState=null),void 0===u.furnitureIconStepState&&(u.furnitureIconStepState=null),void 0===u.stepsView&&(u.stepsView=null),void 0===u.step&&(u.step=null),void 0===u.name&&(u.name=null),void 0===u.creator&&(u.creator=null),void 0===u.model&&(u.model=null),void 0===u.width&&(u.width=0),void 0===u.proportionalWidth&&(u.proportionalWidth=0),void 0===u.depth&&(u.depth=0),void 0===u.proportionalDepth&&(u.proportionalDepth=0),void 0===u.height&&(u.height=0),void 0===u.proportionalHeight&&(u.proportionalHeight=0),void 0===u.elevation&&(u.elevation=0),void 0===u.movable&&(u.movable=!1),void 0===u.doorOrWindow&&(u.doorOrWindow=!1),void 0===u.staircaseCutOutShape&&(u.staircaseCutOutShape=null),void 0===u.color&&(u.color=null),void 0===u.category&&(u.category=null),void 0===u.modelSize&&(u.modelSize=0),void 0===u.modelRotation&&(u.modelRotation=null),void 0===u.edgeColorMaterialHidden&&(u.edgeColorMaterialHidden=!1),void 0===u.backFaceShown&&(u.backFaceShown=!1),void 0===u.iconYaw&&(u.iconYaw=0),void 0===u.iconPitch&&(u.iconPitch=0),void 0===u.iconScale&&(u.iconScale=0),void 0===u.proportional&&(u.proportional=!1),void 0===u.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory&&(u.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory=null)}return u}return __extends(t,e),t.prototype.finish=function(){var e,t=(this.isBackFaceShown()?PieceOfFurniture.SHOW_BACK_FACE:0)|(this.isEdgeColorMaterialHidden()?PieceOfFurniture.HIDE_EDGE_COLOR_MATERIAL:0);e=this.isDoorOrWindow()?new CatalogDoorOrWindow(this.getName(),this.getIcon(),this.getModel(),this.getWidth(),this.getDepth(),this.getHeight(),this.getElevation(),this.isMovable(),1,0,[],this.getColor(),this.getModelRotation(),t,this.getModelSize(),this.getCreator(),this.getIconYaw(),this.getIconPitch(),this.getIconScale(),this.isProportional()):new CatalogPieceOfFurniture(this.getName(),this.getIcon(),this.getModel(),this.getWidth(),this.getDepth(),this.getHeight(),this.getElevation(),this.isMovable(),this.getStaircaseCutOutShape(),this.getColor(),this.getModelRotation(),t,this.getModelSize(),this.getCreator(),this.getIconYaw(),this.getIconPitch(),this.getIconScale(),this.isProportional()),null!=this.home&&this.addPieceOfFurniture(this.furnitureController.createHomePieceOfFurniture(e));var i=this.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences.getFurnitureCatalog();null!=this.piece&&i.delete(this.piece),null!=this.category&&i.add(this.category,e)},t.prototype.addPieceOfFurniture=function(e){var i=this.home.isBasePlanLocked(),n=this.home.isAllLevelsSelection(),o=this.home.getSelectedItems(),r=this.home.getFurniture().length;if(this.home.addPieceOfFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture$int(e,r),this.home.setSelectedItems([e]),!e.isMovable()&&i&&this.home.setBasePlanLocked(!1),this.home.setAllLevelsSelection(!1),null!=this.undoSupport){var l=new t.PieceOfFurnitureImportationUndoableEdit(this.home,this.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences,o.slice(0),i,n,e,r);this.undoSupport.postEdit(l)}},t.prototype.getContentManager=function(){return this.contentManager},t.prototype.getStepState=function(){return e.prototype.getStepState.call(this)},t.prototype.getFurnitureModelStepState=function(){return this.furnitureModelStepState},t.prototype.getFurnitureOrientationStepState=function(){return this.furnitureOrientationStepState},t.prototype.getFurnitureAttributesStepState=function(){return this.furnitureAttributesStepState},t.prototype.getFurnitureIconStepState=function(){return this.furnitureIconStepState},t.prototype.getStepsView=function(){return null==this.stepsView&&(this.stepsView=this.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory.createImportedFurnitureWizardStepsView(this.piece,this.modelName,null!=this.home,this.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences,this)),this.stepsView},t.prototype.setStep=function(e){if(e!==this.step){var t=this.step;this.step=e,this.propertyChangeSupport.firePropertyChange("STEP",t,e)}},t.prototype.getStep=function(){return this.step},t.prototype.getModel=function(){return this.model},t.prototype.setModel=function(e){if(e!==this.model){var t=this.model;this.model=e,this.propertyChangeSupport.firePropertyChange("MODEL",t,e)}},t.prototype.isBackFaceShown=function(){return this.backFaceShown},t.prototype.setBackFaceShown=function(e){e!==this.backFaceShown&&(this.backFaceShown=e,this.propertyChangeSupport.firePropertyChange("BACK_FACE_SHOWN",!e,e))},t.prototype.getModelSize=function(){return this.modelSize},t.prototype.setModelSize=function(e){if(e!==this.modelSize){var t=this.modelSize;this.modelSize=e,this.propertyChangeSupport.firePropertyChange("MODEL_SIZE",t,e)}},t.prototype.getModelRotation=function(){return this.modelRotation},t.prototype.setModelRotation=function(e){if(e!==this.modelRotation){var t=this.modelRotation;this.modelRotation=e,this.propertyChangeSupport.firePropertyChange("MODEL_ROTATION",t,e)}},t.prototype.isEdgeColorMaterialHidden=function(){return this.edgeColorMaterialHidden},t.prototype.setEdgeColorMaterialHidden=function(e){e!==this.edgeColorMaterialHidden&&(this.edgeColorMaterialHidden=e,this.propertyChangeSupport.firePropertyChange("EDGE_COLOR_MATERIAL_HIDDEN",!e,e))},t.prototype.getName=function(){return this.name},t.prototype.setName=function(e){if(e!==this.name){var t=this.name;this.name=e,null!=this.propertyChangeSupport&&this.propertyChangeSupport.firePropertyChange("NAME",t,e)}},t.prototype.getCreator=function(){return this.creator},t.prototype.setCreator=function(e){if(e!==this.creator){var t=this.creator;this.creator=e,null!=this.propertyChangeSupport&&this.propertyChangeSupport.firePropertyChange("CREATOR",t,e)}},t.prototype.getWidth=function(){return this.width},t.prototype.setWidth$float=function(e){this.setWidth$float$boolean(e,!1)},t.prototype.setWidth$float$boolean=function(e,t){var i=Math.max(e,.001);if(i!==e&&t||(this.proportionalWidth=e),i!==this.width){var n=this.width;this.width=i,this.propertyChangeSupport.firePropertyChange("WIDTH",n,i)}},t.prototype.setWidth=function(e,t){if("number"!=typeof e&&null!==e||"boolean"!=typeof t&&null!==t){if("number"!=typeof e&&null!==e||void 0!==t)throw new Error("invalid overload");return this.setWidth$float(e)}return this.setWidth$float$boolean(e,t)},t.prototype.getDepth=function(){return this.depth},t.prototype.setDepth$float=function(e){this.setDepth$float$boolean(e,!1)},t.prototype.setDepth$float$boolean=function(e,t){var i=Math.max(e,.001);if(i!==e&&t||(this.proportionalDepth=e),i!==this.depth){var n=this.depth;this.depth=i,this.propertyChangeSupport.firePropertyChange("DEPTH",n,i)}},t.prototype.setDepth=function(e,t){if("number"!=typeof e&&null!==e||"boolean"!=typeof t&&null!==t){if("number"!=typeof e&&null!==e||void 0!==t)throw new Error("invalid overload");return this.setDepth$float(e)}return this.setDepth$float$boolean(e,t)},t.prototype.getHeight=function(){return this.height},t.prototype.setHeight$float=function(e){this.setHeight$float$boolean(e,!1)},t.prototype.setHeight$float$boolean=function(e,t){var i=Math.max(e,.001);if(i!==e&&t||(this.proportionalHeight=e),i!==this.height){var n=this.height;this.height=i,this.propertyChangeSupport.firePropertyChange("HEIGHT",n,i)}},t.prototype.setHeight=function(e,t){if("number"!=typeof e&&null!==e||"boolean"!=typeof t&&null!==t){if("number"!=typeof e&&null!==e||void 0!==t)throw new Error("invalid overload");return this.setHeight$float(e)}return this.setHeight$float$boolean(e,t)},t.prototype.getElevation=function(){return this.elevation},t.prototype.setElevation=function(e){if(e!==this.elevation){var t=this.elevation;this.elevation=e,this.propertyChangeSupport.firePropertyChange("ELEVATION",t,e)}},t.prototype.isMovable=function(){return this.movable},t.prototype.setMovable=function(e){e!==this.movable&&(this.movable=e,this.propertyChangeSupport.firePropertyChange("MOVABLE",!e,e))},t.prototype.isDoorOrWindow=function(){return this.doorOrWindow},t.prototype.setDoorOrWindow=function(e){e!==this.doorOrWindow&&(this.doorOrWindow=e,this.propertyChangeSupport.firePropertyChange("DOOR_OR_WINDOW",!e,e),e&&(this.setStaircaseCutOutShape(null),this.setMovable(!1)))},t.prototype.getStaircaseCutOutShape=function(){return this.staircaseCutOutShape},t.prototype.setStaircaseCutOutShape=function(e){if(e!==this.staircaseCutOutShape){var t=this.staircaseCutOutShape;this.staircaseCutOutShape=e,null!=this.propertyChangeSupport&&this.propertyChangeSupport.firePropertyChange("STAIRCASE_CUT_OUT_SHAPE",t,e),null!=this.staircaseCutOutShape&&(this.setDoorOrWindow(!1),this.setMovable(!1))}},t.prototype.getColor=function(){return this.color},t.prototype.setColor=function(e){if(e!==this.color){var t=this.color;this.color=e,this.propertyChangeSupport.firePropertyChange("COLOR",t,e)}},t.prototype.getCategory=function(){return this.category},t.prototype.setCategory=function(e){if(e!==this.category){var t=this.category;this.category=e,this.propertyChangeSupport.firePropertyChange("CATEGORY",t,e)}},t.prototype.getIcon=function(){return this.getStepsView().getIcon()},t.prototype.getIconYaw=function(){return this.iconYaw},t.prototype.setIconYaw=function(e){if(e!==this.iconYaw){var t=this.iconYaw;this.iconYaw=e,this.propertyChangeSupport.firePropertyChange("ICON_YAW",t,e)}},t.prototype.getIconPitch=function(){return this.iconPitch},t.prototype.setIconPitch=function(e){if(e!==this.iconPitch){var t=this.iconPitch;this.iconPitch=e,this.propertyChangeSupport.firePropertyChange("ICON_PITCH",t,e)}},t.prototype.getIconScale=function(){return this.iconScale},t.prototype.setIconScale=function(e){if(e!==this.iconScale){var t=this.iconScale;this.iconScale=e,this.propertyChangeSupport.firePropertyChange("ICON_SCALE",t,e)}},t.prototype.isProportional=function(){return this.proportional},t.prototype.setProportional=function(e){e!==this.proportional&&(this.proportional=e,this.propertyChangeSupport.firePropertyChange("PROPORTIONAL",!e,e))},t.prototype.isPieceOfFurnitureNameValid=function(){return null!=this.name&&this.name.length>0},t}(WizardController);ImportedFurnitureWizardController.__class="com.eteks.sweethome3d.viewcontroller.ImportedFurnitureWizardController",ImportedFurnitureWizardController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"],function(e){var t;(t=e.Step||(e.Step={}))[t.MODEL=0]="MODEL",t[t.ROTATION=1]="ROTATION",t[t.ATTRIBUTES=2]="ATTRIBUTES",t[t.ICON=3]="ICON";var i=function(t){function i(i,n,o,r,l,a,s){var h=t.call(this,n,e,"undoImportFurnitureName")||this;return void 0===h.home&&(h.home=null),void 0===h.oldSelection&&(h.oldSelection=null),void 0===h.oldBasePlanLocked&&(h.oldBasePlanLocked=!1),void 0===h.oldAllLevelsSelection&&(h.oldAllLevelsSelection=!1),void 0===h.piece&&(h.piece=null),void 0===h.pieceIndex&&(h.pieceIndex=0),h.home=i,h.oldSelection=o,h.oldBasePlanLocked=r,h.oldAllLevelsSelection=l,h.piece=a,h.pieceIndex=s,h}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),this.home.deletePieceOfFurniture(this.piece),this.home.setSelectedItems(this.oldSelection.slice(0)),this.home.setAllLevelsSelection(this.oldAllLevelsSelection),this.home.setBasePlanLocked(this.oldBasePlanLocked)},i.prototype.redo=function(){t.prototype.redo.call(this),this.home.addPieceOfFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture$int(this.piece,this.pieceIndex),this.home.setSelectedItems([this.piece]),!this.piece.isMovable()&&this.oldBasePlanLocked&&this.home.setBasePlanLocked(!1),this.home.setAllLevelsSelection(!1)},i}(LocalizedUndoableEdit);e.PieceOfFurnitureImportationUndoableEdit=i,i.__class="com.eteks.sweethome3d.viewcontroller.ImportedFurnitureWizardController.PieceOfFurnitureImportationUndoableEdit",i.__interfaces=["javax.swing.undo.UndoableEdit"];var n=function(e){function t(t){var i=e.call(this)||this;return i.__parent=t,i.icon="resources/importedFurnitureWizard.png",i}return __extends(t,e),t.prototype.enter=function(){this.__parent.setStep(this.getStep())},t.prototype.getView=function(){return this.__parent.getStepsView()},t.prototype.getIcon=function(){return this.icon},t}(WizardController.WizardControllerStepState);e.ImportedFurnitureWizardStepState=n,n.__class="com.eteks.sweethome3d.viewcontroller.ImportedFurnitureWizardController.ImportedFurnitureWizardStepState";var o=function(t){function i(e){var n=t.call(this,e)||this;return n.__parent=e,n.modelChangeListener=new i.FurnitureModelStepState$0(n),n}return __extends(i,t),i.prototype.enter=function(){t.prototype.enter.call(this),this.setFirstStep(!0),this.setNextStepEnabled(null!=this.__parent.getModel()),this.__parent.addPropertyChangeListener("MODEL",this.modelChangeListener)},i.prototype.getStep=function(){return e.Step.MODEL},i.prototype.goToNextStep=function(){this.__parent.setStepState(this.__parent.getFurnitureOrientationStepState())},i.prototype.exit=function(){this.__parent.removePropertyChangeListener("MODEL",this.modelChangeListener)},i}(e.ImportedFurnitureWizardStepState);e.FurnitureModelStepState=o,o.__class="com.eteks.sweethome3d.viewcontroller.ImportedFurnitureWizardController.FurnitureModelStepState",function(e){var t=function(){function e(e){this.__parent=e}return e.prototype.propertyChange=function(e){this.__parent.setNextStepEnabled(null!=this.__parent.__parent.getModel())},e}();e.FurnitureModelStepState$0=t}(o=e.FurnitureModelStepState||(e.FurnitureModelStepState={}));var r=function(t){function i(e){var i=t.call(this,e)||this;return i.__parent=e,i}return __extends(i,t),i.prototype.enter=function(){t.prototype.enter.call(this),this.setNextStepEnabled(!0)},i.prototype.getStep=function(){return e.Step.ROTATION},i.prototype.goBackToPreviousStep=function(){this.__parent.setStepState(this.__parent.getFurnitureModelStepState())},i.prototype.goToNextStep=function(){this.__parent.setStepState(this.__parent.getFurnitureAttributesStepState())},i}(e.ImportedFurnitureWizardStepState);e.FurnitureOrientationStepState=r,r.__class="com.eteks.sweethome3d.viewcontroller.ImportedFurnitureWizardController.FurnitureOrientationStepState";var l=function(t){function i(e){var n=t.call(this,e)||this;return n.__parent=e,n.widthChangeListener=new i.FurnitureAttributesStepState$0(n),n.depthChangeListener=new i.FurnitureAttributesStepState$1(n),n.heightChangeListener=new i.FurnitureAttributesStepState$2(n),n.nameAndCategoryChangeListener=new i.FurnitureAttributesStepState$3(n),n}return __extends(i,t),i.prototype.enter=function(){t.prototype.enter.call(this),this.__parent.addPropertyChangeListener("WIDTH",this.widthChangeListener),this.__parent.addPropertyChangeListener("DEPTH",this.depthChangeListener),this.__parent.addPropertyChangeListener("HEIGHT",this.heightChangeListener),this.__parent.addPropertyChangeListener("NAME",this.nameAndCategoryChangeListener),this.__parent.addPropertyChangeListener("CATEGORY",this.nameAndCategoryChangeListener),this.checkPieceOfFurnitureNameInCategory()},i.prototype.checkPieceOfFurnitureNameInCategory=function(){this.setNextStepEnabled(this.__parent.isPieceOfFurnitureNameValid())},i.prototype.getStep=function(){return e.Step.ATTRIBUTES},i.prototype.goBackToPreviousStep=function(){this.__parent.setStepState(this.__parent.getFurnitureOrientationStepState())},i.prototype.goToNextStep=function(){this.__parent.setStepState(this.__parent.getFurnitureIconStepState())},i.prototype.exit=function(){this.__parent.removePropertyChangeListener("WIDTH",this.widthChangeListener),this.__parent.removePropertyChangeListener("DEPTH",this.depthChangeListener),this.__parent.removePropertyChangeListener("HEIGHT",this.heightChangeListener),this.__parent.removePropertyChangeListener("NAME",this.nameAndCategoryChangeListener),this.__parent.removePropertyChangeListener("CATEGORY",this.nameAndCategoryChangeListener)},i}(e.ImportedFurnitureWizardStepState);e.FurnitureAttributesStepState=l,l.__class="com.eteks.sweethome3d.viewcontroller.ImportedFurnitureWizardController.FurnitureAttributesStepState",function(e){var t=function(){function e(e){this.__parent=e}return e.prototype.propertyChange=function(e){if(this.__parent.__parent.isProportional()){this.__parent.__parent.removePropertyChangeListener("DEPTH",this.__parent.depthChangeListener),this.__parent.__parent.removePropertyChangeListener("HEIGHT",this.__parent.heightChangeListener);var t=e.getNewValue()/e.getOldValue();this.__parent.__parent.setDepth(this.__parent.__parent.proportionalDepth*t,!0),this.__parent.__parent.setHeight(this.__parent.__parent.proportionalHeight*t,!0),this.__parent.__parent.addPropertyChangeListener("DEPTH",this.__parent.depthChangeListener),this.__parent.__parent.addPropertyChangeListener("HEIGHT",this.__parent.heightChangeListener)}},e}();e.FurnitureAttributesStepState$0=t;var i=function(){function e(e){this.__parent=e}return e.prototype.propertyChange=function(e){if(this.__parent.__parent.isProportional()){this.__parent.__parent.removePropertyChangeListener("WIDTH",this.__parent.widthChangeListener),this.__parent.__parent.removePropertyChangeListener("HEIGHT",this.__parent.heightChangeListener);var t=e.getNewValue()/e.getOldValue();this.__parent.__parent.setWidth(this.__parent.__parent.proportionalWidth*t,!0),this.__parent.__parent.setHeight(this.__parent.__parent.proportionalHeight*t,!0),this.__parent.__parent.addPropertyChangeListener("WIDTH",this.__parent.widthChangeListener),this.__parent.__parent.addPropertyChangeListener("HEIGHT",this.__parent.heightChangeListener)}},e}();e.FurnitureAttributesStepState$1=i;var n=function(){function e(e){this.__parent=e}return e.prototype.propertyChange=function(e){if(this.__parent.__parent.isProportional()){this.__parent.__parent.removePropertyChangeListener("WIDTH",this.__parent.widthChangeListener),this.__parent.__parent.removePropertyChangeListener("DEPTH",this.__parent.depthChangeListener);var t=e.getNewValue()/e.getOldValue();this.__parent.__parent.setWidth(this.__parent.__parent.proportionalWidth*t,!0),this.__parent.__parent.setDepth(this.__parent.__parent.proportionalDepth*t,!0),this.__parent.__parent.addPropertyChangeListener("WIDTH",this.__parent.widthChangeListener),this.__parent.__parent.addPropertyChangeListener("DEPTH",this.__parent.depthChangeListener)}},e}();e.FurnitureAttributesStepState$2=n;var o=function(){function e(e){this.__parent=e}return e.prototype.propertyChange=function(e){this.__parent.checkPieceOfFurnitureNameInCategory()},e}();e.FurnitureAttributesStepState$3=o}(l=e.FurnitureAttributesStepState||(e.FurnitureAttributesStepState={}));var a=function(t){function i(e){var i=t.call(this,e)||this;return i.__parent=e,i}return __extends(i,t),i.prototype.enter=function(){t.prototype.enter.call(this),this.setLastStep(!0),this.setNextStepEnabled(!0)},i.prototype.getStep=function(){return e.Step.ICON},i.prototype.goBackToPreviousStep=function(){this.__parent.setStepState(this.__parent.getFurnitureAttributesStepState())},i}(e.ImportedFurnitureWizardStepState);e.FurnitureIconStepState=a,a.__class="com.eteks.sweethome3d.viewcontroller.ImportedFurnitureWizardController.FurnitureIconStepState"}(ImportedFurnitureWizardController||(ImportedFurnitureWizardController={}));var PageSetupController=function(){function e(e,t,i,n){void 0===this.home&&(this.home=null),void 0===this.preferences&&(this.preferences=null),void 0===this.viewFactory&&(this.viewFactory=null),void 0===this.undoSupport&&(this.undoSupport=null),void 0===this.propertyChangeSupport&&(this.propertyChangeSupport=null),void 0===this.pageSetupView&&(this.pageSetupView=null),void 0===this.print&&(this.print=null),this.home=e,this.preferences=t,this.viewFactory=i,this.undoSupport=n,this.propertyChangeSupport=new PropertyChangeSupport(this),this.setPrint(e.getPrint())}return e.prototype.getView=function(){return null==this.pageSetupView&&(this.pageSetupView=this.viewFactory.createPageSetupView(this.preferences,this)),this.pageSetupView},e.prototype.displayView=function(e){this.getView().displayView(e)},e.prototype.addPropertyChangeListener=function(e,t){this.propertyChangeSupport.addPropertyChangeListener(e,t)},e.prototype.removePropertyChangeListener=function(e,t){this.propertyChangeSupport.removePropertyChangeListener(e,t)},e.prototype.setPrint=function(e){if(e!==this.print){var t=this.print;this.print=e,this.propertyChangeSupport.firePropertyChange("PRINT",t,e)}},e.prototype.getPrint=function(){return this.print},e.prototype.getPrintableLevels=function(){return this.home.getLevels()},e.prototype.modifyPageSetup=function(){var t=this.home.getPrint(),i=this.getPrint();this.home.setPrint(i);var n=new e.HomePrintModificationUndoableEdit(this.home,this.preferences,t,i);this.undoSupport.postEdit(n)},e}();PageSetupController.__class="com.eteks.sweethome3d.viewcontroller.PageSetupController",PageSetupController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"],function(e){var t=function(t){function i(i,n,o,r){var l=t.call(this,n,e,"undoPageSetupName")||this;return void 0===l.home&&(l.home=null),void 0===l.oldHomePrint&&(l.oldHomePrint=null),void 0===l.homePrint&&(l.homePrint=null),l.home=i,l.oldHomePrint=o,l.homePrint=r,l}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),this.home.setPrint(this.oldHomePrint)},i.prototype.redo=function(){t.prototype.redo.call(this),this.home.setPrint(this.homePrint)},i}(LocalizedUndoableEdit);e.HomePrintModificationUndoableEdit=t,t.__class="com.eteks.sweethome3d.viewcontroller.PageSetupController.HomePrintModificationUndoableEdit",t.__interfaces=["javax.swing.undo.UndoableEdit"]}(PageSetupController||(PageSetupController={}));var LevelController=function(){function e(e,t,i,n){void 0===this.home&&(this.home=null),void 0===this.preferences&&(this.preferences=null),void 0===this.viewFactory&&(this.viewFactory=null),void 0===this.undoSupport&&(this.undoSupport=null),void 0===this.propertyChangeSupport&&(this.propertyChangeSupport=null),void 0===this.homeLevelView&&(this.homeLevelView=null),void 0===this.name&&(this.name=null),void 0===this.viewable&&(this.viewable=null),void 0===this.elevation&&(this.elevation=null),void 0===this.elevationIndex&&(this.elevationIndex=null),void 0===this.floorThickness&&(this.floorThickness=null),void 0===this.height&&(this.height=null),void 0===this.levels&&(this.levels=null),void 0===this.selectedLevelIndex&&(this.selectedLevelIndex=null),this.home=e,this.preferences=t,this.viewFactory=i,this.undoSupport=n,this.propertyChangeSupport=new PropertyChangeSupport(this),this.updateProperties()}return e.prototype.getView=function(){return null==this.homeLevelView&&(this.homeLevelView=this.viewFactory.createLevelView(this.preferences,this)),this.homeLevelView},e.prototype.displayView=function(e){this.getView().displayView(e)},e.prototype.addPropertyChangeListener=function(e,t){this.propertyChangeSupport.addPropertyChangeListener(e,t)},e.prototype.removePropertyChangeListener=function(e,t){this.propertyChangeSupport.removePropertyChangeListener(e,t)},e.prototype.updateProperties=function(){var e,t,i=this.home.getSelectedLevel();this.setLevels(this.clone((e=[],t=this.home.getLevels(),e.length>=t.length?(e.length=0,e.push.apply(e,t),e):t.slice(0)))),null==i?(this.setSelectedLevelIndex(null),this.setName(null),this.setViewable(!0),this.setElevation(null,!1),this.setFloorThickness(null),this.setHeight(null),this.setElevationIndex(null,!1)):(this.setSelectedLevelIndex(this.home.getLevels().indexOf(i)),this.setName(i.getName()),this.setViewable(i.isViewable()),this.setElevation(i.getElevation(),!1),this.setFloorThickness(i.getFloorThickness()),this.setHeight(i.getHeight()),this.setElevationIndex(i.getElevationIndex(),!1))},e.prototype.clone=function(e){for(var t=0;t<e.length;t++)e[t]=function(e){if(null!=e.clone)return e.clone();var t=Object.create(e);for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t}(e[t]);return e},e.prototype.isPropertyEditable=function(e){return!0},e.prototype.setName=function(e){if(e!==this.name){var t=this.name;this.name=e,this.propertyChangeSupport.firePropertyChange("NAME",t,e),null!=this.selectedLevelIndex&&(this.levels[this.selectedLevelIndex].setName(e),this.propertyChangeSupport.firePropertyChange("LEVELS",null,this.levels))}},e.prototype.getName=function(){return this.name},e.prototype.setViewable=function(e){if(e!==this.viewable){var t=e;this.viewable=e,this.propertyChangeSupport.firePropertyChange("VIEWABLE",t,e),null!=e&&null!=this.selectedLevelIndex&&(this.levels[this.selectedLevelIndex].setViewable(e),this.propertyChangeSupport.firePropertyChange("LEVELS",null,this.levels))}},e.prototype.getViewable=function(){return this.viewable},e.prototype.setElevation=function(t,i){if(void 0===i&&(i=!0),t!==this.elevation){var n=this.elevation;if(this.elevation=t,this.propertyChangeSupport.firePropertyChange("ELEVATION",n,t),i&&null!=t&&null!=this.selectedLevelIndex){var o=e.updateLevelElevation(this.levels[this.selectedLevelIndex],t,this.levels.slice(0));this.setElevationIndex(o,!1),this.updateLevels()}}},e.updateLevelElevation=function(e,t,i){for(var n=i.length,o=0,r=0;r<i.length;r++){var l=i[r];l===e?n=r:l.getElevation()===t?o=l.getElevationIndex()+1:r>n&&l.getElevation()===e.getElevation()&&l.setElevationIndex(l.getElevationIndex()-1)}return e.setElevation(t),e.setElevationIndex(o),o},e.prototype.getElevation=function(){return this.elevation},e.prototype.setElevationIndex=function(t,i){if(void 0===i&&(i=!0),t!==this.elevationIndex){var n=this.elevationIndex;this.elevationIndex=t,this.propertyChangeSupport.firePropertyChange("ELEVATION_INDEX",n,t),i&&null!=t&&null!=this.selectedLevelIndex&&(e.updateLevelElevationIndex(this.levels[this.selectedLevelIndex],t,this.levels.slice(0)),this.updateLevels())}},e.updateLevelElevationIndex=function(e,t,i){for(var n,o=(n=t-e.getElevationIndex())>0?1:n<0?-1:0,r=0;r<i.length;r++){var l=i[r];if(l!==e&&l.getElevation()===e.getElevation()&&function(e){return e>0?1:e<0?-1:0}(l.getElevationIndex()-e.getElevationIndex())===o&&function(e){return e>0?1:e<0?-1:0}(l.getElevationIndex()-t)!==o)l.setElevationIndex(l.getElevationIndex()-(0|o));else if(l.getElevation()>e.getElevation())break}e.setElevationIndex(t)},e.prototype.updateLevels=function(){for(var e=new Home,t=this.levels[this.selectedLevelIndex],i=0;i<this.levels.length;i++){var n=this.levels[i];e.addLevel(n)}var o=e.getLevels();this.setLevels(o.slice(0)),this.setSelectedLevelIndex(o.indexOf(t))},e.prototype.getElevationIndex=function(){return this.elevationIndex},e.prototype.setFloorThickness=function(e){if(e!==this.floorThickness){var t=this.floorThickness;this.floorThickness=e,this.propertyChangeSupport.firePropertyChange("FLOOR_THICKNESS",t,e),null!=e&&null!=this.selectedLevelIndex&&(this.levels[this.selectedLevelIndex].setFloorThickness(e),this.propertyChangeSupport.firePropertyChange("LEVELS",null,this.levels))}},e.prototype.getFloorThickness=function(){return this.floorThickness},e.prototype.setHeight=function(e){if(e!==this.height){var t=this.height;this.height=e,this.propertyChangeSupport.firePropertyChange("HEIGHT",t,e),null!=e&&null!=this.selectedLevelIndex&&(this.levels[this.selectedLevelIndex].setHeight(e),this.propertyChangeSupport.firePropertyChange("LEVELS",null,this.levels))}},e.prototype.getHeight=function(){return this.height},e.prototype.setLevels=function(e){if(e!==this.levels){var t=this.levels;this.levels=e,this.propertyChangeSupport.firePropertyChange("LEVELS",t,e)}},e.prototype.getLevels=function(){return this.levels.slice(0)},e.prototype.setSelectedLevelIndex=function(e){if(e!==this.selectedLevelIndex){var t=this.selectedLevelIndex;this.selectedLevelIndex=e,this.propertyChangeSupport.firePropertyChange("SELECT_LEVEL_INDEX",t,e)}},e.prototype.getSelectedLevelIndex=function(){return this.selectedLevelIndex},e.prototype.modifyLevels=function(){var t=this.home.getSelectedLevel();if(null!=t){var i=this.home.getSelectedItems(),n=this.getName(),o=this.getViewable(),r=this.getElevation(),l=this.getFloorThickness(),a=this.getHeight(),s=this.getElevationIndex(),h=new e.ModifiedLevel(t);if(e.doModifyLevel(this.home,h,n,o,r,l,a,s),null!=this.undoSupport){var u=new e.LevelModificationUndoableEdit(this.home,this.preferences,i.slice(0),h,n,o,r,l,a,s);this.undoSupport.postEdit(u)}null!=n&&this.preferences.addAutoCompletionString("LevelName",n)}},e.doModifyLevel=function(t,i,n,o,r,l,a,s){var h=i.getLevel();if(null!=n&&h.setName(n),null!=o){var u=t.getSelectedItems();h.setViewable(o),t.setSelectedItems(e.getViewableSublist(u))}if(null!=r&&r!==h.getElevation()&&e.updateLevelElevation(h,r,t.getLevels()),null!=s&&e.updateLevelElevationIndex(h,s,t.getLevels()),!t.getEnvironment().isAllLevelsVisible())for(var d=t.getSelectedLevel(),c=!0,p=t.getLevels(),g=0;g<p.length;g++){var m=p[g];m.setVisible(c),m===d&&(c=!1)}null!=l&&h.setFloorThickness(l),null!=a&&h.setHeight(a)},e.getViewableSublist=function(e){for(var t=[],i=0;i<e.length;i++){var n=e[i];null!=n&&null!=n.constructor&&null!=n.constructor.__interfaces&&n.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Elevatable")>=0&&!n.getLevel().isViewable()||t.push(n)}return t},e.undoModifyLevel=function(t,i){i.reset();var n=i.getLevel();i.getElevation()!==n.getElevation()&&e.updateLevelElevation(n,i.getElevation(),t.getLevels()),i.getElevationIndex()!==n.getElevationIndex()&&e.updateLevelElevationIndex(n,i.getElevationIndex(),t.getLevels())},e}();LevelController.__class="com.eteks.sweethome3d.viewcontroller.LevelController",LevelController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"],function(e){var t=function(t){function i(i,n,o,r,l,a,s,h,u,d){var c=t.call(this,n,e,"undoModifyLevelName")||this;return void 0===c.home&&(c.home=null),void 0===c.oldSelection&&(c.oldSelection=null),void 0===c.modifiedLevel&&(c.modifiedLevel=null),void 0===c.name&&(c.name=null),void 0===c.viewable&&(c.viewable=null),void 0===c.elevation&&(c.elevation=null),void 0===c.floorThickness&&(c.floorThickness=null),void 0===c.height&&(c.height=null),void 0===c.elevationIndex&&(c.elevationIndex=null),c.home=i,c.oldSelection=o,c.modifiedLevel=r,c.name=l,c.viewable=a,c.elevation=s,c.floorThickness=h,c.height=u,c.elevationIndex=d,c}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),e.undoModifyLevel(this.home,this.modifiedLevel),this.home.setSelectedLevel(this.modifiedLevel.getLevel()),this.home.setSelectedItems(this.oldSelection.slice(0))},i.prototype.redo=function(){t.prototype.redo.call(this),this.home.setSelectedLevel(this.modifiedLevel.getLevel()),e.doModifyLevel(this.home,this.modifiedLevel,this.name,this.viewable,this.elevation,this.floorThickness,this.height,this.elevationIndex)},i}(LocalizedUndoableEdit);e.LevelModificationUndoableEdit=t,t.__class="com.eteks.sweethome3d.viewcontroller.LevelController.LevelModificationUndoableEdit",t.__interfaces=["javax.swing.undo.UndoableEdit"];var i=function(){function e(e){void 0===this.level&&(this.level=null),void 0===this.name&&(this.name=null),void 0===this.viewable&&(this.viewable=!1),void 0===this.elevation&&(this.elevation=0),void 0===this.floorThickness&&(this.floorThickness=0),void 0===this.height&&(this.height=0),void 0===this.elevationIndex&&(this.elevationIndex=0),this.level=e,this.name=e.getName(),this.viewable=e.isViewable(),this.elevation=e.getElevation(),this.floorThickness=e.getFloorThickness(),this.height=e.getHeight(),this.elevationIndex=e.getElevationIndex()}return e.prototype.getLevel=function(){return this.level},e.prototype.getElevation=function(){return this.elevation},e.prototype.getElevationIndex=function(){return this.elevationIndex},e.prototype.reset=function(){this.level.setName(this.name),this.level.setViewable(this.viewable),this.level.setFloorThickness(this.floorThickness),this.level.setHeight(this.height)},e}();e.ModifiedLevel=i,i.__class="com.eteks.sweethome3d.viewcontroller.LevelController.ModifiedLevel"}(LevelController||(LevelController={}));var WallController=function(){function e(e,t,i,n,o){void 0===this.home&&(this.home=null),void 0===this.preferences&&(this.preferences=null),void 0===this.viewFactory&&(this.viewFactory=null),void 0===this.contentManager&&(this.contentManager=null),void 0===this.undoSupport&&(this.undoSupport=null),void 0===this.leftSideTextureController&&(this.leftSideTextureController=null),void 0===this.leftSideBaseboardController&&(this.leftSideBaseboardController=null),void 0===this.rightSideTextureController&&(this.rightSideTextureController=null),void 0===this.rightSideBaseboardController&&(this.rightSideBaseboardController=null),void 0===this.propertyChangeSupport&&(this.propertyChangeSupport=null),void 0===this.wallView&&(this.wallView=null),void 0===this.editablePoints&&(this.editablePoints=!1),void 0===this.xStart&&(this.xStart=null),void 0===this.yStart&&(this.yStart=null),void 0===this.xEnd&&(this.xEnd=null),void 0===this.yEnd&&(this.yEnd=null),void 0===this.length&&(this.length=null),void 0===this.distanceToEndPoint&&(this.distanceToEndPoint=null),void 0===this.leftSideColor&&(this.leftSideColor=null),void 0===this.leftSidePaint&&(this.leftSidePaint=null),void 0===this.leftSideShininess&&(this.leftSideShininess=null),void 0===this.rightSideColor&&(this.rightSideColor=null),void 0===this.rightSidePaint&&(this.rightSidePaint=null),void 0===this.rightSideShininess&&(this.rightSideShininess=null),void 0===this.pattern&&(this.pattern=null),void 0===this.topColor&&(this.topColor=null),void 0===this.topPaint&&(this.topPaint=null),void 0===this.shape&&(this.shape=null),void 0===this.rectangularWallHeight&&(this.rectangularWallHeight=null),void 0===this.slopingWallHeightAtStart&&(this.slopingWallHeightAtStart=null),void 0===this.sloppingWallHeightAtEnd&&(this.sloppingWallHeightAtEnd=null),void 0===this.thickness&&(this.thickness=null),void 0===this.arcExtentInDegrees&&(this.arcExtentInDegrees=null),this.home=e,this.preferences=t,this.viewFactory=i,this.contentManager=n,this.undoSupport=o,this.propertyChangeSupport=new PropertyChangeSupport(this),this.updateProperties()}return e.prototype.getLeftSideTextureController=function(){return null==this.leftSideTextureController&&(this.leftSideTextureController=new TextureChoiceController(this.preferences.getLocalizedString(e,"leftSideTextureTitle"),this.preferences,this.viewFactory,this.contentManager),this.leftSideTextureController.addPropertyChangeListener("TEXTURE",new e.WallController$0(this))),this.leftSideTextureController},e.prototype.getLeftSideBaseboardController=function(){return null==this.leftSideBaseboardController&&(this.leftSideBaseboardController=new BaseboardChoiceController(this.preferences,this.viewFactory,this.contentManager)),this.leftSideBaseboardController},e.prototype.getRightSideTextureController=function(){return null==this.rightSideTextureController&&(this.rightSideTextureController=new TextureChoiceController(this.preferences.getLocalizedString(e,"rightSideTextureTitle"),this.preferences,this.viewFactory,this.contentManager),this.rightSideTextureController.addPropertyChangeListener("TEXTURE",new e.WallController$1(this))),this.rightSideTextureController},e.prototype.getRightSideBaseboardController=function(){return null==this.rightSideBaseboardController&&(this.rightSideBaseboardController=new BaseboardChoiceController(this.preferences,this.viewFactory,this.contentManager)),this.rightSideBaseboardController},e.prototype.getView=function(){return null==this.wallView&&(this.wallView=this.viewFactory.createWallView(this.preferences,this)),this.wallView},e.prototype.displayView=function(e){this.getView().displayView(e)},e.prototype.addPropertyChangeListener=function(e,t){this.propertyChangeSupport.addPropertyChangeListener(e,t)},e.prototype.removePropertyChangeListener=function(e,t){this.propertyChangeSupport.removePropertyChangeListener(e,t)},e.prototype.updateProperties=function(){var t,i,n=Home.getWallsSubList(this.home.getSelectedItems());if(0==n.length)this.setXStart(null),this.setYStart(null),this.setXEnd(null),this.setYEnd(null),this.setEditablePoints(!1),this.setLeftSideColor(null),this.getLeftSideTextureController().setTexture(null),this.setLeftSidePaint(null),this.setLeftSideShininess(null),this.getLeftSideBaseboardController().setVisible(null),this.getLeftSideBaseboardController().setThickness(null),this.getLeftSideBaseboardController().setHeight(null),this.getLeftSideBaseboardController().setColor(null),this.getLeftSideBaseboardController().getTextureController().setTexture(null),this.getLeftSideBaseboardController().setPaint(null),this.setRightSideColor(null),this.getRightSideTextureController().setTexture(null),this.setRightSidePaint(null),this.setRightSideShininess(null),this.getRightSideBaseboardController().setVisible(null),this.getRightSideBaseboardController().setThickness(null),this.getRightSideBaseboardController().setHeight(null),this.getRightSideBaseboardController().setColor(null),this.getRightSideBaseboardController().getTextureController().setTexture(null),this.getRightSideBaseboardController().setPaint(null),this.setPattern(null),this.setTopColor(null),this.setTopPaint(null),this.setRectangularWallHeight(null),this.setSlopingWallHeightAtStart(null),this.setSlopingWallHeightAtEnd(null),this.setShape(null),this.setThickness(null),this.setArcExtentInDegrees(null);else{var o=n[0],r=n.length>1;this.setEditablePoints(!r);for(var l=o.getXStart(),a=1;a<n.length;a++)if(l!==n[a].getXStart()){l=null;break}this.setXStart(l);var s=o.getYStart();for(a=1;a<n.length;a++)if(s!==n[a].getYStart()){s=null;break}this.setYStart(s);var h=o.getXEnd();for(a=1;a<n.length;a++)if(h!==n[a].getXEnd()){h=null;break}this.setXEnd(h);var u=o.getYEnd();for(a=1;a<n.length;a++)if(u!==n[a].getYEnd()){u=null;break}this.setYEnd(u);var d=o.getLeftSideColor();if(null!=d)for(a=1;a<n.length;a++)if(d!==n[a].getLeftSideColor()){d=null;break}this.setLeftSideColor(d);var c=o.getLeftSideTexture();if(null!=c)for(a=1;a<n.length;a++)if(!c.equals(n[a].getLeftSideTexture())){c=null;break}this.getLeftSideTextureController().setTexture(c);var p=!0;for(a=0;a<n.length;a++){if(null!=(N=n[a]).getLeftSideColor()||null!=N.getLeftSideTexture()){p=!1;break}}null!=d?this.setLeftSidePaint(e.WallPaint.COLORED):null!=c?this.setLeftSidePaint(e.WallPaint.TEXTURED):p?this.setLeftSidePaint(e.WallPaint.DEFAULT):this.setLeftSidePaint(null);var g=o.getLeftSideShininess();for(a=1;a<n.length;a++)if(g!==n[a].getLeftSideShininess()){g=null;break}this.setLeftSideShininess(g);var m=null!=o.getLeftSideBaseboard();for(a=1;a<n.length;a++)if(m!==(null!=n[a].getLeftSideBaseboard())){m=null;break}this.getLeftSideBaseboardController().setVisible(m);var f=o.getLeftSideBaseboard(),v=null!=f?f.getThickness():this.preferences.getNewWallBaseboardThickness();for(a=1;a<n.length;a++){if(v!==(null!=(O=n[a].getLeftSideBaseboard())?O.getThickness():this.preferences.getNewWallBaseboardThickness())){v=null;break}}this.getLeftSideBaseboardController().setThickness(v);var _=null!=f?f.getHeight():this.preferences.getNewWallBaseboardHeight();for(a=1;a<n.length;a++){if(_!==(null!=(O=n[a].getLeftSideBaseboard())?O.getHeight():this.preferences.getNewWallBaseboardHeight())){_=null;break}}this.getLeftSideBaseboardController().setHeight(_);var S=null!=f?f.getColor():null;if(null!=S)for(a=1;a<n.length;a++){if(null==(O=n[a].getLeftSideBaseboard())||S!==O.getColor()){S=null;break}}this.getLeftSideBaseboardController().setColor(S);var y=null!=f?f.getTexture():null;if(null!=y)for(a=1;a<n.length;a++){if(null==(O=n[a].getLeftSideBaseboard())||!y.equals(O.getTexture())){y=null;break}}this.getLeftSideBaseboardController().getTextureController().setTexture(y),p=!0;for(a=0;a<n.length;a++){if(null!=(O=n[a].getLeftSideBaseboard())&&(null!=O.getColor()||null!=O.getTexture())){p=!1;break}}null!=S?this.getLeftSideBaseboardController().setPaint(BaseboardChoiceController.BaseboardPaint.COLORED):null!=y?this.getLeftSideBaseboardController().setPaint(BaseboardChoiceController.BaseboardPaint.TEXTURED):p?this.getLeftSideBaseboardController().setPaint(BaseboardChoiceController.BaseboardPaint.DEFAULT):this.getLeftSideBaseboardController().setPaint(null);var E=o.getRightSideColor();if(null!=E)for(a=1;a<n.length;a++)if(E!==n[a].getRightSideColor()){E=null;break}this.setRightSideColor(E);var C=o.getRightSideTexture();if(null!=C)for(a=1;a<n.length;a++)if(!C.equals(n[a].getRightSideTexture())){C=null;break}this.getRightSideTextureController().setTexture(C),p=!0;for(a=0;a<n.length;a++){if(null!=(N=n[a]).getRightSideColor()||null!=N.getRightSideTexture()){p=!1;break}}null!=E?this.setRightSidePaint(e.WallPaint.COLORED):null!=C?this.setRightSidePaint(e.WallPaint.TEXTURED):p?this.setRightSidePaint(e.WallPaint.DEFAULT):this.setRightSidePaint(null);var P=o.getRightSideShininess();for(a=1;a<n.length;a++)if(P!==n[a].getRightSideShininess()){P=null;break}this.setRightSideShininess(P);var w=null!=o.getRightSideBaseboard();for(a=1;a<n.length;a++)if(w!==(null!=n[a].getRightSideBaseboard())){w=null;break}this.getRightSideBaseboardController().setVisible(w);var L=o.getRightSideBaseboard(),T=null!=L?L.getThickness():this.preferences.getNewWallBaseboardThickness();for(a=1;a<n.length;a++){if(T!==(null!=(O=n[a].getRightSideBaseboard())?O.getThickness():this.preferences.getNewWallBaseboardThickness())){T=null;break}}this.getRightSideBaseboardController().setThickness(T);var A=null!=L?L.getHeight():this.preferences.getNewWallBaseboardHeight();for(a=1;a<n.length;a++){if(A!==(null!=(O=n[a].getRightSideBaseboard())?O.getHeight():this.preferences.getNewWallBaseboardHeight())){A=null;break}}this.getRightSideBaseboardController().setHeight(A);var I=null!=L?L.getColor():null;if(null!=I)for(a=1;a<n.length;a++){if(null==(O=n[a].getRightSideBaseboard())||I!==O.getColor()){I=null;break}}this.getRightSideBaseboardController().setColor(I);var b=null!=L?L.getTexture():null;if(null!=b)for(a=1;a<n.length;a++){if(null==(O=n[a].getRightSideBaseboard())||!b.equals(O.getTexture())){b=null;break}}this.getRightSideBaseboardController().getTextureController().setTexture(b),p=!0;for(a=0;a<n.length;a++){var O;if(null!=(O=n[a].getRightSideBaseboard())&&(null!=O.getColor()||null!=O.getTexture())){p=!1;break}}null!=I?this.getRightSideBaseboardController().setPaint(BaseboardChoiceController.BaseboardPaint.COLORED):null!=b?this.getRightSideBaseboardController().setPaint(BaseboardChoiceController.BaseboardPaint.TEXTURED):p?this.getRightSideBaseboardController().setPaint(BaseboardChoiceController.BaseboardPaint.DEFAULT):this.getRightSideBaseboardController().setPaint(null);var M=o.getPattern();null==M&&(M=this.preferences.getWallPattern());for(a=1;a<n.length;a++){var D=n[a].getPattern();if(null==D&&(D=this.preferences.getWallPattern()),i=D,!((t=M)&&t.equals?t.equals(i):t===i)){M=null;break}}this.setPattern(M);var R=o.getTopColor(),F=void 0;if(null!=R){F=!1;for(a=1;a<n.length;a++)if(R!==n[a].getTopColor()){R=null;break}}else{F=!0;for(a=1;a<n.length;a++)if(null!=n[a].getTopColor()){F=!1;break}}this.setTopColor(R),F?this.setTopPaint(e.WallPaint.DEFAULT):null!=R?this.setTopPaint(e.WallPaint.COLORED):this.setTopPaint(null);var x=o.getHeight();null==x&&null==o.getHeight()&&(x=this.home.getWallHeight());for(a=1;a<n.length;a++){var N;if(x!==(null==(N=n[a]).getHeight()?this.home.getWallHeight():N.getHeight())){x=null;break}}this.setRectangularWallHeight(x),this.setSlopingWallHeightAtStart(x);var k=o.getHeightAtEnd();if(null!=k)for(a=1;a<n.length;a++)if(k!==n[a].getHeightAtEnd()){k=null;break}this.setSlopingWallHeightAtEnd(null==k&&1===n.length?x:k);var H=!o.isTrapezoidal(),V=o.isTrapezoidal();for(a=1;a<n.length;a++)n[a].isTrapezoidal()?H=!1:V=!1;H?this.setShape(e.WallShape.RECTANGULAR_WALL):V?this.setShape(e.WallShape.SLOPING_WALL):this.setShape(null);var U=o.getThickness();for(a=1;a<n.length;a++)if(U!==n[a].getThickness()){U=null;break}this.setThickness(U);var W=o.getArcExtent();if(null!=W)for(a=1;a<n.length;a++)if(W!==n[a].getArcExtent()){W=null;break}null!=W?this.setArcExtentInDegrees(function(e){return 180*e/Math.PI}(W)):this.setArcExtentInDegrees(1===n.length?new Number(0).valueOf():null)}},e.prototype.setXStart=function(e){if(e!==this.xStart){var t=this.xStart;this.xStart=e,this.propertyChangeSupport.firePropertyChange("X_START",t,e),this.updateLength(),this.updateDistanceToEndPoint()}},e.prototype.getXStart=function(){return this.xStart},e.prototype.setYStart=function(e){if(e!==this.yStart){var t=this.yStart;this.yStart=e,this.propertyChangeSupport.firePropertyChange("Y_START",t,e),this.updateLength(),this.updateDistanceToEndPoint()}},e.prototype.getYStart=function(){return this.yStart},e.prototype.setXEnd=function(e){if(e!==this.xEnd){var t=this.xEnd;this.xEnd=e,this.propertyChangeSupport.firePropertyChange("X_END",t,e),this.updateLength(),this.updateDistanceToEndPoint()}},e.prototype.getXEnd=function(){return this.xEnd},e.prototype.setYEnd=function(e){if(e!==this.yEnd){var t=this.yEnd;this.yEnd=e,this.propertyChangeSupport.firePropertyChange("Y_END",t,e),this.updateLength(),this.updateDistanceToEndPoint()}},e.prototype.getYEnd=function(){return this.yEnd},e.prototype.updateLength=function(){var e=this.getXStart(),t=this.getYStart(),i=this.getXEnd(),n=this.getYEnd();if(null!=e&&null!=t&&null!=i&&null!=n){var o=new Wall(e,t,i,n,0,0),r=this.getArcExtentInDegrees();null!=r&&o.setArcExtent(r*Math.PI/180),this.setLength(o.getLength(),!1)}else this.setLength(null,!1)},e.prototype.getLength=function(){return this.length},e.prototype.setLength=function(e,t){if(void 0===t&&(t=!0),e!==this.length){var i=this.length;if(this.length=e,this.propertyChangeSupport.firePropertyChange("LENGTH",i,e),t){var n=this.getXStart(),o=this.getYStart(),r=this.getXEnd(),l=this.getYEnd();if(null!=n&&null!=o&&null!=r&&null!=l&&null!=e){if(null==this.getArcExtentInDegrees()||0!==this.getArcExtentInDegrees())throw new UnsupportedOperationException("Computing end point of a round wall from its length not supported");var a=Math.atan2(o-l,r-n);this.setXEnd(n+e*Math.cos(a)),this.setYEnd(o-e*Math.sin(a))}else this.setXEnd(null),this.setYEnd(null)}}},e.prototype.updateDistanceToEndPoint=function(){var e=this.getXStart(),t=this.getYStart(),i=this.getXEnd(),n=this.getYEnd();null!=e&&null!=t&&null!=i&&null!=n?this.setDistanceToEndPoint(java.awt.geom.Point2D.distance(e,t,i,n),!1):this.setDistanceToEndPoint(null,!1)},e.prototype.setDistanceToEndPoint=function(e,t){if(void 0===t&&(t=!0),e!==this.distanceToEndPoint){var i=this.distanceToEndPoint;if(this.distanceToEndPoint=e,this.propertyChangeSupport.firePropertyChange("DISTANCE_TO_END_POINT",i,e),t){var n=this.getXStart(),o=this.getYStart(),r=this.getXEnd(),l=this.getYEnd();if(null!=n&&null!=o&&null!=r&&null!=l&&null!=e){var a=Math.atan2(o-l,r-n);this.setXEnd(n+e*Math.cos(a)),this.setYEnd(o-e*Math.sin(a))}else this.setXEnd(null),this.setYEnd(null)}}},e.prototype.getDistanceToEndPoint=function(){return this.distanceToEndPoint},e.prototype.setEditablePoints=function(e){e!==this.editablePoints&&(this.editablePoints=e,this.propertyChangeSupport.firePropertyChange("EDITABLE_POINTS",!e,e))},e.prototype.isEditablePoints=function(){return this.editablePoints},e.prototype.setLeftSideColor=function(t){if(t!==this.leftSideColor){var i=this.leftSideColor;this.leftSideColor=t,this.propertyChangeSupport.firePropertyChange("LEFT_SIDE_COLOR",i,t),this.setLeftSidePaint(e.WallPaint.COLORED)}},e.prototype.getLeftSideColor=function(){return this.leftSideColor},e.prototype.setLeftSidePaint=function(e){if(e!==this.leftSidePaint){var t=this.leftSidePaint;this.leftSidePaint=e,this.propertyChangeSupport.firePropertyChange("LEFT_SIDE_PAINT",t,e)}},e.prototype.getLeftSidePaint=function(){return this.leftSidePaint},e.prototype.setLeftSideShininess=function(e){if(e!==this.leftSideShininess){var t=this.leftSideShininess;this.leftSideShininess=e,this.propertyChangeSupport.firePropertyChange("LEFT_SIDE_SHININESS",t,e)}},e.prototype.getLeftSideShininess=function(){return this.leftSideShininess},e.prototype.setRightSideColor=function(t){if(t!==this.rightSideColor){var i=this.rightSideColor;this.rightSideColor=t,this.propertyChangeSupport.firePropertyChange("RIGHT_SIDE_COLOR",i,t),this.setRightSidePaint(e.WallPaint.COLORED)}},e.prototype.getRightSideColor=function(){return this.rightSideColor},e.prototype.setRightSidePaint=function(e){if(e!==this.rightSidePaint){var t=this.rightSidePaint;this.rightSidePaint=e,this.propertyChangeSupport.firePropertyChange("RIGHT_SIDE_PAINT",t,e)}},e.prototype.getRightSidePaint=function(){return this.rightSidePaint},e.prototype.setRightSideShininess=function(e){if(e!==this.rightSideShininess){var t=this.rightSideShininess;this.rightSideShininess=e,this.propertyChangeSupport.firePropertyChange("RIGHT_SIDE_SHININESS",t,e)}},e.prototype.getRightSideShininess=function(){return this.rightSideShininess},e.prototype.setPattern=function(e){if(this.pattern!==e){var t=this.pattern;this.pattern=e,this.propertyChangeSupport.firePropertyChange("PATTERN",t,e)}},e.prototype.getPattern=function(){return this.pattern},e.prototype.setTopColor=function(e){if(e!==this.topColor){var t=this.topColor;this.topColor=e,this.propertyChangeSupport.firePropertyChange("TOP_COLOR",t,e)}},e.prototype.getTopColor=function(){return this.topColor},e.prototype.setTopPaint=function(e){if(e!==this.topPaint){var t=this.topPaint;this.topPaint=e,this.propertyChangeSupport.firePropertyChange("TOP_PAINT",t,e)}},e.prototype.getTopPaint=function(){return this.topPaint},e.prototype.setShape=function(t){if(t!==this.shape){var i=this.shape;if(this.shape=t,this.propertyChangeSupport.firePropertyChange("SHAPE",i,t),t===e.WallShape.RECTANGULAR_WALL)null!=this.rectangularWallHeight&&(this.getLeftSideBaseboardController().setMaxHeight(this.rectangularWallHeight),this.getRightSideBaseboardController().setMaxHeight(this.rectangularWallHeight));else if(t===e.WallShape.SLOPING_WALL)if(null!=this.slopingWallHeightAtStart&&null!=this.sloppingWallHeightAtEnd){var n=Math.max(this.sloppingWallHeightAtEnd,this.slopingWallHeightAtStart);this.getLeftSideBaseboardController().setMaxHeight(n),this.getRightSideBaseboardController().setMaxHeight(n)}else null!=this.slopingWallHeightAtStart?(this.getLeftSideBaseboardController().setMaxHeight(this.slopingWallHeightAtStart),this.getRightSideBaseboardController().setMaxHeight(this.slopingWallHeightAtStart)):null!=this.sloppingWallHeightAtEnd&&(this.getLeftSideBaseboardController().setMaxHeight(this.sloppingWallHeightAtEnd),this.getRightSideBaseboardController().setMaxHeight(this.sloppingWallHeightAtEnd))}},e.prototype.getShape=function(){return this.shape},e.prototype.setRectangularWallHeight=function(t){if(t!==this.rectangularWallHeight){var i=this.rectangularWallHeight;this.rectangularWallHeight=t,this.propertyChangeSupport.firePropertyChange("RECTANGULAR_WALL_HEIGHT",i,t),this.setShape(e.WallShape.RECTANGULAR_WALL),null!=t&&(this.getLeftSideBaseboardController().setMaxHeight(t),this.getRightSideBaseboardController().setMaxHeight(t))}},e.prototype.getRectangularWallHeight=function(){return this.rectangularWallHeight},e.prototype.setSlopingWallHeightAtStart=function(t){if(t!==this.slopingWallHeightAtStart){var i=this.slopingWallHeightAtStart;if(this.slopingWallHeightAtStart=t,this.propertyChangeSupport.firePropertyChange("SLOPING_WALL_HEIGHT_AT_START",i,t),this.setShape(e.WallShape.SLOPING_WALL),null!=t){var n=null!=this.sloppingWallHeightAtEnd?Math.max(this.sloppingWallHeightAtEnd,t):t;n=Math.max(n,this.preferences.getLengthUnit().getMinimumLength()),this.getLeftSideBaseboardController().setMaxHeight(n),this.getRightSideBaseboardController().setMaxHeight(n)}}},e.prototype.getSlopingWallHeightAtStart=function(){return this.slopingWallHeightAtStart},e.prototype.setSlopingWallHeightAtEnd=function(t){if(t!==this.sloppingWallHeightAtEnd){var i=this.sloppingWallHeightAtEnd;if(this.sloppingWallHeightAtEnd=t,this.propertyChangeSupport.firePropertyChange("SLOPING_WALL_HEIGHT_AT_END",i,t),this.setShape(e.WallShape.SLOPING_WALL),null!=t){var n=null!=this.slopingWallHeightAtStart?Math.max(this.slopingWallHeightAtStart,t):t;n=Math.max(n,this.preferences.getLengthUnit().getMinimumLength()),this.getLeftSideBaseboardController().setMaxHeight(n),this.getRightSideBaseboardController().setMaxHeight(n)}}},e.prototype.getSlopingWallHeightAtEnd=function(){return this.sloppingWallHeightAtEnd},e.prototype.setThickness=function(e){if(e!==this.thickness){var t=this.thickness;this.thickness=e,this.propertyChangeSupport.firePropertyChange("THICKNESS",t,e)}},e.prototype.getThickness=function(){return this.thickness},e.prototype.setArcExtentInDegrees=function(e){if(e!==this.arcExtentInDegrees){var t=this.arcExtentInDegrees;this.arcExtentInDegrees=e,this.propertyChangeSupport.firePropertyChange("ARC_EXTENT_IN_DEGREES",t,e)}},e.prototype.getArcExtentInDegrees=function(){return this.arcExtentInDegrees},e.prototype.getArcLength=function(){var e=this.getXStart(),t=this.getYStart(),i=this.getXEnd(),n=this.getYEnd(),o=this.getArcExtentInDegrees();if(null!=e&&null!=t&&null!=i&&null!=n&&null!=o){var r=new Wall(e,t,i,n,1e-5,0);return r.setArcExtent(o*Math.PI/180),r.getLength()}return null},e.prototype.modifyWalls=function(){var t=this.home.getSelectedItems(),i=Home.getWallsSubList(t);if(0!=i.length){var n=this.getXStart(),o=this.getYStart(),r=this.getXEnd(),l=this.getYEnd(),a=this.getLeftSidePaint(),s=a===e.WallPaint.COLORED?this.getLeftSideColor():null,h=a===e.WallPaint.TEXTURED?this.getLeftSideTextureController().getTexture():null,u=this.getLeftSideShininess(),d=this.getLeftSideBaseboardController().getVisible(),c=this.getLeftSideBaseboardController().getThickness(),p=this.getLeftSideBaseboardController().getHeight(),g=this.getLeftSideBaseboardController().getPaint(),m=g===BaseboardChoiceController.BaseboardPaint.COLORED?this.getLeftSideBaseboardController().getColor():null,f=g===BaseboardChoiceController.BaseboardPaint.TEXTURED?this.getLeftSideBaseboardController().getTextureController().getTexture():null,v=this.getRightSidePaint(),_=v===e.WallPaint.COLORED?this.getRightSideColor():null,S=v===e.WallPaint.TEXTURED?this.getRightSideTextureController().getTexture():null,y=this.getRightSideShininess(),E=this.getRightSideBaseboardController().getVisible(),C=this.getRightSideBaseboardController().getThickness(),P=this.getRightSideBaseboardController().getHeight(),w=this.getRightSideBaseboardController().getPaint(),L=w===BaseboardChoiceController.BaseboardPaint.COLORED?this.getRightSideBaseboardController().getColor():null,T=w===BaseboardChoiceController.BaseboardPaint.TEXTURED?this.getRightSideBaseboardController().getTextureController().getTexture():null,A=this.getPattern(),I=null!=this.getTopPaint(),b=this.getTopPaint()===e.WallPaint.COLORED?this.getTopColor():null,O=this.getThickness(),M=this.getArcExtentInDegrees();null!=M&&(M=M*Math.PI/180);var D=void 0;D=this.getShape()===e.WallShape.SLOPING_WALL?this.getSlopingWallHeightAtStart():this.getShape()===e.WallShape.RECTANGULAR_WALL?this.getRectangularWallHeight():null;var R=void 0;if(R=this.getShape()===e.WallShape.SLOPING_WALL?this.getSlopingWallHeightAtEnd():this.getShape()===e.WallShape.RECTANGULAR_WALL?this.getRectangularWallHeight():null,null!=D&&null!=R){var F=Math.max(D,R);null!=p&&(p=Math.min(p,F)),null!=P&&(P=Math.min(P,F))}for(var x=function(e){for(var t=[];e-- >0;)t.push(null);return t}(i.length),N=0;N<x.length;N++)x[N]=new e.ModifiedWall(i[N]);if(e.doModifyWalls(x,this.preferences.getNewWallBaseboardThickness(),this.preferences.getNewWallBaseboardHeight(),n,o,r,l,a,s,h,u,d,c,p,g,m,f,v,_,S,y,E,C,P,w,L,T,A,I,b,D,R,O,M),null!=this.undoSupport){var k=new e.WallsModificationUndoableEdit(this.home,this.preferences,t.slice(0),x,this.preferences.getNewWallBaseboardThickness(),this.preferences.getNewWallBaseboardHeight(),n,o,r,l,a,s,h,u,d,c,p,g,m,f,v,_,S,y,E,C,P,w,L,T,A,I,b,D,R,O,M);this.undoSupport.postEdit(k)}}},e.doModifyWalls=function(t,i,n,o,r,l,a,s,h,u,d,c,p,g,m,f,v,_,S,y,E,C,P,w,L,T,A,I,b,O,M,D,R,F){for(var x=0;x<t.length;x++){var N=t[x].getWall();if(e.moveWallPoints(N,o,r,l,a),null!=s)switch(s){case e.WallPaint.DEFAULT:N.setLeftSideColor(null),N.setLeftSideTexture(null);break;case e.WallPaint.COLORED:null!=h&&N.setLeftSideColor(h),N.setLeftSideTexture(null);break;case e.WallPaint.TEXTURED:N.setLeftSideColor(null),null!=u&&N.setLeftSideTexture(u)}if(null!=d&&N.setLeftSideShininess(d),!1===c)N.setLeftSideBaseboard(null);else{var k=N.getLeftSideBaseboard();if(!0===c||null!=k){var H=null!=k?k.getThickness():i,V=null!=k?k.getHeight():n,U=null!=k?k.getColor():null,W=null!=k?k.getTexture():null;if(null!=m)switch(m){case BaseboardChoiceController.BaseboardPaint.DEFAULT:U=null,W=null;break;case BaseboardChoiceController.BaseboardPaint.COLORED:null!=f&&(U=f),W=null;break;case BaseboardChoiceController.BaseboardPaint.TEXTURED:U=null,null!=v&&(W=v)}N.setLeftSideBaseboard(Baseboard.getInstance(null!=p?p:H,null!=g?g:V,U,W))}}if(null!=_)switch(_){case e.WallPaint.DEFAULT:N.setRightSideColor(null),N.setRightSideTexture(null);break;case e.WallPaint.COLORED:null!=S&&N.setRightSideColor(S),N.setRightSideTexture(null);break;case e.WallPaint.TEXTURED:N.setRightSideColor(null),null!=y&&N.setRightSideTexture(y)}if(null!=E&&N.setRightSideShininess(E),!1===C)N.setRightSideBaseboard(null);else{k=N.getRightSideBaseboard();if(!0===C||null!=k){H=null!=k?k.getThickness():i,V=null!=k?k.getHeight():n,U=null!=k?k.getColor():null,W=null!=k?k.getTexture():null;if(null!=L)switch(L){case BaseboardChoiceController.BaseboardPaint.DEFAULT:U=null,W=null;break;case BaseboardChoiceController.BaseboardPaint.COLORED:null!=T&&(U=T),W=null;break;case BaseboardChoiceController.BaseboardPaint.TEXTURED:U=null,null!=A&&(W=A)}N.setRightSideBaseboard(Baseboard.getInstance(null!=P?P:H,null!=w?w:V,U,W))}}null!=I&&N.setPattern(I),b&&N.setTopColor(O),null!=M&&(N.setHeight(M),null!=D&&(D===M?N.setHeightAtEnd(null):N.setHeightAtEnd(D))),null!=R&&N.setThickness(R),null!=F&&(0===F?N.setArcExtent(null):N.setArcExtent(F))}},e.undoModifyWalls=function(t){for(var i=0;i<t.length;i++){var n=t[i],o=n.getWall();e.moveWallPoints(o,n.getXStart(),n.getYStart(),n.getXEnd(),n.getYEnd()),o.setLeftSideColor(n.getLeftSideColor()),o.setLeftSideTexture(n.getLeftSideTexture()),o.setLeftSideShininess(n.getLeftSideShininess()),o.setLeftSideBaseboard(n.getLeftSideBaseboard()),o.setRightSideColor(n.getRightSideColor()),o.setRightSideTexture(n.getRightSideTexture()),o.setRightSideShininess(n.getRightSideShininess()),o.setRightSideBaseboard(n.getRightSideBaseboard()),o.setPattern(n.getPattern()),o.setTopColor(n.getTopColor()),o.setHeight(n.getHeight()),o.setHeightAtEnd(n.getHeightAtEnd()),o.setThickness(n.getThickness()),o.setArcExtent(n.getArcExtent())}},e.moveWallPoints=function(e,t,i,n,o){var r=e.getWallAtStart();null!=t&&(e.setXStart(t),null!=r&&(r.getWallAtStart()===e?r.setXStart(t):r.getWallAtEnd()===e&&r.setXEnd(t))),null!=i&&(e.setYStart(i),null!=r&&(r.getWallAtStart()===e?r.setYStart(i):r.getWallAtEnd()===e&&r.setYEnd(i)));var l=e.getWallAtEnd();null!=n&&(e.setXEnd(n),null!=l&&(l.getWallAtStart()===e?l.setXStart(n):l.getWallAtEnd()===e&&l.setXEnd(n))),null!=o&&(e.setYEnd(o),null!=l&&(l.getWallAtStart()===e?l.setYStart(o):l.getWallAtEnd()===e&&l.setYEnd(o)))},e}();WallController.__class="com.eteks.sweethome3d.viewcontroller.WallController",WallController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"],function(e){var t;(t=e.WallShape||(e.WallShape={}))[t.RECTANGULAR_WALL=0]="RECTANGULAR_WALL",t[t.SLOPING_WALL=1]="SLOPING_WALL",function(e){e[e.DEFAULT=0]="DEFAULT",e[e.COLORED=1]="COLORED",e[e.TEXTURED=2]="TEXTURED"}(e.WallPaint||(e.WallPaint={}));var i=function(t){function i(i,n,o,r,l,a,s,h,u,d,c,p,g,m,f,v,_,S,y,E,C,P,w,L,T,A,I,b,O,M,D,R,F,x,N,k,H){var V=t.call(this,n,e,"undoModifyWallsName")||this;return void 0===V.home&&(V.home=null),void 0===V.oldSelection&&(V.oldSelection=null),void 0===V.modifiedWalls&&(V.modifiedWalls=null),void 0===V.newWallBaseboardThickness&&(V.newWallBaseboardThickness=0),void 0===V.newWallBaseboardHeight&&(V.newWallBaseboardHeight=0),void 0===V.xStart&&(V.xStart=null),void 0===V.yStart&&(V.yStart=null),void 0===V.xEnd&&(V.xEnd=null),void 0===V.yEnd&&(V.yEnd=null),void 0===V.leftSidePaint&&(V.leftSidePaint=null),void 0===V.leftSideColor&&(V.leftSideColor=null),void 0===V.leftSideTexture&&(V.leftSideTexture=null),void 0===V.leftSideShininess&&(V.leftSideShininess=null),void 0===V.leftSideBaseboardVisible&&(V.leftSideBaseboardVisible=null),void 0===V.leftSideBaseboardThickness&&(V.leftSideBaseboardThickness=null),void 0===V.leftSideBaseboardHeight&&(V.leftSideBaseboardHeight=null),void 0===V.leftSideBaseboardPaint&&(V.leftSideBaseboardPaint=null),void 0===V.leftSideBaseboardColor&&(V.leftSideBaseboardColor=null),void 0===V.leftSideBaseboardTexture&&(V.leftSideBaseboardTexture=null),void 0===V.rightSidePaint&&(V.rightSidePaint=null),void 0===V.rightSideColor&&(V.rightSideColor=null),void 0===V.rightSideTexture&&(V.rightSideTexture=null),void 0===V.rightSideShininess&&(V.rightSideShininess=null),void 0===V.rightSideBaseboardVisible&&(V.rightSideBaseboardVisible=null),void 0===V.rightSideBaseboardThickness&&(V.rightSideBaseboardThickness=null),void 0===V.rightSideBaseboardHeight&&(V.rightSideBaseboardHeight=null),void 0===V.rightSideBaseboardPaint&&(V.rightSideBaseboardPaint=null),void 0===V.rightSideBaseboardColor&&(V.rightSideBaseboardColor=null),void 0===V.rightSideBaseboardTexture&&(V.rightSideBaseboardTexture=null),void 0===V.pattern&&(V.pattern=null),void 0===V.modifiedTopColor&&(V.modifiedTopColor=!1),void 0===V.topColor&&(V.topColor=null),void 0===V.height&&(V.height=null),void 0===V.heightAtEnd&&(V.heightAtEnd=null),void 0===V.thickness&&(V.thickness=null),void 0===V.arcExtent&&(V.arcExtent=null),V.home=i,V.oldSelection=o,V.modifiedWalls=r,V.newWallBaseboardThickness=l,V.newWallBaseboardHeight=a,V.xStart=s,V.yStart=h,V.xEnd=u,V.yEnd=d,V.leftSidePaint=c,V.leftSideColor=p,V.leftSideShininess=m,V.leftSideBaseboardVisible=f,V.leftSideBaseboardThickness=v,V.leftSideBaseboardHeight=_,V.leftSideBaseboardPaint=S,V.leftSideBaseboardColor=y,V.leftSideBaseboardTexture=E,V.rightSidePaint=C,V.rightSideColor=P,V.rightSideTexture=w,V.leftSideTexture=g,V.rightSideShininess=L,V.rightSideBaseboardVisible=T,V.rightSideBaseboardThickness=A,V.rightSideBaseboardHeight=I,V.rightSideBaseboardPaint=b,V.rightSideBaseboardColor=O,V.rightSideBaseboardTexture=M,V.pattern=D,V.modifiedTopColor=R,V.topColor=F,V.height=x,V.heightAtEnd=N,V.thickness=k,V.arcExtent=H,V}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),e.undoModifyWalls(this.modifiedWalls),this.home.setSelectedItems(this.oldSelection.slice(0))},i.prototype.redo=function(){t.prototype.redo.call(this),e.doModifyWalls(this.modifiedWalls,this.newWallBaseboardThickness,this.newWallBaseboardHeight,this.xStart,this.yStart,this.xEnd,this.yEnd,this.leftSidePaint,this.leftSideColor,this.leftSideTexture,this.leftSideShininess,this.leftSideBaseboardVisible,this.leftSideBaseboardThickness,this.leftSideBaseboardHeight,this.leftSideBaseboardPaint,this.leftSideBaseboardColor,this.leftSideBaseboardTexture,this.rightSidePaint,this.rightSideColor,this.rightSideTexture,this.rightSideShininess,this.rightSideBaseboardVisible,this.rightSideBaseboardThickness,this.rightSideBaseboardHeight,this.rightSideBaseboardPaint,this.rightSideBaseboardColor,this.rightSideBaseboardTexture,this.pattern,this.modifiedTopColor,this.topColor,this.height,this.heightAtEnd,this.thickness,this.arcExtent),this.home.setSelectedItems(this.oldSelection.slice(0))},i}(LocalizedUndoableEdit);e.WallsModificationUndoableEdit=i,i.__class="com.eteks.sweethome3d.viewcontroller.WallController.WallsModificationUndoableEdit",i.__interfaces=["javax.swing.undo.UndoableEdit"];var n=function(){function e(e){void 0===this.wall&&(this.wall=null),void 0===this.xStart&&(this.xStart=0),void 0===this.yStart&&(this.yStart=0),void 0===this.xEnd&&(this.xEnd=0),void 0===this.yEnd&&(this.yEnd=0),void 0===this.leftSideColor&&(this.leftSideColor=null),void 0===this.leftSideTexture&&(this.leftSideTexture=null),void 0===this.leftSideShininess&&(this.leftSideShininess=0),void 0===this.leftSideBaseboard&&(this.leftSideBaseboard=null),void 0===this.rightSideColor&&(this.rightSideColor=null),void 0===this.rightSideTexture&&(this.rightSideTexture=null),void 0===this.rightSideShininess&&(this.rightSideShininess=0),void 0===this.rightSideBaseboard&&(this.rightSideBaseboard=null),void 0===this.pattern&&(this.pattern=null),void 0===this.topColor&&(this.topColor=null),void 0===this.height&&(this.height=null),void 0===this.heightAtEnd&&(this.heightAtEnd=null),void 0===this.thickness&&(this.thickness=0),void 0===this.arcExtent&&(this.arcExtent=null),this.wall=e,this.xStart=e.getXStart(),this.yStart=e.getYStart(),this.xEnd=e.getXEnd(),this.yEnd=e.getYEnd(),this.leftSideColor=e.getLeftSideColor(),this.leftSideTexture=e.getLeftSideTexture(),this.leftSideShininess=e.getLeftSideShininess(),this.leftSideBaseboard=e.getLeftSideBaseboard(),this.rightSideColor=e.getRightSideColor(),this.rightSideTexture=e.getRightSideTexture(),this.rightSideShininess=e.getRightSideShininess(),this.rightSideBaseboard=e.getRightSideBaseboard(),this.pattern=e.getPattern(),this.topColor=e.getTopColor(),this.height=e.getHeight(),this.heightAtEnd=e.getHeightAtEnd(),this.thickness=e.getThickness(),this.arcExtent=e.getArcExtent()}return e.prototype.getWall=function(){return this.wall},e.prototype.getXStart=function(){return this.xStart},e.prototype.getXEnd=function(){return this.xEnd},e.prototype.getYStart=function(){return this.yStart},e.prototype.getYEnd=function(){return this.yEnd},e.prototype.getHeight=function(){return this.height},e.prototype.getHeightAtEnd=function(){return this.heightAtEnd},e.prototype.getLeftSideColor=function(){return this.leftSideColor},e.prototype.getLeftSideTexture=function(){return this.leftSideTexture},e.prototype.getLeftSideShininess=function(){return this.leftSideShininess},e.prototype.getLeftSideBaseboard=function(){return this.leftSideBaseboard},e.prototype.getRightSideColor=function(){return this.rightSideColor},e.prototype.getRightSideTexture=function(){return this.rightSideTexture},e.prototype.getRightSideShininess=function(){return this.rightSideShininess},e.prototype.getRightSideBaseboard=function(){return this.rightSideBaseboard},e.prototype.getPattern=function(){return this.pattern},e.prototype.getTopColor=function(){return this.topColor},e.prototype.getThickness=function(){return this.thickness},e.prototype.getArcExtent=function(){return this.arcExtent},e}();e.ModifiedWall=n,n.__class="com.eteks.sweethome3d.viewcontroller.WallController.ModifiedWall";var o=function(){function t(e){this.__parent=e}return t.prototype.propertyChange=function(t){this.__parent.setLeftSidePaint(e.WallPaint.TEXTURED)},t}();e.WallController$0=o;var r=function(){function t(e){this.__parent=e}return t.prototype.propertyChange=function(t){this.__parent.setRightSidePaint(e.WallPaint.TEXTURED)},t}();e.WallController$1=r}(WallController||(WallController={}));var FurnitureController=function(){function e(e,t,i,n,o){if((null!=e&&e instanceof Home||null===e)&&(null!=t&&t instanceof UserPreferences||null===t)&&(null!=i&&null!=i.constructor&&null!=i.constructor.__interfaces&&i.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0||null===i)&&(null!=n&&null!=n.constructor&&null!=n.constructor.__interfaces&&n.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ContentManager")>=0||null===n)&&(null!=o&&o instanceof javax.swing.undo.UndoableEditSupport||null===o)){void 0===this.home&&(this.home=null),void 0===this.preferences&&(this.preferences=null),void 0===this.viewFactory&&(this.viewFactory=null),void 0===this.contentManager&&(this.contentManager=null),void 0===this.undoSupport&&(this.undoSupport=null),void 0===this.furnitureView&&(this.furnitureView=null),void 0===this.leadSelectedPieceOfFurniture&&(this.leadSelectedPieceOfFurniture=null),this.home=e,this.preferences=t,this.viewFactory=i,this.undoSupport=o,this.contentManager=n,this.addModelListeners()}else{if(!((null!=e&&e instanceof Home||null===e)&&(null!=t&&t instanceof UserPreferences||null===t)&&(null!=i&&null!=i.constructor&&null!=i.constructor.__interfaces&&i.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0||null===i)&&void 0===n&&void 0===o))throw new Error("invalid overload");void 0===this.home&&(this.home=null),void 0===this.preferences&&(this.preferences=null),void 0===this.viewFactory&&(this.viewFactory=null),void 0===this.contentManager&&(this.contentManager=null),void 0===this.undoSupport&&(this.undoSupport=null),void 0===this.furnitureView&&(this.furnitureView=null),void 0===this.leadSelectedPieceOfFurniture&&(this.leadSelectedPieceOfFurniture=null),this.home=e,this.preferences=t,this.viewFactory=i,this.undoSupport=null,this.contentManager=null,this.addModelListeners(),void 0===this.home&&(this.home=null),void 0===this.preferences&&(this.preferences=null),void 0===this.viewFactory&&(this.viewFactory=null),void 0===this.contentManager&&(this.contentManager=null),void 0===this.undoSupport&&(this.undoSupport=null),void 0===this.furnitureView&&(this.furnitureView=null),void 0===this.leadSelectedPieceOfFurniture&&(this.leadSelectedPieceOfFurniture=null)}}return e.prototype.getView=function(){return null==this.furnitureView&&(this.furnitureView=this.viewFactory.createFurnitureView(this.home,this.preferences,this)),this.furnitureView},e.prototype.addModelListeners=function(){this.home.addSelectionListener(new e.FurnitureController$0(this));for(var t=new e.FurnitureController$1(this),i=this.home.getFurniture(),n=0;n<i.length;n++){var o=i[n];if(o.addPropertyChangeListener(t),null!=o&&o instanceof HomeFurnitureGroup)for(var r=o.getAllFurniture(),l=0;l<r.length;l++){r[l].addPropertyChangeListener(t)}}this.home.addFurnitureListener((function(e){var i=e.getItem();if(e.getType()===CollectionEvent.Type.ADD){if(i.addPropertyChangeListener(t),null!=i&&i instanceof HomeFurnitureGroup)for(var n=i.getAllFurniture(),o=0;o<n.length;o++){n[o].addPropertyChangeListener(t)}}else if(e.getType()===CollectionEvent.Type.DELETE&&(i.removePropertyChangeListener(t),null!=i&&i instanceof HomeFurnitureGroup))for(n=i.getAllFurniture(),o=0;o<n.length;o++){n[o].removePropertyChangeListener(t)}}))},e.prototype.addFurniture$java_util_List=function(e){this.addFurniture$java_util_List$com_eteks_sweethome3d_model_Level_A$com_eteks_sweethome3d_model_HomeFurnitureGroup$com_eteks_sweethome3d_model_HomePieceOfFurniture(e,null,null,null)},e.prototype.addFurniture$java_util_List$com_eteks_sweethome3d_model_HomePieceOfFurniture=function(e,t){this.addFurniture$java_util_List$com_eteks_sweethome3d_model_Level_A$com_eteks_sweethome3d_model_HomeFurnitureGroup$com_eteks_sweethome3d_model_HomePieceOfFurniture(e,null,null,t)},e.prototype.addFurnitureToGroup=function(e,t){if(null==t)throw new IllegalArgumentException("Group shouldn't be null");this.addFurniture$java_util_List$com_eteks_sweethome3d_model_Level_A$com_eteks_sweethome3d_model_HomeFurnitureGroup$com_eteks_sweethome3d_model_HomePieceOfFurniture(e,null,t,null)},e.prototype.addFurniture$java_util_List$com_eteks_sweethome3d_model_Level_A$com_eteks_sweethome3d_model_HomeFurnitureGroup$com_eteks_sweethome3d_model_HomePieceOfFurniture=function(t,i,n,o){var r=this.home.isBasePlanLocked(),l=this.home.isAllLevelsSelection(),a=this.home.getSelectedItems(),s=t.slice(0),h=function(e){for(var t=[];e-- >0;)t.push(0);return t}(t.length),u=null==n?this.home.getFurniture().length:n.getFurniture().length;if(null!=o){var d=this.home.getFurniture();null!=(n=e.getPieceOfFurnitureGroup(o,null,d))&&(d=n.getFurniture()),u=d.indexOf(o)}for(var c=null!=n?function(e){for(var t=[];e-- >0;)t.push(null);return t}(t.length):null,p=r,g=null!=n||null==i,m=0;m<h.length;m++)h[m]=u++,p=!this.isPieceOfFurniturePartOfBasePlan(s[m])&&p,null!=i&&(g=null==i[m]||g),null!=c&&(c[m]=n);var f=g?null:i,v=p,_=null!=n?n.getLevel():this.home.getSelectedLevel();e.doAddFurniture(this.home,s,c,h,_,f,v,!1),null!=this.undoSupport&&this.undoSupport.postEdit(new e.FurnitureAdditionUndoableEdit(this.home,this.preferences,a.slice(0),r,l,s,h,c,f,_,v))},e.prototype.addFurniture=function(e,t,i,n){if((null!=e&&e instanceof Array||null===e)&&(null!=t&&t instanceof Array&&(0==t.length||null==t[0]||null!=t[0]&&t[0]instanceof Level)||null===t)&&(null!=i&&i instanceof HomeFurnitureGroup||null===i)&&(null!=n&&n instanceof HomePieceOfFurniture||null===n))return this.addFurniture$java_util_List$com_eteks_sweethome3d_model_Level_A$com_eteks_sweethome3d_model_HomeFurnitureGroup$com_eteks_sweethome3d_model_HomePieceOfFurniture(e,t,i,n);if((null!=e&&e instanceof Array||null===e)&&(null!=t&&t instanceof HomePieceOfFurniture||null===t)&&void 0===i&&void 0===n)return this.addFurniture$java_util_List$com_eteks_sweethome3d_model_HomePieceOfFurniture(e,t);if((null!=e&&e instanceof Array||null===e)&&void 0===t&&void 0===i&&void 0===n)return this.addFurniture$java_util_List(e);throw new Error("invalid overload")},e.doAddFurniture=function(e,t,i,n,o,r,l,a){for(var s=0;s<n.length;s++)null!=i&&null!=i[s]?(e.addPieceOfFurnitureToGroup(t[s],i[s],n[s]),t[s].setVisible(i[s].isVisible())):e.addPieceOfFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture$int(t[s],n[s]),t[s].setLevel(null!=r?r[s]:o);e.setBasePlanLocked(l),e.setSelectedItems(t.slice(0)),e.setAllLevelsSelection(a)},e.prototype.deleteSelection=function(){this.deleteFurniture(Home.getFurnitureSubList(this.home.getSelectedItems()))},e.prototype.deleteFurniture=function(t){var i=this.home.isBasePlanLocked(),n=this.home.isAllLevelsSelection(),o=this.home.getSelectedItems(),r=this.home.getFurniture();t=t.slice(0);var l,a=[];e.searchGroups(r,a);do{l=!1;for(var s=0;s<a.length;s++){var h=(p=a[s]).getFurniture();(function(e,t){for(var i=0;i<t.length;i++)if(e.indexOf(t[i])<0)return!1;return!0})(t,h)&&(!function(e,t){for(var i=!1,n=0;n<t.length;n++){var o=e.indexOf(t[n]);o>=0&&(e.splice(o,1),i=!0)}}(t,h),t.push(p),l=!0)}}while(l);var u={},d=0;for(s=0;s<t.length;s++){var c=t[s];if(this.isPieceOfFurnitureDeletable(c)){var p,g=function(e,t){null==e.entries&&(e.entries=[]);for(var i=0;i<e.entries.length;i++)if(null==e.entries[i].key&&null==t||null!=e.entries[i].key.equals&&e.entries[i].key.equals(t)||e.entries[i].key===t)return e.entries[i].value;return null}(u,p=e.getPieceOfFurnitureGroup(c,null,r));null==g&&function(e,t,i){null==e.entries&&(e.entries=[]);for(var n=0;n<e.entries.length;n++)if(null==e.entries[n].key&&null==t||null!=e.entries[n].key.equals&&e.entries[n].key.equals(t)||e.entries[n].key===t)return void(e.entries[n].value=i);e.entries.push({key:t,value:i,getKey:function(){return this.key},getValue:function(){return this.value}})}(u,p,g={}),null==p?function(e,t,i){null==e.entries&&(e.entries=[]);for(var n=0;n<e.entries.length;n++)if(null!=e.entries[n].key.equals&&e.entries[n].key.equals(t)||e.entries[n].key===t){var o=e.entries[n].value;return e.entries[n].value=i,o}e.entries.push({key:t,value:i,getKey:function(){return this.key},getValue:function(){return this.value}}),e.entries.sort((function(e,t){return null!=e.key.compareTo?e.key.compareTo(t):e.key-t.key}))}(g,r.indexOf(c),c):function(e,t,i){null==e.entries&&(e.entries=[]);for(var n=0;n<e.entries.length;n++)if(null!=e.entries[n].key.equals&&e.entries[n].key.equals(t)||e.entries[n].key===t){var o=e.entries[n].value;return e.entries[n].value=i,o}e.entries.push({key:t,value:i,getKey:function(){return this.key},getValue:function(){return this.value}}),e.entries.sort((function(e,t){return null!=e.key.compareTo?e.key.compareTo(t):e.key-t.key}))}(g,p.getFurniture().indexOf(c),c),d++}}var m,f=function(e){for(var t=[];e-- >0;)t.push(null);return t}(d),v=function(e){for(var t=[];e-- >0;)t.push(0);return t}(f.length),_=function(e){for(var t=[];e-- >0;)t.push(null);return t}(f.length),S=function(e){for(var t=[];e-- >0;)t.push(null);return t}(f.length),y=0,E=(null==(m=u).entries&&(m.entries=[]),m.entries);for(s=0;s<E.length;s++)for(var C=E[s],P=function(e){return null==e.entries&&(e.entries=[]),e.entries}(C.getValue()),w=0;w<P.length;w++){var L=P[w];f[y]=L.getValue(),v[y]=L.getKey(),_[y]=f[y].getLevel(),S[y++]=C.getKey()}e.doDeleteFurniture(this.home,f,i,!1),null!=this.undoSupport&&this.undoSupport.postEdit(new e.FurnitureDeletionUndoableEdit(this.home,this.preferences,o.slice(0),i,n,f,v,S,_))},e.doDeleteFurniture=function(e,t,i,n){for(var o=0;o<t.length;o++){var r=t[o];e.deletePieceOfFurniture(r)}e.setBasePlanLocked(i),e.setAllLevelsSelection(n)},e.searchGroups=function(t,i){for(var n=0;n<t.length;n++){var o=t[n];null!=o&&o instanceof HomeFurnitureGroup&&(i.push(o),e.searchGroups(o.getFurniture(),i))}},e.getPieceOfFurnitureGroup=function(t,i,n){for(var o=0;o<n.length;o++){var r=n[o];if(s=t,(a=r)&&a.equals?a.equals(s):a===s)return i;if(null!=r&&r instanceof HomeFurnitureGroup){var l=e.getPieceOfFurnitureGroup(t,r,r.getFurniture());if(null!=l)return l}}var a,s;return null},e.prototype.moveSelectedFurnitureBefore=function(t){var i=Home.getFurnitureSubList(this.home.getSelectedItems());if(0!=i.length){for(var n=function(e){for(var t=[];e-- >0;)t.push(null);return t}(i.length),o=0;o<n.length;o++)n[o]=i[o].getLevel();this.undoSupport.beginUpdate(),this.deleteFurniture(i),this.addFurniture$java_util_List$com_eteks_sweethome3d_model_Level_A$com_eteks_sweethome3d_model_HomeFurnitureGroup$com_eteks_sweethome3d_model_HomePieceOfFurniture(i,n,null,t),this.undoSupport.postEdit(new LocalizedUndoableEdit(this.preferences,e,"undoReorderName")),this.undoSupport.endUpdate()}},e.prototype.setSelectedFurniture$java_util_List=function(e){this.setSelectedFurniture$java_util_List$boolean(e,!0)},e.prototype.setSelectedFurniture$java_util_List$boolean=function(e,t){if(this.home.isBasePlanLocked()&&(e=this.getFurnitureNotPartOfBasePlan(e)),t)this.home.setSelectedItems(e),this.home.setAllLevelsSelection(!1);else{var i=this.home.getSelectedItems().slice(0);e=e.slice(0);for(var n=i.length-1;n>=0;n--){var o=i[n];if(null!=o&&o instanceof HomePieceOfFurniture){var r=e.indexOf(o);r>=0?e.splice(r,1)[0]:i.splice(n,1)[0]}}a=e,(l=i).push.apply(l,a),this.home.setSelectedItems(i)}var l,a},e.prototype.setSelectedFurniture=function(e,t){if(!(null!=e&&e instanceof Array||null===e)||"boolean"!=typeof t&&null!==t){if((null!=e&&e instanceof Array||null===e)&&void 0===t)return this.setSelectedFurniture$java_util_List(e);throw new Error("invalid overload")}return this.setSelectedFurniture$java_util_List$boolean(e,t)},e.prototype.selectAll=function(){this.setSelectedFurniture$java_util_List(this.home.getFurniture())},e.prototype.isPieceOfFurniturePartOfBasePlan=function(e){return!e.isMovable()||e.isDoorOrWindow()},e.prototype.isPieceOfFurnitureMovable=function(e){return!0},e.prototype.isPieceOfFurnitureDeletable=function(e){return!0},e.prototype.createHomePieceOfFurniture=function(e){for(var t,i,n=e.getPropertyNames().slice(0),o=n.length-1;o>=0;o--){var r=n[o];t="modelPresetTransformationsName_",void 0===(i=void 0)&&(i=0),(r.substr(i,31)===t||function(e,t,i){return void 0===i&&(i=0),e.substr(i,27)===t}(r,"modelPresetTransformations_"))&&n.splice(o,1)[0]}var l=n.slice(0);return null!=e&&null!=e.constructor&&null!=e.constructor.__interfaces&&e.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.DoorOrWindow")>=0?new HomeDoorOrWindow(e,l):null!=e&&null!=e.constructor&&null!=e.constructor.__interfaces&&e.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Light")>=0?new HomeLight(e,l):null!=e&&null!=e.constructor&&null!=e.constructor.__interfaces&&e.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.ShelfUnit")>=0?new HomeShelfUnit(e,l):new HomePieceOfFurniture(e,l)},e.prototype.getFurnitureNotPartOfBasePlan=function(e){for(var t=[],i=0;i<e.length;i++){var n=e[i];this.isPieceOfFurniturePartOfBasePlan(n)||t.push(n)}return t},e.prototype.toggleFurnitureSort$java_lang_String=function(e){e===this.home.getFurnitureSortedPropertyName()?this.home.setFurnitureSortedPropertyName(null):this.home.setFurnitureSortedPropertyName(e)},e.prototype.toggleFurnitureSort=function(e){if("string"==typeof e||null===e)return this.toggleFurnitureSort$java_lang_String(e);if("number"==typeof e||null===e)return this.toggleFurnitureSort$com_eteks_sweethome3d_model_HomePieceOfFurniture_SortableProperty(e);throw new Error("invalid overload")},e.prototype.toggleFurnitureSort$com_eteks_sweethome3d_model_HomePieceOfFurniture_SortableProperty=function(e){e==this.home.getFurnitureSortedProperty()?this.home.setFurnitureSortedProperty(null):this.home.setFurnitureSortedProperty(e)},e.prototype.toggleFurnitureSortOrder=function(){this.home.setFurnitureDescendingSorted(!this.home.isFurnitureDescendingSorted())},e.prototype.sortFurniture$java_lang_String=function(e){var t=this.home.getFurnitureSortedPropertyName(),i=this.home.isFurnitureDescendingSorted(),n=!1;e===t&&(i?e=null:n=!0),this.home.setFurnitureSortedPropertyName(e),this.home.setFurnitureDescendingSorted(n)},e.prototype.sortFurniture=function(e){if("string"==typeof e||null===e)return this.sortFurniture$java_lang_String(e);if("number"==typeof e||null===e)return this.sortFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture_SortableProperty(e);throw new Error("invalid overload")},e.prototype.sortFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture_SortableProperty=function(e){var t=this.home.getFurnitureSortedProperty(),i=this.home.isFurnitureDescendingSorted(),n=!1;e==t&&(i?e=null:n=!0),this.home.setFurnitureSortedProperty(e),this.home.setFurnitureDescendingSorted(n)},e.prototype.setFurnitureVisiblePropertyNames=function(e){this.home.setFurnitureVisiblePropertyNames(e)},e.prototype.setFurnitureVisibleProperties=function(e){this.home.setFurnitureVisibleProperties(e)},e.prototype.toggleFurnitureVisibleProperty$java_lang_String=function(e){var t,i,n=this.home.getFurnitureVisiblePropertyNames().slice(0);if(n.indexOf(e)>=0)(i=(t=n).indexOf(e))>=0&&t.splice(i,1),0==n.length&&n.push("NAME");else{for(var o=["CATALOG_ID","NAME","DESCRIPTION","CREATOR","LICENSE","WIDTH","DEPTH","HEIGHT","X","Y","ELEVATION","ANGLE","LEVEL","MODEL_SIZE","COLOR","TEXTURE","MOVABLE","DOOR_OR_WINDOW","VISIBLE","PRICE","VALUE_ADDED_TAX_PERCENTAGE","VALUE_ADDED_TAX","PRICE_VALUE_ADDED_TAX_INCLUDED"].slice(0).slice(0),r=this.home.getFurnitureAdditionalProperties(),l=0;l<r.length;l++){var a=r[l];o.push(a.getName())}var s=o.indexOf(e)-1;if(s>0)for(;s>0;){var h=n.indexOf(o[s]);if(h>=0){s=h+1;break}s--}s<0&&(s=0),n.splice(s,0,e)}this.home.setFurnitureVisiblePropertyNames(n)},e.prototype.toggleFurnitureVisibleProperty=function(e){if("string"==typeof e||null===e)return this.toggleFurnitureVisibleProperty$java_lang_String(e);if("number"==typeof e||null===e)return this.toggleFurnitureVisibleProperty$com_eteks_sweethome3d_model_HomePieceOfFurniture_SortableProperty(e);throw new Error("invalid overload")},e.prototype.toggleFurnitureVisibleProperty$com_eteks_sweethome3d_model_HomePieceOfFurniture_SortableProperty=function(e){this.toggleFurnitureVisibleProperty$java_lang_String(e)},e.prototype.modifySelectedFurniture=function(){0!=Home.getFurnitureSubList(this.home.getSelectedItems()).length&&new HomeFurnitureController(this.home,this.preferences,this.viewFactory,this.contentManager,this.undoSupport).displayView(this.getView())},e.prototype.toggleSelectedFurnitureVisibility=function(){if(1===Home.getFurnitureSubList(this.home.getSelectedItems()).length){var e=new HomeFurnitureController(this.home,this.preferences,this.viewFactory,this.contentManager,this.undoSupport);e.setVisible(!e.getVisible()),e.modifyFurniture()}},e.prototype.groupSelectedFurniture=function(){var t,i=this.getMovableSelectedFurniture();if(i.length>0){for(var n=this.home.isBasePlanLocked(),o=this.home.isAllLevelsSelection(),r=this.home.getSelectedItems(),l=this.home.getFurniture(),a={},s=0,h=0;h<i.length;h++){var u=i[h],d=e.getPieceOfFurnitureGroup(u,null,l),c=function(e,t){null==e.entries&&(e.entries=[]);for(var i=0;i<e.entries.length;i++)if(null==e.entries[i].key&&null==t||null!=e.entries[i].key.equals&&e.entries[i].key.equals(t)||e.entries[i].key===t)return e.entries[i].value;return null}(a,d);null==c&&function(e,t,i){null==e.entries&&(e.entries=[]);for(var n=0;n<e.entries.length;n++)if(null==e.entries[n].key&&null==t||null!=e.entries[n].key.equals&&e.entries[n].key.equals(t)||e.entries[n].key===t)return void(e.entries[n].value=i);e.entries.push({key:t,value:i,getKey:function(){return this.key},getValue:function(){return this.value}})}(a,d,c={}),null==d?function(e,t,i){null==e.entries&&(e.entries=[]);for(var n=0;n<e.entries.length;n++)if(null!=e.entries[n].key.equals&&e.entries[n].key.equals(t)||e.entries[n].key===t){var o=e.entries[n].value;return e.entries[n].value=i,o}e.entries.push({key:t,value:i,getKey:function(){return this.key},getValue:function(){return this.value}}),e.entries.sort((function(e,t){return null!=e.key.compareTo?e.key.compareTo(t):e.key-t.key}))}(c,l.indexOf(u),u):function(e,t,i){null==e.entries&&(e.entries=[]);for(var n=0;n<e.entries.length;n++)if(null!=e.entries[n].key.equals&&e.entries[n].key.equals(t)||e.entries[n].key===t){var o=e.entries[n].value;return e.entries[n].value=i,o}e.entries.push({key:t,value:i,getKey:function(){return this.key},getValue:function(){return this.value}}),e.entries.sort((function(e,t){return null!=e.key.compareTo?e.key.compareTo(t):e.key-t.key}))}(c,d.getFurniture().indexOf(u),u),s++}var p=function(e){for(var t=[];e-- >0;)t.push(null);return t}(s),g=function(e){for(var t=[];e-- >0;)t.push(0);return t}(p.length),m=function(e){for(var t=[];e-- >0;)t.push(null);return t}(p.length),f=function(e){for(var t=[];e-- >0;)t.push(0);return t}(p.length),v=function(e){for(var t=[];e-- >0;)t.push(!1);return t}(p.length),_=function(e){for(var t=[];e-- >0;)t.push(null);return t}(p.length),S=this.home.getSelectedLevel(),y=0,E=(null==(t=a).entries&&(t.entries=[]),t.entries);for(h=0;h<E.length;h++)for(var C=E[h],P=function(e){return null==e.entries&&(e.entries=[]),e.entries}(C.getValue()),w=0;w<P.length;w++){var L=P[w];u=L.getValue();p[y]=u,g[y]=L.getKey(),m[y]=u.getLevel(),f[y]=u.getElevation(),v[y]=u.isVisible(),_[y]=C.getKey(),null!=m[y]&&(null==S||m[y].getElevation()<S.getElevation())&&(S=m[y]),y++}var T=void 0,A=p.slice(0);T=A.indexOf(this.leadSelectedPieceOfFurniture)>0?this.createHomeFurnitureGroup$java_util_List$com_eteks_sweethome3d_model_HomePieceOfFurniture(A,this.leadSelectedPieceOfFurniture):this.createHomeFurnitureGroup$java_util_List(A);var I=function(e){for(var t=[];e-- >0;)t.push(0);return t}(p.length);y=0;for(h=0;h<p.length;h++){u=p[h];I[y++]=u.getElevation()}var b=function(e,t){null==e.entries&&(e.entries=[]);for(var i=0;i<e.entries.length;i++)if(null==e.entries[i].key||null!=e.entries[i].key.equals&&e.entries[i].key.equals(t)||e.entries[i].key===t)return e.entries[i].value;return null}(a,null),O=null!=b?function(e){return e.entries[e.entries.length-1].key}(b)+1-p.length:l.length,M=T.isMovable(),D=S;e.doGroupFurniture(this.home,p,[T],null,[O],[D],n,!1),null!=this.undoSupport&&this.undoSupport.postEdit(new e.FurnitureGroupingUndoableEdit(this.home,this.preferences,r.slice(0),n,o,p,g,_,m,f,v,T,O,D,I,M))}},e.prototype.createHomeFurnitureGroup$java_util_List=function(e){return this.createHomeFurnitureGroup$java_util_List$com_eteks_sweethome3d_model_HomePieceOfFurniture(e,e[0])},e.prototype.createHomeFurnitureGroup$java_util_List$com_eteks_sweethome3d_model_HomePieceOfFurniture=function(t,i){var n=this.preferences.getLocalizedString(e,"groupName",e.getFurnitureGroupCount(this.home.getFurniture())+1);return new HomeFurnitureGroup(t,i,n)},e.prototype.createHomeFurnitureGroup=function(e,t){if((null!=e&&e instanceof Array||null===e)&&(null!=t&&t instanceof HomePieceOfFurniture||null===t))return this.createHomeFurnitureGroup$java_util_List$com_eteks_sweethome3d_model_HomePieceOfFurniture(e,t);if((null!=e&&e instanceof Array||null===e)&&void 0===t)return this.createHomeFurnitureGroup$java_util_List(e);throw new Error("invalid overload")},e.getFurnitureGroupCount=function(t){for(var i=0,n=0;n<t.length;n++){var o=t[n];null!=o&&o instanceof HomeFurnitureGroup&&(i+=1+e.getFurnitureGroupCount(o.getFurniture()))}return i},e.doGroupFurniture=function(t,i,n,o,r,l,a,s){e.doDeleteFurniture(t,i,a,s),e.doAddFurniture(t,n,o,r,null,l,a,s)},e.doUngroupFurniture=function(t,i,n,o,r,l,a,s){e.doDeleteFurniture(t,i,a,s),e.doAddFurniture(t,n,o,r,null,l,a,s)},e.prototype.ungroupSelectedFurniture=function(){for(var t,i=[],n=this.home.getSelectedItems(),o=0;o<n.length;o++){var r=n[o];if(null!=r&&r instanceof HomeFurnitureGroup){var l=r;this.isPieceOfFurnitureMovable(l)&&i.push(l)}}if(0!=i.length){var a=this.home.getFurniture(),s=this.home.isBasePlanLocked(),h=this.home.isAllLevelsSelection(),u=this.home.getSelectedItems(),d={},c=0;for(o=0;o<i.length;o++){var p=i[o],g=e.getPieceOfFurnitureGroup(p,null,a);null==(P=function(e,t){null==e.entries&&(e.entries=[]);for(var i=0;i<e.entries.length;i++)if(null==e.entries[i].key&&null==t||null!=e.entries[i].key.equals&&e.entries[i].key.equals(t)||e.entries[i].key===t)return e.entries[i].value;return null}(d,g))&&function(e,t,i){null==e.entries&&(e.entries=[]);for(var n=0;n<e.entries.length;n++)if(null==e.entries[n].key&&null==t||null!=e.entries[n].key.equals&&e.entries[n].key.equals(t)||e.entries[n].key===t)return void(e.entries[n].value=i);e.entries.push({key:t,value:i,getKey:function(){return this.key},getValue:function(){return this.value}})}(d,g,P={}),null==g?function(e,t,i){null==e.entries&&(e.entries=[]);for(var n=0;n<e.entries.length;n++)if(null!=e.entries[n].key.equals&&e.entries[n].key.equals(t)||e.entries[n].key===t){var o=e.entries[n].value;return e.entries[n].value=i,o}e.entries.push({key:t,value:i,getKey:function(){return this.key},getValue:function(){return this.value}}),e.entries.sort((function(e,t){return null!=e.key.compareTo?e.key.compareTo(t):e.key-t.key}))}(P,a.indexOf(p),p):function(e,t,i){null==e.entries&&(e.entries=[]);for(var n=0;n<e.entries.length;n++)if(null!=e.entries[n].key.equals&&e.entries[n].key.equals(t)||e.entries[n].key===t){var o=e.entries[n].value;return e.entries[n].value=i,o}e.entries.push({key:t,value:i,getKey:function(){return this.key},getValue:function(){return this.value}}),e.entries.sort((function(e,t){return null!=e.key.compareTo?e.key.compareTo(t):e.key-t.key}))}(P,g.getFurniture().indexOf(p),p),c++}var m=function(e){for(var t=[];e-- >0;)t.push(null);return t}(c),f=function(e){for(var t=[];e-- >0;)t.push(null);return t}(m.length),v=function(e){for(var t=[];e-- >0;)t.push(0);return t}(m.length),_=function(e){for(var t=[];e-- >0;)t.push(null);return t}(m.length),S=0,y=[],E=[],C=[];for(n=(null==(t=d).entries&&(t.entries=[]),t.entries),o=0;o<n.length;o++)for(var P,w=n[o],L=function(e){return e.entries[e.entries.length-1].key}(P=w.getValue())+1-function(e){return null==e.entries&&(e.entries=[]),e.entries.length}(P),T=function(e){return null==e.entries&&(e.entries=[]),e.entries}(P),A=0;A<T.length;A++){var I=T[A];l=I.getValue();m[S]=l,f[S]=w.getKey(),v[S]=I.getKey(),_[S++]=l.getLevel();for(var b=l.getFurniture(),O=0;O<b.length;O++){var M=b[O];y.push(M),C.push(w.getKey()),E.push(L++)}}var D=y.slice(0),R=C.slice(0),F=function(e){for(var t=[];e-- >0;)t.push(0);return t}(D.length),x=function(e){for(var t=[];e-- >0;)t.push(null);return t}(D.length),N=s;for(S=0;S<D.length;S++)F[S]=E[S],x[S]=D[S].getLevel(),N=!this.isPieceOfFurniturePartOfBasePlan(D[S])&&N;var k=N;e.doUngroupFurniture(this.home,m,D,R,F,x,k,!1),null!=this.undoSupport&&this.undoSupport.postEdit(new e.FurnitureUngroupingUndoableEdit(this.home,this.preferences,u.slice(0),s,h,m,v,f,_,D,F,R,x,k))}},e.prototype.importFurniture$=function(){new ImportedFurnitureWizardController(this.home,this.preferences,this,this.viewFactory,this.contentManager,this.undoSupport).displayView(this.getView())},e.prototype.importFurniture$java_lang_String=function(e){new ImportedFurnitureWizardController(this.home,e,this.preferences,this,this.viewFactory,this.contentManager,this.undoSupport).displayView(this.getView())},e.prototype.importFurniture=function(e){if("string"==typeof e||null===e)return this.importFurniture$java_lang_String(e);if(void 0===e)return this.importFurniture$();throw new Error("invalid overload")},e.prototype.alignSelectedFurnitureOnTop=function(){var t=this.home.getSelectedItems();this.alignSelectedFurniture(new e.FurnitureTopAlignmentUndoableEdit(this.home,this.preferences,t.slice(0),this.getMovableSelectedFurniture(),this.leadSelectedPieceOfFurniture))},e.prototype.alignSelectedFurnitureOnBottom=function(){var t=this.home.getSelectedItems();this.alignSelectedFurniture(new e.FurnitureBottomAlignmentUndoableEdit(this.home,this.preferences,t.slice(0),this.getMovableSelectedFurniture(),this.leadSelectedPieceOfFurniture))},e.prototype.alignSelectedFurnitureOnLeft=function(){var t=this.home.getSelectedItems();this.alignSelectedFurniture(new e.FurnitureLeftAlignmentUndoableEdit(this.home,this.preferences,t.slice(0),this.getMovableSelectedFurniture(),this.leadSelectedPieceOfFurniture))},e.prototype.alignSelectedFurnitureOnRight=function(){var t=this.home.getSelectedItems();this.alignSelectedFurniture(new e.FurnitureRightAlignmentUndoableEdit(this.home,this.preferences,t.slice(0),this.getMovableSelectedFurniture(),this.leadSelectedPieceOfFurniture))},e.prototype.alignSelectedFurnitureOnFrontSide=function(){var t=this.home.getSelectedItems();this.alignSelectedFurniture(new e.FurnitureFrontSideAlignmentUndoableEdit(this.home,this.preferences,t.slice(0),this.getMovableSelectedFurniture(),this.leadSelectedPieceOfFurniture))},e.prototype.alignSelectedFurnitureOnBackSide=function(){var t=this.home.getSelectedItems();this.alignSelectedFurniture(new e.FurnitureBackSideAlignmentUndoableEdit(this.home,this.preferences,t.slice(0),this.getMovableSelectedFurniture(),this.leadSelectedPieceOfFurniture))},e.prototype.alignSelectedFurnitureOnLeftSide=function(){var t=this.home.getSelectedItems();this.alignSelectedFurniture(new e.FurnitureLeftSideAlignmentUndoableEdit(this.home,this.preferences,t.slice(0),this.getMovableSelectedFurniture(),this.leadSelectedPieceOfFurniture))},e.prototype.alignSelectedFurnitureOnRightSide=function(){var t=this.home.getSelectedItems();this.alignSelectedFurniture(new e.FurnitureRightSideAlignmentUndoableEdit(this.home,this.preferences,t.slice(0),this.getMovableSelectedFurniture(),this.leadSelectedPieceOfFurniture))},e.prototype.alignSelectedFurnitureSideBySide=function(){var t=this.home.getSelectedItems();this.alignSelectedFurniture(new e.FurnitureSideBySideAlignmentUndoableEdit(this.home,this.preferences,t.slice(0),this.getMovableSelectedFurniture(),this.leadSelectedPieceOfFurniture))},e.sortFurniture=function(t,i,n){var o,r,l=[];return null!=i&&l.push(i),o=l,r=t.slice(0),o.push.apply(o,r),function(e,t){t.compare?e.sort((function(e,i){return t.compare(e,i)})):e.sort(t)}(l,new e.FurnitureController$2(n)),l},e.alignPieceOfFurnitureAlongSides=function(t,i,n,o,r,l){var a=n.relativeCCW(t.getX(),t.getY())*n.ptLineDist(t.getX(),t.getY())+e.getPieceBoundingRectangleHeight(t,-i.getAngle())/2;o&&(a=-a);var s=Math.sin(i.getAngle()),h=Math.cos(i.getAngle()),u=-a*s,d=a*h,c=e.getPieceBoundingRectangleWidth(t,-i.getAngle());if(null!=r){var p=r.relativeCCW(t.getX(),t.getY());0===p&&(p=o?1:-1),u+=(a=l+p*(r.ptLineDist(t.getX(),t.getY())-c/2))*h,d+=a*s}return t.move(u,d),c},e.alignPieceOfFurnitureAlongLeftOrRightSides=function(t,i,n,o){var r=n.relativeCCW(t.getX(),t.getY())*n.ptLineDist(t.getX(),t.getY())+e.getPieceBoundingRectangleWidth(t,-i.getAngle())/2;o&&(r=-r),t.move(r*Math.cos(i.getAngle()),r*Math.sin(i.getAngle()))},e.getPieceBoundingRectangleWidth=function(e,t){return Math.abs(e.getWidthInPlan()*Math.cos(t+e.getAngle()))+Math.abs(e.getDepthInPlan()*Math.sin(t+e.getAngle()))},e.getPieceBoundingRectangleHeight=function(e,t){return Math.abs(e.getWidthInPlan()*Math.sin(t+e.getAngle()))+Math.abs(e.getDepthInPlan()*Math.cos(t+e.getAngle()))},e.prototype.alignSelectedFurniture=function(e){var t=this.getMovableSelectedFurniture();t.length>=2&&(this.home.setSelectedItems(t.slice(0)),e.alignFurniture$(),null!=this.undoSupport&&this.undoSupport.postEdit(e))},e.prototype.getMovableSelectedFurniture=function(){for(var e=[],t=this.home.getSelectedItems(),i=0;i<t.length;i++){var n=t[i];if(null!=n&&n instanceof HomePieceOfFurniture){var o=n;this.isPieceOfFurnitureMovable(o)&&e.push(o)}}return e.slice(0)},e.undoAlignFurniture=function(e,t,i){for(var n=0;n<e.length;n++){var o=e[n];o.setX(t[n]),o.setY(i[n])}},e.getMinX=function(e){for(var t=e.getPoints(),i=1/0,n=0;n<t.length;n++){var o=t[n];i=Math.min(i,o[0])}return i},e.getMaxX=function(e){for(var t=e.getPoints(),i=-1/0,n=0;n<t.length;n++){var o=t[n];i=Math.max(i,o[0])}return i},e.getMinY=function(e){for(var t=e.getPoints(),i=1/0,n=0;n<t.length;n++){var o=t[n];i=Math.min(i,o[1])}return i},e.getMaxY=function(e){for(var t=e.getPoints(),i=-1/0,n=0;n<t.length;n++){var o=t[n];i=Math.max(i,o[1])}return i},e.prototype.distributeSelectedFurnitureHorizontally=function(){this.distributeSelectedFurniture(!0)},e.prototype.distributeSelectedFurnitureVertically=function(){this.distributeSelectedFurniture(!1)},e.prototype.distributeSelectedFurniture=function(t){var i=this.getMovableSelectedFurniture();if(i.length>=3){for(var n=this.home.getSelectedItems(),o=function(e){for(var t=[];e-- >0;)t.push(0);return t}(i.length),r=function(e){for(var t=[];e-- >0;)t.push(0);return t}(i.length),l=0;l<i.length;l++)o[l]=i[l].getX(),r[l]=i[l].getY();this.home.setSelectedItems(i.slice(0)),e.doDistributeFurnitureAlongAxis(i,t),null!=this.undoSupport&&this.undoSupport.postEdit(new e.FurnitureDistributionUndoableEdit(this.home,this.preferences,n.slice(0),o,r,i,t))}},e.doDistributeFurnitureAlongAxis=function(t,i){for(var n=i?new java.awt.geom.Line2D.Float(0,0,0,-1):new java.awt.geom.Line2D.Float(0,0,1,0),o=e.sortFurniture(t,null,n),r=i?0:Math.PI/2,l=o[0],a=e.getPieceBoundingRectangleWidth(l,r)/2,s=o[o.length-1],h=e.getPieceBoundingRectangleWidth(s,r)/2,u=Math.abs(n.ptLineDist(s.getX(),s.getY())*n.relativeCCW(s.getX(),s.getY())-n.ptLineDist(l.getX(),l.getY())*n.relativeCCW(l.getX(),l.getY()))-h-a,d=function(e){for(var t=[];e-- >0;)t.push(0);return t}(o.length-2),c=1;c<o.length-1;c++){var p=o[c];d[c-1]=e.getPieceBoundingRectangleWidth(p,r),u-=d[c-1]}u/=o.length-1;var g=(i?l.getX():l.getY())+(a+u);for(c=1;c<o.length-1;c++){p=o[c];i?p.setX(g+d[c-1]/2):p.setY(g+d[c-1]/2),g+=u+d[c-1]}},e.prototype.resetFurnitureElevation=function(){var t=this.getMovableSelectedFurniture();if(t.length>=1){for(var i=this.home.getSelectedItems(),n=function(e){for(var t=[];e-- >0;)t.push(0);return t}(t.length),o=function(e){for(var t=[];e-- >0;)t.push(0);return t}(t.length),r=0;r<t.length;r++){var l=t[r];n[r]=l.getElevation();var a=this.getHighestSurroundingPieceOfFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture$java_util_List(l,t.slice(0));if(null!=a){var s=a.getElevation();a.isHorizontallyRotated()?s+=a.getHeightInPlan():s+=a.getHeight()*a.getDropOnTopElevation(),null!=a.getLevel()&&(s+=a.getLevel().getElevation()-l.getLevel().getElevation()),o[r]=Math.max(0,s)}else o[r]=0}this.home.setSelectedItems(t.slice(0)),e.doSetFurnitureElevation(t,o),null!=this.undoSupport&&this.undoSupport.postEdit(new e.FurnitureElevationResetUndoableEdit(this.home,this.preferences,i.slice(0),n,t,o))}},e.doSetFurnitureElevation=function(e,t){for(var i=0;i<e.length;i++)e[i].setElevation(t[i])},e.prototype.getHighestSurroundingPieceOfFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture=function(e){return this.getHighestSurroundingPieceOfFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture$java_util_List(e,[])},e.prototype.getHighestSurroundingPieceOfFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture$java_util_List=function(e,t){for(var i=null,n=14e-46,o=this.getSurroundingFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture$java_util_List$float$boolean(e,t,.05,!1),r=0;r<o.length;r++){var l=o[r],a=l.getElevation();l.isHorizontallyRotated()?a+=l.getHeightInPlan():a+=l.getHeight()*l.getDropOnTopElevation(),a>n&&(n=a,i=l)}return i},e.prototype.getHighestSurroundingPieceOfFurniture=function(e,t){if((null!=e&&e instanceof HomePieceOfFurniture||null===e)&&(null!=t&&t instanceof Array||null===t))return this.getHighestSurroundingPieceOfFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture$java_util_List(e,t);if((null!=e&&e instanceof HomePieceOfFurniture||null===e)&&void 0===t)return this.getHighestSurroundingPieceOfFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture(e);throw new Error("invalid overload")},e.prototype.getSurroundingFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture=function(e){return this.getSurroundingFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture$java_util_List$float$boolean(e,[],.2,!0)},e.prototype.getSurroundingFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture$java_util_List$float$boolean=function(e,t,i,n){for(var o=e.getPoints(),r=Math.min(e.getWidthInPlan(),e.getDepthInPlan())*i,l=[],a=this.getFurnitureInSameGroup(e),s=0;s<a.length;s++){var h=a[s];if(h!==e&&!(t.indexOf(h)>=0)&&this.isPieceOfFurnitureVisibleAtSelectedLevel(h)&&(h.getDropOnTopElevation()>=0||n&&null!=h&&h instanceof HomeShelfUnit)){for(var u=!0,d=0;d<o.length;d++){var c=o[d];if(!h.containsPoint(c[0],c[1],r)){u=!1;break}}u&&l.push(h)}}return l},e.prototype.getSurroundingFurniture=function(e,t,i,n){if(!(null!=e&&e instanceof HomePieceOfFurniture||null===e)||!(null!=t&&t instanceof Array||null===t)||"number"!=typeof i&&null!==i||"boolean"!=typeof n&&null!==n){if((null!=e&&e instanceof HomePieceOfFurniture||null===e)&&void 0===t&&void 0===i&&void 0===n)return this.getSurroundingFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture(e);throw new Error("invalid overload")}return this.getSurroundingFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture$java_util_List$float$boolean(e,t,i,n)},e.prototype.getFurnitureInSameGroup=function(t){var i=this.home.getFurniture(),n=e.getFurnitureInSameGroup(t,i);return null!=n?n:i},e.getFurnitureInSameGroup=function(t,i){for(var n=0;n<i.length;n++){var o=i[n];if(o===t)return i;if(null!=o&&o instanceof HomeFurnitureGroup){var r=e.getFurnitureInSameGroup(t,o.getFurniture());if(null!=r)return r}}return null},e.prototype.isPieceOfFurnitureVisibleAtSelectedLevel=function(e){var t=this.home.getSelectedLevel();return e.isVisible()&&(null==e.getLevel()||e.getLevel().isViewable())&&(e.getLevel()===t||e.isAtLevel(t))},e.prototype.setVisualProperty=function(e,t){this.home.setVisualProperty(e,t)},e.prototype.setHomeProperty=function(e,t){this.home.setProperty(e,t)},e}();FurnitureController.__class="com.eteks.sweethome3d.viewcontroller.FurnitureController",FurnitureController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"],function(e){var t=function(t){function i(i,n,o,r,l,a,s,h,u,d,c){var p=t.call(this,n,e,"undoAddFurnitureName")||this;return void 0===p.home&&(p.home=null),void 0===p.allLevelsSelection&&(p.allLevelsSelection=!1),void 0===p.oldSelection&&(p.oldSelection=null),void 0===p.oldBasePlanLocked&&(p.oldBasePlanLocked=!1),void 0===p.newFurniture&&(p.newFurniture=null),void 0===p.newFurnitureIndex&&(p.newFurnitureIndex=null),void 0===p.newFurnitureGroups&&(p.newFurnitureGroups=null),void 0===p.newFurnitureLevels&&(p.newFurnitureLevels=null),void 0===p.furnitureLevel&&(p.furnitureLevel=null),void 0===p.newBasePlanLocked&&(p.newBasePlanLocked=!1),p.home=i,p.oldSelection=o,p.oldBasePlanLocked=r,p.allLevelsSelection=l,p.newFurniture=a,p.newFurnitureIndex=s,p.newFurnitureGroups=h,p.newFurnitureLevels=u,p.furnitureLevel=d,p.newBasePlanLocked=c,p}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),e.doDeleteFurniture(this.home,this.newFurniture,this.oldBasePlanLocked,this.allLevelsSelection),this.home.setSelectedItems(this.oldSelection.slice(0))},i.prototype.redo=function(){t.prototype.redo.call(this),e.doAddFurniture(this.home,this.newFurniture,this.newFurnitureGroups,this.newFurnitureIndex,this.furnitureLevel,this.newFurnitureLevels,this.newBasePlanLocked,!1)},i}(LocalizedUndoableEdit);e.FurnitureAdditionUndoableEdit=t,t.__class="com.eteks.sweethome3d.viewcontroller.FurnitureController.FurnitureAdditionUndoableEdit",t.__interfaces=["javax.swing.undo.UndoableEdit"];var i=function(t){function i(i,n,o,r,l,a,s,h,u){var d=t.call(this,n,e,"undoDeleteSelectionName")||this;return void 0===d.home&&(d.home=null),void 0===d.oldSelection&&(d.oldSelection=null),void 0===d.basePlanLocked&&(d.basePlanLocked=!1),void 0===d.allLevelsSelection&&(d.allLevelsSelection=!1),void 0===d.furniture&&(d.furniture=null),void 0===d.furnitureIndex&&(d.furnitureIndex=null),void 0===d.furnitureGroups&&(d.furnitureGroups=null),void 0===d.furnitureLevels&&(d.furnitureLevels=null),d.home=i,d.oldSelection=o,d.basePlanLocked=r,d.allLevelsSelection=l,d.furniture=a,d.furnitureIndex=s,d.furnitureGroups=h,d.furnitureLevels=u,d}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),e.doAddFurniture(this.home,this.furniture,this.furnitureGroups,this.furnitureIndex,null,this.furnitureLevels,this.basePlanLocked,this.allLevelsSelection),this.home.setSelectedItems(this.oldSelection.slice(0))},i.prototype.redo=function(){t.prototype.redo.call(this),this.home.setSelectedItems(this.furniture.slice(0)),e.doDeleteFurniture(this.home,this.furniture,this.basePlanLocked,!1)},i}(LocalizedUndoableEdit);e.FurnitureDeletionUndoableEdit=i,i.__class="com.eteks.sweethome3d.viewcontroller.FurnitureController.FurnitureDeletionUndoableEdit",i.__interfaces=["javax.swing.undo.UndoableEdit"];var n=function(t){function i(i,n,o,r,l,a,s,h,u,d,c,p,g,m,f,v){var _=t.call(this,n,e,"undoGroupName")||this;return void 0===_.home&&(_.home=null),void 0===_.oldSelection&&(_.oldSelection=null),void 0===_.basePlanLocked&&(_.basePlanLocked=!1),void 0===_.allLevelsSelection&&(_.allLevelsSelection=!1),void 0===_.groupedPieces&&(_.groupedPieces=null),void 0===_.groupedPiecesIndex&&(_.groupedPiecesIndex=null),void 0===_.groupedPiecesGroups&&(_.groupedPiecesGroups=null),void 0===_.groupedPiecesLevel&&(_.groupedPiecesLevel=null),void 0===_.groupedPiecesElevation&&(_.groupedPiecesElevation=null),void 0===_.groupedPiecesVisible&&(_.groupedPiecesVisible=null),void 0===_.newGroup&&(_.newGroup=null),void 0===_.groupIndex&&(_.groupIndex=0),void 0===_.groupLevel&&(_.groupLevel=null),void 0===_.groupPiecesNewElevation&&(_.groupPiecesNewElevation=null),void 0===_.movable&&(_.movable=!1),_.home=i,_.basePlanLocked=r,_.oldSelection=o,_.allLevelsSelection=l,_.groupedPieces=a,_.groupedPiecesIndex=s,_.groupedPiecesGroups=h,_.groupedPiecesLevel=u,_.groupedPiecesElevation=d,_.groupedPiecesVisible=c,_.newGroup=p,_.groupIndex=g,_.groupLevel=m,_.groupPiecesNewElevation=f,_.movable=v,_}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),e.doUngroupFurniture(this.home,[this.newGroup],this.groupedPieces,this.groupedPiecesGroups,this.groupedPiecesIndex,this.groupedPiecesLevel,this.basePlanLocked,this.allLevelsSelection);for(var i=0;i<this.groupedPieces.length;i++)this.groupedPieces[i].setElevation(this.groupedPiecesElevation[i]),this.groupedPieces[i].setVisible(this.groupedPiecesVisible[i]);this.home.setSelectedItems(this.oldSelection.slice(0))},i.prototype.redo=function(){t.prototype.redo.call(this);for(var i=0;i<this.groupedPieces.length;i++)this.groupedPieces[i].setElevation(this.groupPiecesNewElevation[i]),this.groupedPieces[i].setLevel(null);this.newGroup.setMovable(this.movable),this.newGroup.setVisible(!0),e.doGroupFurniture(this.home,this.groupedPieces,[this.newGroup],null,[this.groupIndex],[this.groupLevel],this.basePlanLocked,!1)},i}(LocalizedUndoableEdit);e.FurnitureGroupingUndoableEdit=n,n.__class="com.eteks.sweethome3d.viewcontroller.FurnitureController.FurnitureGroupingUndoableEdit",n.__interfaces=["javax.swing.undo.UndoableEdit"];var o=function(t){function i(i,n,o,r,l,a,s,h,u,d,c,p,g,m){var f=t.call(this,n,e,"undoUngroupName")||this;return void 0===f.home&&(f.home=null),void 0===f.oldBasePlanLocked&&(f.oldBasePlanLocked=!1),void 0===f.oldSelection&&(f.oldSelection=null),void 0===f.allLevelsSelection&&(f.allLevelsSelection=!1),void 0===f.groups&&(f.groups=null),void 0===f.groupsIndex&&(f.groupsIndex=null),void 0===f.groupsGroups&&(f.groupsGroups=null),void 0===f.groupsLevels&&(f.groupsLevels=null),void 0===f.ungroupedPieces&&(f.ungroupedPieces=null),void 0===f.ungroupedPiecesIndex&&(f.ungroupedPiecesIndex=null),void 0===f.ungroupedPiecesGroups&&(f.ungroupedPiecesGroups=null),void 0===f.ungroupedPiecesLevels&&(f.ungroupedPiecesLevels=null),void 0===f.newBasePlanLocked&&(f.newBasePlanLocked=!1),f.home=i,f.oldSelection=o,f.oldBasePlanLocked=r,f.allLevelsSelection=l,f.groups=a,f.groupsIndex=s,f.groupsGroups=h,f.groupsLevels=u,f.ungroupedPieces=d,f.ungroupedPiecesIndex=c,f.ungroupedPiecesGroups=p,f.ungroupedPiecesLevels=g,f.newBasePlanLocked=m,f}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),e.doGroupFurniture(this.home,this.ungroupedPieces,this.groups,this.groupsGroups,this.groupsIndex,this.groupsLevels,this.oldBasePlanLocked,this.allLevelsSelection),this.home.setSelectedItems(this.oldSelection.slice(0))},i.prototype.redo=function(){t.prototype.redo.call(this),e.doUngroupFurniture(this.home,this.groups,this.ungroupedPieces,this.ungroupedPiecesGroups,this.ungroupedPiecesIndex,this.ungroupedPiecesLevels,this.newBasePlanLocked,!1)},i}(LocalizedUndoableEdit);e.FurnitureUngroupingUndoableEdit=o,o.__class="com.eteks.sweethome3d.viewcontroller.FurnitureController.FurnitureUngroupingUndoableEdit",o.__interfaces=["javax.swing.undo.UndoableEdit"];var r=function(t){function i(i,n,o,r,l){var a=t.call(this,n,e,"undoAlignName")||this;void 0===a.home&&(a.home=null),void 0===a.oldSelection&&(a.oldSelection=null),void 0===a.selectedFurniture&&(a.selectedFurniture=null),void 0===a.leadPiece&&(a.leadPiece=null),void 0===a.alignedFurniture&&(a.alignedFurniture=null),void 0===a.oldX&&(a.oldX=null),void 0===a.oldY&&(a.oldY=null),a.home=i,a.oldSelection=o,a.selectedFurniture=r,a.leadPiece=l,a.alignedFurniture=function(e){for(var t=[];e-- >0;)t.push(null);return t}(null==l?r.length:r.length-1),a.oldX=function(e){for(var t=[];e-- >0;)t.push(0);return t}(a.alignedFurniture.length),a.oldY=function(e){for(var t=[];e-- >0;)t.push(0);return t}(a.alignedFurniture.length);for(var s=0,h=0;h<r.length;h++){var u=r[h];u!==l&&(a.alignedFurniture[s]=u,a.oldX[s]=u.getX(),a.oldY[s]=u.getY(),s++)}return a}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),e.undoAlignFurniture(this.alignedFurniture,this.oldX,this.oldY),this.home.setSelectedItems(this.oldSelection.slice(0))},i.prototype.redo=function(){t.prototype.redo.call(this),this.home.setSelectedItems(this.selectedFurniture.slice(0)),this.alignFurniture$()},i.prototype.alignFurniture$=function(){this.alignFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture_A$com_eteks_sweethome3d_model_HomePieceOfFurniture(this.alignedFurniture,this.leadPiece)},i.prototype.alignFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture_A$com_eteks_sweethome3d_model_HomePieceOfFurniture=function(e,t){throw new Error("cannot invoke abstract overloaded method... check your argument(s) type(s)")},i.prototype.alignFurniture=function(e,t){if((null!=e&&e instanceof Array&&(0==e.length||null==e[0]||null!=e[0]&&e[0]instanceof HomePieceOfFurniture)||null===e)&&(null!=t&&t instanceof HomePieceOfFurniture||null===t))return this.alignFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture_A$com_eteks_sweethome3d_model_HomePieceOfFurniture(e,t);if(void 0===e&&void 0===t)return this.alignFurniture$();throw new Error("invalid overload")},i}(LocalizedUndoableEdit);e.FurnitureAlignmentUndoableEdit=r,r.__class="com.eteks.sweethome3d.viewcontroller.FurnitureController.FurnitureAlignmentUndoableEdit",r.__interfaces=["javax.swing.undo.UndoableEdit"];var l=function(t){function i(i,n,o,r,l,a,s){var h=t.call(this,n,e,"undoDistributeName")||this;return void 0===h.home&&(h.home=null),void 0===h.oldSelection&&(h.oldSelection=null),void 0===h.oldX&&(h.oldX=null),void 0===h.oldY&&(h.oldY=null),void 0===h.alignedFurniture&&(h.alignedFurniture=null),void 0===h.horizontal&&(h.horizontal=!1),h.home=i,h.oldSelection=o,h.oldX=r,h.oldY=l,h.alignedFurniture=a,h.horizontal=s,h}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),e.undoAlignFurniture(this.alignedFurniture,this.oldX,this.oldY),this.home.setSelectedItems(this.oldSelection.slice(0))},i.prototype.redo=function(){t.prototype.redo.call(this),this.home.setSelectedItems(this.alignedFurniture.slice(0)),e.doDistributeFurnitureAlongAxis(this.alignedFurniture,this.horizontal)},i}(LocalizedUndoableEdit);e.FurnitureDistributionUndoableEdit=l,l.__class="com.eteks.sweethome3d.viewcontroller.FurnitureController.FurnitureDistributionUndoableEdit",l.__interfaces=["javax.swing.undo.UndoableEdit"];var a=function(t){function i(i,n,o,r,l,a){var s=t.call(this,n,e,"undoResetElevation")||this;return void 0===s.home&&(s.home=null),void 0===s.oldSelection&&(s.oldSelection=null),void 0===s.furnitureOldElevation&&(s.furnitureOldElevation=null),void 0===s.selectedFurniture&&(s.selectedFurniture=null),void 0===s.furnitureNewElevation&&(s.furnitureNewElevation=null),s.home=i,s.oldSelection=o,s.furnitureOldElevation=r,s.selectedFurniture=l,s.furnitureNewElevation=a,s}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),e.doSetFurnitureElevation(this.selectedFurniture,this.furnitureOldElevation),this.home.setSelectedItems(this.oldSelection.slice(0))},i.prototype.redo=function(){t.prototype.redo.call(this),this.home.setSelectedItems(this.selectedFurniture.slice(0)),e.doSetFurnitureElevation(this.selectedFurniture,this.furnitureNewElevation)},i}(LocalizedUndoableEdit);e.FurnitureElevationResetUndoableEdit=a,a.__class="com.eteks.sweethome3d.viewcontroller.FurnitureController.FurnitureElevationResetUndoableEdit",a.__interfaces=["javax.swing.undo.UndoableEdit"];var s=function(t){function i(e,i,n,o,r){return t.call(this,e,i,n,o,r)||this}return __extends(i,t),i.prototype.alignFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture_A$com_eteks_sweethome3d_model_HomePieceOfFurniture=function(t,i){for(var n=e.getMinY(i),o=0;o<t.length;o++){var r=t[o],l=e.getMinY(r);r.setY(r.getY()+n-l)}},i.prototype.alignFurniture=function(e,t){if((null!=e&&e instanceof Array&&(0==e.length||null==e[0]||null!=e[0]&&e[0]instanceof HomePieceOfFurniture)||null===e)&&(null!=t&&t instanceof HomePieceOfFurniture||null===t))return this.alignFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture_A$com_eteks_sweethome3d_model_HomePieceOfFurniture(e,t);if(void 0===e&&void 0===t)return this.alignFurniture$();throw new Error("invalid overload")},i}(e.FurnitureAlignmentUndoableEdit);e.FurnitureTopAlignmentUndoableEdit=s,s.__class="com.eteks.sweethome3d.viewcontroller.FurnitureController.FurnitureTopAlignmentUndoableEdit",s.__interfaces=["javax.swing.undo.UndoableEdit"];var h=function(t){function i(e,i,n,o,r){return t.call(this,e,i,n,o,r)||this}return __extends(i,t),i.prototype.alignFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture_A$com_eteks_sweethome3d_model_HomePieceOfFurniture=function(t,i){for(var n=e.getMaxY(i),o=0;o<t.length;o++){var r=t[o],l=e.getMaxY(r);r.setY(r.getY()+n-l)}},i.prototype.alignFurniture=function(e,t){if((null!=e&&e instanceof Array&&(0==e.length||null==e[0]||null!=e[0]&&e[0]instanceof HomePieceOfFurniture)||null===e)&&(null!=t&&t instanceof HomePieceOfFurniture||null===t))return this.alignFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture_A$com_eteks_sweethome3d_model_HomePieceOfFurniture(e,t);if(void 0===e&&void 0===t)return this.alignFurniture$();throw new Error("invalid overload")},i}(e.FurnitureAlignmentUndoableEdit);e.FurnitureBottomAlignmentUndoableEdit=h,h.__class="com.eteks.sweethome3d.viewcontroller.FurnitureController.FurnitureBottomAlignmentUndoableEdit",h.__interfaces=["javax.swing.undo.UndoableEdit"];var u=function(t){function i(e,i,n,o,r){return t.call(this,e,i,n,o,r)||this}return __extends(i,t),i.prototype.alignFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture_A$com_eteks_sweethome3d_model_HomePieceOfFurniture=function(t,i){for(var n=e.getMinX(i),o=0;o<t.length;o++){var r=t[o],l=e.getMinX(r);r.setX(r.getX()+n-l)}},i.prototype.alignFurniture=function(e,t){if((null!=e&&e instanceof Array&&(0==e.length||null==e[0]||null!=e[0]&&e[0]instanceof HomePieceOfFurniture)||null===e)&&(null!=t&&t instanceof HomePieceOfFurniture||null===t))return this.alignFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture_A$com_eteks_sweethome3d_model_HomePieceOfFurniture(e,t);if(void 0===e&&void 0===t)return this.alignFurniture$();throw new Error("invalid overload")},i}(e.FurnitureAlignmentUndoableEdit);e.FurnitureLeftAlignmentUndoableEdit=u,u.__class="com.eteks.sweethome3d.viewcontroller.FurnitureController.FurnitureLeftAlignmentUndoableEdit",u.__interfaces=["javax.swing.undo.UndoableEdit"];var d=function(t){function i(e,i,n,o,r){return t.call(this,e,i,n,o,r)||this}return __extends(i,t),i.prototype.alignFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture_A$com_eteks_sweethome3d_model_HomePieceOfFurniture=function(t,i){for(var n=e.getMaxX(i),o=0;o<t.length;o++){var r=t[o],l=e.getMaxX(r);r.setX(r.getX()+n-l)}},i.prototype.alignFurniture=function(e,t){if((null!=e&&e instanceof Array&&(0==e.length||null==e[0]||null!=e[0]&&e[0]instanceof HomePieceOfFurniture)||null===e)&&(null!=t&&t instanceof HomePieceOfFurniture||null===t))return this.alignFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture_A$com_eteks_sweethome3d_model_HomePieceOfFurniture(e,t);if(void 0===e&&void 0===t)return this.alignFurniture$();throw new Error("invalid overload")},i}(e.FurnitureAlignmentUndoableEdit);e.FurnitureRightAlignmentUndoableEdit=d,d.__class="com.eteks.sweethome3d.viewcontroller.FurnitureController.FurnitureRightAlignmentUndoableEdit",d.__interfaces=["javax.swing.undo.UndoableEdit"];var c=function(t){function i(e,i,n,o,r){return t.call(this,e,i,n,o,r)||this}return __extends(i,t),i.prototype.alignFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture_A$com_eteks_sweethome3d_model_HomePieceOfFurniture=function(t,i){for(var n=i.getPoints(),o=new java.awt.geom.Line2D.Float(n[2][0],n[2][1],n[3][0],n[3][1]),r=0;r<t.length;r++){var l=t[r];e.alignPieceOfFurnitureAlongSides(l,i,o,!0,null,0)}},i.prototype.alignFurniture=function(e,t){if((null!=e&&e instanceof Array&&(0==e.length||null==e[0]||null!=e[0]&&e[0]instanceof HomePieceOfFurniture)||null===e)&&(null!=t&&t instanceof HomePieceOfFurniture||null===t))return this.alignFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture_A$com_eteks_sweethome3d_model_HomePieceOfFurniture(e,t);if(void 0===e&&void 0===t)return this.alignFurniture$();throw new Error("invalid overload")},i}(e.FurnitureAlignmentUndoableEdit);e.FurnitureFrontSideAlignmentUndoableEdit=c,c.__class="com.eteks.sweethome3d.viewcontroller.FurnitureController.FurnitureFrontSideAlignmentUndoableEdit",c.__interfaces=["javax.swing.undo.UndoableEdit"];var p=function(t){function i(e,i,n,o,r){return t.call(this,e,i,n,o,r)||this}return __extends(i,t),i.prototype.alignFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture_A$com_eteks_sweethome3d_model_HomePieceOfFurniture=function(t,i){for(var n=i.getPoints(),o=new java.awt.geom.Line2D.Float(n[0][0],n[0][1],n[1][0],n[1][1]),r=0;r<t.length;r++){var l=t[r];e.alignPieceOfFurnitureAlongSides(l,i,o,!1,null,0)}},i.prototype.alignFurniture=function(e,t){if((null!=e&&e instanceof Array&&(0==e.length||null==e[0]||null!=e[0]&&e[0]instanceof HomePieceOfFurniture)||null===e)&&(null!=t&&t instanceof HomePieceOfFurniture||null===t))return this.alignFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture_A$com_eteks_sweethome3d_model_HomePieceOfFurniture(e,t);if(void 0===e&&void 0===t)return this.alignFurniture$();throw new Error("invalid overload")},i}(e.FurnitureAlignmentUndoableEdit);e.FurnitureBackSideAlignmentUndoableEdit=p,p.__class="com.eteks.sweethome3d.viewcontroller.FurnitureController.FurnitureBackSideAlignmentUndoableEdit",p.__interfaces=["javax.swing.undo.UndoableEdit"];var g=function(t){function i(e,i,n,o,r){return t.call(this,e,i,n,o,r)||this}return __extends(i,t),i.prototype.alignFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture_A$com_eteks_sweethome3d_model_HomePieceOfFurniture=function(t,i){for(var n=i.getPoints(),o=new java.awt.geom.Line2D.Float(n[3][0],n[3][1],n[0][0],n[0][1]),r=0;r<t.length;r++){var l=t[r];e.alignPieceOfFurnitureAlongLeftOrRightSides(l,i,o,!1)}},i.prototype.alignFurniture=function(e,t){if((null!=e&&e instanceof Array&&(0==e.length||null==e[0]||null!=e[0]&&e[0]instanceof HomePieceOfFurniture)||null===e)&&(null!=t&&t instanceof HomePieceOfFurniture||null===t))return this.alignFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture_A$com_eteks_sweethome3d_model_HomePieceOfFurniture(e,t);if(void 0===e&&void 0===t)return this.alignFurniture$();throw new Error("invalid overload")},i}(e.FurnitureAlignmentUndoableEdit);e.FurnitureLeftSideAlignmentUndoableEdit=g,g.__class="com.eteks.sweethome3d.viewcontroller.FurnitureController.FurnitureLeftSideAlignmentUndoableEdit",g.__interfaces=["javax.swing.undo.UndoableEdit"];var m=function(t){function i(e,i,n,o,r){return t.call(this,e,i,n,o,r)||this}return __extends(i,t),i.prototype.alignFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture_A$com_eteks_sweethome3d_model_HomePieceOfFurniture=function(t,i){for(var n=i.getPoints(),o=new java.awt.geom.Line2D.Float(n[1][0],n[1][1],n[2][0],n[2][1]),r=0;r<t.length;r++){var l=t[r];e.alignPieceOfFurnitureAlongLeftOrRightSides(l,i,o,!0)}},i.prototype.alignFurniture=function(e,t){if((null!=e&&e instanceof Array&&(0==e.length||null==e[0]||null!=e[0]&&e[0]instanceof HomePieceOfFurniture)||null===e)&&(null!=t&&t instanceof HomePieceOfFurniture||null===t))return this.alignFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture_A$com_eteks_sweethome3d_model_HomePieceOfFurniture(e,t);if(void 0===e&&void 0===t)return this.alignFurniture$();throw new Error("invalid overload")},i}(e.FurnitureAlignmentUndoableEdit);e.FurnitureRightSideAlignmentUndoableEdit=m,m.__class="com.eteks.sweethome3d.viewcontroller.FurnitureController.FurnitureRightSideAlignmentUndoableEdit",m.__interfaces=["javax.swing.undo.UndoableEdit"];var f=function(t){function i(e,i,n,o,r){return t.call(this,e,i,n,o,r)||this}return __extends(i,t),i.prototype.alignFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture_A$com_eteks_sweethome3d_model_HomePieceOfFurniture=function(t,i){for(var n=i.getPoints(),o=new java.awt.geom.Line2D.Float(i.getX(),i.getY(),(n[0][0]+n[1][0])/2,(n[0][1]+n[1][1])/2),r=e.sortFurniture(t,i,o),l=r.indexOf(i),a=new java.awt.geom.Line2D.Float(n[0][0],n[0][1],n[1][0],n[1][1]),s=i.getWidthInPlan()/2,h=l+1;h<r.length;h++)s+=e.alignPieceOfFurnitureAlongSides(r[h],i,a,!1,o,s);s=-i.getWidthInPlan()/2;for(h=l-1;h>=0;h--)s-=e.alignPieceOfFurnitureAlongSides(r[h],i,a,!1,o,s)},i.prototype.alignFurniture=function(e,t){if((null!=e&&e instanceof Array&&(0==e.length||null==e[0]||null!=e[0]&&e[0]instanceof HomePieceOfFurniture)||null===e)&&(null!=t&&t instanceof HomePieceOfFurniture||null===t))return this.alignFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture_A$com_eteks_sweethome3d_model_HomePieceOfFurniture(e,t);if(void 0===e&&void 0===t)return this.alignFurniture$();throw new Error("invalid overload")},i}(e.FurnitureAlignmentUndoableEdit);e.FurnitureSideBySideAlignmentUndoableEdit=f,f.__class="com.eteks.sweethome3d.viewcontroller.FurnitureController.FurnitureSideBySideAlignmentUndoableEdit",f.__interfaces=["javax.swing.undo.UndoableEdit"];var v=function(){function e(e){this.__parent=e}return e.prototype.selectionChanged=function(e){var t=Home.getFurnitureSubList(this.__parent.home.getSelectedItems());0==t.length?this.__parent.leadSelectedPieceOfFurniture=null:null!=this.__parent.leadSelectedPieceOfFurniture&&1!==t.length&&-1!==t.indexOf(this.__parent.leadSelectedPieceOfFurniture)||(this.__parent.leadSelectedPieceOfFurniture=t[0])},e}();e.FurnitureController$0=v,v.__interfaces=["com.eteks.sweethome3d.model.SelectionListener"];var _=function(){function e(e){this.__parent=e}return e.prototype.propertyChange=function(e){if("MOVABLE"===e.getPropertyName()){var t=e.getSource();if(this.__parent.home.isBasePlanLocked()&&this.__parent.isPieceOfFurniturePartOfBasePlan(t)){var i=this.__parent.home.getSelectedItems();i.indexOf(t)>=0&&(i=i.slice(0),(o=(n=i).indexOf(t))>=0&&n.splice(o,1),this.__parent.home.setSelectedItems(i))}}var n,o},e}();e.FurnitureController$1=_;var S=function(){function e(e){this.orthogonalAxis=e}return e.prototype.compare=function(e,t){return this.orthogonalAxis.ptLineDistSq(t.getX(),t.getY())*this.orthogonalAxis.relativeCCW(t.getX(),t.getY())-this.orthogonalAxis.ptLineDistSq(e.getX(),e.getY())*this.orthogonalAxis.relativeCCW(e.getX(),e.getY())},e}();e.FurnitureController$2=S}(FurnitureController||(FurnitureController={}));var LabelController=function(){function e(e,t,i,n,o,r){if((null!=e&&e instanceof Home||null===e)&&("number"==typeof t||null===t)&&("number"==typeof i||null===i)&&(null!=n&&n instanceof UserPreferences||null===n)&&(null!=o&&null!=o.constructor&&null!=o.constructor.__interfaces&&o.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0||null===o)&&(null!=r&&r instanceof javax.swing.undo.UndoableEditSupport||null===r)){var l=arguments;void 0===this.home&&(this.home=null),void 0===this.x&&(this.x=null),void 0===this.y&&(this.y=null),void 0===this.preferences&&(this.preferences=null),void 0===this.viewFactory&&(this.viewFactory=null),void 0===this.undoSupport&&(this.undoSupport=null),void 0===this.propertyChangeSupport&&(this.propertyChangeSupport=null),void 0===this.labelView&&(this.labelView=null),void 0===this.text&&(this.text=null),void 0===this.alignment&&(this.alignment=null),void 0===this.fontName&&(this.fontName=null),void 0===this.fontNameSet&&(this.fontNameSet=!1),void 0===this.fontSize&&(this.fontSize=null),void 0===this.color&&(this.color=null),void 0===this.pitch&&(this.pitch=null),void 0===this.pitchEnabled&&(this.pitchEnabled=null),void 0===this.elevation&&(this.elevation=null),this.home=e,this.x=t,this.y=i,this.preferences=n,this.viewFactory=o,this.undoSupport=r,this.propertyChangeSupport=new PropertyChangeSupport(this),this.alignment=TextStyle.Alignment.CENTER,this.fontName=n.getDefaultFontName(),this.fontNameSet=!0,this.fontSize=n.getDefaultTextStyle(Label).getFontSize(),this.pitchEnabled=!1,this.elevation=0}else{if(!((null!=e&&e instanceof Home||null===e)&&(null!=t&&t instanceof UserPreferences||null===t)&&(null!=i&&null!=i.constructor&&null!=i.constructor.__interfaces&&i.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0||null===i)&&(null!=n&&n instanceof javax.swing.undo.UndoableEditSupport||null===n)&&void 0===o&&void 0===r))throw new Error("invalid overload");var a=(l=arguments)[1],s=l[2],h=l[3];void 0===this.home&&(this.home=null),void 0===this.x&&(this.x=null),void 0===this.y&&(this.y=null),void 0===this.preferences&&(this.preferences=null),void 0===this.viewFactory&&(this.viewFactory=null),void 0===this.undoSupport&&(this.undoSupport=null),void 0===this.propertyChangeSupport&&(this.propertyChangeSupport=null),void 0===this.labelView&&(this.labelView=null),void 0===this.text&&(this.text=null),void 0===this.alignment&&(this.alignment=null),void 0===this.fontName&&(this.fontName=null),void 0===this.fontNameSet&&(this.fontNameSet=!1),void 0===this.fontSize&&(this.fontSize=null),void 0===this.color&&(this.color=null),void 0===this.pitch&&(this.pitch=null),void 0===this.pitchEnabled&&(this.pitchEnabled=null),void 0===this.elevation&&(this.elevation=null),this.home=e,this.x=null,this.y=null,this.preferences=a,this.viewFactory=s,this.undoSupport=h,this.propertyChangeSupport=new PropertyChangeSupport(this),this.updateProperties()}}return e.prototype.updateProperties=function(){var e=Home.getLabelsSubList(this.home.getSelectedItems());if(0==e.length)this.setText(null),this.setFontName(null),this.fontNameSet=!1,this.setFontSize(null),this.setAlignment(null),this.setColor(null),this.setPitch(null),this.pitchEnabled=!1,this.setElevation(null);else{var t=e[0],i=t.getText();if(null!=i)for(var n=1;n<e.length;n++)if(i!==e[n].getText()){i=null;break}this.setText(i);var o=null!=t.getStyle()?t.getStyle().getAlignment():TextStyle.Alignment.CENTER;for(n=1;n<e.length;n++){if(o!==(null!=(a=e[n]).getStyle()?a.getStyle().getAlignment():TextStyle.Alignment.CENTER)){o=null;break}}this.setAlignment(o);var r=null!=t.getStyle()?t.getStyle().getFontName():null,l=!0;for(n=1;n<e.length;n++){var a=e[n];if((null!=r||null!=a.getStyle()&&null!=a.getStyle().getFontName())&&(null==r||null==a.getStyle()||r!==a.getStyle().getFontName())){l=!1;break}}this.setFontName(r),this.fontNameSet=l;var s=this.preferences.getDefaultTextStyle(Label).getFontSize(),h=null!=t.getStyle()?t.getStyle().getFontSize():s;for(n=1;n<e.length;n++){if(h!==(null!=(a=e[n]).getStyle()?a.getStyle().getFontSize():s)){h=null;break}}this.setFontSize(h);var u=t.getColor();if(null!=u)for(n=1;n<e.length;n++)if(u!==e[n].getColor()){u=null;break}this.setColor(u);var d=t.getPitch();for(n=1;n<e.length;n++){a=e[n];if(!(null==d&&null==a.getPitch()||null!=d&&d===a.getPitch())){d=null;break}}this.setPitch(d);var c=null!=t.getPitch();for(n=1;n<e.length;n++)if(c!==(null!=e[n].getPitch())){c=null;break}this.pitchEnabled=c;var p=t.getElevation();for(n=1;n<e.length;n++)if(p!==e[n].getElevation()){p=null;break}this.setElevation(p)}},e.prototype.getView=function(){return null==this.labelView&&(this.labelView=this.viewFactory.createLabelView(null==this.x,this.preferences,this)),this.labelView},e.prototype.displayView=function(e){this.getView().displayView(e)},e.prototype.addPropertyChangeListener=function(e,t){this.propertyChangeSupport.addPropertyChangeListener(e,t)},e.prototype.removePropertyChangeListener=function(e,t){this.propertyChangeSupport.removePropertyChangeListener(e,t)},e.prototype.setText=function(e){if(e!==this.text){var t=this.text;this.text=e,this.propertyChangeSupport.firePropertyChange("TEXT",t,e)}},e.prototype.getText=function(){return this.text},e.prototype.setAlignment=function(e){if(e!==this.alignment){var t=this.alignment;this.alignment=e,this.propertyChangeSupport.firePropertyChange("ALIGNMENT",t,e)}},e.prototype.getAlignment=function(){return this.alignment},e.prototype.setFontName=function(e){if(e!==this.fontName){var t=this.fontName;this.fontName=e,this.propertyChangeSupport.firePropertyChange("FONT_NAME",t,e),this.fontNameSet=!0}},e.prototype.getFontName=function(){return this.fontName},e.prototype.setFontSize=function(e){if(e!==this.fontSize){var t=this.fontSize;this.fontSize=e,this.propertyChangeSupport.firePropertyChange("FONT_SIZE",t,e)}},e.prototype.getFontSize=function(){return this.fontSize},e.prototype.isFontNameSet=function(){return this.fontNameSet},e.prototype.setColor=function(e){if(e!==this.color){var t=this.color;this.color=e,this.propertyChangeSupport.firePropertyChange("COLOR",t,e)}},e.prototype.getColor=function(){return this.color},e.prototype.setPitch=function(e){if(e!==this.pitch){var t=this.pitch;this.pitch=e,this.propertyChangeSupport.firePropertyChange("PITCH",t,e)}this.pitchEnabled=null!=e},e.prototype.getPitch=function(){return this.pitch},e.prototype.isPitchEnabled=function(){return this.pitchEnabled},e.prototype.setElevation=function(e){if(e!==this.elevation){var t=this.elevation;this.elevation=e,this.propertyChangeSupport.firePropertyChange("ELEVATION",t,e)}},e.prototype.getElevation=function(){return this.elevation},e.prototype.createLabel$java_lang_String$float$float=function(e,t,i){var n=new Label(e,t,i);return this.home.addLabel(n),n},e.prototype.createLabel=function(e,t,i){if("string"!=typeof e&&null!==e||"number"!=typeof t&&null!==t||"number"!=typeof i&&null!==i){if(void 0===e&&void 0===t&&void 0===i)return this.createLabel$();throw new Error("invalid overload")}return this.createLabel$java_lang_String$float$float(e,t,i)},e.prototype.createLabel$=function(){var t=this.getText();if(null!=t&&t.trim().length>0){var i=this.home.getSelectedItems(),n=this.home.isBasePlanLocked(),o=this.home.isAllLevelsSelection(),r=this.createLabel$java_lang_String$float$float(t,this.x,this.y),l=this.getAlignment(),a=this.getFontName(),s=this.getFontSize();if(null!=a||null!=s||null!=this.getPitch()){var h=this.preferences.getDefaultTextStyle(Label);null!=a&&(h=h.deriveStyle$java_lang_String(a)),null!=s&&(h=h.deriveStyle$float(s)),null!=l&&(h=h.deriveStyle$com_eteks_sweethome3d_model_TextStyle_Alignment(l)),r.setStyle(h)}null!=this.color&&r.setColor(this.color),r.setColor(this.getColor()),r.setPitch(this.getPitch()),r.setElevation(this.getElevation());var u=n&&!this.isLabelPartOfBasePlan(r);if(e.doAddAndSelectLabel(this.home,r,!1,u),null!=this.undoSupport){var d=new e.LabelCreationUndoableEdit(this.home,this.preferences,i.slice(0),n,o,r,u);this.undoSupport.postEdit(d)}t.indexOf("\n")<0&&this.preferences.addAutoCompletionString("LabelText",t)}},e.doAddAndSelectLabel=function(e,t,i,n){i&&e.addLabel(t),e.setBasePlanLocked(n),e.setSelectedItems([t].slice(0)),e.setAllLevelsSelection(!1)},e.doDeleteLabel=function(e,t,i){e.deleteLabel(t),e.setBasePlanLocked(i)},e.prototype.isLabelPartOfBasePlan=function(e){return!0},e.prototype.modifyLabels=function(){var t=this.home.getSelectedItems(),i=Home.getLabelsSubList(t);if(0!=i.length){var n=this.getText();null!=n&&0===n.trim().length&&(n=null);for(var o=this.getAlignment(),r=this.getFontName(),l=this.isFontNameSet(),a=this.getFontSize(),s=this.getColor(),h=this.getPitch(),u=this.isPitchEnabled(),d=this.getElevation(),c=function(e){for(var t=[];e-- >0;)t.push(null);return t}(i.length),p=0;p<c.length;p++)c[p]=new e.ModifiedLabel(i[p]);var g=this.preferences.getDefaultTextStyle(Label);if(e.doModifyLabels(c,n,o,r,l,a,g,s,h,u,d),null!=this.undoSupport){var m=new e.LabelModificationUndoableEdit(this.home,this.preferences,t.slice(0),c,n,o,r,l,a,g,s,h,u,d);this.undoSupport.postEdit(m)}null!=n&&n.indexOf("\n")<0&&this.preferences.addAutoCompletionString("LabelText",n)}},e.doModifyLabels=function(e,t,i,n,o,r,l,a,s,h,u){for(var d=0;d<e.length;d++){var c=e[d].getLabel();null!=t&&c.setText(t),null!=i&&c.setStyle(null!=c.getStyle()?c.getStyle().deriveStyle$com_eteks_sweethome3d_model_TextStyle_Alignment(i):l.deriveStyle$com_eteks_sweethome3d_model_TextStyle_Alignment(i)),o&&c.setStyle(null!=c.getStyle()?c.getStyle().deriveStyle$java_lang_String(n):l.deriveStyle$java_lang_String(n)),null!=r&&c.setStyle(null!=c.getStyle()?c.getStyle().deriveStyle$float(r):l.deriveStyle$float(r)),null!=a&&c.setColor(a),null!=h&&(!1===h?c.setPitch(null):null!=s&&(c.setPitch(s),null==c.getStyle()&&c.setStyle(l))),null!=u&&c.setElevation(u)}},e.undoModifyLabels=function(e){for(var t=0;t<e.length;t++){e[t].reset()}},e}();LabelController.__class="com.eteks.sweethome3d.viewcontroller.LabelController",LabelController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"],function(e){var t=function(t){function i(i,n,o,r,l,a,s){var h=t.call(this,n,e,"undoCreateLabelName")||this;return void 0===h.home&&(h.home=null),void 0===h.oldSelection&&(h.oldSelection=null),void 0===h.oldBasePlanLocked&&(h.oldBasePlanLocked=!1),void 0===h.oldAllLevelsSelection&&(h.oldAllLevelsSelection=!1),void 0===h.label&&(h.label=null),void 0===h.newBasePlanLocked&&(h.newBasePlanLocked=!1),h.home=i,h.oldSelection=o,h.oldBasePlanLocked=r,h.oldAllLevelsSelection=l,h.label=a,h.newBasePlanLocked=s,h}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),e.doDeleteLabel(this.home,this.label,this.oldBasePlanLocked),this.home.setSelectedItems(this.oldSelection.slice(0)),this.home.setAllLevelsSelection(this.oldAllLevelsSelection)},i.prototype.redo=function(){t.prototype.redo.call(this),e.doAddAndSelectLabel(this.home,this.label,!0,this.newBasePlanLocked)},i}(LocalizedUndoableEdit);e.LabelCreationUndoableEdit=t,t.__class="com.eteks.sweethome3d.viewcontroller.LabelController.LabelCreationUndoableEdit",t.__interfaces=["javax.swing.undo.UndoableEdit"];var i=function(t){function i(i,n,o,r,l,a,s,h,u,d,c,p,g,m){var f=t.call(this,n,e,"undoModifyLabelsName")||this;return void 0===f.home&&(f.home=null),void 0===f.oldSelection&&(f.oldSelection=null),void 0===f.modifiedLabels&&(f.modifiedLabels=null),void 0===f.text&&(f.text=null),void 0===f.alignment&&(f.alignment=null),void 0===f.fontName&&(f.fontName=null),void 0===f.fontNameSet&&(f.fontNameSet=!1),void 0===f.fontSize&&(f.fontSize=null),void 0===f.defaultStyle&&(f.defaultStyle=null),void 0===f.color&&(f.color=null),void 0===f.pitch&&(f.pitch=null),void 0===f.pitchEnabled&&(f.pitchEnabled=null),void 0===f.elevation&&(f.elevation=null),f.home=i,f.oldSelection=o,f.modifiedLabels=r,f.text=l,f.alignment=a,f.fontName=s,f.fontNameSet=h,f.fontSize=u,f.defaultStyle=d,f.color=c,f.pitch=p,f.pitchEnabled=g,f.elevation=m,f}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),e.undoModifyLabels(this.modifiedLabels),this.home.setSelectedItems(this.oldSelection.slice(0))},i.prototype.redo=function(){t.prototype.redo.call(this),e.doModifyLabels(this.modifiedLabels,this.text,this.alignment,this.fontName,this.fontNameSet,this.fontSize,this.defaultStyle,this.color,this.pitch,this.pitchEnabled,this.elevation),this.home.setSelectedItems(this.oldSelection.slice(0))},i}(LocalizedUndoableEdit);e.LabelModificationUndoableEdit=i,i.__class="com.eteks.sweethome3d.viewcontroller.LabelController.LabelModificationUndoableEdit",i.__interfaces=["javax.swing.undo.UndoableEdit"];var n=function(){function e(e){void 0===this.label&&(this.label=null),void 0===this.text&&(this.text=null),void 0===this.style&&(this.style=null),void 0===this.color&&(this.color=null),void 0===this.pitch&&(this.pitch=null),void 0===this.elevation&&(this.elevation=0),this.label=e,this.text=e.getText(),this.style=e.getStyle(),this.color=e.getColor(),this.pitch=e.getPitch(),this.elevation=e.getElevation()}return e.prototype.getLabel=function(){return this.label},e.prototype.reset=function(){this.label.setText(this.text),this.label.setStyle(this.style),this.label.setColor(this.color),this.label.setPitch(this.pitch),this.label.setElevation(this.elevation)},e}();e.ModifiedLabel=n,n.__class="com.eteks.sweethome3d.viewcontroller.LabelController.ModifiedLabel"}(LabelController||(LabelController={}));var PhotoController=function(e){function t(i,n,o,r,l){var a=e.call(this,i,n,o,l)||this;return void 0===a.__com_eteks_sweethome3d_viewcontroller_PhotoController_home&&(a.__com_eteks_sweethome3d_viewcontroller_PhotoController_home=null),void 0===a.preferences&&(a.preferences=null),void 0===a.viewFactory&&(a.viewFactory=null),void 0===a.cameraChangeListener&&(a.cameraChangeListener=null),void 0===a.photoView&&(a.photoView=null),void 0===a.time&&(a.time=0),void 0===a.lens&&(a.lens=null),void 0===a.renderer&&(a.renderer=null),a.__com_eteks_sweethome3d_viewcontroller_PhotoController_home=i,a.preferences=n,a.viewFactory=r,a.cameraChangeListener=new t.CameraChangeListener(a),i.getCamera().addPropertyChangeListener(a.cameraChangeListener),i.addPropertyChangeListener("CAMERA",new t.HomeCameraChangeListener(a)),a.updateProperties(),a}return __extends(t,e),t.prototype.getView=function(){return null==this.photoView&&(this.photoView=this.viewFactory.createPhotoView(this.__com_eteks_sweethome3d_viewcontroller_PhotoController_home,this.preferences,this)),this.photoView},t.prototype.displayView=function(e){this.getView().displayView(e)},t.prototype.updateProperties=function(){if(null!=this.__com_eteks_sweethome3d_viewcontroller_PhotoController_home){e.prototype.updateProperties.call(this),this.setTime(this.__com_eteks_sweethome3d_viewcontroller_PhotoController_home.getCamera().getTime()),this.setLens(this.__com_eteks_sweethome3d_viewcontroller_PhotoController_home.getCamera().getLens());var t=this.__com_eteks_sweethome3d_viewcontroller_PhotoController_home.getCamera().getRenderer();null==t&&(t=this.preferences.getPhotoRenderer()),this.setRenderer(t,!1)}},t.prototype.setTime=function(e){if(this.time!==e){var t=this.time;this.time=e,this.propertyChangeSupport.firePropertyChange("TIME",t,e);var i=this.__com_eteks_sweethome3d_viewcontroller_PhotoController_home.getCamera();i.removePropertyChangeListener(this.cameraChangeListener),i.setTime(e),i.addPropertyChangeListener(this.cameraChangeListener)}},t.prototype.getTime=function(){return this.time},t.prototype.setLens=function(e){if(this.lens!==e){var t=this.lens;this.lens=e,this.propertyChangeSupport.firePropertyChange("LENS",t,e),e===Camera.Lens.SPHERICAL?this.setAspectRatio(AspectRatio.RATIO_2_1):e===Camera.Lens.FISHEYE&&this.setAspectRatio(AspectRatio.SQUARE_RATIO),this.__com_eteks_sweethome3d_viewcontroller_PhotoController_home.getCamera().setLens(this.lens)}},t.prototype.getLens=function(){return this.lens},t.prototype.setRenderer=function(e,t){if(void 0===t&&(t=!0),this.renderer!==e){var i=this.renderer;this.renderer=e,this.propertyChangeSupport.firePropertyChange("RENDERER",i,e),this.__com_eteks_sweethome3d_viewcontroller_PhotoController_home.getTopCamera().setRenderer(this.renderer),this.__com_eteks_sweethome3d_viewcontroller_PhotoController_home.getObserverCamera().setRenderer(this.renderer),t&&this.preferences.setPhotoRenderer(e)}},t.prototype.getRenderer=function(){return this.renderer},t}(AbstractPhotoController);PhotoController.__class="com.eteks.sweethome3d.viewcontroller.PhotoController",PhotoController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"],function(e){var t=function(){function e(e){void 0===this.photoController&&(this.photoController=null),this.photoController=e}return e.prototype.propertyChange=function(e){var t=this.photoController;null==t?e.getSource().removePropertyChangeListener("CAMERA",this):(e.getOldValue().removePropertyChangeListener(t.cameraChangeListener),t.updateProperties(),e.getNewValue().addPropertyChangeListener(t.cameraChangeListener))},e}();e.HomeCameraChangeListener=t,t.__class="com.eteks.sweethome3d.viewcontroller.PhotoController.HomeCameraChangeListener";var i=function(){function e(e){void 0===this.photoController&&(this.photoController=null),this.photoController=e}return e.prototype.propertyChange=function(e){var t=this.photoController;null==t?e.getSource().removePropertyChangeListener(this):t.updateProperties()},e}();e.CameraChangeListener=i,i.__class="com.eteks.sweethome3d.viewcontroller.PhotoController.CameraChangeListener"}(PhotoController||(PhotoController={}));var PhotosController=function(e){function t(i,n,o,r,l){var a=e.call(this,i,n,o,l)||this;return void 0===a.__com_eteks_sweethome3d_viewcontroller_PhotosController_home&&(a.__com_eteks_sweethome3d_viewcontroller_PhotosController_home=null),void 0===a.preferences&&(a.preferences=null),void 0===a.viewFactory&&(a.viewFactory=null),void 0===a.photoView&&(a.photoView=null),void 0===a.cameras&&(a.cameras=null),void 0===a.selectedCameras&&(a.selectedCameras=null),void 0===a.fileFormat&&(a.fileFormat=null),void 0===a.fileCompressionQuality&&(a.fileCompressionQuality=null),a.__com_eteks_sweethome3d_viewcontroller_PhotosController_home=i,a.preferences=n,a.viewFactory=r,a.cameras=[],a.selectedCameras=[],i.addPropertyChangeListener("STORED_CAMERAS",new t.HomeStoredCamerasChangeListener(a)),a.updateProperties(),a}return __extends(t,e),t.prototype.getView=function(){return null==this.photoView&&(this.photoView=this.viewFactory.createPhotosView(this.__com_eteks_sweethome3d_viewcontroller_PhotosController_home,this.preferences,this)),this.photoView},t.prototype.displayView=function(e){this.getView().displayView(e)},t.prototype.updateProperties=function(){null!=this.__com_eteks_sweethome3d_viewcontroller_PhotosController_home&&(e.prototype.updateProperties.call(this),this.setCameras(this.__com_eteks_sweethome3d_viewcontroller_PhotosController_home.getStoredCameras()),this.setSelectedCameras(this.__com_eteks_sweethome3d_viewcontroller_PhotosController_home.getStoredCameras()))},t.prototype.getCameras=function(){return this.cameras},t.prototype.setCameras=function(e){if(!function(e,t){if(null==e&&null==t)return!0;if(null==e||null==t)return!1;if(e.length!=t.length)return!1;for(var i=0;i<e.length;i++)if(e[i]!=t[i])return!1;return!0}(e,this.cameras)){var t=this.cameras;this.cameras=e.slice(0),this.propertyChangeSupport.firePropertyChange("CAMERAS",t.slice(0),e.slice(0))}},t.prototype.getSelectedCameras=function(){return this.selectedCameras},t.prototype.setSelectedCameras=function(e){if(!function(e,t){if(null==e&&null==t)return!0;if(null==e||null==t)return!1;if(e.length!=t.length)return!1;for(var i=0;i<e.length;i++)if(e[i]!=t[i])return!1;return!0}(e,this.selectedCameras)){var t=this.selectedCameras;this.selectedCameras=e.slice(0),this.propertyChangeSupport.firePropertyChange("SELECTED_CAMERAS",t.slice(0),e.slice(0))}},t.prototype.getFileFormat=function(){return this.fileFormat},t.prototype.setFileFormat=function(e){if(e!==this.fileFormat){var t=this.fileFormat;this.fileFormat=e,this.propertyChangeSupport.firePropertyChange("FILE_FORMAT",t,e)}},t.prototype.getFileCompressionQuality=function(){return this.fileCompressionQuality},t.prototype.setFileCompressionQuality=function(e){if(e!==this.fileCompressionQuality){var t=this.fileCompressionQuality;this.fileCompressionQuality=e,this.propertyChangeSupport.firePropertyChange("FILE_COMPRESSION_QUALITY",t,e)}},t}(AbstractPhotoController);PhotosController.__class="com.eteks.sweethome3d.viewcontroller.PhotosController",PhotosController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"],function(e){var t=function(){function e(e){void 0===this.photosController&&(this.photosController=null),this.photosController=e}return e.prototype.propertyChange=function(e){var t=this.photosController;null==t?e.getSource().removePropertyChangeListener("STORED_CAMERAS",this):t.updateProperties()},e}();e.HomeStoredCamerasChangeListener=t,t.__class="com.eteks.sweethome3d.viewcontroller.PhotosController.HomeStoredCamerasChangeListener"}(PhotosController||(PhotosController={}));var HomeShelfUnit=function(e){function t(t,i,n){var o=this;if(("string"==typeof t||null===t)&&(null!=i&&null!=i.constructor&&null!=i.constructor.__interfaces&&i.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.ShelfUnit")>=0||null===i)&&(null!=n&&n instanceof Array&&(0==n.length||null==n[0]||"string"==typeof n[0])||null===n)){var r=arguments;void 0===(o=e.call(this,t,i,n)||this).shelfElevations&&(o.shelfElevations=null),void 0===o.shelfBoxes&&(o.shelfBoxes=null),o.shelfElevations=i.getShelfElevations(),o.shelfBoxes=i.getShelfBoxes()}else if((null!=t&&null!=t.constructor&&null!=t.constructor.__interfaces&&t.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.ShelfUnit")>=0||null===t)&&(null!=i&&i instanceof Array&&(0==i.length||null==i[0]||"string"==typeof i[0])||null===i)&&void 0===n){var l=(r=arguments)[0],a=r[1],s=HomeObject.createId("shelfUnit");void 0===(o=e.call(this,s,l,a)||this).shelfElevations&&(o.shelfElevations=null),void 0===o.shelfBoxes&&(o.shelfBoxes=null),o.shelfElevations=l.getShelfElevations(),o.shelfBoxes=l.getShelfBoxes(),void 0===o.shelfElevations&&(o.shelfElevations=null),void 0===o.shelfBoxes&&(o.shelfBoxes=null)}else if("string"!=typeof t&&null!==t||!(null!=i&&null!=i.constructor&&null!=i.constructor.__interfaces&&i.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.ShelfUnit")>=0||null===i)||void 0!==n){if(!(null!=t&&null!=t.constructor&&null!=t.constructor.__interfaces&&t.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.ShelfUnit")>=0||null===t)||void 0!==i||void 0!==n)throw new Error("invalid overload");var h=(r=arguments)[0],u=HomePieceOfFurniture.EMPTY_PROPERTY_ARRAY_$LI$(),d=HomeObject.createId("shelfUnit");void 0===(o=e.call(this,d,h,u)||this).shelfElevations&&(o.shelfElevations=null),void 0===o.shelfBoxes&&(o.shelfBoxes=null),o.shelfElevations=h.getShelfElevations(),o.shelfBoxes=h.getShelfBoxes(),void 0===o.shelfElevations&&(o.shelfElevations=null),void 0===o.shelfBoxes&&(o.shelfBoxes=null),void 0===o.shelfElevations&&(o.shelfElevations=null),void 0===o.shelfBoxes&&(o.shelfBoxes=null)}else{var r=arguments,c=HomePieceOfFurniture.EMPTY_PROPERTY_ARRAY_$LI$();void 0===(o=e.call(this,t,i,c)||this).shelfElevations&&(o.shelfElevations=null),void 0===o.shelfBoxes&&(o.shelfBoxes=null),o.shelfElevations=i.getShelfElevations(),o.shelfBoxes=i.getShelfBoxes(),void 0===o.shelfElevations&&(o.shelfElevations=null),void 0===o.shelfBoxes&&(o.shelfBoxes=null)}return o}return __extends(t,e),t.prototype.getShelfElevations=function(){return null!=this.shelfElevations?this.shelfElevations.slice(0):null},t.prototype.setShelfElevations=function(e){if(!function(e,t){if(null==e&&null==t)return!0;if(null==e||null==t)return!1;if(e.length!=t.length)return!1;for(var i=0;i<e.length;i++)if(e[i]!=t[i])return!1;return!0}(e,this.shelfElevations)){var t=0===this.shelfElevations.length?this.shelfElevations:this.shelfElevations.slice(0);this.shelfElevations=0===e.length?e:e.slice(0),this.firePropertyChange("SHELF_ELEVATIONS",t,e)}},t.prototype.getShelfBoxes=function(){return this.shelfBoxes.slice(0)},t.prototype.setShelfBoxes=function(e){if(!function(e,t){if(null==e&&null==t)return!0;if(null==e||null==t)return!1;if(e.length!=t.length)return!1;for(var i=0;i<e.length;i++)if(e[i]!=t[i])return!1;return!0}(e,this.shelfBoxes)){var t=0===this.shelfBoxes.length?this.shelfBoxes:this.shelfBoxes.slice(0);this.shelfBoxes=0===e.length?e:e.slice(0),this.firePropertyChange("SHELF_BOXES",t,e)}},t.prototype.clone=function(){var t=this;return function(i){if(null!=e.prototype.clone)return e.prototype.clone.call(t);var n=Object.create(i);for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o]);return n}(this)},t}(HomePieceOfFurniture);HomeShelfUnit.__class="com.eteks.sweethome3d.model.HomeShelfUnit",HomeShelfUnit.__interfaces=["com.eteks.sweethome3d.model.Selectable","com.eteks.sweethome3d.model.PieceOfFurniture","com.eteks.sweethome3d.model.ShelfUnit","com.eteks.sweethome3d.model.Elevatable"],HomeShelfUnit.__transients=["shapeCache","propertyChangeSupport"];var HomeLight=function(e){function t(t,i,n){var o=this;if(("string"==typeof t||null===t)&&(null!=i&&null!=i.constructor&&null!=i.constructor.__interfaces&&i.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Light")>=0||null===i)&&(null!=n&&n instanceof Array&&(0==n.length||null==n[0]||"string"==typeof n[0])||null===n)){var r=arguments;void 0===(o=e.call(this,t,i,n)||this).lightSources&&(o.lightSources=null),void 0===o.lightSourceMaterialNames&&(o.lightSourceMaterialNames=null),void 0===o.power&&(o.power=0),o.lightSources=i.getLightSources(),o.lightSourceMaterialNames=i.getLightSourceMaterialNames(),o.power=.5}else if((null!=t&&null!=t.constructor&&null!=t.constructor.__interfaces&&t.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Light")>=0||null===t)&&(null!=i&&i instanceof Array&&(0==i.length||null==i[0]||"string"==typeof i[0])||null===i)&&void 0===n){var l=(r=arguments)[0],a=r[1],s=HomeObject.createId("light");void 0===(o=e.call(this,s,l,a)||this).lightSources&&(o.lightSources=null),void 0===o.lightSourceMaterialNames&&(o.lightSourceMaterialNames=null),void 0===o.power&&(o.power=0),o.lightSources=l.getLightSources(),o.lightSourceMaterialNames=l.getLightSourceMaterialNames(),o.power=.5,void 0===o.lightSources&&(o.lightSources=null),void 0===o.lightSourceMaterialNames&&(o.lightSourceMaterialNames=null),void 0===o.power&&(o.power=0)}else if("string"!=typeof t&&null!==t||!(null!=i&&null!=i.constructor&&null!=i.constructor.__interfaces&&i.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Light")>=0||null===i)||void 0!==n){if(!(null!=t&&null!=t.constructor&&null!=t.constructor.__interfaces&&t.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Light")>=0||null===t)||void 0!==i||void 0!==n)throw new Error("invalid overload");var h=(r=arguments)[0],u=HomePieceOfFurniture.EMPTY_PROPERTY_ARRAY_$LI$(),d=HomeObject.createId("light");void 0===(o=e.call(this,d,h,u)||this).lightSources&&(o.lightSources=null),void 0===o.lightSourceMaterialNames&&(o.lightSourceMaterialNames=null),void 0===o.power&&(o.power=0),o.lightSources=h.getLightSources(),o.lightSourceMaterialNames=h.getLightSourceMaterialNames(),o.power=.5,void 0===o.lightSources&&(o.lightSources=null),void 0===o.lightSourceMaterialNames&&(o.lightSourceMaterialNames=null),void 0===o.power&&(o.power=0),void 0===o.lightSources&&(o.lightSources=null),void 0===o.lightSourceMaterialNames&&(o.lightSourceMaterialNames=null),void 0===o.power&&(o.power=0)}else{var r=arguments,c=HomePieceOfFurniture.EMPTY_PROPERTY_ARRAY_$LI$();void 0===(o=e.call(this,t,i,c)||this).lightSources&&(o.lightSources=null),void 0===o.lightSourceMaterialNames&&(o.lightSourceMaterialNames=null),void 0===o.power&&(o.power=0),o.lightSources=i.getLightSources(),o.lightSourceMaterialNames=i.getLightSourceMaterialNames(),o.power=.5,void 0===o.lightSources&&(o.lightSources=null),void 0===o.lightSourceMaterialNames&&(o.lightSourceMaterialNames=null),void 0===o.power&&(o.power=0)}return o}return __extends(t,e),t.prototype.getLightSources=function(){return 0===this.lightSources.length?this.lightSources:this.lightSources.slice(0)},t.prototype.setLightSources=function(e){if(!function(e,t){if(null==e&&null==t)return!0;if(null==e||null==t)return!1;if(e.length!=t.length)return!1;for(var i=0;i<e.length;i++)if(e[i]!=t[i])return!1;return!0}(e,this.lightSources)){var t=0===this.lightSources.length?this.lightSources:this.lightSources.slice(0);this.lightSources=0===e.length?e:e.slice(0),this.firePropertyChange("LIGHT_SOURCES",t,e)}},t.prototype.getLightSourceMaterialNames=function(){return 0===this.lightSourceMaterialNames.length?this.lightSourceMaterialNames:this.lightSourceMaterialNames.slice(0)},t.prototype.setLightSourceMaterialNames=function(e){if(!function(e,t){if(null==e&&null==t)return!0;if(null==e||null==t)return!1;if(e.length!=t.length)return!1;for(var i=0;i<e.length;i++)if(e[i]!=t[i])return!1;return!0}(e,this.lightSourceMaterialNames)){var t=0===this.lightSourceMaterialNames.length?this.lightSourceMaterialNames:this.lightSourceMaterialNames.slice(0);this.lightSourceMaterialNames=0===e.length?e:e.slice(0),this.firePropertyChange("LIGHT_SOURCE_MATERIAL_NAMES",t,e)}},t.prototype.getPower=function(){return this.power},t.prototype.setPower=function(e){if(e!==this.power){var t=this.power;this.power=e,this.firePropertyChange("POWER",t,e)}},t.prototype.clone=function(){var t=this;return function(i){if(null!=e.prototype.clone)return e.prototype.clone.call(t);var n=Object.create(i);for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o]);return n}(this)},t}(HomePieceOfFurniture);HomeLight.__class="com.eteks.sweethome3d.model.HomeLight",HomeLight.__interfaces=["com.eteks.sweethome3d.model.Selectable","com.eteks.sweethome3d.model.PieceOfFurniture","com.eteks.sweethome3d.model.Elevatable","com.eteks.sweethome3d.model.Light"],HomeLight.__transients=["shapeCache","propertyChangeSupport"];var HomeDoorOrWindow=function(e){function t(t,i,n){var o=this;if(("string"==typeof t||null===t)&&(null!=i&&null!=i.constructor&&null!=i.constructor.__interfaces&&i.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.DoorOrWindow")>=0||null===i)&&(null!=n&&n instanceof Array&&(0==n.length||null==n[0]||"string"==typeof n[0])||null===n)){var r=arguments;void 0===(o=e.call(this,t,i,n)||this).wallThickness&&(o.wallThickness=0),void 0===o.wallDistance&&(o.wallDistance=0),void 0===o.wallWidth&&(o.wallWidth=0),void 0===o.wallLeft&&(o.wallLeft=0),void 0===o.wallHeight&&(o.wallHeight=0),void 0===o.wallTop&&(o.wallTop=0),void 0===o.wallCutOutOnBothSides&&(o.wallCutOutOnBothSides=!1),void 0===o.widthDepthDeformable&&(o.widthDepthDeformable=!1),void 0===o.sashes&&(o.sashes=null),void 0===o.cutOutShape&&(o.cutOutShape=null),void 0===o.boundToWall&&(o.boundToWall=!1),o.wallThickness=i.getWallThickness(),o.wallDistance=i.getWallDistance(),o.wallWidth=1,o.wallLeft=0,o.wallHeight=1,o.wallTop=0,o.wallCutOutOnBothSides=i.isWallCutOutOnBothSides(),o.widthDepthDeformable=i.isWidthDepthDeformable(),o.sashes=i.getSashes(),o.cutOutShape=i.getCutOutShape()}else if((null!=t&&null!=t.constructor&&null!=t.constructor.__interfaces&&t.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.DoorOrWindow")>=0||null===t)&&(null!=i&&i instanceof Array&&(0==i.length||null==i[0]||"string"==typeof i[0])||null===i)&&void 0===n){var l=(r=arguments)[0],a=r[1],s=HomeObject.createId("doorOrWindow");void 0===(o=e.call(this,s,l,a)||this).wallThickness&&(o.wallThickness=0),void 0===o.wallDistance&&(o.wallDistance=0),void 0===o.wallWidth&&(o.wallWidth=0),void 0===o.wallLeft&&(o.wallLeft=0),void 0===o.wallHeight&&(o.wallHeight=0),void 0===o.wallTop&&(o.wallTop=0),void 0===o.wallCutOutOnBothSides&&(o.wallCutOutOnBothSides=!1),void 0===o.widthDepthDeformable&&(o.widthDepthDeformable=!1),void 0===o.sashes&&(o.sashes=null),void 0===o.cutOutShape&&(o.cutOutShape=null),void 0===o.boundToWall&&(o.boundToWall=!1),o.wallThickness=l.getWallThickness(),o.wallDistance=l.getWallDistance(),o.wallWidth=1,o.wallLeft=0,o.wallHeight=1,o.wallTop=0,o.wallCutOutOnBothSides=l.isWallCutOutOnBothSides(),o.widthDepthDeformable=l.isWidthDepthDeformable(),o.sashes=l.getSashes(),o.cutOutShape=l.getCutOutShape(),void 0===o.wallThickness&&(o.wallThickness=0),void 0===o.wallDistance&&(o.wallDistance=0),void 0===o.wallWidth&&(o.wallWidth=0),void 0===o.wallLeft&&(o.wallLeft=0),void 0===o.wallHeight&&(o.wallHeight=0),void 0===o.wallTop&&(o.wallTop=0),void 0===o.wallCutOutOnBothSides&&(o.wallCutOutOnBothSides=!1),void 0===o.widthDepthDeformable&&(o.widthDepthDeformable=!1),void 0===o.sashes&&(o.sashes=null),void 0===o.cutOutShape&&(o.cutOutShape=null),void 0===o.boundToWall&&(o.boundToWall=!1)}else if("string"!=typeof t&&null!==t||!(null!=i&&null!=i.constructor&&null!=i.constructor.__interfaces&&i.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.DoorOrWindow")>=0||null===i)||void 0!==n){if(!(null!=t&&null!=t.constructor&&null!=t.constructor.__interfaces&&t.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.DoorOrWindow")>=0||null===t)||void 0!==i||void 0!==n)throw new Error("invalid overload");var h=(r=arguments)[0],u=HomePieceOfFurniture.EMPTY_PROPERTY_ARRAY_$LI$(),d=HomeObject.createId("doorOrWindow");void 0===(o=e.call(this,d,h,u)||this).wallThickness&&(o.wallThickness=0),void 0===o.wallDistance&&(o.wallDistance=0),void 0===o.wallWidth&&(o.wallWidth=0),void 0===o.wallLeft&&(o.wallLeft=0),void 0===o.wallHeight&&(o.wallHeight=0),void 0===o.wallTop&&(o.wallTop=0),void 0===o.wallCutOutOnBothSides&&(o.wallCutOutOnBothSides=!1),void 0===o.widthDepthDeformable&&(o.widthDepthDeformable=!1),void 0===o.sashes&&(o.sashes=null),void 0===o.cutOutShape&&(o.cutOutShape=null),void 0===o.boundToWall&&(o.boundToWall=!1),o.wallThickness=h.getWallThickness(),o.wallDistance=h.getWallDistance(),o.wallWidth=1,o.wallLeft=0,o.wallHeight=1,o.wallTop=0,o.wallCutOutOnBothSides=h.isWallCutOutOnBothSides(),o.widthDepthDeformable=h.isWidthDepthDeformable(),o.sashes=h.getSashes(),o.cutOutShape=h.getCutOutShape(),void 0===o.wallThickness&&(o.wallThickness=0),void 0===o.wallDistance&&(o.wallDistance=0),void 0===o.wallWidth&&(o.wallWidth=0),void 0===o.wallLeft&&(o.wallLeft=0),void 0===o.wallHeight&&(o.wallHeight=0),void 0===o.wallTop&&(o.wallTop=0),void 0===o.wallCutOutOnBothSides&&(o.wallCutOutOnBothSides=!1),void 0===o.widthDepthDeformable&&(o.widthDepthDeformable=!1),void 0===o.sashes&&(o.sashes=null),void 0===o.cutOutShape&&(o.cutOutShape=null),void 0===o.boundToWall&&(o.boundToWall=!1),void 0===o.wallThickness&&(o.wallThickness=0),void 0===o.wallDistance&&(o.wallDistance=0),void 0===o.wallWidth&&(o.wallWidth=0),void 0===o.wallLeft&&(o.wallLeft=0),void 0===o.wallHeight&&(o.wallHeight=0),void 0===o.wallTop&&(o.wallTop=0),void 0===o.wallCutOutOnBothSides&&(o.wallCutOutOnBothSides=!1),void 0===o.widthDepthDeformable&&(o.widthDepthDeformable=!1),void 0===o.sashes&&(o.sashes=null),void 0===o.cutOutShape&&(o.cutOutShape=null),void 0===o.boundToWall&&(o.boundToWall=!1)}else{var r=arguments,c=HomePieceOfFurniture.EMPTY_PROPERTY_ARRAY_$LI$();void 0===(o=e.call(this,t,i,c)||this).wallThickness&&(o.wallThickness=0),void 0===o.wallDistance&&(o.wallDistance=0),void 0===o.wallWidth&&(o.wallWidth=0),void 0===o.wallLeft&&(o.wallLeft=0),void 0===o.wallHeight&&(o.wallHeight=0),void 0===o.wallTop&&(o.wallTop=0),void 0===o.wallCutOutOnBothSides&&(o.wallCutOutOnBothSides=!1),void 0===o.widthDepthDeformable&&(o.widthDepthDeformable=!1),void 0===o.sashes&&(o.sashes=null),void 0===o.cutOutShape&&(o.cutOutShape=null),void 0===o.boundToWall&&(o.boundToWall=!1),o.wallThickness=i.getWallThickness(),o.wallDistance=i.getWallDistance(),o.wallWidth=1,o.wallLeft=0,o.wallHeight=1,o.wallTop=0,o.wallCutOutOnBothSides=i.isWallCutOutOnBothSides(),o.widthDepthDeformable=i.isWidthDepthDeformable(),o.sashes=i.getSashes(),o.cutOutShape=i.getCutOutShape(),void 0===o.wallThickness&&(o.wallThickness=0),void 0===o.wallDistance&&(o.wallDistance=0),void 0===o.wallWidth&&(o.wallWidth=0),void 0===o.wallLeft&&(o.wallLeft=0),void 0===o.wallHeight&&(o.wallHeight=0),void 0===o.wallTop&&(o.wallTop=0),void 0===o.wallCutOutOnBothSides&&(o.wallCutOutOnBothSides=!1),void 0===o.widthDepthDeformable&&(o.widthDepthDeformable=!1),void 0===o.sashes&&(o.sashes=null),void 0===o.cutOutShape&&(o.cutOutShape=null),void 0===o.boundToWall&&(o.boundToWall=!1)}return o}return __extends(t,e),t.prototype.getWallThickness=function(){return this.wallThickness},t.prototype.setWallThickness=function(e){if(e!==this.wallThickness){var t=this.wallThickness;this.wallThickness=e,this.firePropertyChange("WALL_THICKNESS",t,e)}},t.prototype.getWallDistance=function(){return this.wallDistance},t.prototype.setWallDistance=function(e){if(e!==this.wallDistance){var t=this.wallDistance;this.wallDistance=e,this.firePropertyChange("WALL_DISTANCE",t,e)}},t.prototype.getWallWidth=function(){return this.wallWidth},t.prototype.setWallWidth=function(e){if(e!==this.wallWidth){var t=this.wallWidth;this.wallWidth=e,this.firePropertyChange("WALL_WIDTH",t,e)}},t.prototype.getWallLeft=function(){return this.wallLeft},t.prototype.setWallLeft=function(e){if(e!==this.wallLeft){var t=this.wallLeft;this.wallLeft=e,this.firePropertyChange("WALL_LEFT",t,e)}},t.prototype.getWallHeight=function(){return this.wallHeight},t.prototype.setWallHeight=function(e){if(e!==this.wallHeight){var t=this.wallHeight;this.wallHeight=e,this.firePropertyChange("WALL_HEIGHT",t,e)}},t.prototype.getWallTop=function(){return this.wallTop},t.prototype.setWallTop=function(e){if(e!==this.wallTop){var t=this.wallTop;this.wallTop=e,this.firePropertyChange("WALL_TOP",t,e)}},t.prototype.getSashes=function(){return 0===this.sashes.length?this.sashes:this.sashes.slice(0)},t.prototype.setSashes=function(e){if(!function(e,t){if(null==e&&null==t)return!0;if(null==e||null==t)return!1;if(e.length!=t.length)return!1;for(var i=0;i<e.length;i++)if(e[i]!=t[i])return!1;return!0}(e,this.sashes)){var t=0===this.sashes.length?this.sashes:this.sashes.slice(0);this.sashes=0===e.length?e:e.slice(0),this.firePropertyChange("SASHES",t,e)}},t.prototype.getCutOutShape=function(){return this.cutOutShape},t.prototype.setCutOutShape=function(e){if(e!==this.cutOutShape&&(null==e||e!==this.cutOutShape)){var t=this.cutOutShape;this.cutOutShape=e,this.firePropertyChange("CUT_OUT_SHAPE",t,e)}},t.prototype.isWallCutOutOnBothSides=function(){return this.wallCutOutOnBothSides},t.prototype.setWallCutOutOnBothSides=function(e){e!==this.wallCutOutOnBothSides&&(this.wallCutOutOnBothSides=e,this.firePropertyChange("WALL_CUT_OUT_ON_BOTH_SIDES",!e,e))},t.prototype.isWidthDepthDeformable=function(){return this.widthDepthDeformable},t.prototype.setWidthDepthDeformable=function(e){e!==this.widthDepthDeformable&&(this.widthDepthDeformable=e,this.firePropertyChange("WIDTH_DEPTH_DEFORMABLE",!e,e))},t.prototype.isBoundToWall=function(){return this.boundToWall},t.prototype.setBoundToWall=function(e){e!==this.boundToWall&&(this.boundToWall=e,this.firePropertyChange("BOUND_TO_WALL",!e,e))},t.prototype.setX=function(t){this.getX()!==t&&(this.boundToWall=!1),e.prototype.setX.call(this,t)},t.prototype.setY=function(t){this.getY()!==t&&(this.boundToWall=!1),e.prototype.setY.call(this,t)},t.prototype.setAngle=function(t){this.getAngle()!==t&&(this.boundToWall=!1),e.prototype.setAngle.call(this,t)},t.prototype.setDepth=function(t){this.getDepth()!==t&&(this.boundToWall=!1),e.prototype.setDepth.call(this,t)},t.prototype.isDoorOrWindow=function(){return!0},t.prototype.duplicate=function(){var t=e.prototype.duplicate.call(this);return t.boundToWall=!1,t},t}(HomePieceOfFurniture);HomeDoorOrWindow.__class="com.eteks.sweethome3d.model.HomeDoorOrWindow",HomeDoorOrWindow.__interfaces=["com.eteks.sweethome3d.model.Selectable","com.eteks.sweethome3d.model.DoorOrWindow","com.eteks.sweethome3d.model.PieceOfFurniture","com.eteks.sweethome3d.model.Elevatable"],HomeDoorOrWindow.__transients=["shapeCache","propertyChangeSupport"];var HomeFurnitureGroup=function(e){function t(t,i,n,o,r){var l=this;if("string"!=typeof t&&null!==t||!(null!=i&&i instanceof Array||null===i)||"number"!=typeof n&&null!==n||"boolean"!=typeof o&&null!==o||"string"!=typeof r&&null!==r)if(!(null!=t&&t instanceof Array||null===t)||"number"!=typeof i&&null!==i||"boolean"!=typeof n&&null!==n||"string"!=typeof o&&null!==o||void 0!==r)if((null!=t&&t instanceof Array||null===t)&&(null!=i&&i instanceof HomePieceOfFurniture||null===i)&&("string"==typeof n||null===n)&&void 0===o&&void 0===r){var a=(w=arguments)[0],s=w[1],h=w[2],u=s.getAngle(),d=HomeObject.createId("furnitureGroup");void 0===(l=e.call(this,d,a[0])||this).furniture&&(l.furniture=null),void 0===l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable&&(l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable=!1),void 0===l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable&&(l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable=!1),void 0===l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable&&(l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable=!1),void 0===l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow&&(l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow=!1),void 0===l.fixedWidth&&(l.fixedWidth=0),void 0===l.fixedDepth&&(l.fixedDepth=0),void 0===l.fixedHeight&&(l.fixedHeight=0),void 0===l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_dropOnTopElevation&&(l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_dropOnTopElevation=0),void 0===l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency&&(l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency=null),void 0===l.furnitureListener&&(l.furnitureListener=null),l.furniture=a.slice(0),l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable=!0,l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable=!0,l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable=!0;for(E=!0,C=!1,P=0;P<a.length;P++){E=(L=a[P]).isMovable()&&E,C=L.isVisible()||C}l.setName(h),l.setCatalogId(null),l.setDescription(null),l.setInformation(null),l.setCreator(null),l.setNameVisible(!1),l.setNameXOffset(0),l.setNameYOffset(0),l.setNameAngle(0),l.setNameStyle(null),e.prototype.setIcon.call(l,null),e.prototype.setPlanIcon.call(l,null),e.prototype.setModel.call(l,null),e.prototype.setMovable.call(l,E),e.prototype.setAngle.call(l,u),e.prototype.setModelMirrored.call(l,!1),l.setVisible(C),l.updateLocationAndSize(a,u,!0),l.addFurnitureListener(),void 0===l.furniture&&(l.furniture=null),void 0===l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable&&(l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable=!1),void 0===l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable&&(l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable=!1),void 0===l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable&&(l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable=!1),void 0===l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow&&(l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow=!1),void 0===l.fixedWidth&&(l.fixedWidth=0),void 0===l.fixedDepth&&(l.fixedDepth=0),void 0===l.fixedHeight&&(l.fixedHeight=0),void 0===l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_dropOnTopElevation&&(l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_dropOnTopElevation=0),void 0===l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency&&(l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency=null),void 0===l.furnitureListener&&(l.furnitureListener=null),void 0===l.furniture&&(l.furniture=null),void 0===l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable&&(l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable=!1),void 0===l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable&&(l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable=!1),void 0===l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable&&(l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable=!1),void 0===l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow&&(l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow=!1),void 0===l.fixedWidth&&(l.fixedWidth=0),void 0===l.fixedDepth&&(l.fixedDepth=0),void 0===l.fixedHeight&&(l.fixedHeight=0),void 0===l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_dropOnTopElevation&&(l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_dropOnTopElevation=0),void 0===l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency&&(l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency=null),void 0===l.furnitureListener&&(l.furnitureListener=null)}else{if(!(null!=t&&t instanceof Array||null===t)||"string"!=typeof i&&null!==i||void 0!==n||void 0!==o||void 0!==r)throw new Error("invalid overload");var c=(w=arguments)[0],p=w[1],g=(s=arguments[0][0]).getAngle(),m=HomeObject.createId("furnitureGroup");void 0===(l=e.call(this,m,c[0])||this).furniture&&(l.furniture=null),void 0===l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable&&(l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable=!1),void 0===l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable&&(l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable=!1),void 0===l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable&&(l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable=!1),void 0===l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow&&(l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow=!1),void 0===l.fixedWidth&&(l.fixedWidth=0),void 0===l.fixedDepth&&(l.fixedDepth=0),void 0===l.fixedHeight&&(l.fixedHeight=0),void 0===l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_dropOnTopElevation&&(l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_dropOnTopElevation=0),void 0===l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency&&(l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency=null),void 0===l.furnitureListener&&(l.furnitureListener=null),l.furniture=c.slice(0),l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable=!0,l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable=!0,l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable=!0;for(E=!0,C=!1,P=0;P<c.length;P++){E=(L=c[P]).isMovable()&&E,C=L.isVisible()||C}l.setName(p),l.setCatalogId(null),l.setDescription(null),l.setInformation(null),l.setCreator(null),l.setNameVisible(!1),l.setNameXOffset(0),l.setNameYOffset(0),l.setNameAngle(0),l.setNameStyle(null),e.prototype.setIcon.call(l,null),e.prototype.setPlanIcon.call(l,null),e.prototype.setModel.call(l,null),e.prototype.setMovable.call(l,E),e.prototype.setAngle.call(l,g),e.prototype.setModelMirrored.call(l,!1),l.setVisible(C),l.updateLocationAndSize(c,g,!0),l.addFurnitureListener(),void 0===l.furniture&&(l.furniture=null),void 0===l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable&&(l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable=!1),void 0===l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable&&(l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable=!1),void 0===l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable&&(l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable=!1),void 0===l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow&&(l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow=!1),void 0===l.fixedWidth&&(l.fixedWidth=0),void 0===l.fixedDepth&&(l.fixedDepth=0),void 0===l.fixedHeight&&(l.fixedHeight=0),void 0===l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_dropOnTopElevation&&(l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_dropOnTopElevation=0),void 0===l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency&&(l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency=null),void 0===l.furnitureListener&&(l.furnitureListener=null),void 0===l.furniture&&(l.furniture=null),void 0===l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable&&(l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable=!1),void 0===l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable&&(l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable=!1),void 0===l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable&&(l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable=!1),void 0===l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow&&(l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow=!1),void 0===l.fixedWidth&&(l.fixedWidth=0),void 0===l.fixedDepth&&(l.fixedDepth=0),void 0===l.fixedHeight&&(l.fixedHeight=0),void 0===l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_dropOnTopElevation&&(l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_dropOnTopElevation=0),void 0===l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency&&(l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency=null),void 0===l.furnitureListener&&(l.furnitureListener=null),void 0===l.furniture&&(l.furniture=null),void 0===l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable&&(l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable=!1),void 0===l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable&&(l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable=!1),void 0===l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable&&(l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable=!1),void 0===l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow&&(l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow=!1),void 0===l.fixedWidth&&(l.fixedWidth=0),void 0===l.fixedDepth&&(l.fixedDepth=0),void 0===l.fixedHeight&&(l.fixedHeight=0),void 0===l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_dropOnTopElevation&&(l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_dropOnTopElevation=0),void 0===l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency&&(l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency=null),void 0===l.furnitureListener&&(l.furnitureListener=null)}else{var f=(w=arguments)[0],v=w[1],_=w[2],S=w[3],y=HomeObject.createId("furnitureGroup");void 0===(l=e.call(this,y,f[0])||this).furniture&&(l.furniture=null),void 0===l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable&&(l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable=!1),void 0===l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable&&(l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable=!1),void 0===l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable&&(l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable=!1),void 0===l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow&&(l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow=!1),void 0===l.fixedWidth&&(l.fixedWidth=0),void 0===l.fixedDepth&&(l.fixedDepth=0),void 0===l.fixedHeight&&(l.fixedHeight=0),void 0===l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_dropOnTopElevation&&(l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_dropOnTopElevation=0),void 0===l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency&&(l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency=null),void 0===l.furnitureListener&&(l.furnitureListener=null),l.furniture=f.slice(0),l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable=!0,l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable=!0,l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable=!0;for(var E=!0,C=!1,P=0;P<f.length;P++){E=(L=f[P]).isMovable()&&E,C=L.isVisible()||C}l.setName(S),l.setCatalogId(null),l.setDescription(null),l.setInformation(null),l.setCreator(null),l.setNameVisible(!1),l.setNameXOffset(0),l.setNameYOffset(0),l.setNameAngle(0),l.setNameStyle(null),e.prototype.setIcon.call(l,null),e.prototype.setPlanIcon.call(l,null),e.prototype.setModel.call(l,null),e.prototype.setMovable.call(l,E),e.prototype.setAngle.call(l,v),e.prototype.setModelMirrored.call(l,_),l.setVisible(C),l.updateLocationAndSize(f,v,!0),l.addFurnitureListener(),void 0===l.furniture&&(l.furniture=null),void 0===l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable&&(l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable=!1),void 0===l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable&&(l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable=!1),void 0===l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable&&(l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable=!1),void 0===l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow&&(l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow=!1),void 0===l.fixedWidth&&(l.fixedWidth=0),void 0===l.fixedDepth&&(l.fixedDepth=0),void 0===l.fixedHeight&&(l.fixedHeight=0),void 0===l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_dropOnTopElevation&&(l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_dropOnTopElevation=0),void 0===l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency&&(l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency=null),void 0===l.furnitureListener&&(l.furnitureListener=null)}else{var w=arguments;void 0===(l=e.call(this,t,i[0])||this).furniture&&(l.furniture=null),void 0===l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable&&(l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable=!1),void 0===l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable&&(l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable=!1),void 0===l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable&&(l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable=!1),void 0===l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow&&(l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow=!1),void 0===l.fixedWidth&&(l.fixedWidth=0),void 0===l.fixedDepth&&(l.fixedDepth=0),void 0===l.fixedHeight&&(l.fixedHeight=0),void 0===l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_dropOnTopElevation&&(l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_dropOnTopElevation=0),void 0===l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency&&(l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency=null),void 0===l.furnitureListener&&(l.furnitureListener=null),l.furniture=i.slice(0),l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable=!0,l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable=!0,l.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable=!0;for(var E=!0,C=!1,P=0;P<i.length;P++){var L;E=(L=i[P]).isMovable()&&E,C=L.isVisible()||C}l.setName(r),l.setCatalogId(null),l.setDescription(null),l.setInformation(null),l.setCreator(null),l.setNameVisible(!1),l.setNameXOffset(0),l.setNameYOffset(0),l.setNameAngle(0),l.setNameStyle(null),e.prototype.setIcon.call(l,null),e.prototype.setPlanIcon.call(l,null),e.prototype.setModel.call(l,null),e.prototype.setMovable.call(l,E),e.prototype.setAngle.call(l,n),e.prototype.setModelMirrored.call(l,o),l.setVisible(C),l.updateLocationAndSize(i,n,!0),l.addFurnitureListener()}return l}return __extends(t,e),t.prototype.updateLocationAndSize=function(t,i,n){this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable=!0,this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable=!0,this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable=!0,this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow=!0,this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency=t[0].getCurrency();for(var o=0;o<t.length;o++){var r=t[o];this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable=r.isResizable()&&this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable,this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable=r.isDeformable()&&this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable,this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable=r.isTexturable()&&this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable,this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow=r.isDoorOrWindow()&&this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow,null!=this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency&&(null!=r.getCurrency()&&r.getCurrency()===this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency||(this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency=null))}var l=34028235e31;if(n){var a=null;for(o=0;o<t.length;o++){var s=(r=t[o]).getLevel();null!=s&&(null==a||s.getElevation()<a.getElevation())&&(a=s)}for(o=0;o<t.length;o++){null!=(r=t[o]).getLevel()?(l=Math.min(l,r.getGroundElevation()-a.getElevation()),r.setElevation(r.getGroundElevation()-a.getElevation()),r.setLevel(null)):l=Math.min(l,r.getElevation())}}else for(o=0;o<t.length;o++){r=t[o];l=Math.min(l,r.getElevation())}var h=0,u=-1;for(o=0;o<t.length;o++){r=t[o];h=Math.max(h,r.getElevation()+r.getHeightInPlan()),r.getDropOnTopElevation()>=0&&(u=Math.max(u,r.getElevation()+r.getHeightInPlan()*r.getDropOnTopElevation()))}h-=l,u-=l;var d=java.awt.geom.AffineTransform.getRotateInstance(-i),c=null,p=this.getFurnitureWithoutGroups(t);for(o=0;o<p.length;o++){r=p[o];var g=new java.awt.geom.GeneralPath,m=r.getPoints();g.moveTo(m[0][0],m[0][1]);for(var f=1;f<m.length;f++)g.lineTo(m[f][0],m[f][1]);g.closePath(),null==c?c=g.createTransformedShape(d).getBounds2D():c.add(g.createTransformedShape(d).getBounds2D())}var v=new java.awt.geom.Point2D.Float(c.getCenterX(),c.getCenterY());if(d.setToRotation(i),d.transform(v,v),this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable){var _=c.getWidth();e.prototype.setWidth.call(this,_),e.prototype.setWidthInPlan.call(this,_);var S=c.getHeight();e.prototype.setDepth.call(this,S),e.prototype.setDepthInPlan.call(this,S),e.prototype.setHeight.call(this,h),e.prototype.setHeightInPlan.call(this,h)}else this.fixedWidth=c.getWidth(),this.fixedDepth=c.getHeight(),this.fixedHeight=h;this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_dropOnTopElevation=u/h,e.prototype.setX.call(this,v.getX()),e.prototype.setY.call(this,v.getY()),e.prototype.setElevation.call(this,l)},t.prototype.addFurnitureListener=function(){this.furnitureListener=new t.LocationAndSizeChangeListener(this);for(var e=0;e<this.furniture.length;e++){this.furniture[e].addPropertyChangeListener(this.furnitureListener)}},t.prototype.getFurnitureWithoutGroups=function(e){for(var i,n,o=[],r=0;r<e.length;r++){var l=e[r];null!=l&&l instanceof t?(i=o,n=this.getFurnitureWithoutGroups(l.getFurniture()),i.push.apply(i,n)):o.push(l)}return o},t.prototype.getAllFurniture=function(){for(var e,i,n=this.furniture.slice(0),o=this.getFurniture(),r=0;r<o.length;r++){var l=o[r];null!=l&&l instanceof t&&(e=n,i=l.getAllFurniture(),e.push.apply(e,i))}return n},t.prototype.getFurniture=function(){return this.furniture.slice(0)},t.prototype.addPieceOfFurniture=function(e,t){this.furniture=this.furniture.slice(0),e.setLevel(this.getLevel()),this.furniture.splice(t,0,e),e.addPropertyChangeListener(this.furnitureListener),this.updateLocationAndSize(this.furniture,this.getAngle(),!1)},t.prototype.deletePieceOfFurniture=function(e){var t=this.furniture.indexOf(e);if(-1!==t){if(!(this.furniture.length>1))throw new IllegalStateException("Group can't be empty");e.setLevel(null),e.removePropertyChangeListener(this.furnitureListener),this.furniture=this.furniture.slice(0),this.furniture.splice(t,1)[0],this.updateLocationAndSize(this.furniture,this.getAngle(),!1)}},t.prototype.getCatalogId=function(){return e.prototype.getCatalogId.call(this)},t.prototype.getInformation=function(){return e.prototype.getInformation.call(this)},t.prototype.isMovable=function(){return e.prototype.isMovable.call(this)},t.prototype.setMovable=function(t){e.prototype.setMovable.call(this,t)},t.prototype.isDoorOrWindow=function(){return this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow},t.prototype.isResizable=function(){return this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable},t.prototype.isDeformable=function(){return this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable},t.prototype.isTexturable=function(){return this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable},t.prototype.isHorizontallyRotatable=function(){return!1},t.prototype.getWidth=function(){return this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable?e.prototype.getWidth.call(this):this.fixedWidth},t.prototype.getWidthInPlan=function(){return this.getWidth()},t.prototype.getDepth=function(){return this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable?e.prototype.getDepth.call(this):this.fixedDepth},t.prototype.getDepthInPlan=function(){return this.getDepth()},t.prototype.getHeight=function(){return this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable?e.prototype.getHeight.call(this):this.fixedHeight},t.prototype.getHeightInPlan=function(){return this.getHeight()},t.prototype.isHorizontallyRotated=function(){if(e.prototype.isHorizontallyRotated.call(this))return!0;for(var t=this.getFurniture(),i=0;i<t.length;i++){if(t[i].isHorizontallyRotated())return!0}return!1},t.prototype.getDropOnTopElevation=function(){return this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_dropOnTopElevation},t.prototype.getIcon=function(){return null},t.prototype.setIcon=function(e){throw new IllegalStateException("Can't set icon of a group")},t.prototype.getPlanIcon=function(){return null},t.prototype.setPlanIcon=function(e){throw new IllegalStateException("Can't set plan icon of a group")},t.prototype.getModel=function(){return null},t.prototype.setModel=function(e){throw new IllegalStateException("Can't set model of a group")},t.prototype.getModelSize=function(){return null},t.prototype.setModelSize=function(e){throw new IllegalStateException("Can't set model size of a group")},t.prototype.getModelRotation=function(){return PieceOfFurniture.IDENTITY_ROTATION_$LI$()},t.prototype.setModelRotation=function(e){throw new IllegalStateException("Can't set model rotation of a group")},t.prototype.isModelCenteredAtOrigin=function(){return!0},t.prototype.getModelFlags=function(){return 0},t.prototype.setModelFlags=function(e){throw new IllegalStateException("Can't set model flags attribute of a group")},t.prototype.isBackFaceShown=function(){return!1},t.prototype.setBackFaceShown=function(e){throw new IllegalStateException("Can't set back face shown attribute of a group")},t.prototype.getModelTransformations=function(){return null},t.prototype.setModelTransformations=function(e){if(this.isDeformable())for(var t=0;t<this.furniture.length;t++){this.furniture[t].setModelTransformations(e)}},t.prototype.getPitch=function(){return 0},t.prototype.getRoll=function(){return 0},t.prototype.getStaircaseCutOutShape=function(){return null},t.prototype.setStaircaseCutOutShape=function(e){throw new IllegalStateException("Can't set staircase cut out shape of a group")},t.prototype.getCreator=function(){return e.prototype.getCreator.call(this)},t.prototype.getPrice=function(){for(var t=null,i=0;i<this.furniture.length;i++){var n=this.furniture[i];null!=n.getPrice()&&(t=null==t?n.getPrice():t.plus(n.getPrice()))}return null==t?e.prototype.getPrice.call(this):t},t.prototype.setPrice=function(t){for(var i=0;i<this.furniture.length;i++){if(null!=this.furniture[i].getPrice())throw new UnsupportedOperationException("Can't change the price of a group containing pieces with a price")}e.prototype.setPrice.call(this,t)},t.prototype.getValueAddedTaxPercentage=function(){var e=this.furniture[0].getValueAddedTaxPercentage();if(null!=e)for(var t=0;t<this.furniture.length;t++){var i=this.furniture[t].getValueAddedTaxPercentage();if(null==i||!(null!=e?i.eq(e):i===e))return null}return e},t.prototype.getCurrency=function(){return this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency},t.prototype.getValueAddedTax=function(){for(var e=null,t=0;t<this.furniture.length;t++){var i=this.furniture[t].getValueAddedTax();null!=i&&(e=null==e?i:e.plus(i))}return e},t.prototype.getPriceValueAddedTaxIncluded=function(){for(var e=null,t=0;t<this.furniture.length;t++){var i=this.furniture[t];null!=i.getPrice()&&(e=null==e?i.getPriceValueAddedTaxIncluded():e.plus(i.getPriceValueAddedTaxIncluded()))}return e},t.prototype.getColor=function(){return null},t.prototype.setColor=function(e){if(this.isTexturable())for(var t=0;t<this.furniture.length;t++){this.furniture[t].setColor(e)}},t.prototype.getTexture=function(){return null},t.prototype.setTexture=function(e){if(this.isTexturable())for(var t=0;t<this.furniture.length;t++){this.furniture[t].setTexture(e)}},t.prototype.getModelMaterials=function(){return null},t.prototype.setModelMaterials=function(e){if(this.isTexturable())for(var t=0;t<this.furniture.length;t++){this.furniture[t].setModelMaterials(e)}},t.prototype.getShininess=function(){return null},t.prototype.setShininess=function(e){if(this.isTexturable())for(var t=0;t<this.furniture.length;t++){this.furniture[t].setShininess(e)}},t.prototype.setAngle=function(t){if(t!==this.getAngle()){for(var i=t-this.getAngle(),n=Math.cos(i),o=Math.sin(i),r=0;r<this.furniture.length;r++){var l=this.furniture[r];l.removePropertyChangeListener(this.furnitureListener),l.setAngle(l.getAngle()+i);var a=this.getX()+((l.getX()-this.getX())*n-(l.getY()-this.getY())*o),s=this.getY()+((l.getX()-this.getX())*o+(l.getY()-this.getY())*n);l.setX(a),l.setY(s),l.addPropertyChangeListener(this.furnitureListener)}e.prototype.setAngle.call(this,t)}},t.prototype.setX=function(t){if(t!==this.getX()){for(var i=t-this.getX(),n=0;n<this.furniture.length;n++){var o=this.furniture[n];o.removePropertyChangeListener(this.furnitureListener),o.setX(o.getX()+i),o.addPropertyChangeListener(this.furnitureListener)}e.prototype.setX.call(this,t)}},t.prototype.setY=function(t){if(t!==this.getY()){for(var i=t-this.getY(),n=0;n<this.furniture.length;n++){var o=this.furniture[n];o.removePropertyChangeListener(this.furnitureListener),o.setY(o.getY()+i),o.addPropertyChangeListener(this.furnitureListener)}e.prototype.setY.call(this,t)}},t.prototype.setWidth=function(t){if(t!==this.getWidth()){for(var i=t/this.getWidth(),n=this.getAngle(),o=0;o<this.furniture.length;o++){var r=this.furniture[o];r.removePropertyChangeListener(this.furnitureListener);var l=r.getAngle()-n,a=r.getWidth(),s=r.getDepth();r.setWidth(a+a*(i-1)*Math.abs(Math.cos(l))),r.setDepth(s+s*(i-1)*Math.abs(Math.sin(l)));var h=Math.cos(n),u=Math.sin(n),d=this.getX()+((r.getX()-this.getX())*h+(r.getY()-this.getY())*u),c=this.getY()+((r.getX()-this.getX())*-u+(r.getY()-this.getY())*h);d=this.getX()+(d-this.getX())*i,r.setX(this.getX()+((d-this.getX())*h-(c-this.getY())*u)),r.setY(this.getY()+((d-this.getX())*u+(c-this.getY())*h)),r.addPropertyChangeListener(this.furnitureListener)}e.prototype.setWidth.call(this,t)}},t.prototype.setDepth=function(t){if(t!==this.getDepth()){for(var i=t/this.getDepth(),n=this.getAngle(),o=0;o<this.furniture.length;o++){var r=this.furniture[o];r.removePropertyChangeListener(this.furnitureListener);var l=r.getAngle()-n,a=r.getWidth(),s=r.getDepth();r.setWidth(a+a*(i-1)*Math.abs(Math.sin(l))),r.setDepth(s+s*(i-1)*Math.abs(Math.cos(l)));var h=Math.cos(n),u=Math.sin(n),d=this.getX()+((r.getX()-this.getX())*h+(r.getY()-this.getY())*u),c=this.getY()+((r.getX()-this.getX())*-u+(r.getY()-this.getY())*h);c=this.getY()+(c-this.getY())*i,r.setX(this.getX()+((d-this.getX())*h-(c-this.getY())*u)),r.setY(this.getY()+((d-this.getX())*u+(c-this.getY())*h)),r.addPropertyChangeListener(this.furnitureListener)}e.prototype.setDepth.call(this,t)}},t.prototype.setHeight=function(t){if(t!==this.getHeight()){for(var i=t/this.getHeight(),n=0;n<this.furniture.length;n++){var o=this.furniture[n];o.removePropertyChangeListener(this.furnitureListener),o.setHeight(o.getHeight()*i),o.setElevation(this.getElevation()+(o.getElevation()-this.getElevation())*i),o.addPropertyChangeListener(this.furnitureListener)}e.prototype.setHeight.call(this,t)}},t.prototype.scale=function(t){for(var i=this.getAngle(),n=0;n<this.furniture.length;n++){var o=this.furniture[n];o.removePropertyChangeListener(this.furnitureListener),o.setWidth(o.getWidth()*t),o.setDepth(o.getDepth()*t),o.setHeight(o.getHeight()*t);var r=Math.cos(i),l=Math.sin(i),a=this.getX()+((o.getX()-this.getX())*r+(o.getY()-this.getY())*l),s=this.getY()+((o.getX()-this.getX())*-l+(o.getY()-this.getY())*r);a=this.getX()+(a-this.getX())*t,s=this.getY()+(s-this.getY())*t,o.setX(this.getX()+((a-this.getX())*r-(s-this.getY())*l)),o.setY(this.getY()+((a-this.getX())*l+(s-this.getY())*r)),o.setElevation(this.getElevation()+(o.getElevation()-this.getElevation())*t),o.addPropertyChangeListener(this.furnitureListener)}e.prototype.setWidth.call(this,this.getWidth()*t),e.prototype.setDepth.call(this,this.getDepth()*t),e.prototype.setHeight.call(this,this.getHeight()*t)},t.prototype.setElevation=function(t){if(t!==this.getElevation()){for(var i=t-this.getElevation(),n=0;n<this.furniture.length;n++){var o=this.furniture[n];o.removePropertyChangeListener(this.furnitureListener),o.setElevation(o.getElevation()+i),o.addPropertyChangeListener(this.furnitureListener)}e.prototype.setElevation.call(this,t)}},t.prototype.setModelMirrored=function(t){if(t!==this.isModelMirrored()){for(var i=this.getAngle(),n=0;n<this.furniture.length;n++){var o=this.furniture[n];o.removePropertyChangeListener(this.furnitureListener),o.setModelMirrored(!o.isModelMirrored()),o.setAngle(2*i-o.getAngle());var r=Math.cos(i),l=Math.sin(i),a=this.getX()+((o.getX()-this.getX())*r+(o.getY()-this.getY())*l),s=this.getY()+((o.getX()-this.getX())*-l+(o.getY()-this.getY())*r);a=this.getX()-(a-this.getX()),o.setX(this.getX()+((a-this.getX())*r-(s-this.getY())*l)),o.setY(this.getY()+((a-this.getX())*l+(s-this.getY())*r)),o.addPropertyChangeListener(this.furnitureListener)}e.prototype.setModelMirrored.call(this,t)}},t.prototype.setVisible=function(t){for(var i=0;i<this.furniture.length;i++){this.furniture[i].setVisible(t)}e.prototype.setVisible.call(this,t)},t.prototype.setLevel=function(t){for(var i=0;i<this.furniture.length;i++){this.furniture[i].setLevel(t)}e.prototype.setLevel.call(this,t)},t.prototype.intersectsRectangle=function(e,t,i,n){for(var o=0;o<this.furniture.length;o++){if(this.furniture[o].intersectsRectangle(e,t,i,n))return!0}return!1},t.prototype.containsPoint=function(e,t,i){for(var n=0;n<this.furniture.length;n++){if(this.furniture[n].containsPoint(e,t,i))return!0}return!1},t.prototype.duplicate=function(){for(var t=e.prototype.duplicate.call(this),i=[],n=0;n<t.furniture.length;n++){var o=t.furniture[n];o.removePropertyChangeListener(t.furnitureListener);var r=o.duplicate();i.push(r),r.addPropertyChangeListener(t.furnitureListener)}return t.furniture=i.slice(0),t},t.prototype.clone=function(){var t=this,i=function(i){if(null!=e.prototype.clone)return e.prototype.clone.call(t);var n=Object.create(i);for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o]);return n}(this);i.furniture=[];for(var n=0;n<this.furniture.length;n++){var o=this.furniture[n];i.furniture.push(function(e){if(null!=e.clone)return e.clone();var t=Object.create(e);for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t}(o))}return i.furniture=i.furniture.slice(0),i.addFurnitureListener(),i},t}(HomePieceOfFurniture);HomeFurnitureGroup.__class="com.eteks.sweethome3d.model.HomeFurnitureGroup",HomeFurnitureGroup.__interfaces=["com.eteks.sweethome3d.model.Selectable","com.eteks.sweethome3d.model.PieceOfFurniture","com.eteks.sweethome3d.model.Elevatable"],function(e){var t=function(){function e(e){void 0===this.group&&(this.group=null),this.group=e}return e.prototype.propertyChange=function(e){var t=this.group;null==t?e.getSource().removePropertyChangeListener(this):"X"!==e.getPropertyName()&&"Y"!==e.getPropertyName()&&"ELEVATION"!==e.getPropertyName()&&"ANGLE"!==e.getPropertyName()&&"WIDTH_IN_PLAN"!==e.getPropertyName()&&"DEPTH_IN_PLAN"!==e.getPropertyName()&&"HEIGHT_IN_PLAN"!==e.getPropertyName()||t.updateLocationAndSize(t.getFurniture(),t.getAngle(),!1)},e}();e.LocationAndSizeChangeListener=t,t.__class="com.eteks.sweethome3d.model.HomeFurnitureGroup.LocationAndSizeChangeListener"}(HomeFurnitureGroup||(HomeFurnitureGroup={})),HomeFurnitureGroup.__transients=["furnitureListener","shapeCache","propertyChangeSupport"];var ObserverCamera=function(e){function t(t,i,n,o,r,l,a){var s=this;if("string"!=typeof t&&null!==t||"number"!=typeof i&&null!==i||"number"!=typeof n&&null!==n||"number"!=typeof o&&null!==o||"number"!=typeof r&&null!==r||"number"!=typeof l&&null!==l||"number"!=typeof a&&null!==a){if("number"!=typeof t&&null!==t||"number"!=typeof i&&null!==i||"number"!=typeof n&&null!==n||"number"!=typeof o&&null!==o||"number"!=typeof r&&null!==r||"number"!=typeof l&&null!==l||void 0!==a)throw new Error("invalid overload");var h=(f=arguments)[0],u=f[1],d=f[2],c=f[3],p=f[4],g=f[5],m=HomeObject.createId("observerCamera");void 0===(s=e.call(this,m,h,u,d,c,p,g)||this).fixedSize&&(s.fixedSize=!1),void 0===s.shapeCache&&(s.shapeCache=null),void 0===s.rectangleShapeCache&&(s.rectangleShapeCache=null),s.planScale=1,void 0===s.fixedSize&&(s.fixedSize=!1),void 0===s.shapeCache&&(s.shapeCache=null),void 0===s.rectangleShapeCache&&(s.rectangleShapeCache=null),s.planScale=1}else{var f=arguments;void 0===(s=e.call(this,t,i,n,o,r,l,a)||this).fixedSize&&(s.fixedSize=!1),void 0===s.shapeCache&&(s.shapeCache=null),void 0===s.rectangleShapeCache&&(s.rectangleShapeCache=null),s.planScale=1}return s}return __extends(t,e),t.prototype.setFixedSize=function(e){if(this.fixedSize!==e){var t=this.getWidth(),i=this.getDepth(),n=this.getHeight();this.fixedSize=e,this.shapeCache=null,this.rectangleShapeCache=null,this.firePropertyChange("WIDTH",t,this.getWidth()),this.firePropertyChange("DEPTH",i,this.getDepth()),this.firePropertyChange("HEIGHT",n,this.getHeight())}},t.prototype.isFixedSize=function(){return this.fixedSize},t.prototype.setPlanScale=function(e){if(this.planScale!==e){var t=this.getWidth(),i=this.getDepth(),n=this.getHeight();this.planScale=e,this.shapeCache=null,this.rectangleShapeCache=null,this.firePropertyChange("WIDTH",t,this.getWidth()),this.firePropertyChange("DEPTH",i,this.getDepth()),this.firePropertyChange("HEIGHT",n,this.getHeight())}},t.prototype.getPlanScale=function(){return this.planScale},t.prototype.setYaw=function(t){e.prototype.setYaw.call(this,t),this.shapeCache=null,this.rectangleShapeCache=null},t.prototype.setX=function(t){e.prototype.setX.call(this,t),this.shapeCache=null,this.rectangleShapeCache=null},t.prototype.setY=function(t){e.prototype.setY.call(this,t),this.shapeCache=null,this.rectangleShapeCache=null},t.prototype.setZ=function(t){var i=this.getWidth(),n=this.getDepth(),o=this.getHeight();e.prototype.setZ.call(this,t),this.shapeCache=null,this.rectangleShapeCache=null,this.firePropertyChange("WIDTH",i,this.getWidth()),this.firePropertyChange("DEPTH",n,this.getDepth()),this.firePropertyChange("HEIGHT",o,this.getHeight())},t.prototype.getWidth=function(){if(this.fixedSize||this.planScale>1)return 46.6*this.planScale;var e=4*this.getZ()/14;return Math.min(Math.max(e,20),62.5)*this.planScale},t.prototype.getDepth=function(){if(this.fixedSize||this.planScale>1)return 18.6*this.planScale;var e=8*this.getZ()/70;return Math.min(Math.max(e,8),25)*this.planScale},t.prototype.getHeight=function(){return this.fixedSize||this.planScale>1?175*this.planScale:15*this.getZ()/14*this.planScale},t.prototype.getPoints=function(){for(var e,t=(e=function(t){if(0===t.length)return 0;for(var i=[],n=0;n<t[0];n++)i.push(e(t.slice(1)));return i})([4,2]),i=this.getRectangleShape().getPathIterator(null),n=0;n<t.length;n++)i.currentSegment(t[n]),i.next();return t},t.prototype.intersectsRectangle=function(e,t,i,n){var o=new java.awt.geom.Rectangle2D.Float(e,t,0,0);return o.add(i,n),this.getShape().intersects(o)},t.prototype.containsPoint=function(e,t,i){return 0===i?this.getShape().contains(e,t):this.getShape().intersects(e-i,t-i,2*i,2*i)},t.prototype.getShape=function(){if(null==this.shapeCache)if(this.planScale<=1){var e=new java.awt.geom.Ellipse2D.Float(this.getX()-this.getWidth()/2,this.getY()-this.getDepth()/2,this.getWidth(),this.getDepth()),t=java.awt.geom.AffineTransform.getRotateInstance(this.getYaw(),this.getX(),this.getY()),i=e.getPathIterator(t),n=new java.awt.geom.GeneralPath;n.append(i,!1),this.shapeCache=n}else this.shapeCache=this.getRectangleShape();return this.shapeCache},t.prototype.getRectangleShape=function(){if(null==this.rectangleShapeCache){var e=new java.awt.geom.Rectangle2D.Float(this.getX()-this.getWidth()/2,this.getY()-this.getDepth()/2,this.getWidth(),this.getDepth()),t=java.awt.geom.AffineTransform.getRotateInstance(this.getYaw(),this.getX(),this.getY()),i=e.getPathIterator(t),n=new java.awt.geom.GeneralPath;n.append(i,!1),this.rectangleShapeCache=n}return this.rectangleShapeCache},t.prototype.move=function(e,t){this.setX(this.getX()+e),this.setY(this.getY()+t)},t.prototype.clone=function(){var t=this;return function(i){if(null!=e.prototype.clone)return e.prototype.clone.call(t);var n=Object.create(i);for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o]);return n}(this)},t}(Camera);ObserverCamera.__class="com.eteks.sweethome3d.model.ObserverCamera",ObserverCamera.__interfaces=["com.eteks.sweethome3d.model.Selectable"],ObserverCamera.__transients=["planScale","shapeCache","rectangleShapeCache","lens","propertyChangeSupport"];var Home=function(){function e(t,i){if(!(null!=t&&t instanceof Array||null===t)||"number"!=typeof i&&null!==i)if((null!=t&&t instanceof Array||null===t)&&void 0===i){void 0===this.furniture&&(this.furniture=null),void 0===this.furnitureChangeSupport&&(this.furnitureChangeSupport=null),void 0===this.selectedItems&&(this.selectedItems=null),void 0===this.selectionListeners&&(this.selectionListeners=null),void 0===this.allLevelsSelection&&(this.allLevelsSelection=!1),void 0===this.levels&&(this.levels=null),void 0===this.selectedLevel&&(this.selectedLevel=null),void 0===this.levelsChangeSupport&&(this.levelsChangeSupport=null),void 0===this.walls&&(this.walls=null),void 0===this.wallsChangeSupport&&(this.wallsChangeSupport=null),void 0===this.rooms&&(this.rooms=null),void 0===this.roomsChangeSupport&&(this.roomsChangeSupport=null),void 0===this.polylines&&(this.polylines=null),void 0===this.polylinesChangeSupport&&(this.polylinesChangeSupport=null),void 0===this.dimensionLines&&(this.dimensionLines=null),void 0===this.dimensionLinesChangeSupport&&(this.dimensionLinesChangeSupport=null),void 0===this.labels&&(this.labels=null),void 0===this.labelsChangeSupport&&(this.labelsChangeSupport=null),void 0===this.camera&&(this.camera=null),void 0===this.name&&(this.name=null),void 0===this.wallHeight&&(this.wallHeight=0),void 0===this.modified&&(this.modified=!1),void 0===this.recovered&&(this.recovered=!1),void 0===this.repaired&&(this.repaired=!1),void 0===this.backgroundImage&&(this.backgroundImage=null),void 0===this.observerCamera&&(this.observerCamera=null),void 0===this.topCamera&&(this.topCamera=null),void 0===this.storedCameras&&(this.storedCameras=null),void 0===this.environment&&(this.environment=null),void 0===this.print&&(this.print=null),void 0===this.furnitureSortedPropertyName&&(this.furnitureSortedPropertyName=null),void 0===this.furnitureVisiblePropertyNames&&(this.furnitureVisiblePropertyNames=null),void 0===this.furnitureDescendingSorted&&(this.furnitureDescendingSorted=!1),void 0===this.visualProperties&&(this.visualProperties=null),void 0===this.properties&&(this.properties=null),void 0===this.propertyChangeSupport&&(this.propertyChangeSupport=null),void 0===this.version&&(this.version=0),void 0===this.basePlanLocked&&(this.basePlanLocked=!1),void 0===this.compass&&(this.compass=null),void 0===this.furnitureAdditionalProperties&&(this.furnitureAdditionalProperties=null),void 0===this.skyColor&&(this.skyColor=0),void 0===this.groundColor&&(this.groundColor=0),void 0===this.groundTexture&&(this.groundTexture=null),void 0===this.lightColor&&(this.lightColor=0),void 0===this.wallsAlpha&&(this.wallsAlpha=0),void 0===this.furnitureSortedProperty&&(this.furnitureSortedProperty=null),void 0===this.furnitureVisibleProperties&&(this.furnitureVisibleProperties=null),void 0===this.furnitureWithDoorsAndWindows&&(this.furnitureWithDoorsAndWindows=null),void 0===this.furnitureWithGroups&&(this.furnitureWithGroups=null),this.furniture=t.slice(0),this.walls=[],this.wallHeight=250,this.furnitureVisibleProperties=["NAME","WIDTH","DEPTH","HEIGHT","VISIBLE"].slice(0),this.furnitureVisiblePropertyNames=[];for(r=0;r<this.furnitureVisibleProperties.length;r++){l=this.furnitureVisibleProperties[r];this.furnitureVisiblePropertyNames.push(l)}this.init(!0),this.addModelListeners(),void 0===this.furniture&&(this.furniture=null),void 0===this.furnitureChangeSupport&&(this.furnitureChangeSupport=null),void 0===this.selectedItems&&(this.selectedItems=null),void 0===this.selectionListeners&&(this.selectionListeners=null),void 0===this.allLevelsSelection&&(this.allLevelsSelection=!1),void 0===this.levels&&(this.levels=null),void 0===this.selectedLevel&&(this.selectedLevel=null),void 0===this.levelsChangeSupport&&(this.levelsChangeSupport=null),void 0===this.walls&&(this.walls=null),void 0===this.wallsChangeSupport&&(this.wallsChangeSupport=null),void 0===this.rooms&&(this.rooms=null),void 0===this.roomsChangeSupport&&(this.roomsChangeSupport=null),void 0===this.polylines&&(this.polylines=null),void 0===this.polylinesChangeSupport&&(this.polylinesChangeSupport=null),void 0===this.dimensionLines&&(this.dimensionLines=null),void 0===this.dimensionLinesChangeSupport&&(this.dimensionLinesChangeSupport=null),void 0===this.labels&&(this.labels=null),void 0===this.labelsChangeSupport&&(this.labelsChangeSupport=null),void 0===this.camera&&(this.camera=null),void 0===this.name&&(this.name=null),void 0===this.wallHeight&&(this.wallHeight=0),void 0===this.modified&&(this.modified=!1),void 0===this.recovered&&(this.recovered=!1),void 0===this.repaired&&(this.repaired=!1),void 0===this.backgroundImage&&(this.backgroundImage=null),void 0===this.observerCamera&&(this.observerCamera=null),void 0===this.topCamera&&(this.topCamera=null),void 0===this.storedCameras&&(this.storedCameras=null),void 0===this.environment&&(this.environment=null),void 0===this.print&&(this.print=null),void 0===this.furnitureSortedPropertyName&&(this.furnitureSortedPropertyName=null),void 0===this.furnitureVisiblePropertyNames&&(this.furnitureVisiblePropertyNames=null),void 0===this.furnitureDescendingSorted&&(this.furnitureDescendingSorted=!1),void 0===this.visualProperties&&(this.visualProperties=null),void 0===this.properties&&(this.properties=null),void 0===this.propertyChangeSupport&&(this.propertyChangeSupport=null),void 0===this.version&&(this.version=0),void 0===this.basePlanLocked&&(this.basePlanLocked=!1),void 0===this.compass&&(this.compass=null),void 0===this.furnitureAdditionalProperties&&(this.furnitureAdditionalProperties=null),void 0===this.skyColor&&(this.skyColor=0),void 0===this.groundColor&&(this.groundColor=0),void 0===this.groundTexture&&(this.groundTexture=null),void 0===this.lightColor&&(this.lightColor=0),void 0===this.wallsAlpha&&(this.wallsAlpha=0),void 0===this.furnitureSortedProperty&&(this.furnitureSortedProperty=null),void 0===this.furnitureVisibleProperties&&(this.furnitureVisibleProperties=null),void 0===this.furnitureWithDoorsAndWindows&&(this.furnitureWithDoorsAndWindows=null),void 0===this.furnitureWithGroups&&(this.furnitureWithGroups=null)}else if((null!=t&&t instanceof e||null===t)&&void 0===i){var n=arguments[0];void 0===this.furniture&&(this.furniture=null),void 0===this.furnitureChangeSupport&&(this.furnitureChangeSupport=null),void 0===this.selectedItems&&(this.selectedItems=null),void 0===this.selectionListeners&&(this.selectionListeners=null),void 0===this.allLevelsSelection&&(this.allLevelsSelection=!1),void 0===this.levels&&(this.levels=null),void 0===this.selectedLevel&&(this.selectedLevel=null),void 0===this.levelsChangeSupport&&(this.levelsChangeSupport=null),void 0===this.walls&&(this.walls=null),void 0===this.wallsChangeSupport&&(this.wallsChangeSupport=null),void 0===this.rooms&&(this.rooms=null),void 0===this.roomsChangeSupport&&(this.roomsChangeSupport=null),void 0===this.polylines&&(this.polylines=null),void 0===this.polylinesChangeSupport&&(this.polylinesChangeSupport=null),void 0===this.dimensionLines&&(this.dimensionLines=null),void 0===this.dimensionLinesChangeSupport&&(this.dimensionLinesChangeSupport=null),void 0===this.labels&&(this.labels=null),void 0===this.labelsChangeSupport&&(this.labelsChangeSupport=null),void 0===this.camera&&(this.camera=null),void 0===this.name&&(this.name=null),void 0===this.wallHeight&&(this.wallHeight=0),void 0===this.modified&&(this.modified=!1),void 0===this.recovered&&(this.recovered=!1),void 0===this.repaired&&(this.repaired=!1),void 0===this.backgroundImage&&(this.backgroundImage=null),void 0===this.observerCamera&&(this.observerCamera=null),void 0===this.topCamera&&(this.topCamera=null),void 0===this.storedCameras&&(this.storedCameras=null),void 0===this.environment&&(this.environment=null),void 0===this.print&&(this.print=null),void 0===this.furnitureSortedPropertyName&&(this.furnitureSortedPropertyName=null),void 0===this.furnitureVisiblePropertyNames&&(this.furnitureVisiblePropertyNames=null),void 0===this.furnitureDescendingSorted&&(this.furnitureDescendingSorted=!1),void 0===this.visualProperties&&(this.visualProperties=null),void 0===this.properties&&(this.properties=null),void 0===this.propertyChangeSupport&&(this.propertyChangeSupport=null),void 0===this.version&&(this.version=0),void 0===this.basePlanLocked&&(this.basePlanLocked=!1),void 0===this.compass&&(this.compass=null),void 0===this.furnitureAdditionalProperties&&(this.furnitureAdditionalProperties=null),void 0===this.skyColor&&(this.skyColor=0),void 0===this.groundColor&&(this.groundColor=0),void 0===this.groundTexture&&(this.groundTexture=null),void 0===this.lightColor&&(this.lightColor=0),void 0===this.wallsAlpha&&(this.wallsAlpha=0),void 0===this.furnitureSortedProperty&&(this.furnitureSortedProperty=null),void 0===this.furnitureVisibleProperties&&(this.furnitureVisibleProperties=null),void 0===this.furnitureWithDoorsAndWindows&&(this.furnitureWithDoorsAndWindows=null),void 0===this.furnitureWithGroups&&(this.furnitureWithGroups=null),this.wallHeight=n.getWallHeight(),e.copyHomeData(n,this),e.initListenersSupport(this),this.addModelListeners()}else if("number"!=typeof t&&null!==t||void 0!==i){if(void 0!==t||void 0!==i)throw new Error("invalid overload");void 0===this.furniture&&(this.furniture=null),void 0===this.furnitureChangeSupport&&(this.furnitureChangeSupport=null),void 0===this.selectedItems&&(this.selectedItems=null),void 0===this.selectionListeners&&(this.selectionListeners=null),void 0===this.allLevelsSelection&&(this.allLevelsSelection=!1),void 0===this.levels&&(this.levels=null),void 0===this.selectedLevel&&(this.selectedLevel=null),void 0===this.levelsChangeSupport&&(this.levelsChangeSupport=null),void 0===this.walls&&(this.walls=null),void 0===this.wallsChangeSupport&&(this.wallsChangeSupport=null),void 0===this.rooms&&(this.rooms=null),void 0===this.roomsChangeSupport&&(this.roomsChangeSupport=null),void 0===this.polylines&&(this.polylines=null),void 0===this.polylinesChangeSupport&&(this.polylinesChangeSupport=null),void 0===this.dimensionLines&&(this.dimensionLines=null),void 0===this.dimensionLinesChangeSupport&&(this.dimensionLinesChangeSupport=null),void 0===this.labels&&(this.labels=null),void 0===this.labelsChangeSupport&&(this.labelsChangeSupport=null),void 0===this.camera&&(this.camera=null),void 0===this.name&&(this.name=null),void 0===this.wallHeight&&(this.wallHeight=0),void 0===this.modified&&(this.modified=!1),void 0===this.recovered&&(this.recovered=!1),void 0===this.repaired&&(this.repaired=!1),void 0===this.backgroundImage&&(this.backgroundImage=null),void 0===this.observerCamera&&(this.observerCamera=null),void 0===this.topCamera&&(this.topCamera=null),void 0===this.storedCameras&&(this.storedCameras=null),void 0===this.environment&&(this.environment=null),void 0===this.print&&(this.print=null),void 0===this.furnitureSortedPropertyName&&(this.furnitureSortedPropertyName=null),void 0===this.furnitureVisiblePropertyNames&&(this.furnitureVisiblePropertyNames=null),void 0===this.furnitureDescendingSorted&&(this.furnitureDescendingSorted=!1),void 0===this.visualProperties&&(this.visualProperties=null),void 0===this.properties&&(this.properties=null),void 0===this.propertyChangeSupport&&(this.propertyChangeSupport=null),void 0===this.version&&(this.version=0),void 0===this.basePlanLocked&&(this.basePlanLocked=!1),void 0===this.compass&&(this.compass=null),void 0===this.furnitureAdditionalProperties&&(this.furnitureAdditionalProperties=null),void 0===this.skyColor&&(this.skyColor=0),void 0===this.groundColor&&(this.groundColor=0),void 0===this.groundTexture&&(this.groundTexture=null),void 0===this.lightColor&&(this.lightColor=0),void 0===this.wallsAlpha&&(this.wallsAlpha=0),void 0===this.furnitureSortedProperty&&(this.furnitureSortedProperty=null),void 0===this.furnitureVisibleProperties&&(this.furnitureVisibleProperties=null),void 0===this.furnitureWithDoorsAndWindows&&(this.furnitureWithDoorsAndWindows=null),void 0===this.furnitureWithGroups&&(this.furnitureWithGroups=null),this.furniture=[].slice(0),this.walls=[],this.wallHeight=250,this.furnitureVisibleProperties=["NAME","WIDTH","DEPTH","HEIGHT","VISIBLE"].slice(0),this.furnitureVisiblePropertyNames=[];for(r=0;r<this.furnitureVisibleProperties.length;r++){l=this.furnitureVisibleProperties[r];this.furnitureVisiblePropertyNames.push(l)}this.init(!0),this.addModelListeners(),void 0===this.furniture&&(this.furniture=null),void 0===this.furnitureChangeSupport&&(this.furnitureChangeSupport=null),void 0===this.selectedItems&&(this.selectedItems=null),void 0===this.selectionListeners&&(this.selectionListeners=null),void 0===this.allLevelsSelection&&(this.allLevelsSelection=!1),void 0===this.levels&&(this.levels=null),void 0===this.selectedLevel&&(this.selectedLevel=null),void 0===this.levelsChangeSupport&&(this.levelsChangeSupport=null),void 0===this.walls&&(this.walls=null),void 0===this.wallsChangeSupport&&(this.wallsChangeSupport=null),void 0===this.rooms&&(this.rooms=null),void 0===this.roomsChangeSupport&&(this.roomsChangeSupport=null),void 0===this.polylines&&(this.polylines=null),void 0===this.polylinesChangeSupport&&(this.polylinesChangeSupport=null),void 0===this.dimensionLines&&(this.dimensionLines=null),void 0===this.dimensionLinesChangeSupport&&(this.dimensionLinesChangeSupport=null),void 0===this.labels&&(this.labels=null),void 0===this.labelsChangeSupport&&(this.labelsChangeSupport=null),void 0===this.camera&&(this.camera=null),void 0===this.name&&(this.name=null),void 0===this.wallHeight&&(this.wallHeight=0),void 0===this.modified&&(this.modified=!1),void 0===this.recovered&&(this.recovered=!1),void 0===this.repaired&&(this.repaired=!1),void 0===this.backgroundImage&&(this.backgroundImage=null),void 0===this.observerCamera&&(this.observerCamera=null),void 0===this.topCamera&&(this.topCamera=null),void 0===this.storedCameras&&(this.storedCameras=null),void 0===this.environment&&(this.environment=null),void 0===this.print&&(this.print=null),void 0===this.furnitureSortedPropertyName&&(this.furnitureSortedPropertyName=null),void 0===this.furnitureVisiblePropertyNames&&(this.furnitureVisiblePropertyNames=null),void 0===this.furnitureDescendingSorted&&(this.furnitureDescendingSorted=!1),void 0===this.visualProperties&&(this.visualProperties=null),void 0===this.properties&&(this.properties=null),void 0===this.propertyChangeSupport&&(this.propertyChangeSupport=null),void 0===this.version&&(this.version=0),void 0===this.basePlanLocked&&(this.basePlanLocked=!1),void 0===this.compass&&(this.compass=null),void 0===this.furnitureAdditionalProperties&&(this.furnitureAdditionalProperties=null),void 0===this.skyColor&&(this.skyColor=0),void 0===this.groundColor&&(this.groundColor=0),void 0===this.groundTexture&&(this.groundTexture=null),void 0===this.lightColor&&(this.lightColor=0),void 0===this.wallsAlpha&&(this.wallsAlpha=0),void 0===this.furnitureSortedProperty&&(this.furnitureSortedProperty=null),void 0===this.furnitureVisibleProperties&&(this.furnitureVisibleProperties=null),void 0===this.furnitureWithDoorsAndWindows&&(this.furnitureWithDoorsAndWindows=null),void 0===this.furnitureWithGroups&&(this.furnitureWithGroups=null),void 0===this.furniture&&(this.furniture=null),void 0===this.furnitureChangeSupport&&(this.furnitureChangeSupport=null),void 0===this.selectedItems&&(this.selectedItems=null),void 0===this.selectionListeners&&(this.selectionListeners=null),void 0===this.allLevelsSelection&&(this.allLevelsSelection=!1),void 0===this.levels&&(this.levels=null),void 0===this.selectedLevel&&(this.selectedLevel=null),void 0===this.levelsChangeSupport&&(this.levelsChangeSupport=null),void 0===this.walls&&(this.walls=null),void 0===this.wallsChangeSupport&&(this.wallsChangeSupport=null),void 0===this.rooms&&(this.rooms=null),void 0===this.roomsChangeSupport&&(this.roomsChangeSupport=null),void 0===this.polylines&&(this.polylines=null),void 0===this.polylinesChangeSupport&&(this.polylinesChangeSupport=null),void 0===this.dimensionLines&&(this.dimensionLines=null),void 0===this.dimensionLinesChangeSupport&&(this.dimensionLinesChangeSupport=null),void 0===this.labels&&(this.labels=null),void 0===this.labelsChangeSupport&&(this.labelsChangeSupport=null),void 0===this.camera&&(this.camera=null),void 0===this.name&&(this.name=null),void 0===this.wallHeight&&(this.wallHeight=0),void 0===this.modified&&(this.modified=!1),void 0===this.recovered&&(this.recovered=!1),void 0===this.repaired&&(this.repaired=!1),void 0===this.backgroundImage&&(this.backgroundImage=null),void 0===this.observerCamera&&(this.observerCamera=null),void 0===this.topCamera&&(this.topCamera=null),void 0===this.storedCameras&&(this.storedCameras=null),void 0===this.environment&&(this.environment=null),void 0===this.print&&(this.print=null),void 0===this.furnitureSortedPropertyName&&(this.furnitureSortedPropertyName=null),void 0===this.furnitureVisiblePropertyNames&&(this.furnitureVisiblePropertyNames=null),void 0===this.furnitureDescendingSorted&&(this.furnitureDescendingSorted=!1),void 0===this.visualProperties&&(this.visualProperties=null),void 0===this.properties&&(this.properties=null),void 0===this.propertyChangeSupport&&(this.propertyChangeSupport=null),void 0===this.version&&(this.version=0),void 0===this.basePlanLocked&&(this.basePlanLocked=!1),void 0===this.compass&&(this.compass=null),void 0===this.furnitureAdditionalProperties&&(this.furnitureAdditionalProperties=null),void 0===this.skyColor&&(this.skyColor=0),void 0===this.groundColor&&(this.groundColor=0),void 0===this.groundTexture&&(this.groundTexture=null),void 0===this.lightColor&&(this.lightColor=0),void 0===this.wallsAlpha&&(this.wallsAlpha=0),void 0===this.furnitureSortedProperty&&(this.furnitureSortedProperty=null),void 0===this.furnitureVisibleProperties&&(this.furnitureVisibleProperties=null),void 0===this.furnitureWithDoorsAndWindows&&(this.furnitureWithDoorsAndWindows=null),void 0===this.furnitureWithGroups&&(this.furnitureWithGroups=null)}else{var o=arguments[0];void 0===this.furniture&&(this.furniture=null),void 0===this.furnitureChangeSupport&&(this.furnitureChangeSupport=null),void 0===this.selectedItems&&(this.selectedItems=null),void 0===this.selectionListeners&&(this.selectionListeners=null),void 0===this.allLevelsSelection&&(this.allLevelsSelection=!1),void 0===this.levels&&(this.levels=null),void 0===this.selectedLevel&&(this.selectedLevel=null),void 0===this.levelsChangeSupport&&(this.levelsChangeSupport=null),void 0===this.walls&&(this.walls=null),void 0===this.wallsChangeSupport&&(this.wallsChangeSupport=null),void 0===this.rooms&&(this.rooms=null),void 0===this.roomsChangeSupport&&(this.roomsChangeSupport=null),void 0===this.polylines&&(this.polylines=null),void 0===this.polylinesChangeSupport&&(this.polylinesChangeSupport=null),void 0===this.dimensionLines&&(this.dimensionLines=null),void 0===this.dimensionLinesChangeSupport&&(this.dimensionLinesChangeSupport=null),void 0===this.labels&&(this.labels=null),void 0===this.labelsChangeSupport&&(this.labelsChangeSupport=null),void 0===this.camera&&(this.camera=null),void 0===this.name&&(this.name=null),void 0===this.wallHeight&&(this.wallHeight=0),void 0===this.modified&&(this.modified=!1),void 0===this.recovered&&(this.recovered=!1),void 0===this.repaired&&(this.repaired=!1),void 0===this.backgroundImage&&(this.backgroundImage=null),void 0===this.observerCamera&&(this.observerCamera=null),void 0===this.topCamera&&(this.topCamera=null),void 0===this.storedCameras&&(this.storedCameras=null),void 0===this.environment&&(this.environment=null),void 0===this.print&&(this.print=null),void 0===this.furnitureSortedPropertyName&&(this.furnitureSortedPropertyName=null),void 0===this.furnitureVisiblePropertyNames&&(this.furnitureVisiblePropertyNames=null),void 0===this.furnitureDescendingSorted&&(this.furnitureDescendingSorted=!1),void 0===this.visualProperties&&(this.visualProperties=null),void 0===this.properties&&(this.properties=null),void 0===this.propertyChangeSupport&&(this.propertyChangeSupport=null),void 0===this.version&&(this.version=0),void 0===this.basePlanLocked&&(this.basePlanLocked=!1),void 0===this.compass&&(this.compass=null),void 0===this.furnitureAdditionalProperties&&(this.furnitureAdditionalProperties=null),void 0===this.skyColor&&(this.skyColor=0),void 0===this.groundColor&&(this.groundColor=0),void 0===this.groundTexture&&(this.groundTexture=null),void 0===this.lightColor&&(this.lightColor=0),void 0===this.wallsAlpha&&(this.wallsAlpha=0),void 0===this.furnitureSortedProperty&&(this.furnitureSortedProperty=null),void 0===this.furnitureVisibleProperties&&(this.furnitureVisibleProperties=null),void 0===this.furnitureWithDoorsAndWindows&&(this.furnitureWithDoorsAndWindows=null),void 0===this.furnitureWithGroups&&(this.furnitureWithGroups=null),this.furniture=[].slice(0),this.walls=[],this.wallHeight=o,this.furnitureVisibleProperties=["NAME","WIDTH","DEPTH","HEIGHT","VISIBLE"].slice(0),this.furnitureVisiblePropertyNames=[];for(var r=0;r<this.furnitureVisibleProperties.length;r++){var l=this.furnitureVisibleProperties[r];this.furnitureVisiblePropertyNames.push(l)}this.init(!0),this.addModelListeners(),void 0===this.furniture&&(this.furniture=null),void 0===this.furnitureChangeSupport&&(this.furnitureChangeSupport=null),void 0===this.selectedItems&&(this.selectedItems=null),void 0===this.selectionListeners&&(this.selectionListeners=null),void 0===this.allLevelsSelection&&(this.allLevelsSelection=!1),void 0===this.levels&&(this.levels=null),void 0===this.selectedLevel&&(this.selectedLevel=null),void 0===this.levelsChangeSupport&&(this.levelsChangeSupport=null),void 0===this.walls&&(this.walls=null),void 0===this.wallsChangeSupport&&(this.wallsChangeSupport=null),void 0===this.rooms&&(this.rooms=null),void 0===this.roomsChangeSupport&&(this.roomsChangeSupport=null),void 0===this.polylines&&(this.polylines=null),void 0===this.polylinesChangeSupport&&(this.polylinesChangeSupport=null),void 0===this.dimensionLines&&(this.dimensionLines=null),void 0===this.dimensionLinesChangeSupport&&(this.dimensionLinesChangeSupport=null),void 0===this.labels&&(this.labels=null),void 0===this.labelsChangeSupport&&(this.labelsChangeSupport=null),void 0===this.camera&&(this.camera=null),void 0===this.name&&(this.name=null),void 0===this.wallHeight&&(this.wallHeight=0),void 0===this.modified&&(this.modified=!1),void 0===this.recovered&&(this.recovered=!1),void 0===this.repaired&&(this.repaired=!1),void 0===this.backgroundImage&&(this.backgroundImage=null),void 0===this.observerCamera&&(this.observerCamera=null),void 0===this.topCamera&&(this.topCamera=null),void 0===this.storedCameras&&(this.storedCameras=null),void 0===this.environment&&(this.environment=null),void 0===this.print&&(this.print=null),void 0===this.furnitureSortedPropertyName&&(this.furnitureSortedPropertyName=null),void 0===this.furnitureVisiblePropertyNames&&(this.furnitureVisiblePropertyNames=null),void 0===this.furnitureDescendingSorted&&(this.furnitureDescendingSorted=!1),void 0===this.visualProperties&&(this.visualProperties=null),void 0===this.properties&&(this.properties=null),void 0===this.propertyChangeSupport&&(this.propertyChangeSupport=null),void 0===this.version&&(this.version=0),void 0===this.basePlanLocked&&(this.basePlanLocked=!1),void 0===this.compass&&(this.compass=null),void 0===this.furnitureAdditionalProperties&&(this.furnitureAdditionalProperties=null),void 0===this.skyColor&&(this.skyColor=0),void 0===this.groundColor&&(this.groundColor=0),void 0===this.groundTexture&&(this.groundTexture=null),void 0===this.lightColor&&(this.lightColor=0),void 0===this.wallsAlpha&&(this.wallsAlpha=0),void 0===this.furnitureSortedProperty&&(this.furnitureSortedProperty=null),void 0===this.furnitureVisibleProperties&&(this.furnitureVisibleProperties=null),void 0===this.furnitureWithDoorsAndWindows&&(this.furnitureWithDoorsAndWindows=null),void 0===this.furnitureWithGroups&&(this.furnitureWithGroups=null)}else{void 0===this.furniture&&(this.furniture=null),void 0===this.furnitureChangeSupport&&(this.furnitureChangeSupport=null),void 0===this.selectedItems&&(this.selectedItems=null),void 0===this.selectionListeners&&(this.selectionListeners=null),void 0===this.allLevelsSelection&&(this.allLevelsSelection=!1),void 0===this.levels&&(this.levels=null),void 0===this.selectedLevel&&(this.selectedLevel=null),void 0===this.levelsChangeSupport&&(this.levelsChangeSupport=null),void 0===this.walls&&(this.walls=null),void 0===this.wallsChangeSupport&&(this.wallsChangeSupport=null),void 0===this.rooms&&(this.rooms=null),void 0===this.roomsChangeSupport&&(this.roomsChangeSupport=null),void 0===this.polylines&&(this.polylines=null),void 0===this.polylinesChangeSupport&&(this.polylinesChangeSupport=null),void 0===this.dimensionLines&&(this.dimensionLines=null),void 0===this.dimensionLinesChangeSupport&&(this.dimensionLinesChangeSupport=null),void 0===this.labels&&(this.labels=null),void 0===this.labelsChangeSupport&&(this.labelsChangeSupport=null),void 0===this.camera&&(this.camera=null),void 0===this.name&&(this.name=null),void 0===this.wallHeight&&(this.wallHeight=0),void 0===this.modified&&(this.modified=!1),void 0===this.recovered&&(this.recovered=!1),void 0===this.repaired&&(this.repaired=!1),void 0===this.backgroundImage&&(this.backgroundImage=null),void 0===this.observerCamera&&(this.observerCamera=null),void 0===this.topCamera&&(this.topCamera=null),void 0===this.storedCameras&&(this.storedCameras=null),void 0===this.environment&&(this.environment=null),void 0===this.print&&(this.print=null),void 0===this.furnitureSortedPropertyName&&(this.furnitureSortedPropertyName=null),void 0===this.furnitureVisiblePropertyNames&&(this.furnitureVisiblePropertyNames=null),void 0===this.furnitureDescendingSorted&&(this.furnitureDescendingSorted=!1),void 0===this.visualProperties&&(this.visualProperties=null),void 0===this.properties&&(this.properties=null),void 0===this.propertyChangeSupport&&(this.propertyChangeSupport=null),void 0===this.version&&(this.version=0),void 0===this.basePlanLocked&&(this.basePlanLocked=!1),void 0===this.compass&&(this.compass=null),void 0===this.furnitureAdditionalProperties&&(this.furnitureAdditionalProperties=null),void 0===this.skyColor&&(this.skyColor=0),void 0===this.groundColor&&(this.groundColor=0),void 0===this.groundTexture&&(this.groundTexture=null),void 0===this.lightColor&&(this.lightColor=0),void 0===this.wallsAlpha&&(this.wallsAlpha=0),void 0===this.furnitureSortedProperty&&(this.furnitureSortedProperty=null),void 0===this.furnitureVisibleProperties&&(this.furnitureVisibleProperties=null),void 0===this.furnitureWithDoorsAndWindows&&(this.furnitureWithDoorsAndWindows=null),void 0===this.furnitureWithGroups&&(this.furnitureWithGroups=null),this.furniture=t.slice(0),this.walls=[],this.wallHeight=i,this.furnitureVisibleProperties=["NAME","WIDTH","DEPTH","HEIGHT","VISIBLE"].slice(0),this.furnitureVisiblePropertyNames=[];for(var r=0;r<this.furnitureVisibleProperties.length;r++){var l=this.furnitureVisibleProperties[r];this.furnitureVisiblePropertyNames.push(l)}this.init(!0),this.addModelListeners()}}return e.LEVEL_ELEVATION_COMPARATOR_$LI$=function(){return null==e.LEVEL_ELEVATION_COMPARATOR&&(e.LEVEL_ELEVATION_COMPARATOR=function(e,t){var i=e.getElevation()-t.getElevation();return 0!==i?i:e.getElevationIndex()-t.getElevationIndex()}),e.LEVEL_ELEVATION_COMPARATOR},e.prototype.moveVisualProperty=function(e){var t,i,n=this;if(this.visualProperties.hasOwnProperty(e)){var o=void 0===(t=this.visualProperties)[i=e]?null:t[i];this.properties[e]=null!=o?String(o).toString():null,function(t){var i=n.visualProperties[e];delete n.visualProperties[e]}(this.visualProperties)}},e.prototype.init=function(t){this.selectedItems=[],e.initListenersSupport(this),null==this.furnitureVisibleProperties&&(this.furnitureVisibleProperties=["NAME","WIDTH","DEPTH","HEIGHT","COLOR","MOVABLE","DOOR_OR_WINDOW","VISIBLE"].slice(0)),this.topCamera=new Camera(e.HOME_TOP_CAMERA_ID,50,1050,1010,Math.PI,Math.PI/4,63*Math.PI/180),this.observerCamera=new ObserverCamera(e.HOME_OBSERVER_CAMERA_ID,50,50,170,7*Math.PI/4,Math.PI/16,63*Math.PI/180),this.storedCameras=[],this.environment=new HomeEnvironment(e.HOME_ENVIRONMENT_ID),this.rooms=[],this.polylines=[],this.dimensionLines=[],this.labels=[],this.compass=new Compass(e.HOME_COMPASS_ID,-100,50,100),this.levels=[],this.compass.setVisible(t),this.visualProperties={},this.properties={},this.furnitureAdditionalProperties=[],this.version=e.CURRENT_VERSION},e.initListenersSupport=function(e){e.furnitureChangeSupport=new CollectionChangeSupport(e),e.selectionListeners=[],e.levelsChangeSupport=new CollectionChangeSupport(e),e.wallsChangeSupport=new CollectionChangeSupport(e),e.roomsChangeSupport=new CollectionChangeSupport(e),e.polylinesChangeSupport=new CollectionChangeSupport(e),e.dimensionLinesChangeSupport=new CollectionChangeSupport(e),e.labelsChangeSupport=new CollectionChangeSupport(e),e.propertyChangeSupport=new PropertyChangeSupport(e)},e.prototype.addModelListeners=function(){for(var t=new e.Home$0(this),i=0;i<this.levels.length;i++){this.levels[i].addPropertyChangeListener(t)}this.addLevelsListener((function(e){switch(e.getType()){case CollectionEvent.Type.ADD:e.getItem().addPropertyChangeListener(t);break;case CollectionEvent.Type.DELETE:e.getItem().removePropertyChangeListener(t)}}))},e.prototype.isFurnitureSortedPropertyBackwardCompatible=function(e){if(null==e)return!1;switch(e){case"NAME":case"WIDTH":case"DEPTH":case"HEIGHT":case"MOVABLE":case"DOOR_OR_WINDOW":case"COLOR":case"VISIBLE":case"X":case"Y":case"ELEVATION":case"ANGLE":return!0;default:return!1}},e.prototype.getGroupFurniture=function(e){for(var t,i,n=[],o=e.getFurniture(),r=0;r<o.length;r++){var l=o[r];null!=l&&l instanceof HomeFurnitureGroup?(t=n,i=this.getGroupFurniture(l),t.push.apply(t,i)):n.push(l)}return n},e.prototype.addLevelsListener=function(e){var t;this.levelsChangeSupport.addCollectionListener(null==(t=e)||"function"==typeof t?t:function(e){return(t.collectionChanged?t.collectionChanged:t).call(t,e)})},e.prototype.removeLevelsListener=function(e){var t;this.levelsChangeSupport.removeCollectionListener(null==(t=e)||"function"==typeof t?t:function(e){return(t.collectionChanged?t.collectionChanged:t).call(t,e)})},e.prototype.getLevels=function(){return this.levels.slice(0)},e.prototype.addLevel=function(t){if(t.getElevationIndex()<0){for(var i=0,n=0;n<this.levels.length;n++){var o=this.levels[n];if(o.getElevation()===t.getElevation())i=o.getElevationIndex()+1;else if(o.getElevation()>t.getElevation())break}t.setElevationIndex(i)}this.levels=this.levels.slice(0);var r,l=function(e,t,i){var n=i;"function"!=typeof i&&(n=function(e,t){return i.compare(e,t)});for(var o=0,r=e.length-1;o<=r;){var l=o+r>>>1,a=n(e[l],t);if(a<0)o=l+1;else{if(!(a>0))return l;r=l-1}}return-(o+1)}(this.levels,t,e.LEVEL_ELEVATION_COMPARATOR_$LI$());r=l>=0?l:-(l+1),this.levels.splice(r,0,t),this.levelsChangeSupport.fireCollectionChanged(t,r,CollectionEvent.Type.ADD)},e.prototype.deleteLevel=function(e){var t,i,n=this.levels.indexOf(e);if(-1!==n){for(var o=0;o<this.furniture.length;o++){var r=this.furniture[o];r.getLevel()===e&&this.deletePieceOfFurniture(r)}for(o=0;o<this.rooms.length;o++){var l=this.rooms[o];l.getLevel()===e&&this.deleteRoom(l)}for(o=0;o<this.walls.length;o++){var a=this.walls[o];a.getLevel()===e&&this.deleteWall(a)}for(o=0;o<this.polylines.length;o++){var s=this.polylines[o];s.getLevel()===e&&this.deletePolyline(s)}for(o=0;o<this.dimensionLines.length;o++){var h=this.dimensionLines[o];h.getLevel()===e&&this.deleteDimensionLine(h)}for(o=0;o<this.labels.length;o++){var u=this.labels[o];u.getLevel()===e&&this.deleteLabel(u)}if(this.selectedLevel===e&&(1===this.levels.length?(this.setSelectedLevel(null),this.setAllLevelsSelection(!1)):this.setSelectedLevel(this.levels[n>=1?n-1:n+1])),null!=this.print&&null!=this.print.getPrintedLevels()){var d=this.print.getPrintedLevels().slice(0);(i=(t=d).indexOf(e))>=0&&(t.splice(i,1),1)&&(this.print=new HomePrint(this.print.getPaperOrientation(),this.print.getPaperWidth(),this.print.getPaperHeight(),this.print.getPaperTopMargin(),this.print.getPaperLeftMargin(),this.print.getPaperBottomMargin(),this.print.getPaperRightMargin(),this.print.isFurniturePrinted(),this.print.isPlanPrinted(),d,this.print.isView3DPrinted(),this.print.getPlanScale(),this.print.getHeaderFormat(),this.print.getFooterFormat()))}this.levels=this.levels.slice(0),this.levels.splice(n,1)[0],this.levelsChangeSupport.fireCollectionChanged(e,n,CollectionEvent.Type.DELETE)}},e.prototype.getSelectedLevel=function(){return this.selectedLevel},e.prototype.setSelectedLevel=function(e){if(e!==this.selectedLevel){var t=this.selectedLevel;this.selectedLevel=e,this.propertyChangeSupport.firePropertyChange("SELECTED_LEVEL",t,e)}},e.prototype.isAllLevelsSelection=function(){return this.allLevelsSelection},e.prototype.setAllLevelsSelection=function(e){e!==this.allLevelsSelection&&(this.allLevelsSelection=e,this.propertyChangeSupport.firePropertyChange("ALL_LEVELS_SELECTION",!e,e))},e.prototype.addFurnitureListener=function(e){var t;this.furnitureChangeSupport.addCollectionListener(null==(t=e)||"function"==typeof t?t:function(e){return(t.collectionChanged?t.collectionChanged:t).call(t,e)})},e.prototype.removeFurnitureListener=function(e){var t;this.furnitureChangeSupport.removeCollectionListener(null==(t=e)||"function"==typeof t?t:function(e){return(t.collectionChanged?t.collectionChanged:t).call(t,e)})},e.prototype.getFurniture=function(){return this.furniture.slice(0)},e.prototype.addPieceOfFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture=function(e){this.addPieceOfFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture$int(e,this.furniture.length)},e.prototype.addPieceOfFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture$int=function(e,t){this.furniture=this.furniture.slice(0),e.setLevel(this.selectedLevel),this.furniture.splice(t,0,e),this.furnitureChangeSupport.fireCollectionChanged(e,t,CollectionEvent.Type.ADD)},e.prototype.addPieceOfFurniture=function(e,t){if(!(null!=e&&e instanceof HomePieceOfFurniture||null===e)||"number"!=typeof t&&null!==t){if((null!=e&&e instanceof HomePieceOfFurniture||null===e)&&void 0===t)return this.addPieceOfFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture(e);throw new Error("invalid overload")}return this.addPieceOfFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture$int(e,t)},e.prototype.addPieceOfFurnitureToGroup=function(e,t,i){e.setLevel(this.selectedLevel),t.addPieceOfFurniture(e,i),this.furnitureChangeSupport.fireCollectionChanged(e,CollectionEvent.Type.ADD)},e.prototype.deletePieceOfFurniture=function(e){if(this.deselectItem(e),null!=e&&e instanceof HomeFurnitureGroup)for(var t=e.getAllFurniture(),i=0;i<t.length;i++){var n=t[i];this.deselectItem(n)}var o=this.furniture.indexOf(e),r=-1===o?this.getPieceOfFurnitureGroup(e,null,this.furniture):null;-1===o&&null==r||(e.setLevel(null),this.furniture=this.furniture.slice(0),null!=r?(r.deletePieceOfFurniture(e),this.furnitureChangeSupport.fireCollectionChanged(e,CollectionEvent.Type.DELETE)):(this.furniture.splice(o,1)[0],this.furnitureChangeSupport.fireCollectionChanged(e,o,CollectionEvent.Type.DELETE)))},e.prototype.getPieceOfFurnitureGroup=function(e,t,i){for(var n=0;n<i.length;n++){var o=i[n];if(a=e,(l=o)&&l.equals?l.equals(a):l===a)return t;if(null!=o&&o instanceof HomeFurnitureGroup){var r=this.getPieceOfFurnitureGroup(e,o,o.getFurniture());if(null!=r)return r}}var l,a;return null},e.prototype.addSelectionListener=function(e){this.selectionListeners.push(e)},e.prototype.removeSelectionListener=function(e){var t,i;t=this.selectionListeners,(i=t.indexOf(e))>=0&&t.splice(i,1)},e.prototype.getSelectedItems=function(){return this.selectedItems.slice(0)},e.prototype.isItemSelected=function(e){return this.selectedItems.indexOf(e)>=0},e.prototype.setSelectedItems=function(e){var t=this.selectedItems.slice(0);if(this.selectedItems=e.slice(0),0!=this.selectionListeners.length)for(var i=new SelectionEvent(this,t,this.getSelectedItems()),n=this.selectionListeners.slice(0),o=0;o<n.length;o++){n[o].selectionChanged(i)}},e.prototype.deselectItem=function(e){var t=this.selectedItems.indexOf(e);if(-1!==t){var i=this.getSelectedItems().slice(0);i.splice(t,1)[0],this.setSelectedItems(i)}},e.prototype.addRoomsListener=function(e){var t;this.roomsChangeSupport.addCollectionListener(null==(t=e)||"function"==typeof t?t:function(e){return(t.collectionChanged?t.collectionChanged:t).call(t,e)})},e.prototype.removeRoomsListener=function(e){var t;this.roomsChangeSupport.removeCollectionListener(null==(t=e)||"function"==typeof t?t:function(e){return(t.collectionChanged?t.collectionChanged:t).call(t,e)})},e.prototype.getRooms=function(){return this.rooms.slice(0)},e.prototype.addRoom$com_eteks_sweethome3d_model_Room=function(e){this.addRoom$com_eteks_sweethome3d_model_Room$int(e,this.rooms.length)},e.prototype.addRoom$com_eteks_sweethome3d_model_Room$int=function(e,t){this.rooms=this.rooms.slice(0),this.rooms.splice(t,0,e),e.setLevel(this.selectedLevel),this.roomsChangeSupport.fireCollectionChanged(e,t,CollectionEvent.Type.ADD)},e.prototype.addRoom=function(e,t){if(!(null!=e&&e instanceof Room||null===e)||"number"!=typeof t&&null!==t){if((null!=e&&e instanceof Room||null===e)&&void 0===t)return this.addRoom$com_eteks_sweethome3d_model_Room(e);throw new Error("invalid overload")}return this.addRoom$com_eteks_sweethome3d_model_Room$int(e,t)},e.prototype.deleteRoom=function(e){this.deselectItem(e);var t=this.rooms.indexOf(e);-1!==t&&(e.setLevel(null),this.rooms=this.rooms.slice(0),this.rooms.splice(t,1)[0],this.roomsChangeSupport.fireCollectionChanged(e,t,CollectionEvent.Type.DELETE))},e.prototype.addWallsListener=function(e){var t;this.wallsChangeSupport.addCollectionListener(null==(t=e)||"function"==typeof t?t:function(e){return(t.collectionChanged?t.collectionChanged:t).call(t,e)})},e.prototype.removeWallsListener=function(e){var t;this.wallsChangeSupport.removeCollectionListener(null==(t=e)||"function"==typeof t?t:function(e){return(t.collectionChanged?t.collectionChanged:t).call(t,e)})},e.prototype.getWalls=function(){return this.walls.slice(0)},e.prototype.addWall=function(e){this.walls=this.walls.slice(0),this.walls.push(e),e.setLevel(this.selectedLevel),this.wallsChangeSupport.fireCollectionChanged(e,CollectionEvent.Type.ADD)},e.prototype.deleteWall=function(e){this.deselectItem(e);for(var t,i,n=this.getWalls(),o=0;o<n.length;o++){var r=n[o];t=e,i=r.getWallAtStart(),(t&&t.equals?t.equals(i):t===i)?r.setWallAtStart(null):function(e,t){return e&&e.equals?e.equals(t):e===t}(e,r.getWallAtEnd())&&r.setWallAtEnd(null)}var l=this.walls.indexOf(e);-1!==l&&(e.setLevel(null),this.walls=this.walls.slice(0),this.walls.splice(l,1)[0],this.wallsChangeSupport.fireCollectionChanged(e,CollectionEvent.Type.DELETE))},e.prototype.addPolylinesListener=function(e){var t;this.polylinesChangeSupport.addCollectionListener(null==(t=e)||"function"==typeof t?t:function(e){return(t.collectionChanged?t.collectionChanged:t).call(t,e)})},e.prototype.removePolylinesListener=function(e){var t;this.polylinesChangeSupport.removeCollectionListener(null==(t=e)||"function"==typeof t?t:function(e){return(t.collectionChanged?t.collectionChanged:t).call(t,e)})},e.prototype.getPolylines=function(){return this.polylines.slice(0)},e.prototype.addPolyline$com_eteks_sweethome3d_model_Polyline=function(e){this.addPolyline$com_eteks_sweethome3d_model_Polyline$int(e,this.polylines.length)},e.prototype.addPolyline$com_eteks_sweethome3d_model_Polyline$int=function(e,t){this.polylines=this.polylines.slice(0),this.polylines.splice(t,0,e),e.setLevel(this.selectedLevel),this.polylinesChangeSupport.fireCollectionChanged(e,CollectionEvent.Type.ADD)},e.prototype.addPolyline=function(e,t){if(!(null!=e&&e instanceof Polyline||null===e)||"number"!=typeof t&&null!==t){if((null!=e&&e instanceof Polyline||null===e)&&void 0===t)return this.addPolyline$com_eteks_sweethome3d_model_Polyline(e);throw new Error("invalid overload")}return this.addPolyline$com_eteks_sweethome3d_model_Polyline$int(e,t)},e.prototype.deletePolyline=function(e){this.deselectItem(e);var t=this.polylines.indexOf(e);-1!==t&&(e.setLevel(null),this.polylines=this.polylines.slice(0),this.polylines.splice(t,1)[0],this.polylinesChangeSupport.fireCollectionChanged(e,CollectionEvent.Type.DELETE))},e.prototype.addDimensionLinesListener=function(e){var t;this.dimensionLinesChangeSupport.addCollectionListener(null==(t=e)||"function"==typeof t?t:function(e){return(t.collectionChanged?t.collectionChanged:t).call(t,e)})},e.prototype.removeDimensionLinesListener=function(e){var t;this.dimensionLinesChangeSupport.removeCollectionListener(null==(t=e)||"function"==typeof t?t:function(e){return(t.collectionChanged?t.collectionChanged:t).call(t,e)})},e.prototype.getDimensionLines=function(){return this.dimensionLines.slice(0)},e.prototype.addDimensionLine=function(e){this.dimensionLines=this.dimensionLines.slice(0),this.dimensionLines.push(e),e.setLevel(this.selectedLevel),this.dimensionLinesChangeSupport.fireCollectionChanged(e,CollectionEvent.Type.ADD)},e.prototype.deleteDimensionLine=function(e){this.deselectItem(e);var t=this.dimensionLines.indexOf(e);-1!==t&&(e.setLevel(null),this.dimensionLines=this.dimensionLines.slice(0),this.dimensionLines.splice(t,1)[0],this.dimensionLinesChangeSupport.fireCollectionChanged(e,CollectionEvent.Type.DELETE))},e.prototype.addLabelsListener=function(e){var t;this.labelsChangeSupport.addCollectionListener(null==(t=e)||"function"==typeof t?t:function(e){return(t.collectionChanged?t.collectionChanged:t).call(t,e)})},e.prototype.removeLabelsListener=function(e){var t;this.labelsChangeSupport.removeCollectionListener(null==(t=e)||"function"==typeof t?t:function(e){return(t.collectionChanged?t.collectionChanged:t).call(t,e)})},e.prototype.getLabels=function(){return this.labels.slice(0)},e.prototype.addLabel=function(e){this.labels=this.labels.slice(0),this.labels.push(e),e.setLevel(this.selectedLevel),this.labelsChangeSupport.fireCollectionChanged(e,CollectionEvent.Type.ADD)},e.prototype.deleteLabel=function(e){this.deselectItem(e);var t=this.labels.indexOf(e);-1!==t&&(e.setLevel(null),this.labels=this.labels.slice(0),this.labels.splice(t,1)[0],this.labelsChangeSupport.fireCollectionChanged(e,CollectionEvent.Type.DELETE))},e.prototype.getSelectableViewableItems=function(){var e=[];this.addViewableItems(this.walls,e),this.addViewableItems(this.rooms,e),this.addViewableItems(this.dimensionLines,e),this.addViewableItems(this.polylines,e),this.addViewableItems(this.labels,e);for(var t=this.getFurniture(),i=0;i<t.length;i++){var n=t[i];n.isVisible()&&(null==n.getLevel()||n.getLevel().isViewable())&&e.push(n)}return this.compass.isVisible()&&e.push(this.compass),e},e.prototype.addViewableItems=function(e,t){for(var i=0;i<e.length;i++){var n=e[i];if(null!=n&&null!=n.constructor&&null!=n.constructor.__interfaces&&n.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Elevatable")>=0){var o=n;(null==o.getLevel()||o.getLevel().isViewable())&&t.push(n)}}},e.prototype.getHomeObjects=function(){var e,t,i=[];i.push(this.environment),i.push(this.compass),e=i,t=this.levels,e.push.apply(e,t),function(e,t){e.push.apply(e,t)}(i,this.walls),function(e,t){e.push.apply(e,t)}(i,this.rooms),function(e,t){e.push.apply(e,t)}(i,this.dimensionLines),function(e,t){e.push.apply(e,t)}(i,this.polylines),function(e,t){e.push.apply(e,t)}(i,this.labels);for(var n=this.getFurniture(),o=0;o<n.length;o++){var r=n[o];i.push(r),null!=r&&r instanceof HomeFurnitureGroup&&function(e,t){e.push.apply(e,t)}(i,r.getAllFurniture())}return i.push(this.topCamera),i.push(this.observerCamera),function(e,t){e.push.apply(e,t)}(i,this.storedCameras),function(e,t){e.push.apply(e,t)}(i,this.environment.getVideoCameraPath()),i},e.prototype.isEmpty=function(){return 0==this.furniture.length&&0==this.walls.length&&0==this.rooms.length&&0==this.dimensionLines.length&&0==this.polylines.length&&0==this.labels.length},e.prototype.getWallHeight=function(){return this.wallHeight},e.prototype.getName=function(){return this.name},e.prototype.setName=function(e){if(e!==this.name&&(null==e||e!==this.name)){var t=this.name;this.name=e,this.propertyChangeSupport.firePropertyChange("NAME",t,e)}},e.prototype.isModified=function(){return this.modified},e.prototype.setModified=function(e){e!==this.modified&&(this.modified=e,this.propertyChangeSupport.firePropertyChange("MODIFIED",!e,e))},e.prototype.isRecovered=function(){return this.recovered},e.prototype.setRecovered=function(e){e!==this.recovered&&(this.recovered=e,this.propertyChangeSupport.firePropertyChange("RECOVERED",!e,e))},e.prototype.isRepaired=function(){return this.repaired},e.prototype.setRepaired=function(e){e!==this.repaired&&(this.repaired=e,this.propertyChangeSupport.firePropertyChange("REPAIRED",!e,e))},e.prototype.getFurnitureSortedPropertyName=function(){return this.furnitureSortedPropertyName},e.prototype.setFurnitureSortedPropertyName=function(e){if(e!==this.furnitureSortedPropertyName&&(null==e||e!==this.furnitureSortedPropertyName)){var t=this.furnitureSortedPropertyName;this.furnitureSortedPropertyName=e;try{this.furnitureSortedProperty=null!=e?e:null}catch(e){this.furnitureSortedProperty=null}this.propertyChangeSupport.firePropertyChange("FURNITURE_SORTED_PROPERTY",t,e)}},e.prototype.getFurnitureSortedProperty=function(){return this.furnitureSortedProperty},e.prototype.setFurnitureSortedProperty=function(e){if(e!==this.furnitureSortedProperty&&(null==e||e!=this.furnitureSortedProperty)){var t=this.furnitureSortedProperty;this.furnitureSortedProperty=e,this.furnitureSortedPropertyName=null!=e?e:null,this.propertyChangeSupport.firePropertyChange("FURNITURE_SORTED_PROPERTY",t,e)}},e.prototype.isFurnitureDescendingSorted=function(){return this.furnitureDescendingSorted},e.prototype.setFurnitureDescendingSorted=function(e){e!==this.furnitureDescendingSorted&&(this.furnitureDescendingSorted=e,this.propertyChangeSupport.firePropertyChange("FURNITURE_DESCENDING_SORTED",!e,e))},e.prototype.getFurnitureVisiblePropertyNames=function(){return null==this.furnitureVisiblePropertyNames?[]:this.furnitureVisiblePropertyNames.slice(0)},e.prototype.setFurnitureVisiblePropertyNames=function(e){if(e!==this.furnitureVisiblePropertyNames&&(null==e||!function(e,t){if(null==e&&null==t)return!0;if(null==e||null==t)return!1;if(e.length!=t.length)return!1;for(var i=0;i<e.length;i++)if(e[i]!=t[i])return!1;return!0}(e,this.furnitureVisiblePropertyNames))){var t=this.furnitureVisiblePropertyNames;this.furnitureVisiblePropertyNames=e.slice(0),this.furnitureVisibleProperties=[];for(var i=0;i<e.length;i++){var n=e[i];try{this.furnitureVisibleProperties.push(n)}catch(e){}}this.propertyChangeSupport.firePropertyChange("FURNITURE_VISIBLE_PROPERTIES",t.slice(0),e.slice(0))}},e.prototype.getFurnitureVisibleProperties=function(){return null==this.furnitureVisibleProperties?[]:this.furnitureVisibleProperties.slice(0)},e.prototype.setFurnitureVisibleProperties=function(e){if(e!==this.furnitureVisibleProperties&&(null==e||!function(e,t){if(null==e&&null==t)return!0;if(null==e||null==t)return!1;if(e.length!=t.length)return!1;for(var i=0;i<e.length;i++)if(e[i]!=t[i])return!1;return!0}(e,this.furnitureVisibleProperties))){var t=this.furnitureVisibleProperties;this.furnitureVisibleProperties=e.slice(0),this.furnitureVisiblePropertyNames=[];for(var i=0;i<e.length;i++){var n=e[i];this.furnitureVisiblePropertyNames.push(n)}this.propertyChangeSupport.firePropertyChange("FURNITURE_VISIBLE_PROPERTIES",t.slice(0),e.slice(0))}},e.prototype.getFurnitureAdditionalProperties=function(){return this.furnitureAdditionalProperties.slice(0)},e.prototype.setFurnitureAdditionalProperties=function(e){if(e!==this.furnitureAdditionalProperties&&(null==e||!function(e,t){if(null==e&&null==t)return!0;if(null==e||null==t)return!1;if(e.length!=t.length)return!1;for(var i=0;i<e.length;i++)if(e[i]!=t[i])return!1;return!0}(e,this.furnitureAdditionalProperties))){var t=this.furnitureAdditionalProperties;this.furnitureAdditionalProperties=e.slice(0);for(var i=this.getFurnitureVisiblePropertyNames().slice(0),n=i.length-1;n>=0;n--)try{i[n]}catch(t){e.indexOf(new ObjectProperty(i[n]))>=0||i.splice(n,1)[0]}this.setFurnitureVisiblePropertyNames(i),null==this.getFurnitureSortedPropertyName()||e.indexOf(new ObjectProperty(this.getFurnitureSortedPropertyName()))>=0||this.setFurnitureSortedPropertyName(null),this.propertyChangeSupport.firePropertyChange("FURNITURE_ADDITIONAL_PROPERTIES",t.slice(0),e.slice(0))}},e.prototype.getBackgroundImage=function(){return this.backgroundImage},e.prototype.setBackgroundImage=function(e){if(e!==this.backgroundImage){var t=this.backgroundImage;this.backgroundImage=e,this.propertyChangeSupport.firePropertyChange("BACKGROUND_IMAGE",t,e)}},e.prototype.getTopCamera=function(){return this.topCamera},e.prototype.getObserverCamera=function(){return this.observerCamera},e.prototype.setCamera=function(e){if(e!==this.camera){var t=this.camera;this.camera=e,this.propertyChangeSupport.firePropertyChange("CAMERA",t,e)}},e.prototype.getCamera=function(){return null==this.camera&&(this.camera=this.getTopCamera()),this.camera},e.prototype.setStoredCameras=function(e){if(!function(e,t){if(null==e&&null==t)return!0;if(null==e||null==t)return!1;if(e.length!=t.length)return!1;for(var i=0;i<e.length;i++)if(e[i]!=t[i])return!1;return!0}(this.storedCameras,e)){var t=this.storedCameras;this.storedCameras=null==e?[]:e.slice(0),this.propertyChangeSupport.firePropertyChange("STORED_CAMERAS",t.slice(0),e.slice(0))}},e.prototype.getStoredCameras=function(){return this.storedCameras.slice(0)},e.prototype.getEnvironment=function(){return this.environment},e.prototype.getCompass=function(){return this.compass},e.prototype.getPrint=function(){return this.print},e.prototype.setPrint=function(e){if(e!==this.print){var t=this.print;this.print=e,this.propertyChangeSupport.firePropertyChange("PRINT",t,e)}this.print=e},e.prototype.getVisualProperty=function(e){return void 0===(t=this.visualProperties)[i=e]?null:t[i];var t,i},e.prototype.setVisualProperty=function(e,t){this.visualProperties[e]=t},e.prototype.getProperty=function(e){return void 0===(t=this.properties)[i=e]?null:t[i];var t,i},e.prototype.getNumericProperty=function(e){var t,i,n=void 0===(t=this.properties)[i=e]?null:t[i];if(null!=n)try{return new Number(n).valueOf()}catch(e){try{return new Number(n).valueOf()}catch(e){}}return null},e.prototype.setProperty=function(e,t){var i,n,o=this,r=void 0===(i=this.properties)[n=e]?null:i[n];null==t?null!=r&&(!function(t){var i=o.properties[e];delete o.properties[e]}(this.properties),this.propertyChangeSupport.firePropertyChange(e,r,null)):(this.properties[e]=t,this.propertyChangeSupport.firePropertyChange(e,r,t))},e.prototype.getPropertyNames=function(){return Object.keys(this.properties)},e.prototype.addPropertyChangeListener=function(e,t){this.propertyChangeSupport.addPropertyChangeListener(e,t)},e.prototype.removePropertyChangeListener=function(e,t){this.propertyChangeSupport.removePropertyChangeListener(e,t)},e.prototype.isBasePlanLocked=function(){return this.basePlanLocked},e.prototype.setBasePlanLocked=function(e){e!==this.basePlanLocked&&(this.basePlanLocked=e,this.propertyChangeSupport.firePropertyChange("BASE_PLAN_LOCKED",!e,e))},e.prototype.getVersion=function(){return this.version},e.prototype.setVersion=function(e){this.version=e},e.prototype.clone=function(){try{var t=function(e){var t=Object.create(e);for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t}(this);return e.copyHomeData(this,t),e.initListenersSupport(t),t.addModelListeners(),t}catch(e){throw new IllegalStateException("Super class isn't cloneable")}},e.copyHomeData=function(t,i){i.allLevelsSelection=t.allLevelsSelection,i.name=t.name,i.modified=t.modified,i.recovered=t.recovered,i.repaired=t.repaired,i.backgroundImage=t.backgroundImage,i.furnitureDescendingSorted=t.furnitureDescendingSorted,i.version=t.version,i.basePlanLocked=t.basePlanLocked,i.skyColor=t.skyColor,i.groundColor=t.groundColor,i.lightColor=t.lightColor,i.wallsAlpha=t.wallsAlpha,i.furnitureSortedProperty=t.furnitureSortedProperty,i.selectedItems=[],i.furniture=e.cloneSelectableItems(t.furniture,t.selectedItems,i.selectedItems),i.rooms=e.cloneSelectableItems(t.rooms,t.selectedItems,i.selectedItems),i.dimensionLines=e.cloneSelectableItems(t.dimensionLines,t.selectedItems,i.selectedItems),i.polylines=e.cloneSelectableItems(t.polylines,t.selectedItems,i.selectedItems),i.labels=e.cloneSelectableItems(t.labels,t.selectedItems,i.selectedItems),i.walls=Wall.clone(t.walls);for(var n=0;n<t.walls.length;n++){var o=t.walls[n];t.selectedItems.indexOf(o)>=0&&i.selectedItems.push(i.walls[n])}if(i.levels=[],t.levels.length>0){for(var r=0;r<t.levels.length;r++){var l=t.levels[r];i.levels.push(function(e){if(null!=e.clone)return e.clone();var t=Object.create(e);for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t}(l))}for(n=0;n<t.furniture.length;n++){var a=t.furniture[n].getLevel();null!=a&&i.furniture[n].setLevel(i.levels[t.levels.indexOf(a)])}for(n=0;n<t.rooms.length;n++){var s=t.rooms[n].getLevel();null!=s&&i.rooms[n].setLevel(i.levels[t.levels.indexOf(s)])}for(n=0;n<t.dimensionLines.length;n++){var h=t.dimensionLines[n].getLevel();null!=h&&i.dimensionLines[n].setLevel(i.levels[t.levels.indexOf(h)])}for(n=0;n<t.polylines.length;n++){var u=t.polylines[n].getLevel();null!=u&&i.polylines[n].setLevel(i.levels[t.levels.indexOf(u)])}for(n=0;n<t.labels.length;n++){var d=t.labels[n].getLevel();null!=d&&i.labels[n].setLevel(i.levels[t.levels.indexOf(d)])}for(n=0;n<t.walls.length;n++){var c=t.walls[n].getLevel();null!=c&&i.walls[n].setLevel(i.levels[t.levels.indexOf(c)])}null!=t.selectedLevel&&(i.selectedLevel=i.levels[t.levels.indexOf(t.selectedLevel)])}if(null!=t.print&&null!=t.print.getPrintedLevels()){var p=t.print.getPrintedLevels().slice(0);for(n=0;n<p.length;n++)p[n]=i.levels[t.levels.indexOf(p[n])];i.print=new HomePrint(t.print.getPaperOrientation(),t.print.getPaperWidth(),t.print.getPaperHeight(),t.print.getPaperTopMargin(),t.print.getPaperLeftMargin(),t.print.getPaperBottomMargin(),t.print.getPaperRightMargin(),t.print.isFurniturePrinted(),t.print.isPlanPrinted(),p,t.print.isView3DPrinted(),t.print.getPlanScale(),t.print.getHeaderFormat(),t.print.getFooterFormat())}else i.print=t.print;i.observerCamera=function(e){if(null!=e.clone)return e.clone();var t=Object.create(e);for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t}(t.observerCamera),i.topCamera=function(e){if(null!=e.clone)return e.clone();var t=Object.create(e);for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t}(t.topCamera),t.camera===t.observerCamera?(i.camera=i.observerCamera,t.selectedItems.indexOf(t.observerCamera)>=0&&i.selectedItems.push(i.observerCamera)):i.camera=i.topCamera,i.storedCameras=[];for(r=0;r<t.storedCameras.length;r++){var g=t.storedCameras[r];i.storedCameras.push(function(e){if(null!=e.clone)return e.clone();var t=Object.create(e);for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t}(g))}i.environment=function(e){if(null!=e.clone)return e.clone();var t=Object.create(e);for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t}(t.environment),i.compass=function(e){if(null!=e.clone)return e.clone();var t=Object.create(e);for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t}(t.compass),i.furnitureVisibleProperties=t.furnitureVisibleProperties.slice(0),i.furnitureVisiblePropertyNames=t.furnitureVisiblePropertyNames.slice(0),i.visualProperties=function(e){var t={};for(var i in e)t[i]=e[i];return t}(t.visualProperties),i.properties=function(e){var t={};for(var i in e)t[i]=e[i];return t}(t.properties)},e.cloneSelectableItems=function(e,t,i){for(var n=[],o=0;o<e.length;o++){var r=e[o],l=function(e){if(null!=e.clone)return e.clone();var t=Object.create(e);for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t}(r);if(n.push(l),t.indexOf(r)>=0)i.push(l);else if(null!=r&&r instanceof HomeFurnitureGroup)for(var a=r.getAllFurniture(),s=null,h=0,u=a.length;h<u;h++){var d=a[h];t.indexOf(d)>=0&&(null==s&&(s=l.getAllFurniture()),i.push(s[h]))}}return n},e.duplicate=function(t){for(var i=[],n=Wall.duplicate(e.getWallsSubList(t)),o=0,r=0;r<t.length;r++){var l=t[r];null!=l&&l instanceof Wall?i.push(n[o++]):null!=l&&l instanceof HomeObject?i.push(l.duplicate()):i.push(function(e){if(null!=e.clone)return e.clone();var t=Object.create(e);for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t}(l))}return i},e.getFurnitureSubList=function(t){return e.getSubList(t,HomePieceOfFurniture)},e.getWallsSubList=function(t){return e.getSubList(t,Wall)},e.getRoomsSubList=function(t){return e.getSubList(t,Room)},e.getPolylinesSubList=function(t){return e.getSubList(t,Polyline)},e.getDimensionLinesSubList=function(t){return e.getSubList(t,DimensionLine)},e.getLabelsSubList=function(t){return e.getSubList(t,Label)},e.getSubList=function(e,t){for(var i,n,o=[],r=0;r<e.length;r++){var l=e[r];n=l,("string"==typeof(i=t)?n.constructor&&n.constructor.__interfaces&&n.constructor.__interfaces.indexOf(i)>=0||n.__interfaces&&n.__interfaces.indexOf(i)>=0:"function"==typeof i?n instanceof i||n.constructor&&n.constructor===i:void 0)&&o.push(l)}return o},e.CURRENT_VERSION=7400,e.HOME_TOP_CAMERA_ID="camera-homeTopCamera",e.HOME_OBSERVER_CAMERA_ID="observerCamera-homeObserverCamera",e.HOME_ENVIRONMENT_ID="environment-homeEnvironment",e.HOME_COMPASS_ID="compass-homeCompass",e.KEEP_BACKWARD_COMPATIBLITY=!0,e}();Home.__class="com.eteks.sweethome3d.model.Home",function(e){var t=function(){function t(e){this.__parent=e}return t.prototype.propertyChange=function(t){var i,n;"ELEVATION"!==t.getPropertyName()&&"ELEVATION_INDEX"!==t.getPropertyName()||(this.__parent.levels=this.__parent.levels.slice(0),i=this.__parent.levels,(n=e.LEVEL_ELEVATION_COMPARATOR_$LI$()).compare?i.sort((function(e,t){return n.compare(e,t)})):i.sort(n))},t}();e.Home$0=t}(Home||(Home={})),Home.__transients=["furnitureChangeSupport","selectedItems","selectionListeners","allLevelsSelection","levelsChangeSupport","wallsChangeSupport","roomsChangeSupport","polylinesChangeSupport","dimensionLinesChangeSupport","labelsChangeSupport","modified","recovered","repaired","propertyChangeSupport","furnitureAdditionalProperties"];var PlanController=function(e){function t(i,n,o,r,l){var a=e.call(this,i,n,o,r,l)||this;void 0===a.__com_eteks_sweethome3d_viewcontroller_PlanController_home&&(a.__com_eteks_sweethome3d_viewcontroller_PlanController_home=null),void 0===a.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences&&(a.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences=null),void 0===a.__com_eteks_sweethome3d_viewcontroller_PlanController_viewFactory&&(a.__com_eteks_sweethome3d_viewcontroller_PlanController_viewFactory=null),void 0===a.__com_eteks_sweethome3d_viewcontroller_PlanController_contentManager&&(a.__com_eteks_sweethome3d_viewcontroller_PlanController_contentManager=null),void 0===a.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport&&(a.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport=null),void 0===a.propertyChangeSupport&&(a.propertyChangeSupport=null),void 0===a.planView&&(a.planView=null),void 0===a.selectionListener&&(a.selectionListener=null),void 0===a.wallChangeListener&&(a.wallChangeListener=null),void 0===a.furnitureSizeChangeListener&&(a.furnitureSizeChangeListener=null),void 0===a.selectionState&&(a.selectionState=null),void 0===a.rectangleSelectionState&&(a.rectangleSelectionState=null),void 0===a.selectionMoveState&&(a.selectionMoveState=null),void 0===a.panningState&&(a.panningState=null),void 0===a.dragAndDropState&&(a.dragAndDropState=null),void 0===a.wallCreationState&&(a.wallCreationState=null),void 0===a.wallDrawingState&&(a.wallDrawingState=null),void 0===a.wallResizeState&&(a.wallResizeState=null),void 0===a.wallArcExtentState&&(a.wallArcExtentState=null),void 0===a.pieceOfFurnitureRotationState&&(a.pieceOfFurnitureRotationState=null),void 0===a.pieceOfFurniturePitchRotationState&&(a.pieceOfFurniturePitchRotationState=null),void 0===a.pieceOfFurnitureRollRotationState&&(a.pieceOfFurnitureRollRotationState=null),void 0===a.pieceOfFurnitureElevationState&&(a.pieceOfFurnitureElevationState=null),void 0===a.pieceOfFurnitureHeightState&&(a.pieceOfFurnitureHeightState=null),void 0===a.pieceOfFurnitureResizeState&&(a.pieceOfFurnitureResizeState=null),void 0===a.lightPowerModificationState&&(a.lightPowerModificationState=null),void 0===a.pieceOfFurnitureNameOffsetState&&(a.pieceOfFurnitureNameOffsetState=null),void 0===a.pieceOfFurnitureNameRotationState&&(a.pieceOfFurnitureNameRotationState=null),void 0===a.cameraYawRotationState&&(a.cameraYawRotationState=null),void 0===a.cameraPitchRotationState&&(a.cameraPitchRotationState=null),void 0===a.cameraElevationState&&(a.cameraElevationState=null),void 0===a.dimensionLineCreationState&&(a.dimensionLineCreationState=null),void 0===a.dimensionLineDrawingState&&(a.dimensionLineDrawingState=null),void 0===a.dimensionLineResizeState&&(a.dimensionLineResizeState=null),void 0===a.dimensionLineOffsetState&&(a.dimensionLineOffsetState=null),void 0===a.dimensionLinePitchRotationState&&(a.dimensionLinePitchRotationState=null),void 0===a.dimensionLineHeightState&&(a.dimensionLineHeightState=null),void 0===a.dimensionLineElevationState&&(a.dimensionLineElevationState=null),void 0===a.roomCreationState&&(a.roomCreationState=null),void 0===a.roomDrawingState&&(a.roomDrawingState=null),void 0===a.roomResizeState&&(a.roomResizeState=null),void 0===a.roomAreaOffsetState&&(a.roomAreaOffsetState=null),void 0===a.roomAreaRotationState&&(a.roomAreaRotationState=null),void 0===a.roomNameOffsetState&&(a.roomNameOffsetState=null),void 0===a.roomNameRotationState&&(a.roomNameRotationState=null),void 0===a.polylineCreationState&&(a.polylineCreationState=null),void 0===a.polylineDrawingState&&(a.polylineDrawingState=null),void 0===a.polylineResizeState&&(a.polylineResizeState=null),void 0===a.labelCreationState&&(a.labelCreationState=null),void 0===a.labelRotationState&&(a.labelRotationState=null),void 0===a.labelElevationState&&(a.labelElevationState=null),void 0===a.compassRotationState&&(a.compassRotationState=null),void 0===a.compassResizeState&&(a.compassResizeState=null),void 0===a.state&&(a.state=null),void 0===a.previousState&&(a.previousState=null),void 0===a.xLastMousePress&&(a.xLastMousePress=0),void 0===a.yLastMousePress&&(a.yLastMousePress=0),void 0===a.shiftDownLastMousePress&&(a.shiftDownLastMousePress=!1),void 0===a.alignmentActivatedLastMousePress&&(a.alignmentActivatedLastMousePress=!1),void 0===a.duplicationActivatedLastMousePress&&(a.duplicationActivatedLastMousePress=!1),void 0===a.magnetismToggledLastMousePress&&(a.magnetismToggledLastMousePress=!1),void 0===a.pointerTypeLastMousePress&&(a.pointerTypeLastMousePress=null),void 0===a.xLastMouseMove&&(a.xLastMouseMove=0),void 0===a.yLastMouseMove&&(a.yLastMouseMove=0),void 0===a.wallsAreaCache&&(a.wallsAreaCache=null),void 0===a.wallsIncludingBaseboardsAreaCache&&(a.wallsIncludingBaseboardsAreaCache=null),void 0===a.insideWallsAreaCache&&(a.insideWallsAreaCache=null),void 0===a.roomPathsCache&&(a.roomPathsCache=null),void 0===a.furnitureSidesCache&&(a.furnitureSidesCache=null),void 0===a.draggedItems&&(a.draggedItems=null),a.feedbackDisplayed=!0,a.__com_eteks_sweethome3d_viewcontroller_PlanController_home=i,a.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences=n,a.__com_eteks_sweethome3d_viewcontroller_PlanController_viewFactory=o,a.__com_eteks_sweethome3d_viewcontroller_PlanController_contentManager=r,a.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport=l,a.propertyChangeSupport=new PropertyChangeSupport(a),a.furnitureSidesCache={},a.selectionState=new t.SelectionState(a),a.selectionMoveState=new t.SelectionMoveState(a),a.rectangleSelectionState=new t.RectangleSelectionState(a),a.panningState=new t.PanningState(a),a.dragAndDropState=new t.DragAndDropState(a),a.wallCreationState=new t.WallCreationState(a),a.wallDrawingState=new t.WallDrawingState(a),a.wallResizeState=new t.WallResizeState(a),a.wallArcExtentState=new t.WallArcExtentState(a),a.pieceOfFurnitureRotationState=new t.PieceOfFurnitureRotationState(a),a.pieceOfFurniturePitchRotationState=new t.PieceOfFurniturePitchRotationState(a),a.pieceOfFurnitureRollRotationState=new t.PieceOfFurnitureRollRotationState(a),a.pieceOfFurnitureElevationState=new t.PieceOfFurnitureElevationState(a),a.pieceOfFurnitureHeightState=new t.PieceOfFurnitureHeightState(a),a.pieceOfFurnitureResizeState=new t.PieceOfFurnitureResizeState(a),a.lightPowerModificationState=new t.LightPowerModificationState(a),a.pieceOfFurnitureNameOffsetState=new t.PieceOfFurnitureNameOffsetState(a),a.pieceOfFurnitureNameRotationState=new t.PieceOfFurnitureNameRotationState(a),a.cameraYawRotationState=new t.CameraYawRotationState(a),a.cameraPitchRotationState=new t.CameraPitchRotationState(a),a.cameraElevationState=new t.CameraElevationState(a),a.dimensionLineCreationState=new t.DimensionLineCreationState(a),a.dimensionLineDrawingState=new t.DimensionLineDrawingState(a),a.dimensionLineResizeState=new t.DimensionLineResizeState(a),a.dimensionLineOffsetState=new t.DimensionLineOffsetState(a),a.dimensionLinePitchRotationState=new t.DimensionLinePitchRotationState(a),a.dimensionLineHeightState=new t.DimensionLineHeightState(a),a.dimensionLineElevationState=new t.DimensionLineElevationState(a),a.roomCreationState=new t.RoomCreationState(a),a.roomDrawingState=new t.RoomDrawingState(a),a.roomResizeState=new t.RoomResizeState(a),a.roomAreaOffsetState=new t.RoomAreaOffsetState(a),a.roomAreaRotationState=new t.RoomAreaRotationState(a),a.roomNameOffsetState=new t.RoomNameOffsetState(a),a.roomNameRotationState=new t.RoomNameRotationState(a),a.polylineCreationState=new t.PolylineCreationState(a),a.polylineDrawingState=new t.PolylineDrawingState(a),a.polylineResizeState=new t.PolylineResizeState(a),a.labelCreationState=new t.LabelCreationState(a),a.labelRotationState=new t.LabelRotationState(a),a.labelElevationState=new t.LabelElevationState(a),a.compassRotationState=new t.CompassRotationState(a),a.compassResizeState=new t.CompassResizeState(a),a.setState(a.selectionState),a.__com_eteks_sweethome3d_viewcontroller_PlanController_addModelListeners();var s=i.getNumericProperty(t.SCALE_VISUAL_PROPERTY);return null!=s&&a.setScale(s),a}return __extends(t,e),t.prototype.getView=function(){return null==this.planView&&(this.planView=this.__com_eteks_sweethome3d_viewcontroller_PlanController_viewFactory.createPlanView(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,this)),this.planView},t.prototype.setState=function(e){var t=null,i=!1,n=!1;null!=this.state&&(t=this.state.getMode(),i=this.state.isModificationState(),n=this.state.isBasePlanModificationState(),this.state.exit()),this.previousState=this.state,this.state=e,this.state.enter(),t!==e.getMode()&&this.propertyChangeSupport.firePropertyChange("MODE",t,e.getMode()),i!==e.isModificationState()&&this.propertyChangeSupport.firePropertyChange("MODIFICATION_STATE",i,!i),n!==e.isBasePlanModificationState()&&this.propertyChangeSupport.firePropertyChange("BASE_PLAN_MODIFICATION_STATE",n,!n)},t.prototype.addPropertyChangeListener=function(e,t){this.propertyChangeSupport.addPropertyChangeListener(e,t)},t.prototype.removePropertyChangeListener=function(e,t){this.propertyChangeSupport.removePropertyChangeListener(e,t)},t.prototype.getMode=function(){return this.state.getMode()},t.prototype.setMode=function(e){var t=this.state.getMode();e!==t&&(this.state.setMode(e),this.propertyChangeSupport.firePropertyChange("MODE",t,e))},t.prototype.isModificationState=function(){return this.state.isModificationState()},t.prototype.isBasePlanModificationState=function(){return this.state.isBasePlanModificationState()},t.prototype.deleteSelection=function(){this.state.deleteSelection()},t.prototype.escape=function(){this.state.escape()},t.prototype.moveSelection=function(e,t){this.state.moveSelection(e,t)},t.prototype.toggleMagnetism=function(e){this.state.toggleMagnetism(e)},t.prototype.setAlignmentActivated=function(e){this.state.setAlignmentActivated(e)},t.prototype.setDuplicationActivated=function(e){this.state.setDuplicationActivated(e)},t.prototype.setEditionActivated=function(e){this.state.setEditionActivated(e)},t.prototype.updateEditableProperty=function(e,t){this.state.updateEditableProperty(e,t)},t.prototype.pressMouse$float$float$int$boolean$boolean=function(e,t,i,n,o){this.pressMouse$float$float$int$boolean$boolean$boolean$boolean(e,t,i,n,n,o,n)},t.prototype.pressMouse$float$float$int$boolean$boolean$boolean$boolean=function(e,t,i,n,o,r,l){this.pressMouse$float$float$int$boolean$boolean$boolean$boolean$com_eteks_sweethome3d_viewcontroller_View_PointerType(e,t,i,n,o,r,l,null)},t.prototype.pressMouse$float$float$int$boolean$boolean$boolean$boolean$com_eteks_sweethome3d_viewcontroller_View_PointerType=function(e,t,i,n,o,r,l,a){this.xLastMousePress=e,this.yLastMousePress=t,this.xLastMouseMove=e,this.yLastMouseMove=t,this.shiftDownLastMousePress=n,this.alignmentActivatedLastMousePress=o,this.duplicationActivatedLastMousePress=r,this.magnetismToggledLastMousePress=l,this.pointerTypeLastMousePress=a,this.state.pressMouse(e,t,i,n,r)},t.prototype.pressMouse=function(e,t,i,n,o,r,l,a){if("number"!=typeof e&&null!==e||"number"!=typeof t&&null!==t||"number"!=typeof i&&null!==i||"boolean"!=typeof n&&null!==n||"boolean"!=typeof o&&null!==o||"boolean"!=typeof r&&null!==r||"boolean"!=typeof l&&null!==l||"number"!=typeof a&&null!==a){if("number"!=typeof e&&null!==e||"number"!=typeof t&&null!==t||"number"!=typeof i&&null!==i||"boolean"!=typeof n&&null!==n||"boolean"!=typeof o&&null!==o||"boolean"!=typeof r&&null!==r||"boolean"!=typeof l&&null!==l||void 0!==a){if("number"!=typeof e&&null!==e||"number"!=typeof t&&null!==t||"number"!=typeof i&&null!==i||"boolean"!=typeof n&&null!==n||"boolean"!=typeof o&&null!==o||void 0!==r||void 0!==l||void 0!==a)throw new Error("invalid overload");return this.pressMouse$float$float$int$boolean$boolean(e,t,i,n,o)}return this.pressMouse$float$float$int$boolean$boolean$boolean$boolean(e,t,i,n,o,r,l)}return this.pressMouse$float$float$int$boolean$boolean$boolean$boolean$com_eteks_sweethome3d_viewcontroller_View_PointerType(e,t,i,n,o,r,l,a)},t.prototype.releaseMouse=function(e,t){this.state.releaseMouse(e,t)},t.prototype.moveMouse=function(e,t){this.xLastMouseMove=e,this.yLastMouseMove=t,this.state.moveMouse(e,t)},t.prototype.zoom=function(e){this.state.zoom(e)},t.prototype.setFeedbackDisplayed=function(e){this.feedbackDisplayed=e,this.getView().deleteFeedback()},t.prototype.isFeedbackDisplayed=function(){return this.feedbackDisplayed},t.prototype.getSelectionState=function(){return this.selectionState},t.prototype.getSelectionMoveState=function(){return this.selectionMoveState},t.prototype.getRectangleSelectionState=function(){return this.rectangleSelectionState},t.prototype.getPanningState=function(){return this.panningState},t.prototype.getDragAndDropState=function(){return this.dragAndDropState},t.prototype.getWallCreationState=function(){return this.wallCreationState},t.prototype.getWallDrawingState=function(){return this.wallDrawingState},t.prototype.getWallResizeState=function(){return this.wallResizeState},t.prototype.getWallArcExtentState=function(){return this.wallArcExtentState},t.prototype.getPieceOfFurnitureRotationState=function(){return this.pieceOfFurnitureRotationState},t.prototype.getPieceOfFurniturePitchRotationState=function(){return this.pieceOfFurniturePitchRotationState},t.prototype.getPieceOfFurnitureRollRotationState=function(){return this.pieceOfFurnitureRollRotationState},t.prototype.getPieceOfFurnitureElevationState=function(){return this.pieceOfFurnitureElevationState},t.prototype.getPieceOfFurnitureHeightState=function(){return this.pieceOfFurnitureHeightState},t.prototype.getPieceOfFurnitureResizeState=function(){return this.pieceOfFurnitureResizeState},t.prototype.getLightPowerModificationState=function(){return this.lightPowerModificationState},t.prototype.getPieceOfFurnitureNameOffsetState=function(){return this.pieceOfFurnitureNameOffsetState},t.prototype.getPieceOfFurnitureNameRotationState=function(){return this.pieceOfFurnitureNameRotationState},t.prototype.getCameraYawRotationState=function(){return this.cameraYawRotationState},t.prototype.getCameraPitchRotationState=function(){return this.cameraPitchRotationState},t.prototype.getCameraElevationState=function(){return this.cameraElevationState},t.prototype.getDimensionLineCreationState=function(){return this.dimensionLineCreationState},t.prototype.getDimensionLineDrawingState=function(){return this.dimensionLineDrawingState},t.prototype.getDimensionLineResizeState=function(){return this.dimensionLineResizeState},t.prototype.getDimensionLineOffsetState=function(){return this.dimensionLineOffsetState},t.prototype.getDimensionLinePitchRotationState=function(){return this.dimensionLinePitchRotationState},t.prototype.getDimensionLineHeightState=function(){return this.dimensionLineHeightState},t.prototype.getDimensionLineElevationState=function(){return this.dimensionLineElevationState},t.prototype.getRoomCreationState=function(){return this.roomCreationState},t.prototype.getRoomDrawingState=function(){return this.roomDrawingState},t.prototype.getRoomResizeState=function(){return this.roomResizeState},t.prototype.getRoomAreaOffsetState=function(){return this.roomAreaOffsetState},t.prototype.getRoomAreaRotationState=function(){return this.roomAreaRotationState},t.prototype.getRoomNameOffsetState=function(){return this.roomNameOffsetState},t.prototype.getRoomNameRotationState=function(){return this.roomNameRotationState},t.prototype.getPolylineCreationState=function(){return this.polylineCreationState},t.prototype.getPolylineDrawingState=function(){return this.polylineDrawingState},t.prototype.getPolylineResizeState=function(){return this.polylineResizeState},t.prototype.getLabelCreationState=function(){return this.labelCreationState},t.prototype.getLabelRotationState=function(){return this.labelRotationState},t.prototype.getLabelElevationState=function(){return this.labelElevationState},t.prototype.getCompassRotationState=function(){return this.compassRotationState},t.prototype.getCompassResizeState=function(){return this.compassResizeState},t.prototype.getXLastMousePress=function(){return this.xLastMousePress},t.prototype.getYLastMousePress=function(){return this.yLastMousePress},t.prototype.wasShiftDownLastMousePress=function(){return this.shiftDownLastMousePress},t.prototype.wasMagnetismToggledLastMousePress=function(){return this.magnetismToggledLastMousePress},t.prototype.wasAlignmentActivatedLastMousePress=function(){return this.alignmentActivatedLastMousePress},t.prototype.wasDuplicationActivatedLastMousePress=function(){return this.duplicationActivatedLastMousePress},t.prototype.getPointerTypeLastMousePress=function(){return this.pointerTypeLastMousePress},t.prototype.getXLastMouseMove=function(){return this.xLastMouseMove},t.prototype.getYLastMouseMove=function(){return this.yLastMouseMove},t.prototype.modifySelectedItem=function(){var e=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(1===e.length){var t=e[0];null!=t&&t instanceof HomePieceOfFurniture?this.modifySelectedFurniture():null!=t&&t instanceof Wall?this.modifySelectedWalls():null!=t&&t instanceof Room?this.modifySelectedRooms():null!=t&&t instanceof Polyline?this.modifySelectedPolylines():null!=t&&t instanceof DimensionLine?this.modifySelectedDimensionLines():null!=t&&t instanceof Label?this.modifySelectedLabels():null!=t&&t instanceof Compass?this.modifyCompass():null!=t&&t instanceof ObserverCamera&&this.modifyObserverCamera()}},t.prototype.modifySelectedWalls=function(){0!=Home.getWallsSubList(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()).length&&new WallController(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,this.__com_eteks_sweethome3d_viewcontroller_PlanController_viewFactory,this.__com_eteks_sweethome3d_viewcontroller_PlanController_contentManager,this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport).displayView(this.getView())},t.prototype.lockBasePlan=function(){if(!this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked()){var e=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection(),i=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems(),n=i.slice(0),o=this.getItemsNotPartOfBasePlan(i),r=o.slice(0);this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setBasePlanLocked(!0),this.selectItems$java_util_List$boolean(o,e),this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new t.LockingUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_home,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,n,e,r))}},t.prototype.isItemPartOfBasePlan=function(e){return null!=e&&e instanceof HomePieceOfFurniture?this.isPieceOfFurniturePartOfBasePlan(e):!(null!=e&&e instanceof ObserverCamera)},t.prototype.getItemsNotPartOfBasePlan=function(e){for(var t=[],i=0;i<e.length;i++){var n=e[i];this.isItemPartOfBasePlan(n)||t.push(n)}return t},t.prototype.unlockBasePlan=function(){if(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked()){var e=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection(),i=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems().slice(0);this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setBasePlanLocked(!1),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setAllLevelsSelection(!1),this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new t.UnlockingUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_home,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,i,e))}},t.prototype.isItemMovable=function(e){return!(null!=e&&e instanceof HomePieceOfFurniture)||this.isPieceOfFurnitureMovable(e)},t.prototype.isItemResizable=function(e){return!(null!=e&&e instanceof HomePieceOfFurniture)||e.isResizable()},t.prototype.isItemDeletable=function(e){return null!=e&&e instanceof HomePieceOfFurniture?this.isPieceOfFurnitureDeletable(e):!(null!=e&&e instanceof Compass||null!=e&&e instanceof Camera)},t.prototype.flipHorizontally=function(){this.flipSelectedItems(!0)},t.prototype.flipVertically=function(){this.flipSelectedItems(!1)},t.prototype.flipSelectedItems=function(e){var i=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(0!=i.length){for(var n=i.slice(0),o=function(e){for(var t=[];e-- >0;)t.push(null);return t}(n.length),r=0;r<o.length;r++)if(null!=n[r]&&n[r]instanceof HomeFurnitureGroup){var l=n[r],a=l.getAllFurniture();o[r]=function(e){for(var t=[];e-- >0;)t.push(0);return t}(a.length+1),o[r][0]=this.getTextBaseOffset(l.getName(),l.getNameStyle(),l.constructor);for(var s=0;s<a.length;s++){var h=a[s];o[r][s+1]=this.getTextBaseOffset(h.getName(),h.getNameStyle(),h.constructor)}}else if(null!=n[r]&&n[r]instanceof HomePieceOfFurniture){h=n[r];o[r]=[this.getTextBaseOffset(h.getName(),h.getNameStyle(),h.constructor)]}else if(null!=n[r]&&n[r]instanceof Room){var u=n[r];o[r]=[this.getTextBaseOffset(u.getName(),u.getNameStyle(),u.constructor),this.getTextBaseOffset(this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getAreaFormatWithUnit().format(u.getArea()),u.getAreaStyle(),u.constructor)]}this.doFlipItems(n,o,e),this.selectAndShowItems$java_util_List$boolean(i,this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection()),this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new t.FlippingUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection(),i.slice(0),o,e))}},t.prototype.doFlipItems=function(e,t,i){for(var n=34028235e31,o=34028235e31,r=-34028235e31,l=-34028235e31,a=0;a<e.length;a++){var s=e[a];if(!(null!=s&&s instanceof ObserverCamera))for(var h=s.getPoints(),u=0;u<h.length;u++){var d=h[u];n=Math.min(n,d[0]),o=Math.min(o,d[1]),r=Math.max(r,d[0]),l=Math.max(l,d[1])}}for(var c=(n+r)/2,p=(o+l)/2,g=e.slice(0),m=0;m<e.length;m++)this.flipItem(e[m],t[m],0,i?c:p,i,g)},t.prototype.flipItem=function(e,i,n,o,r,l){if(null!=e&&e instanceof HomePieceOfFurniture){var a=e;if(r?(a.setX(2*o-a.getX()),a.setAngle(-a.getAngle()),t.flipPieceOfFurnitureName(a,i[0],r)):(a.setY(2*o-a.getY()),a.setAngle(Math.PI-a.getAngle()),t.flipPieceOfFurnitureName(a,i[0],r)),a.isHorizontallyRotatable()&&a.setRoll(-a.getRoll()),a.isResizable()&&a.setModelMirrored(!a.isModelMirrored()),null!=e&&e instanceof HomeFurnitureGroup)for(var s=e.getAllFurniture(),h=0;h<s.length;h++)t.flipPieceOfFurnitureName(s[h],i[h+1],r)}else if(null!=e&&e instanceof Wall){var u,d,c=e;if(r)c.setXStart(2*o-c.getXStart()),null==(u=c.getWallAtStart())||l.indexOf(u)>=0||(u.getWallAtStart()===c?u.setXStart(2*o-u.getXStart()):u.setXEnd(2*o-u.getXEnd())),c.setXEnd(2*o-c.getXEnd()),null==(d=c.getWallAtEnd())||l.indexOf(d)>=0||(d.getWallAtStart()===c?d.setXStart(2*o-d.getXStart()):d.setXEnd(2*o-d.getXEnd()));else c.setYStart(2*o-c.getYStart()),null==(u=c.getWallAtStart())||l.indexOf(u)>=0||(u.getWallAtStart()===c?u.setYStart(2*o-u.getYStart()):u.setYEnd(2*o-u.getYEnd())),c.setYEnd(2*o-c.getYEnd()),null==(d=c.getWallAtEnd())||l.indexOf(d)>=0||(d.getWallAtStart()===c?d.setYStart(2*o-d.getYStart()):d.setYEnd(2*o-d.getYEnd()));var p=c.getArcExtent();null!=p&&c.setArcExtent(-p),t.reverseWallSidesStyle(c)}else if(null!=e&&e instanceof Room){for(var g=e,m=g.getPoints(),f=0;f<m.length;f++){var v=m[f];r?v[0]=2*o-v[0]:v[1]=2*o-v[1]}g.setPoints(m);var _=g.getNameStyle(),S=g.getAreaStyle();if(r)g.setNameXOffset(-g.getNameXOffset()),g.setAreaXOffset(-g.getAreaXOffset()),null!=_&&(_.getAlignment()===TextStyle.Alignment.LEFT?g.setNameStyle(_.deriveStyle$com_eteks_sweethome3d_model_TextStyle_Alignment(TextStyle.Alignment.RIGHT)):_.getAlignment()===TextStyle.Alignment.RIGHT&&g.setNameStyle(_.deriveStyle$com_eteks_sweethome3d_model_TextStyle_Alignment(TextStyle.Alignment.LEFT))),null!=S&&(S.getAlignment()===TextStyle.Alignment.LEFT?g.setAreaStyle(S.deriveStyle$com_eteks_sweethome3d_model_TextStyle_Alignment(TextStyle.Alignment.RIGHT)):S.getAlignment()===TextStyle.Alignment.RIGHT&&g.setAreaStyle(S.deriveStyle$com_eteks_sweethome3d_model_TextStyle_Alignment(TextStyle.Alignment.LEFT)));else{g.setNameYOffset(-g.getNameYOffset());var y=i[0];g.setNameXOffset(g.getNameXOffset()-y*Math.sin(g.getNameAngle())),g.setNameYOffset(g.getNameYOffset()-y*Math.cos(g.getNameAngle())),g.setAreaYOffset(-g.getAreaYOffset()),y=i[1],g.setAreaXOffset(g.getAreaXOffset()-y*Math.sin(g.getAreaAngle())),g.setAreaYOffset(g.getAreaYOffset()-y*Math.cos(g.getAreaAngle()))}g.setNameAngle(-g.getNameAngle()),g.setAreaAngle(-g.getAreaAngle())}else if(null!=e&&e instanceof Polyline){var E=e;for(m=E.getPoints(),f=0;f<m.length;f++){v=m[f];r?v[0]=2*o-v[0]:v[1]=2*o-v[1]}E.setPoints(m)}else if(null!=e&&e instanceof DimensionLine){var C=e;if(C.isElevationDimensionLine())r?(C.setXStart(2*o-C.getXStart()),C.setXEnd(C.getXStart()),C.setPitch(Math.PI-C.getPitch())):(C.setYStart(2*o-C.getYStart()),C.setYEnd(C.getYStart()),C.setPitch(-C.getPitch())),C.setOffset(-C.getOffset());else if(r){var P=C.getXStart();C.setXStart(2*o-C.getXEnd()),C.setXEnd(2*o-P);var w=C.getYStart();C.setYStart(C.getYEnd()),C.setYEnd(w)}else C.setYStart(2*o-C.getYStart()),C.setYEnd(2*o-C.getYEnd()),C.setOffset(-C.getOffset())}else if(null!=e&&e instanceof Label){var L=e;r?(L.setX(2*o-L.getX()),L.setAngle(-L.getAngle())):(L.setY(2*o-L.getY()),null!=L.getPitch()?L.setAngle(Math.PI-L.getAngle()):L.setAngle(-L.getAngle()));var T=L.getStyle();null!=T&&(T.getAlignment()===TextStyle.Alignment.LEFT?L.setStyle(T.deriveStyle$com_eteks_sweethome3d_model_TextStyle_Alignment(TextStyle.Alignment.RIGHT)):T.getAlignment()===TextStyle.Alignment.RIGHT&&L.setStyle(T.deriveStyle$com_eteks_sweethome3d_model_TextStyle_Alignment(TextStyle.Alignment.LEFT)))}else if(null!=e&&e instanceof Compass){var A=e;r?(A.setX(2*o-A.getX()),A.setNorthDirection(-A.getNorthDirection())):(A.setY(2*o-A.getY()),A.setNorthDirection(Math.PI-A.getNorthDirection()))}},t.flipPieceOfFurnitureName=function(e,t,i){if(i){e.setNameXOffset(-e.getNameXOffset());var n=e.getNameStyle();null!=n&&(n.getAlignment()===TextStyle.Alignment.LEFT?e.setNameStyle(n.deriveStyle$com_eteks_sweethome3d_model_TextStyle_Alignment(TextStyle.Alignment.RIGHT)):n.getAlignment()===TextStyle.Alignment.RIGHT&&e.setNameStyle(n.deriveStyle$com_eteks_sweethome3d_model_TextStyle_Alignment(TextStyle.Alignment.LEFT)))}else e.setNameYOffset(-e.getNameYOffset()),0===e.getNameXOffset()&&0===e.getNameYOffset()||(e.setNameXOffset(e.getNameXOffset()-t*Math.sin(e.getNameAngle())),e.setNameYOffset(e.getNameYOffset()-t*Math.cos(e.getNameAngle()))),e.setNameAngle(-e.getNameAngle())},t.prototype.getTextBaseOffset=function(e,t,i){null==t&&(t=this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getDefaultTextStyle(i));var n=this.getView().getTextBounds(null!=e?e:"Ag",t,0,0,0);return(n[n.length-1][1]+n[0][1])/2},t.prototype.joinSelectedWalls=function(){for(var e,i,n=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems(),o=Home.getWallsSubList(n),r=[null,null],l=0;l<o.length;l++){var a=o[l];if(!(null!=a.getArcExtent()&&0!==a.getArcExtent()||null!=a.getWallAtStart()&&null!=a.getWallAtEnd())){if(null!=r[0]){r[1]=a;break}r[0]=a}}if(null==r[1]&&(e=o,(i=new t.PlanController$0(this,r)).compare?e.sort((function(e,t){return i.compare(e,t)})):e.sort(i),r[0]!==o[1]&&(r[1]=o[1])),null!=r[1]){var s=Math.atan2(r[0].getYEnd()-r[0].getYStart(),r[0].getXEnd()-r[0].getXStart()),h=Math.atan2(r[1].getYEnd()-r[1].getYStart(),r[1].getXEnd()-r[1].getXStart()),u=Math.abs(s-h)%Math.PI,d=null;if(u<=Math.PI/360||Math.PI-u<=Math.PI/360){if(java.awt.geom.Line2D.ptLineDistSq(r[1].getXStart(),r[1].getYStart(),r[1].getXEnd(),r[1].getYEnd(),r[0].getXStart(),r[0].getYStart())<.01&&java.awt.geom.Line2D.ptLineDistSq(r[1].getXStart(),r[1].getYStart(),r[1].getXEnd(),r[1].getYEnd(),r[0].getXEnd(),r[0].getYEnd())<.01)if(null==r[1].getWallAtStart()!=(null==r[1].getWallAtEnd()))d=null==r[1].getWallAtStart()?[r[1].getXStart(),r[1].getYStart()]:[r[1].getXEnd(),r[1].getYEnd()];else if(null==r[1].getWallAtStart()&&null==r[1].getWallAtEnd()){var c=java.awt.geom.Line2D.ptSegDistSq(r[1].getXStart(),r[1].getYStart(),r[1].getXEnd(),r[1].getYEnd(),r[0].getXStart(),r[0].getYStart()),p=java.awt.geom.Line2D.ptSegDistSq(r[1].getXStart(),r[1].getYStart(),r[1].getXEnd(),r[1].getYEnd(),r[0].getXEnd(),r[0].getYEnd());c>.01&&p>.01&&(d=null!=r[0].getWallAtEnd()||null==r[0].getWallAtStart()&&c<=p?java.awt.geom.Point2D.distanceSq(r[1].getXStart(),r[1].getYStart(),r[0].getXStart(),r[0].getYStart())<java.awt.geom.Point2D.distanceSq(r[1].getXEnd(),r[1].getYEnd(),r[0].getXStart(),r[0].getYStart())?[r[1].getXStart(),r[1].getYStart()]:[r[1].getXEnd(),r[1].getYEnd()]:java.awt.geom.Point2D.distanceSq(r[1].getXStart(),r[1].getYStart(),r[0].getXEnd(),r[0].getYEnd())<java.awt.geom.Point2D.distanceSq(r[1].getXEnd(),r[1].getYEnd(),r[0].getXEnd(),r[0].getYEnd())?[r[1].getXStart(),r[1].getYStart()]:[r[1].getXEnd(),r[1].getYEnd()])}}else d=t.computeIntersection$float$float$float$float$float$float$float$float(r[0].getXStart(),r[0].getYStart(),r[0].getXEnd(),r[0].getYEnd(),r[1].getXStart(),r[1].getYStart(),r[1].getXEnd(),r[1].getYEnd());if(null!=d){var g=t.JoinedWall.getJoinedWalls([r[0],r[1]]);this.doJoinWalls(g,d),this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new t.WallsJoiningUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,n.slice(0),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection(),g,d))}}},t.prototype.doJoinWalls=function(e,t){for(var i=[e[0].getWall(),e[1].getWall()],n=!1,o=0;o<2;o++){var r=null==i[o].getWallAtEnd(),l=null==i[o].getWallAtStart();l&&r&&(java.awt.geom.Point2D.distanceSq(i[o].getXStart(),i[o].getYStart(),t[0],t[1])<java.awt.geom.Point2D.distanceSq(i[o].getXEnd(),i[o].getYEnd(),t[0],t[1])?r=!1:l=!1),r?(i[o].setXEnd(t[0]),i[o].setYEnd(t[1])):l&&(i[o].setXStart(t[0]),i[o].setYStart(t[1])),(n||null==i[(o+1)%2].getWallAtStart()||null==i[(o+1)%2].getWallAtEnd())&&(r?(i[o].setWallAtEnd(i[(o+1)%2]),n=!0):l&&(i[o].setWallAtStart(i[(o+1)%2]),n=!0))}n?this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setSelectedItems([i[0],i[1]]):this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setSelectedItems([i[0]])},t.prototype.reverseSelectedWallsDirection=function(){var e=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems(),i=Home.getWallsSubList(e);if(0!=i.length){var n=i.slice(0);this.doReverseWallsDirection(n),this.selectAndShowItems$java_util_List$boolean(n.slice(0),!1),this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new t.WallsDirectionReversingUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,e.slice(0),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection(),n))}},t.prototype.doReverseWallsDirection=function(e){for(var i=0;i<e.length;i++){var n=e[i],o=n.getXStart(),r=n.getYStart(),l=n.getXEnd(),a=n.getYEnd();n.setXStart(l),n.setYStart(a),n.setXEnd(o),n.setYEnd(r),null!=n.getArcExtent()&&n.setArcExtent(-n.getArcExtent());var s=n.getWallAtStart(),h=null!=s&&s.getWallAtEnd()===n,u=null!=s&&s.getWallAtStart()===n,d=n.getWallAtEnd(),c=null!=d&&d.getWallAtEnd()===n,p=null!=d&&d.getWallAtStart()===n;n.setWallAtStart(d),n.setWallAtEnd(s),h?s.setWallAtEnd(n):u&&s.setWallAtStart(n),c?d.setWallAtEnd(n):p&&d.setWallAtStart(n);var g=n.getHeightAtEnd();if(null!=g){var m=n.getHeight();n.setHeight(g),n.setHeightAtEnd(m)}t.reverseWallSidesStyle(n)}},t.reverseWallSidesStyle=function(e){var t=e.getRightSideColor(),i=e.getRightSideTexture(),n=e.getLeftSideShininess(),o=e.getLeftSideBaseboard(),r=e.getLeftSideColor(),l=e.getLeftSideTexture(),a=e.getRightSideShininess(),s=e.getRightSideBaseboard();e.setLeftSideColor(t),e.setLeftSideTexture(i),e.setLeftSideShininess(a),e.setLeftSideBaseboard(s),e.setRightSideColor(r),e.setRightSideTexture(l),e.setRightSideShininess(n),e.setRightSideBaseboard(o)},t.prototype.splitSelectedWall=function(){var e=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems(),i=Home.getWallsSubList(e);if(1===i.length){var n=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection(),o=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked(),r=i[0],l=new t.JoinedWall(r),a=r.getXStart(),s=r.getYStart(),h=(a+r.getXEnd())/2,u=(s+r.getYEnd())/2,d=r.getWallAtStart(),c=null!=d&&d.getWallAtEnd()===r,p=null!=d&&d.getWallAtStart()===r,g=r.getWallAtEnd(),m=null!=g&&g.getWallAtEnd()===r,f=null!=g&&g.getWallAtStart()===r,v=r.duplicate();this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addWall(v),v.setLevel(r.getLevel());var _=r.duplicate();if(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addWall(_),_.setLevel(r.getLevel()),v.setXEnd(h),v.setYEnd(u),_.setXStart(h),_.setYStart(u),null!=r.getHeightAtEnd()){var S=(r.getHeight()+r.getHeightAtEnd())/2;v.setHeightAtEnd(S),_.setHeight(S)}v.setWallAtEnd(_),_.setWallAtStart(v),v.setWallAtStart(d),c?d.setWallAtEnd(v):p&&d.setWallAtStart(v),_.setWallAtEnd(g),f?g.setWallAtStart(_):m&&g.setWallAtEnd(_),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.deleteWall(r),this.selectAndShowItems$java_util_List$boolean([v].slice(0),!1),this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new t.WallSplittingUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,e.slice(0),o,n,l,new t.JoinedWall(v),new t.JoinedWall(_),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked()))}},t.prototype.modifySelectedRooms=function(){0!=Home.getRoomsSubList(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()).length&&new RoomController(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,this.__com_eteks_sweethome3d_viewcontroller_PlanController_viewFactory,this.__com_eteks_sweethome3d_viewcontroller_PlanController_contentManager,this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport).displayView(this.getView())},t.prototype.createDimensionLine$float$float=function(e,t){new DimensionLineController(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home,e,t,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,this.__com_eteks_sweethome3d_viewcontroller_PlanController_viewFactory,this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport).displayView(this.getView())},t.prototype.createLabel=function(e,t){new LabelController(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home,e,t,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,this.__com_eteks_sweethome3d_viewcontroller_PlanController_viewFactory,this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport).displayView(this.getView())},t.prototype.modifySelectedLabels=function(){0!=Home.getLabelsSubList(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()).length&&new LabelController(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,this.__com_eteks_sweethome3d_viewcontroller_PlanController_viewFactory,this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport).displayView(this.getView())},t.prototype.modifySelectedPolylines=function(){0!=Home.getPolylinesSubList(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()).length&&new PolylineController(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,this.__com_eteks_sweethome3d_viewcontroller_PlanController_viewFactory,this.__com_eteks_sweethome3d_viewcontroller_PlanController_contentManager,this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport).displayView(this.getView())},t.prototype.modifySelectedDimensionLines=function(){0!=Home.getDimensionLinesSubList(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()).length&&new DimensionLineController(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,this.__com_eteks_sweethome3d_viewcontroller_PlanController_viewFactory,this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport).displayView(this.getView())},t.prototype.modifyCompass=function(){new CompassController(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,this.__com_eteks_sweethome3d_viewcontroller_PlanController_viewFactory,this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport).displayView(this.getView())},t.prototype.modifyObserverCamera=function(){new ObserverCameraController(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,this.__com_eteks_sweethome3d_viewcontroller_PlanController_viewFactory).displayView(this.getView())},t.prototype.toggleBoldStyle=function(){for(var e=null,t=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems(),i=0;i<t.length;i++){var n=void 0;if(null!=(s=t[i])&&s instanceof Label)n=this.getItemTextStyle(s,s.getStyle()).isBold();else if(null!=s&&s instanceof HomePieceOfFurniture&&s.isVisible())n=this.getItemTextStyle(s,s.getNameStyle()).isBold();else if(null!=s&&s instanceof Room){var o=s;(n=this.getItemTextStyle(o,o.getNameStyle()).isBold())!==this.getItemTextStyle(o,o.getAreaStyle()).isBold()&&(n=null)}else{if(!(null!=s&&s instanceof DimensionLine))continue;n=this.getItemTextStyle(s,s.getLengthStyle()).isBold()}if(null==e)e=n;else if(null==n||e!==n){e=null;break}}e=null==e||!e;var r=[],l=[],a=[];for(t=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems(),i=0;i<t.length;i++){var s;if(null!=(s=t[i])&&s instanceof Label){var h=s;r.push(h);var u=this.getItemTextStyle(h,h.getStyle());l.push(u),a.push(u.deriveBoldStyle(e))}else if(null!=s&&s instanceof HomePieceOfFurniture){var d=s;if(d.isVisible()){r.push(d);var c=this.getItemTextStyle(d,d.getNameStyle());l.push(c),a.push(c.deriveBoldStyle(e))}}else if(null!=s&&s instanceof Room){o=s;r.push(o);c=this.getItemTextStyle(o,o.getNameStyle());l.push(c),a.push(c.deriveBoldStyle(e));var p=this.getItemTextStyle(o,o.getAreaStyle());l.push(p),a.push(p.deriveBoldStyle(e))}else if(null!=s&&s instanceof DimensionLine){var g=s;r.push(g);var m=this.getItemTextStyle(g,g.getLengthStyle());l.push(m),a.push(m.deriveBoldStyle(e))}}this.modifyTextStyle(r.slice(0),l.slice(0),a.slice(0))},t.prototype.getItemTextStyle=function(e,t){return null==t&&(t=this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getDefaultTextStyle(e.constructor)),t},t.prototype.toggleItalicStyle=function(){for(var e=null,t=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems(),i=0;i<t.length;i++){var n=void 0;if(null!=(s=t[i])&&s instanceof Label)n=this.getItemTextStyle(s,s.getStyle()).isItalic();else if(null!=s&&s instanceof HomePieceOfFurniture&&s.isVisible())n=this.getItemTextStyle(s,s.getNameStyle()).isItalic();else if(null!=s&&s instanceof Room){var o=s;(n=this.getItemTextStyle(o,o.getNameStyle()).isItalic())!==this.getItemTextStyle(o,o.getAreaStyle()).isItalic()&&(n=null)}else{if(!(null!=s&&s instanceof DimensionLine))continue;n=this.getItemTextStyle(s,s.getLengthStyle()).isItalic()}if(null==e)e=n;else if(null==n||e!==n){e=null;break}}e=null==e||!e;var r=[],l=[],a=[];for(t=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems(),i=0;i<t.length;i++){var s;if(null!=(s=t[i])&&s instanceof Label){var h=s;r.push(h);var u=this.getItemTextStyle(h,h.getStyle());l.push(u),a.push(u.deriveItalicStyle(e))}else if(null!=s&&s instanceof HomePieceOfFurniture){var d=s;if(d.isVisible()){r.push(d);var c=this.getItemTextStyle(d,d.getNameStyle());l.push(c),a.push(c.deriveItalicStyle(e))}}else if(null!=s&&s instanceof Room){o=s;r.push(o);c=this.getItemTextStyle(o,o.getNameStyle());l.push(c),a.push(c.deriveItalicStyle(e));var p=this.getItemTextStyle(o,o.getAreaStyle());l.push(p),a.push(p.deriveItalicStyle(e))}else if(null!=s&&s instanceof DimensionLine){var g=s;r.push(g);var m=this.getItemTextStyle(g,g.getLengthStyle());l.push(m),a.push(m.deriveItalicStyle(e))}}this.modifyTextStyle(r.slice(0),l.slice(0),a.slice(0))},t.prototype.increaseTextSize=function(){this.applyFactorToTextSize(1.1)},t.prototype.decreaseTextSize=function(){this.applyFactorToTextSize(1/1.1)},t.prototype.applyFactorToTextSize=function(e){for(var t=[],i=[],n=[],o=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems(),r=0;r<o.length;r++){var l=o[r];if(null!=l&&l instanceof Label){var a=l;t.push(a);var s=this.getItemTextStyle(l,a.getStyle());i.push(s),n.push(s.deriveStyle$float(Math.round(s.getFontSize()*e)))}else if(null!=l&&l instanceof HomePieceOfFurniture){var h=l;if(h.isVisible()){t.push(h);var u=this.getItemTextStyle(h,h.getNameStyle());i.push(u),n.push(u.deriveStyle$float(Math.round(u.getFontSize()*e)))}}else if(null!=l&&l instanceof Room){var d=l;t.push(d);u=this.getItemTextStyle(d,d.getNameStyle());i.push(u),n.push(u.deriveStyle$float(Math.round(u.getFontSize()*e)));var c=this.getItemTextStyle(d,d.getAreaStyle());i.push(c),n.push(c.deriveStyle$float(Math.round(c.getFontSize()*e)))}else if(null!=l&&l instanceof DimensionLine){var p=l;t.push(p);var g=this.getItemTextStyle(p,p.getLengthStyle());i.push(g),n.push(g.deriveStyle$float(Math.round(g.getFontSize()*e)))}}this.modifyTextStyle(t.slice(0),i.slice(0),n.slice(0))},t.prototype.modifyTextStyle=function(e,i,n){var o=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection(),r=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems().slice(0);t.doModifyTextStyle(e,n),this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new t.TextStyleModificationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,r,o,i,e,n))},t.doModifyTextStyle=function(e,t){for(var i=0,n=0;n<e.length;n++){var o=e[n];if(null!=o&&o instanceof Label)o.setStyle(t[i++]);else if(null!=o&&o instanceof HomePieceOfFurniture){var r=o;r.isVisible()&&r.setNameStyle(t[i++])}else if(null!=o&&o instanceof Room){var l=o;l.setNameStyle(t[i++]),l.setAreaStyle(t[i++])}else null!=o&&o instanceof DimensionLine&&o.setLengthStyle(t[i++])}},t.prototype.getMinimumScale=function(){return.01},t.prototype.getMaximumScale=function(){return 10},t.prototype.getScale=function(){return this.getView().getScale()},t.prototype.setScale=function(e){if((e=Math.max(this.getMinimumScale(),Math.min(e,this.getMaximumScale())))!==this.getView().getScale()){var i=this.getView().getScale();if(this.furnitureSidesCache.entries=[],null!=this.getView()){var n=this.getView().convertXModelToScreen(this.getXLastMouseMove()),o=this.getView().convertXModelToScreen(this.getYLastMouseMove());this.getView().setScale(e),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getObserverCamera().setPlanScale(e<.4?.4/e:1),this.moveMouse(this.getView().convertXPixelToModel(n),this.getView().convertYPixelToModel(o))}this.propertyChangeSupport.firePropertyChange("SCALE",i,e),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setProperty(t.SCALE_VISUAL_PROPERTY,String(e).toString())}},t.prototype.setSelectedLevel=function(e){this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setSelectedLevel(e)},t.prototype.selectAll=function(){var e=this.getVisibleItemsAtSelectedLevel();this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked()?this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setSelectedItems(this.getItemsNotPartOfBasePlan(e)):this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setSelectedItems(e),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setAllLevelsSelection(!1)},t.prototype.getVisibleItemsAtSelectedLevel=function(){for(var e=[],t=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel(),i=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectableViewableItems(),n=0;n<i.length;n++){var o=i[n];null!=o&&o instanceof HomePieceOfFurniture?this.isPieceOfFurnitureVisibleAtSelectedLevel(o)&&e.push(o):null!=o&&null!=o.constructor&&null!=o.constructor.__interfaces&&o.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Elevatable")>=0&&!o.isAtLevel(t)||e.push(o)}return e},t.prototype.selectAllAtAllLevels=function(){var e=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectableViewableItems().slice(0);this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked()&&(e=this.getItemsNotPartOfBasePlan(e)),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setSelectedItems(e),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setAllLevelsSelection(!0)},t.prototype.getDetectableRoomsAtSelectedLevel=function(){var e=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getRooms(),t=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel(),i=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getLevels();if(null==t||i.length<=1)return e;for(var n=[],o=i.indexOf(t),r=i[0]===t||i[o-1].getElevation()===t.getElevation(),l=i[r&&o<i.length-1?o+1:o-1],a=0;a<e.length;a++){var s=e[a];(s.isAtLevel(t)||null!=l&&s.isAtLevel(l)&&(r&&s.isFloorVisible()||!r&&s.isCeilingVisible()))&&n.push(s)}return n},t.prototype.getDetectableWallsAtSelectedLevel=function(){var e=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getWalls(),t=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel(),i=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getLevels();if(null==t||i.length<=1)return e;for(var n=[],o=i.indexOf(t),r=i[0]===t||i[o-1].getElevation()===t.getElevation(),l=i[r&&o<i.length-1?o+1:o-1],a=0;a<e.length;a++){var s=e[a];(s.isAtLevel(t)||null!=l&&s.isAtLevel(l))&&n.push(s)}return n},t.prototype.getHorizontalRulerView=function(){return this.getView().getHorizontalRuler()},t.prototype.getVerticalRulerView=function(){return this.getView().getVerticalRuler()},t.prototype.__com_eteks_sweethome3d_viewcontroller_PlanController_addModelListeners=function(){var e=this;this.selectionListener=new t.PlanController$1(this),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addSelectionListener(this.selectionListener),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getObserverCamera().addPropertyChangeListener(new t.PlanController$2(this)),this.wallChangeListener=new t.PlanController$3(this);for(var i=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getWalls(),n=0;n<i.length;n++){i[n].addPropertyChangeListener(this.wallChangeListener)}this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addWallsListener((function(t){t.getType()===CollectionEvent.Type.ADD?t.getItem().addPropertyChangeListener(e.wallChangeListener):t.getType()===CollectionEvent.Type.DELETE&&t.getItem().removePropertyChangeListener(e.wallChangeListener),e.resetAreaCache()}));var o=new t.PlanController$4(this);this.furnitureSizeChangeListener=new t.PlanController$5(this);for(i=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getFurniture(),n=0;n<i.length;n++){var r=i[n];if(r.addPropertyChangeListener(o),r.addPropertyChangeListener(this.furnitureSizeChangeListener),null!=r&&r instanceof HomeFurnitureGroup)for(var l=r.getAllFurniture(),a=0;a<l.length;a++){l[a].addPropertyChangeListener(this.furnitureSizeChangeListener)}}this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addFurnitureListener((function(t){var i=t.getItem();if(t.getType()===CollectionEvent.Type.ADD){if(i.addPropertyChangeListener(o),i.addPropertyChangeListener(e.furnitureSizeChangeListener),null!=i&&i instanceof HomeFurnitureGroup)for(var n=i.getAllFurniture(),r=0;r<n.length;r++){n[r].addPropertyChangeListener(e.furnitureSizeChangeListener)}}else if(t.getType()===CollectionEvent.Type.DELETE&&(i.removePropertyChangeListener(o),function(e,t){null==e.entries&&(e.entries=[]);for(var i=0;i<e.entries.length;i++)if(null==e.entries[i].key&&null==t||null!=e.entries[i].key.equals&&e.entries[i].key.equals(t)||e.entries[i].key===t)return e.entries.splice(i,1)[0]}(e.furnitureSidesCache,i),i.removePropertyChangeListener(e.furnitureSizeChangeListener),null!=i&&i instanceof HomeFurnitureGroup))for(n=i.getAllFurniture(),r=0;r<n.length;r++){n[r].removePropertyChangeListener(e.furnitureSizeChangeListener)}})),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addPropertyChangeListener("SELECTED_LEVEL",new t.PlanController$6(this)),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getObserverCamera().setFixedSize(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getLevels().length>=2),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addLevelsListener((function(t){e.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getObserverCamera().setFixedSize(e.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getLevels().length>=2)}))},t.prototype.getSelectionListener=function(){return this.selectionListener},t.prototype.resetAreaCache=function(){this.wallsAreaCache=null,this.wallsIncludingBaseboardsAreaCache=null,this.insideWallsAreaCache=null,this.roomPathsCache=null},t.prototype.startDraggedItems=function(e,t,i){if(this.draggedItems=e,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())for(var n=Home.getFurnitureSubList(e),o=0;o<n.length;o++){var r=n[o];r.isResizable()&&(r.setWidth(this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMagnetizedLength(r.getWidth(),.1)),r.setWidthInPlan(r.getWidth()),r.setDepth(this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMagnetizedLength(r.getDepth(),.1)),r.setDepthInPlan(r.getDepth()),r.setHeight(this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMagnetizedLength(r.getHeight(),.1)),r.setHeightInPlan(r.getHeight())),r.setElevation(this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMagnetizedLength(r.getElevation(),.1))}this.isModificationState()&&this.escape(),this.setState(this.getDragAndDropState()),this.moveMouse(t,i)},t.prototype.stopDraggedItems=function(){if(this.state!==this.getDragAndDropState())throw new IllegalStateException("Controller isn't in a drag and drop state");this.draggedItems=null,this.setState(this.previousState)},t.prototype.adjustMagnetizedPieceOfFurniture=function(e,t,i){var n=null!=this.adjustPieceOfFurnitureElevation(e,!1,34028235e31),o=this.adjustPieceOfFurnitureOnWallAt(e,t,i,!0),r=null;n||(r=this.adjustPieceOfFurnitureSideBySideAt(e,null==o,o)),null==r&&this.adjustPieceOfFurnitureInShelfBox(e,null==o)},t.prototype.adjustPieceOfFurnitureOnWallAt=function(e,i,n,o){var r,l=t.PIXEL_MARGIN/this.getScale(),a=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel(),s=e.getPoints(),h=!e.isDoorOrWindow()&&0===e.getElevation(),u=this.getWallsArea(h),d=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getWalls(),c=null,p=null;if(o||!e.isDoorOrWindow()){for(var g=0;g<d.length;g++){if((v=d[g]).isAtLevel(a)&&this.isLevelNullOrViewable(v.getLevel())&&v.containsPoint$float$float$boolean$float(i,n,h,0)&&v.getStartPointToEndPointDistance()>0){c=this.getReferenceWall(v,i,n),p=v.getArcExtent();break}}if(null==c)for(g=0;g<d.length;g++){if((v=d[g]).isAtLevel(a)&&this.isLevelNullOrViewable(v.getLevel())&&v.containsPoint$float$float$boolean$float(i,n,h,0)&&v.getStartPointToEndPointDistance()>0){c=this.getReferenceWall(v,i,n),p=v.getArcExtent();break}}}if(null==c){var m=new java.awt.geom.Area(this.getRotatedRectangle(e.getX()-e.getWidthInPlan()/2-l,e.getY()-e.getDepthInPlan()/2-l,e.getWidthInPlan()+2*l,e.getDepthInPlan()+2*l,e.getAngle())),f=0;for(g=0;g<d.length;g++){var v;if((v=d[g]).isAtLevel(a)&&this.isLevelNullOrViewable(v.getLevel())&&v.getStartPointToEndPointDistance()>0){var _=v.getPoints$boolean(h),S=new java.awt.geom.Area(this.getPath$float_A_A(_));if(S.intersect(m),!S.isEmpty()){var y=this.getArea(S);if(y>f)if(f=y,o)c=this.getReferenceWall(v,i,n),p=v.getArcExtent();else{var E=S.getBounds2D();c=this.getReferenceWall(v,E.getCenterX(),E.getCenterY()),p=v.getArcExtent()}}}}}if(null!=c){var C=i,P=n,w=e.getAngle(),L=e.getWidthInPlan()/2,T=e.getDepthInPlan()/2,A=Math.atan2(c.getYEnd()-c.getYStart(),c.getXEnd()-c.getXStart()),I=(_=c.getPoints$boolean(h),A>-Math.PI/2&&A<=Math.PI/2),b=Math.cos(A),O=Math.sin(A),M=_[0][0]!==_[0][1]||_[1][0]!==_[1][1]?java.awt.geom.Line2D.ptLineDist(_[0][0],_[0][1],_[1][0],_[1][1],i,n):java.awt.geom.Point2D.distance(_[0][0],_[0][1],i,n),D=_[2][0]!==_[2][1]||_[3][0]!==_[3][1]?java.awt.geom.Line2D.ptLineDist(_[2][0],_[2][1],_[3][0],_[3][1],i,n):java.awt.geom.Point2D.distance(_[2][0],_[2][1],i,n),R=o||e.isDoorOrWindow()||c.containsPoint$float$float$boolean$float(i,n,h,l);if(R){var F=java.awt.geom.Line2D.ptLineDist(s[0][0],s[0][1],s[3][0],s[3][1],i,n),x=java.awt.geom.Line2D.ptLineDist(s[1][0],s[1][1],s[2][0],s[2][1],i,n),N=w>3*Math.PI/2+1e-6||w<Math.PI/2+1e-6?F:x;if(w=D<M?A:A+Math.PI,e.isDoorOrWindow()){var k=75e-5,H=void 0;if(null==p||0===p){if(H=k/2,null!=e&&e instanceof HomeDoorOrWindow){var V=e;e.isResizable()&&this.isItemResizable(e)&&V.isWidthDepthDeformable()&&null==V.getModelTransformations()?(e.setDepth(k+c.getThickness()/V.getWallThickness()),e.setDepthInPlan(e.getDepth()),T=e.getDepth()/2,H+=e.getDepth()*V.getWallDistance()):H+=e.getDepth()*(V.getWallDistance()+V.getWallThickness())-c.getThickness()}}else if(H=-c.getThickness()/2,null!=e&&e instanceof HomeDoorOrWindow){V=e;H+=e.getDepth()*(V.getWallDistance()+V.getWallThickness()/2)}D<M?(C+=O*(M+H-T),P+=b*(-(M+H)+T)):(C+=O*(-(D+H)+T),P+=b*(D+H-T)),I?(C+=b*(L-N),P+=O*(L-N)):(C+=-b*(L-N),P+=-O*(L-N))}else{var U;if(D<M)C+=(U=java.awt.geom.Line2D.relativeCCW(_[2][0],_[2][1],_[3][0],_[3][1],i,n))*O*D-O*T,P+=-U*b*D+b*T;else C+=-(U=java.awt.geom.Line2D.relativeCCW(_[0][0],_[0][1],_[1][0],_[1][1],i,n))*O*M+O*T,P+=U*b*M-b*T;I?(C+=b*(L-N),P+=O*(L-N)):(C+=-b*(L-N),P+=-O*(L-N))}}else{var W=new java.awt.geom.Line2D.Float(c.getXStart(),c.getYStart(),c.getXEnd(),c.getYEnd()),B=this.getRotatedRectangle(0,0,e.getWidthInPlan(),e.getDepthInPlan(),w-A).getBounds2D().getHeight(),G=(r=W.relativeCCW(e.getX(),e.getY()))>0?1:r<0?-1:0,Y=function(e){return e>0?1:e<0?-1:0}(W.relativeCCW(i,n)),$=G*(-c.getThickness()/2+W.ptLineDist(e.getX(),e.getY())-B/2);h&&(G>0&&null!=c.getLeftSideBaseboard()?$-=G*c.getLeftSideBaseboard().getThickness():G<0&&null!=c.getRightSideBaseboard()&&($-=G*c.getRightSideBaseboard().getThickness())),Y!==G&&($-=Y*(B+c.getThickness()),null!=c.getLeftSideBaseboard()&&($-=Y*c.getLeftSideBaseboard().getThickness()),null!=c.getRightSideBaseboard()&&($-=Y*c.getRightSideBaseboard().getThickness())),C=e.getX()+-$*O,P=e.getY()+$*b}if(!e.isDoorOrWindow()&&(null==c.getArcExtent()||!R||java.awt.geom.Line2D.relativeCCW(c.getXStart(),c.getYStart(),c.getXEnd(),c.getYEnd(),i,n)>0)){var X=new java.awt.geom.Area(u),z=new java.awt.geom.Area(this.getRotatedRectangle(C-L,P-T,e.getWidthInPlan(),e.getDepthInPlan(),w));if(X.subtract(new java.awt.geom.Area(this.getPath$float_A_A(_))),X.intersect(z),!X.isEmpty()){var j=this.getClosestPath(this.getAreaPaths(X),i,n);if(null!=j){if(z.subtract(u),z.isEmpty())return null;var K=this.getAreaPaths(z),J=(A-w+2*Math.PI)%Math.PI;if(J<1e-5||Math.PI-J<1e-5||K.length<2){var q=this.getClosestPath(K,i,n),Z=new java.awt.geom.Area(j);for(g=0;g<K.length;g++){var Q=K[g];Q!==q&&Z.add(new java.awt.geom.Area(Q))}var ee=java.awt.geom.AffineTransform.getRotateInstance(-A),te=Z.createTransformedArea(ee).getBounds2D(),ie=q.createTransformedShape(ee).getBounds2D();if(!te.contains(ie)){var ne=function(e){return e>0?1:e<0?-1:0}(ie.getCenterX()-te.getCenterX());C+=te.getWidth()*b*ne,P+=te.getWidth()*O*ne}}}}}return e.setAngle(w),e.setX(C),e.setY(P),null!=e&&e instanceof HomeDoorOrWindow&&e.setBoundToWall(null==p||0===p),c}return null},t.prototype.isLevelNullOrViewable=function(e){return null==e||e.isViewable()},t.prototype.getReferenceWall=function(e,t,i){var n=e.getArcExtent();if(null==n||0===n)return e;var o=Math.atan2(e.getYArcCircleCenter()-i,t-e.getXArcCircleCenter()),r=java.awt.geom.Point2D.distance(e.getXArcCircleCenter(),e.getYArcCircleCenter(),e.getXStart(),e.getYStart()),l=.001,a=new Wall(e.getXArcCircleCenter()+Math.cos(o+l)*r,e.getYArcCircleCenter()-Math.sin(o+l)*r,e.getXArcCircleCenter()+Math.cos(o-l)*r,e.getYArcCircleCenter()-Math.sin(o-l)*r,e.getThickness(),0);return a.setLeftSideBaseboard(e.getLeftSideBaseboard()),a.setRightSideBaseboard(e.getRightSideBaseboard()),a},t.prototype.getClosestPath=function(e,t,i){for(var n=null,o=17976931348623157e292,r=0;r<e.length;r++)for(var l=e[r],a=this.getPathPoints(l,!0),s=0;s<a.length;s++){var h=java.awt.geom.Line2D.ptSegDistSq(a[s][0],a[s][1],a[(s+1)%a.length][0],a[(s+1)%a.length][1],t,i);h<o&&(o=h,n=l)}return n},t.prototype.getDimensionLinesAlongWall=function(e,i){var n,o,r=e.getPoints(),l=e.getAngle(),a=i.getPoints$(),s=e.isDoorOrWindow()?r[3]:r[0];java.awt.geom.Line2D.ptLineDistSq(a[0][0],a[0][1],a[1][0],a[1][1],s[0],s[1])<=java.awt.geom.Line2D.ptLineDistSq(a[2][0],a[2][1],a[3][0],a[3][1],s[0],s[1])?(n=t.computeIntersection$float_A$float_A$float_A$float_A(a[0],a[1],r[0],r[3]),o=t.computeIntersection$float_A$float_A$float_A$float_A(a[0],a[1],r[1],r[2])):(n=t.computeIntersection$float_A$float_A$float_A$float_A(a[2],a[3],r[0],r[3]),o=t.computeIntersection$float_A$float_A$float_A$float_A(a[2],a[3],r[1],r[2]));for(var h=[],u=null,d=null,c=this.getRoomPathsFromWalls(),p=0;p<c.length&&null==u&&null==d;p++)for(var g=this.getPathPoints(c[p],!0),m=0;m<g.length;m++){var f=g[m],v=g[(m+1)%g.length],_=v[0]-f[0],S=v[1]-f[1],y=((Math.abs(_)<1e-5?Math.PI/2:Math.abs(S)<1e-5?0:Math.atan2(S,_))-l+2*Math.PI)%Math.PI;if(y<1e-5||Math.PI-y<1e-5){var E=java.awt.geom.Line2D.ptSegDistSq(f[0],f[1],v[0],v[1],n[0],n[1])<1e-4,C=java.awt.geom.Line2D.ptSegDistSq(f[0],f[1],v[0],v[1],o[0],o[1])<1e-4;if(E||C){if(E)u=java.awt.geom.Point2D.distanceSq(f[0],f[1],n[0],n[1])<java.awt.geom.Point2D.distanceSq(f[0],f[1],o[0],o[1])||!C?f.slice(0):v.slice(0);if(C)d=java.awt.geom.Point2D.distanceSq(v[0],v[1],n[0],n[1])<java.awt.geom.Point2D.distanceSq(v[0],v[1],o[0],o[1])&&E?f.slice(0):v.slice(0);break}}}var P=!e.isDoorOrWindow()&&java.awt.geom.Line2D.ptLineDistSq(i.getXStart(),i.getYStart(),i.getXEnd(),i.getYEnd(),s[0],s[1])>java.awt.geom.Line2D.ptLineDistSq(i.getXStart(),i.getYStart(),i.getXEnd(),i.getYEnd(),r[3][0],r[3][1]);if(null!=u){var w=void 0;w=P?-java.awt.geom.Point2D.distance(n[0],n[1],r[0][0],r[0][1])-10/this.getView().getScale():java.awt.geom.Point2D.distance(n[0],n[1],r[3][0],r[3][1])+10/this.getView().getScale(),h.push(this.getDimensionLineBetweenPoints$float_A$float_A$float$double$boolean(u,n,w,0,!1))}if(null!=d){w=void 0;w=P?-java.awt.geom.Point2D.distance(o[0],o[1],r[1][0],r[1][1])-10/this.getView().getScale():java.awt.geom.Point2D.distance(o[0],o[1],r[2][0],r[2][1])+10/this.getView().getScale(),h.push(this.getDimensionLineBetweenPoints$float_A$float_A$float$double$boolean(o,d,w,0,!1))}for(p=h.length-1;p>=0;p--)h[p].getLength()<.01&&h.splice(p,1)[0];return h},t.computeIntersection$float_A$float_A$float_A$float_A=function(e,i,n,o){return t.computeIntersection$float$float$float$float$float$float$float$float(e[0],e[1],i[0],i[1],n[0],n[1],o[0],o[1])},t.computeIntersection$float$float$float$float$float$float$float$float=function(e,t,i,n,o,r,l,a){var s,h=i,u=n,d=(n-t)/(i-e),c=(a-r)/(l-o);if(d!==c)if(Math.abs(d)>4e3)Math.abs(c)<4e3&&(u=c*(h=e)+(a-c*l));else if(Math.abs(c)>4e3){if(Math.abs(d)<4e3)u=d*(h=o)+(p=n-d*i)}else{var p,g=((s=d)>0?1:s<0?-1:0)===function(e){return e>0?1:e<0?-1:0}(c);if(Math.abs(d-c)>1e-5&&(!g||(Math.abs(d)>Math.abs(c)?d/c:c/d)>1.004))u=d*(h=(a-c*l-(p=n-d*i))/(d-c))+p}return[h,u]},t.computeIntersection=function(e,i,n,o,r,l,a,s){if("number"!=typeof e&&null!==e||"number"!=typeof i&&null!==i||"number"!=typeof n&&null!==n||"number"!=typeof o&&null!==o||"number"!=typeof r&&null!==r||"number"!=typeof l&&null!==l||"number"!=typeof a&&null!==a||"number"!=typeof s&&null!==s){if((null!=e&&e instanceof Array&&(0==e.length||null==e[0]||"number"==typeof e[0])||null===e)&&(null!=i&&i instanceof Array&&(0==i.length||null==i[0]||"number"==typeof i[0])||null===i)&&(null!=n&&n instanceof Array&&(0==n.length||null==n[0]||"number"==typeof n[0])||null===n)&&(null!=o&&o instanceof Array&&(0==o.length||null==o[0]||"number"==typeof o[0])||null===o)&&void 0===r&&void 0===l&&void 0===a&&void 0===s)return t.computeIntersection$float_A$float_A$float_A$float_A(e,i,n,o);throw new Error("invalid overload")}return t.computeIntersection$float$float$float$float$float$float$float$float(e,i,n,o,r,l,a,s)},t.prototype.adjustPieceOfFurnitureElevation=function(e,t,i){if(!t||!e.isDoorOrWindow()&&0===e.getElevation()){var n=34028235e31,o=e.getElevation(),r=o,l=void 0;if(t||0===e.getElevation()){var a=this.getHighestSurroundingPieceOfFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture(e);if(null==a)return null;l=[a]}else{l=this.getSurroundingFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture(e);for(var s=!1,h=0;h<l.length;h++){null!=(u=l[h])&&u instanceof HomeShelfUnit&&(s=!0)}if(!s)return null}for(h=0;h<l.length;h++){var u=l[h],d=[];if(!t&&null!=u&&u instanceof HomeShelfUnit&&!u.isHorizontallyRotated()){var c=u,p=c.getShelfBoxes();if(p.length>0){d=function(e){for(var t=[];e-- >0;)t.push(0);return t}(p.length);for(var g=0;g<d.length;g++)d[g]=p[g].getZLower()}else d=c.getShelfElevations()}if((0===d.length||0!==d[0]&&0===e.getElevation())&&(d=[u.getDropOnTopElevation()]),0!==d.length)for(var m=0;m<d.length;m++){var f=d[m],v=u.getElevation();u.isHorizontallyRotated()?v+=u.getHeightInPlan():v+=u.getHeight()*f,null!=u.getLevel()&&(v+=u.getLevel().getElevation()-(null!=e.getLevel()?e.getLevel().getElevation():this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel().getElevation()));var _=Math.abs(o-v);n>_&&(n=_,r=v)}}if(r!==o&&Math.abs(r-o)<i)return e.setElevation(r),e}return null},t.prototype.adjustPieceOfFurnitureSideBySideAt=function(e,i,n){for(var o=e.getPoints(),r=new java.awt.geom.Area(this.getPath$float_A_A(o)),l=null!=e&&e instanceof HomeDoorOrWindow&&e.isBoundToWall(),a=e.getGroundElevation(),s=2*t.PIXEL_MARGIN/this.getScale(),h=null,u=null,d=0,c=null,p=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getFurniture(),g=0;g<p.length;g++){var m=p[g],f=m.getGroundElevation();if(m!==e&&this.isPieceOfFurnitureVisibleAtSelectedLevel(m)&&a<f+m.getHeightInPlan()&&a+e.getHeightInPlan()>f&&(!l||m.isDoorOrWindow())){var v=m.getPoints(),_=void 0;if(l&&m.isDoorOrWindow())(_=new java.awt.geom.Area(this.getPath$float_A_A(new Wall(v[1][0],v[1][1],v[2][0],v[2][1],s,0).getPoints$()))).add(new java.awt.geom.Area(this.getPath$float_A_A(new Wall(v[3][0],v[3][1],v[0][0],v[0][1],s,0).getPoints$())));else if(null==(_=function(e,t){null==e.entries&&(e.entries=[]);for(var i=0;i<e.entries.length;i++)if(null==e.entries[i].key&&null==t||null!=e.entries[i].key.equals&&e.entries[i].key.equals(t)||e.entries[i].key===t)return e.entries[i].value;return null}(this.furnitureSidesCache,m))){for(var S=function(e){for(var t=[];e-- >0;)t.push(null);return t}(v.length),y=0;y<S.length;y++)S[y]=new Wall(v[y][0],v[y][1],v[(y+1)%S.length][0],v[(y+1)%S.length][1],s,0);for(y=0;y<S.length;y++)S[(y+1)%S.length].setWallAtStart(S[y]),S[y].setWallAtEnd(S[(y+1)%S.length]);var E=function(e){for(var t=[];e-- >0;)t.push(null);return t}(2*S.length+2),C=null;for(y=0;y<S.length;y++)C=S[y].getPoints$(),E[y]=C[0],E[E.length-y-1]=C[3];E[(E.length/2|0)-1]=C[1],E[E.length/2|0]=C[2],_=new java.awt.geom.Area(this.getPath$float_A_A(E)),function(e,t,i){null==e.entries&&(e.entries=[]);for(var n=0;n<e.entries.length;n++)if(null==e.entries[n].key&&null==t||null!=e.entries[n].key.equals&&e.entries[n].key.equals(t)||e.entries[n].key===t)return void(e.entries[n].value=i);e.entries.push({key:t,value:i,getKey:function(){return this.key},getValue:function(){return this.value}})}(this.furnitureSidesCache,m,_)}var P=new java.awt.geom.Area(_);if(P.intersect(r),!P.isEmpty()){var w=new java.awt.geom.Area(r);if(w.exclusiveOr(P),w.isSingular()){var L=new java.awt.geom.Area(this.getPath$float_A_A(v));if(L.subtract(_),L.intersect(r),L.isEmpty()){var T=this.getArea(P);T>d&&(d=T,h=m,c=v,u=P)}}}}}if(null!=h){var A=void 0;if(l&&h.isDoorOrWindow())A=!1;else{var I=this.getRotatedRectangle(h.getX()-h.getWidthInPlan(),h.getY()-h.getDepthInPlan(),2*h.getWidthInPlan(),2*h.getDepthInPlan(),h.getAngle()),b=this.getPathPoints(I,!1);A=this.isAreaLargerOnFrontOrBackSide(u,b)}i&&e.setAngle(h.getAngle());var O=this.getRotatedRectangle(0,0,e.getWidthInPlan(),e.getDepthInPlan(),e.getAngle()-h.getAngle()),M=0,D=0;if(A){F=new java.awt.geom.Line2D.Float(h.getX(),h.getY(),(c[2][0]+c[1][0])/2,(c[2][1]+c[1][1])/2);var R=O.getBounds2D().getHeight();M=-(H=F.relativeCCW(e.getX(),e.getY())*(-h.getDepthInPlan()/2+F.ptLineDist(e.getX(),e.getY())-R/2))*Math.sin(h.getAngle()),D=H*Math.cos(h.getAngle()),this.isIntersectionEmpty$com_eteks_sweethome3d_model_HomePieceOfFurniture$com_eteks_sweethome3d_model_Wall$float$float(e,n,M,D)||(M=D=0)}else{var F=new java.awt.geom.Line2D.Float(h.getX(),h.getY(),(c[0][0]+c[1][0])/2,(c[0][1]+c[1][1])/2),x=O.getBounds2D().getWidth();M=(H=F.relativeCCW(e.getX(),e.getY())*(-h.getWidthInPlan()/2+F.ptLineDist(e.getX(),e.getY())-x/2))*Math.cos(h.getAngle()),D=H*Math.sin(h.getAngle())}if(!this.isIntersectionEmpty$com_eteks_sweethome3d_model_HomePieceOfFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture$float$float(e,h,M,D))return e.move(M,D),h;i&&(o=e.getPoints());var N=this.isAreaLargerOnFrontOrBackSide(u,o),k=this.getRotatedRectangle(0,0,h.getWidthInPlan(),h.getDepthInPlan(),h.getAngle()-e.getAngle());if(N){F=new java.awt.geom.Line2D.Float(e.getX(),e.getY(),(o[2][0]+o[1][0])/2,(o[2][1]+o[1][1])/2),R=k.getBounds2D().getHeight();M=- -(H=F.relativeCCW(h.getX(),h.getY())*(-e.getDepthInPlan()/2+F.ptLineDist(h.getX(),h.getY())-R/2))*Math.sin(e.getAngle()),D=-H*Math.cos(e.getAngle()),this.isIntersectionEmpty$com_eteks_sweethome3d_model_HomePieceOfFurniture$com_eteks_sweethome3d_model_Wall$float$float(e,n,M,D)||(M=D=0)}else{var H,F=new java.awt.geom.Line2D.Float(e.getX(),e.getY(),(o[0][0]+o[1][0])/2,(o[0][1]+o[1][1])/2);x=k.getBounds2D().getWidth();M=-(H=F.relativeCCW(h.getX(),h.getY())*(-e.getWidthInPlan()/2+F.ptLineDist(h.getX(),h.getY())-x/2))*Math.cos(e.getAngle()),D=-H*Math.sin(e.getAngle())}if(!this.isIntersectionEmpty$com_eteks_sweethome3d_model_HomePieceOfFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture$float$float(e,h,M,D))return e.move(M,D),h}return null},t.prototype.adjustPieceOfFurnitureInShelfBox=function(e,t){for(var i=e.getGroundElevation(),n=e.getPoints(),o=null,r=0,l=null,a=null,s=this.getSurroundingFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture(e),h=0,u=0;u<s.length;u++){var d=s[u];if(null!=d&&d instanceof HomeShelfUnit&&!d.isHorizontallyRotated())for(var c=d,p=c.getGroundElevation(),g=c.getShelfBoxes(),m=0;m<g.length;m++){var f=g[m];if(Math.abs(p+f.getZLower()*c.getHeight()-i)<.1){var v=[new java.awt.geom.Point2D.Float(f.getXLower()*c.getWidth(),(1-f.getYUpper())*c.getDepth()),new java.awt.geom.Point2D.Float(f.getXUpper()*c.getWidth(),(1-f.getYUpper())*c.getDepth()),new java.awt.geom.Point2D.Float(f.getXUpper()*c.getWidth(),(1-f.getYLower())*c.getDepth()),new java.awt.geom.Point2D.Float(f.getXLower()*c.getWidth(),(1-f.getYLower())*c.getDepth())],_=java.awt.geom.AffineTransform.getTranslateInstance(c.getX()-c.getWidth()/2,c.getY()-c.getDepth()/2);_.concatenate(java.awt.geom.AffineTransform.getRotateInstance(c.getAngle(),c.getWidth()/2,c.getDepth()/2)),c.isModelMirrored()&&_.concatenate(new java.awt.geom.AffineTransform(-1,0,0,1,c.getWidth(),0));for(var S=0;S<v.length;S++)_.transform(v[S],v[S]);var y=new java.awt.geom.GeneralPath;y.moveTo(v[0].getX(),v[0].getY()),y.lineTo(v[1].getX(),v[1].getY()),y.lineTo(v[2].getX(),v[2].getY()),y.lineTo(v[3].getX(),v[3].getY()),y.closePath();var E=new java.awt.geom.Area(y);if(null==o&&(o=new java.awt.geom.Area(this.getPath$float_A_A(n))),E.intersect(o),!E.isEmpty()){0===h&&(h=this.getArea(o));var C=h-this.getArea(E);l=c,Math.abs(C)>.01&&C<h/4&&r<C&&(r=C,a=v)}}}}if(t&&null!=l&&(e.setAngle(l.getAngle()),n=e.getPoints()),null!=a){var P=0;for(S=0;S<n.length;S++){if(java.awt.geom.Line2D.relativeCCW(a[0].getX(),a[0].getY(),a[3].getX(),a[3].getY(),n[S][0],n[S][1])===(l.isModelMirrored()?1:-1))(L=java.awt.geom.Line2D.ptLineDistSq(a[0].getX(),a[0].getY(),a[3].getX(),a[3].getY(),n[S][0],n[S][1]))>P&&(P=L)}if(P>0)P=Math.sqrt(P)*(l.isModelMirrored()?-1:1),e.move(P*Math.cos(l.getAngle()),P*Math.sin(l.getAngle()));else{for(S=0;S<n.length;S++){if(java.awt.geom.Line2D.relativeCCW(a[1].getX(),a[1].getY(),a[2].getX(),a[2].getY(),n[S][0],n[S][1])===(l.isModelMirrored()?-1:1))(L=java.awt.geom.Line2D.ptLineDistSq(a[1].getX(),a[1].getY(),a[2].getX(),a[2].getY(),n[S][0],n[S][1]))>P&&(P=L)}P>0&&(P=Math.sqrt(P)*(l.isModelMirrored()?1:-1),e.move(P*Math.cos(l.getAngle()),P*Math.sin(l.getAngle())))}var w=0;for(S=0;S<n.length;S++){if(java.awt.geom.Line2D.relativeCCW(a[0].getX(),a[0].getY(),a[1].getX(),a[1].getY(),n[S][0],n[S][1])===(l.isModelMirrored()?-1:1))(L=java.awt.geom.Line2D.ptLineDistSq(a[0].getX(),a[0].getY(),a[1].getX(),a[1].getY(),n[S][0],n[S][1]))>w&&(w=L)}if(w>0)w=Math.sqrt(w),e.move(w*-Math.sin(l.getAngle()),w*Math.cos(l.getAngle()));else{for(S=0;S<n.length;S++){var L;if(java.awt.geom.Line2D.relativeCCW(a[3].getX(),a[3].getY(),a[2].getX(),a[2].getY(),n[S][0],n[S][1])===(l.isModelMirrored()?1:-1))(L=java.awt.geom.Line2D.ptLineDistSq(a[3].getX(),a[3].getY(),a[2].getX(),a[2].getY(),n[S][0],n[S][1]))>w&&(w=L)}w>0&&(w=-Math.sqrt(w),e.move(w*-Math.sin(l.getAngle()),w*Math.cos(l.getAngle())))}return l}return null},t.prototype.isAreaLargerOnFrontOrBackSide=function(e,t){var i=new java.awt.geom.GeneralPath;i.moveTo(t[0][0],t[0][1]),i.lineTo(t[2][0],t[2][1]),i.lineTo(t[3][0],t[3][1]),i.lineTo(t[1][0],t[1][1]),i.closePath();var n=new java.awt.geom.Area(e);if(n.intersect(new java.awt.geom.Area(i)),n.isEmpty())return!1;var o=new java.awt.geom.GeneralPath;o.moveTo(t[0][0],t[0][1]),o.lineTo(t[2][0],t[2][1]),o.lineTo(t[1][0],t[1][1]),o.lineTo(t[3][0],t[3][1]),o.closePath();var r=new java.awt.geom.Area(e);return r.intersect(new java.awt.geom.Area(o)),this.getArea(n)>this.getArea(r)},t.prototype.getArea=function(e){var t=this.getPathPoints(this.getPath$java_awt_geom_Area(e),!1);return t.length>1?new Room(t).getArea():0},t.prototype.isIntersectionEmpty$com_eteks_sweethome3d_model_HomePieceOfFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture$float$float=function(e,t,i,n){var o=new java.awt.geom.Area(this.getRotatedRectangle(e.getX()-e.getWidthInPlan()/2+i,e.getY()-e.getDepthInPlan()/2+n,e.getWidthInPlan(),e.getDepth(),e.getAngle())),r=.01;return o.intersect(new java.awt.geom.Area(this.getRotatedRectangle(t.getX()-t.getWidthInPlan()/2-r,t.getY()-t.getDepthInPlan()/2-r,t.getWidthInPlan()+2*r,t.getDepthInPlan()+2*r,t.getAngle()))),o.isEmpty()},t.prototype.isIntersectionEmpty=function(e,t,i,n){if(!(null!=e&&e instanceof HomePieceOfFurniture||null===e)||!(null!=t&&t instanceof HomePieceOfFurniture||null===t)||"number"!=typeof i&&null!==i||"number"!=typeof n&&null!==n){if(!(null!=e&&e instanceof HomePieceOfFurniture||null===e)||!(null!=t&&t instanceof Wall||null===t)||"number"!=typeof i&&null!==i||"number"!=typeof n&&null!==n)throw new Error("invalid overload");return this.isIntersectionEmpty$com_eteks_sweethome3d_model_HomePieceOfFurniture$com_eteks_sweethome3d_model_Wall$float$float(e,t,i,n)}return this.isIntersectionEmpty$com_eteks_sweethome3d_model_HomePieceOfFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture$float$float(e,t,i,n)},t.prototype.isIntersectionEmpty$com_eteks_sweethome3d_model_HomePieceOfFurniture$com_eteks_sweethome3d_model_Wall$float$float=function(e,t,i,n){if(null!=t){var o=new java.awt.geom.Area(this.getPath$float_A_A(t.getPoints$()));return o.intersect(new java.awt.geom.Area(this.getRotatedRectangle(e.getX()-e.getWidthInPlan()/2+i,e.getY()-e.getDepthInPlan()/2+n,e.getWidthInPlan(),e.getDepthInPlan(),e.getAngle()))),this.getArea(o)<1e-4}return!0},t.prototype.getRotatedRectangle=function(e,t,i,n,o){var r=new java.awt.geom.Rectangle2D.Float(e,t,i,n),l=java.awt.geom.AffineTransform.getRotateInstance(o,e+i/2,t+n/2),a=new java.awt.geom.GeneralPath;return a.append(r.getPathIterator(l),!1),a},t.prototype.getMeasuringDimensionLineAt=function(e,t,i){for(var n=this.getSelectionMargin(),o=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getFurniture(),r=0;r<o.length;r++){var l=o[r];if(this.isPieceOfFurnitureVisibleAtSelectedLevel(l))if(null!=(s=this.getDimensionLineBetweenPointsAt(l.getPoints(),e,t,n,i)))return s}for(o=this.getRoomPathsFromWalls(),r=0;r<o.length;r++){var a=o[r];if(a.intersects(e-n,t-n,2*n,2*n))if(null!=(s=this.getDimensionLineBetweenPointsAt(this.getPathPoints(a,!0),e,t,n,i)))return s}for(o=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getRooms(),r=0;r<o.length;r++){var s,h=o[r];if(this.isLevelNullOrViewable(h.getLevel())&&h.isAtLevel(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel()))if(null!=(s=this.getDimensionLineBetweenPointsAt(h.getPoints(),e,t,n,i)))return s}return null},t.prototype.getDimensionLineBetweenPointsAt=function(e,t,i,n,o){for(var r=0;r<e.length;r++){var l=(r+1)%e.length,a=java.awt.geom.Point2D.distanceSq(e[r][0],e[r][1],e[l][0],e[l][1]);if(a>.01&&java.awt.geom.Line2D.ptSegDistSq(e[r][0],e[r][1],e[l][0],e[l][1],t,i)<=n*n)return this.getDimensionLineBetweenPoints$float_A$float_A$float$double$boolean(e[r],e[l],0,a,o)}return null},t.prototype.getDimensionLineBetweenPoints$float_A$float_A$float$boolean=function(e,t,i,n){return this.getDimensionLineBetweenPoints$float_A$float_A$float$double$boolean(e,t,i,java.awt.geom.Point2D.distanceSq(e[0],e[1],t[0],t[1]),n)},t.prototype.getDimensionLineBetweenPoints$float_A$float_A$float$double$boolean=function(e,t,i,n,o){var r,l,a,s,h=Math.atan2(e[1]-t[1],t[0]-e[0]),u=h<=-Math.PI/2||h>Math.PI/2;if(u?(r=t[0],l=t[1],a=e[0],s=e[1],i=-i):(r=e[0],l=e[1],a=t[0],s=t[1]),o){var d=this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMagnetizedLength(Math.sqrt(n),this.getView().getPixelLength());u?(a=t[0]-d*Math.cos(h),s=t[1]+d*Math.sin(h)):(a=e[0]+d*Math.cos(h),s=e[1]-d*Math.sin(h))}return new DimensionLine(r,l,a,s,i)},t.prototype.getDimensionLineBetweenPoints=function(e,t,i,n,o){if(!(null!=e&&e instanceof Array&&(0==e.length||null==e[0]||"number"==typeof e[0])||null===e)||!(null!=t&&t instanceof Array&&(0==t.length||null==t[0]||"number"==typeof t[0])||null===t)||"number"!=typeof i&&null!==i||"number"!=typeof n&&null!==n||"boolean"!=typeof o&&null!==o){if(!(null!=e&&e instanceof Array&&(0==e.length||null==e[0]||"number"==typeof e[0])||null===e)||!(null!=t&&t instanceof Array&&(0==t.length||null==t[0]||"number"==typeof t[0])||null===t)||"number"!=typeof i&&null!==i||"boolean"!=typeof n&&null!==n||void 0!==o)throw new Error("invalid overload");return this.getDimensionLineBetweenPoints$float_A$float_A$float$boolean(e,t,i,n)}return this.getDimensionLineBetweenPoints$float_A$float_A$float$double$boolean(e,t,i,n,o)},t.prototype.addLevel$=function(){this.addLevel$boolean(!1)},t.prototype.addLevelAtSameElevation=function(){this.addLevel$boolean(!0)},t.prototype.addLevel$boolean=function(e){var i,n=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection(),o=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems().slice(0),r=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel(),l=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getBackgroundImage(),a=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getLevels(),s=this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getNewWallHeight(),h=this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getNewFloorThickness();if(0==a.length){var u=this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(t,"levelName",0);i=this.createLevel(u,0,h,s),this.moveHomeItemsToLevel(i),i.setBackgroundImage(l),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setBackgroundImage(null),a=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getLevels()}else i=null;var d,c=this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(t,"levelName",a.length);if(e){var p=null!=i?i:this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel();d=this.createLevel(c,p.getElevation(),p.getFloorThickness(),p.getHeight())}else{var g=a[a.length-1].getElevation()+s+h;d=this.createLevel(c,g,h,s)}this.setSelectedLevel(d),this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new t.LevelAdditionUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_home,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,o,n,r,i,l,d))},t.prototype.addLevel=function(e){if("boolean"==typeof e||null===e)return this.addLevel$boolean(e);if(void 0===e)return this.addLevel$();throw new Error("invalid overload")},t.prototype.createLevel=function(e,t,i,n){var o=new Level(e,t,i,n);return this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addLevel(o),o},t.prototype.moveHomeItemsToLevel=function(e){for(var t=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getFurniture(),i=0;i<t.length;i++){t[i].setLevel(e)}for(t=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getWalls(),i=0;i<t.length;i++){t[i].setLevel(e)}for(t=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getRooms(),i=0;i<t.length;i++){t[i].setLevel(e)}for(t=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getPolylines(),i=0;i<t.length;i++){t[i].setLevel(e)}for(t=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getDimensionLines(),i=0;i<t.length;i++){t[i].setLevel(e)}for(t=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getLabels(),i=0;i<t.length;i++){t[i].setLevel(e)}},t.prototype.toggleSelectedLevelViewability=function(){var e=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel();e.setViewable(!e.isViewable()),this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new t.LevelViewabilityModificationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,e))},t.prototype.setSelectedLevelOnlyViewable=function(){var e=this.getLevels(!0),i=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel(),n=i.isViewable();1===e.length&&n||(t.setLevelsViewability(e,!1),i.setViewable(!0),this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new t.LevelsViewabilityModificationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,i,n,e)))},t.prototype.setAllLevelsViewable=function(){var e=this.getLevels(!1);if(e.length>0){var i=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel();t.setLevelsViewability(e,!0),this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new t.AllLevelsViewabilityModificationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,i,e))}},t.prototype.getLevels=function(e){for(var t=[],i=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getLevels(),n=0;n<i.length;n++){var o=i[n];o.isViewable()===e&&t.push(o)}return t.slice(0)},t.setLevelsViewability=function(e,t){for(var i=0;i<e.length;i++){e[i].setViewable(t)}},t.prototype.modifySelectedLevel=function(){null!=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel()&&new LevelController(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,this.__com_eteks_sweethome3d_viewcontroller_PlanController_viewFactory,this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport).displayView(this.getView())},t.prototype.deleteSelectedLevel=function(){this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.beginUpdate();for(var e=[],i=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel(),n=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getFurniture(),o=0;o<n.length;o++){var r=n[o];r.getLevel()===i&&e.push(r)}this.deleteFurniture(e);var l=[];this.addLevelItemsAtSelectedLevel(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getWalls(),l),this.addLevelItemsAtSelectedLevel(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getRooms(),l),this.addLevelItemsAtSelectedLevel(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getDimensionLines(),l),this.addLevelItemsAtSelectedLevel(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getLabels(),l),this.postDeleteItems(l,this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked(),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection()),this.doDeleteItems(l),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.deleteLevel(i);var a,s,h,u=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getLevels();1===u.length?(s=(a=u[0]).getElevation(),h=a.isViewable(),a.setElevation(0),a.setViewable(!0)):(a=null,s=null,h=!1),this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new t.LevelDeletionUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_home,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,i,a,s,h)),this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.endUpdate()},t.prototype.addLevelItemsAtSelectedLevel=function(e,t){for(var i=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel(),n=0;n<e.length;n++){var o=e[n];null!=o&&null!=o.constructor&&null!=o.constructor.__interfaces&&o.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Elevatable")>=0&&o.getLevel()===i&&t.push(o)}},t.prototype.createWall=function(e,t,i,n,o,r){var l=new Wall(e,t,i,n,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getNewWallThickness(),this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getNewWallHeight(),this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getNewWallPattern());return this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addWall(l),null!=o?(l.setWallAtStart(o),o.setWallAtStart(l)):null!=r&&(l.setWallAtStart(r),r.setWallAtEnd(l)),l},t.prototype.joinNewWallEndToWall=function(e,t,i){null!=t?(e.setWallAtEnd(t),t.setWallAtStart(e),e.setXEnd(t.getXStart()),e.setYEnd(t.getYStart())):null!=i&&(e.setWallAtEnd(i),i.setWallAtEnd(e),e.setXEnd(i.getXEnd()),e.setYEnd(i.getYEnd()))},t.prototype.getWallStartAt=function(e,i,n){for(var o=t.WALL_ENDS_PIXEL_MARGIN/this.getScale(),r=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getWalls(),l=0;l<r.length;l++){var a=r[l];if(a!==n&&this.isLevelNullOrViewable(a.getLevel())&&a.isAtLevel(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel())&&null==a.getWallAtStart()&&a.containsWallStartAt(e,i,o))return a}return null},t.prototype.getWallEndAt=function(e,i,n){for(var o=t.WALL_ENDS_PIXEL_MARGIN/this.getScale(),r=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getWalls(),l=0;l<r.length;l++){var a=r[l];if(a!==n&&this.isLevelNullOrViewable(a.getLevel())&&a.isAtLevel(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel())&&null==a.getWallAtEnd()&&a.containsWallEndAt(e,i,o))return a}return null},t.prototype.getIndicatorMargin=function(){var e=t.INDICATOR_PIXEL_MARGIN;return this.getPointerTypeLastMousePress()===View.PointerType.TOUCH&&(e*=3),e/this.getScale()},t.prototype.getResizedWallStartAt=function(e,t){var i=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(1===i.length&&null!=i[0]&&i[0]instanceof Wall&&this.isItemResizable(i[0])){var n=i[0],o=this.getIndicatorMargin();if(n.isAtLevel(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel())&&n.containsWallStartAt(e,t,o))return n}return null},t.prototype.getResizedWallEndAt=function(e,t){var i=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(1===i.length&&null!=i[0]&&i[0]instanceof Wall&&this.isItemResizable(i[0])){var n=i[0],o=this.getIndicatorMargin();if(n.isAtLevel(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel())&&n.containsWallEndAt(e,t,o))return n}return null},t.prototype.getArcExtentWallAt=function(e,t){var i=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(1===i.length&&null!=i[0]&&i[0]instanceof Wall&&this.isItemResizable(i[0])){var n=i[0],o=this.getIndicatorMargin();if(n.isAtLevel(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel())&&n.isMiddlePointAt(e,t,o))return n}return null},t.prototype.createRoom=function(e){var t=new Room(e);return t.setFloorColor(this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getNewRoomFloorColor()),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addRoom$com_eteks_sweethome3d_model_Room(t),t},t.prototype.computeRoomPointsAt=function(e,t){for(var i=this.getRoomPathsFromWalls(),n=0;n<i.length;n++){var o=i[n];if(o.contains(e,t)){for(var r=this.getVisibleDoorsAndWindowsAtGround(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getFurniture()),l=0;l<r.length;l++){for(var a=r[l],s=a.getPoints(),h=0,u=0;u<s.length;u++)o.contains(s[u][0],s[u][1])&&h++;if(4===s.length){var d=.05,c=null;if(null!=a&&a instanceof HomeDoorOrWindow&&a.isWallCutOutOnBothSides()){for(var p,g=a,m=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel(),f=new java.awt.geom.Area(this.getPath$float_A_A(s)),v=new java.awt.geom.Area,_=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getWalls(),S=0;S<_.length;S++){var y=_[S];if(y.isAtLevel(m)&&g.isParallelToWall(y)){var E=this.getPath$float_A_A(y.getPoints$()),C=new java.awt.geom.Area(E);if(C.intersect(f),!C.isEmpty()){var P=function(e){if(null!=e.clone)return e.clone();var t=Object.create(e);for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t}(g);P.setDepthInPlan(P.getDepth()+4*y.getThickness()),(C=new java.awt.geom.Area(E)).intersect(new java.awt.geom.Area(this.getPath$float_A_A(P.getPoints()))),v.add(C)}}}if(!v.isEmpty()&&v.isSingular())if(4===(p=this.getPathPoints(this.getPath$java_awt_geom_Area(v),!0)).length){var w=g.getY()+g.getDepth()*(-.5+g.getWallDistance()+g.getWallThickness()/2),L=g.getWidth()/2,T=[g.getX()-L,w,g.getX()+L,w];java.awt.geom.AffineTransform.getRotateInstance(g.getAngle(),g.getX(),g.getY()).transform(T,0,T,0,2);for(u=0;u<p.length-1;u++)if(o.intersects(p[u][0]-d/2,p[u][1]-d/2,d,d)){var A=u,I=void 0,b=void 0;if(o.intersects(p[u+1][0]-d/2,p[u+1][1]-d/2,d,d))b=(u+2)%4,I=(u+3)%4;else{if(!o.intersects(p[(u+3)%4][0]-d/2,p[(u+3)%4][1]-d/2,d,d))break;I=(u+1)%4,b=(u+2)%4}java.awt.geom.Point2D.distanceSq(p[A][0],p[A][1],T[0],T[1])<java.awt.geom.Point2D.distanceSq(p[A][0],p[A][1],T[2],T[3])?(p[I][0]=T[0],p[I][1]=T[1],p[b][0]=T[2],p[b][1]=T[3]):(p[I][0]=T[2],p[I][1]=T[3],p[b][0]=T[0],p[b][1]=T[1]),c=p;break}}}if(null==c&&2===h)if((v=new java.awt.geom.Area(this.getWallsArea(!1))).intersect(new java.awt.geom.Area(this.getPath$float_A_A(s))),4===(p=this.getPathPoints(this.getPath$java_awt_geom_Area(v),!1)).length)for(u=0;u<p.length;u++)if(o.intersects(p[u][0]-d/2,p[u][1]-d/2,d,d)){A=u;var O=void 0;I=void 0,b=void 0;o.intersects(p[u+1][0]-d/2,p[u+1][1]-d/2,d,d)?(O=u+1,b=(u+2)%4,I=(u+3)%4):(I=(u+1)%4,b=(u+2)%4,O=(u+3)%4),p[I][0]=(p[I][0]+p[A][0])/2,p[I][1]=(p[I][1]+p[A][1])/2,p[b][0]=(p[b][0]+p[O][0])/2,p[b][1]=(p[b][1]+p[O][1])/2,c=p;break}if(null!=c){var M=this.getPath$float_A_A(c),D=M.getBounds2D(),R=java.awt.geom.AffineTransform.getTranslateInstance(D.getCenterX(),D.getCenterY()),F=Math.min(D.getWidth(),D.getHeight()),x=(F+d)/F;R.scale(x,x),R.translate(-D.getCenterX(),-D.getCenterY());var N=M.createTransformedShape(R),k=new java.awt.geom.Area(N);k.add(new java.awt.geom.Area(o)),o=this.getPath$java_awt_geom_Area(k)}}}return this.getPathPoints(o,!1)}}return null},t.prototype.getVisibleDoorsAndWindowsAtGround=function(e){for(var t,i,n=[],o=0;o<e.length;o++){var r=e[o];this.isPieceOfFurnitureVisibleAtSelectedLevel(r)&&0===r.getElevation()&&(null!=r&&r instanceof HomeFurnitureGroup?(t=n,i=this.getVisibleDoorsAndWindowsAtGround(r.getFurniture()),t.push.apply(t,i)):r.isDoorOrWindow()&&n.push(r))}return n},t.prototype.getResizedRoomAt=function(e,t){var i=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(1===i.length&&null!=i[0]&&i[0]instanceof Room&&this.isItemResizable(i[0])){var n=i[0],o=this.getIndicatorMargin();if(n.isAtLevel(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel())&&-1!==n.getPointIndexAt(e,t,o))return n}return null},t.prototype.getRoomNameAt=function(e,t){var i=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(1===i.length&&null!=i[0]&&i[0]instanceof Room&&this.isItemMovable(i[0])){var n=i[0],o=this.getIndicatorMargin();if(n.isAtLevel(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel())&&null!=n.getName()&&n.getName().trim().length>0&&n.isNameCenterPointAt(e,t,o))return n}return null},t.prototype.getRoomRotatedNameAt=function(e,t){var i=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(1===i.length&&null!=i[0]&&i[0]instanceof Room&&this.isItemMovable(i[0])){var n=i[0],o=this.getIndicatorMargin();if(n.isAtLevel(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel())&&null!=n.getName()&&n.getName().trim().length>0&&this.isTextAnglePointAt(n,n.getName(),n.getNameStyle(),n.getXCenter()+n.getNameXOffset(),n.getYCenter()+n.getNameYOffset(),n.getNameAngle(),e,t,o))return n}return null},t.prototype.getRoomAreaAt=function(e,t){var i=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(1===i.length&&null!=i[0]&&i[0]instanceof Room&&this.isItemMovable(i[0])){var n=i[0],o=this.getIndicatorMargin();if(n.isAtLevel(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel())&&n.isAreaVisible()&&n.isAreaCenterPointAt(e,t,o))return n}return null},t.prototype.getRoomRotatedAreaAt=function(e,t){var i=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(1===i.length&&null!=i[0]&&i[0]instanceof Room&&this.isItemMovable(i[0])){var n=i[0],o=this.getIndicatorMargin();if(n.isAtLevel(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel())&&n.isAreaVisible()){var r=n.getArea();if(r>.01){var l=this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getAreaFormatWithUnit().format(r);if(this.isTextAnglePointAt(n,l,n.getAreaStyle(),n.getXCenter()+n.getAreaXOffset(),n.getYCenter()+n.getAreaYOffset(),n.getAreaAngle(),e,t,o))return n}}}return null},t.prototype.isRoomPointDeletableAt=function(e,t,i){return this.isItemResizable(e)&&e.getPointIndexAt(t,i,this.getIndicatorMargin())>=0},t.prototype.deletePointFromSelectedRoom=function(e,i){var n=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(1===n.length&&null!=n[0]&&n[0]instanceof Room&&this.isItemResizable(n[0])){var o=n[0],r=o.getPointIndexAt(e,i,this.getIndicatorMargin());if(r>=0){var l=o.getPoints()[r],a=l[0],s=l[1];o.removePoint(r),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setSelectedItems([o].slice(0)),this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new t.RoomPointDeletionUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,n.slice(0),o,r,a,s))}}},t.prototype.isRoomPointsComputableAt=function(e,t,i){if(this.isItemResizable(e)&&e.containsPoint(t,i,0)){var n=this.computeRoomPointsAt(t,i);return null!=n&&!(JSON.stringify(e.getPoints())===JSON.stringify(n))}return!1},t.prototype.recomputeSelectedRoomPoints=function(e,i){var n=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(1===n.length&&null!=n[0]&&n[0]instanceof Room&&this.isItemResizable(n[0])){var o=n[0],r=o.getPoints(),l=this.computeRoomPointsAt(e,i);null!=l&&(o.setPoints(l),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setSelectedItems([o].slice(0)),this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new t.RoomPointsModificationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,n.slice(0),o,r,l)))}},t.prototype.addPointToSelectedRoom=function(e,i){var n=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(1===n.length&&null!=n[0]&&n[0]instanceof Room&&this.isItemResizable(n[0])){for(var o=n[0],r=o.getPoints(),l=-1,a=17976931348623157e292,s=0;s<r.length;s++){var h=r[s],u=r[(s+1)%r.length],d=java.awt.geom.Line2D.ptSegDistSq(h[0],h[1],u[0],u[1],e,i);a>d&&(a=d,l=s)}var c=l+1;o.addPoint$float$float$int(e,i,c),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setSelectedItems([o].slice(0)),this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new t.RoomPointAdditionUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,n.slice(0),o,c,e,i))}},t.prototype.createDimensionLine$float$float$float$float$float=function(e,t,i,n,o){var r=new DimensionLine(e,t,i,n,o);return this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addDimensionLine(r),r},t.prototype.createDimensionLine=function(e,t,i,n,o){if("number"!=typeof e&&null!==e||"number"!=typeof t&&null!==t||"number"!=typeof i&&null!==i||"number"!=typeof n&&null!==n||"number"!=typeof o&&null!==o){if("number"!=typeof e&&null!==e||"number"!=typeof t&&null!==t||void 0!==i||void 0!==n||void 0!==o)throw new Error("invalid overload");return this.createDimensionLine$float$float(e,t)}return this.createDimensionLine$float$float$float$float$float(e,t,i,n,o)},t.prototype.getResizedDimensionLineStartAt=function(e,t){var i=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(1===i.length&&null!=i[0]&&i[0]instanceof DimensionLine&&this.isItemResizable(i[0])){var n=i[0],o=this.getIndicatorMargin();if(n.isAtLevel(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel())&&n.containsStartExtensionLinetAt(e,t,o))return n}return null},t.prototype.getResizedDimensionLineEndAt=function(e,t){var i=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(1===i.length&&null!=i[0]&&i[0]instanceof DimensionLine&&this.isItemResizable(i[0])){var n=i[0],o=this.getIndicatorMargin();if(n.isAtLevel(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel())&&n.containsEndExtensionLineAt(e,t,o))return n}return null},t.prototype.getOffsetDimensionLineAt=function(e,t){var i=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(1===i.length&&null!=i[0]&&i[0]instanceof DimensionLine&&this.isItemResizable(i[0])){var n=i[0],o=this.getIndicatorMargin();if(n.isAtLevel(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel())&&(n.isMiddlePointAt(e,t,o)||n.isTopPointAt(e,t,o)&&!n.containsPoint(e,t,0)))return n}return null},t.prototype.getPitchRotatedDimensionLineAt=function(e,t){var i=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(1===i.length&&null!=i[0]&&i[0]instanceof DimensionLine&&this.isItemMovable(i[0])){var n=i[0],o=this.getIndicatorMargin();if(n.isAtLevel(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel())&&n.isElevationDimensionLine()&&n.isBottomPointAt(e,t,o)&&!n.containsPoint(e,t,0))return n}return null},t.prototype.getElevatedDimensionLineAt=function(e,t){var i=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(1===i.length&&null!=i[0]&&i[0]instanceof DimensionLine&&this.isItemMovable(i[0])){var n=i[0],o=this.getIndicatorMargin();if(n.isAtLevel(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel())&&n.isLeftPointAt(e,t,o)&&!n.containsPoint(e,t,0))return n}return null},t.prototype.getHeightResizedDimensionLineAt=function(e,t){var i=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(1===i.length&&null!=i[0]&&i[0]instanceof DimensionLine&&this.isItemResizable(i[0])){var n=i[0],o=this.getIndicatorMargin();if(n.isAtLevel(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel())&&n.isRightPointAt(e,t,o)&&!n.containsPoint(e,t,0))return n}return null},t.prototype.createPolyline=function(e){var t=new Polyline(e),i=this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit();return t.setThickness(i.isMetric()?2:LengthUnit.inchToCentimeter(1)),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addPolyline$com_eteks_sweethome3d_model_Polyline(t),t},t.prototype.getResizedPolylineAt=function(e,t){var i=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(1===i.length&&null!=i[0]&&i[0]instanceof Polyline&&this.isItemResizable(i[0])){var n=i[0],o=this.getIndicatorMargin();if(n.isAtLevel(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel())&&-1!==n.getPointIndexAt(e,t,o))return n}return null},t.prototype.getSelectionMargin=function(){var e=t.PIXEL_MARGIN;return this.getPointerTypeLastMousePress()===View.PointerType.TOUCH&&(e*=2),e/this.getScale()},t.prototype.isItemSelectedAt=function(e,t){for(var i=this.getSelectionMargin(),n=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems(),o=0;o<n.length;o++){if(n[o].containsPoint(e,t,i))return!0}return!1},t.prototype.getSelectableItemAt$float$float=function(e,t){return this.getSelectableItemAt$float$float$boolean(e,t,!0)},t.prototype.getSelectableItemAt$float$float$boolean=function(e,t,i){var n=this.getSelectableItemsAt$float$float$boolean$boolean(e,t,!0,i);return 0!==n.length?n[0]:null},t.prototype.getSelectableItemAt=function(e,t,i){if("number"!=typeof e&&null!==e||"number"!=typeof t&&null!==t||"boolean"!=typeof i&&null!==i){if("number"!=typeof e&&null!==e||"number"!=typeof t&&null!==t||void 0!==i)throw new Error("invalid overload");return this.getSelectableItemAt$float$float(e,t)}return this.getSelectableItemAt$float$float$boolean(e,t,i)},t.prototype.getSelectableItemsAt$float$float=function(e,t){return this.getSelectableItemsAt$float$float$boolean$boolean(e,t,!1,!0)},t.prototype.getSelectableItemsAt$float$float$boolean$boolean=function(e,i,n,o){var r=[],l=this.getSelectionMargin(),a=l/2,s=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getObserverCamera();if(null!=s&&s===this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getCamera()&&s.containsPoint(e,i,l)&&(r.push(s),n))return r;for(var h=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked(),u=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel(),d=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getLabels(),c=0;c<d.length;c++){var p=d[c];if((!h||!this.isItemPartOfBasePlan(p))&&this.isLevelNullOrViewable(p.getLevel())&&p.isAtLevel(u)&&(p.containsPoint(e,i,l)||this.isItemTextAt(p,p.getText(),p.getStyle(),p.getX(),p.getY(),p.getAngle(),e,i,a))&&(r.push(p),n))return r}for(d=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getDimensionLines(),c=0;c<d.length;c++){var g=d[c];if((!h||!this.isItemPartOfBasePlan(g))&&this.isLevelNullOrViewable(g.getLevel())&&g.isAtLevel(u)&&g.containsPoint(e,i,l)&&(r.push(g),n))return r}for(var m=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getPolylines(),f=m.length-1;f>=0;f--){var v=m[f];if((!h||!this.isItemPartOfBasePlan(v))&&this.isLevelNullOrViewable(v.getLevel())&&v.isAtLevel(u)&&v.containsPoint(e,i,l)&&(r.push(v),n))return r}var _=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getFurniture(),S=[],y=null;for(f=_.length-1;f>=0;f--){var E=_[f];if((!h||!this.isItemPartOfBasePlan(E))&&this.isPieceOfFurnitureVisibleAtSelectedLevel(E))if(E.containsPoint(e,i,l))S.push(E),(null==y||E.getGroundElevation()>y.getGroundElevation())&&(y=E);else if(null==y){var C=E.getName();null!=C&&E.isNameVisible()&&this.isItemTextAt(E,C,E.getNameStyle(),E.getX()+E.getNameXOffset(),E.getY()+E.getNameYOffset(),E.getNameAngle(),e,i,a)&&(S.push(E),y=E)}}if(null==y&&h)for(d=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems(),c=0;c<d.length;c++){var P=d[c];if(null!=P&&P instanceof HomePieceOfFurniture){E=P;if(!this.isItemPartOfBasePlan(E)&&this.isPieceOfFurnitureVisibleAtSelectedLevel(E)&&(E.containsPoint(e,i,l)||null!=E.getName()&&E.isNameVisible()&&this.isItemTextAt(E,E.getName(),E.getNameStyle(),E.getX()+E.getNameXOffset(),E.getY()+E.getNameYOffset(),E.getNameAngle(),e,i,a))&&(S.push(E),y=E,n))break}}if(null!=y&&n){if(!o&&null!=y&&y instanceof HomeFurnitureGroup){var w=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(w.length>=1&&(1===w.length&&w[0]===y||function(e,t){for(var i=0;i<t.length;i++)if(e.indexOf(t[i])<0)return!1;return!0}(y.getAllFurniture(),w))){for(c=0;c<w.length;c++){if(null!=(L=w[c])&&L instanceof HomeFurnitureGroup)for(f=(T=L.getFurniture()).length-1;f>=0;f--){E=T[f];if((!h||!this.isItemPartOfBasePlan(E))&&!(w.indexOf(E)>=0)&&E.containsPoint(e,i,l))return[E].slice(0)}}for(c=0;c<w.length;c++){var L;if(null!=(L=w[c])&&L instanceof HomePieceOfFurniture){var T;for(f=(T=this.getFurnitureInSameGroup(L)).length-1;f>=0;f--){E=T[f];if((!h||!this.isItemPartOfBasePlan(E))&&E.containsPoint(e,i,l))return[E].slice(0)}}}}}return[y].slice(0)}R=S,(F=new t.PlanController$7(this)).compare?R.sort((function(e,t){return F.compare(e,t)})):R.sort(F),function(e,t){e.push.apply(e,t)}(r,S);for(d=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getWalls(),c=0;c<d.length;c++){var A=d[c];if((!h||!this.isItemPartOfBasePlan(A))&&this.isLevelNullOrViewable(A.getLevel())&&A.isAtLevel(u)&&A.containsPoint$float$float$float(e,i,l)&&(r.push(A),n))return r}var I=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getRooms(),b=null;for(f=I.length-1;f>=0;f--){var O=I[f];if((!h||!this.isItemPartOfBasePlan(O))&&this.isLevelNullOrViewable(O.getLevel())&&O.isAtLevel(u))if(O.containsPoint(e,i,l))r.push(O),(null==b||O.isCeilingVisible()&&!b.isCeilingVisible())&&(b=O);else{var M=O.getName();if(null!=M&&this.isItemTextAt(O,M,O.getNameStyle(),O.getXCenter()+O.getNameXOffset(),O.getYCenter()+O.getNameYOffset(),O.getNameAngle(),e,i,a)&&(r.push(O),b=O),O.isAreaVisible()){var D=this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getAreaFormatWithUnit().format(O.getArea());this.isItemTextAt(O,D,O.getAreaStyle(),O.getXCenter()+O.getAreaXOffset(),O.getYCenter()+O.getAreaYOffset(),O.getAreaAngle(),e,i,a)&&(r.push(O),b=O)}}}if(null!=b&&n)return[b].slice(0);var R,F,x=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getCompass();return h&&this.isItemPartOfBasePlan(x)||!x.containsPoint(e,i,a)||r.push(x),r},t.prototype.getSelectableItemsAt=function(e,t,i,n){if("number"!=typeof e&&null!==e||"number"!=typeof t&&null!==t||"boolean"!=typeof i&&null!==i||"boolean"!=typeof n&&null!==n){if("number"!=typeof e&&null!==e||"number"!=typeof t&&null!==t||void 0!==i||void 0!==n)throw new Error("invalid overload");return this.getSelectableItemsAt$float$float(e,t)}return this.getSelectableItemsAt$float$float$boolean$boolean(e,t,i,n)},t.prototype.isItemTextAt=function(e,t,i,n,o,r,l,a,s){null==i&&(i=this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getDefaultTextStyle(e.constructor));var h=this.getView().getTextBounds(t,i,n,o,r);return this.getPath$float_A_A(h).intersects(l-s,a-s,2*s,2*s)},t.prototype.getSelectableItemsIntersectingRectangle=function(e,t,i,n){for(var o=[],r=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked(),l=this.getVisibleItemsAtSelectedLevel(),a=0;a<l.length;a++){var s=l[a];r&&this.isItemPartOfBasePlan(s)||!s.intersectsRectangle(e,t,i,n)||o.push(s)}var h=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getObserverCamera();return null!=h&&h.intersectsRectangle(e,t,i,n)&&o.push(h),o},t.prototype.getRotatedPieceOfFurnitureAt=function(e,t){var i=this.getSelectedMovablePieceOfFurniture();if(null!=i){var n=this.getIndicatorMargin();if(i.isTopLeftPointAt(e,t,n)&&!i.containsPoint(e,t,0))return i}return null},t.prototype.getElevatedPieceOfFurnitureAt=function(e,t){var i=this.getSelectedMovablePieceOfFurniture();if(null!=i){var n=this.getIndicatorMargin();if(i.isTopRightPointAt(e,t,n)&&!i.containsPoint(e,t,0))return i}return null},t.prototype.getHeightResizedPieceOfFurnitureAt=function(e,t){var i=this.getSelectedResizablePieceOfFurniture();if(null!=i){var n=this.getIndicatorMargin();if(!i.isHorizontallyRotated()&&i.isBottomLeftPointAt(e,t,n)&&!i.containsPoint(e,t,0))return i}return null},t.prototype.getPitchRotatedPieceOfFurnitureAt=function(e,t){var i=this.getSelectedMovablePieceOfFurniture();if(null!=i&&this.getView().isFurnitureSizeInPlanSupported()){var n=this.getIndicatorMargin();if(0!==i.getPitch()&&i.isBottomLeftPointAt(e,t,n)&&!i.containsPoint(e,t,0))return i}return null},t.prototype.getRollRotatedPieceOfFurnitureAt=function(e,t){var i=this.getSelectedMovablePieceOfFurniture();if(null!=i&&this.getView().isFurnitureSizeInPlanSupported()){var n=this.getIndicatorMargin();if(0!==i.getRoll()&&i.isBottomLeftPointAt(e,t,n)&&!i.containsPoint(e,t,0))return i}return null},t.prototype.getWidthAndDepthResizedPieceOfFurnitureAt=function(e,t){var i=this.getSelectedResizablePieceOfFurniture();if(null!=i){var n=this.getIndicatorMargin();if(i.isBottomRightPointAt(e,t,n)&&!i.containsPoint(e,t,0))return i}return null},t.prototype.getSelectedMovablePieceOfFurniture=function(){var e=this.getSelectedPieceOfFurniture();return null!=e&&this.isItemMovable(e)?e:null},t.prototype.getSelectedResizablePieceOfFurniture=function(){var e=this.getSelectedPieceOfFurniture();return null!=e&&e.isResizable()&&this.isItemResizable(e)?e:null},t.prototype.getSelectedPieceOfFurniture=function(){var e=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(1===e.length&&null!=e[0]&&e[0]instanceof HomePieceOfFurniture){var t=e[0];if(this.isPieceOfFurnitureVisibleAtSelectedLevel(t))return t}return null},t.prototype.getModifiedLightPowerAt=function(e,t){var i=this.getSelectedPieceOfFurniture();if(null!=i&&i instanceof HomeLight){var n=this.getIndicatorMargin();if(i.isBottomLeftPointAt(e,t,n)&&!i.containsPoint(e,t,0))return i}return null},t.prototype.getPieceOfFurnitureNameAt=function(e,t){var i=this.getSelectedMovablePieceOfFurniture();if(null!=i){var n=this.getIndicatorMargin();if(i.isNameVisible()&&i.getName().trim().length>0&&i.isNameCenterPointAt(e,t,n))return i}return null},t.prototype.getPieceOfFurnitureRotatedNameAt=function(e,t){var i=this.getSelectedMovablePieceOfFurniture();if(null!=i){var n=this.getIndicatorMargin();if(i.isNameVisible()&&i.getName().trim().length>0&&this.isTextAnglePointAt(i,i.getName(),i.getNameStyle(),i.getX()+i.getNameXOffset(),i.getY()+i.getNameYOffset(),i.getNameAngle(),e,t,n))return i}return null},t.prototype.isTextAnglePointAt=function(e,t,i,n,o,r,l,a,s){null==i&&(i=this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getDefaultTextStyle(e.constructor));var h,u,d=this.getView().getTextBounds(t,i,n,o,r);return i.getAlignment()===TextStyle.Alignment.LEFT?(h=d[0][0],u=d[0][1]):i.getAlignment()===TextStyle.Alignment.RIGHT?(h=d[1][0],u=d[1][1]):(h=(d[0][0]+d[1][0])/2,u=(d[0][1]+d[1][1])/2),Math.abs(l-h)<=s&&Math.abs(a-u)<=s},t.prototype.getRotatedLabelAt=function(e,t){var i=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(1===i.length&&null!=i[0]&&i[0]instanceof Label&&this.isItemMovable(i[0])){var n=i[0],o=this.getIndicatorMargin();if(n.isAtLevel(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel())&&this.isTextAnglePointAt(n,n.getText(),n.getStyle(),n.getX(),n.getY(),n.getAngle(),e,t,o))return n}return null},t.prototype.getElevatedLabelAt=function(e,t){var i=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(1===i.length&&null!=i[0]&&i[0]instanceof Label){var n=i[0];if(null!=n.getPitch()&&this.isItemMovable(n)){var o=this.getIndicatorMargin();if(n.isAtLevel(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel())){var r=n.getStyle();null==r&&(r=this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getDefaultTextStyle(n.constructor));var l=this.getView().getTextBounds(n.getText(),this.getItemTextStyle(n,n.getStyle()),n.getX(),n.getY(),n.getAngle()),a=void 0,s=void 0;if(r.getAlignment()===TextStyle.Alignment.LEFT?(a=l[3][0],s=l[3][1]):r.getAlignment()===TextStyle.Alignment.RIGHT?(a=l[2][0],s=l[2][1]):(a=(l[2][0]+l[3][0])/2,s=(l[2][1]+l[3][1])/2),Math.abs(e-a)<=o&&Math.abs(t-s)<=o)return n}}}return null},t.prototype.getYawRotatedCameraAt=function(e,t){var i=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(1===i.length&&null!=i[0]&&i[0]instanceof Camera&&this.isItemResizable(i[0])){var n=i[0],o=this.getIndicatorMargin(),r=n.getPoints(),l=(r[0][0]+r[3][0])/2,a=(r[0][1]+r[3][1])/2;if(Math.abs(e-l)<=o&&Math.abs(t-a)<=o&&!n.containsPoint(e,t,0))return n}return null},t.prototype.getPitchRotatedCameraAt=function(e,t){var i=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(1===i.length&&null!=i[0]&&i[0]instanceof Camera&&this.isItemResizable(i[0])){var n=i[0],o=this.getIndicatorMargin(),r=n.getPoints(),l=(r[1][0]+r[2][0])/2,a=(r[1][1]+r[2][1])/2;if(Math.abs(e-l)<=o&&Math.abs(t-a)<=o&&!n.containsPoint(e,t,0))return n}return null},t.prototype.getElevatedCameraAt=function(e,t){var i=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(1===i.length&&null!=i[0]&&i[0]instanceof Camera&&this.isItemResizable(i[0])){var n=i[0],o=this.getIndicatorMargin(),r=n.getPoints(),l=(r[0][0]+r[1][0])/2,a=(r[0][1]+r[1][1])/2;if(Math.abs(e-l)<=o&&Math.abs(t-a)<=o&&!n.containsPoint(e,t,0))return n}return null},t.prototype.getRotatedCompassAt=function(e,t){var i=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(1===i.length&&null!=i[0]&&i[0]instanceof Compass&&this.isItemMovable(i[0])){var n=i[0],o=this.getIndicatorMargin(),r=n.getPoints(),l=(r[2][0]+r[3][0])/2,a=(r[2][1]+r[3][1])/2;if(Math.abs(e-l)<=o&&Math.abs(t-a)<=o&&!n.containsPoint(e,t,0))return n}return null},t.prototype.getResizedCompassAt=function(e,t){var i=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(1===i.length&&null!=i[0]&&i[0]instanceof Compass&&this.isItemMovable(i[0])){var n=i[0],o=this.getIndicatorMargin(),r=n.getPoints(),l=(r[1][0]+r[2][0])/2,a=(r[1][1]+r[2][1])/2;if(Math.abs(e-l)<=o&&Math.abs(t-a)<=o&&!n.containsPoint(e,t,0))return n}return null},t.prototype.deleteItems=function(e){for(var i,n,o=[],r=0;r<e.length;r++){var l=e[r];this.isItemDeletable(l)&&o.push(l)}if(0!=o.length){this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.beginUpdate(),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.removeSelectionListener(this.selectionListener);var a=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection(),s=e.slice(0);this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new t.ItemsDeletionStartUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_home,a,s.slice(0))),this.deleteFurniture(Home.getFurnitureSubList(o));var h=Home.getWallsSubList(o).slice(0);i=h,n=Home.getRoomsSubList(o),i.push.apply(i,n),function(e,t){e.push.apply(e,t)}(h,Home.getDimensionLinesSubList(o)),function(e,t){e.push.apply(e,t)}(h,Home.getPolylinesSubList(o)),function(e,t){e.push.apply(e,t)}(h,Home.getLabelsSubList(o)),this.postDeleteItems(h,this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked(),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection()),this.doDeleteItems(h),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addSelectionListener(this.selectionListener),this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new t.ItemsDeletionEndUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_home)),this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.endUpdate()}},t.prototype.postDeleteItems=function(e,i,n){for(var o=Home.getWallsSubList(e),r=t.JoinedWall.getJoinedWalls(o),l=Home.getRoomsSubList(e),a=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getRooms(),s={},h=0;h<l.length;h++){var u=l[h];!function(e,t,i){null==e.entries&&(e.entries=[]);for(var n=0;n<e.entries.length;n++)if(null!=e.entries[n].key.equals&&e.entries[n].key.equals(t)||e.entries[n].key===t){var o=e.entries[n].value;return e.entries[n].value=i,o}e.entries.push({key:t,value:i,getKey:function(){return this.key},getValue:function(){return this.value}}),e.entries.sort((function(e,t){return null!=e.key.compareTo?e.key.compareTo(t):e.key-t.key}))}(s,a.indexOf(u),u)}for(var d,c=function(e,t){return e.length>=t.length?(e.length=0,e.push.apply(e,t),e):t.slice(0)}(function(e){for(var t=[];e-- >0;)t.push(null);return t}((null==(d=s).entries&&(d.entries=[]),d.entries.length)),function(e){var t=[];null==e.entries&&(e.entries=[]);for(var i=0;i<e.entries.length;i++)t.push(e.entries[i].value);return t}(s)),p=function(e){for(var t=[];e-- >0;)t.push(0);return t}(c.length),g=function(e){for(var t=[];e-- >0;)t.push(null);return t}(c.length),m=0,f=function(e){var t=[];null==e.entries&&(e.entries=[]);for(var i=0;i<e.entries.length;i++)t.push(e.entries[i].key);return t}(s),v=0;v<f.length;v++){h=f[v];p[m]=h,g[m]=c[m].getLevel(),m++}var _=Home.getDimensionLinesSubList(e).slice(0),S=function(e){for(var t=[];e-- >0;)t.push(null);return t}(_.length);for(m=0;m<_.length;m++)S[m]=_[m].getLevel();var y=Home.getPolylinesSubList(e),E=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getPolylines(),C={};for(h=0;h<y.length;h++){var P=y[h];!function(e,t,i){null==e.entries&&(e.entries=[]);for(var n=0;n<e.entries.length;n++)if(null!=e.entries[n].key.equals&&e.entries[n].key.equals(t)||e.entries[n].key===t){var o=e.entries[n].value;return e.entries[n].value=i,o}e.entries.push({key:t,value:i,getKey:function(){return this.key},getValue:function(){return this.value}}),e.entries.sort((function(e,t){return null!=e.key.compareTo?e.key.compareTo(t):e.key-t.key}))}(C,E.indexOf(P),P)}var w=function(e,t){return e.length>=t.length?(e.length=0,e.push.apply(e,t),e):t.slice(0)}(function(e){for(var t=[];e-- >0;)t.push(null);return t}(function(e){return null==e.entries&&(e.entries=[]),e.entries.length}(C)),function(e){var t=[];null==e.entries&&(e.entries=[]);for(var i=0;i<e.entries.length;i++)t.push(e.entries[i].value);return t}(C)),L=function(e){for(var t=[];e-- >0;)t.push(0);return t}(w.length),T=function(e){for(var t=[];e-- >0;)t.push(null);return t}(w.length);m=0;for(f=function(e){var t=[];null==e.entries&&(e.entries=[]);for(var i=0;i<e.entries.length;i++)t.push(e.entries[i].key);return t}(C),v=0;v<f.length;v++){h=f[v];L[m]=h,T[m]=w[m].getLevel(),m++}var A=Home.getLabelsSubList(e).slice(0),I=function(e){for(var t=[];e-- >0;)t.push(null);return t}(A.length);for(m=0;m<A.length;m++)I[m]=A[m].getLevel();this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new t.ItemsDeletionUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,i,n,e.slice(0),r,c,p,g,_,S,w,L,T,A,I))},t.prototype.doDeleteItems=function(e){for(var t=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked(),i=0;i<e.length;i++){var n=e[i];null!=n&&n instanceof Wall?this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.deleteWall(n):null!=n&&n instanceof DimensionLine?this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.deleteDimensionLine(n):null!=n&&n instanceof Room?this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.deleteRoom(n):null!=n&&n instanceof Polyline?this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.deletePolyline(n):null!=n&&n instanceof Label?this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.deleteLabel(n):null!=n&&n instanceof HomePieceOfFurniture&&this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.deletePieceOfFurniture(n),t=!this.isItemPartOfBasePlan(n)&&t}this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setBasePlanLocked(t),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setAllLevelsSelection(!1)},t.prototype.moveAndShowSelectedItems=function(e,t){for(var i=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems(),n=[],o=0;o<i.length;o++){var r=i[o];this.isItemMovable(r)&&n.push(r)}0!=n.length&&(this.moveItems(n,e,t),this.selectAndShowItems$java_util_List$boolean(n,this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection()),1===n.length&&null!=n[0]&&n[0]instanceof Camera||this.postItemsMove(n,i,e,t))},t.prototype.moveItems=function(e,i,n){for(var o=0;o<e.length;o++){var r=e[o];if(null!=r&&r instanceof Wall){var l=r;l.removePropertyChangeListener(this.wallChangeListener),t.moveWallStartPoint(l,l.getXStart()+i,l.getYStart()+n,!(e.indexOf(l.getWallAtStart())>=0)),t.moveWallEndPoint(l,l.getXEnd()+i,l.getYEnd()+n,!(e.indexOf(l.getWallAtEnd())>=0)),this.resetAreaCache(),l.addPropertyChangeListener(this.wallChangeListener)}else{var a=!1;if(null!=r&&r instanceof HomeDoorOrWindow&&(a=r.isBoundToWall()),r.move(i,n),a){var s=new java.awt.geom.Area(this.getPath$float_A_A(r.getPoints()));s.intersect(this.getWallsArea(!0)),r.setBoundToWall(!s.isEmpty())}}}},t.moveWallStartPoint=function(e,t,i,n){var o=e.getXStart(),r=e.getYStart();e.setXStart(t),e.setYStart(i);var l=e.getWallAtStart();null!=l&&n&&(l.getWallAtStart()===e&&(l.getWallAtEnd()!==e||l.getXStart()===o&&l.getYStart()===r)?(l.setXStart(t),l.setYStart(i)):l.getWallAtEnd()===e&&(l.getWallAtStart()!==e||l.getXEnd()===o&&l.getYEnd()===r)&&(l.setXEnd(t),l.setYEnd(i)))},t.moveWallEndPoint=function(e,t,i,n){var o=e.getXEnd(),r=e.getYEnd();e.setXEnd(t),e.setYEnd(i);var l=e.getWallAtEnd();null!=l&&n&&(l.getWallAtStart()===e&&(l.getWallAtEnd()!==e||l.getXStart()===o&&l.getYStart()===r)?(l.setXStart(t),l.setYStart(i)):l.getWallAtEnd()===e&&(l.getWallAtStart()!==e||l.getXEnd()===o&&l.getYEnd()===r)&&(l.setXEnd(t),l.setYEnd(i)))},t.moveWallPoint=function(e,i,n,o){o?t.moveWallStartPoint(e,i,n,!0):t.moveWallEndPoint(e,i,n,!0)},t.moveRoomPoint=function(e,t,i,n){e.setPoint(t,i,n)},t.moveDimensionLinePoint=function(e,t,i,n){n?(e.setXStart(t),e.setYStart(i)):(e.setXEnd(t),e.setYEnd(i))},t.reverseDimensionLine=function(e){var t=e.getXStart(),i=e.getYStart();e.setXStart(e.getXEnd()),e.setYStart(e.getYEnd()),e.setXEnd(t),e.setYEnd(i),e.setOffset(-e.getOffset())},t.prototype.selectAndShowItems$java_util_List=function(e){this.selectAndShowItems$java_util_List$boolean(e,!1)},t.prototype.selectAndShowItems$java_util_List$boolean=function(e,t){this.selectItems$java_util_List$boolean(e,t),this.selectLevelFromSelectedItems(),this.getView().makeSelectionVisible()},t.prototype.selectAndShowItems=function(e,t){if(!(null!=e&&e instanceof Array||null===e)||"boolean"!=typeof t&&null!==t){if((null!=e&&e instanceof Array||null===e)&&void 0===t)return this.selectAndShowItems$java_util_List(e);throw new Error("invalid overload")}return this.selectAndShowItems$java_util_List$boolean(e,t)},t.prototype.selectItems$java_util_List=function(e){this.selectItems$java_util_List$boolean(e,!1)},t.prototype.selectItems$java_util_List$boolean=function(e,t){this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.removeSelectionListener(this.selectionListener),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setSelectedItems(e),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addSelectionListener(this.selectionListener),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setAllLevelsSelection(t)},t.prototype.selectItems=function(e,t){if(!(null!=e&&e instanceof Array||null===e)||"boolean"!=typeof t&&null!==t){if((null!=e&&e instanceof Array||null===e)&&void 0===t)return this.selectItems$java_util_List(e);throw new Error("invalid overload")}return this.selectItems$java_util_List$boolean(e,t)},t.prototype.selectItem=function(e){this.selectItems$java_util_List([e].slice(0))},t.prototype.toggleItemSelection=function(e){var t,i,n=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems().slice(0);n.indexOf(e)>=0?(i=(t=n).indexOf(e))>=0&&t.splice(i,1):n.push(e),this.selectItems$java_util_List$boolean(n,this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection())},t.prototype.deselectAll=function(){this.selectItems$java_util_List([])},t.prototype.addItems=function(e){this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.beginUpdate(),this.addFurniture$java_util_List(Home.getFurnitureSubList(e)),this.addWalls(Home.getWallsSubList(e)),this.addRooms(Home.getRoomsSubList(e)),this.addPolylines(Home.getPolylinesSubList(e)),this.addDimensionLines(Home.getDimensionLinesSubList(e)),this.addLabels(Home.getLabelsSubList(e)),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setSelectedItems(e),this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new t.ItemsAdditionEndUndoableEdit(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,e.slice(0))),this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.endUpdate()},t.prototype.addFurniture=function(t,i,n,o){if(!((null!=t&&t instanceof Array||null===t)&&(null!=i&&i instanceof Array&&(0==i.length||null==i[0]||null!=i[0]&&i[0]instanceof Level)||null===i)&&(null!=n&&n instanceof HomeFurnitureGroup||null===n)&&(null!=o&&o instanceof HomePieceOfFurniture||null===o))){if((null!=t&&t instanceof Array||null===t)&&(null!=i&&i instanceof HomePieceOfFurniture||null===i)&&void 0===n&&void 0===o)return this.addFurniture$java_util_List$com_eteks_sweethome3d_model_HomePieceOfFurniture(t,i);if((null!=t&&t instanceof Array||null===t)&&void 0===i&&void 0===n&&void 0===o)return this.addFurniture$java_util_List(t);throw new Error("invalid overload")}e.prototype.addFurniture.call(this,t,i,n,o)},t.prototype.addFurniture$java_util_List=function(t){if(e.prototype.addFurniture$java_util_List.call(this,t),this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())for(var i=this.getWallsArea(!1),n=0;n<t.length;n++){var o=t[n];if(null!=o&&o instanceof HomeDoorOrWindow){var r=o.getPoints(),l=new java.awt.geom.Area(this.getPath$float_A_A(r));l.intersect(i),!l.isEmpty()&&new Room(r).getArea()/this.getArea(l)>.999&&o.setBoundToWall(!0)}}},t.prototype.addWalls=function(e){for(var t=0;t<e.length;t++){var i=e[t];this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addWall(i)}this.postCreateWalls(e,this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems(),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked(),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection())},t.prototype.postCreateWalls=function(e,i,n,o){if(e.length>0){var r=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked();if(r){for(var l=0;l<e.length;l++){var a=e[l];r=!this.isItemPartOfBasePlan(a)&&r}this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setBasePlanLocked(r)}var s=r,h=t.JoinedWall.getJoinedWalls(e),u=i.slice(0);this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new t.WallsCreationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,u,n,o,h,s))}},t.prototype.doAddWalls=function(e,t){for(var i=0;i<e.length;i++){var n=(o=e[i]).getWall();this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addWall(n),n.setLevel(o.getLevel())}this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setBasePlanLocked(t);for(i=0;i<e.length;i++){n=(o=e[i]).getWall();var o,r=o.getWallAtStart();null!=r&&(n.setWallAtStart(r),o.isJoinedAtEndOfWallAtStart()?r.setWallAtEnd(n):r.setWallAtStart(n));var l=o.getWallAtEnd();null!=l&&(n.setWallAtEnd(l),o.isJoinedAtStartOfWallAtEnd()?l.setWallAtStart(n):l.setWallAtEnd(n))}},t.prototype.doDeleteWalls=function(e,t){for(var i=0;i<e.length;i++){var n=e[i];this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.deleteWall(n.getWall())}this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setBasePlanLocked(t)},t.prototype.addRooms=function(e){for(var t=e.slice(0),i=function(e){for(var t=[];e-- >0;)t.push(0);return t}(e.length),n=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getRooms().length,o=0;o<i.length;o++)i[o]=n++,this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addRoom$com_eteks_sweethome3d_model_Room$int(t[o],i[o]);this.postCreateRooms$com_eteks_sweethome3d_model_Room_A$int_A$java_util_List$boolean$boolean(t,i,this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems(),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked(),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection())},t.prototype.postCreateRooms$com_eteks_sweethome3d_model_Room_A$int_A$java_util_List$boolean$boolean=function(e,i,n,o,r){if(e.length>0){var l=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked();if(l){for(var a=0;a<e.length;a++){var s=e[a];l=!this.isItemPartOfBasePlan(s)&&l}this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setBasePlanLocked(l)}var h=l,u=n.slice(0),d=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel();this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new t.RoomsCreationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,u,o,r,e,i,d,h))}},t.prototype.postCreateRooms=function(e,t,i,n,o){if(!((null!=e&&e instanceof Array&&(0==e.length||null==e[0]||null!=e[0]&&e[0]instanceof Room)||null===e)&&(null!=t&&t instanceof Array&&(0==t.length||null==t[0]||"number"==typeof t[0])||null===t)&&(null!=i&&i instanceof Array||null===i))||"boolean"!=typeof n&&null!==n||"boolean"!=typeof o&&null!==o){if(!(null!=e&&e instanceof Array||null===e)||!(null!=t&&t instanceof Array||null===t)||"boolean"!=typeof i&&null!==i||"boolean"!=typeof n&&null!==n||void 0!==o)throw new Error("invalid overload");return this.postCreateRooms$java_util_List$java_util_List$boolean$boolean(e,t,i,n)}return this.postCreateRooms$com_eteks_sweethome3d_model_Room_A$int_A$java_util_List$boolean$boolean(e,t,i,n,o)},t.prototype.postCreateRooms$java_util_List$java_util_List$boolean$boolean=function(e,t,i,n){for(var o=e.slice(0),r=function(e){for(var t=[];e-- >0;)t.push(0);return t}(e.length),l=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getRooms(),a=0;a<r.length;a++)r[a]=l.lastIndexOf(o[a]);this.postCreateRooms$com_eteks_sweethome3d_model_Room_A$int_A$java_util_List$boolean$boolean(o,r,t,i,n)},t.prototype.doAddRooms=function(e,t,i,n,o){for(var r=0;r<t.length;r++)this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addRoom$com_eteks_sweethome3d_model_Room$int(e[r],t[r]),e[r].setLevel(null!=i?i[r]:n);this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setBasePlanLocked(o)},t.prototype.doDeleteRooms=function(e,t){for(var i=0;i<e.length;i++){var n=e[i];this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.deleteRoom(n)}this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setBasePlanLocked(t)},t.prototype.addDimensionLines=function(e){for(var t=0;t<e.length;t++){var i=e[t];this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addDimensionLine(i)}this.postCreateDimensionLines(e,this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems(),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked(),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection())},t.prototype.postCreateDimensionLines=function(e,i,n,o){if(e.length>0){var r=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked();if(r){for(var l=0;l<e.length;l++){var a=e[l];r=!this.isItemPartOfBasePlan(a)&&r}this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setBasePlanLocked(r)}var s=r,h=e.slice(0),u=i.slice(0),d=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel();this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new t.DimensionLinesCreationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,u,n,o,h,d,s))}},t.prototype.doAddDimensionLines=function(e,t,i,n){for(var o=0;o<e.length;o++){var r=e[o];this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addDimensionLine(r),r.setLevel(null!=t?t[o]:i)}this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setBasePlanLocked(n)},t.prototype.doDeleteDimensionLines=function(e,t){for(var i=0;i<e.length;i++){var n=e[i];this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.deleteDimensionLine(n)}this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setBasePlanLocked(t)},t.prototype.addPolylines=function(e){for(var t=e.slice(0),i=function(e){for(var t=[];e-- >0;)t.push(0);return t}(e.length),n=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getPolylines().length,o=0;o<i.length;o++)i[o]=n++,this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addPolyline$com_eteks_sweethome3d_model_Polyline$int(t[o],i[o]);this.postCreatePolylines$com_eteks_sweethome3d_model_Polyline_A$int_A$java_util_List$boolean$boolean(t,i,this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems(),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked(),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection())},t.prototype.postCreatePolylines$com_eteks_sweethome3d_model_Polyline_A$int_A$java_util_List$boolean$boolean=function(e,i,n,o,r){if(e.length>0){var l=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked();if(l){for(var a=0;a<e.length;a++){var s=e[a];l=!this.isItemPartOfBasePlan(s)&&l}this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setBasePlanLocked(l)}var h=l,u=n.slice(0),d=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel();this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new t.PolylinesCreationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,u,o,r,e,i,d,h))}},t.prototype.postCreatePolylines=function(e,t,i,n,o){if(!((null!=e&&e instanceof Array&&(0==e.length||null==e[0]||null!=e[0]&&e[0]instanceof Polyline)||null===e)&&(null!=t&&t instanceof Array&&(0==t.length||null==t[0]||"number"==typeof t[0])||null===t)&&(null!=i&&i instanceof Array||null===i))||"boolean"!=typeof n&&null!==n||"boolean"!=typeof o&&null!==o){if(!(null!=e&&e instanceof Array||null===e)||!(null!=t&&t instanceof Array||null===t)||"boolean"!=typeof i&&null!==i||"boolean"!=typeof n&&null!==n||void 0!==o)throw new Error("invalid overload");return this.postCreatePolylines$java_util_List$java_util_List$boolean$boolean(e,t,i,n)}return this.postCreatePolylines$com_eteks_sweethome3d_model_Polyline_A$int_A$java_util_List$boolean$boolean(e,t,i,n,o)},t.prototype.postCreatePolylines$java_util_List$java_util_List$boolean$boolean=function(e,t,i,n){for(var o=e.slice(0),r=function(e){for(var t=[];e-- >0;)t.push(0);return t}(e.length),l=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getPolylines(),a=0;a<r.length;a++)r[a]=l.lastIndexOf(o[a]);this.postCreatePolylines$com_eteks_sweethome3d_model_Polyline_A$int_A$java_util_List$boolean$boolean(o,r,t,i,n)},t.prototype.doAddPolylines=function(e,t,i,n,o){for(var r=0;r<t.length;r++)this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addPolyline$com_eteks_sweethome3d_model_Polyline$int(e[r],t[r]),e[r].setLevel(null!=i?i[r]:n);this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setBasePlanLocked(o)},t.prototype.doDeletePolylines=function(e,t){for(var i=0;i<e.length;i++){var n=e[i];this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.deletePolyline(n)}this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setBasePlanLocked(t)},t.prototype.addLabels=function(e){for(var t=0;t<e.length;t++){var i=e[t];this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addLabel(i)}this.postCreateLabels(e,this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems(),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked(),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection())},t.prototype.postCreateLabels=function(e,i,n,o){if(e.length>0){var r=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked();if(r){for(var l=0;l<e.length;l++){var a=e[l];r=!this.isItemPartOfBasePlan(a)&&r}this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setBasePlanLocked(r)}var s=r,h=e.slice(0),u=i.slice(0),d=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel();this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new t.LabelsCreationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,u,n,o,h,d,s))}},t.prototype.doAddLabels=function(e,t,i,n){for(var o=0;o<e.length;o++){var r=e[o];this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addLabel(r),r.setLevel(null!=t?t[o]:i)}this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setBasePlanLocked(n)},t.prototype.doDeleteLabels=function(e,t){for(var i=0;i<e.length;i++){var n=e[i];this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.deleteLabel(n)}this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setBasePlanLocked(t)},t.prototype.postLabelRotation=function(e,i){var n=e.getAngle();n!==i&&this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new t.LabelRotationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,i,e,n))},t.prototype.postLabelElevation=function(e,i){var n=e.getElevation();n!==i&&this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new t.LabelElevationModificationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,i,e,n))},t.prototype.postItemsMove=function(e,i,n,o){if(0!==n||0!==o){var r=e.slice(0),l=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection(),a=i.slice(0);this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new t.ItemsMovingUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,a,l,r,n,o))}},t.prototype.doMoveAndShowItems=function(e,t,i,n,o){this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setAllLevelsSelection(o),this.moveItems(e.slice(0),i,n),this.selectAndShowItems$java_util_List$boolean(t.slice(0),o)},t.prototype.postPieceOfFurnitureMove=function(e,i,n,o,r,l,a){var s=e.getAngle(),h=e.getDepth(),u=e.getElevation();0===i&&0===n&&s===o&&h===r&&u===l||this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new t.PieceOfFurnitureMovingUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,o,r,l,a,e,i,n,s,h,u))},t.prototype.postItemsDuplication=function(e,i){for(var n=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked(),o=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection(),r=Home.getFurnitureSubList(e),l=0;l<r.length;l++){var a=r[l];this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.deletePieceOfFurniture(a)}this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.beginUpdate(),this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new t.DuplicationStartUndoableEdit(this,i.slice(0),o)),this.addFurniture$java_util_List(r);var s=[];this.postCreateWalls(Home.getWallsSubList(e),s,n,o),this.postCreateRooms$java_util_List$java_util_List$boolean$boolean(Home.getRoomsSubList(e),s,n,o),this.postCreatePolylines$java_util_List$java_util_List$boolean$boolean(Home.getPolylinesSubList(e),s,n,o),this.postCreateDimensionLines(Home.getDimensionLinesSubList(e),s,n,o),this.postCreateLabels(Home.getLabelsSubList(e),s,n,o),this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new t.DuplicationEndUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,e.slice(0))),this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.endUpdate(),this.selectItems$java_util_List(e)},t.prototype.postWallResize=function(e,i,n,o){var r,l;o?(r=e.getXStart(),l=e.getYStart()):(r=e.getXEnd(),l=e.getYEnd()),r===i&&l===n||this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new t.WallResizingUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,i,n,e,o,r,l))},t.prototype.postWallArcExtent=function(e,i){var n=e.getArcExtent();n===i||null!=n&&n===i||this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new t.WallArcExtentModificationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,i,e,n))},t.prototype.postRoomResize=function(e,i,n,o){var r=e.getPoints()[o],l=r[0],a=r[1];if(l!==i||a!==n){var s=new t.RoomResizingUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,i,n,e,o,l,a);this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(s)}},t.prototype.postRoomNameOffset=function(e,i,n){var o=e.getNameXOffset(),r=e.getNameYOffset();o===i&&r===n||this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new t.RoomNameOffsetModificationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,i,n,e,o,r))},t.prototype.postRoomNameRotation=function(e,i){var n=e.getNameAngle();n!==i&&this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new t.RoomNameRotationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,i,e,n))},t.prototype.postRoomAreaOffset=function(e,i,n){var o=e.getAreaXOffset(),r=e.getAreaYOffset();o===i&&r===n||this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new t.RoomAreaOffsetModificationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,i,n,e,o,r))},t.prototype.postRoomAreaRotation=function(e,i){var n=e.getAreaAngle();n!==i&&this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new t.RoomAreaRotationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,i,e,n))},t.prototype.postPieceOfFurnitureRotation=function(e,i,n){var o=e.getAngle();o!==i&&this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new t.PieceOfFurnitureRotationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,i,n,e,o))},t.prototype.postPieceOfFurniturePitchRotation=function(e,i,n,o,r){var l=e.getPitch();l!==i&&this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new t.PieceOfFurniturePitchRotationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,i,n,o,r,e,l,e.getWidthInPlan(),e.getDepthInPlan(),e.getHeightInPlan()))},t.prototype.setPieceOfFurniturePitch=function(e,t,i,n,o){e.removePropertyChangeListener(this.furnitureSizeChangeListener),e.setPitch(t),e.setWidthInPlan(i),e.setDepthInPlan(n),e.setHeightInPlan(o),e.addPropertyChangeListener(this.furnitureSizeChangeListener)},t.prototype.postPieceOfFurnitureRollRotation=function(e,i,n,o,r){var l=e.getRoll();l!==i&&this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new t.PieceOfFurnitureRollRotationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,i,n,o,r,e,l,e.getWidthInPlan(),e.getDepthInPlan(),e.getHeightInPlan()))},t.prototype.setPieceOfFurnitureRoll=function(e,t,i,n,o){e.removePropertyChangeListener(this.furnitureSizeChangeListener),e.setRoll(t),e.setWidthInPlan(i),e.setDepthInPlan(n),e.setHeightInPlan(o),e.addPropertyChangeListener(this.furnitureSizeChangeListener)},t.prototype.postPieceOfFurnitureElevation=function(e,i){var n=e.getElevation();n!==i&&this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new t.PieceOfFurnitureElevationModificationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,i,e,n))},t.prototype.postPieceOfFurnitureHeightResize=function(e){e.getPieceOfFurniture().getHeight()!==e.getHeight()&&this.postPieceOfFurnitureResize(e,"undoPieceOfFurnitureHeightResizeName")},t.prototype.postPieceOfFurnitureWidthAndDepthResize=function(e){var t=e.getPieceOfFurniture();t.getWidth()===e.getWidth()&&t.getDepth()===e.getDepth()||this.postPieceOfFurnitureResize(e,"undoPieceOfFurnitureWidthAndDepthResizeName")},t.prototype.postPieceOfFurnitureResize=function(e,i){var n=e.getPieceOfFurniture(),o=null!=n&&n instanceof HomeDoorOrWindow&&n.isBoundToWall();this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new t.PieceOfFurnitureResizingUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,i,o,e,n.getX(),n.getY(),n.getWidth(),n.getDepth(),n.getHeight()))},t.prototype.setPieceOfFurnitureSize=function(e,i,n,o){var r=e.getPieceOfFurniture();if(r.removePropertyChangeListener(this.furnitureSizeChangeListener),null!=r&&r instanceof HomeFurnitureGroup)for(var l=r.getAllFurniture(),a=0;a<l.length;a++){l[a].removePropertyChangeListener(this.furnitureSizeChangeListener)}if(t.ResizedPieceOfFurniture.setPieceOfFurnitureSize(r,i,n,o),r.addPropertyChangeListener(this.furnitureSizeChangeListener),null!=r&&r instanceof HomeFurnitureGroup)for(l=r.getAllFurniture(),a=0;a<l.length;a++){l[a].addPropertyChangeListener(this.furnitureSizeChangeListener)}},t.prototype.resetPieceOfFurnitureSize=function(e){var t=e.getPieceOfFurniture();if(t.removePropertyChangeListener(this.furnitureSizeChangeListener),null!=t&&t instanceof HomeFurnitureGroup)for(var i=t.getAllFurniture(),n=0;n<i.length;n++){i[n].removePropertyChangeListener(this.furnitureSizeChangeListener)}if(e.reset(),t.addPropertyChangeListener(this.furnitureSizeChangeListener),null!=t&&t instanceof HomeFurnitureGroup)for(i=t.getAllFurniture(),n=0;n<i.length;n++){i[n].addPropertyChangeListener(this.furnitureSizeChangeListener)}},t.prototype.postLightPowerModification=function(e,i){var n=e.getPower();n!==i&&this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new t.LightPowerModificationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,i,e,n))},t.prototype.postPieceOfFurnitureNameOffset=function(e,i,n){var o=e.getNameXOffset(),r=e.getNameYOffset();o===i&&r===n||this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new t.PieceOfFurnitureNameOffsetModificationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,i,n,e,o,r))},t.prototype.postPieceOfFurnitureNameRotation=function(e,i){var n=e.getNameAngle();n!==i&&this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new t.PieceOfFurnitureNameRotationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,i,e,n))},t.prototype.postDimensionLineResize=function(e,i,n,o,r){var l,a;o?(l=e.getXStart(),a=e.getYStart()):(l=e.getXEnd(),a=e.getYEnd()),(l!==i||a!==n||r)&&this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new t.DimensionLineResizingUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,i,n,e,l,a,o,r))},t.prototype.postDimensionLineOffset=function(e,i){var n=e.getOffset();n!==i&&this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new t.DimensionLineOffsetModificationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,i,e,n))},t.prototype.postDimensionLinePitchRotation=function(e,i){var n=e.getPitch();n!==i&&this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new t.DimensionLinePitchRotationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,i,e,n))},t.prototype.postDimensionLineHeight=function(e,i){var n=e.getElevationEnd()-e.getElevationStart();n!==i&&this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new t.DimensionLineHeightResizingUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,i,e,n))},t.prototype.postDimensionLineElevation=function(e,i){var n=e.getElevationStart();n!==i&&this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new t.DimensionLineElevationModificationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,i,e,n))},t.prototype.postPolylineResize=function(e,i,n,o){var r=e.getPoints()[o],l=r[0],a=r[1];l===i&&a===n||this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new t.PolylineResizingUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,i,n,e,o,l,a))},t.prototype.postCompassRotation=function(e,i){var n=e.getNorthDirection();n!==i&&this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new t.CompassRotationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,i,e,n))},t.prototype.postCompassResize=function(e,i){var n=e.getDiameter();n!==i&&this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new t.CompassResizingUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,i,e,n))},t.prototype.getPathPoints=function(e,t){for(var i=[],n=null,o=e.getPathIterator(null);!o.isDone();o.next()){var r=[0,0];if(o.currentSegment(r)!==java.awt.geom.PathIterator.SEG_CLOSE&&(null==n||!function(e,t){if(null==e&&null==t)return!0;if(null==e||null==t)return!1;if(e.length!=t.length)return!1;for(var i=0;i<e.length;i++)if(e[i]!=t[i])return!1;return!0}(r,n))){var l=!1;if(t&&i.length>1){var a=i[i.length-2],s=n;l=java.awt.geom.Line2D.ptLineDistSq(a[0],a[1],s[0],s[1],r[0],r[1])<1e-4}l?i[i.length-1]=r:i.push(r),n=r}}return i.length>1&&function(e,t){if(null==e&&null==t)return!0;if(null==e||null==t)return!1;if(e.length!=t.length)return!1;for(var i=0;i<e.length;i++)if(e[i]!=t[i])return!1;return!0}(i[0],i[i.length-1])&&i.splice(i.length-1,1)[0],i.slice(0)},t.prototype.getRoomPathsFromWalls=function(){if(null==this.roomPathsCache){for(var e=this.getWallsArea(!1),t=this.getAreaPaths(e),i=new java.awt.geom.Area(e),n=0;n<t.length;n++){var o=t[n];i.add(new java.awt.geom.Area(o))}this.roomPathsCache=t,this.insideWallsAreaCache=i}return this.roomPathsCache},t.prototype.getAreaPaths=function(e){for(var t=[],i=null,n=null,o=e.getPathIterator(null,.5);!o.isDone();o.next()){var r=[0,0];switch(o.currentSegment(r)){case java.awt.geom.PathIterator.SEG_MOVETO:(i=new java.awt.geom.GeneralPath).moveTo(r[0],r[1]),n=r;break;case java.awt.geom.PathIterator.SEG_LINETO:(r[0]!==n[0]||r[1]!==n[1])&&java.awt.geom.Point2D.distanceSq(r[0],r[1],n[0],n[1])>1e-10&&(i.lineTo(r[0],r[1]),n=r);break;case java.awt.geom.PathIterator.SEG_CLOSE:i.closePath(),t.push(i)}}return t},t.prototype.getInsideWallsArea=function(){return null==this.insideWallsAreaCache&&this.getRoomPathsFromWalls(),this.insideWallsAreaCache},t.prototype.getWallsArea=function(e){if(!e&&null==this.wallsAreaCache||e&&null==this.wallsIncludingBaseboardsAreaCache){for(var t=new java.awt.geom.Area,i=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel(),n=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getWalls(),o=0;o<n.length;o++){var r=n[o];r.isAtLevel(i)&&t.add(new java.awt.geom.Area(this.getPath$float_A_A(r.getPoints$boolean(e))))}e?this.wallsIncludingBaseboardsAreaCache=t:this.wallsAreaCache=t}return e?this.wallsIncludingBaseboardsAreaCache:this.wallsAreaCache},t.prototype.getPath$float_A_A=function(e){var t=new java.awt.geom.GeneralPath;t.moveTo(e[0][0],e[0][1]);for(var i=1;i<e.length;i++)t.lineTo(e[i][0],e[i][1]);return t.closePath(),t},t.prototype.getPath=function(e){if(null!=e&&e instanceof Array&&(0==e.length||null==e[0]||e[0]instanceof Array)||null===e)return this.getPath$float_A_A(e);if(null!=e&&e instanceof java.awt.geom.Area||null===e)return this.getPath$java_awt_geom_Area(e);throw new Error("invalid overload")},t.prototype.getPath$java_awt_geom_Area=function(e){for(var t=new java.awt.geom.GeneralPath,i=[0,0],n=e.getPathIterator(null,.5);!n.isDone();n.next())switch(n.currentSegment(i)){case java.awt.geom.PathIterator.SEG_MOVETO:t.moveTo(i[0],i[1]);break;case java.awt.geom.PathIterator.SEG_LINETO:t.lineTo(i[0],i[1])}return t},t.prototype.selectLevelFromSelectedItems=function(){for(var e=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel(),t=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems(),i=0;i<t.length;i++){if(null!=(n=t[i])&&null!=n.constructor&&null!=n.constructor.__interfaces&&n.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Elevatable")>=0&&n.isAtLevel(e))return}for(i=0;i<t.length;i++){var n;if(null!=(n=t[i])&&null!=n.constructor&&null!=n.constructor.__interfaces&&n.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Elevatable")>=0){this.setSelectedLevel(n.getLevel());break}}},t.SCALE_VISUAL_PROPERTY="com.eteks.sweethome3d.SweetHome3D.PlanScale",t.PIXEL_MARGIN=4,t.INDICATOR_PIXEL_MARGIN=5,t.WALL_ENDS_PIXEL_MARGIN=2,t}(FurnitureController);function Node3D(){}function Shape3D(e,t){Node3D.call(this),void 0===e?(e=null,t=null):void 0===t&&(t=null),this.appearance=t,this.bounds=null,this.geometries=[],null!==e&&this.geometries.push(e)}function Background3D(e){Node3D.call(this),this.geometry=e,e.parent=this}function Light3D(e){Node3D.call(this),this.color=e}function AmbientLight3D(e){Light3D.call(this,e)}function DirectionalLight3D(e,t){Light3D.call(this,e),this.direction=t}function Group3D(){Node3D.call(this),this.children=[]}function BranchGroup3D(){Group3D.call(this)}function SharedGroup3D(){Group3D.call(this)}function Link3D(e){Node3D.call(this),this.sharedGroup=e}function TransformGroup3D(e){Group3D.call(this),this.transform=void 0!==e?mat4.clone(e):mat4.create()}function Appearance3D(e){void 0!==e&&(this.name=e)}function IndexedGeometryArray3D(e,t,i,n){this.vertices=e,this.vertexIndices=t,this.textureCoordinates=i,this.textureCoordinateIndices=n,this.textureCoordinatesDefined=this.textureCoordinateIndices&&this.textureCoordinateIndices.length>0}function IndexedLineArray3D(e,t,i,n){IndexedGeometryArray3D.call(this,e,t,i,n)}function IndexedTriangleArray3D(e,t,i,n,o,r){IndexedGeometryArray3D.call(this,e,t,i,n),this.normals=o,this.normalIndices=r}function BoundingBox3D(e,t){this.lower=void 0!==e?vec3.clone(e):vec3.fromValues(-1,-1,-1),this.upper=void 0!==t?vec3.clone(t):vec3.fromValues(1,1,1)}function Box3D(e,t,i,n){Shape3D.call(this,new IndexedTriangleArray3D([vec3.fromValues(-e,-t,-i),vec3.fromValues(e,-t,-i),vec3.fromValues(e,-t,i),vec3.fromValues(-e,-t,i),vec3.fromValues(-e,t,-i),vec3.fromValues(-e,t,i),vec3.fromValues(e,t,i),vec3.fromValues(e,t,-i)],[0,1,2,0,2,3,4,5,6,4,6,7,0,3,5,0,5,4,1,7,6,1,6,2,0,4,7,0,7,1,2,6,5,2,5,3],[vec2.fromValues(0,0),vec2.fromValues(1,0),vec2.fromValues(1,1),vec2.fromValues(0,1)],[0,1,2,0,2,3,3,0,1,3,1,2,0,1,2,0,2,3,1,2,3,1,3,0,1,2,3,1,3,0,1,2,3,1,3,0],[vec3.fromValues(0,-1,0),vec3.fromValues(0,1,0),vec3.fromValues(-1,0,0),vec3.fromValues(1,0,0),vec3.fromValues(0,0,-1),vec3.fromValues(0,0,1)],[0,0,0,0,0,0,1,1,1,1,1,1,2,2,2,2,2,2,3,3,3,3,3,3,4,4,4,4,4,4,5,5,5,5,5,5]),n),this.bounds=new BoundingBox3D(vec3.fromValues(-e,-t,-i),vec3.fromValues(e,t,i))}function GeometryInfo3D(e){this.type=e}function IncorrectFormat3DException(e){this.message=e}function HTMLCanvas3D(e,t){if(this.scene=null,this.textures=[],this.sharedGeometries=[],this.sceneGeometries=[],this.backgroundGeometries=[],this.lights=[],this.fieldOfView=45*Math.PI/180,this.frontClipDistance=.1,this.backClipDistance=100,this.projectionPolicy=HTMLCanvas3D.PERSPECTIVE_PROJECTION,this.offscreen=!0===t,this.canvas="string"==typeof e?document.getElementById(e):e,this.gl=this.canvas.getContext("webgl"),!this.gl&&(this.gl=this.canvas.getContext("experimental-webgl"),!this.gl))throw"No WebGL";this.updateViewportSize(),this.shaderProgram=this.gl.createProgram();var i=this.createShader(this.gl.VERTEX_SHADER,"attribute vec3 vertexPosition;attribute vec3 vertexNormal;attribute vec2 vertexTextureCoord;uniform mat4 modelViewTransform;uniform mat4 projectionTransform;uniform bool textureCoordinatesGenerated;uniform vec4 planeS;uniform vec4 planeT;uniform mat3 textureCoordTransform;uniform mat3 normalTransform;uniform bool ignoreNormal;uniform bool backFaceNormalFlip;uniform bool lightingEnabled;uniform bool useTextures;varying vec2 varTextureCoord;varying vec4 varVertexPosition;varying vec3 varTransformedNormal;void main(void) {  varVertexPosition = modelViewTransform * vec4(vertexPosition, 1.0);  gl_Position = projectionTransform * varVertexPosition;  if (useTextures) {    if (textureCoordinatesGenerated) {      varTextureCoord = vec2(vertexPosition.x * planeS.x + vertexPosition.y * planeS.y          + vertexPosition.z * planeS.z + planeS.w,            vertexPosition.x * planeT.x + vertexPosition.y * planeT.y          + vertexPosition.z * planeT.z + planeT.w);    } else {      varTextureCoord = vec2(vertexTextureCoord);    }    varTextureCoord = vec2(textureCoordTransform * vec3(varTextureCoord, 1));  }  if (lightingEnabled) {    vec3 normal;    if (ignoreNormal) {      normal = vec3(1., 1., 1.);    } else {      normal = vertexNormal;      if (backFaceNormalFlip) {        normal = -normal;      }    }    varTransformedNormal = normalize(normalTransform * normal);  }}");this.gl.attachShader(this.shaderProgram,i);var n=this.createShader(this.gl.FRAGMENT_SHADER,"precision mediump float;uniform vec3  vertexDiffuseColor;uniform vec3  vertexSpecularColor;uniform float shininess;uniform sampler2D sampler;uniform float alpha;uniform bool  useTextures;uniform bool  lightingEnabled;uniform vec3  ambientColor;uniform int   directionalLightCount;uniform vec3  lightDirections["+HTMLCanvas3D.MAX_DIRECTIONAL_LIGHT+"];uniform vec3  directionalLightColors["+HTMLCanvas3D.MAX_DIRECTIONAL_LIGHT+"];varying vec2  varTextureCoord;varying vec4  varVertexPosition;varying vec3  varTransformedNormal;void main(void) {  vec3 lightWeight;  if (lightingEnabled) {    lightWeight = ambientColor;    if (directionalLightCount > 0) {      vec3 diffuseLightWeight = vec3(0., 0., 0.);      vec3 specularLightWeight = vec3(0., 0., 0.);      vec3 eyeDirection = vec3(0., 0., 0.);      bool computeSpecularLightWeight = false;      if (vertexSpecularColor.r > 0.          && vertexSpecularColor.g > 0.          && vertexSpecularColor.b > 0.) {        eyeDirection = normalize(-varVertexPosition.xyz);        computeSpecularLightWeight = length(eyeDirection) <= 1.0001;      }      for (int i = 0; i < "+HTMLCanvas3D.MAX_DIRECTIONAL_LIGHT+"; i++) {        if (i >= directionalLightCount) {          break;        }        float directionalLightWeight = max(dot(varTransformedNormal, lightDirections[i]), 0.);        diffuseLightWeight += directionalLightColors[i] * directionalLightWeight;        if (computeSpecularLightWeight) {          vec3 reflectionDirection = reflect(-lightDirections[i], varTransformedNormal);          specularLightWeight += directionalLightColors[i] * pow(max(dot(reflectionDirection, eyeDirection), 0.), shininess);        }      }      lightWeight += vertexDiffuseColor * diffuseLightWeight;      if (computeSpecularLightWeight) {        lightWeight += vertexSpecularColor * specularLightWeight;      }    }  } else {    lightWeight = vertexDiffuseColor;  }  vec4 fragmentColor;  if (useTextures) {    fragmentColor = texture2D(sampler, vec2(varTextureCoord.s, varTextureCoord.t));  } else {    fragmentColor = vec4(1., 1., 1., 1.);  }  gl_FragColor = vec4(fragmentColor.rgb * lightWeight * alpha, fragmentColor.a * alpha);}");this.gl.attachShader(this.shaderProgram,n),this.gl.linkProgram(this.shaderProgram),this.shaderProgram.vertexPositionAttribute=this.gl.getAttribLocation(this.shaderProgram,"vertexPosition"),this.shaderProgram.normalAttribute=this.gl.getAttribLocation(this.shaderProgram,"vertexNormal"),this.shaderProgram.textureCoordAttribute=this.gl.getAttribLocation(this.shaderProgram,"vertexTextureCoord"),this.shaderProgram.projectionTransform=this.gl.getUniformLocation(this.shaderProgram,"projectionTransform"),this.shaderProgram.modelViewTransform=this.gl.getUniformLocation(this.shaderProgram,"modelViewTransform"),this.shaderProgram.textureCoordinatesGenerated=this.gl.getUniformLocation(this.shaderProgram,"textureCoordinatesGenerated"),this.shaderProgram.planeS=this.gl.getUniformLocation(this.shaderProgram,"planeS"),this.shaderProgram.planeT=this.gl.getUniformLocation(this.shaderProgram,"planeT"),this.shaderProgram.textureCoordTransform=this.gl.getUniformLocation(this.shaderProgram,"textureCoordTransform"),this.shaderProgram.normalTransform=this.gl.getUniformLocation(this.shaderProgram,"normalTransform"),this.shaderProgram.ignoreNormal=this.gl.getUniformLocation(this.shaderProgram,"ignoreNormal"),this.shaderProgram.backFaceNormalFlip=this.gl.getUniformLocation(this.shaderProgram,"backFaceNormalFlip"),this.shaderProgram.ambientColor=this.gl.getUniformLocation(this.shaderProgram,"ambientColor"),this.shaderProgram.lightingEnabled=this.gl.getUniformLocation(this.shaderProgram,"lightingEnabled"),this.shaderProgram.directionalLightCount=this.gl.getUniformLocation(this.shaderProgram,"directionalLightCount"),this.shaderProgram.lightDirections=this.gl.getUniformLocation(this.shaderProgram,"lightDirections"),this.shaderProgram.directionalLightColors=this.gl.getUniformLocation(this.shaderProgram,"directionalLightColors"),this.shaderProgram.vertexDiffuseColor=this.gl.getUniformLocation(this.shaderProgram,"vertexDiffuseColor"),this.shaderProgram.vertexSpecularColor=this.gl.getUniformLocation(this.shaderProgram,"vertexSpecularColor"),this.shaderProgram.shininess=this.gl.getUniformLocation(this.shaderProgram,"shininess"),this.shaderProgram.alpha=this.gl.getUniformLocation(this.shaderProgram,"alpha"),this.shaderProgram.useTextures=this.gl.getUniformLocation(this.shaderProgram,"useTextures"),this.gl.useProgram(this.shaderProgram),this.viewPlatformTransform=mat4.create(),mat4.translate(this.viewPlatformTransform,this.viewPlatformTransform,[0,0,-2.4]),this.geometryAmbientColor=vec3.create(),this.geometrySpecularColor=vec3.create(),this.geometryModelViewTransform=mat4.create(),this.geometryNormalTransform=mat3.create(),this.shaderAmbientColor=vec3.create(),this.gl.uniform3fv(this.shaderProgram.ambientColor,this.shaderAmbientColor),this.shaderSpecularColor=vec3.create(),this.gl.uniform3fv(this.shaderProgram.vertexSpecularColor,this.shaderSpecularColor),this.geometryDiffuseColor=vec3.create(),this.shaderDiffuseColor=vec3.fromValues(1,1,1),this.gl.uniform3fv(this.shaderProgram.vertexDiffuseColor,this.shaderDiffuseColor),this.shaderModelViewTransform=mat4.create(),this.gl.uniformMatrix4fv(this.shaderProgram.modelViewTransform,!1,this.shaderModelViewTransform),this.shaderNormalTransform=mat3.create(),this.gl.uniformMatrix3fv(this.shaderProgram.normalTransform,!1,this.shaderNormalTransform),this.shaderTextureTransform=mat3.create(),this.gl.uniformMatrix3fv(this.shaderProgram.textureCoordTransform,!1,this.shaderTextureTransform),this.shaderLightingEnabled=!0,this.gl.uniform1i(this.shaderProgram.lightingEnabled,this.shaderLightingEnabled),this.shaderShininess=1,this.gl.uniform1f(this.shaderProgram.shininess,this.shaderShininess),this.shaderIgnoreNormal=!1,this.gl.uniform1i(this.shaderProgram.ignoreNormal,this.shaderIgnoreNormal),this.shaderBackFaceNormalFlip=!1,this.gl.uniform1i(this.shaderProgram.backFaceNormalFlip,this.shaderBackFaceNormalFlip),this.shaderTextureCoordinatesGenerated=!1,this.gl.uniform1i(this.shaderProgram.textureCoordinatesGenerated,!1),this.shaderUseTextures=!1,this.gl.uniform1i(this.shaderProgram.useTextures,!1),this.shaderAlpha=1,this.gl.uniform1f(this.shaderProgram.alpha,this.shaderAlpha),this.gl.enable(this.gl.CULL_FACE),this.gl.cullFace(this.gl.BACK),this.canvasNeededRepaint=!1,this.pickingFrameBufferNeededRepaint=!0,this.errorTexture=this.gl.createTexture(),this.gl.bindTexture(this.gl.TEXTURE_2D,this.errorTexture);var o=new Uint8Array([255,0,0,255]);this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,1,1,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,o),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.bindTexture(this.gl.TEXTURE_2D,null)}PlanController.__class="com.eteks.sweethome3d.viewcontroller.PlanController",PlanController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"],function(e){var t=function(){function t(e){void 0===this.__name&&(this.__name=null),this.__name=e}return t.SELECTION_$LI$=function(){return null==t.SELECTION&&(t.SELECTION=new e.Mode("SELECTION")),t.SELECTION},t.PANNING_$LI$=function(){return null==t.PANNING&&(t.PANNING=new e.Mode("PANNING")),t.PANNING},t.WALL_CREATION_$LI$=function(){return null==t.WALL_CREATION&&(t.WALL_CREATION=new e.Mode("WALL_CREATION")),t.WALL_CREATION},t.ROOM_CREATION_$LI$=function(){return null==t.ROOM_CREATION&&(t.ROOM_CREATION=new e.Mode("ROOM_CREATION")),t.ROOM_CREATION},t.POLYLINE_CREATION_$LI$=function(){return null==t.POLYLINE_CREATION&&(t.POLYLINE_CREATION=new e.Mode("POLYLINE_CREATION")),t.POLYLINE_CREATION},t.DIMENSION_LINE_CREATION_$LI$=function(){return null==t.DIMENSION_LINE_CREATION&&(t.DIMENSION_LINE_CREATION=new e.Mode("DIMENSION_LINE_CREATION")),t.DIMENSION_LINE_CREATION},t.LABEL_CREATION_$LI$=function(){return null==t.LABEL_CREATION&&(t.LABEL_CREATION=new e.Mode("LABEL_CREATION")),t.LABEL_CREATION},t.prototype.name=function(){return this.__name},t.prototype.toString=function(){return this.__name},t}();e.Mode=t,t.__class="com.eteks.sweethome3d.viewcontroller.PlanController.Mode";var i=function(t){function i(i,n,o,r,l,a){var s=t.call(this,o,e,"undoLockBasePlan")||this;return void 0===s.controller&&(s.controller=null),void 0===s.home&&(s.home=null),void 0===s.oldSelection&&(s.oldSelection=null),void 0===s.allLevelsSelection&&(s.allLevelsSelection=!1),void 0===s.newSelectedItems&&(s.newSelectedItems=null),s.controller=i,s.home=n,s.oldSelection=r,s.allLevelsSelection=l,s.newSelectedItems=a,s}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),this.home.setBasePlanLocked(!1),this.controller.selectAndShowItems$java_util_List$boolean(this.oldSelection.slice(0),this.allLevelsSelection)},i.prototype.redo=function(){t.prototype.redo.call(this),this.home.setBasePlanLocked(!0),this.controller.selectAndShowItems$java_util_List$boolean(this.newSelectedItems.slice(0),this.allLevelsSelection)},i}(LocalizedUndoableEdit);e.LockingUndoableEdit=i,i.__class="com.eteks.sweethome3d.viewcontroller.PlanController.LockingUndoableEdit",i.__interfaces=["javax.swing.undo.UndoableEdit"];var n=function(t){function i(i,n,o,r,l){var a=t.call(this,o,e,"undoUnlockBasePlan")||this;return void 0===a.controller&&(a.controller=null),void 0===a.home&&(a.home=null),void 0===a.selectedItems&&(a.selectedItems=null),void 0===a.allLevelsSelection&&(a.allLevelsSelection=!1),a.controller=i,a.home=n,a.selectedItems=r,a.allLevelsSelection=l,a}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),this.home.setBasePlanLocked(!0),this.controller.selectAndShowItems$java_util_List$boolean(this.selectedItems.slice(0),this.allLevelsSelection)},i.prototype.redo=function(){t.prototype.redo.call(this),this.home.setBasePlanLocked(!1),this.controller.selectAndShowItems$java_util_List$boolean(this.selectedItems.slice(0),!1)},i}(LocalizedUndoableEdit);e.UnlockingUndoableEdit=n,n.__class="com.eteks.sweethome3d.viewcontroller.PlanController.UnlockingUndoableEdit",n.__interfaces=["javax.swing.undo.UndoableEdit"];var o=function(t){function i(i,n,o,r,l,a){var s=t.call(this,n,e,"undoFlipName")||this;return void 0===s.controller&&(s.controller=null),void 0===s.allLevelsSelection&&(s.allLevelsSelection=!1),void 0===s.items&&(s.items=null),void 0===s.itemTextBaseOffsets&&(s.itemTextBaseOffsets=null),void 0===s.horizontalFlip&&(s.horizontalFlip=!1),s.controller=i,s.allLevelsSelection=o,s.items=r,s.itemTextBaseOffsets=l,s.horizontalFlip=a,s}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),this.controller.doFlipItems(this.items,this.itemTextBaseOffsets,this.horizontalFlip),this.controller.selectAndShowItems$java_util_List$boolean(this.items.slice(0),this.allLevelsSelection)},i.prototype.redo=function(){t.prototype.redo.call(this),this.controller.doFlipItems(this.items,this.itemTextBaseOffsets,this.horizontalFlip),this.controller.selectAndShowItems$java_util_List$boolean(this.items.slice(0),this.allLevelsSelection)},i}(LocalizedUndoableEdit);e.FlippingUndoableEdit=o,o.__class="com.eteks.sweethome3d.viewcontroller.PlanController.FlippingUndoableEdit",o.__interfaces=["javax.swing.undo.UndoableEdit"];var r=function(t){function i(i,n,o,r,l,a){var s=t.call(this,n,e,"undoJoinWallsName")||this;return void 0===s.controller&&(s.controller=null),void 0===s.oldSelection&&(s.oldSelection=null),void 0===s.allLevelsSelection&&(s.allLevelsSelection=!1),void 0===s.joinedWalls&&(s.joinedWalls=null),void 0===s.joinPoint&&(s.joinPoint=null),s.controller=i,s.oldSelection=o,s.allLevelsSelection=r,s.joinedWalls=l,s.joinPoint=a,s}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this);for(var e=0;e<this.joinedWalls.length;e++){var i=this.joinedWalls[e],n=i.getWall();n.setWallAtStart(i.getWallAtStart()),null!=i.getWallAtStart()&&(i.isJoinedAtEndOfWallAtStart()?i.getWallAtStart().setWallAtEnd(n):i.getWallAtStart().setWallAtStart(n)),n.setWallAtEnd(i.getWallAtEnd()),null!=i.getWallAtEnd()&&(i.isJoinedAtStartOfWallAtEnd()?i.getWallAtEnd().setWallAtStart(n):i.getWallAtEnd().setWallAtEnd(n)),n.setXStart(i.getXStart()),n.setYStart(i.getYStart()),n.setXEnd(i.getXEnd()),n.setYEnd(i.getYEnd())}this.controller.selectAndShowItems$java_util_List$boolean(this.oldSelection.slice(0),this.allLevelsSelection)},i.prototype.redo=function(){t.prototype.redo.call(this),this.controller.doJoinWalls(this.joinedWalls,this.joinPoint)},i}(LocalizedUndoableEdit);e.WallsJoiningUndoableEdit=r,r.__class="com.eteks.sweethome3d.viewcontroller.PlanController.WallsJoiningUndoableEdit",r.__interfaces=["javax.swing.undo.UndoableEdit"];var l=function(t){function i(i,n,o,r,l){var a=t.call(this,n,e,"undoReverseWallsDirectionName")||this;return void 0===a.controller&&(a.controller=null),void 0===a.oldSelection&&(a.oldSelection=null),void 0===a.allLevelsSelection&&(a.allLevelsSelection=!1),void 0===a.walls&&(a.walls=null),a.controller=i,a.oldSelection=o,a.allLevelsSelection=r,a.walls=l,a}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),this.controller.doReverseWallsDirection(this.walls),this.controller.selectAndShowItems$java_util_List$boolean(this.oldSelection.slice(0),this.allLevelsSelection)},i.prototype.redo=function(){t.prototype.redo.call(this),this.controller.doReverseWallsDirection(this.walls),this.controller.selectAndShowItems$java_util_List$boolean(this.walls.slice(0),!1)},i}(LocalizedUndoableEdit);e.WallsDirectionReversingUndoableEdit=l,l.__class="com.eteks.sweethome3d.viewcontroller.PlanController.WallsDirectionReversingUndoableEdit",l.__interfaces=["javax.swing.undo.UndoableEdit"];var a=function(t){function i(i,n,o,r,l,a,s,h,u){var d=t.call(this,n,e,"undoSplitWallName")||this;return void 0===d.controller&&(d.controller=null),void 0===d.oldSelection&&(d.oldSelection=null),void 0===d.oldBasePlanLocked&&(d.oldBasePlanLocked=!1),void 0===d.oldAllLevelsSelection&&(d.oldAllLevelsSelection=!1),void 0===d.splitJoinedWall&&(d.splitJoinedWall=null),void 0===d.firstJoinedWall&&(d.firstJoinedWall=null),void 0===d.secondJoinedWall&&(d.secondJoinedWall=null),void 0===d.newBasePlanLocked&&(d.newBasePlanLocked=!1),d.controller=i,d.oldSelection=o,d.oldBasePlanLocked=r,d.oldAllLevelsSelection=l,d.splitJoinedWall=a,d.firstJoinedWall=s,d.secondJoinedWall=h,d.newBasePlanLocked=u,d}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),this.controller.doDeleteWalls([this.firstJoinedWall,this.secondJoinedWall],this.oldBasePlanLocked),this.controller.doAddWalls([this.splitJoinedWall],this.oldBasePlanLocked),this.controller.selectAndShowItems$java_util_List$boolean(this.oldSelection.slice(0),this.oldAllLevelsSelection)},i.prototype.redo=function(){t.prototype.redo.call(this),this.controller.doDeleteWalls([this.splitJoinedWall],this.newBasePlanLocked),this.controller.doAddWalls([this.firstJoinedWall,this.secondJoinedWall],this.newBasePlanLocked),this.controller.selectAndShowItems$java_util_List$boolean([this.firstJoinedWall.getWall()].slice(0),!1)},i}(LocalizedUndoableEdit);e.WallSplittingUndoableEdit=a,a.__class="com.eteks.sweethome3d.viewcontroller.PlanController.WallSplittingUndoableEdit",a.__interfaces=["javax.swing.undo.UndoableEdit"];var s=function(t){function i(i,n,o,r,l,a,s){var h=t.call(this,n,e,"undoModifyTextStyleName")||this;return void 0===h.controller&&(h.controller=null),void 0===h.oldSelection&&(h.oldSelection=null),void 0===h.allLevelsSelection&&(h.allLevelsSelection=!1),void 0===h.oldStyles&&(h.oldStyles=null),void 0===h.items&&(h.items=null),void 0===h.styles&&(h.styles=null),h.controller=i,h.oldSelection=o,h.allLevelsSelection=r,h.oldStyles=l,h.items=a,h.styles=s,h}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),e.doModifyTextStyle(this.items,this.oldStyles),this.controller.selectAndShowItems$java_util_List$boolean(this.oldSelection.slice(0),this.allLevelsSelection)},i.prototype.redo=function(){t.prototype.redo.call(this),e.doModifyTextStyle(this.items,this.styles),this.controller.selectAndShowItems$java_util_List$boolean(this.oldSelection.slice(0),this.allLevelsSelection)},i}(LocalizedUndoableEdit);e.TextStyleModificationUndoableEdit=s,s.__class="com.eteks.sweethome3d.viewcontroller.PlanController.TextStyleModificationUndoableEdit",s.__interfaces=["javax.swing.undo.UndoableEdit"];var h=function(t){function i(i,n,o,r,l,a,s,h,u){var d=t.call(this,o,e,"undoAddLevel")||this;return void 0===d.controller&&(d.controller=null),void 0===d.home&&(d.home=null),void 0===d.oldSelection&&(d.oldSelection=null),void 0===d.allLevelsSelection&&(d.allLevelsSelection=!1),void 0===d.oldSelectedLevel&&(d.oldSelectedLevel=null),void 0===d.level0&&(d.level0=null),void 0===d.homeBackgroundImage&&(d.homeBackgroundImage=null),void 0===d.newLevel&&(d.newLevel=null),d.controller=i,d.home=n,d.oldSelection=r,d.allLevelsSelection=l,d.oldSelectedLevel=a,d.level0=s,d.homeBackgroundImage=h,d.newLevel=u,d}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),this.controller.setSelectedLevel(this.oldSelectedLevel),this.home.deleteLevel(this.newLevel),null!=this.level0&&(this.home.setBackgroundImage(this.homeBackgroundImage),this.controller.moveHomeItemsToLevel(this.oldSelectedLevel),this.home.deleteLevel(this.level0)),this.controller.selectAndShowItems$java_util_List$boolean(this.oldSelection.slice(0),this.allLevelsSelection)},i.prototype.redo=function(){t.prototype.redo.call(this),null!=this.level0&&(this.home.addLevel(this.level0),this.controller.moveHomeItemsToLevel(this.level0),this.level0.setBackgroundImage(this.homeBackgroundImage),this.home.setBackgroundImage(null)),this.home.addLevel(this.newLevel),this.controller.setSelectedLevel(this.newLevel)},i}(LocalizedUndoableEdit);e.LevelAdditionUndoableEdit=h,h.__class="com.eteks.sweethome3d.viewcontroller.PlanController.LevelAdditionUndoableEdit",h.__interfaces=["javax.swing.undo.UndoableEdit"];var u=function(t){function i(i,n,o){var r=t.call(this,n,e,"undoModifyLevelViewabilityName")||this;return void 0===r.controller&&(r.controller=null),void 0===r.selectedLevel&&(r.selectedLevel=null),r.controller=i,r.selectedLevel=o,r}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),this.controller.setSelectedLevel(this.selectedLevel),this.selectedLevel.setViewable(!this.selectedLevel.isViewable())},i.prototype.redo=function(){t.prototype.redo.call(this),this.controller.setSelectedLevel(this.selectedLevel),this.selectedLevel.setViewable(!this.selectedLevel.isViewable())},i}(LocalizedUndoableEdit);e.LevelViewabilityModificationUndoableEdit=u,u.__class="com.eteks.sweethome3d.viewcontroller.PlanController.LevelViewabilityModificationUndoableEdit",u.__interfaces=["javax.swing.undo.UndoableEdit"];var d=function(t){function i(i,n,o,r,l){var a=t.call(this,n,e,"undoModifyLevelViewabilityName")||this;return void 0===a.controller&&(a.controller=null),void 0===a.selectedLevel&&(a.selectedLevel=null),void 0===a.selectedLevelViewable&&(a.selectedLevelViewable=!1),void 0===a.viewableLevels&&(a.viewableLevels=null),a.controller=i,a.selectedLevel=o,a.selectedLevelViewable=r,a.viewableLevels=l,a}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),this.controller.setSelectedLevel(this.selectedLevel),e.setLevelsViewability(this.viewableLevels,!0),this.selectedLevel.setViewable(this.selectedLevelViewable)},i.prototype.redo=function(){t.prototype.redo.call(this),this.controller.setSelectedLevel(this.selectedLevel),e.setLevelsViewability(this.viewableLevels,!1),this.selectedLevel.setViewable(!0)},i}(LocalizedUndoableEdit);e.LevelsViewabilityModificationUndoableEdit=d,d.__class="com.eteks.sweethome3d.viewcontroller.PlanController.LevelsViewabilityModificationUndoableEdit",d.__interfaces=["javax.swing.undo.UndoableEdit"];var c=function(t){function i(i,n,o,r){var l=t.call(this,n,e,"undoModifyLevelViewabilityName")||this;return void 0===l.controller&&(l.controller=null),void 0===l.selectedLevel&&(l.selectedLevel=null),void 0===l.unviewableLevels&&(l.unviewableLevels=null),l.controller=i,l.selectedLevel=o,l.unviewableLevels=r,l}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),this.controller.setSelectedLevel(this.selectedLevel),e.setLevelsViewability(this.unviewableLevels,!1)},i.prototype.redo=function(){t.prototype.redo.call(this),this.controller.setSelectedLevel(this.selectedLevel),e.setLevelsViewability(this.unviewableLevels,!0)},i}(LocalizedUndoableEdit);e.AllLevelsViewabilityModificationUndoableEdit=c,c.__class="com.eteks.sweethome3d.viewcontroller.PlanController.AllLevelsViewabilityModificationUndoableEdit",c.__interfaces=["javax.swing.undo.UndoableEdit"];var p=function(t){function i(i,n,o,r,l,a,s){var h=t.call(this,o,e,"undoDeleteSelectedLevel")||this;return void 0===h.controller&&(h.controller=null),void 0===h.home&&(h.home=null),void 0===h.oldSelectedLevel&&(h.oldSelectedLevel=null),void 0===h.remainingLevel&&(h.remainingLevel=null),void 0===h.remainingLevelElevation&&(h.remainingLevelElevation=null),void 0===h.remainingLevelViewable&&(h.remainingLevelViewable=!1),h.controller=i,h.home=n,h.oldSelectedLevel=r,h.remainingLevel=l,h.remainingLevelElevation=a,h.remainingLevelViewable=s,h}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),null!=this.remainingLevel&&(this.remainingLevel.setElevation(this.remainingLevelElevation),this.remainingLevel.setViewable(this.remainingLevelViewable)),this.home.addLevel(this.oldSelectedLevel),this.controller.setSelectedLevel(this.oldSelectedLevel)},i.prototype.redo=function(){t.prototype.redo.call(this),this.home.deleteLevel(this.oldSelectedLevel),null!=this.remainingLevel&&(this.remainingLevel.setElevation(0),this.remainingLevel.setViewable(!0))},i}(LocalizedUndoableEdit);e.LevelDeletionUndoableEdit=p,p.__class="com.eteks.sweethome3d.viewcontroller.PlanController.LevelDeletionUndoableEdit",p.__interfaces=["javax.swing.undo.UndoableEdit"];var g=function(t){function i(i,n,o,r,l,a,s){var h=t.call(this,n,e,"undoAddRoomPointName")||this;return void 0===h.controller&&(h.controller=null),void 0===h.oldSelection&&(h.oldSelection=null),void 0===h.room&&(h.room=null),void 0===h.index&&(h.index=0),void 0===h.x&&(h.x=0),void 0===h.y&&(h.y=0),h.controller=i,h.oldSelection=o,h.room=r,h.index=l,h.x=a,h.y=s,h}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),this.room.removePoint(this.index),this.controller.selectAndShowItems$java_util_List(this.oldSelection.slice(0))},i.prototype.redo=function(){t.prototype.redo.call(this),this.room.addPoint$float$float$int(this.x,this.y,this.index),this.controller.selectAndShowItems$java_util_List([this.room].slice(0))},i}(LocalizedUndoableEdit);e.RoomPointAdditionUndoableEdit=g,g.__class="com.eteks.sweethome3d.viewcontroller.PlanController.RoomPointAdditionUndoableEdit",g.__interfaces=["javax.swing.undo.UndoableEdit"];var m=function(t){function i(i,n,o,r,l,a,s){var h=t.call(this,n,e,"undoDeleteRoomPointName")||this;return void 0===h.controller&&(h.controller=null),void 0===h.oldSelection&&(h.oldSelection=null),void 0===h.room&&(h.room=null),void 0===h.index&&(h.index=0),void 0===h.xPoint&&(h.xPoint=0),void 0===h.yPoint&&(h.yPoint=0),h.controller=i,h.oldSelection=o,h.room=r,h.index=l,h.xPoint=a,h.yPoint=s,h}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),this.room.addPoint$float$float$int(this.xPoint,this.yPoint,this.index),this.controller.selectAndShowItems$java_util_List(this.oldSelection.slice(0))},i.prototype.redo=function(){t.prototype.redo.call(this),this.room.removePoint(this.index),this.controller.selectAndShowItems$java_util_List([this.room].slice(0))},i}(LocalizedUndoableEdit);e.RoomPointDeletionUndoableEdit=m,m.__class="com.eteks.sweethome3d.viewcontroller.PlanController.RoomPointDeletionUndoableEdit",m.__interfaces=["javax.swing.undo.UndoableEdit"];var f=function(t){function i(i,n,o,r,l,a){var s=t.call(this,n,e,"undoRecomputeRoomPointsName")||this;return void 0===s.controller&&(s.controller=null),void 0===s.oldSelection&&(s.oldSelection=null),void 0===s.room&&(s.room=null),void 0===s.oldPoints&&(s.oldPoints=null),void 0===s.newPoints&&(s.newPoints=null),s.controller=i,s.oldSelection=o,s.room=r,s.oldPoints=l,s.newPoints=a,s}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),this.room.setPoints(this.oldPoints),this.controller.selectAndShowItems$java_util_List(this.oldSelection.slice(0))},i.prototype.redo=function(){t.prototype.redo.call(this),this.room.setPoints(this.newPoints),this.controller.selectAndShowItems$java_util_List([this.room].slice(0))},i}(LocalizedUndoableEdit);e.RoomPointsModificationUndoableEdit=f,f.__class="com.eteks.sweethome3d.viewcontroller.PlanController.RoomPointsModificationUndoableEdit",f.__interfaces=["javax.swing.undo.UndoableEdit"];var v=function(e){function t(t,i,n,o){var r=e.call(this)||this;return void 0===r.controller&&(r.controller=null),void 0===r.home&&(r.home=null),void 0===r.allLevelsSelection&&(r.allLevelsSelection=!1),void 0===r.selectedItems&&(r.selectedItems=null),r.controller=t,r.home=i,r.allLevelsSelection=n,r.selectedItems=o,r}return __extends(t,e),t.prototype.undo=function(){e.prototype.undo.call(this),this.controller.selectAndShowItems$java_util_List$boolean(this.selectedItems.slice(0),this.allLevelsSelection)},t.prototype.redo=function(){e.prototype.redo.call(this),this.home.removeSelectionListener(this.controller.getSelectionListener())},t}(javax.swing.undo.AbstractUndoableEdit);e.ItemsDeletionStartUndoableEdit=v,v.__class="com.eteks.sweethome3d.viewcontroller.PlanController.ItemsDeletionStartUndoableEdit",v.__interfaces=["javax.swing.undo.UndoableEdit"];var _=function(e){function t(t,i){var n=e.call(this)||this;return void 0===n.controller&&(n.controller=null),void 0===n.home&&(n.home=null),n.controller=t,n.home=i,n}return __extends(t,e),t.prototype.redo=function(){e.prototype.redo.call(this),this.home.addSelectionListener(this.controller.getSelectionListener())},t}(javax.swing.undo.AbstractUndoableEdit);e.ItemsDeletionEndUndoableEdit=_,_.__class="com.eteks.sweethome3d.viewcontroller.PlanController.ItemsDeletionEndUndoableEdit",_.__interfaces=["javax.swing.undo.UndoableEdit"];var S=function(t){function i(i,n,o,r,l,a,s,h,u,d,c,p,g,m,f,v){var _=t.call(this,n,e,"undoDeleteSelectionName")||this;return void 0===_.controller&&(_.controller=null),void 0===_.basePlanLocked&&(_.basePlanLocked=!1),void 0===_.allLevelsSelection&&(_.allLevelsSelection=!1),void 0===_.deletedItems&&(_.deletedItems=null),void 0===_.joinedDeletedWalls&&(_.joinedDeletedWalls=null),void 0===_.rooms&&(_.rooms=null),void 0===_.roomsIndices&&(_.roomsIndices=null),void 0===_.roomsLevels&&(_.roomsLevels=null),void 0===_.dimensionLines&&(_.dimensionLines=null),void 0===_.dimensionLinesLevels&&(_.dimensionLinesLevels=null),void 0===_.polylines&&(_.polylines=null),void 0===_.polylinesIndices&&(_.polylinesIndices=null),void 0===_.polylinesLevels&&(_.polylinesLevels=null),void 0===_.labels&&(_.labels=null),void 0===_.labelsLevels&&(_.labelsLevels=null),_.controller=i,_.basePlanLocked=o,_.allLevelsSelection=r,_.deletedItems=l,_.joinedDeletedWalls=a,_.rooms=s,_.roomsIndices=h,_.roomsLevels=u,_.dimensionLines=d,_.dimensionLinesLevels=c,_.polylines=p,_.polylinesIndices=g,_.polylinesLevels=m,_.labels=f,_.labelsLevels=v,_}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),this.controller.doAddWalls(this.joinedDeletedWalls,this.basePlanLocked),this.controller.doAddRooms(this.rooms,this.roomsIndices,this.roomsLevels,null,this.basePlanLocked),this.controller.doAddDimensionLines(this.dimensionLines,this.dimensionLinesLevels,null,this.basePlanLocked),this.controller.doAddPolylines(this.polylines,this.polylinesIndices,this.polylinesLevels,null,this.basePlanLocked),this.controller.doAddLabels(this.labels,this.labelsLevels,null,this.basePlanLocked),this.controller.selectAndShowItems$java_util_List$boolean(this.deletedItems.slice(0),this.allLevelsSelection)},i.prototype.redo=function(){t.prototype.redo.call(this),this.controller.selectItems$java_util_List(this.deletedItems.slice(0)),this.controller.doDeleteWalls(this.joinedDeletedWalls,this.basePlanLocked),this.controller.doDeleteRooms(this.rooms,this.basePlanLocked),this.controller.doDeleteDimensionLines(this.dimensionLines,this.basePlanLocked),this.controller.doDeletePolylines(this.polylines,this.basePlanLocked),this.controller.doDeleteLabels(this.labels,this.basePlanLocked)},i}(LocalizedUndoableEdit);e.ItemsDeletionUndoableEdit=S,S.__class="com.eteks.sweethome3d.viewcontroller.PlanController.ItemsDeletionUndoableEdit",S.__interfaces=["javax.swing.undo.UndoableEdit"];var y=function(t){function i(i,n,o){var r=t.call(this,n,e,"undoAddItemsName")||this;return void 0===r.home&&(r.home=null),void 0===r.items&&(r.items=null),r.home=i,r.items=o,r}return __extends(i,t),i.prototype.redo=function(){t.prototype.redo.call(this),this.home.setSelectedItems(this.items.slice(0))},i}(LocalizedUndoableEdit);e.ItemsAdditionEndUndoableEdit=y,y.__class="com.eteks.sweethome3d.viewcontroller.PlanController.ItemsAdditionEndUndoableEdit",y.__interfaces=["javax.swing.undo.UndoableEdit"];var E=function(t){function i(i,n,o,r,l,a,s){var h=t.call(this,n,e,"undoCreateWallsName")||this;return void 0===h.controller&&(h.controller=null),void 0===h.oldSelection&&(h.oldSelection=null),void 0===h.oldBasePlanLocked&&(h.oldBasePlanLocked=!1),void 0===h.oldAllLevelsSelection&&(h.oldAllLevelsSelection=!1),void 0===h.joinedNewWalls&&(h.joinedNewWalls=null),void 0===h.newBasePlanLocked&&(h.newBasePlanLocked=!1),h.controller=i,h.oldSelection=o,h.oldBasePlanLocked=r,h.oldAllLevelsSelection=l,h.joinedNewWalls=a,h.newBasePlanLocked=s,h}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),this.controller.doDeleteWalls(this.joinedNewWalls,this.oldBasePlanLocked),this.controller.selectAndShowItems$java_util_List$boolean(this.oldSelection.slice(0),this.oldAllLevelsSelection)},i.prototype.redo=function(){t.prototype.redo.call(this),this.controller.doAddWalls(this.joinedNewWalls,this.newBasePlanLocked),this.controller.selectAndShowItems$java_util_List$boolean(e.JoinedWall.getWalls(this.joinedNewWalls),!1)},i}(LocalizedUndoableEdit);e.WallsCreationUndoableEdit=E,E.__class="com.eteks.sweethome3d.viewcontroller.PlanController.WallsCreationUndoableEdit",E.__interfaces=["javax.swing.undo.UndoableEdit"];var C=function(t){function i(i,n,o,r,l,a,s,h,u){var d=t.call(this,n,e,"undoCreateRoomsName")||this;return void 0===d.controller&&(d.controller=null),void 0===d.oldSelection&&(d.oldSelection=null),void 0===d.oldBasePlanLocked&&(d.oldBasePlanLocked=!1),void 0===d.oldAllLevelsSelection&&(d.oldAllLevelsSelection=!1),void 0===d.newRooms&&(d.newRooms=null),void 0===d.roomsIndex&&(d.roomsIndex=null),void 0===d.roomsLevel&&(d.roomsLevel=null),void 0===d.newBasePlanLocked&&(d.newBasePlanLocked=!1),d.controller=i,d.oldSelection=o,d.oldBasePlanLocked=r,d.oldAllLevelsSelection=l,d.newRooms=a,d.roomsIndex=s,d.roomsLevel=h,d.newBasePlanLocked=u,d}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),this.controller.doDeleteRooms(this.newRooms,this.oldBasePlanLocked),this.controller.selectAndShowItems$java_util_List$boolean(this.oldSelection.slice(0),this.oldAllLevelsSelection)},i.prototype.redo=function(){t.prototype.redo.call(this),this.controller.doAddRooms(this.newRooms,this.roomsIndex,null,this.roomsLevel,this.newBasePlanLocked),this.controller.selectAndShowItems$java_util_List$boolean(this.newRooms.slice(0),!1)},i}(LocalizedUndoableEdit);e.RoomsCreationUndoableEdit=C,C.__class="com.eteks.sweethome3d.viewcontroller.PlanController.RoomsCreationUndoableEdit",C.__interfaces=["javax.swing.undo.UndoableEdit"];var P=function(t){function i(i,n,o,r,l,a,s,h){var u=t.call(this,n,e,"undoCreateDimensionLinesName")||this;return void 0===u.controller&&(u.controller=null),void 0===u.oldSelection&&(u.oldSelection=null),void 0===u.oldBasePlanLocked&&(u.oldBasePlanLocked=!1),void 0===u.oldAllLevelsSelection&&(u.oldAllLevelsSelection=!1),void 0===u.dimensionLines&&(u.dimensionLines=null),void 0===u.dimensionLinesLevel&&(u.dimensionLinesLevel=null),void 0===u.newBasePlanLocked&&(u.newBasePlanLocked=!1),u.controller=i,u.oldSelection=o,u.oldBasePlanLocked=r,u.oldAllLevelsSelection=l,u.dimensionLines=a,u.dimensionLinesLevel=s,u.newBasePlanLocked=h,u}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),this.controller.doDeleteDimensionLines(this.dimensionLines,this.oldBasePlanLocked),this.controller.selectAndShowItems$java_util_List$boolean(this.oldSelection.slice(0),this.oldAllLevelsSelection)},i.prototype.redo=function(){t.prototype.redo.call(this),this.controller.doAddDimensionLines(this.dimensionLines,null,this.dimensionLinesLevel,this.newBasePlanLocked),this.controller.selectAndShowItems$java_util_List$boolean(this.dimensionLines.slice(0),!1)},i}(LocalizedUndoableEdit);e.DimensionLinesCreationUndoableEdit=P,P.__class="com.eteks.sweethome3d.viewcontroller.PlanController.DimensionLinesCreationUndoableEdit",P.__interfaces=["javax.swing.undo.UndoableEdit"];var w=function(t){function i(i,n,o,r,l,a,s,h,u){var d=t.call(this,n,e,"undoCreatePolylinesName")||this;return void 0===d.controller&&(d.controller=null),void 0===d.oldSelection&&(d.oldSelection=null),void 0===d.oldBasePlanLocked&&(d.oldBasePlanLocked=!1),void 0===d.oldAllLevelsSelection&&(d.oldAllLevelsSelection=!1),void 0===d.newPolylines&&(d.newPolylines=null),void 0===d.polylinesIndex&&(d.polylinesIndex=null),void 0===d.polylinesLevel&&(d.polylinesLevel=null),void 0===d.newBasePlanLocked&&(d.newBasePlanLocked=!1),d.controller=i,d.oldSelection=o,d.oldBasePlanLocked=r,d.oldAllLevelsSelection=l,d.newPolylines=a,d.polylinesIndex=s,d.polylinesLevel=h,d.newBasePlanLocked=u,d}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),this.controller.doDeletePolylines(this.newPolylines,this.oldBasePlanLocked),this.controller.selectAndShowItems$java_util_List$boolean(this.oldSelection.slice(0),this.oldAllLevelsSelection)},i.prototype.redo=function(){t.prototype.redo.call(this),this.controller.doAddPolylines(this.newPolylines,this.polylinesIndex,null,this.polylinesLevel,this.newBasePlanLocked),this.controller.selectAndShowItems$java_util_List(this.newPolylines.slice(0))},i}(LocalizedUndoableEdit);e.PolylinesCreationUndoableEdit=w,w.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PolylinesCreationUndoableEdit",w.__interfaces=["javax.swing.undo.UndoableEdit"];var L=function(t){function i(i,n,o,r,l,a,s,h){var u=t.call(this,n,e,"undoCreateLabelsName")||this;return void 0===u.controller&&(u.controller=null),void 0===u.oldSelection&&(u.oldSelection=null),void 0===u.oldBasePlanLocked&&(u.oldBasePlanLocked=!1),void 0===u.oldAllLevelsSelection&&(u.oldAllLevelsSelection=!1),void 0===u.labels&&(u.labels=null),void 0===u.labelsLevel&&(u.labelsLevel=null),void 0===u.newBasePlanLocked&&(u.newBasePlanLocked=!1),u.controller=i,u.oldSelection=o,u.oldBasePlanLocked=r,u.oldAllLevelsSelection=l,u.labels=a,u.labelsLevel=s,u.newBasePlanLocked=h,u}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),this.controller.doDeleteLabels(this.labels,this.oldBasePlanLocked),this.controller.selectAndShowItems$java_util_List$boolean(this.oldSelection.slice(0),this.oldAllLevelsSelection)},i.prototype.redo=function(){t.prototype.redo.call(this),this.controller.doAddLabels(this.labels,null,this.labelsLevel,this.newBasePlanLocked),this.controller.selectAndShowItems$java_util_List$boolean(this.labels.slice(0),!1)},i}(LocalizedUndoableEdit);e.LabelsCreationUndoableEdit=L,L.__class="com.eteks.sweethome3d.viewcontroller.PlanController.LabelsCreationUndoableEdit",L.__interfaces=["javax.swing.undo.UndoableEdit"];var T=function(t){function i(i,n,o,r,l){var a=t.call(this,n,e,"undoLabelRotationName")||this;return void 0===a.controller&&(a.controller=null),void 0===a.oldAngle&&(a.oldAngle=0),void 0===a.label&&(a.label=null),void 0===a.newAngle&&(a.newAngle=0),a.controller=i,a.oldAngle=o,a.label=r,a.newAngle=l,a}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),this.label.setAngle(this.oldAngle),this.controller.selectAndShowItems$java_util_List([this.label].slice(0))},i.prototype.redo=function(){t.prototype.redo.call(this),this.label.setAngle(this.newAngle),this.controller.selectAndShowItems$java_util_List([this.label].slice(0))},i}(LocalizedUndoableEdit);e.LabelRotationUndoableEdit=T,T.__class="com.eteks.sweethome3d.viewcontroller.PlanController.LabelRotationUndoableEdit",T.__interfaces=["javax.swing.undo.UndoableEdit"];var A=function(t){function i(i,n,o,r,l){var a=t.call(this,n,e,o<l?"undoLabelRaiseName":"undoLabelLowerName")||this;return void 0===a.controller&&(a.controller=null),void 0===a.oldElevation&&(a.oldElevation=0),void 0===a.label&&(a.label=null),void 0===a.newElevation&&(a.newElevation=0),a.controller=i,a.oldElevation=o,a.label=r,a.newElevation=l,a}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),this.label.setElevation(this.oldElevation),this.controller.selectAndShowItems$java_util_List([this.label].slice(0))},i.prototype.redo=function(){t.prototype.redo.call(this),this.label.setElevation(this.newElevation),this.controller.selectAndShowItems$java_util_List([this.label].slice(0))},i}(LocalizedUndoableEdit);e.LabelElevationModificationUndoableEdit=A,A.__class="com.eteks.sweethome3d.viewcontroller.PlanController.LabelElevationModificationUndoableEdit",A.__interfaces=["javax.swing.undo.UndoableEdit"];var I=function(t){function i(i,n,o,r,l,a,s){var h=t.call(this,n,e,"undoMoveSelectionName")||this;return void 0===h.controller&&(h.controller=null),void 0===h.oldSelection&&(h.oldSelection=null),void 0===h.allLevelsSelection&&(h.allLevelsSelection=!1),void 0===h.itemsArray&&(h.itemsArray=null),void 0===h.dx&&(h.dx=0),void 0===h.dy&&(h.dy=0),h.controller=i,h.oldSelection=o,h.allLevelsSelection=r,h.itemsArray=l,h.dx=a,h.dy=s,h}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),this.controller.doMoveAndShowItems(this.itemsArray,this.oldSelection,-this.dx,-this.dy,this.allLevelsSelection)},i.prototype.redo=function(){t.prototype.redo.call(this),this.controller.doMoveAndShowItems(this.itemsArray,this.itemsArray,this.dx,this.dy,this.allLevelsSelection)},i}(LocalizedUndoableEdit);e.ItemsMovingUndoableEdit=I,I.__class="com.eteks.sweethome3d.viewcontroller.PlanController.ItemsMovingUndoableEdit",I.__interfaces=["javax.swing.undo.UndoableEdit"];var b=function(t){function i(i,n,o,r,l,a,s,h,u,d,c,p){var g=t.call(this,n,e,"undoMoveSelectionName")||this;return void 0===g.controller&&(g.controller=null),void 0===g.oldAngle&&(g.oldAngle=0),void 0===g.oldDepth&&(g.oldDepth=0),void 0===g.oldElevation&&(g.oldElevation=0),void 0===g.oldDoorOrWindowBoundToWall&&(g.oldDoorOrWindowBoundToWall=!1),void 0===g.piece&&(g.piece=null),void 0===g.dx&&(g.dx=0),void 0===g.dy&&(g.dy=0),void 0===g.newAngle&&(g.newAngle=0),void 0===g.newDepth&&(g.newDepth=0),void 0===g.newElevation&&(g.newElevation=0),g.controller=i,g.oldAngle=o,g.oldDepth=r,g.oldElevation=l,g.oldDoorOrWindowBoundToWall=a,g.piece=s,g.dx=h,g.dy=u,g.newAngle=d,g.newDepth=c,g.newElevation=p,g}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),this.piece.move(-this.dx,-this.dy),this.piece.setAngle(this.oldAngle),null!=this.piece&&this.piece instanceof HomeDoorOrWindow&&this.piece.isResizable()&&this.controller.isItemResizable(this.piece)&&this.piece.setDepth(this.oldDepth),this.piece.setElevation(this.oldElevation),null!=this.piece&&this.piece instanceof HomeDoorOrWindow&&this.piece.setBoundToWall(this.oldDoorOrWindowBoundToWall),this.controller.selectAndShowItems$java_util_List([this.piece].slice(0))},i.prototype.redo=function(){t.prototype.redo.call(this),this.piece.move(this.dx,this.dy),this.piece.setAngle(this.newAngle),null!=this.piece&&this.piece instanceof HomeDoorOrWindow&&this.piece.isResizable()&&this.controller.isItemResizable(this.piece)&&this.piece.setDepth(this.newDepth),this.piece.setElevation(this.newElevation),this.controller.selectAndShowItems$java_util_List([this.piece].slice(0))},i}(LocalizedUndoableEdit);e.PieceOfFurnitureMovingUndoableEdit=b,b.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PieceOfFurnitureMovingUndoableEdit",b.__interfaces=["javax.swing.undo.UndoableEdit"];var O=function(e){function t(t,i,n){var o=e.call(this)||this;return void 0===o.controller&&(o.controller=null),void 0===o.oldSelection&&(o.oldSelection=null),void 0===o.allLevelsSelection&&(o.allLevelsSelection=!1),o.controller=t,o.oldSelection=i,o.allLevelsSelection=n,o}return __extends(t,e),t.prototype.undo=function(){e.prototype.undo.call(this),this.controller.selectAndShowItems$java_util_List$boolean(this.oldSelection.slice(0),this.allLevelsSelection)},t}(javax.swing.undo.AbstractUndoableEdit);e.DuplicationStartUndoableEdit=O,O.__class="com.eteks.sweethome3d.viewcontroller.PlanController.DuplicationStartUndoableEdit",O.__interfaces=["javax.swing.undo.UndoableEdit"];var M=function(t){function i(i,n,o){var r=t.call(this,n,e,"undoDuplicateSelectionName")||this;return void 0===r.controller&&(r.controller=null),void 0===r.items&&(r.items=null),r.controller=i,r.items=o,r}return __extends(i,t),i.prototype.redo=function(){t.prototype.redo.call(this),this.controller.selectAndShowItems$java_util_List(this.items.slice(0))},i}(LocalizedUndoableEdit);e.DuplicationEndUndoableEdit=M,M.__class="com.eteks.sweethome3d.viewcontroller.PlanController.DuplicationEndUndoableEdit",M.__interfaces=["javax.swing.undo.UndoableEdit"];var D=function(t){function i(i,n,o,r,l,a,s,h){var u=t.call(this,n,e,"undoWallResizeName")||this;return void 0===u.controller&&(u.controller=null),void 0===u.oldX&&(u.oldX=0),void 0===u.oldY&&(u.oldY=0),void 0===u.wall&&(u.wall=null),void 0===u.startPoint&&(u.startPoint=!1),void 0===u.newX&&(u.newX=0),void 0===u.newY&&(u.newY=0),u.controller=i,u.oldX=o,u.oldY=r,u.wall=l,u.startPoint=a,u.newX=s,u.newY=h,u}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),e.moveWallPoint(this.wall,this.oldX,this.oldY,this.startPoint),this.controller.selectAndShowItems$java_util_List([this.wall].slice(0))},i.prototype.redo=function(){t.prototype.redo.call(this),e.moveWallPoint(this.wall,this.newX,this.newY,this.startPoint),this.controller.selectAndShowItems$java_util_List([this.wall].slice(0))},i}(LocalizedUndoableEdit);e.WallResizingUndoableEdit=D,D.__class="com.eteks.sweethome3d.viewcontroller.PlanController.WallResizingUndoableEdit",D.__interfaces=["javax.swing.undo.UndoableEdit"];var R=function(t){function i(i,n,o,r,l){var a=t.call(this,n,e,"undoWallArcExtentName")||this;return void 0===a.controller&&(a.controller=null),void 0===a.oldArcExtent&&(a.oldArcExtent=null),void 0===a.wall&&(a.wall=null),void 0===a.newArcExtent&&(a.newArcExtent=null),a.controller=i,a.oldArcExtent=o,a.wall=r,a.newArcExtent=l,a}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),this.wall.setArcExtent(this.oldArcExtent),this.controller.selectAndShowItems$java_util_List([this.wall].slice(0))},i.prototype.redo=function(){t.prototype.redo.call(this),this.wall.setArcExtent(this.newArcExtent),this.controller.selectAndShowItems$java_util_List([this.wall].slice(0))},i}(LocalizedUndoableEdit);e.WallArcExtentModificationUndoableEdit=R,R.__class="com.eteks.sweethome3d.viewcontroller.PlanController.WallArcExtentModificationUndoableEdit",R.__interfaces=["javax.swing.undo.UndoableEdit"];var F=function(t){function i(i,n,o,r,l,a,s,h){var u=t.call(this,n,e,"undoRoomResizeName")||this;return void 0===u.controller&&(u.controller=null),void 0===u.oldX&&(u.oldX=0),void 0===u.oldY&&(u.oldY=0),void 0===u.room&&(u.room=null),void 0===u.pointIndex&&(u.pointIndex=0),void 0===u.newX&&(u.newX=0),void 0===u.newY&&(u.newY=0),u.controller=i,u.oldX=o,u.oldY=r,u.room=l,u.pointIndex=a,u.newX=s,u.newY=h,u}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),e.moveRoomPoint(this.room,this.oldX,this.oldY,this.pointIndex),this.controller.selectAndShowItems$java_util_List([this.room].slice(0))},i.prototype.redo=function(){t.prototype.redo.call(this),e.moveRoomPoint(this.room,this.newX,this.newY,this.pointIndex),this.controller.selectAndShowItems$java_util_List([this.room].slice(0))},i}(LocalizedUndoableEdit);e.RoomResizingUndoableEdit=F,F.__class="com.eteks.sweethome3d.viewcontroller.PlanController.RoomResizingUndoableEdit",F.__interfaces=["javax.swing.undo.UndoableEdit"];var x=function(t){function i(i,n,o,r,l,a,s){var h=t.call(this,n,e,"undoRoomNameOffsetName")||this;return void 0===h.controller&&(h.controller=null),void 0===h.oldNameXOffset&&(h.oldNameXOffset=0),void 0===h.oldNameYOffset&&(h.oldNameYOffset=0),void 0===h.room&&(h.room=null),void 0===h.newNameXOffset&&(h.newNameXOffset=0),void 0===h.newNameYOffset&&(h.newNameYOffset=0),h.controller=i,h.oldNameXOffset=o,h.oldNameYOffset=r,h.room=l,h.newNameXOffset=a,h.newNameYOffset=s,h}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),this.room.setNameXOffset(this.oldNameXOffset),this.room.setNameYOffset(this.oldNameYOffset),this.controller.selectAndShowItems$java_util_List([this.room].slice(0))},i.prototype.redo=function(){t.prototype.redo.call(this),this.room.setNameXOffset(this.newNameXOffset),this.room.setNameYOffset(this.newNameYOffset),this.controller.selectAndShowItems$java_util_List([this.room].slice(0))},i}(LocalizedUndoableEdit);e.RoomNameOffsetModificationUndoableEdit=x,x.__class="com.eteks.sweethome3d.viewcontroller.PlanController.RoomNameOffsetModificationUndoableEdit",x.__interfaces=["javax.swing.undo.UndoableEdit"];var N=function(t){function i(i,n,o,r,l){var a=t.call(this,n,e,"undoRoomNameRotationName")||this;return void 0===a.controller&&(a.controller=null),void 0===a.oldNameAngle&&(a.oldNameAngle=0),void 0===a.room&&(a.room=null),void 0===a.newNameAngle&&(a.newNameAngle=0),a.controller=i,a.oldNameAngle=o,a.room=r,a.newNameAngle=l,a}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),this.room.setNameAngle(this.oldNameAngle),this.controller.selectAndShowItems$java_util_List([this.room].slice(0))},i.prototype.redo=function(){t.prototype.redo.call(this),this.room.setNameAngle(this.newNameAngle),this.controller.selectAndShowItems$java_util_List([this.room].slice(0))},i}(LocalizedUndoableEdit);e.RoomNameRotationUndoableEdit=N,N.__class="com.eteks.sweethome3d.viewcontroller.PlanController.RoomNameRotationUndoableEdit",N.__interfaces=["javax.swing.undo.UndoableEdit"];var k=function(t){function i(i,n,o,r,l,a,s){var h=t.call(this,n,e,"undoRoomAreaOffsetName")||this;return void 0===h.controller&&(h.controller=null),void 0===h.oldAreaXOffset&&(h.oldAreaXOffset=0),void 0===h.oldAreaYOffset&&(h.oldAreaYOffset=0),void 0===h.room&&(h.room=null),void 0===h.newAreaXOffset&&(h.newAreaXOffset=0),void 0===h.newAreaYOffset&&(h.newAreaYOffset=0),h.controller=i,h.oldAreaXOffset=o,h.oldAreaYOffset=r,h.room=l,h.newAreaXOffset=a,h.newAreaYOffset=s,h}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),this.room.setAreaXOffset(this.oldAreaXOffset),this.room.setAreaYOffset(this.oldAreaYOffset),this.controller.selectAndShowItems$java_util_List([this.room].slice(0))},i.prototype.redo=function(){t.prototype.redo.call(this),this.room.setAreaXOffset(this.newAreaXOffset),this.room.setAreaYOffset(this.newAreaYOffset),this.controller.selectAndShowItems$java_util_List([this.room].slice(0))},i}(LocalizedUndoableEdit);e.RoomAreaOffsetModificationUndoableEdit=k,k.__class="com.eteks.sweethome3d.viewcontroller.PlanController.RoomAreaOffsetModificationUndoableEdit",k.__interfaces=["javax.swing.undo.UndoableEdit"];var H=function(t){function i(i,n,o,r,l){var a=t.call(this,n,e,"undoRoomAreaRotationName")||this;return void 0===a.controller&&(a.controller=null),void 0===a.oldAreaAngle&&(a.oldAreaAngle=0),void 0===a.room&&(a.room=null),void 0===a.newAreaAngle&&(a.newAreaAngle=0),a.controller=i,a.oldAreaAngle=o,a.room=r,a.newAreaAngle=l,a}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),this.room.setAreaAngle(this.oldAreaAngle),this.controller.selectAndShowItems$java_util_List([this.room].slice(0))},i.prototype.redo=function(){t.prototype.redo.call(this),this.room.setAreaAngle(this.newAreaAngle),this.controller.selectAndShowItems$java_util_List([this.room].slice(0))},i}(LocalizedUndoableEdit);e.RoomAreaRotationUndoableEdit=H,H.__class="com.eteks.sweethome3d.viewcontroller.PlanController.RoomAreaRotationUndoableEdit",H.__interfaces=["javax.swing.undo.UndoableEdit"];var V=function(t){function i(i,n,o,r,l,a){var s=t.call(this,n,e,"undoPieceOfFurnitureRotationName")||this;return void 0===s.controller&&(s.controller=null),void 0===s.oldAngle&&(s.oldAngle=0),void 0===s.oldDoorOrWindowBoundToWall&&(s.oldDoorOrWindowBoundToWall=!1),void 0===s.piece&&(s.piece=null),void 0===s.newAngle&&(s.newAngle=0),s.controller=i,s.oldAngle=o,s.oldDoorOrWindowBoundToWall=r,s.piece=l,s.newAngle=a,s}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),this.piece.setAngle(this.oldAngle),null!=this.piece&&this.piece instanceof HomeDoorOrWindow&&this.piece.setBoundToWall(this.oldDoorOrWindowBoundToWall),this.controller.selectAndShowItems$java_util_List([this.piece].slice(0))},i.prototype.redo=function(){t.prototype.redo.call(this),this.piece.setAngle(this.newAngle),this.controller.selectAndShowItems$java_util_List([this.piece].slice(0))},i}(LocalizedUndoableEdit);e.PieceOfFurnitureRotationUndoableEdit=V,V.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PieceOfFurnitureRotationUndoableEdit",V.__interfaces=["javax.swing.undo.UndoableEdit"];var U=function(t){function i(i,n,o,r,l,a,s,h,u,d,c){var p=t.call(this,n,e,"undoPieceOfFurnitureRotationName")||this;return void 0===p.controller&&(p.controller=null),void 0===p.oldPitch&&(p.oldPitch=0),void 0===p.oldWidthInPlan&&(p.oldWidthInPlan=0),void 0===p.oldDepthInPlan&&(p.oldDepthInPlan=0),void 0===p.oldHeightInPlan&&(p.oldHeightInPlan=0),void 0===p.piece&&(p.piece=null),void 0===p.newPitch&&(p.newPitch=0),void 0===p.newWidthInPlan&&(p.newWidthInPlan=0),void 0===p.newDepthInPlan&&(p.newDepthInPlan=0),void 0===p.newHeightInPlan&&(p.newHeightInPlan=0),p.controller=i,p.oldPitch=o,p.oldWidthInPlan=r,p.oldDepthInPlan=l,p.oldHeightInPlan=a,p.piece=s,p.newPitch=h,p.newWidthInPlan=u,p.newDepthInPlan=d,p.newHeightInPlan=c,p}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),this.controller.setPieceOfFurniturePitch(this.piece,this.oldPitch,this.oldWidthInPlan,this.oldDepthInPlan,this.oldHeightInPlan),this.controller.selectAndShowItems$java_util_List([this.piece].slice(0))},i.prototype.redo=function(){t.prototype.redo.call(this),this.controller.setPieceOfFurniturePitch(this.piece,this.newPitch,this.newWidthInPlan,this.newDepthInPlan,this.newHeightInPlan),this.controller.selectAndShowItems$java_util_List([this.piece].slice(0))},i}(LocalizedUndoableEdit);e.PieceOfFurniturePitchRotationUndoableEdit=U,U.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PieceOfFurniturePitchRotationUndoableEdit",U.__interfaces=["javax.swing.undo.UndoableEdit"];var W=function(t){function i(i,n,o,r,l,a,s,h,u,d,c){var p=t.call(this,n,e,"undoPieceOfFurnitureRotationName")||this;return void 0===p.controller&&(p.controller=null),void 0===p.oldRoll&&(p.oldRoll=0),void 0===p.oldWidthInPlan&&(p.oldWidthInPlan=0),void 0===p.oldDepthInPlan&&(p.oldDepthInPlan=0),void 0===p.oldHeightInPlan&&(p.oldHeightInPlan=0),void 0===p.piece&&(p.piece=null),void 0===p.newRoll&&(p.newRoll=0),void 0===p.newWidthInPlan&&(p.newWidthInPlan=0),void 0===p.newDepthInPlan&&(p.newDepthInPlan=0),void 0===p.newHeightInPlan&&(p.newHeightInPlan=0),p.controller=i,p.oldRoll=o,p.oldWidthInPlan=r,p.oldDepthInPlan=l,p.oldHeightInPlan=a,p.piece=s,p.newRoll=h,p.newWidthInPlan=u,p.newDepthInPlan=d,p.newHeightInPlan=c,p}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),this.controller.setPieceOfFurnitureRoll(this.piece,this.oldRoll,this.oldWidthInPlan,this.oldDepthInPlan,this.oldHeightInPlan),this.controller.selectAndShowItems$java_util_List([this.piece].slice(0))},i.prototype.redo=function(){t.prototype.redo.call(this),this.controller.setPieceOfFurnitureRoll(this.piece,this.newRoll,this.newWidthInPlan,this.newDepthInPlan,this.newHeightInPlan),this.controller.selectAndShowItems$java_util_List([this.piece].slice(0))},i}(LocalizedUndoableEdit);e.PieceOfFurnitureRollRotationUndoableEdit=W,W.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PieceOfFurnitureRollRotationUndoableEdit",W.__interfaces=["javax.swing.undo.UndoableEdit"];var B=function(t){function i(i,n,o,r,l){var a=t.call(this,n,e,o<l?"undoPieceOfFurnitureRaiseName":"undoPieceOfFurnitureLowerName")||this;return void 0===a.controller&&(a.controller=null),void 0===a.oldElevation&&(a.oldElevation=0),void 0===a.piece&&(a.piece=null),void 0===a.newElevation&&(a.newElevation=0),a.controller=i,a.oldElevation=o,a.piece=r,a.newElevation=l,a}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),this.piece.setElevation(this.oldElevation),this.controller.selectAndShowItems$java_util_List([this.piece].slice(0))},i.prototype.redo=function(){t.prototype.redo.call(this),this.piece.setElevation(this.newElevation),this.controller.selectAndShowItems$java_util_List([this.piece].slice(0))},i}(LocalizedUndoableEdit);e.PieceOfFurnitureElevationModificationUndoableEdit=B,B.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PieceOfFurnitureElevationModificationUndoableEdit",B.__interfaces=["javax.swing.undo.UndoableEdit"];var G=function(t){function i(i,n,o,r,l,a,s,h,u,d){var c=t.call(this,n,e,o)||this;return void 0===c.controller&&(c.controller=null),void 0===c.doorOrWindowBoundToWall&&(c.doorOrWindowBoundToWall=!1),void 0===c.resizedPiece&&(c.resizedPiece=null),void 0===c.newX&&(c.newX=0),void 0===c.newY&&(c.newY=0),void 0===c.newWidth&&(c.newWidth=0),void 0===c.newDepth&&(c.newDepth=0),void 0===c.newHeight&&(c.newHeight=0),c.controller=i,c.doorOrWindowBoundToWall=r,c.resizedPiece=l,c.newX=a,c.newY=s,c.newWidth=h,c.newDepth=u,c.newHeight=d,c}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),this.controller.resetPieceOfFurnitureSize(this.resizedPiece),this.controller.selectAndShowItems$java_util_List([this.resizedPiece.getPieceOfFurniture()].slice(0))},i.prototype.redo=function(){t.prototype.redo.call(this);var e=this.resizedPiece.getPieceOfFurniture();e.setX(this.newX),e.setY(this.newY),this.controller.setPieceOfFurnitureSize(this.resizedPiece,this.newWidth,this.newDepth,this.newHeight),null!=e&&e instanceof HomeDoorOrWindow&&e.setBoundToWall(this.doorOrWindowBoundToWall),this.controller.selectAndShowItems$java_util_List([e].slice(0))},i}(LocalizedUndoableEdit);e.PieceOfFurnitureResizingUndoableEdit=G,G.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PieceOfFurnitureResizingUndoableEdit",G.__interfaces=["javax.swing.undo.UndoableEdit"];var Y=function(t){function i(i,n,o,r,l){var a=t.call(this,n,e,"undoLightPowerModificationName")||this;return void 0===a.controller&&(a.controller=null),void 0===a.oldPower&&(a.oldPower=0),void 0===a.light&&(a.light=null),void 0===a.newPower&&(a.newPower=0),a.controller=i,a.oldPower=o,a.light=r,a.newPower=l,a}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),this.light.setPower(this.oldPower),this.controller.selectAndShowItems$java_util_List([this.light].slice(0))},i.prototype.redo=function(){t.prototype.redo.call(this),this.light.setPower(this.newPower),this.controller.selectAndShowItems$java_util_List([this.light].slice(0))},i}(LocalizedUndoableEdit);e.LightPowerModificationUndoableEdit=Y,Y.__class="com.eteks.sweethome3d.viewcontroller.PlanController.LightPowerModificationUndoableEdit",Y.__interfaces=["javax.swing.undo.UndoableEdit"];var $=function(t){function i(i,n,o,r,l,a,s){var h=t.call(this,n,e,"undoPieceOfFurnitureNameOffsetName")||this;return void 0===h.controller&&(h.controller=null),void 0===h.oldNameXOffset&&(h.oldNameXOffset=0),void 0===h.oldNameYOffset&&(h.oldNameYOffset=0),void 0===h.piece&&(h.piece=null),void 0===h.newNameXOffset&&(h.newNameXOffset=0),void 0===h.newNameYOffset&&(h.newNameYOffset=0),h.controller=i,h.oldNameXOffset=o,h.oldNameYOffset=r,h.piece=l,h.newNameXOffset=a,h.newNameYOffset=s,h}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),this.piece.setNameXOffset(this.oldNameXOffset),this.piece.setNameYOffset(this.oldNameYOffset),this.controller.selectAndShowItems$java_util_List([this.piece].slice(0))},i.prototype.redo=function(){t.prototype.redo.call(this),this.piece.setNameXOffset(this.newNameXOffset),this.piece.setNameYOffset(this.newNameYOffset),this.controller.selectAndShowItems$java_util_List([this.piece].slice(0))},i}(LocalizedUndoableEdit);e.PieceOfFurnitureNameOffsetModificationUndoableEdit=$,$.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PieceOfFurnitureNameOffsetModificationUndoableEdit",$.__interfaces=["javax.swing.undo.UndoableEdit"];var X=function(t){function i(i,n,o,r,l){var a=t.call(this,n,e,"undoPieceOfFurnitureNameRotationName")||this;return void 0===a.controller&&(a.controller=null),void 0===a.oldNameAngle&&(a.oldNameAngle=0),void 0===a.piece&&(a.piece=null),void 0===a.newNameAngle&&(a.newNameAngle=0),a.controller=i,a.oldNameAngle=o,a.piece=r,a.newNameAngle=l,a}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),this.piece.setNameAngle(this.oldNameAngle),this.controller.selectAndShowItems$java_util_List([this.piece].slice(0))},i.prototype.redo=function(){t.prototype.redo.call(this),this.piece.setNameAngle(this.newNameAngle),this.controller.selectAndShowItems$java_util_List([this.piece].slice(0))},i}(LocalizedUndoableEdit);e.PieceOfFurnitureNameRotationUndoableEdit=X,X.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PieceOfFurnitureNameRotationUndoableEdit",X.__interfaces=["javax.swing.undo.UndoableEdit"];var z=function(t){function i(i,n,o,r,l,a,s,h,u){var d=t.call(this,n,e,"undoDimensionLineResizeName")||this;return void 0===d.controller&&(d.controller=null),void 0===d.oldX&&(d.oldX=0),void 0===d.oldY&&(d.oldY=0),void 0===d.dimensionLine&&(d.dimensionLine=null),void 0===d.newX&&(d.newX=0),void 0===d.newY&&(d.newY=0),void 0===d.startPoint&&(d.startPoint=!1),void 0===d.reversed&&(d.reversed=!1),d.controller=i,d.oldX=o,d.oldY=r,d.dimensionLine=l,d.newX=a,d.newY=s,d.startPoint=h,d.reversed=u,d}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),this.reversed?(e.reverseDimensionLine(this.dimensionLine),e.moveDimensionLinePoint(this.dimensionLine,this.oldX,this.oldY,!this.startPoint)):e.moveDimensionLinePoint(this.dimensionLine,this.oldX,this.oldY,this.startPoint),this.controller.selectAndShowItems$java_util_List([this.dimensionLine].slice(0))},i.prototype.redo=function(){t.prototype.redo.call(this),this.reversed?(e.moveDimensionLinePoint(this.dimensionLine,this.newX,this.newY,!this.startPoint),e.reverseDimensionLine(this.dimensionLine)):e.moveDimensionLinePoint(this.dimensionLine,this.newX,this.newY,this.startPoint),this.controller.selectAndShowItems$java_util_List([this.dimensionLine].slice(0))},i}(LocalizedUndoableEdit);e.DimensionLineResizingUndoableEdit=z,z.__class="com.eteks.sweethome3d.viewcontroller.PlanController.DimensionLineResizingUndoableEdit",z.__interfaces=["javax.swing.undo.UndoableEdit"];var j=function(t){function i(i,n,o,r,l){var a=t.call(this,n,e,"undoDimensionLineOffsetName")||this;return void 0===a.controller&&(a.controller=null),void 0===a.oldOffset&&(a.oldOffset=0),void 0===a.dimensionLine&&(a.dimensionLine=null),void 0===a.newOffset&&(a.newOffset=0),a.controller=i,a.oldOffset=o,a.dimensionLine=r,a.newOffset=l,a}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),this.dimensionLine.setOffset(this.oldOffset),this.controller.selectAndShowItems$java_util_List([this.dimensionLine].slice(0))},i.prototype.redo=function(){t.prototype.redo.call(this),this.dimensionLine.setOffset(this.newOffset),this.controller.selectAndShowItems$java_util_List([this.dimensionLine].slice(0))},i}(LocalizedUndoableEdit);e.DimensionLineOffsetModificationUndoableEdit=j,j.__class="com.eteks.sweethome3d.viewcontroller.PlanController.DimensionLineOffsetModificationUndoableEdit",j.__interfaces=["javax.swing.undo.UndoableEdit"];var K=function(t){function i(i,n,o,r,l){var a=t.call(this,n,e,"undoDimensionLineRotationName")||this;return void 0===a.controller&&(a.controller=null),void 0===a.oldPitch&&(a.oldPitch=0),void 0===a.dimensionLine&&(a.dimensionLine=null),void 0===a.newPitch&&(a.newPitch=0),a.controller=i,a.oldPitch=o,a.dimensionLine=r,a.newPitch=l,a}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),this.dimensionLine.setPitch(this.oldPitch),this.controller.selectAndShowItems$java_util_List([this.dimensionLine].slice(0))},i.prototype.redo=function(){t.prototype.redo.call(this),this.dimensionLine.setPitch(this.newPitch),this.controller.selectAndShowItems$java_util_List([this.dimensionLine].slice(0))},i}(LocalizedUndoableEdit);e.DimensionLinePitchRotationUndoableEdit=K,K.__class="com.eteks.sweethome3d.viewcontroller.PlanController.DimensionLinePitchRotationUndoableEdit",K.__interfaces=["javax.swing.undo.UndoableEdit"];var J=function(t){function i(i,n,o,r,l){var a=t.call(this,n,e,"undoDimensionLineHeightResizeName")||this;return void 0===a.controller&&(a.controller=null),void 0===a.oldHeight&&(a.oldHeight=0),void 0===a.dimensionLine&&(a.dimensionLine=null),void 0===a.newHeight&&(a.newHeight=0),a.controller=i,a.oldHeight=o,a.dimensionLine=r,a.newHeight=l,a}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),this.dimensionLine.setElevationEnd(this.dimensionLine.getElevationStart()+this.oldHeight),this.controller.selectAndShowItems$java_util_List([this.dimensionLine].slice(0))},i.prototype.redo=function(){t.prototype.redo.call(this),this.dimensionLine.setElevationEnd(this.dimensionLine.getElevationStart()+this.newHeight),this.controller.selectAndShowItems$java_util_List([this.dimensionLine].slice(0))},i}(LocalizedUndoableEdit);e.DimensionLineHeightResizingUndoableEdit=J,J.__class="com.eteks.sweethome3d.viewcontroller.PlanController.DimensionLineHeightResizingUndoableEdit",J.__interfaces=["javax.swing.undo.UndoableEdit"];var q=function(t){function i(i,n,o,r,l){var a=t.call(this,n,e,o<l?"undoDimensionLineRaiseName":"undoDimensionLineLowerName")||this;return void 0===a.controller&&(a.controller=null),void 0===a.oldElevation&&(a.oldElevation=0),void 0===a.dimensionLine&&(a.dimensionLine=null),void 0===a.newElevation&&(a.newElevation=0),a.controller=i,a.oldElevation=o,a.dimensionLine=r,a.newElevation=l,a}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),this.dimensionLine.setElevationStart(this.oldElevation),this.controller.selectAndShowItems$java_util_List([this.dimensionLine].slice(0))},i.prototype.redo=function(){t.prototype.redo.call(this),this.dimensionLine.setElevationStart(this.newElevation),this.controller.selectAndShowItems$java_util_List([this.dimensionLine].slice(0))},i}(LocalizedUndoableEdit);e.DimensionLineElevationModificationUndoableEdit=q,q.__class="com.eteks.sweethome3d.viewcontroller.PlanController.DimensionLineElevationModificationUndoableEdit",q.__interfaces=["javax.swing.undo.UndoableEdit"];var Z=function(t){function i(i,n,o,r,l,a,s,h){var u=t.call(this,n,e,"undoPolylineResizeName")||this;return void 0===u.controller&&(u.controller=null),void 0===u.oldX&&(u.oldX=0),void 0===u.oldY&&(u.oldY=0),void 0===u.polyline&&(u.polyline=null),void 0===u.pointIndex&&(u.pointIndex=0),void 0===u.newX&&(u.newX=0),void 0===u.newY&&(u.newY=0),u.controller=i,u.oldX=o,u.oldY=r,u.polyline=l,u.pointIndex=a,u.newX=s,u.newY=h,u}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),this.polyline.setPoint(this.oldX,this.oldY,this.pointIndex),this.controller.selectAndShowItems$java_util_List([this.polyline].slice(0))},i.prototype.redo=function(){t.prototype.redo.call(this),this.polyline.setPoint(this.newX,this.newY,this.pointIndex),this.controller.selectAndShowItems$java_util_List([this.polyline].slice(0))},i}(LocalizedUndoableEdit);e.PolylineResizingUndoableEdit=Z,Z.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PolylineResizingUndoableEdit",Z.__interfaces=["javax.swing.undo.UndoableEdit"];var Q=function(t){function i(i,n,o,r,l){var a=t.call(this,n,e,"undoCompassRotationName")||this;return void 0===a.controller&&(a.controller=null),void 0===a.oldNorthDirection&&(a.oldNorthDirection=0),void 0===a.compass&&(a.compass=null),void 0===a.newNorthDirection&&(a.newNorthDirection=0),a.controller=i,a.compass=r,a.newNorthDirection=l,a.oldNorthDirection=o,a}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),this.compass.setNorthDirection(this.oldNorthDirection),this.controller.selectAndShowItems$java_util_List([this.compass].slice(0))},i.prototype.redo=function(){t.prototype.redo.call(this),this.compass.setNorthDirection(this.newNorthDirection),this.controller.selectAndShowItems$java_util_List([this.compass].slice(0))},i}(LocalizedUndoableEdit);e.CompassRotationUndoableEdit=Q,Q.__class="com.eteks.sweethome3d.viewcontroller.PlanController.CompassRotationUndoableEdit",Q.__interfaces=["javax.swing.undo.UndoableEdit"];var ee=function(t){function i(i,n,o,r,l){var a=t.call(this,n,e,"undoCompassResizeName")||this;return void 0===a.controller&&(a.controller=null),void 0===a.oldDiameter&&(a.oldDiameter=0),void 0===a.compass&&(a.compass=null),void 0===a.newDiameter&&(a.newDiameter=0),a.controller=i,a.oldDiameter=o,a.compass=r,a.newDiameter=l,a}return __extends(i,t),i.prototype.undo=function(){t.prototype.undo.call(this),this.compass.setDiameter(this.oldDiameter),this.controller.selectAndShowItems$java_util_List([this.compass].slice(0))},i.prototype.redo=function(){t.prototype.redo.call(this),this.compass.setDiameter(this.newDiameter),this.controller.selectAndShowItems$java_util_List([this.compass].slice(0))},i}(LocalizedUndoableEdit);e.CompassResizingUndoableEdit=ee,ee.__class="com.eteks.sweethome3d.viewcontroller.PlanController.CompassResizingUndoableEdit",ee.__interfaces=["javax.swing.undo.UndoableEdit"];var te=function(){function e(e){if(void 0===this.piece&&(this.piece=null),void 0===this.x&&(this.x=0),void 0===this.y&&(this.y=0),void 0===this.width&&(this.width=0),void 0===this.depth&&(this.depth=0),void 0===this.height&&(this.height=0),void 0===this.doorOrWindowBoundToWall&&(this.doorOrWindowBoundToWall=!1),void 0===this.groupFurnitureX&&(this.groupFurnitureX=null),void 0===this.groupFurnitureY&&(this.groupFurnitureY=null),void 0===this.groupFurnitureWidth&&(this.groupFurnitureWidth=null),void 0===this.groupFurnitureDepth&&(this.groupFurnitureDepth=null),void 0===this.groupFurnitureHeight&&(this.groupFurnitureHeight=null),this.piece=e,this.x=e.getX(),this.y=e.getY(),this.width=e.getWidth(),this.depth=e.getDepth(),this.height=e.getHeight(),this.doorOrWindowBoundToWall=null!=e&&e instanceof HomeDoorOrWindow&&e.isBoundToWall(),null!=e&&e instanceof HomeFurnitureGroup){var t=e.getAllFurniture();this.groupFurnitureX=function(e){for(var t=[];e-- >0;)t.push(0);return t}(t.length),this.groupFurnitureY=function(e){for(var t=[];e-- >0;)t.push(0);return t}(t.length),this.groupFurnitureWidth=function(e){for(var t=[];e-- >0;)t.push(0);return t}(t.length),this.groupFurnitureDepth=function(e){for(var t=[];e-- >0;)t.push(0);return t}(t.length),this.groupFurnitureHeight=function(e){for(var t=[];e-- >0;)t.push(0);return t}(t.length);for(var i=0;i<t.length;i++){var n=t[i];this.groupFurnitureX[i]=n.getX(),this.groupFurnitureY[i]=n.getY(),this.groupFurnitureWidth[i]=n.getWidth(),this.groupFurnitureDepth[i]=n.getDepth(),this.groupFurnitureHeight[i]=n.getHeight()}}else this.groupFurnitureX=null,this.groupFurnitureY=null,this.groupFurnitureWidth=null,this.groupFurnitureDepth=null,this.groupFurnitureHeight=null}return e.prototype.getPieceOfFurniture=function(){return this.piece},e.prototype.getWidth=function(){return this.width},e.prototype.getDepth=function(){return this.depth},e.prototype.getHeight=function(){return this.height},e.prototype.isDoorOrWindowBoundToWall=function(){return this.doorOrWindowBoundToWall},e.prototype.reset=function(){if(this.piece.setX(this.x),this.piece.setY(this.y),e.setPieceOfFurnitureSize(this.piece,this.width,this.depth,this.height),null!=this.piece&&this.piece instanceof HomeDoorOrWindow&&this.piece.setBoundToWall(this.doorOrWindowBoundToWall),null!=this.piece&&this.piece instanceof HomeFurnitureGroup)for(var t=this.piece.getAllFurniture(),i=0;i<t.length;i++){var n=t[i];this.piece.isResizable()&&(n.setX(this.groupFurnitureX[i]),n.setY(this.groupFurnitureY[i]),e.setPieceOfFurnitureSize(n,this.groupFurnitureWidth[i],this.groupFurnitureDepth[i],this.groupFurnitureHeight[i]))}},e.setPieceOfFurnitureSize=function(e,t,i,n){if(e.isHorizontallyRotated()){var o=t/e.getWidth();if(e.scale(o),e.setWidthInPlan(o*e.getWidthInPlan()),e.setDepthInPlan(o*e.getDepthInPlan()),e.setHeightInPlan(o*e.getHeightInPlan()),null!=e&&e instanceof HomeFurnitureGroup)for(var r=e.getAllFurniture(),l=0;l<r.length;l++){(u=r[l]).setWidthInPlan(o*u.getWidthInPlan()),u.setDepthInPlan(o*u.getDepthInPlan()),u.setHeightInPlan(o*u.getHeightInPlan())}}else{var a=e.getWidthInPlan()*t/e.getWidth();e.setWidth(t),e.setWidthInPlan(a);var s=e.getDepthInPlan()*i/e.getDepth();e.setDepth(i),e.setDepthInPlan(s);var h=e.getHeightInPlan()*n/e.getHeight();if(e.setHeight(n),e.setHeightInPlan(h),null!=e&&e instanceof HomeFurnitureGroup)for(r=e.getAllFurniture(),l=0;l<r.length;l++){var u;(u=r[l]).setWidthInPlan(u.getWidth()),u.setDepthInPlan(u.getDepth()),u.setHeightInPlan(u.getHeight())}}},e}();e.ResizedPieceOfFurniture=te,te.__class="com.eteks.sweethome3d.viewcontroller.PlanController.ResizedPieceOfFurniture";var ie=function(){function t(e){void 0===this.wall&&(this.wall=null),void 0===this.level&&(this.level=null),void 0===this.xStart&&(this.xStart=0),void 0===this.yStart&&(this.yStart=0),void 0===this.xEnd&&(this.xEnd=0),void 0===this.yEnd&&(this.yEnd=0),void 0===this.wallAtStart&&(this.wallAtStart=null),void 0===this.wallAtEnd&&(this.wallAtEnd=null),void 0===this.joinedAtEndOfWallAtStart&&(this.joinedAtEndOfWallAtStart=!1),void 0===this.joinedAtStartOfWallAtEnd&&(this.joinedAtStartOfWallAtEnd=!1),this.wall=e,this.level=e.getLevel(),this.xStart=e.getXStart(),this.xEnd=e.getXEnd(),this.yStart=e.getYStart(),this.yEnd=e.getYEnd(),this.wallAtStart=e.getWallAtStart(),this.joinedAtEndOfWallAtStart=null!=this.wallAtStart&&this.wallAtStart.getWallAtEnd()===e,this.wallAtEnd=e.getWallAtEnd(),this.joinedAtStartOfWallAtEnd=null!=this.wallAtEnd&&this.wallAtEnd.getWallAtStart()===e}return t.prototype.getWall=function(){return this.wall},t.prototype.getLevel=function(){return this.level},t.prototype.getXStart=function(){return this.xStart},t.prototype.getYStart=function(){return this.yStart},t.prototype.getXEnd=function(){return this.xEnd},t.prototype.getYEnd=function(){return this.yEnd},t.prototype.getWallAtEnd=function(){return this.wallAtEnd},t.prototype.getWallAtStart=function(){return this.wallAtStart},t.prototype.isJoinedAtEndOfWallAtStart=function(){return this.joinedAtEndOfWallAtStart},t.prototype.isJoinedAtStartOfWallAtEnd=function(){return this.joinedAtStartOfWallAtEnd},t.getJoinedWalls=function(t){for(var i=function(e){for(var t=[];e-- >0;)t.push(null);return t}(t.length),n=0;n<i.length;n++)i[n]=new e.JoinedWall(t[n]);return i},t.getWalls=function(e){for(var t=function(e){for(var t=[];e-- >0;)t.push(null);return t}(e.length),i=0;i<e.length;i++)t[i]=e[i].getWall();return t.slice(0)},t}();e.JoinedWall=ie,ie.__class="com.eteks.sweethome3d.viewcontroller.PlanController.JoinedWall";var ne=function(){function e(t,i,n,o,r,l,a){if("number"!=typeof t&&null!==t||"number"!=typeof i&&null!==i||"number"!=typeof n&&null!==n||"number"!=typeof o&&null!==o||null==r&&null!==r||"number"!=typeof l&&null!==l||"number"!=typeof a&&null!==a){if("number"!=typeof t&&null!==t||"number"!=typeof i&&null!==i||"number"!=typeof n&&null!==n||"number"!=typeof o&&null!==o||null==r&&null!==r||"number"!=typeof l&&null!==l||void 0!==a)throw new Error("invalid overload");var s=e.CIRCLE_STEPS_15_DEG;if(void 0===this.x&&(this.x=0),void 0===this.y&&(this.y=0),void 0===this.angle&&(this.angle=0),this.x=n,this.y=o,t===n){h=r.getMagnetizedLength(Math.abs(i-o),l);this.y=i+h*function(e){return e>0?1:e<0?-1:0}(o-i)}else if(i===o){h=r.getMagnetizedLength(Math.abs(t-n),l);this.x=t+h*function(e){return e>0?1:e<0?-1:0}(n-t)}else{u=2*Math.PI/s,d=Math.atan2(i-o,n-t),c=Math.floor(d/u)*u,p=void 0,g=void 0,m=void 0,f=void 0;Math.tan(d)>0?(p=c,g=Math.tan(c),m=c+u,f=Math.tan(c+u)):(p=c+u,g=Math.tan(c+u),m=c,f=Math.tan(c));v=Math.abs(g),_=Math.abs(f),S=Math.abs(t-n),y=Math.abs(i-o),E=0;_>1e-10&&(E=y/_);C=0;v<1e10&&(C=S*v);P=void 0;Math.abs(E-S)<Math.abs(C-y)?(P=m,this.x=t+(i-o)/f):(P=p,this.y=i-(n-t)*g);h=r.getMagnetizedLength(java.awt.geom.Point2D.distance(t,i,this.x,this.y),l);this.x=t+h*Math.cos(P),this.y=i-h*Math.sin(P),this.angle=P}void 0===this.x&&(this.x=0),void 0===this.y&&(this.y=0),void 0===this.angle&&(this.angle=0)}else{if(void 0===this.x&&(this.x=0),void 0===this.y&&(this.y=0),void 0===this.angle&&(this.angle=0),this.x=n,this.y=o,t===n){var h=r.getMagnetizedLength(Math.abs(i-o),l);this.y=i+h*((w=o-i)>0?1:w<0?-1:0)}else if(i===o){var h=r.getMagnetizedLength(Math.abs(t-n),l);this.x=t+h*function(e){return e>0?1:e<0?-1:0}(n-t)}else{var u=2*Math.PI/a,d=Math.atan2(i-o,n-t),c=Math.floor(d/u)*u,p=void 0,g=void 0,m=void 0,f=void 0;Math.tan(d)>0?(p=c,g=Math.tan(c),m=c+u,f=Math.tan(c+u)):(p=c+u,g=Math.tan(c+u),m=c,f=Math.tan(c));var v=Math.abs(g),_=Math.abs(f),S=Math.abs(t-n),y=Math.abs(i-o),E=0;_>1e-10&&(E=y/_);var C=0;v<1e10&&(C=S*v);var P=void 0;Math.abs(E-S)<Math.abs(C-y)?(P=m,this.x=t+(i-o)/f):(P=p,this.y=i-(n-t)*g);var h=r.getMagnetizedLength(java.awt.geom.Point2D.distance(t,i,this.x,this.y),l);this.x=t+h*Math.cos(P),this.y=i-h*Math.sin(P),this.angle=P}}var w}return e.prototype.getX=function(){return this.x},e.prototype.setX=function(e){this.x=e},e.prototype.getY=function(){return this.y},e.prototype.setY=function(e){this.y=e},e.prototype.getAngle=function(){return this.angle},e.CIRCLE_STEPS_15_DEG=24,e}();e.PointWithAngleMagnetism=ne,ne.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PointWithAngleMagnetism";var oe=function(){function e(e,t,i,n,o){if(!(null!=t&&t instanceof Room||null===t)||"number"!=typeof i&&null!==i||"number"!=typeof n&&null!==n||"number"!=typeof o&&null!==o){if("number"!=typeof t&&null!==t||"number"!=typeof i&&null!==i||void 0!==n||void 0!==o)throw new Error("invalid overload");var r=(a=Array.prototype.slice.call(arguments,[1]))[0],l=a[1];Array.prototype.slice.call(arguments,[1]);void 0===this.x&&(this.x=0),void 0===this.y&&(this.y=0),void 0===this.magnetized&&(this.magnetized=!1);for(s=e.getSelectionMargin(),h=17976931348623157e292,u=e.getRoomPathsFromWalls(),d=0;d<u.length;d++){c=u[d];h=this.updateMagnetizedPoint(-1,r,l,h,e.getPathPoints(c,!1))}for(u=e.getDetectableRoomsAtSelectedLevel(),d=0;d<u.length;d++){p=u[d];h=this.updateMagnetizedPoint(-1,r,l,h,p.getPoints())}this.magnetized=h<=s*s,this.magnetized||(this.x=r,this.y=l),void 0===this.x&&(this.x=0),void 0===this.y&&(this.y=0),void 0===this.magnetized&&(this.magnetized=!1)}else{var a=Array.prototype.slice.call(arguments,[1]);void 0===this.x&&(this.x=0),void 0===this.y&&(this.y=0),void 0===this.magnetized&&(this.magnetized=!1);for(var s=e.getSelectionMargin(),h=17976931348623157e292,u=e.getRoomPathsFromWalls(),d=0;d<u.length;d++){var c=u[d];h=this.updateMagnetizedPoint(-1,n,o,h,e.getPathPoints(c,!1))}for(var u=e.getDetectableRoomsAtSelectedLevel(),d=0;d<u.length;d++){var p=u[d];h=this.updateMagnetizedPoint(p===t?i:-1,n,o,h,p.getPoints())}this.magnetized=h<=s*s,this.magnetized||(this.x=n,this.y=o)}}return e.prototype.updateMagnetizedPoint=function(e,t,i,n,o){for(var r=0;r<o.length;r++)if(r!==e){var l=java.awt.geom.Point2D.distanceSq(o[r][0],o[r][1],t,i);l<n&&(this.x=o[r][0],this.y=o[r][1],n=l)}return n},e.prototype.getX=function(){return this.x},e.prototype.getY=function(){return this.y},e.prototype.isMagnetized=function(){return this.magnetized},e}();e.PointMagnetizedToClosestWallOrRoomPoint=oe,oe.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PointMagnetizedToClosestWallOrRoomPoint";var re=function(){function e(){}return e.prototype.enter=function(){},e.prototype.exit=function(){},e.prototype.setMode=function(e){},e.prototype.isModificationState=function(){return!1},e.prototype.isBasePlanModificationState=function(){return!1},e.prototype.deleteSelection=function(){},e.prototype.escape=function(){},e.prototype.moveSelection=function(e,t){},e.prototype.toggleMagnetism=function(e){},e.prototype.setAlignmentActivated=function(e){},e.prototype.setDuplicationActivated=function(e){},e.prototype.setEditionActivated=function(e){},e.prototype.updateEditableProperty=function(e,t){},e.prototype.pressMouse=function(e,t,i,n,o){},e.prototype.releaseMouse=function(e,t){},e.prototype.moveMouse=function(e,t){},e.prototype.zoom=function(e){},e}();e.ControllerState=re,re.__class="com.eteks.sweethome3d.viewcontroller.PlanController.ControllerState";var le=function(t){function i(i,n,o,r,l,a){var s=t.call(this,o,r,l,a,i.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit(),i.getView().getPixelLength())||this;s.__parent=i;for(var h=e.PIXEL_MARGIN/i.getScale(),u=1/0,d=1/0,c=0,p=0,g=i.getDetectableWallsAtSelectedLevel(),m=0;m<g.length;m++){var f=g[m];f!==n&&(Math.abs(s.getX()-f.getXStart())<h&&(null==n||!s.equalsWallPoint(f.getXStart(),f.getYStart(),n))?Math.abs(d)>Math.abs(s.getY()-f.getYStart())&&(c=f.getXStart(),d=s.getY()-p):Math.abs(s.getX()-f.getXEnd())<h&&(null==n||!s.equalsWallPoint(f.getXEnd(),f.getYEnd(),n))&&Math.abs(d)>Math.abs(s.getY()-f.getYEnd())&&(c=f.getXEnd(),d=s.getY()-p),Math.abs(s.getY()-f.getYStart())<h&&(null==n||!s.equalsWallPoint(f.getXStart(),f.getYStart(),n))?Math.abs(u)>Math.abs(s.getX()-f.getXStart())&&(p=f.getYStart(),u=s.getX()-c):Math.abs(s.getY()-f.getYEnd())<h&&(null==n||!s.equalsWallPoint(f.getXEnd(),f.getYEnd(),n))&&Math.abs(u)>Math.abs(s.getX()-f.getXEnd())&&(p=f.getYEnd(),u=s.getX()-c))}if(null!=n){var v=-Math.tan(s.getAngle()),_=Math.abs(v)<1e10?r-v*o:1/0;if(u!==1/0&&Math.abs(v)>1e-10){var S=(p-_)/v;if(java.awt.geom.Point2D.distanceSq(s.getX(),s.getY(),S,p)<=h*h)return s.setX(S),s.setY(p),s}if(d!==1/0&&_!==1/0){var y=v*c+_;java.awt.geom.Point2D.distanceSq(s.getX(),s.getY(),c,y)<=h*h&&(s.setX(c),s.setY(y))}}else u!==1/0&&s.setY(p),d!==1/0&&s.setX(c);return s}return __extends(i,t),i.prototype.equalsWallPoint=function(e,t,i){return e===i.getXStart()&&t===i.getYStart()||e===i.getXEnd()&&t===i.getYEnd()},i}(e.PointWithAngleMagnetism);e.WallPointWithAngleMagnetism=le,le.__class="com.eteks.sweethome3d.viewcontroller.PlanController.WallPointWithAngleMagnetism";var ae=function(t){function i(i,n,o,r,l,a,s){var h=t.call(this,r,l,a,s,i.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit(),i.getView().getPixelLength())||this;h.__parent=i;for(var u=i.getScale(),d=e.PIXEL_MARGIN/u,c=1/0,p=1/0,g=0,m=0,f=i.getDetectableRoomsAtSelectedLevel(),v=0;v<f.length;v++)for(var _=f[v].getPoints(),S=0;S<_.length;S++)(-1===o||S!==o&&_.length>2)&&(Math.abs(h.getX()-_[S][0])<d&&Math.abs(p)>Math.abs(h.getY()-_[S][1])&&(g=_[S][0],p=h.getY()-_[S][1]),Math.abs(h.getY()-_[S][1])<d&&Math.abs(c)>Math.abs(h.getX()-_[S][0])&&(m=_[S][1],c=h.getX()-_[S][0]));for(f=i.getDetectableWallsAtSelectedLevel(),v=0;v<f.length;v++){var y=f[v].getPoints$();y=[y[0],y[(y.length/2|0)-1],y[y.length/2|0],y[y.length-1]];for(S=0;S<y.length;S++)Math.abs(h.getX()-y[S][0])<d&&Math.abs(p)>Math.abs(h.getY()-y[S][1])&&(g=y[S][0],p=h.getY()-y[S][1]),Math.abs(h.getY()-y[S][1])<d&&Math.abs(c)>Math.abs(h.getX()-y[S][0])&&(m=y[S][1],c=h.getX()-y[S][0])}if(null!=n){var E=-Math.tan(h.getAngle()),C=Math.abs(E)<1e10?l-E*r:1/0;if(c!==1/0&&Math.abs(E)>1e-10){var P=(m-C)/E;if(java.awt.geom.Point2D.distanceSq(h.getX(),h.getY(),P,m)<=d*d)return h.setX(P),h.setY(m),h}if(p!==1/0&&C!==1/0){var w=E*g+C;java.awt.geom.Point2D.distanceSq(h.getX(),h.getY(),g,w)<=d*d&&(h.setX(g),h.setY(w))}}else c!==1/0&&h.setY(m),p!==1/0&&h.setX(g);return h}return __extends(i,t),i}(e.PointWithAngleMagnetism);e.RoomPointWithAngleMagnetism=ae,ae.__class="com.eteks.sweethome3d.viewcontroller.PlanController.RoomPointWithAngleMagnetism";var se=function(e){function t(t){var i=e.call(this)||this;return void 0===i.state&&(i.state=null),i.state=t,i}return __extends(t,e),t.prototype.enter=function(){this.state.enter()},t.prototype.exit=function(){this.state.exit()},t.prototype.getMode=function(){return this.state.getMode()},t.prototype.setMode=function(e){this.state.setMode(e)},t.prototype.isModificationState=function(){return this.state.isModificationState()},t.prototype.isBasePlanModificationState=function(){return this.state.isBasePlanModificationState()},t.prototype.deleteSelection=function(){this.state.deleteSelection()},t.prototype.escape=function(){this.state.escape()},t.prototype.moveSelection=function(e,t){this.state.moveSelection(e,t)},t.prototype.toggleMagnetism=function(e){this.state.toggleMagnetism(e)},t.prototype.setAlignmentActivated=function(e){this.state.setAlignmentActivated(e)},t.prototype.setDuplicationActivated=function(e){this.state.setDuplicationActivated(e)},t.prototype.setEditionActivated=function(e){this.state.setEditionActivated(e)},t.prototype.updateEditableProperty=function(e,t){this.state.updateEditableProperty(e,t)},t.prototype.pressMouse=function(e,t,i,n,o){this.state.pressMouse(e,t,i,n,o)},t.prototype.releaseMouse=function(e,t){this.state.releaseMouse(e,t)},t.prototype.moveMouse=function(e,t){this.state.moveMouse(e,t)},t.prototype.zoom=function(e){this.state.zoom(e)},t}(e.ControllerState);e.ControllerStateDecorator=se,se.__class="com.eteks.sweethome3d.viewcontroller.PlanController.ControllerStateDecorator";var he=function(t){function i(e){var i=t.call(this)||this;return i.__parent=e,i}return __extends(i,t),i.prototype.setMode=function(t){t===e.Mode.SELECTION_$LI$()?this.__parent.setState(this.__parent.getSelectionState()):t===e.Mode.PANNING_$LI$()?this.__parent.setState(this.__parent.getPanningState()):t===e.Mode.WALL_CREATION_$LI$()?this.__parent.setState(this.__parent.getWallCreationState()):t===e.Mode.ROOM_CREATION_$LI$()?this.__parent.setState(this.__parent.getRoomCreationState()):t===e.Mode.POLYLINE_CREATION_$LI$()?this.__parent.setState(this.__parent.getPolylineCreationState()):t===e.Mode.DIMENSION_LINE_CREATION_$LI$()?this.__parent.setState(this.__parent.getDimensionLineCreationState()):t===e.Mode.LABEL_CREATION_$LI$()&&this.__parent.setState(this.__parent.getLabelCreationState())},i.prototype.deleteSelection=function(){this.__parent.deleteItems(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()),this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())},i.prototype.moveSelection=function(e,t){this.__parent.moveAndShowSelectedItems(e,t),this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())},i.prototype.zoom=function(e){this.__parent.setScale(this.__parent.getScale()*e)},i}(e.ControllerState);e.AbstractModeChangeState=he,he.__class="com.eteks.sweethome3d.viewcontroller.PlanController.AbstractModeChangeState";var ue,de,ce=function(t){function i(e){var i=t.call(this)||this;return i.__parent=e,void 0===i.xLastMouseMove&&(i.xLastMouseMove=0),void 0===i.yLastMouseMove&&(i.yLastMouseMove=0),void 0===i.mouseMoved&&(i.mouseMoved=!1),void 0===i.oldSelection&&(i.oldSelection=null),void 0===i.selectionUpdateNeeded&&(i.selectionUpdateNeeded=!1),void 0===i.movedItems&&(i.movedItems=null),void 0===i.duplicatedItems&&(i.duplicatedItems=null),void 0===i.movedPieceOfFurniture&&(i.movedPieceOfFurniture=null),void 0===i.angleMovedPieceOfFurniture&&(i.angleMovedPieceOfFurniture=0),void 0===i.depthMovedPieceOfFurniture&&(i.depthMovedPieceOfFurniture=0),void 0===i.elevationMovedPieceOfFurniture&&(i.elevationMovedPieceOfFurniture=0),void 0===i.xMovedPieceOfFurniture&&(i.xMovedPieceOfFurniture=0),void 0===i.yMovedPieceOfFurniture&&(i.yMovedPieceOfFurniture=0),void 0===i.movedDoorOrWindowBoundToWall&&(i.movedDoorOrWindowBoundToWall=!1),void 0===i.magnetismEnabled&&(i.magnetismEnabled=!1),void 0===i.duplicationActivated&&(i.duplicationActivated=!1),void 0===i.alignmentActivated&&(i.alignmentActivated=!1),void 0===i.basePlanModification&&(i.basePlanModification=!1),i}return __extends(i,t),i.prototype.getMode=function(){return e.Mode.SELECTION_$LI$()},i.prototype.isModificationState=function(){return!0},i.prototype.isBasePlanModificationState=function(){return this.basePlanModification},i.prototype.enter=function(){this.xLastMouseMove=this.__parent.getXLastMousePress(),this.yLastMouseMove=this.__parent.getYLastMousePress(),this.mouseMoved=!1;for(var e=this.__parent.getSelectableItemsAt(this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress()),t=e.slice(0),i=this.__parent.getSelectionMargin(),n=0;n<e.length;n++){if(null!=(s=e[n])&&s instanceof HomeFurnitureGroup)for(var o=s.getAllFurniture(),r=0;r<o.length;r++){var l=o[r];l.containsPoint(this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress(),i)&&t.push(l)}}this.oldSelection=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems(),this.toggleMagnetism(this.__parent.wasMagnetismToggledLastMousePress()),this.selectionUpdateNeeded=function(e,t){for(var i=0;i<e.length;i++)if(t.indexOf(e[i])>=0)return!1;return!0}(t,this.oldSelection),this.selectionUpdateNeeded&&this.__parent.getPointerTypeLastMousePress()!==View.PointerType.TOUCH&&this.__parent.selectItem(this.__parent.getSelectableItemAt(this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress(),!1));var a=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();this.movedItems=[],this.basePlanModification=!1;for(n=0;n<a.length;n++){var s=a[n];this.__parent.isItemMovable(s)&&(this.movedItems.push(s),!this.basePlanModification&&this.__parent.isItemPartOfBasePlan(s)&&(this.basePlanModification=!0))}1===this.movedItems.length&&null!=this.movedItems[0]&&this.movedItems[0]instanceof HomePieceOfFurniture&&(this.movedPieceOfFurniture=this.movedItems[0],this.xMovedPieceOfFurniture=this.movedPieceOfFurniture.getX(),this.yMovedPieceOfFurniture=this.movedPieceOfFurniture.getY(),this.angleMovedPieceOfFurniture=this.movedPieceOfFurniture.getAngle(),this.depthMovedPieceOfFurniture=this.movedPieceOfFurniture.getDepth(),this.elevationMovedPieceOfFurniture=this.movedPieceOfFurniture.getElevation(),this.movedDoorOrWindowBoundToWall=null!=this.movedPieceOfFurniture&&this.movedPieceOfFurniture instanceof HomeDoorOrWindow&&this.movedPieceOfFurniture.isBoundToWall()),this.duplicatedItems=null,this.duplicationActivated=this.__parent.wasDuplicationActivatedLastMousePress()&&!this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection(),this.alignmentActivated=this.__parent.wasAlignmentActivatedLastMousePress(),this.__parent.getPointerTypeLastMousePress()===View.PointerType.TOUCH&&this.selectionUpdateNeeded||this.__parent.getView().setCursor(PlanView.CursorType.MOVE)},i.prototype.moveMouse=function(t,n){if(this.__parent.getPointerTypeLastMousePress()===View.PointerType.TOUCH&&this.selectionUpdateNeeded)this.__parent.setState(new i.SelectionMoveState$0(this,this.__parent.getPanningState()));else{if(this.mouseMoved||this.toggleDuplication(this.duplicationActivated),this.alignmentActivated){var o=new e.PointWithAngleMagnetism(this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress(),t,n,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit(),this.__parent.getView().getPixelLength(),4);t=o.getX(),n=o.getY()}if(null!=this.movedPieceOfFurniture){if(this.movedPieceOfFurniture.setX(this.xMovedPieceOfFurniture),this.movedPieceOfFurniture.setY(this.yMovedPieceOfFurniture),this.movedPieceOfFurniture.setAngle(this.angleMovedPieceOfFurniture),null!=this.movedPieceOfFurniture&&this.movedPieceOfFurniture instanceof HomeDoorOrWindow&&this.movedPieceOfFurniture.isResizable()&&this.__parent.isItemResizable(this.movedPieceOfFurniture)&&this.movedPieceOfFurniture.setDepth(this.depthMovedPieceOfFurniture),this.movedPieceOfFurniture.setElevation(this.elevationMovedPieceOfFurniture),this.movedPieceOfFurniture.move(t-this.__parent.getXLastMousePress(),n-this.__parent.getYLastMousePress()),this.magnetismEnabled&&!this.alignmentActivated){var r=null!=this.__parent.adjustPieceOfFurnitureElevation(this.movedPieceOfFurniture,!0,34028235e31),l=this.__parent.adjustPieceOfFurnitureOnWallAt(this.movedPieceOfFurniture,t,n,!1),a=null;r||(a=this.__parent.adjustPieceOfFurnitureSideBySideAt(this.movedPieceOfFurniture,!1,l)),null==a&&this.__parent.adjustPieceOfFurnitureInShelfBox(this.movedPieceOfFurniture,!1),this.__parent.feedbackDisplayed&&null!=l?this.__parent.getView().setDimensionLinesFeedback(this.__parent.getDimensionLinesAlongWall(this.movedPieceOfFurniture,l)):this.__parent.getView().setDimensionLinesFeedback(null)}}else this.__parent.moveItems(this.movedItems,t-this.xLastMouseMove,n-this.yLastMouseMove);this.mouseMoved||this.__parent.selectItems(this.movedItems,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection()),this.__parent.getView().makePointVisible(t,n),this.xLastMouseMove=t,this.yLastMouseMove=n,this.mouseMoved=!0}},i.prototype.releaseMouse=function(e,t){if(this.mouseMoved)this.movedItems.length>0&&!(null!=this.movedItems[0]&&this.movedItems[0]instanceof Camera)&&(null!=this.duplicatedItems?this.__parent.postItemsDuplication(this.movedItems,this.duplicatedItems):null!=this.movedPieceOfFurniture?this.__parent.postPieceOfFurnitureMove(this.movedPieceOfFurniture,this.movedPieceOfFurniture.getX()-this.xMovedPieceOfFurniture,this.movedPieceOfFurniture.getY()-this.yMovedPieceOfFurniture,this.angleMovedPieceOfFurniture,this.depthMovedPieceOfFurniture,this.elevationMovedPieceOfFurniture,this.movedDoorOrWindowBoundToWall):this.__parent.postItemsMove(this.movedItems,this.oldSelection,this.xLastMouseMove-this.__parent.getXLastMousePress(),this.yLastMouseMove-this.__parent.getYLastMousePress()));else if(this.__parent.getPointerTypeLastMousePress()===View.PointerType.TOUCH||!function(e,t){for(var i=0;i<e.length;i++)if(t.indexOf(e[i])>=0)return!1;return!0}(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems(),this.oldSelection)){var i=this.__parent.getSelectableItemAt(e,t,!1);null!=i?this.__parent.selectItem(i):this.__parent.deselectAll()}this.__parent.setState(this.__parent.getSelectionState())},i.prototype.toggleMagnetism=function(e){this.magnetismEnabled=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled()!==e,null!=this.movedPieceOfFurniture&&(this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove()),this.magnetismEnabled||this.__parent.getView().deleteFeedback())},i.prototype.escape=function(){this.mouseMoved&&(null!=this.duplicatedItems?(this.__parent.doDeleteItems(this.movedItems),this.__parent.selectItems(this.duplicatedItems)):null!=this.movedPieceOfFurniture?(this.movedPieceOfFurniture.setX(this.xMovedPieceOfFurniture),this.movedPieceOfFurniture.setY(this.yMovedPieceOfFurniture),this.movedPieceOfFurniture.setAngle(this.angleMovedPieceOfFurniture),null!=this.movedPieceOfFurniture&&this.movedPieceOfFurniture instanceof HomeDoorOrWindow&&this.movedPieceOfFurniture.isResizable()&&this.__parent.isItemResizable(this.movedPieceOfFurniture)&&this.movedPieceOfFurniture.setDepth(this.depthMovedPieceOfFurniture),this.movedPieceOfFurniture.setElevation(this.elevationMovedPieceOfFurniture),null!=this.movedPieceOfFurniture&&this.movedPieceOfFurniture instanceof HomeDoorOrWindow&&this.movedPieceOfFurniture.setBoundToWall(this.movedDoorOrWindowBoundToWall)):this.__parent.moveItems(this.movedItems,this.__parent.getXLastMousePress()-this.xLastMouseMove,this.__parent.getYLastMousePress()-this.yLastMouseMove)),this.__parent.setState(this.__parent.getSelectionState())},i.prototype.setDuplicationActivated=function(e){e=!this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection()&&e,this.mouseMoved&&this.toggleDuplication(e),this.duplicationActivated=e},i.prototype.setAlignmentActivated=function(e){this.__parent.getPointerTypeLastMousePress()===View.PointerType.TOUCH&&this.selectionUpdateNeeded&&!this.duplicationActivated?(this.__parent.setState(this.__parent.getSelectionState()),this.__parent.pressMouse$float$float$int$boolean$boolean$boolean$boolean$com_eteks_sweethome3d_viewcontroller_View_PointerType(this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress(),1,!0,!1,!1,!1,this.__parent.getPointerTypeLastMousePress())):(this.alignmentActivated=e,this.mouseMoved&&this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove()),this.alignmentActivated&&this.__parent.getView().deleteFeedback())},i.prototype.toggleDuplication=function(e){if(this.movedItems.length>1||1===this.movedItems.length&&!(null!=this.movedItems[0]&&this.movedItems[0]instanceof Camera)&&!(null!=this.movedItems[0]&&this.movedItems[0]instanceof Compass)){if(e&&null==this.duplicatedItems){this.duplicatedItems=this.movedItems,this.movedItems=[];for(var t=Home.duplicate(this.duplicatedItems),i=0;i<t.length;i++){var n=t[i];if(null!=n&&n instanceof Wall)this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addWall(n);else if(null!=n&&n instanceof Room)this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addRoom$com_eteks_sweethome3d_model_Room(n);else if(null!=n&&n instanceof Polyline)this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addPolyline$com_eteks_sweethome3d_model_Polyline(n);else if(null!=n&&n instanceof DimensionLine)this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addDimensionLine(n);else if(null!=n&&n instanceof HomePieceOfFurniture)this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addPieceOfFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture(n);else{if(!(null!=n&&n instanceof Label))continue;this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addLabel(n)}this.movedItems.push(n)}null!=this.movedPieceOfFurniture?(this.movedPieceOfFurniture.setX(this.xMovedPieceOfFurniture),this.movedPieceOfFurniture.setY(this.yMovedPieceOfFurniture),this.movedPieceOfFurniture.setAngle(this.angleMovedPieceOfFurniture),null!=this.movedPieceOfFurniture&&this.movedPieceOfFurniture instanceof HomeDoorOrWindow&&this.movedPieceOfFurniture.isResizable()&&this.__parent.isItemResizable(this.movedPieceOfFurniture)&&this.movedPieceOfFurniture.setDepth(this.depthMovedPieceOfFurniture),this.movedPieceOfFurniture.setElevation(this.elevationMovedPieceOfFurniture),this.movedPieceOfFurniture=this.movedItems[0]):this.__parent.moveItems(this.duplicatedItems,this.__parent.getXLastMousePress()-this.xLastMouseMove,this.__parent.getYLastMousePress()-this.yLastMouseMove),this.__parent.getView().setCursor(PlanView.CursorType.DUPLICATION)}else e||null==this.duplicatedItems||(this.__parent.doDeleteItems(this.movedItems),this.__parent.moveItems(this.duplicatedItems,this.xLastMouseMove-this.__parent.getXLastMousePress(),this.yLastMouseMove-this.__parent.getYLastMousePress()),this.movedItems=this.duplicatedItems,this.duplicatedItems=null,null!=this.movedPieceOfFurniture&&(this.movedPieceOfFurniture=this.movedItems[0]),this.__parent.getView().setCursor(PlanView.CursorType.MOVE));this.__parent.selectItems(this.movedItems,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection())}},i.prototype.exit=function(){this.__parent.getView().deleteFeedback(),this.movedItems=null,this.duplicatedItems=null,this.movedPieceOfFurniture=null},i}(e.ControllerState);e.SelectionMoveState=ce,ce.__class="com.eteks.sweethome3d.viewcontroller.PlanController.SelectionMoveState",ue=ce=e.SelectionMoveState||(e.SelectionMoveState={}),de=function(e){function t(t,i){var n=e.call(this,i)||this;return n.__parent=t,n}return __extends(t,e),t.prototype.enter=function(){e.prototype.enter.call(this),this.pressMouse(this.__parent.__parent.getXLastMousePress(),this.__parent.__parent.getYLastMousePress(),1,this.__parent.__parent.wasShiftDownLastMousePress(),this.__parent.__parent.wasDuplicationActivatedLastMousePress()),this.moveMouse(this.__parent.__parent.getXLastMouseMove(),this.__parent.__parent.getYLastMouseMove())},t.prototype.releaseMouse=function(e,t){this.escape()},t.prototype.escape=function(){e.prototype.escape.call(this),this.__parent.__parent.setState(this.__parent.__parent.getSelectionState())},t}(e.ControllerStateDecorator),ue.SelectionMoveState$0=de;var pe=function(t){function i(e){var i=t.call(this)||this;return i.__parent=e,void 0===i.selectedItemsMousePressed&&(i.selectedItemsMousePressed=null),void 0===i.ignoreRectangleSelection&&(i.ignoreRectangleSelection=!1),void 0===i.mouseMoved&&(i.mouseMoved=!1),i}return __extends(i,t),i.prototype.getMode=function(){return e.Mode.SELECTION_$LI$()},i.prototype.isModificationState=function(){return!0},i.prototype.enter=function(){null!=this.__parent.getSelectableItemAt(this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress())||this.__parent.wasShiftDownLastMousePress()||this.__parent.deselectAll(),this.selectedItemsMousePressed=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems().slice(0);var e=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getFurniture();this.ignoreRectangleSelection=!1;for(var t=0;t<this.selectedItemsMousePressed.length;t++){var i=this.selectedItemsMousePressed[t];if(null!=i&&i instanceof HomePieceOfFurniture&&!(e.indexOf(i)>=0)){this.ignoreRectangleSelection=!0;break}}this.mouseMoved=!1},i.prototype.moveMouse=function(e,t){if(this.mouseMoved=!0,!this.ignoreRectangleSelection){if(this.updateSelectedItems(this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress(),e,t,this.selectedItemsMousePressed),this.__parent.feedbackDisplayed)this.__parent.getView().setRectangleFeedback(this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress(),e,t);this.__parent.planView.makePointVisible(e,t)}},i.prototype.releaseMouse=function(e,t){if(!this.mouseMoved){var i=this.__parent.getSelectableItemAt(e,t,!1);if(null!=i){if(this.selectedItemsMousePressed.indexOf(i)>=0)r=this.selectedItemsMousePressed,(l=r.indexOf(i))>=0&&r.splice(l,1);else{for(var n=this.selectedItemsMousePressed.length-1;n>=0;n--){var o=this.selectedItemsMousePressed[n];(null!=o&&o instanceof Camera||null!=i&&i instanceof HomePieceOfFurniture&&null!=o&&o instanceof HomeFurnitureGroup&&o.getAllFurniture().indexOf(i)>=0||null!=i&&i instanceof HomeFurnitureGroup&&null!=o&&o instanceof HomePieceOfFurniture&&i.getAllFurniture().indexOf(o)>=0)&&this.selectedItemsMousePressed.splice(n,1)[0]}null!=i&&i instanceof Camera&&0!==this.selectedItemsMousePressed.length||this.selectedItemsMousePressed.push(i)}this.__parent.selectItems(this.selectedItemsMousePressed,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection()&&this.__parent.wasShiftDownLastMousePress())}}var r,l;this.__parent.setState(this.__parent.getSelectionState())},i.prototype.escape=function(){this.__parent.setState(this.__parent.getSelectionState())},i.prototype.exit=function(){this.__parent.getView().deleteFeedback(),this.selectedItemsMousePressed=null},i.prototype.updateSelectedItems=function(e,t,i,n,o){var r,l=this.__parent.wasShiftDownLastMousePress();r=l?o.slice(0):[];for(var a,s,h,u=this.__parent.getSelectableItemsIntersectingRectangle(e,t,i,n),d=0;d<u.length;d++)a=void 0,s=void 0,h=void 0,null!=(h=u[d])&&h instanceof Camera||(l?o.indexOf(h)>=0?(s=(a=r).indexOf(h))>=0&&a.splice(s,1):r.push(h):o.indexOf(h)>=0||r.push(h));this.__parent.selectItems(r,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection()&&l)},i}(e.ControllerState);e.RectangleSelectionState=pe,pe.__class="com.eteks.sweethome3d.viewcontroller.PlanController.RectangleSelectionState";var ge=function(t){function i(e){var i=t.call(this)||this;return i.__parent=e,void 0===i.xLastMouseMove&&(i.xLastMouseMove=null),void 0===i.yLastMouseMove&&(i.yLastMouseMove=null),i}return __extends(i,t),i.prototype.getMode=function(){return e.Mode.PANNING_$LI$()},i.prototype.setMode=function(t){t===e.Mode.SELECTION_$LI$()?this.__parent.setState(this.__parent.getSelectionState()):t===e.Mode.WALL_CREATION_$LI$()?this.__parent.setState(this.__parent.getWallCreationState()):t===e.Mode.ROOM_CREATION_$LI$()?this.__parent.setState(this.__parent.getRoomCreationState()):t===e.Mode.POLYLINE_CREATION_$LI$()?this.__parent.setState(this.__parent.getPolylineCreationState()):t===e.Mode.DIMENSION_LINE_CREATION_$LI$()?this.__parent.setState(this.__parent.getDimensionLineCreationState()):t===e.Mode.LABEL_CREATION_$LI$()&&this.__parent.setState(this.__parent.getLabelCreationState())},i.prototype.enter=function(){this.__parent.getView().setCursor(PlanView.CursorType.PANNING)},i.prototype.moveSelection=function(e,t){this.__parent.getView().moveView(10*e,10*t)},i.prototype.pressMouse=function(e,t,i,n,o){1===i?(this.xLastMouseMove=this.__parent.getView().convertXModelToScreen(e),this.yLastMouseMove=this.__parent.getView().convertYModelToScreen(t)):(this.xLastMouseMove=null,this.yLastMouseMove=null)},i.prototype.moveMouse=function(e,t){if(null!=this.xLastMouseMove){var i=this.__parent.getView().convertXModelToScreen(e),n=this.__parent.getView().convertYModelToScreen(t);this.__parent.getView().moveView((this.xLastMouseMove-i)/this.__parent.getScale(),(this.yLastMouseMove-n)/this.__parent.getScale()),this.xLastMouseMove=i,this.yLastMouseMove=n}},i.prototype.releaseMouse=function(e,t){this.xLastMouseMove=null},i.prototype.escape=function(){this.xLastMouseMove=null},i.prototype.zoom=function(e){this.__parent.setScale(this.__parent.getScale()*e)},i}(e.ControllerState);e.PanningState=ge,ge.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PanningState";var me=function(t){function i(e){var i=t.call(this)||this;return i.__parent=e,void 0===i.xLastMouseMove&&(i.xLastMouseMove=0),void 0===i.yLastMouseMove&&(i.yLastMouseMove=0),void 0===i.draggedPieceOfFurniture&&(i.draggedPieceOfFurniture=null),void 0===i.xDraggedPieceOfFurniture&&(i.xDraggedPieceOfFurniture=0),void 0===i.yDraggedPieceOfFurniture&&(i.yDraggedPieceOfFurniture=0),void 0===i.angleDraggedPieceOfFurniture&&(i.angleDraggedPieceOfFurniture=0),void 0===i.depthDraggedPieceOfFurniture&&(i.depthDraggedPieceOfFurniture=0),void 0===i.elevationDraggedPieceOfFurniture&&(i.elevationDraggedPieceOfFurniture=0),i}return __extends(i,t),i.prototype.getMode=function(){return e.Mode.SELECTION_$LI$()},i.prototype.isModificationState=function(){return!1},i.prototype.isBasePlanModificationState=function(){return null!=this.draggedPieceOfFurniture&&this.__parent.isPieceOfFurniturePartOfBasePlan(this.draggedPieceOfFurniture)},i.prototype.enter=function(){this.xLastMouseMove=0,this.yLastMouseMove=0,this.__parent.feedbackDisplayed&&this.__parent.getView().setDraggedItemsFeedback(this.__parent.draggedItems),1===this.__parent.draggedItems.length&&null!=this.__parent.draggedItems[0]&&this.__parent.draggedItems[0]instanceof HomePieceOfFurniture&&(this.draggedPieceOfFurniture=this.__parent.draggedItems[0],this.xDraggedPieceOfFurniture=this.draggedPieceOfFurniture.getX(),this.yDraggedPieceOfFurniture=this.draggedPieceOfFurniture.getY(),this.angleDraggedPieceOfFurniture=this.draggedPieceOfFurniture.getAngle(),this.depthDraggedPieceOfFurniture=this.draggedPieceOfFurniture.getDepth(),this.elevationDraggedPieceOfFurniture=this.draggedPieceOfFurniture.getElevation())},i.prototype.moveMouse=function(e,t){var i=this.__parent.draggedItems.slice(0);if(this.__parent.moveItems(this.__parent.draggedItems,e-this.xLastMouseMove,t-this.yLastMouseMove),null!=this.draggedPieceOfFurniture&&this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled()){this.draggedPieceOfFurniture.setX(this.xDraggedPieceOfFurniture),this.draggedPieceOfFurniture.setY(this.yDraggedPieceOfFurniture),this.draggedPieceOfFurniture.setAngle(this.angleDraggedPieceOfFurniture),this.draggedPieceOfFurniture.isResizable()&&(this.draggedPieceOfFurniture.setDepth(this.depthDraggedPieceOfFurniture),this.draggedPieceOfFurniture.setDepthInPlan(this.depthDraggedPieceOfFurniture)),this.draggedPieceOfFurniture.setElevation(this.elevationDraggedPieceOfFurniture),this.draggedPieceOfFurniture.move(e,t);var n=null!=this.__parent.adjustPieceOfFurnitureElevation(this.draggedPieceOfFurniture,!1,34028235e31),o=this.__parent.adjustPieceOfFurnitureOnWallAt(this.draggedPieceOfFurniture,e,t,!0),r=null;n||(r=this.__parent.adjustPieceOfFurnitureSideBySideAt(this.draggedPieceOfFurniture,null==o,o)),null==r&&this.__parent.adjustPieceOfFurnitureInShelfBox(this.draggedPieceOfFurniture,null==o),this.__parent.feedbackDisplayed&&null!=o?this.__parent.getView().setDimensionLinesFeedback(this.__parent.getDimensionLinesAlongWall(this.draggedPieceOfFurniture,o)):this.__parent.getView().setDimensionLinesFeedback(null)}this.__parent.feedbackDisplayed&&this.__parent.getView().setDraggedItemsFeedback(i),this.xLastMouseMove=e,this.yLastMouseMove=t},i.prototype.exit=function(){this.draggedPieceOfFurniture=null,this.__parent.getView().deleteFeedback()},i}(e.ControllerState);e.DragAndDropState=me,me.__class="com.eteks.sweethome3d.viewcontroller.PlanController.DragAndDropState";var fe=function(t){function i(e){var i=t.call(this)||this;return i.__parent=e,void 0===i.wallLengthToolTipFeedback&&(i.wallLengthToolTipFeedback=null),void 0===i.wallAngleToolTipFeedback&&(i.wallAngleToolTipFeedback=null),void 0===i.wallArcExtentToolTipFeedback&&(i.wallArcExtentToolTipFeedback=null),void 0===i.wallThicknessToolTipFeedback&&(i.wallThicknessToolTipFeedback=null),i}return __extends(i,t),i.prototype.enter=function(){this.wallLengthToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(e,"wallLengthToolTipFeedback");try{this.wallAngleToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(e,"wallAngleToolTipFeedback")}catch(e){}this.wallArcExtentToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(e,"wallArcExtentToolTipFeedback");try{this.wallThicknessToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(e,"wallThicknessToolTipFeedback")}catch(e){}},i.prototype.getToolTipFeedbackText=function(e,t){var i=e.getArcExtent();if(t||null==i){var n=e.getStartPointToEndPointDistance(),o="<html>"+CoreTools.format(this.wallLengthToolTipFeedback,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getFormatWithUnit().format(n));return null!=this.wallAngleToolTipFeedback&&this.wallAngleToolTipFeedback.length>0&&(o+="<br>"+CoreTools.format(this.wallAngleToolTipFeedback,this.getWallAngleInDegrees$com_eteks_sweethome3d_model_Wall$float(e,n))),null!=this.wallThicknessToolTipFeedback&&this.wallThicknessToolTipFeedback.length>0&&(o+="<br>"+CoreTools.format(this.wallThicknessToolTipFeedback,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getFormatWithUnit().format(e.getThickness()))),o}return"<html>"+CoreTools.format(this.wallArcExtentToolTipFeedback,Math.round(180*i/Math.PI))},i.prototype.getWallAngleInDegrees$com_eteks_sweethome3d_model_Wall=function(e){return this.getWallAngleInDegrees$com_eteks_sweethome3d_model_Wall$float(e,e.getStartPointToEndPointDistance())},i.prototype.getWallAngleInDegrees$com_eteks_sweethome3d_model_Wall$float=function(e,t){var i=e.getWallAtStart();if(null!=i){var n=i.getStartPointToEndPointDistance();if(0!==t&&0!==n){var o=(e.getXEnd()-e.getXStart())/t,r=(e.getYEnd()-e.getYStart())/t,l=(i.getXEnd()-i.getXStart())/n,a=(i.getYEnd()-i.getYStart())/n;i.getWallAtStart()===e&&(l=-l,a=-a);var s=0|Math.round(180-180*Math.atan2(r*l-o*a,o*l+r*a)/Math.PI);return s>180&&(s-=360),s}}return 0===t?0:0|Math.round(function(e){return 180*e/Math.PI}(Math.atan2(e.getYStart()-e.getYEnd(),e.getXEnd()-e.getXStart())))},i.prototype.getWallAngleInDegrees=function(e,t){if(!(null!=e&&e instanceof Wall||null===e)||"number"!=typeof t&&null!==t){if((null!=e&&e instanceof Wall||null===e)&&void 0===t)return this.getWallAngleInDegrees$com_eteks_sweethome3d_model_Wall(e);throw new Error("invalid overload")}return this.getWallAngleInDegrees$com_eteks_sweethome3d_model_Wall$float(e,t)},i.prototype.getArcExtent=function(e,t,i,n,o,r){var l,a,s=this.getCircumscribedCircleCenter(e,t,i,n,o,r),h=java.awt.geom.Point2D.distance(e,t,i,n)/2,u=(l=s[0],Number.NEGATIVE_INFINITY===l||Number.POSITIVE_INFINITY===l||function(e){return Number.NEGATIVE_INFINITY===e||Number.POSITIVE_INFINITY===e}(s[1])?1/0:java.awt.geom.Line2D.ptLineDist(e,t,i,n,s[0],s[1])),d=java.awt.geom.Line2D.relativeCCW(e,t,i,n,o,r);return a=java.awt.geom.Line2D.relativeCCW(e,t,i,n,s[0],s[1])===d?Math.PI+2*Math.atan2(u,h):2*Math.atan2(h,u),a=Math.min(a,3*Math.PI/2),a*=d},i.prototype.getCircumscribedCircleCenter=function(t,i,n,o,r,l){var a=this.getBissectorLine(t,i,n,o),s=this.getBissectorLine(t,i,r,l);return e.computeIntersection(a[0],a[1],s[0],s[1])},i.prototype.getBissectorLine=function(e,t,i,n){var o=(e+i)/2,r=(t+n)/2,l=(e-i)/(n-t);return l>1e10?[[o,r],[o,r+1]]:[[o,r],[o+1,l+r]]},i.prototype.showWallAngleFeedback=function(e,t){var i=e.getArcExtent();if(t||null==i){if(null!=this.wallAngleToolTipFeedback&&this.wallAngleToolTipFeedback.length>0){var n=e.getWallAtStart();null!=n&&(n.getWallAtStart()===e?this.getWallAngleInDegrees$com_eteks_sweethome3d_model_Wall(e)>0?this.__parent.getView().setAngleFeedback(e.getXStart(),e.getYStart(),n.getXEnd(),n.getYEnd(),e.getXEnd(),e.getYEnd()):this.__parent.getView().setAngleFeedback(e.getXStart(),e.getYStart(),e.getXEnd(),e.getYEnd(),n.getXEnd(),n.getYEnd()):this.getWallAngleInDegrees$com_eteks_sweethome3d_model_Wall(e)>0?this.__parent.getView().setAngleFeedback(e.getXStart(),e.getYStart(),n.getXStart(),n.getYStart(),e.getXEnd(),e.getYEnd()):this.__parent.getView().setAngleFeedback(e.getXStart(),e.getYStart(),e.getXEnd(),e.getYEnd(),n.getXStart(),n.getYStart()))}}else i<0?this.__parent.getView().setAngleFeedback(e.getXArcCircleCenter(),e.getYArcCircleCenter(),e.getXStart(),e.getYStart(),e.getXEnd(),e.getYEnd()):this.__parent.getView().setAngleFeedback(e.getXArcCircleCenter(),e.getYArcCircleCenter(),e.getXEnd(),e.getYEnd(),e.getXStart(),e.getYStart())},i}(e.ControllerState);e.AbstractWallState=fe,fe.__class="com.eteks.sweethome3d.viewcontroller.PlanController.AbstractWallState";var ve=function(t){function i(e){var i=t.call(this)||this;return i.__parent=e,void 0===i.magnetismEnabled&&(i.magnetismEnabled=!1),void 0===i.alignmentActivated&&(i.alignmentActivated=!1),void 0===i.selectedPiece&&(i.selectedPiece=null),void 0===i.angleMousePress&&(i.angleMousePress=0),void 0===i.oldAngle&&(i.oldAngle=0),void 0===i.doorOrWindowBoundToWall&&(i.doorOrWindowBoundToWall=!1),void 0===i.rotationToolTipFeedback&&(i.rotationToolTipFeedback=null),i}return __extends(i,t),i.prototype.getMode=function(){return e.Mode.SELECTION_$LI$()},i.prototype.isModificationState=function(){return!0},i.prototype.isBasePlanModificationState=function(){return null!=this.selectedPiece&&this.__parent.isPieceOfFurniturePartOfBasePlan(this.selectedPiece)},i.prototype.enter=function(){this.rotationToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(e,"rotationToolTipFeedback"),this.selectedPiece=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0],this.angleMousePress=Math.atan2(this.selectedPiece.getY()-this.__parent.getYLastMousePress(),this.__parent.getXLastMousePress()-this.selectedPiece.getX()),this.oldAngle=this.selectedPiece.getAngle(),this.doorOrWindowBoundToWall=null!=this.selectedPiece&&this.selectedPiece instanceof HomeDoorOrWindow&&this.selectedPiece.isBoundToWall(),this.alignmentActivated=this.__parent.wasAlignmentActivatedLastMousePress(),this.magnetismEnabled=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled()!==this.__parent.wasMagnetismToggledLastMousePress();var t=this.__parent.getView();t.setResizeIndicatorVisible(!0),this.__parent.feedbackDisplayed&&t.setToolTipFeedback(this.getToolTipFeedbackText(this.oldAngle),this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress())},i.prototype.moveMouse=function(e,t){if(e!==this.selectedPiece.getX()||t!==this.selectedPiece.getY()){var n=Math.atan2(this.selectedPiece.getY()-t,e-this.selectedPiece.getX()),o=this.oldAngle-n+this.angleMousePress;if(this.alignmentActivated||this.magnetismEnabled){var r=2*Math.PI/i.STEP_COUNT;o=Math.round(o/r)*r}this.selectedPiece.setAngle(o);var l=this.__parent.getView();l.makePointVisible(e,t),this.__parent.feedbackDisplayed&&l.setToolTipFeedback(this.getToolTipFeedbackText(o),e,t)}},i.prototype.releaseMouse=function(e,t){this.__parent.postPieceOfFurnitureRotation(this.selectedPiece,this.oldAngle,this.doorOrWindowBoundToWall),this.__parent.setState(this.__parent.getSelectionState())},i.prototype.toggleMagnetism=function(e){this.magnetismEnabled=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled()!==e,this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())},i.prototype.setAlignmentActivated=function(e){this.alignmentActivated=e,this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())},i.prototype.escape=function(){this.selectedPiece.setAngle(this.oldAngle),null!=this.selectedPiece&&this.selectedPiece instanceof HomeDoorOrWindow&&this.selectedPiece.setBoundToWall(this.doorOrWindowBoundToWall),this.__parent.setState(this.__parent.getSelectionState())},i.prototype.exit=function(){var e=this.__parent.getView();e.setResizeIndicatorVisible(!1),e.deleteFeedback(),this.selectedPiece=null},i.prototype.getToolTipFeedbackText=function(e){return CoreTools.format(this.rotationToolTipFeedback,(Math.round(180*e/Math.PI)+360)%360)},i.STEP_COUNT=24,i}(e.ControllerState);e.PieceOfFurnitureRotationState=ve,ve.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PieceOfFurnitureRotationState";var _e=function(t){function i(e){var i=t.call(this)||this;return i.__parent=e,void 0===i.selectedPiece&&(i.selectedPiece=null),void 0===i.oldPitch&&(i.oldPitch=0),void 0===i.oldWidthInPlan&&(i.oldWidthInPlan=0),void 0===i.oldDepthInPlan&&(i.oldDepthInPlan=0),void 0===i.oldHeightInPlan&&(i.oldHeightInPlan=0),void 0===i.pitchRotationToolTipFeedback&&(i.pitchRotationToolTipFeedback=null),i}return __extends(i,t),i.prototype.getMode=function(){return e.Mode.SELECTION_$LI$()},i.prototype.isModificationState=function(){return!0},i.prototype.isBasePlanModificationState=function(){return null!=this.selectedPiece&&this.__parent.isPieceOfFurniturePartOfBasePlan(this.selectedPiece)},i.prototype.enter=function(){this.pitchRotationToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(e,"pitchRotationToolTipFeedback"),this.selectedPiece=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0],this.oldPitch=this.selectedPiece.getPitch(),this.oldWidthInPlan=this.selectedPiece.getWidthInPlan(),this.oldDepthInPlan=this.selectedPiece.getDepthInPlan(),this.oldHeightInPlan=this.selectedPiece.getHeightInPlan();var t=this.__parent.getView();t.setResizeIndicatorVisible(!0),this.__parent.feedbackDisplayed&&t.setToolTipFeedback(this.getToolTipFeedbackText(this.oldPitch),this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress())},i.prototype.moveMouse=function(e,t){var i=this.oldPitch-(t-this.__parent.getYLastMousePress())*Math.cos(this.selectedPiece.getAngle())*Math.PI/360+(e-this.__parent.getXLastMousePress())*Math.sin(this.selectedPiece.getAngle())*Math.PI/360;Math.abs(i)<1e-8&&(i=0),this.selectedPiece.setPitch(i),this.__parent.feedbackDisplayed&&this.__parent.getView().setToolTipFeedback(this.getToolTipFeedbackText(i),e,t)},i.prototype.releaseMouse=function(e,t){this.__parent.postPieceOfFurniturePitchRotation(this.selectedPiece,this.oldPitch,this.oldWidthInPlan,this.oldDepthInPlan,this.oldHeightInPlan),this.__parent.setState(this.__parent.getSelectionState())},i.prototype.escape=function(){this.selectedPiece.setPitch(this.oldPitch),this.__parent.setState(this.__parent.getSelectionState())},i.prototype.exit=function(){var e=this.__parent.getView();e.setResizeIndicatorVisible(!1),e.deleteFeedback(),this.selectedPiece=null},i.prototype.getToolTipFeedbackText=function(e){return CoreTools.format(this.pitchRotationToolTipFeedback,(Math.round(180*e/Math.PI)+360)%360)},i}(e.ControllerState);e.PieceOfFurniturePitchRotationState=_e,_e.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PieceOfFurniturePitchRotationState";var Se=function(t){function i(e){var i=t.call(this)||this;return i.__parent=e,void 0===i.selectedPiece&&(i.selectedPiece=null),void 0===i.oldRoll&&(i.oldRoll=0),void 0===i.oldWidthInPlan&&(i.oldWidthInPlan=0),void 0===i.oldDepthInPlan&&(i.oldDepthInPlan=0),void 0===i.oldHeightInPlan&&(i.oldHeightInPlan=0),void 0===i.rollRotationToolTipFeedback&&(i.rollRotationToolTipFeedback=null),i}return __extends(i,t),i.prototype.getMode=function(){return e.Mode.SELECTION_$LI$()},i.prototype.isModificationState=function(){return!0},i.prototype.isBasePlanModificationState=function(){return null!=this.selectedPiece&&this.__parent.isPieceOfFurniturePartOfBasePlan(this.selectedPiece)},i.prototype.enter=function(){this.rollRotationToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(e,"rollRotationToolTipFeedback"),this.selectedPiece=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0],this.oldRoll=this.selectedPiece.getRoll(),this.oldWidthInPlan=this.selectedPiece.getWidthInPlan(),this.oldDepthInPlan=this.selectedPiece.getDepthInPlan(),this.oldHeightInPlan=this.selectedPiece.getHeightInPlan();var t=this.__parent.getView();t.setResizeIndicatorVisible(!0),this.__parent.feedbackDisplayed&&t.setToolTipFeedback(this.getToolTipFeedbackText(this.oldRoll),this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress())},i.prototype.moveMouse=function(e,t){var i=this.oldRoll+(t-this.__parent.getYLastMousePress())*Math.sin(this.selectedPiece.getAngle())*Math.PI/360+(e-this.__parent.getXLastMousePress())*Math.cos(this.selectedPiece.getAngle())*Math.PI/360;Math.abs(i)<1e-8&&(i=0),this.selectedPiece.setRoll(i),this.__parent.feedbackDisplayed&&this.__parent.getView().setToolTipFeedback(this.getToolTipFeedbackText(i),e,t)},i.prototype.releaseMouse=function(e,t){this.__parent.postPieceOfFurnitureRollRotation(this.selectedPiece,this.oldRoll,this.oldWidthInPlan,this.oldDepthInPlan,this.oldHeightInPlan),this.__parent.setState(this.__parent.getSelectionState())},i.prototype.escape=function(){this.selectedPiece.setRoll(this.oldRoll),this.__parent.setState(this.__parent.getSelectionState())},i.prototype.exit=function(){var e=this.__parent.getView();e.setResizeIndicatorVisible(!1),e.deleteFeedback(),this.selectedPiece=null},i.prototype.getToolTipFeedbackText=function(e){return CoreTools.format(this.rollRotationToolTipFeedback,(Math.round(180*e/Math.PI)+360)%360)},i}(e.ControllerState);e.PieceOfFurnitureRollRotationState=Se,Se.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PieceOfFurnitureRollRotationState";var ye=function(t){function i(e){var i=t.call(this)||this;return i.__parent=e,void 0===i.magnetismEnabled&&(i.magnetismEnabled=!1),void 0===i.deltaYToElevationPoint&&(i.deltaYToElevationPoint=0),void 0===i.selectedPiece&&(i.selectedPiece=null),void 0===i.oldElevation&&(i.oldElevation=0),void 0===i.elevationToolTipFeedback&&(i.elevationToolTipFeedback=null),i}return __extends(i,t),i.prototype.getMode=function(){return e.Mode.SELECTION_$LI$()},i.prototype.isModificationState=function(){return!0},i.prototype.isBasePlanModificationState=function(){return null!=this.selectedPiece&&this.__parent.isPieceOfFurniturePartOfBasePlan(this.selectedPiece)},i.prototype.enter=function(){this.elevationToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(e,"elevationToolTipFeedback"),this.selectedPiece=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0];var t=this.selectedPiece.getPoints()[1];this.deltaYToElevationPoint=this.__parent.getYLastMousePress()-t[1],this.oldElevation=this.selectedPiece.getElevation(),this.magnetismEnabled=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled()!==this.__parent.wasMagnetismToggledLastMousePress();var i=this.__parent.getView();i.setResizeIndicatorVisible(!0),this.__parent.feedbackDisplayed&&i.setToolTipFeedback(this.getToolTipFeedbackText(this.oldElevation),this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress())},i.prototype.moveMouse=function(t,i){var n=this.__parent.getView(),o=this.selectedPiece.getPoints()[1],r=i-this.deltaYToElevationPoint-o[1],l=this.oldElevation-r;l=Math.min(Math.max(l,0),this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMaximumElevation()),this.magnetismEnabled&&(l=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMagnetizedLength(l,n.getPixelLength())),this.selectedPiece.setElevation(l),this.magnetismEnabled&&null!=this.selectedPiece&&this.__parent.adjustPieceOfFurnitureElevation(this.selectedPiece,!1,3*e.PIXEL_MARGIN/this.__parent.getScale()),this.__parent.feedbackDisplayed&&n.setToolTipFeedback(this.getToolTipFeedbackText(this.selectedPiece.getElevation()),t,i),n.makeSelectionVisible()},i.prototype.releaseMouse=function(e,t){this.__parent.postPieceOfFurnitureElevation(this.selectedPiece,this.oldElevation),this.__parent.setState(this.__parent.getSelectionState())},i.prototype.toggleMagnetism=function(e){this.magnetismEnabled=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled()!==e,this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())},i.prototype.escape=function(){this.selectedPiece.setElevation(this.oldElevation),this.__parent.setState(this.__parent.getSelectionState())},i.prototype.exit=function(){var e=this.__parent.getView();e.setResizeIndicatorVisible(!1),e.deleteFeedback(),this.selectedPiece=null},i.prototype.getToolTipFeedbackText=function(e){return CoreTools.format(this.elevationToolTipFeedback,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getFormatWithUnit().format(e))},i}(e.ControllerState);e.PieceOfFurnitureElevationState=ye,ye.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PieceOfFurnitureElevationState";var Ee=function(t){function i(e){var i=t.call(this)||this;return i.__parent=e,void 0===i.magnetismEnabled&&(i.magnetismEnabled=!1),void 0===i.deltaYToResizePoint&&(i.deltaYToResizePoint=0),void 0===i.resizedPiece&&(i.resizedPiece=null),void 0===i.topLeftPoint&&(i.topLeftPoint=null),void 0===i.resizePoint&&(i.resizePoint=null),void 0===i.resizeToolTipFeedback&&(i.resizeToolTipFeedback=null),i}return __extends(i,t),i.prototype.getMode=function(){return e.Mode.SELECTION_$LI$()},i.prototype.isModificationState=function(){return!0},i.prototype.isBasePlanModificationState=function(){return null!=this.resizedPiece&&this.__parent.isPieceOfFurniturePartOfBasePlan(this.resizedPiece.getPieceOfFurniture())},i.prototype.enter=function(){this.resizeToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(e,"heightResizeToolTipFeedback");var t=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0];this.resizedPiece=new e.ResizedPieceOfFurniture(t);var i=t.getPoints();this.resizePoint=i[3],this.deltaYToResizePoint=this.__parent.getYLastMousePress()-this.resizePoint[1],this.topLeftPoint=i[0],this.magnetismEnabled=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled()!==this.__parent.wasMagnetismToggledLastMousePress();var n=this.__parent.getView();n.setResizeIndicatorVisible(!0),this.__parent.feedbackDisplayed&&n.setToolTipFeedback(this.getToolTipFeedbackText(t.getHeight()),this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress())},i.prototype.moveMouse=function(e,t){var i=this.__parent.getView(),n=this.resizedPiece.getPieceOfFurniture(),o=t-this.deltaYToResizePoint-this.resizePoint[1],r=this.resizedPiece.getHeight()-o;if(r=Math.max(r,0),this.magnetismEnabled&&(r=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMagnetizedLength(r,i.getPixelLength())),r=Math.min(Math.max(r,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMinimumLength()),this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMaximumLength()),n.isDeformable()&&!n.isHorizontallyRotated()&&null==n.getModelTransformations())this.__parent.setPieceOfFurnitureSize(this.resizedPiece,this.resizedPiece.getWidth(),this.resizedPiece.getDepth(),r);else{var l=r/this.resizedPiece.getHeight(),a=this.resizedPiece.getWidth()*l,s=this.resizedPiece.getDepth()*l,h=n.getAngle(),u=Math.cos(h),d=Math.sin(h),c=this.topLeftPoint[0]+(a*u-s*d)/2,p=this.topLeftPoint[1]+(a*d+s*u)/2;n.setX(c),n.setY(p),this.__parent.setPieceOfFurnitureSize(this.resizedPiece,a,s,r)}i.makePointVisible(e,t),this.__parent.feedbackDisplayed&&i.setToolTipFeedback(this.getToolTipFeedbackText(r),e,t)},i.prototype.releaseMouse=function(e,t){this.__parent.postPieceOfFurnitureHeightResize(this.resizedPiece),this.__parent.setState(this.__parent.getSelectionState())},i.prototype.toggleMagnetism=function(e){this.magnetismEnabled=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled()!==e,this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())},i.prototype.escape=function(){this.__parent.resetPieceOfFurnitureSize(this.resizedPiece),this.__parent.setState(this.__parent.getSelectionState())},i.prototype.exit=function(){var e=this.__parent.getView();e.setResizeIndicatorVisible(!1),e.deleteFeedback(),this.resizedPiece=null},i.prototype.getToolTipFeedbackText=function(e){return CoreTools.format(this.resizeToolTipFeedback,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getFormatWithUnit().format(e))},i}(e.ControllerState);e.PieceOfFurnitureHeightState=Ee,Ee.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PieceOfFurnitureHeightState";var Ce=function(t){function i(e){var i=t.call(this)||this;return i.__parent=e,void 0===i.magnetismEnabled&&(i.magnetismEnabled=!1),void 0===i.alignmentActivated&&(i.alignmentActivated=!1),void 0===i.widthOrDepthResizingActivated&&(i.widthOrDepthResizingActivated=!1),void 0===i.deltaXToResizePoint&&(i.deltaXToResizePoint=0),void 0===i.deltaYToResizePoint&&(i.deltaYToResizePoint=0),void 0===i.resizedPiece&&(i.resizedPiece=null),void 0===i.resizedPieceWidthInPlan&&(i.resizedPieceWidthInPlan=0),void 0===i.resizePoint&&(i.resizePoint=null),void 0===i.topLeftPoint&&(i.topLeftPoint=null),void 0===i.widthResizeToolTipFeedback&&(i.widthResizeToolTipFeedback=null),void 0===i.depthResizeToolTipFeedback&&(i.depthResizeToolTipFeedback=null),void 0===i.heightResizeToolTipFeedback&&(i.heightResizeToolTipFeedback=null),i}return __extends(i,t),i.prototype.getMode=function(){return e.Mode.SELECTION_$LI$()},i.prototype.isModificationState=function(){return!0},i.prototype.isBasePlanModificationState=function(){return null!=this.resizedPiece&&this.__parent.isPieceOfFurniturePartOfBasePlan(this.resizedPiece.getPieceOfFurniture())},i.prototype.enter=function(){this.widthResizeToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(e,"widthResizeToolTipFeedback"),this.depthResizeToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(e,"depthResizeToolTipFeedback"),this.heightResizeToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(e,"heightResizeToolTipFeedback");var t=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0];this.resizedPiece=new e.ResizedPieceOfFurniture(t),this.resizedPieceWidthInPlan=t.getWidthInPlan();var i=t.getPoints();this.resizePoint=i[2],this.deltaXToResizePoint=this.__parent.getXLastMousePress()-this.resizePoint[0],this.deltaYToResizePoint=this.__parent.getYLastMousePress()-this.resizePoint[1],this.topLeftPoint=i[0],this.magnetismEnabled=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled()!==this.__parent.wasMagnetismToggledLastMousePress(),this.alignmentActivated=this.__parent.wasAlignmentActivatedLastMousePress(),this.widthOrDepthResizingActivated=this.__parent.wasDuplicationActivatedLastMousePress();var n=this.__parent.getView();n.setResizeIndicatorVisible(!0),this.__parent.feedbackDisplayed&&n.setToolTipFeedback(this.getToolTipFeedbackText(t.getWidth(),t.getDepth(),t.getHeight()),this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress())},i.prototype.moveMouse=function(e,t){var i=this.__parent.getView(),n=this.resizedPiece.getPieceOfFurniture(),o=n.getAngle(),r=Math.cos(o),l=Math.sin(o),a=e-this.deltaXToResizePoint-this.topLeftPoint[0],s=t-this.deltaYToResizePoint-this.topLeftPoint[1],h=s*l+a*r;this.magnetismEnabled&&(h=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMagnetizedLength(h,i.getPixelLength())),h=Math.min(Math.max(h,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMinimumLength()),this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMaximumLength());var u,d=this.resizedPiece.getDepth(),c=this.resizedPiece.getHeight(),p=this.resizedPiece.isDoorOrWindowBoundToWall();if(this.isProprortionallyResized(n)){var g=h/this.resizedPieceWidthInPlan;h=this.resizedPiece.getWidth()*g,d=this.resizedPiece.getDepth()*g,c=this.resizedPiece.getHeight()*g,p=d===this.resizedPiece.getDepth()}else n.isWidthDepthDeformable()?this.resizedPiece.isDoorOrWindowBoundToWall()&&this.magnetismEnabled&&!this.widthOrDepthResizingActivated||(d=s*r-a*l,this.magnetismEnabled&&(d=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMagnetizedLength(d,i.getPixelLength())),p=(d=Math.min(Math.max(d,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMinimumLength()),this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMaximumLength()))===this.resizedPiece.getDepth(),this.widthOrDepthResizingActivated&&(((u=java.awt.geom.Line2D.relativeCCW(this.topLeftPoint[0],this.topLeftPoint[1],this.resizePoint[0],this.resizePoint[1],e-this.deltaXToResizePoint,t-this.deltaYToResizePoint))>0?1:u<0?-1:0)>=0?d=this.resizedPiece.getDepth():h=this.resizedPiece.getWidth())):d=this.resizedPiece.getDepth()*h/this.resizedPiece.getWidth();this.__parent.setPieceOfFurnitureSize(this.resizedPiece,h,d,c),this.resizedPiece.isDoorOrWindowBoundToWall()&&n.setBoundToWall(this.magnetismEnabled&&p);var m=this.topLeftPoint[0]+(n.getWidthInPlan()*r-n.getDepthInPlan()*l)/2,f=this.topLeftPoint[1]+(n.getWidthInPlan()*l+n.getDepthInPlan()*r)/2;n.setX(m),n.setY(f),i.makePointVisible(e,t),this.__parent.feedbackDisplayed&&i.setToolTipFeedback(this.getToolTipFeedbackText(h,d,c),e,t)},i.prototype.isProprortionallyResized=function(e){return!e.isDeformable()||e.isHorizontallyRotated()||null!=e.getModelTransformations()||this.alignmentActivated},i.prototype.releaseMouse=function(e,t){this.__parent.postPieceOfFurnitureWidthAndDepthResize(this.resizedPiece),this.__parent.setState(this.__parent.getSelectionState())},i.prototype.toggleMagnetism=function(e){this.magnetismEnabled=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled()!==e,this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())},i.prototype.setAlignmentActivated=function(e){this.alignmentActivated=e,this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())},i.prototype.setDuplicationActivated=function(e){this.widthOrDepthResizingActivated=e,this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())},i.prototype.escape=function(){this.__parent.resetPieceOfFurnitureSize(this.resizedPiece),this.__parent.setState(this.__parent.getSelectionState())},i.prototype.exit=function(){var e=this.__parent.getView();e.setResizeIndicatorVisible(!1),e.deleteFeedback(),this.resizedPiece=null},i.prototype.getToolTipFeedbackText=function(e,t,i){var n="<html>"+CoreTools.format(this.widthResizeToolTipFeedback,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getFormatWithUnit().format(e));return null!=this.resizedPiece.getPieceOfFurniture()&&this.resizedPiece.getPieceOfFurniture()instanceof HomeDoorOrWindow&&this.resizedPiece.getPieceOfFurniture().isBoundToWall()&&!this.isProprortionallyResized(this.resizedPiece.getPieceOfFurniture())||(n+="<br>"+CoreTools.format(this.depthResizeToolTipFeedback,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getFormatWithUnit().format(t))),this.isProprortionallyResized(this.resizedPiece.getPieceOfFurniture())&&(n+="<br>"+CoreTools.format(this.heightResizeToolTipFeedback,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getFormatWithUnit().format(i))),n},i}(e.ControllerState);e.PieceOfFurnitureResizeState=Ce,Ce.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PieceOfFurnitureResizeState";var Pe=function(t){function i(e){var i=t.call(this)||this;return i.__parent=e,void 0===i.deltaXToModificationPoint&&(i.deltaXToModificationPoint=0),void 0===i.selectedLight&&(i.selectedLight=null),void 0===i.oldPower&&(i.oldPower=0),void 0===i.lightPowerToolTipFeedback&&(i.lightPowerToolTipFeedback=null),i}return __extends(i,t),i.prototype.getMode=function(){return e.Mode.SELECTION_$LI$()},i.prototype.isModificationState=function(){return!0},i.prototype.enter=function(){this.lightPowerToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(e,"lightPowerToolTipFeedback"),this.selectedLight=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0];var t=this.selectedLight.getPoints()[3];this.deltaXToModificationPoint=this.__parent.getXLastMousePress()-t[0],this.oldPower=this.selectedLight.getPower();var i=this.__parent.getView();i.setResizeIndicatorVisible(!0),this.__parent.feedbackDisplayed&&i.setToolTipFeedback(this.getToolTipFeedbackText(this.oldPower),this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress())},i.prototype.moveMouse=function(e,t){var i=this.__parent.getView(),n=this.selectedLight.getPoints()[3],o=e-this.deltaXToModificationPoint-n[0],r=this.oldPower+o/100*this.__parent.getScale();r=Math.min(Math.max(r,0),1),this.selectedLight.setPower(r),i.makePointVisible(e,t),this.__parent.feedbackDisplayed&&i.setToolTipFeedback(this.getToolTipFeedbackText(r),e,t)},i.prototype.releaseMouse=function(e,t){this.__parent.postLightPowerModification(this.selectedLight,this.oldPower),this.__parent.setState(this.__parent.getSelectionState())},i.prototype.escape=function(){this.selectedLight.setPower(this.oldPower),this.__parent.setState(this.__parent.getSelectionState())},i.prototype.exit=function(){var e=this.__parent.getView();e.setResizeIndicatorVisible(!1),e.deleteFeedback(),this.selectedLight=null},i.prototype.getToolTipFeedbackText=function(e){return CoreTools.format(this.lightPowerToolTipFeedback,Math.round(100*e))},i}(e.ControllerState);e.LightPowerModificationState=Pe,Pe.__class="com.eteks.sweethome3d.viewcontroller.PlanController.LightPowerModificationState";var we=function(t){function i(e){var i=t.call(this)||this;return i.__parent=e,void 0===i.selectedPiece&&(i.selectedPiece=null),void 0===i.oldNameXOffset&&(i.oldNameXOffset=0),void 0===i.oldNameYOffset&&(i.oldNameYOffset=0),void 0===i.xLastMouseMove&&(i.xLastMouseMove=0),void 0===i.yLastMouseMove&&(i.yLastMouseMove=0),void 0===i.alignmentActivated&&(i.alignmentActivated=!1),i}return __extends(i,t),i.prototype.getMode=function(){return e.Mode.SELECTION_$LI$()},i.prototype.isModificationState=function(){return!0},i.prototype.enter=function(){this.selectedPiece=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0],this.oldNameXOffset=this.selectedPiece.getNameXOffset(),this.oldNameYOffset=this.selectedPiece.getNameYOffset(),this.xLastMouseMove=this.__parent.getXLastMousePress(),this.yLastMouseMove=this.__parent.getYLastMousePress(),this.alignmentActivated=this.__parent.wasAlignmentActivatedLastMousePress(),this.__parent.getView().setResizeIndicatorVisible(!0)},i.prototype.moveMouse=function(t,i){if(this.alignmentActivated){var n=new e.PointWithAngleMagnetism(this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress(),t,i,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit(),this.__parent.getView().getPixelLength(),4);t=n.getX(),i=n.getY()}this.selectedPiece.setNameXOffset(this.selectedPiece.getNameXOffset()+t-this.xLastMouseMove),this.selectedPiece.setNameYOffset(this.selectedPiece.getNameYOffset()+i-this.yLastMouseMove),this.xLastMouseMove=t,this.yLastMouseMove=i,this.__parent.getView().makePointVisible(t,i)},i.prototype.releaseMouse=function(e,t){this.__parent.postPieceOfFurnitureNameOffset(this.selectedPiece,this.oldNameXOffset,this.oldNameYOffset),this.__parent.setState(this.__parent.getSelectionState())},i.prototype.escape=function(){this.selectedPiece.setNameXOffset(this.oldNameXOffset),this.selectedPiece.setNameYOffset(this.oldNameYOffset),this.__parent.setState(this.__parent.getSelectionState())},i.prototype.setAlignmentActivated=function(e){this.alignmentActivated=e,this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())},i.prototype.exit=function(){this.__parent.getView().setResizeIndicatorVisible(!1),this.selectedPiece=null},i}(e.ControllerState);e.PieceOfFurnitureNameOffsetState=we,we.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PieceOfFurnitureNameOffsetState";var Le=function(t){function i(e){var i=t.call(this)||this;return i.__parent=e,void 0===i.selectedPiece&&(i.selectedPiece=null),void 0===i.oldNameAngle&&(i.oldNameAngle=0),void 0===i.angleMousePress&&(i.angleMousePress=0),void 0===i.magnetismEnabled&&(i.magnetismEnabled=!1),void 0===i.alignmentActivated&&(i.alignmentActivated=!1),i}return __extends(i,t),i.prototype.getMode=function(){return e.Mode.SELECTION_$LI$()},i.prototype.isModificationState=function(){return!0},i.prototype.enter=function(){this.selectedPiece=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0],this.angleMousePress=Math.atan2(this.selectedPiece.getY()+this.selectedPiece.getNameYOffset()-this.__parent.getYLastMousePress(),this.__parent.getXLastMousePress()-this.selectedPiece.getX()-this.selectedPiece.getNameXOffset()),this.oldNameAngle=this.selectedPiece.getNameAngle(),this.alignmentActivated=this.__parent.wasAlignmentActivatedLastMousePress(),this.magnetismEnabled=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled()!==this.__parent.wasMagnetismToggledLastMousePress(),this.__parent.getView().setResizeIndicatorVisible(!0)},i.prototype.moveMouse=function(e,t){if(e!==this.selectedPiece.getX()+this.selectedPiece.getNameXOffset()||t!==this.selectedPiece.getY()+this.selectedPiece.getNameYOffset()){var n=Math.atan2(this.selectedPiece.getY()+this.selectedPiece.getNameYOffset()-t,e-this.selectedPiece.getX()-this.selectedPiece.getNameXOffset()),o=this.oldNameAngle-n+this.angleMousePress;if(this.alignmentActivated||this.magnetismEnabled){var r=2*Math.PI/i.STEP_COUNT;o=Math.round(o/r)*r}this.selectedPiece.setNameAngle(o),this.__parent.getView().makePointVisible(e,t)}},i.prototype.releaseMouse=function(e,t){this.__parent.postPieceOfFurnitureNameRotation(this.selectedPiece,this.oldNameAngle),this.__parent.setState(this.__parent.getSelectionState())},i.prototype.toggleMagnetism=function(e){this.magnetismEnabled=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled()!==e,this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())},i.prototype.setAlignmentActivated=function(e){this.alignmentActivated=e,this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())},i.prototype.escape=function(){this.selectedPiece.setNameAngle(this.oldNameAngle),this.__parent.setState(this.__parent.getSelectionState())},i.prototype.exit=function(){this.__parent.getView().setResizeIndicatorVisible(!1),this.selectedPiece=null},i.STEP_COUNT=24,i}(e.ControllerState);e.PieceOfFurnitureNameRotationState=Le,Le.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PieceOfFurnitureNameRotationState";var Te=function(t){function i(e){var i=t.call(this)||this;return i.__parent=e,void 0===i.selectedCamera&&(i.selectedCamera=null),void 0===i.oldYaw&&(i.oldYaw=0),void 0===i.xLastMouseMove&&(i.xLastMouseMove=0),void 0===i.yLastMouseMove&&(i.yLastMouseMove=0),void 0===i.angleLastMouseMove&&(i.angleLastMouseMove=0),void 0===i.rotationToolTipFeedback&&(i.rotationToolTipFeedback=null),i}return __extends(i,t),i.prototype.getMode=function(){return e.Mode.SELECTION_$LI$()},i.prototype.isModificationState=function(){return!0},i.prototype.enter=function(){this.rotationToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(e,"cameraYawRotationToolTipFeedback"),this.selectedCamera=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0],this.oldYaw=this.selectedCamera.getYaw(),this.xLastMouseMove=this.__parent.getXLastMousePress(),this.yLastMouseMove=this.__parent.getYLastMousePress(),this.angleLastMouseMove=Math.atan2(this.selectedCamera.getY()-this.yLastMouseMove,this.xLastMouseMove-this.selectedCamera.getX());var t=this.__parent.getView();t.setResizeIndicatorVisible(!0),this.__parent.feedbackDisplayed&&t.setToolTipFeedback(this.getToolTipFeedbackText(this.oldYaw),this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress())},i.prototype.moveMouse=function(e,t){if(e!==this.selectedCamera.getX()||t!==this.selectedCamera.getY()){var i=Math.atan2(this.selectedCamera.getY()-t,e-this.selectedCamera.getX()),n=this.angleLastMouseMove-i,o=(l=(t-this.selectedCamera.getY())*(this.xLastMouseMove-this.selectedCamera.getX())-(this.yLastMouseMove-this.selectedCamera.getY())*(e-this.selectedCamera.getX()))>0?1:l<0?-1:0;o<0&&n>0?n-=2*Math.PI:o>0&&n<0&&(n+=2*Math.PI);var r=this.selectedCamera.getYaw()+n;this.selectedCamera.setYaw(r),this.__parent.feedbackDisplayed&&this.__parent.getView().setToolTipFeedback(this.getToolTipFeedbackText(r),e,t),this.xLastMouseMove=e,this.yLastMouseMove=t,this.angleLastMouseMove=i}var l},i.prototype.releaseMouse=function(e,t){this.__parent.setState(this.__parent.getSelectionState())},i.prototype.escape=function(){this.selectedCamera.setYaw(this.oldYaw),this.__parent.setState(this.__parent.getSelectionState())},i.prototype.exit=function(){var e=this.__parent.getView();e.setResizeIndicatorVisible(!1),e.deleteFeedback(),this.selectedCamera=null},i.prototype.getToolTipFeedbackText=function(e){return CoreTools.format(this.rotationToolTipFeedback,(Math.round(180*e/Math.PI)+360)%360)},i}(e.ControllerState);e.CameraYawRotationState=Te,Te.__class="com.eteks.sweethome3d.viewcontroller.PlanController.CameraYawRotationState";var Ae=function(t){function i(e){var i=t.call(this)||this;return i.__parent=e,void 0===i.selectedCamera&&(i.selectedCamera=null),void 0===i.oldPitch&&(i.oldPitch=0),void 0===i.rotationToolTipFeedback&&(i.rotationToolTipFeedback=null),i}return __extends(i,t),i.prototype.getMode=function(){return e.Mode.SELECTION_$LI$()},i.prototype.isModificationState=function(){return!0},i.prototype.enter=function(){this.rotationToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(e,"cameraPitchRotationToolTipFeedback"),this.selectedCamera=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0],this.oldPitch=this.selectedCamera.getPitch();var t=this.__parent.getView();t.setResizeIndicatorVisible(!0),this.__parent.feedbackDisplayed&&t.setToolTipFeedback(this.getToolTipFeedbackText(this.oldPitch),this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress())},i.prototype.moveMouse=function(e,t){var i=this.oldPitch+(t-this.__parent.getYLastMousePress())*Math.cos(this.selectedCamera.getYaw())*Math.PI/360-(e-this.__parent.getXLastMousePress())*Math.sin(this.selectedCamera.getYaw())*Math.PI/360;i=Math.max(i,-Math.PI/2),i=Math.min(i,Math.PI/2),this.selectedCamera.setPitch(i),this.__parent.feedbackDisplayed&&this.__parent.getView().setToolTipFeedback(this.getToolTipFeedbackText(i),e,t)},i.prototype.releaseMouse=function(e,t){this.__parent.setState(this.__parent.getSelectionState())},i.prototype.escape=function(){this.selectedCamera.setPitch(this.oldPitch),this.__parent.setState(this.__parent.getSelectionState())},i.prototype.exit=function(){var e=this.__parent.getView();e.setResizeIndicatorVisible(!1),e.deleteFeedback(),this.selectedCamera=null},i.prototype.getToolTipFeedbackText=function(e){return CoreTools.format(this.rotationToolTipFeedback,Math.round(180*e/Math.PI)%360)},i}(e.ControllerState);e.CameraPitchRotationState=Ae,Ae.__class="com.eteks.sweethome3d.viewcontroller.PlanController.CameraPitchRotationState";var Ie=function(t){function i(e){var i=t.call(this)||this;return i.__parent=e,void 0===i.selectedCamera&&(i.selectedCamera=null),void 0===i.oldElevation&&(i.oldElevation=0),void 0===i.cameraElevationToolTipFeedback&&(i.cameraElevationToolTipFeedback=null),void 0===i.observerHeightToolTipFeedback&&(i.observerHeightToolTipFeedback=null),i}return __extends(i,t),i.prototype.getMode=function(){return e.Mode.SELECTION_$LI$()},i.prototype.isModificationState=function(){return!0},i.prototype.enter=function(){this.cameraElevationToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(e,"cameraElevationToolTipFeedback"),this.observerHeightToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(e,"observerHeightToolTipFeedback"),this.selectedCamera=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0],this.oldElevation=this.selectedCamera.getZ();var t=this.__parent.getView();t.setResizeIndicatorVisible(!0),this.__parent.feedbackDisplayed&&t.setToolTipFeedback(this.getToolTipFeedbackText(this.oldElevation),this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress())},i.prototype.moveMouse=function(e,t){var i=this.oldElevation-(t-this.__parent.getYLastMousePress()),n=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getLevels(),o=0===n.length?10:10+n[0].getElevation();i=Math.min(Math.max(i,o),this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMaximumElevation()),this.selectedCamera.setZ(i),this.__parent.feedbackDisplayed&&this.__parent.getView().setToolTipFeedback(this.getToolTipFeedbackText(i),e,t)},i.prototype.releaseMouse=function(e,t){this.__parent.setState(this.__parent.getSelectionState())},i.prototype.escape=function(){this.selectedCamera.setZ(this.oldElevation),this.__parent.setState(this.__parent.getSelectionState())},i.prototype.exit=function(){var e=this.__parent.getView();e.setResizeIndicatorVisible(!1),e.deleteFeedback(),this.selectedCamera=null},i.prototype.getToolTipFeedbackText=function(e){var t="<html>"+CoreTools.format(this.cameraElevationToolTipFeedback,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getFormatWithUnit().format(e));return!this.selectedCamera.isFixedSize()&&e>=70&&e<=218.75&&(t+="<br>"+CoreTools.format(this.observerHeightToolTipFeedback,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getFormatWithUnit().format(15*e/14))),t},i}(e.ControllerState);e.CameraElevationState=Ie,Ie.__class="com.eteks.sweethome3d.viewcontroller.PlanController.CameraElevationState";var be=function(t){function i(e){var i=t.call(this)||this;return i.__parent=e,void 0===i.xStart&&(i.xStart=0),void 0===i.yStart&&(i.yStart=0),void 0===i.editingStartPoint&&(i.editingStartPoint=!1),void 0===i.newDimensionLine&&(i.newDimensionLine=null),void 0===i.oldSelection&&(i.oldSelection=null),void 0===i.oldBasePlanLocked&&(i.oldBasePlanLocked=!1),void 0===i.oldAllLevelsSelection&&(i.oldAllLevelsSelection=!1),void 0===i.magnetismEnabled&&(i.magnetismEnabled=!1),void 0===i.alignmentActivated&&(i.alignmentActivated=!1),void 0===i.offsetChoice&&(i.offsetChoice=!1),i}return __extends(i,t),i.prototype.getMode=function(){return e.Mode.DIMENSION_LINE_CREATION_$LI$()},i.prototype.isModificationState=function(){return!0},i.prototype.isBasePlanModificationState=function(){return!0},i.prototype.setMode=function(t){this.escape(),t===e.Mode.SELECTION_$LI$()?this.__parent.setState(this.__parent.getSelectionState()):t===e.Mode.PANNING_$LI$()?this.__parent.setState(this.__parent.getPanningState()):t===e.Mode.WALL_CREATION_$LI$()?this.__parent.setState(this.__parent.getWallCreationState()):t===e.Mode.ROOM_CREATION_$LI$()?this.__parent.setState(this.__parent.getRoomCreationState()):t===e.Mode.POLYLINE_CREATION_$LI$()?this.__parent.setState(this.__parent.getPolylineCreationState()):t===e.Mode.LABEL_CREATION_$LI$()&&this.__parent.setState(this.__parent.getLabelCreationState())},i.prototype.enter=function(){this.oldSelection=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems(),this.oldBasePlanLocked=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked(),this.oldAllLevelsSelection=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection(),this.xStart=this.__parent.getXLastMouseMove(),this.yStart=this.__parent.getYLastMouseMove(),this.editingStartPoint=!1,this.offsetChoice=!1,this.newDimensionLine=null,this.__parent.deselectAll(),this.alignmentActivated=this.__parent.wasAlignmentActivatedLastMousePress(),this.toggleMagnetism(this.__parent.wasMagnetismToggledLastMousePress());var e=this.__parent.getMeasuringDimensionLineAt(this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress(),this.magnetismEnabled);this.__parent.feedbackDisplayed&&(null!=e&&this.__parent.getView().setDimensionLinesFeedback([e].slice(0)),this.__parent.getView().setAlignmentFeedback(DimensionLine,null,this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress(),!1))},i.prototype.moveMouse=function(t,i){var n,o=this.__parent.getView();if(o.deleteFeedback(),this.offsetChoice){var r=java.awt.geom.Line2D.ptLineDist(this.newDimensionLine.getXStart(),this.newDimensionLine.getYStart(),this.newDimensionLine.getXEnd(),this.newDimensionLine.getYEnd(),t,i);if(this.newDimensionLine.getLength()>0){var l=java.awt.geom.Line2D.relativeCCW(this.newDimensionLine.getXStart(),this.newDimensionLine.getYStart(),this.newDimensionLine.getXEnd(),this.newDimensionLine.getYEnd(),t,i);this.newDimensionLine.setOffset(-((n=l)>0?1:n<0?-1:0)*r)}}else{var a=void 0,s=void 0;if(this.magnetismEnabled||this.alignmentActivated){var h=new e.PointWithAngleMagnetism(this.xStart,this.yStart,t,i,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit(),o.getPixelLength());a=h.getX(),s=h.getY()}else a=t,s=i;null==this.newDimensionLine?(this.newDimensionLine=this.__parent.createDimensionLine(this.xStart,this.yStart,a,s,0),this.__parent.getView().setDimensionLinesFeedback(null)):this.editingStartPoint?(this.newDimensionLine.setXStart(a),this.newDimensionLine.setYStart(s)):(this.newDimensionLine.setXEnd(a),this.newDimensionLine.setYEnd(s)),this.updateReversedDimensionLine(),this.__parent.feedbackDisplayed&&o.setAlignmentFeedback(DimensionLine,this.newDimensionLine,a,s,!1)}o.makePointVisible(t,i)},i.prototype.updateReversedDimensionLine=function(){var t=this.getDimensionLineAngle();(t<-Math.PI/2||t>Math.PI/2)!==this.editingStartPoint&&(e.reverseDimensionLine(this.newDimensionLine),this.editingStartPoint=!this.editingStartPoint)},i.prototype.getDimensionLineAngle=function(){return 0===this.newDimensionLine.getLength()?0:this.editingStartPoint?Math.atan2(this.yStart-this.newDimensionLine.getYStart(),this.newDimensionLine.getXStart()-this.xStart):Math.atan2(this.yStart-this.newDimensionLine.getYEnd(),this.newDimensionLine.getXEnd()-this.xStart)},i.prototype.pressMouse=function(e,t,i,n,o){if(null==this.newDimensionLine&&2===i){var r=this.__parent.getMeasuringDimensionLineAt(e,t,this.magnetismEnabled);if(null==r)return void this.__parent.setState(this.__parent.getDimensionLineCreationState());this.newDimensionLine=this.__parent.createDimensionLine(r.getXStart(),r.getYStart(),r.getXEnd(),r.getYEnd(),r.getOffset()),this.__parent.getPointerTypeLastMousePress()===View.PointerType.TOUCH&&this.validateDrawnDimensionLine()}if(null!=this.newDimensionLine)if(this.offsetChoice)this.validateDrawnDimensionLine();else{this.offsetChoice=!0;var l=this.__parent.getView();l.setCursor(PlanView.CursorType.HEIGHT),l.deleteFeedback()}},i.prototype.releaseMouse=function(e,t){this.__parent.getPointerTypeLastMousePress()===View.PointerType.TOUCH&&null!=this.newDimensionLine&&this.validateDrawnDimensionLine()},i.prototype.validateDrawnDimensionLine=function(){this.__parent.selectItem(this.newDimensionLine),this.__parent.postCreateDimensionLines([this.newDimensionLine].slice(0),this.oldSelection,this.oldBasePlanLocked,this.oldAllLevelsSelection),this.newDimensionLine=null,this.__parent.getPointerTypeLastMousePress()===View.PointerType.TOUCH?this.__parent.setState(this.__parent.getSelectionState()):this.__parent.setState(this.__parent.getDimensionLineCreationState())},i.prototype.setEditionActivated=function(e){var t,i=this.__parent.getView();if(e)i.deleteFeedback(),null==this.newDimensionLine?i.setToolTipEditedProperties(["X","Y"],[this.xStart,this.yStart],this.xStart,this.yStart):this.offsetChoice?i.setToolTipEditedProperties(["OFFSET"],[this.newDimensionLine.getOffset()],this.newDimensionLine.getXEnd(),this.newDimensionLine.getYEnd()):i.setToolTipEditedProperties(["LENGTH","ANGLE"],[this.newDimensionLine.getLength(),0|Math.round((t=this.getDimensionLineAngle(),180*t/Math.PI))],this.newDimensionLine.getXEnd(),this.newDimensionLine.getYEnd()),this.showDimensionLineFeedback();else if(null==this.newDimensionLine){var n=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().isMetric()?100:LengthUnit.footToCentimeter(3);this.newDimensionLine=this.__parent.createDimensionLine(this.xStart,this.yStart,this.xStart+n,this.yStart,0),i.deleteFeedback(),this.setEditionActivated(!0)}else this.offsetChoice?this.validateDrawnDimensionLine():(this.offsetChoice=!0,this.setEditionActivated(!0))},i.prototype.updateEditableProperty=function(e,t){var i=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMaximumLength();if(null==this.newDimensionLine)switch(e){case"X":this.xStart=null!=t?t:0,this.xStart=Math.max(-i,Math.min(this.xStart,i));break;case"Y":this.yStart=null!=t?t:0,this.yStart=Math.max(-i,Math.min(this.yStart,i))}else if(this.offsetChoice){if("OFFSET"===e){var n=null!=t?t:0;n=Math.max(-i,Math.min(n,i)),this.newDimensionLine.setOffset(n)}}else{var o=void 0,r=void 0;switch(e){case"LENGTH":var l=null!=t?t:0;l=Math.max(.001,Math.min(l,i));var a=this.getDimensionLineAngle();o=this.xStart+l*Math.cos(a),r=this.yStart-l*Math.sin(a);break;case"ANGLE":a=(null!=t?t:0)*Math.PI/180;var s=this.newDimensionLine.getLength();o=this.xStart+s*Math.cos(a),r=this.yStart-s*Math.sin(a);break;default:return}this.editingStartPoint?(this.newDimensionLine.setXStart(o),this.newDimensionLine.setYStart(r)):(this.newDimensionLine.setXEnd(o),this.newDimensionLine.setYEnd(r))}this.showDimensionLineFeedback()},i.prototype.showDimensionLineFeedback=function(){var e=this.__parent.getView();if(null==this.newDimensionLine)this.__parent.feedbackDisplayed&&e.setAlignmentFeedback(DimensionLine,null,this.xStart,this.yStart,!0),e.makePointVisible(this.xStart,this.yStart);else if(!this.offsetChoice){var t=void 0,i=void 0;this.editingStartPoint?(t=this.newDimensionLine.getXStart(),i=this.newDimensionLine.getYStart()):(t=this.newDimensionLine.getXEnd(),i=this.newDimensionLine.getYEnd()),this.updateReversedDimensionLine(),this.__parent.feedbackDisplayed&&e.setAlignmentFeedback(DimensionLine,this.newDimensionLine,t,i,!1),e.makePointVisible(this.xStart,this.yStart),e.makePointVisible(t,i)}},i.prototype.toggleMagnetism=function(e){this.magnetismEnabled=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled()!==e,null==this.newDimensionLine||this.offsetChoice||this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())},i.prototype.setAlignmentActivated=function(e){this.alignmentActivated=e,this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())},i.prototype.escape=function(){null!=this.newDimensionLine&&this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.deleteDimensionLine(this.newDimensionLine),this.__parent.getPointerTypeLastMousePress()===View.PointerType.TOUCH?this.__parent.setState(this.__parent.getSelectionState()):this.__parent.setState(this.__parent.getDimensionLineCreationState())},i.prototype.exit=function(){this.__parent.getView().deleteFeedback(),this.newDimensionLine=null,this.oldSelection=null},i}(e.ControllerState);e.DimensionLineDrawingState=be,be.__class="com.eteks.sweethome3d.viewcontroller.PlanController.DimensionLineDrawingState";var Oe=function(t){function i(e){var i=t.call(this)||this;return i.__parent=e,void 0===i.selectedDimensionLine&&(i.selectedDimensionLine=null),void 0===i.editingStartPoint&&(i.editingStartPoint=!1),void 0===i.oldX&&(i.oldX=0),void 0===i.oldY&&(i.oldY=0),void 0===i.reversedDimensionLine&&(i.reversedDimensionLine=!1),void 0===i.deltaXToResizePoint&&(i.deltaXToResizePoint=0),void 0===i.deltaYToResizePoint&&(i.deltaYToResizePoint=0),void 0===i.distanceFromResizePointToDimensionBaseLine&&(i.distanceFromResizePointToDimensionBaseLine=0),void 0===i.magnetismEnabled&&(i.magnetismEnabled=!1),void 0===i.alignmentActivated&&(i.alignmentActivated=!1),i}return __extends(i,t),i.prototype.getMode=function(){return e.Mode.SELECTION_$LI$()},i.prototype.isModificationState=function(){return!0},i.prototype.isBasePlanModificationState=function(){return!0},i.prototype.enter=function(){var e,t,i=this.__parent.getView();i.setResizeIndicatorVisible(!0),this.selectedDimensionLine=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0],this.editingStartPoint=this.selectedDimensionLine===this.__parent.getResizedDimensionLineStartAt(this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress()),this.editingStartPoint?(this.oldX=this.selectedDimensionLine.getXStart(),this.oldY=this.selectedDimensionLine.getYStart()):(this.oldX=this.selectedDimensionLine.getXEnd(),this.oldY=this.selectedDimensionLine.getYEnd()),this.reversedDimensionLine=!1;var n=(this.selectedDimensionLine.getYEnd()-this.selectedDimensionLine.getYStart())/(this.selectedDimensionLine.getXEnd()-this.selectedDimensionLine.getXStart());if(Math.abs(n)>1e5)e=this.__parent.getXLastMousePress(),t=this.editingStartPoint?this.selectedDimensionLine.getYStart():this.selectedDimensionLine.getYEnd();else if(this.selectedDimensionLine.getYStart()===this.selectedDimensionLine.getYEnd())e=this.editingStartPoint?this.selectedDimensionLine.getXStart():this.selectedDimensionLine.getXEnd(),t=this.__parent.getYLastMousePress();else{var o=this.__parent.getYLastMousePress()-n*this.__parent.getXLastMousePress(),r=-1/n;t=n*(e=((this.editingStartPoint?this.selectedDimensionLine.getYStart()-r*this.selectedDimensionLine.getXStart():this.selectedDimensionLine.getYEnd()-r*this.selectedDimensionLine.getXEnd())-o)/(n-r))+o}this.deltaXToResizePoint=this.__parent.getXLastMousePress()-e,this.deltaYToResizePoint=this.__parent.getYLastMousePress()-t,this.editingStartPoint?(this.distanceFromResizePointToDimensionBaseLine=java.awt.geom.Point2D.distance(e,t,this.selectedDimensionLine.getXStart(),this.selectedDimensionLine.getYStart()),this.__parent.feedbackDisplayed&&i.setAlignmentFeedback(DimensionLine,this.selectedDimensionLine,this.selectedDimensionLine.getXStart(),this.selectedDimensionLine.getYStart(),!1)):(this.distanceFromResizePointToDimensionBaseLine=java.awt.geom.Point2D.distance(e,t,this.selectedDimensionLine.getXEnd(),this.selectedDimensionLine.getYEnd()),this.__parent.feedbackDisplayed&&i.setAlignmentFeedback(DimensionLine,this.selectedDimensionLine,this.selectedDimensionLine.getXEnd(),this.selectedDimensionLine.getYEnd(),!1)),this.alignmentActivated=this.__parent.wasAlignmentActivatedLastMousePress(),this.toggleMagnetism(this.__parent.wasMagnetismToggledLastMousePress())},i.prototype.moveMouse=function(t,i){var n=this.__parent.getView(),o=t-this.deltaXToResizePoint,r=i-this.deltaYToResizePoint;if(this.editingStartPoint){var l=java.awt.geom.Point2D.distance(o,r,this.selectedDimensionLine.getXEnd(),this.selectedDimensionLine.getYEnd());if((d=Math.sqrt(l*l-this.distanceFromResizePointToDimensionBaseLine*this.distanceFromResizePointToDimensionBaseLine))>0){var a=-Math.atan2(this.distanceFromResizePointToDimensionBaseLine,d);this.selectedDimensionLine.getOffset()>=0&&(a=-a);var s=a+Math.atan2(r-this.selectedDimensionLine.getYEnd(),o-this.selectedDimensionLine.getXEnd()),h=this.selectedDimensionLine.getXEnd()+d*Math.cos(s),u=this.selectedDimensionLine.getYEnd()+d*Math.sin(s);if(this.alignmentActivated||this.magnetismEnabled)h=(p=new e.PointWithAngleMagnetism(this.selectedDimensionLine.getXEnd(),this.selectedDimensionLine.getYEnd(),h,u,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit(),n.getPixelLength())).getX(),u=p.getY();e.moveDimensionLinePoint(this.selectedDimensionLine,h,u,this.editingStartPoint),this.updateReversedDimensionLine(),this.__parent.feedbackDisplayed&&n.setAlignmentFeedback(DimensionLine,this.selectedDimensionLine,h,u,!1)}else n.deleteFeedback()}else{var d,c=java.awt.geom.Point2D.distance(o,r,this.selectedDimensionLine.getXStart(),this.selectedDimensionLine.getYStart());if((d=Math.sqrt(c*c-this.distanceFromResizePointToDimensionBaseLine*this.distanceFromResizePointToDimensionBaseLine))>0){a=Math.atan2(this.distanceFromResizePointToDimensionBaseLine,d);this.selectedDimensionLine.getOffset()>=0&&(a=-a);s=a+Math.atan2(r-this.selectedDimensionLine.getYStart(),o-this.selectedDimensionLine.getXStart());var p,g=this.selectedDimensionLine.getXStart()+d*Math.cos(s),m=this.selectedDimensionLine.getYStart()+d*Math.sin(s);if(this.alignmentActivated||this.magnetismEnabled)g=(p=new e.PointWithAngleMagnetism(this.selectedDimensionLine.getXStart(),this.selectedDimensionLine.getYStart(),g,m,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit(),n.getPixelLength())).getX(),m=p.getY();e.moveDimensionLinePoint(this.selectedDimensionLine,g,m,this.editingStartPoint),this.updateReversedDimensionLine(),this.__parent.feedbackDisplayed&&n.setAlignmentFeedback(DimensionLine,this.selectedDimensionLine,g,m,!1)}else n.deleteFeedback()}this.__parent.getView().makePointVisible(t,i)},i.prototype.updateReversedDimensionLine=function(){var t=this.getDimensionLineAngle();(t<-Math.PI/2||t>Math.PI/2)&&(e.reverseDimensionLine(this.selectedDimensionLine),this.editingStartPoint=!this.editingStartPoint,this.reversedDimensionLine=!this.reversedDimensionLine)},i.prototype.getDimensionLineAngle=function(){return 0===this.selectedDimensionLine.getLength()?0:Math.atan2(this.selectedDimensionLine.getYStart()-this.selectedDimensionLine.getYEnd(),this.selectedDimensionLine.getXEnd()-this.selectedDimensionLine.getXStart())},i.prototype.releaseMouse=function(e,t){this.__parent.postDimensionLineResize(this.selectedDimensionLine,this.oldX,this.oldY,this.editingStartPoint,this.reversedDimensionLine),this.__parent.setState(this.__parent.getSelectionState())},i.prototype.toggleMagnetism=function(e){this.magnetismEnabled=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled()!==e,this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())},i.prototype.setAlignmentActivated=function(e){this.alignmentActivated=e,this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())},i.prototype.escape=function(){this.reversedDimensionLine&&(e.reverseDimensionLine(this.selectedDimensionLine),this.editingStartPoint=!this.editingStartPoint),e.moveDimensionLinePoint(this.selectedDimensionLine,this.oldX,this.oldY,this.editingStartPoint),this.__parent.setState(this.__parent.getSelectionState())},i.prototype.exit=function(){var e=this.__parent.getView();e.deleteFeedback(),e.setResizeIndicatorVisible(!1),this.selectedDimensionLine=null},i}(e.ControllerState);e.DimensionLineResizeState=Oe,Oe.__class="com.eteks.sweethome3d.viewcontroller.PlanController.DimensionLineResizeState";var Me=function(t){function i(e){var i=t.call(this)||this;return i.__parent=e,void 0===i.selectedDimensionLine&&(i.selectedDimensionLine=null),void 0===i.oldOffset&&(i.oldOffset=0),void 0===i.deltaXToOffsetPoint&&(i.deltaXToOffsetPoint=0),void 0===i.deltaYToOffsetPoint&&(i.deltaYToOffsetPoint=0),i}return __extends(i,t),i.prototype.getMode=function(){return e.Mode.SELECTION_$LI$()},i.prototype.isModificationState=function(){return!0},i.prototype.isBasePlanModificationState=function(){return!0},i.prototype.enter=function(){this.selectedDimensionLine=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0],this.oldOffset=this.selectedDimensionLine.getOffset();var e=this.selectedDimensionLine.getYEnd()!==this.selectedDimensionLine.getYStart()||this.selectedDimensionLine.getXEnd()!==this.selectedDimensionLine.getXStart()?Math.atan2(this.selectedDimensionLine.getYEnd()-this.selectedDimensionLine.getYStart(),this.selectedDimensionLine.getXEnd()-this.selectedDimensionLine.getXStart()):this.selectedDimensionLine.getPitch(),t=-Math.sin(e)*this.oldOffset,i=Math.cos(e)*this.oldOffset,n=(this.selectedDimensionLine.getXStart()+this.selectedDimensionLine.getXEnd())/2+t,o=(this.selectedDimensionLine.getYStart()+this.selectedDimensionLine.getYEnd())/2+i;this.deltaXToOffsetPoint=this.__parent.getXLastMousePress()-n,this.deltaYToOffsetPoint=this.__parent.getYLastMousePress()-o,this.__parent.getView().setResizeIndicatorVisible(!0)},i.prototype.moveMouse=function(e,t){var i,n,o,r,l=e-this.deltaXToOffsetPoint,a=t-this.deltaYToOffsetPoint;this.selectedDimensionLine.getYEnd()!==this.selectedDimensionLine.getYStart()||this.selectedDimensionLine.getXEnd()!==this.selectedDimensionLine.getXStart()?(i=java.awt.geom.Line2D.ptLineDist(this.selectedDimensionLine.getXStart(),this.selectedDimensionLine.getYStart(),this.selectedDimensionLine.getXEnd(),this.selectedDimensionLine.getYEnd(),l,a),n=java.awt.geom.Line2D.relativeCCW(this.selectedDimensionLine.getXStart(),this.selectedDimensionLine.getYStart(),this.selectedDimensionLine.getXEnd(),this.selectedDimensionLine.getYEnd(),l,a)):(i=java.awt.geom.Point2D.distance(this.selectedDimensionLine.getXStart(),this.selectedDimensionLine.getYStart(),l,a),n=java.awt.geom.Line2D.relativeCCW(this.selectedDimensionLine.getXStart(),this.selectedDimensionLine.getYStart(),this.selectedDimensionLine.getXStart()+Math.cos(this.selectedDimensionLine.getPitch()),this.selectedDimensionLine.getYStart()+Math.sin(this.selectedDimensionLine.getPitch()),l,a)),o=-((r=n)>0?1:r<0?-1:0)*i,this.selectedDimensionLine.setOffset(o),this.__parent.getView().makePointVisible(e,t)},i.prototype.releaseMouse=function(e,t){this.__parent.postDimensionLineOffset(this.selectedDimensionLine,this.oldOffset),this.__parent.setState(this.__parent.getSelectionState())},i.prototype.escape=function(){this.selectedDimensionLine.setOffset(this.oldOffset),this.__parent.setState(this.__parent.getSelectionState())},i.prototype.exit=function(){this.__parent.getView().setResizeIndicatorVisible(!1),this.selectedDimensionLine=null},i}(e.ControllerState);e.DimensionLineOffsetState=Me,Me.__class="com.eteks.sweethome3d.viewcontroller.PlanController.DimensionLineOffsetState";var De=function(t){function i(e){var i=t.call(this)||this;return i.__parent=e,void 0===i.selectedDimensionLine&&(i.selectedDimensionLine=null),void 0===i.oldPitch&&(i.oldPitch=0),void 0===i.pitchMousePress&&(i.pitchMousePress=0),void 0===i.magnetismEnabled&&(i.magnetismEnabled=!1),void 0===i.alignmentActivated&&(i.alignmentActivated=!1),i}return __extends(i,t),i.prototype.getMode=function(){return e.Mode.SELECTION_$LI$()},i.prototype.isModificationState=function(){return!0},i.prototype.isBasePlanModificationState=function(){return!0},i.prototype.enter=function(){this.selectedDimensionLine=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0],this.pitchMousePress=Math.atan2(this.selectedDimensionLine.getYStart()-this.__parent.getYLastMousePress(),this.__parent.getXLastMousePress()-this.selectedDimensionLine.getXStart()),this.oldPitch=this.selectedDimensionLine.getPitch(),this.alignmentActivated=this.__parent.wasAlignmentActivatedLastMousePress(),this.magnetismEnabled=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled()!==this.__parent.wasMagnetismToggledLastMousePress(),this.__parent.getView().setResizeIndicatorVisible(!0)},i.prototype.moveMouse=function(e,t){if(e!==this.selectedDimensionLine.getXStart()||t!==this.selectedDimensionLine.getYStart()){var n=Math.atan2(this.selectedDimensionLine.getYStart()-t,e-this.selectedDimensionLine.getXStart()),o=(this.oldPitch-n+this.pitchMousePress+2*Math.PI)%(2*Math.PI);if(this.alignmentActivated||this.magnetismEnabled){var r=2*Math.PI/i.STEP_COUNT;o=Math.round(o/r)*r}this.selectedDimensionLine.setPitch(o),this.__parent.planView.makePointVisible(e,t)}},i.prototype.releaseMouse=function(e,t){this.__parent.postDimensionLinePitchRotation(this.selectedDimensionLine,this.oldPitch),this.__parent.setState(this.__parent.getSelectionState())},i.prototype.toggleMagnetism=function(e){this.magnetismEnabled=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled()!==e,this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())},i.prototype.setAlignmentActivated=function(e){this.alignmentActivated=e,this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())},i.prototype.escape=function(){this.selectedDimensionLine.setPitch(this.oldPitch),this.__parent.setState(this.__parent.getSelectionState())},i.prototype.exit=function(){this.__parent.getView().setResizeIndicatorVisible(!1),this.selectedDimensionLine=null},i.STEP_COUNT=24,i}(e.ControllerState);e.DimensionLinePitchRotationState=De,De.__class="com.eteks.sweethome3d.viewcontroller.PlanController.DimensionLinePitchRotationState";var Re=function(t){function i(e){var i=t.call(this)||this;return i.__parent=e,void 0===i.selectedDimensionLine&&(i.selectedDimensionLine=null),void 0===i.oldHeight&&(i.oldHeight=0),void 0===i.magnetismEnabled&&(i.magnetismEnabled=!1),i}return __extends(i,t),i.prototype.getMode=function(){return e.Mode.SELECTION_$LI$()},i.prototype.isModificationState=function(){return!0},i.prototype.isBasePlanModificationState=function(){return!0},i.prototype.enter=function(){this.selectedDimensionLine=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0],this.oldHeight=this.selectedDimensionLine.getElevationEnd()-this.selectedDimensionLine.getElevationStart(),this.magnetismEnabled=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled()!==this.__parent.wasMagnetismToggledLastMousePress(),this.__parent.getView().setResizeIndicatorVisible(!0)},i.prototype.moveMouse=function(e,t){var i=t-this.__parent.getYLastMousePress(),n=Math.max(this.oldHeight-i,0);this.magnetismEnabled&&(n=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMagnetizedLength(n,this.__parent.planView.getPixelLength())),n=Math.min(Math.max(n,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMinimumLength()),this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMaximumLength()),this.selectedDimensionLine.setElevationEnd(this.selectedDimensionLine.getElevationStart()+n),this.__parent.getView().makePointVisible(e,t)},i.prototype.releaseMouse=function(e,t){this.__parent.postDimensionLineHeight(this.selectedDimensionLine,this.oldHeight),this.__parent.setState(this.__parent.getSelectionState())},i.prototype.toggleMagnetism=function(e){this.magnetismEnabled=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled()!==e,this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())},i.prototype.escape=function(){this.selectedDimensionLine.setElevationEnd(this.selectedDimensionLine.getElevationStart()+this.oldHeight),this.__parent.setState(this.__parent.getSelectionState())},i.prototype.exit=function(){this.__parent.getView().setResizeIndicatorVisible(!1),this.selectedDimensionLine=null},i}(e.ControllerState);e.DimensionLineHeightState=Re,Re.__class="com.eteks.sweethome3d.viewcontroller.PlanController.DimensionLineHeightState";var Fe=function(t){function i(e){var i=t.call(this)||this;return i.__parent=e,void 0===i.selectedDimensionLine&&(i.selectedDimensionLine=null),void 0===i.elevationToolTipFeedback&&(i.elevationToolTipFeedback=null),void 0===i.oldElevation&&(i.oldElevation=0),void 0===i.magnetismEnabled&&(i.magnetismEnabled=!1),i}return __extends(i,t),i.prototype.getMode=function(){return e.Mode.SELECTION_$LI$()},i.prototype.isModificationState=function(){return!0},i.prototype.isBasePlanModificationState=function(){return!0},i.prototype.enter=function(){this.selectedDimensionLine=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0],this.elevationToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(e,"elevationToolTipFeedback"),this.oldElevation=this.selectedDimensionLine.getElevationStart(),this.magnetismEnabled=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled()!==this.__parent.wasMagnetismToggledLastMousePress();var t=this.__parent.getView();t.setResizeIndicatorVisible(!0),this.__parent.feedbackDisplayed&&t.setToolTipFeedback(this.getToolTipFeedbackText(this.oldElevation),this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress())},i.prototype.moveMouse=function(e,t){var i=this.__parent.getView(),n=t-this.__parent.getYLastMousePress(),o=Math.max(this.oldElevation-n,0);this.magnetismEnabled&&(o=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMagnetizedLength(o,i.getPixelLength())),o=Math.min(o,this.selectedDimensionLine.getElevationEnd()-this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMinimumLength()),this.selectedDimensionLine.setElevationStart(o),i.makePointVisible(e,t),this.__parent.feedbackDisplayed&&i.setToolTipFeedback(this.getToolTipFeedbackText(o),e,t)},i.prototype.releaseMouse=function(e,t){this.__parent.postDimensionLineElevation(this.selectedDimensionLine,this.oldElevation),this.__parent.setState(this.__parent.getSelectionState())},i.prototype.toggleMagnetism=function(e){this.magnetismEnabled=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled()!==e,this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())},i.prototype.escape=function(){this.selectedDimensionLine.setElevationStart(this.oldElevation),this.__parent.setState(this.__parent.getSelectionState())},i.prototype.exit=function(){var e=this.__parent.getView();e.setResizeIndicatorVisible(!1),e.deleteFeedback(),this.selectedDimensionLine=null},i.prototype.getToolTipFeedbackText=function(e){return CoreTools.format(this.elevationToolTipFeedback,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getFormatWithUnit().format(e))},i}(e.ControllerState);e.DimensionLineElevationState=Fe,Fe.__class="com.eteks.sweethome3d.viewcontroller.PlanController.DimensionLineElevationState";var xe=function(t){function i(e){var i=t.call(this)||this;return i.__parent=e,void 0===i.roomSideLengthToolTipFeedback&&(i.roomSideLengthToolTipFeedback=null),void 0===i.roomDiagonalLengthToolTipFeedback&&(i.roomDiagonalLengthToolTipFeedback=null),void 0===i.roomSideAngleToolTipFeedback&&(i.roomSideAngleToolTipFeedback=null),i}return __extends(i,t),i.prototype.enter=function(){this.roomSideLengthToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(e,"roomSideLengthToolTipFeedback");try{this.roomDiagonalLengthToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(e,"roomDiagonalLengthToolTipFeedback")}catch(e){}try{this.roomSideAngleToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(e,"roomSideAngleToolTipFeedback")}catch(e){}},i.prototype.getToolTipFeedbackText=function(e,t){var i=this.getRoomSideLength(e,t),n=this.getRoomSideAngle(e,t),o="<html>"+CoreTools.format(this.roomSideLengthToolTipFeedback,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getFormatWithUnit().format(i));if(null!=this.roomDiagonalLengthToolTipFeedback&&this.roomDiagonalLengthToolTipFeedback.length>0&&e.getPointCount()>2){var r=this.getRoomDiagonalLength(e,t);o+="<br>"+CoreTools.format(this.roomDiagonalLengthToolTipFeedback,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getFormatWithUnit().format(r))}return null!=this.roomSideAngleToolTipFeedback&&this.roomSideAngleToolTipFeedback.length>0&&(o+="<br>"+CoreTools.format(this.roomSideAngleToolTipFeedback,n)),o},i.prototype.getRoomSideLength=function(e,t){var i=e.getPoints(),n=i[(t+i.length-1)%i.length];return java.awt.geom.Point2D.distance(n[0],n[1],i[t][0],i[t][1])},i.prototype.getRoomDiagonalLength=function(e,t){var i=e.getPoints();if(i.length>2){var n=i[(t+i.length-2)%i.length];return java.awt.geom.Point2D.distance(i[t][0],i[t][1],n[0],n[1])}throw new IllegalArgumentException("Room doesn't have at least 3 points")},i.prototype.getTriangulationDimensionLines=function(e,t){var i=e.getPoints(),n=i[(t+i.length-1)%i.length],o=[],r=20/this.__parent.getView().getScale();if(function(e,t){if(null==e&&null==t)return!0;if(null==e||null==t)return!1;if(e.length!=t.length)return!1;for(var i=0;i<e.length;i++)if(e[i]!=t[i])return!1;return!0}(i[t],n)||o.push(this.__parent.getDimensionLineBetweenPoints(n,i[t],this.isDimensionInsideRoom(e,n,i[t])?-r:r,!1)),i.length>2){var l=i[t+1<i.length?t+1:0];(function(e,t){if(null==e&&null==t)return!0;if(null==e||null==t)return!1;if(e.length!=t.length)return!1;for(var i=0;i<e.length;i++)if(e[i]!=t[i])return!1;return!0})(i[t],l)||o.push(this.__parent.getDimensionLineBetweenPoints(i[t],l,this.isDimensionInsideRoom(e,i[t],l)?-r:r,!1));var a=i[(t+i.length-2)%i.length];3===i.length?o.push(this.__parent.getDimensionLineBetweenPoints(n,a,this.isDimensionInsideRoom(e,n,a)?-r:r,!1)):function(e,t){if(null==e&&null==t)return!0;if(null==e||null==t)return!1;if(e.length!=t.length)return!1;for(var i=0;i<e.length;i++)if(e[i]!=t[i])return!1;return!0}(i[t],a)||o.push(this.__parent.getDimensionLineBetweenPoints(i[t],a,0,!1))}return o},i.prototype.isDimensionInsideRoom=function(e,t,i){var n=java.awt.geom.AffineTransform.getRotateInstance(Math.atan2(i[1]-t[1],i[0]-t[0]),t[0],t[1]),o=[t[0]+java.awt.geom.Point2D.distance(t[0],t[1],i[0],i[1])/2,t[1]+1];return n.transform(o,0,o,0,1),e.containsPoint(o[0],o[1],0)},i.prototype.getRoomSideAngle=function(e,t){var i=e.getPoints(),n=i[t],o=i[(t+i.length-1)%i.length],r=i[(t+i.length-2)%i.length],l=java.awt.geom.Point2D.distance(o[0],o[1],i[t][0],i[t][1]),a=java.awt.geom.Point2D.distance(r[0],r[1],o[0],o[1]);if(r!==n&&0!==l&&0!==a){var s=(n[0]-o[0])/l,h=(n[1]-o[1])/l,u=(o[0]-r[0])/a,d=(o[1]-r[1])/a,c=0|Math.round(180-180*Math.atan2(h*u-s*d,s*u+h*d)/Math.PI);return c>180&&(c-=360),c}return 0===l?0:0|Math.round(function(e){return 180*e/Math.PI}(Math.atan2(o[1]-n[1],n[0]-o[0])))},i.prototype.showRoomAngleFeedback=function(e,t){var i=e.getPoints();if(null!=this.roomSideAngleToolTipFeedback&&this.roomSideAngleToolTipFeedback.length>0&&i.length>2){var n=i[(t+i.length-1)%i.length],o=i[(t+i.length-2)%i.length];this.getRoomSideAngle(e,t)>0?this.__parent.getView().setAngleFeedback(n[0],n[1],o[0],o[1],i[t][0],i[t][1]):this.__parent.getView().setAngleFeedback(n[0],n[1],i[t][0],i[t][1],o[0],o[1])}},i}(e.ControllerState);e.AbstractRoomState=xe,xe.__class="com.eteks.sweethome3d.viewcontroller.PlanController.AbstractRoomState";var Ne=function(t){function i(e){var i=t.call(this)||this;return i.__parent=e,void 0===i.selectedRoom&&(i.selectedRoom=null),void 0===i.oldNameXOffset&&(i.oldNameXOffset=0),void 0===i.oldNameYOffset&&(i.oldNameYOffset=0),void 0===i.xLastMouseMove&&(i.xLastMouseMove=0),void 0===i.yLastMouseMove&&(i.yLastMouseMove=0),void 0===i.alignmentActivated&&(i.alignmentActivated=!1),i}return __extends(i,t),i.prototype.getMode=function(){return e.Mode.SELECTION_$LI$()},i.prototype.isModificationState=function(){return!0},i.prototype.enter=function(){this.selectedRoom=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0],this.oldNameXOffset=this.selectedRoom.getNameXOffset(),this.oldNameYOffset=this.selectedRoom.getNameYOffset(),this.xLastMouseMove=this.__parent.getXLastMousePress(),this.yLastMouseMove=this.__parent.getYLastMousePress(),this.alignmentActivated=this.__parent.wasAlignmentActivatedLastMousePress(),this.__parent.getView().setResizeIndicatorVisible(!0)},i.prototype.moveMouse=function(t,i){if(this.alignmentActivated){var n=new e.PointWithAngleMagnetism(this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress(),t,i,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit(),this.__parent.getView().getPixelLength(),4);t=n.getX(),i=n.getY()}this.selectedRoom.setNameXOffset(this.selectedRoom.getNameXOffset()+t-this.xLastMouseMove),this.selectedRoom.setNameYOffset(this.selectedRoom.getNameYOffset()+i-this.yLastMouseMove),this.xLastMouseMove=t,this.yLastMouseMove=i,this.__parent.getView().makePointVisible(t,i)},i.prototype.releaseMouse=function(e,t){this.__parent.postRoomNameOffset(this.selectedRoom,this.oldNameXOffset,this.oldNameYOffset),this.__parent.setState(this.__parent.getSelectionState())},i.prototype.setAlignmentActivated=function(e){this.alignmentActivated=e,this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())},i.prototype.escape=function(){this.selectedRoom.setNameXOffset(this.oldNameXOffset),this.selectedRoom.setNameYOffset(this.oldNameYOffset),this.__parent.setState(this.__parent.getSelectionState())},i.prototype.exit=function(){this.__parent.getView().setResizeIndicatorVisible(!1),this.selectedRoom=null},i}(e.ControllerState);e.RoomNameOffsetState=Ne,Ne.__class="com.eteks.sweethome3d.viewcontroller.PlanController.RoomNameOffsetState";var ke=function(t){function i(e){var i=t.call(this)||this;return i.__parent=e,void 0===i.selectedRoom&&(i.selectedRoom=null),void 0===i.oldNameAngle&&(i.oldNameAngle=0),void 0===i.angleMousePress&&(i.angleMousePress=0),void 0===i.magnetismEnabled&&(i.magnetismEnabled=!1),void 0===i.alignmentActivated&&(i.alignmentActivated=!1),i}return __extends(i,t),i.prototype.getMode=function(){return e.Mode.SELECTION_$LI$()},i.prototype.isModificationState=function(){return!0},i.prototype.enter=function(){this.selectedRoom=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0],this.angleMousePress=Math.atan2(this.selectedRoom.getYCenter()+this.selectedRoom.getNameYOffset()-this.__parent.getYLastMousePress(),this.__parent.getXLastMousePress()-this.selectedRoom.getXCenter()-this.selectedRoom.getNameXOffset()),this.oldNameAngle=this.selectedRoom.getNameAngle(),this.alignmentActivated=this.__parent.wasAlignmentActivatedLastMousePress(),this.magnetismEnabled=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled()!==this.__parent.wasMagnetismToggledLastMousePress(),this.__parent.getView().setResizeIndicatorVisible(!0)},i.prototype.moveMouse=function(e,t){if(e!==this.selectedRoom.getXCenter()+this.selectedRoom.getNameXOffset()||t!==this.selectedRoom.getYCenter()+this.selectedRoom.getNameYOffset()){var n=Math.atan2(this.selectedRoom.getYCenter()+this.selectedRoom.getNameYOffset()-t,e-this.selectedRoom.getXCenter()-this.selectedRoom.getNameXOffset()),o=this.oldNameAngle-n+this.angleMousePress;if(this.alignmentActivated||this.magnetismEnabled){var r=2*Math.PI/i.STEP_COUNT;o=Math.round(o/r)*r}this.selectedRoom.setNameAngle(o),this.__parent.getView().makePointVisible(e,t)}},i.prototype.releaseMouse=function(e,t){this.__parent.postRoomNameRotation(this.selectedRoom,this.oldNameAngle),this.__parent.setState(this.__parent.getSelectionState())},i.prototype.toggleMagnetism=function(e){this.magnetismEnabled=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled()!==e,this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())},i.prototype.setAlignmentActivated=function(e){this.alignmentActivated=e,this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())},i.prototype.escape=function(){this.selectedRoom.setNameAngle(this.oldNameAngle),this.__parent.setState(this.__parent.getSelectionState())},i.prototype.exit=function(){this.__parent.getView().setResizeIndicatorVisible(!1),this.selectedRoom=null},i.STEP_COUNT=24,i}(e.ControllerState);e.RoomNameRotationState=ke,ke.__class="com.eteks.sweethome3d.viewcontroller.PlanController.RoomNameRotationState";var He=function(t){function i(e){var i=t.call(this)||this;return i.__parent=e,void 0===i.selectedRoom&&(i.selectedRoom=null),void 0===i.oldAreaXOffset&&(i.oldAreaXOffset=0),void 0===i.oldAreaYOffset&&(i.oldAreaYOffset=0),void 0===i.xLastMouseMove&&(i.xLastMouseMove=0),void 0===i.yLastMouseMove&&(i.yLastMouseMove=0),void 0===i.alignmentActivated&&(i.alignmentActivated=!1),i}return __extends(i,t),i.prototype.getMode=function(){return e.Mode.SELECTION_$LI$()},i.prototype.isModificationState=function(){return!0},i.prototype.enter=function(){this.selectedRoom=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0],this.oldAreaXOffset=this.selectedRoom.getAreaXOffset(),this.oldAreaYOffset=this.selectedRoom.getAreaYOffset(),this.xLastMouseMove=this.__parent.getXLastMousePress(),this.yLastMouseMove=this.__parent.getYLastMousePress(),this.alignmentActivated=this.__parent.wasAlignmentActivatedLastMousePress(),this.__parent.getView().setResizeIndicatorVisible(!0)},i.prototype.moveMouse=function(t,i){if(this.alignmentActivated){var n=new e.PointWithAngleMagnetism(this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress(),t,i,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit(),this.__parent.getView().getPixelLength(),4);t=n.getX(),i=n.getY()}this.selectedRoom.setAreaXOffset(this.selectedRoom.getAreaXOffset()+t-this.xLastMouseMove),this.selectedRoom.setAreaYOffset(this.selectedRoom.getAreaYOffset()+i-this.yLastMouseMove),this.xLastMouseMove=t,this.yLastMouseMove=i,this.__parent.getView().makePointVisible(t,i)},i.prototype.releaseMouse=function(e,t){this.__parent.postRoomAreaOffset(this.selectedRoom,this.oldAreaXOffset,this.oldAreaYOffset),this.__parent.setState(this.__parent.getSelectionState())},i.prototype.setAlignmentActivated=function(e){this.alignmentActivated=e,this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())},i.prototype.escape=function(){this.selectedRoom.setAreaXOffset(this.oldAreaXOffset),this.selectedRoom.setAreaYOffset(this.oldAreaYOffset),this.__parent.setState(this.__parent.getSelectionState())},i.prototype.exit=function(){this.__parent.getView().setResizeIndicatorVisible(!1),this.selectedRoom=null},i}(e.ControllerState);e.RoomAreaOffsetState=He,He.__class="com.eteks.sweethome3d.viewcontroller.PlanController.RoomAreaOffsetState";var Ve=function(t){function i(e){var i=t.call(this)||this;return i.__parent=e,void 0===i.selectedRoom&&(i.selectedRoom=null),void 0===i.oldAreaAngle&&(i.oldAreaAngle=0),void 0===i.angleMousePress&&(i.angleMousePress=0),void 0===i.magnetismEnabled&&(i.magnetismEnabled=!1),void 0===i.alignmentActivated&&(i.alignmentActivated=!1),i}return __extends(i,t),i.prototype.getMode=function(){return e.Mode.SELECTION_$LI$()},i.prototype.isModificationState=function(){return!0},i.prototype.enter=function(){this.selectedRoom=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0],this.angleMousePress=Math.atan2(this.selectedRoom.getYCenter()+this.selectedRoom.getAreaYOffset()-this.__parent.getYLastMousePress(),this.__parent.getXLastMousePress()-this.selectedRoom.getXCenter()-this.selectedRoom.getAreaXOffset()),this.oldAreaAngle=this.selectedRoom.getAreaAngle(),this.alignmentActivated=this.__parent.wasAlignmentActivatedLastMousePress(),this.magnetismEnabled=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled()!==this.__parent.wasMagnetismToggledLastMousePress(),this.__parent.getView().setResizeIndicatorVisible(!0)},i.prototype.moveMouse=function(e,t){if(e!==this.selectedRoom.getXCenter()+this.selectedRoom.getAreaXOffset()||t!==this.selectedRoom.getYCenter()+this.selectedRoom.getAreaYOffset()){var n=Math.atan2(this.selectedRoom.getYCenter()+this.selectedRoom.getAreaYOffset()-t,e-this.selectedRoom.getXCenter()-this.selectedRoom.getAreaXOffset()),o=this.oldAreaAngle-n+this.angleMousePress;if(this.alignmentActivated||this.magnetismEnabled){var r=2*Math.PI/i.STEP_COUNT;o=Math.round(o/r)*r}this.selectedRoom.setAreaAngle(o),this.__parent.getView().makePointVisible(e,t)}},i.prototype.releaseMouse=function(e,t){this.__parent.postRoomAreaRotation(this.selectedRoom,this.oldAreaAngle),this.__parent.setState(this.__parent.getSelectionState())},i.prototype.toggleMagnetism=function(e){this.magnetismEnabled=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled()!==e,this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())},i.prototype.setAlignmentActivated=function(e){this.alignmentActivated=e,this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())},i.prototype.escape=function(){this.selectedRoom.setAreaAngle(this.oldAreaAngle),this.__parent.setState(this.__parent.getSelectionState())},i.prototype.exit=function(){this.__parent.getView().setResizeIndicatorVisible(!1),this.selectedRoom=null},i.STEP_COUNT=24,i}(e.ControllerState);e.RoomAreaRotationState=Ve,Ve.__class="com.eteks.sweethome3d.viewcontroller.PlanController.RoomAreaRotationState";var Ue=function(t){function i(e){var i=t.call(this)||this;return i.__parent=e,void 0===i.polylineSegmentLengthToolTipFeedback&&(i.polylineSegmentLengthToolTipFeedback=null),void 0===i.polylineSegmentAngleToolTipFeedback&&(i.polylineSegmentAngleToolTipFeedback=null),i}return __extends(i,t),i.prototype.enter=function(){this.polylineSegmentLengthToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(e,"polylineSegmentLengthToolTipFeedback");try{this.polylineSegmentAngleToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(e,"polylineSegmentAngleToolTipFeedback")}catch(e){}},i.prototype.getToolTipFeedbackText=function(e,t){var i=this.getPolylineSegmentLength(e,t),n=this.getPolylineSegmentAngle(e,t),o="<html>"+CoreTools.format(this.polylineSegmentLengthToolTipFeedback,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getFormatWithUnit().format(i));return null!=this.polylineSegmentAngleToolTipFeedback&&this.polylineSegmentAngleToolTipFeedback.length>0&&(o+="<br>"+CoreTools.format(this.polylineSegmentAngleToolTipFeedback,n)),o},i.prototype.getPolylineSegmentLength=function(e,t){0!==t||e.isClosedPath()||t++;var i=e.getPoints(),n=i[(t+i.length-1)%i.length];return java.awt.geom.Point2D.distance(n[0],n[1],i[t][0],i[t][1])},i.prototype.getPolylineSegmentAngle=function(e,t){0!==t||e.isClosedPath()||t++;var i=e.getPoints(),n=i[t],o=i[(t+i.length-1)%i.length],r=i[(t+i.length-2)%i.length],l=java.awt.geom.Point2D.distance(o[0],o[1],i[t][0],i[t][1]),a=java.awt.geom.Point2D.distance(r[0],r[1],o[0],o[1]);if(r!==n&&0!==l&&0!==a){var s=(n[0]-o[0])/l,h=(n[1]-o[1])/l,u=(o[0]-r[0])/a,d=(o[1]-r[1])/a,c=0|Math.round(180-180*Math.atan2(h*u-s*d,s*u+h*d)/Math.PI);return c>180&&(c-=360),c}return 0===l?0:0|Math.round(function(e){return 180*e/Math.PI}(Math.atan2(o[1]-n[1],n[0]-o[0])))},i.prototype.showPolylineAngleFeedback=function(e,t){var i=e.getPoints();if(null!=this.polylineSegmentAngleToolTipFeedback&&this.polylineSegmentAngleToolTipFeedback.length>0&&(t>=2||i.length>2&&e.isClosedPath())){var n=i[(t+i.length-1)%i.length],o=i[(t+i.length-2)%i.length];this.__parent.getView().setAngleFeedback(n[0],n[1],o[0],o[1],i[t][0],i[t][1])}},i}(e.ControllerState);e.AbstractPolylineState=Ue,Ue.__class="com.eteks.sweethome3d.viewcontroller.PlanController.AbstractPolylineState";var We=function(t){function i(e){var i=t.call(this)||this;return i.__parent=e,void 0===i.selectedLabel&&(i.selectedLabel=null),void 0===i.oldAngle&&(i.oldAngle=0),void 0===i.angleMousePress&&(i.angleMousePress=0),void 0===i.magnetismEnabled&&(i.magnetismEnabled=!1),void 0===i.alignmentActivated&&(i.alignmentActivated=!1),i}return __extends(i,t),i.prototype.getMode=function(){return e.Mode.SELECTION_$LI$()},i.prototype.isModificationState=function(){return!0},i.prototype.isBasePlanModificationState=function(){return!0},i.prototype.enter=function(){this.selectedLabel=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0],this.angleMousePress=Math.atan2(this.selectedLabel.getY()-this.__parent.getYLastMousePress(),this.__parent.getXLastMousePress()-this.selectedLabel.getX()),this.oldAngle=this.selectedLabel.getAngle(),this.alignmentActivated=this.__parent.wasAlignmentActivatedLastMousePress(),this.magnetismEnabled=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled()!==this.__parent.wasMagnetismToggledLastMousePress(),this.__parent.getView().setResizeIndicatorVisible(!0)},i.prototype.moveMouse=function(e,t){if(e!==this.selectedLabel.getX()||t!==this.selectedLabel.getY()){var n=Math.atan2(this.selectedLabel.getY()-t,e-this.selectedLabel.getX()),o=this.oldAngle-n+this.angleMousePress;if(this.alignmentActivated||this.magnetismEnabled){var r=2*Math.PI/i.STEP_COUNT;o=Math.round(o/r)*r}this.selectedLabel.setAngle(o),this.__parent.getView().makePointVisible(e,t)}},i.prototype.releaseMouse=function(e,t){this.__parent.postLabelRotation(this.selectedLabel,this.oldAngle),this.__parent.setState(this.__parent.getSelectionState())},i.prototype.toggleMagnetism=function(e){this.magnetismEnabled=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled()!==e,this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())},i.prototype.setAlignmentActivated=function(e){this.alignmentActivated=e,this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())},i.prototype.escape=function(){this.selectedLabel.setAngle(this.oldAngle),this.__parent.setState(this.__parent.getSelectionState())},i.prototype.exit=function(){this.__parent.getView().setResizeIndicatorVisible(!1),this.selectedLabel=null},i.STEP_COUNT=24,i}(e.ControllerState);e.LabelRotationState=We,We.__class="com.eteks.sweethome3d.viewcontroller.PlanController.LabelRotationState";var Be=function(t){function i(e){var i=t.call(this)||this;return i.__parent=e,void 0===i.magnetismEnabled&&(i.magnetismEnabled=!1),void 0===i.deltaYToElevationPoint&&(i.deltaYToElevationPoint=0),void 0===i.selectedLabel&&(i.selectedLabel=null),void 0===i.oldElevation&&(i.oldElevation=0),void 0===i.elevationToolTipFeedback&&(i.elevationToolTipFeedback=null),i}return __extends(i,t),i.prototype.getMode=function(){return e.Mode.SELECTION_$LI$()},i.prototype.isModificationState=function(){return!0},i.prototype.isBasePlanModificationState=function(){return!0},i.prototype.enter=function(){this.elevationToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(e,"elevationToolTipFeedback"),this.selectedLabel=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0];var t=this.__parent.getItemTextStyle(this.selectedLabel,this.selectedLabel.getStyle()),i=this.__parent.getView().getTextBounds(this.selectedLabel.getText(),t,this.selectedLabel.getX(),this.selectedLabel.getY(),this.selectedLabel.getAngle());this.deltaYToElevationPoint=this.__parent.getYLastMousePress()-(i[2][1]+i[3][1])/2,this.oldElevation=this.selectedLabel.getElevation(),this.magnetismEnabled=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled()!==this.__parent.wasMagnetismToggledLastMousePress();var n=this.__parent.getView();n.setResizeIndicatorVisible(!0),this.__parent.feedbackDisplayed&&n.setToolTipFeedback(this.getToolTipFeedbackText(this.oldElevation),this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress())},i.prototype.moveMouse=function(e,t){var i=this.__parent.getView(),n=this.__parent.getItemTextStyle(this.selectedLabel,this.selectedLabel.getStyle()),o=this.__parent.getView().getTextBounds(this.selectedLabel.getText(),n,this.selectedLabel.getX(),this.selectedLabel.getY(),this.selectedLabel.getAngle()),r=t-this.deltaYToElevationPoint-(o[2][1]+o[3][1])/2,l=this.oldElevation-r;l=Math.min(Math.max(l,0),this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMaximumElevation()),this.magnetismEnabled&&(l=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMagnetizedLength(l,i.getPixelLength())),this.selectedLabel.setElevation(l),i.makePointVisible(e,t),this.__parent.feedbackDisplayed&&i.setToolTipFeedback(this.getToolTipFeedbackText(l),e,t)},i.prototype.releaseMouse=function(e,t){this.__parent.postLabelElevation(this.selectedLabel,this.oldElevation),this.__parent.setState(this.__parent.getSelectionState())},i.prototype.toggleMagnetism=function(e){this.magnetismEnabled=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled()!==e,this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())},i.prototype.escape=function(){this.selectedLabel.setElevation(this.oldElevation),this.__parent.setState(this.__parent.getSelectionState())},i.prototype.exit=function(){var e=this.__parent.getView();e.setResizeIndicatorVisible(!1),e.deleteFeedback(),this.selectedLabel=null},i.prototype.getToolTipFeedbackText=function(e){return CoreTools.format(this.elevationToolTipFeedback,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getFormatWithUnit().format(e))},i}(e.ControllerState);e.LabelElevationState=Be,Be.__class="com.eteks.sweethome3d.viewcontroller.PlanController.LabelElevationState";var Ge=function(t){function i(e){var i=t.call(this)||this;return i.__parent=e,void 0===i.selectedCompass&&(i.selectedCompass=null),void 0===i.angleMousePress&&(i.angleMousePress=0),void 0===i.oldNorthDirection&&(i.oldNorthDirection=0),void 0===i.rotationToolTipFeedback&&(i.rotationToolTipFeedback=null),i}return __extends(i,t),i.prototype.getMode=function(){return e.Mode.SELECTION_$LI$()},i.prototype.isModificationState=function(){return!0},i.prototype.isBasePlanModificationState=function(){return!0},i.prototype.enter=function(){this.rotationToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(e,"rotationToolTipFeedback"),this.selectedCompass=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0],this.angleMousePress=Math.atan2(this.selectedCompass.getY()-this.__parent.getYLastMousePress(),this.__parent.getXLastMousePress()-this.selectedCompass.getX()),this.oldNorthDirection=this.selectedCompass.getNorthDirection();var t=this.__parent.getView();t.setResizeIndicatorVisible(!0),this.__parent.feedbackDisplayed&&t.setToolTipFeedback(this.getToolTipFeedbackText(this.oldNorthDirection),this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress())},i.prototype.moveMouse=function(e,t){if(e!==this.selectedCompass.getX()||t!==this.selectedCompass.getY()){var i=Math.atan2(this.selectedCompass.getY()-t,e-this.selectedCompass.getX()),n=this.oldNorthDirection-i+this.angleMousePress,o=Math.PI/180;n=((n=Math.round(n/o)*o)+2*Math.PI)%(2*Math.PI),this.selectedCompass.setNorthDirection(n);var r=this.__parent.getView();r.makePointVisible(e,t),this.__parent.feedbackDisplayed&&r.setToolTipFeedback(this.getToolTipFeedbackText(n),e,t)}},i.prototype.releaseMouse=function(e,t){this.__parent.postCompassRotation(this.selectedCompass,this.oldNorthDirection),this.__parent.setState(this.__parent.getSelectionState())},i.prototype.escape=function(){this.selectedCompass.setNorthDirection(this.oldNorthDirection),this.__parent.setState(this.__parent.getSelectionState())},i.prototype.exit=function(){var e=this.__parent.getView();e.setResizeIndicatorVisible(!1),e.deleteFeedback(),this.selectedCompass=null},i.prototype.getToolTipFeedbackText=function(e){return CoreTools.format(this.rotationToolTipFeedback,Math.round(180*e/Math.PI))},i}(e.ControllerState);e.CompassRotationState=Ge,Ge.__class="com.eteks.sweethome3d.viewcontroller.PlanController.CompassRotationState";var Ye=function(t){function i(e){var i=t.call(this)||this;return i.__parent=e,void 0===i.selectedCompass&&(i.selectedCompass=null),void 0===i.oldDiameter&&(i.oldDiameter=0),void 0===i.deltaXToResizePoint&&(i.deltaXToResizePoint=0),void 0===i.deltaYToResizePoint&&(i.deltaYToResizePoint=0),void 0===i.resizeToolTipFeedback&&(i.resizeToolTipFeedback=null),i}return __extends(i,t),i.prototype.getMode=function(){return e.Mode.SELECTION_$LI$()},i.prototype.isModificationState=function(){return!0},i.prototype.isBasePlanModificationState=function(){return!0},i.prototype.enter=function(){this.resizeToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(e,"diameterToolTipFeedback"),this.selectedCompass=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0];var t=this.selectedCompass.getPoints(),i=(t[1][0]+t[2][0])/2,n=(t[1][1]+t[2][1])/2;this.deltaXToResizePoint=this.__parent.getXLastMousePress()-i,this.deltaYToResizePoint=this.__parent.getYLastMousePress()-n,this.oldDiameter=this.selectedCompass.getDiameter();var o=this.__parent.getView();o.setResizeIndicatorVisible(!0),this.__parent.feedbackDisplayed&&o.setToolTipFeedback(this.getToolTipFeedbackText(this.oldDiameter),this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress())},i.prototype.moveMouse=function(e,t){var i=this.__parent.getView(),n=2*java.awt.geom.Point2D.distance(this.selectedCompass.getX(),this.selectedCompass.getY(),e-this.deltaXToResizePoint,t-this.deltaYToResizePoint);n=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMagnetizedLength(n,i.getPixelLength()),n=Math.min(Math.max(n,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMinimumLength()),this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMaximumLength()/10),this.selectedCompass.setDiameter(n),i.makePointVisible(e,t),this.__parent.feedbackDisplayed&&i.setToolTipFeedback(this.getToolTipFeedbackText(n),e,t)},i.prototype.releaseMouse=function(e,t){this.__parent.postCompassResize(this.selectedCompass,this.oldDiameter),this.__parent.setState(this.__parent.getSelectionState())},i.prototype.escape=function(){this.selectedCompass.setDiameter(this.oldDiameter),this.__parent.setState(this.__parent.getSelectionState())},i.prototype.exit=function(){var e=this.__parent.getView();e.setResizeIndicatorVisible(!1),e.deleteFeedback(),this.selectedCompass=null},i.prototype.getToolTipFeedbackText=function(e){return CoreTools.format(this.resizeToolTipFeedback,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getFormatWithUnit().format(e))},i}(e.ControllerState);e.CompassResizeState=Ye,Ye.__class="com.eteks.sweethome3d.viewcontroller.PlanController.CompassResizeState";var $e=function(t){function i(e){var n=t.call(this,e)||this;return n.__parent=e,n.selectionListener=new i.SelectionState$0(n),n}return __extends(i,t),i.prototype.getMode=function(){return e.Mode.SELECTION_$LI$()},i.prototype.enter=function(){null!=this.__parent.getView()&&(this.__parent.getPointerTypeLastMousePress()!==View.PointerType.TOUCH&&this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove()),this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addSelectionListener(this.selectionListener),this.selectionListener.selectionChanged(null))},i.prototype.moveMouse=function(e,t){null!=this.__parent.getRotatedLabelAt(e,t)||null!=this.__parent.getYawRotatedCameraAt(e,t)||null!=this.__parent.getPitchRotatedCameraAt(e,t)?this.__parent.getView().setCursor(PlanView.CursorType.ROTATION):null!=this.__parent.getElevatedLabelAt(e,t)||null!=this.__parent.getElevatedCameraAt(e,t)?this.__parent.getView().setCursor(PlanView.CursorType.ELEVATION):null!=this.__parent.getRoomNameAt(e,t)||null!=this.__parent.getRoomAreaAt(e,t)?this.__parent.getView().setCursor(PlanView.CursorType.RESIZE):null!=this.__parent.getRoomRotatedNameAt(e,t)||null!=this.__parent.getRoomRotatedAreaAt(e,t)?this.__parent.getView().setCursor(PlanView.CursorType.ROTATION):null!=this.__parent.getResizedDimensionLineStartAt(e,t)||null!=this.__parent.getResizedDimensionLineEndAt(e,t)||null!=this.__parent.getHeightResizedDimensionLineAt(e,t)||null!=this.__parent.getWidthAndDepthResizedPieceOfFurnitureAt(e,t)||null!=this.__parent.getResizedWallStartAt(e,t)||null!=this.__parent.getResizedWallEndAt(e,t)||null!=this.__parent.getResizedPolylineAt(e,t)||null!=this.__parent.getResizedRoomAt(e,t)?this.__parent.getView().setCursor(PlanView.CursorType.RESIZE):null!=this.__parent.getPitchRotatedPieceOfFurnitureAt(e,t)||null!=this.__parent.getRollRotatedPieceOfFurnitureAt(e,t)?this.__parent.getView().setCursor(PlanView.CursorType.ROTATION):null!=this.__parent.getModifiedLightPowerAt(e,t)?this.__parent.getView().setCursor(PlanView.CursorType.POWER):null!=this.__parent.getOffsetDimensionLineAt(e,t)||null!=this.__parent.getHeightResizedPieceOfFurnitureAt(e,t)||null!=this.__parent.getArcExtentWallAt(e,t)?this.__parent.getView().setCursor(PlanView.CursorType.HEIGHT):null!=this.__parent.getRotatedPieceOfFurnitureAt(e,t)||null!=this.__parent.getPitchRotatedDimensionLineAt(e,t)?this.__parent.getView().setCursor(PlanView.CursorType.ROTATION):null!=this.__parent.getElevatedPieceOfFurnitureAt(e,t)||null!=this.__parent.getElevatedDimensionLineAt(e,t)?this.__parent.getView().setCursor(PlanView.CursorType.ELEVATION):null!=this.__parent.getPieceOfFurnitureNameAt(e,t)?this.__parent.getView().setCursor(PlanView.CursorType.RESIZE):null!=this.__parent.getPieceOfFurnitureRotatedNameAt(e,t)||null!=this.__parent.getRotatedCompassAt(e,t)?this.__parent.getView().setCursor(PlanView.CursorType.ROTATION):null!=this.__parent.getResizedCompassAt(e,t)?this.__parent.getView().setCursor(PlanView.CursorType.RESIZE):this.__parent.isItemSelectedAt(e,t)?this.__parent.getView().setCursor(PlanView.CursorType.MOVE):this.__parent.getView().setCursor(PlanView.CursorType.SELECTION)},i.prototype.pressMouse=function(e,t,i,n,o){if(1===i)this.__parent.getPointerTypeLastMousePress()===View.PointerType.TOUCH&&this.moveMouse(e,t),null!=this.__parent.getRotatedLabelAt(e,t)?this.__parent.setState(this.__parent.getLabelRotationState()):null!=this.__parent.getYawRotatedCameraAt(e,t)?this.__parent.setState(this.__parent.getCameraYawRotationState()):null!=this.__parent.getPitchRotatedCameraAt(e,t)?this.__parent.setState(this.__parent.getCameraPitchRotationState()):null!=this.__parent.getElevatedLabelAt(e,t)?this.__parent.setState(this.__parent.getLabelElevationState()):null!=this.__parent.getElevatedCameraAt(e,t)?this.__parent.setState(this.__parent.getCameraElevationState()):null!=this.__parent.getRoomNameAt(e,t)?this.__parent.setState(this.__parent.getRoomNameOffsetState()):null!=this.__parent.getRoomRotatedNameAt(e,t)?this.__parent.setState(this.__parent.getRoomNameRotationState()):null!=this.__parent.getRoomAreaAt(e,t)?this.__parent.setState(this.__parent.getRoomAreaOffsetState()):null!=this.__parent.getRoomRotatedAreaAt(e,t)?this.__parent.setState(this.__parent.getRoomAreaRotationState()):null!=this.__parent.getResizedDimensionLineStartAt(e,t)||null!=this.__parent.getResizedDimensionLineEndAt(e,t)?this.__parent.setState(this.__parent.getDimensionLineResizeState()):null!=this.__parent.getHeightResizedDimensionLineAt(e,t)?this.__parent.setState(this.__parent.getDimensionLineHeightState()):null!=this.__parent.getWidthAndDepthResizedPieceOfFurnitureAt(e,t)?this.__parent.setState(this.__parent.getPieceOfFurnitureResizeState()):null!=this.__parent.getResizedWallStartAt(e,t)||null!=this.__parent.getResizedWallEndAt(e,t)?this.__parent.setState(this.__parent.getWallResizeState()):null!=this.__parent.getResizedRoomAt(e,t)?this.__parent.setState(this.__parent.getRoomResizeState()):null!=this.__parent.getOffsetDimensionLineAt(e,t)?this.__parent.setState(this.__parent.getDimensionLineOffsetState()):null!=this.__parent.getResizedPolylineAt(e,t)?this.__parent.setState(this.__parent.getPolylineResizeState()):null!=this.__parent.getPitchRotatedPieceOfFurnitureAt(e,t)?this.__parent.setState(this.__parent.getPieceOfFurniturePitchRotationState()):null!=this.__parent.getRollRotatedPieceOfFurnitureAt(e,t)?this.__parent.setState(this.__parent.getPieceOfFurnitureRollRotationState()):null!=this.__parent.getModifiedLightPowerAt(e,t)?this.__parent.setState(this.__parent.getLightPowerModificationState()):null!=this.__parent.getHeightResizedPieceOfFurnitureAt(e,t)?this.__parent.setState(this.__parent.getPieceOfFurnitureHeightState()):null!=this.__parent.getArcExtentWallAt(e,t)?this.__parent.setState(this.__parent.getWallArcExtentState()):null!=this.__parent.getRotatedPieceOfFurnitureAt(e,t)?this.__parent.setState(this.__parent.getPieceOfFurnitureRotationState()):null!=this.__parent.getPitchRotatedDimensionLineAt(e,t)?this.__parent.setState(this.__parent.getDimensionLinePitchRotationState()):null!=this.__parent.getElevatedPieceOfFurnitureAt(e,t)?this.__parent.setState(this.__parent.getPieceOfFurnitureElevationState()):null!=this.__parent.getElevatedDimensionLineAt(e,t)?this.__parent.setState(this.__parent.getDimensionLineElevationState()):null!=this.__parent.getPieceOfFurnitureNameAt(e,t)?this.__parent.setState(this.__parent.getPieceOfFurnitureNameOffsetState()):null!=this.__parent.getPieceOfFurnitureRotatedNameAt(e,t)?this.__parent.setState(this.__parent.getPieceOfFurnitureNameRotationState()):null!=this.__parent.getRotatedCompassAt(e,t)?this.__parent.setState(this.__parent.getCompassRotationState()):null!=this.__parent.getResizedCompassAt(e,t)?this.__parent.setState(this.__parent.getCompassResizeState()):n||this.__parent.getPointerTypeLastMousePress()!==View.PointerType.TOUCH&&null==this.__parent.getSelectableItemAt(e,t)?this.__parent.setState(this.__parent.getRectangleSelectionState()):this.__parent.setState(this.__parent.getSelectionMoveState());else if(2===i){var r=this.__parent.getSelectableItemAt(e,t);n||null==r||this.__parent.modifySelectedItem()}},i.prototype.exit=function(){null!=this.__parent.getView()&&(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.removeSelectionListener(this.selectionListener),this.__parent.getView().setResizeIndicatorVisible(!1))},i}(e.AbstractModeChangeState);e.SelectionState=$e,$e.__class="com.eteks.sweethome3d.viewcontroller.PlanController.SelectionState",function(e){var t=function(){function e(e){this.__parent=e}return e.prototype.selectionChanged=function(e){var t=this.__parent.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();this.__parent.__parent.getView().setResizeIndicatorVisible(1===t.length&&(this.__parent.__parent.isItemResizable(t[0])||this.__parent.__parent.isItemMovable(t[0])))},e}();e.SelectionState$0=t,t.__interfaces=["com.eteks.sweethome3d.model.SelectionListener"]}($e=e.SelectionState||(e.SelectionState={}));var Xe=function(t){function i(e){var i=t.call(this,e)||this;return i.__parent=e,void 0===i.magnetismEnabled&&(i.magnetismEnabled=!1),i}return __extends(i,t),i.prototype.getMode=function(){return e.Mode.WALL_CREATION_$LI$()},i.prototype.enter=function(){this.__parent.getView().setCursor(PlanView.CursorType.DRAW),this.toggleMagnetism(this.__parent.wasMagnetismToggledLastMousePress())},i.prototype.moveMouse=function(t,i){if(this.magnetismEnabled){var n=new e.WallPointWithAngleMagnetism(this.__parent,null,t,i,t,i);t=n.getX(),i=n.getY()}this.__parent.feedbackDisplayed&&this.__parent.getView().setAlignmentFeedback(Wall,null,t,i,!1)},i.prototype.pressMouse=function(e,t,i,n,o){this.__parent.setState(this.__parent.getWallDrawingState())},i.prototype.setEditionActivated=function(e){e&&(this.__parent.setState(this.__parent.getWallDrawingState()),this.setEditionActivated(e))},i.prototype.toggleMagnetism=function(e){this.magnetismEnabled=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled()!==e,this.__parent.getPointerTypeLastMousePress()!==View.PointerType.TOUCH&&this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())},i.prototype.exit=function(){this.__parent.getView().deleteFeedback()},i}(e.AbstractModeChangeState);e.WallCreationState=Xe,Xe.__class="com.eteks.sweethome3d.viewcontroller.PlanController.WallCreationState";var ze=function(t){function i(e){var i=t.call(this,e)||this;return i.__parent=e,void 0===i.magnetismEnabled&&(i.magnetismEnabled=!1),i}return __extends(i,t),i.prototype.getMode=function(){return e.Mode.DIMENSION_LINE_CREATION_$LI$()},i.prototype.enter=function(){this.__parent.getView().setCursor(PlanView.CursorType.DRAW),this.toggleMagnetism(this.__parent.wasMagnetismToggledLastMousePress())},i.prototype.moveMouse=function(e,t){if(this.__parent.feedbackDisplayed){this.__parent.getView().setAlignmentFeedback(DimensionLine,null,e,t,!1);var i=this.__parent.getMeasuringDimensionLineAt(e,t,this.magnetismEnabled);null!=i?this.__parent.getView().setDimensionLinesFeedback([i].slice(0)):this.__parent.getView().setDimensionLinesFeedback(null)}},i.prototype.pressMouse=function(e,t,i,n,o){1===i&&(this.__parent.wasDuplicationActivatedLastMousePress()?(this.__parent.getView().deleteFeedback(),this.__parent.createDimensionLine(e,t)):this.__parent.setState(this.__parent.getDimensionLineDrawingState()))},i.prototype.setEditionActivated=function(e){e&&(this.__parent.setState(this.__parent.getDimensionLineDrawingState()),this.setEditionActivated(e))},i.prototype.toggleMagnetism=function(e){this.magnetismEnabled=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled()!==e,this.__parent.getPointerTypeLastMousePress()!==View.PointerType.TOUCH&&this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())},i.prototype.exit=function(){this.__parent.getView().deleteFeedback()},i}(e.AbstractModeChangeState);e.DimensionLineCreationState=ze,ze.__class="com.eteks.sweethome3d.viewcontroller.PlanController.DimensionLineCreationState";var je=function(t){function i(e){var i=t.call(this,e)||this;return i.__parent=e,void 0===i.magnetismEnabled&&(i.magnetismEnabled=!1),i}return __extends(i,t),i.prototype.getMode=function(){return e.Mode.ROOM_CREATION_$LI$()},i.prototype.enter=function(){this.__parent.getView().setCursor(PlanView.CursorType.DRAW),this.toggleMagnetism(this.__parent.wasMagnetismToggledLastMousePress())},i.prototype.moveMouse=function(t,i){if(this.__parent.feedbackDisplayed&&this.magnetismEnabled){var n=new e.PointMagnetizedToClosestWallOrRoomPoint(this.__parent,t,i);if(n.isMagnetized())this.__parent.getView().setAlignmentFeedback(Room,null,n.getX(),n.getY(),n.isMagnetized());else{var o=new e.RoomPointWithAngleMagnetism(this.__parent,null,-1,this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove(),this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove());this.__parent.getView().setAlignmentFeedback(Room,null,o.getX(),o.getY(),n.isMagnetized())}}else this.__parent.getView().setAlignmentFeedback(Room,null,t,i,!1)},i.prototype.pressMouse=function(e,t,i,n,o){this.__parent.setState(this.__parent.getRoomDrawingState())},i.prototype.setEditionActivated=function(e){e&&(this.__parent.setState(this.__parent.getRoomDrawingState()),this.setEditionActivated(e))},i.prototype.toggleMagnetism=function(e){this.magnetismEnabled=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled()!==e,this.__parent.getPointerTypeLastMousePress()!==View.PointerType.TOUCH&&this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())},i.prototype.exit=function(){this.__parent.getView().deleteFeedback()},i}(e.AbstractModeChangeState);e.RoomCreationState=je,je.__class="com.eteks.sweethome3d.viewcontroller.PlanController.RoomCreationState";var Ke=function(t){function i(e){var i=t.call(this,e)||this;return i.__parent=e,i}return __extends(i,t),i.prototype.getMode=function(){return e.Mode.POLYLINE_CREATION_$LI$()},i.prototype.enter=function(){this.__parent.getView().setCursor(PlanView.CursorType.DRAW)},i.prototype.pressMouse=function(e,t,i,n,o){this.__parent.setState(this.__parent.getPolylineDrawingState())},i.prototype.setEditionActivated=function(e){e&&(this.__parent.setState(this.__parent.getPolylineDrawingState()),this.setEditionActivated(e))},i}(e.AbstractModeChangeState);e.PolylineCreationState=Ke,Ke.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PolylineCreationState";var Je=function(t){function i(e){var i=t.call(this,e)||this;return i.__parent=e,i}return __extends(i,t),i.prototype.getMode=function(){return e.Mode.LABEL_CREATION_$LI$()},i.prototype.enter=function(){this.__parent.getView().setCursor(PlanView.CursorType.DRAW)},i.prototype.pressMouse=function(e,t,i,n,o){this.__parent.createLabel(e,t),this.__parent.getPointerTypeLastMousePress()===View.PointerType.TOUCH&&this.__parent.setState(this.__parent.getSelectionState())},i}(e.AbstractModeChangeState);e.LabelCreationState=Je,Je.__class="com.eteks.sweethome3d.viewcontroller.PlanController.LabelCreationState";var qe=function(t){function i(e){var i=t.call(this,e)||this;return i.__parent=e,void 0===i.xStart&&(i.xStart=0),void 0===i.yStart&&(i.yStart=0),void 0===i.xLastEnd&&(i.xLastEnd=0),void 0===i.yLastEnd&&(i.yLastEnd=0),void 0===i.wallStartAtStart&&(i.wallStartAtStart=null),void 0===i.wallEndAtStart&&(i.wallEndAtStart=null),void 0===i.newWall&&(i.newWall=null),void 0===i.wallStartAtEnd&&(i.wallStartAtEnd=null),void 0===i.wallEndAtEnd&&(i.wallEndAtEnd=null),void 0===i.lastWall&&(i.lastWall=null),void 0===i.oldSelection&&(i.oldSelection=null),void 0===i.oldBasePlanLocked&&(i.oldBasePlanLocked=!1),void 0===i.oldAllLevelsSelection&&(i.oldAllLevelsSelection=!1),void 0===i.newWalls&&(i.newWalls=null),void 0===i.magnetismEnabled&&(i.magnetismEnabled=!1),void 0===i.alignmentActivated&&(i.alignmentActivated=!1),void 0===i.roundWall&&(i.roundWall=!1),void 0===i.lastWallCreationTime&&(i.lastWallCreationTime=0),void 0===i.wallArcExtent&&(i.wallArcExtent=null),i}return __extends(i,t),i.prototype.getMode=function(){return e.Mode.WALL_CREATION_$LI$()},i.prototype.isModificationState=function(){return!0},i.prototype.isBasePlanModificationState=function(){return!0},i.prototype.setMode=function(t){this.escape(),t===e.Mode.SELECTION_$LI$()?this.__parent.setState(this.__parent.getSelectionState()):t===e.Mode.PANNING_$LI$()?this.__parent.setState(this.__parent.getPanningState()):t===e.Mode.ROOM_CREATION_$LI$()?this.__parent.setState(this.__parent.getRoomCreationState()):t===e.Mode.POLYLINE_CREATION_$LI$()?this.__parent.setState(this.__parent.getPolylineCreationState()):t===e.Mode.DIMENSION_LINE_CREATION_$LI$()?this.__parent.setState(this.__parent.getDimensionLineCreationState()):t===e.Mode.LABEL_CREATION_$LI$()&&this.__parent.setState(this.__parent.getLabelCreationState())},i.prototype.enter=function(){if(t.prototype.enter.call(this),this.oldSelection=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems(),this.oldBasePlanLocked=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked(),this.oldAllLevelsSelection=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection(),this.alignmentActivated=this.__parent.wasAlignmentActivatedLastMousePress(),this.toggleMagnetism(this.__parent.wasMagnetismToggledLastMousePress()),this.xStart=this.__parent.getXLastMouseMove(),this.yStart=this.__parent.getYLastMouseMove(),this.wallEndAtStart=this.__parent.getWallEndAt(this.xStart,this.yStart,null),null!=this.wallEndAtStart)this.wallStartAtStart=null,this.xStart=this.wallEndAtStart.getXEnd(),this.yStart=this.wallEndAtStart.getYEnd();else if(this.wallStartAtStart=this.__parent.getWallStartAt(this.xStart,this.yStart,null),null!=this.wallStartAtStart)this.xStart=this.wallStartAtStart.getXStart(),this.yStart=this.wallStartAtStart.getYStart();else if(this.magnetismEnabled){var i=new e.WallPointWithAngleMagnetism(this.__parent,null,this.xStart,this.yStart,this.xStart,this.yStart);this.xStart=i.getX(),this.yStart=i.getY()}this.newWall=null,this.wallStartAtEnd=null,this.wallEndAtEnd=null,this.lastWall=null,this.newWalls=[],this.lastWallCreationTime=-1,this.__parent.deselectAll(),this.setDuplicationActivated(this.__parent.wasDuplicationActivatedLastMousePress()),this.__parent.feedbackDisplayed&&this.__parent.getView().setAlignmentFeedback(Wall,null,this.xStart,this.yStart,!1)},i.prototype.moveMouse=function(t,i){var n,o,r,l=this.__parent.getView();this.alignmentActivated?(n=(r=new e.PointWithAngleMagnetism(this.xStart,this.yStart,t,i,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit(),l.getPixelLength())).getX(),o=r.getY()):this.magnetismEnabled?(n=(r=new e.WallPointWithAngleMagnetism(this.__parent,this.newWall,this.xStart,this.yStart,t,i)).getX(),o=r.getY()):(n=t,o=i);null==this.newWall?(this.newWall=this.__parent.createWall(this.xStart,this.yStart,n,o,this.wallStartAtStart,this.wallEndAtStart),this.newWalls.push(this.newWall)):null!=this.wallArcExtent?(this.wallArcExtent=this.getArcExtent(this.newWall.getXStart(),this.newWall.getXEnd(),this.newWall.getYStart(),this.newWall.getYEnd(),t,i),(this.alignmentActivated||this.magnetismEnabled)&&(this.wallArcExtent=function(e){return e*Math.PI/180}(Math.round(180*this.wallArcExtent/Math.PI))),this.newWall.setArcExtent(this.wallArcExtent)):(this.newWall.setXEnd(n),this.newWall.setYEnd(o)),this.__parent.feedbackDisplayed&&(l.setToolTipFeedback(this.getToolTipFeedbackText(this.newWall,!1),t,i),l.setAlignmentFeedback(Wall,this.newWall,n,o,!1),this.showWallAngleFeedback(this.newWall,!1)),this.wallStartAtEnd=this.__parent.getWallStartAt(n,o,this.newWall),null!=this.wallStartAtEnd?(this.wallEndAtEnd=null,this.__parent.selectItem(this.wallStartAtEnd)):(this.wallEndAtEnd=this.__parent.getWallEndAt(n,o,this.newWall),null!=this.wallEndAtEnd?this.__parent.selectItem(this.wallEndAtEnd):this.__parent.deselectAll()),l.makePointVisible(t,i),this.xLastEnd=n,this.yLastEnd=o},i.prototype.pressMouse=function(e,t,i,n,o){if(2===i){var r=this.__parent.getSelectableItemAt(e,t);0===this.newWalls.length&&null!=r&&r instanceof Room?this.createWallsAroundRoom(r):(this.roundWall&&null!=this.newWall&&this.endWallCreation(),null!=this.lastWall&&this.__parent.joinNewWallEndToWall(this.lastWall,this.wallStartAtEnd,this.wallEndAtEnd)),this.validateDrawnWalls()}else null!=this.newWall&&this.newWall.getStartPointToEndPointDistance()>0&&(this.roundWall&&null==this.wallArcExtent?(this.wallArcExtent=Math.PI,this.newWall.setArcExtent(this.wallArcExtent),this.__parent.feedbackDisplayed&&this.__parent.getView().setToolTipFeedback(this.getToolTipFeedbackText(this.newWall,!1),e,t)):(this.__parent.getView().deleteToolTipFeedback(),this.__parent.selectItem(this.newWall),this.endWallCreation()))},i.prototype.createWallsAroundRoom=function(t){if(t.isSingular()){var n=t.getPoints(),o=n.slice(0).slice(0);t.isClockwise()||o.reverse();for(var r=0;r<o.length;){var l=o[r],a=o[(r+1)%o.length];l[0]===a[0]&&l[1]===a[1]?o.splice(r,1)[0]:r++}n=o.slice(0);var s=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getNewWallThickness()/2,h=function(e){for(var t=[];e-- >0;)t.push(null);return t}(n.length);for(r=0;r<n.length;r++){l=n[r];var u=n[(r+n.length-1)%n.length],d=(a=n[(r+1)%n.length],Math.atan2(l[0]-u[0],u[1]-l[1])),c=Math.cos(d)*s,p=Math.sin(d)*s,g=[u[0]-c,u[1]-p],m=[l[0]-c,l[1]-p],f=Math.atan2(a[0]-l[0],l[1]-a[1]);c=Math.cos(f)*s,p=Math.sin(f)*s;var v=[l[0]-c,l[1]-p],_=[a[0]-c,a[1]-p];h[r]=e.computeIntersection(g,m,v,_)}var S=null,y=this.__parent.getWallsArea(!1);for(r=0;r<h.length;r++){var E=h[r],C=h[(r+1)%n.length],P=new java.awt.geom.Area(this.__parent.getPath(new Wall(E[0],E[1],C[0],C[1],.05,0).getPoints$()));P.subtract(y);for(var w=this.__parent.getAreaPaths(P),L=[],T=0,A=0;A<w.length;A++){var I=this.__parent.getPathPoints(w[A],!1);if(I.length>4&&(I=this.__parent.getPathPoints(w[A],!0)),4===I.length){g=void 0,m=void 0;java.awt.geom.Point2D.distanceSq(I[0][0],I[0][1],I[1][0],I[1][1])<java.awt.geom.Point2D.distanceSq(I[0][0],I[0][1],I[3][0],I[3][1])?(g=[(I[0][0]+I[1][0])/2,(I[0][1]+I[1][1])/2],m=[(I[2][0]+I[3][0])/2,(I[2][1]+I[3][1])/2]):(g=[(I[0][0]+I[3][0])/2,(I[0][1]+I[3][1])/2],m=[(I[1][0]+I[2][0])/2,(I[1][1]+I[2][1])/2]);var b=void 0,O=void 0;java.awt.geom.Point2D.distanceSq(g[0],g[1],E[0],E[1])<java.awt.geom.Point2D.distanceSq(m[0],m[1],E[0],E[1])?(b=g,O=m):(b=m,O=g),java.awt.geom.Point2D.distanceSq(b[0],b[1],O[0],O[1])>.01?L.push(this.__parent.createWall(b[0],b[1],O[0],O[1],null,null!=S&&java.awt.geom.Point2D.distanceSq(S.getXEnd(),S.getYEnd(),b[0],b[1])<.01?S:null)):T++}}if(w.length>T&&0==L.length){for(var M=null,D=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getWalls(),R=0;R<D.length;R++){var F=D[R];if(F.isAtLevel(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel())&&Math.abs(F.getXStart()-E[0])<.05&&Math.abs(F.getYStart()-E[1])<.05&&Math.abs(F.getXEnd()-C[0])<.05&&Math.abs(F.getYEnd()-C[1])<.05&&(null==F.getArcExtent()||0===F.getArcExtent())){M=F;break}}null==M&&L.push(this.__parent.createWall(E[0],E[1],C[0],C[1],null,S))}L.length>0?(!function(e,t){t.compare?e.sort((function(e,i){return t.compare(e,i)})):e.sort(t)}(L,new i.WallDrawingState$0(this,E)),x=this.newWalls,N=L,x.push.apply(x,N),S=L[L.length-1]):S=null}null!=S&&java.awt.geom.Point2D.distanceSq(S.getXEnd(),S.getYEnd(),this.newWalls[0].getXStart(),this.newWalls[0].getYStart())<.01&&this.__parent.joinNewWallEndToWall(S,this.newWalls[0],null)}var x,N},i.prototype.validateDrawnWalls=function(){this.newWalls.length>0&&(this.__parent.postCreateWalls(this.newWalls,this.oldSelection,this.oldBasePlanLocked,this.oldAllLevelsSelection),this.__parent.selectItems(this.newWalls)),this.__parent.getPointerTypeLastMousePress()===View.PointerType.TOUCH?this.__parent.setState(this.__parent.getSelectionState()):this.__parent.setState(this.__parent.getWallCreationState())},i.prototype.endWallCreation=function(){this.lastWall=this.wallEndAtStart=this.newWall,this.wallStartAtStart=null,this.xStart=this.newWall.getXEnd(),this.yStart=this.newWall.getYEnd(),this.newWall=null,this.wallArcExtent=null},i.prototype.setEditionActivated=function(e){var t,i=this,n=this.__parent.getView();if(e)n.deleteFeedback(),0===this.newWalls.length&&null==this.wallEndAtStart&&null==this.wallStartAtStart?n.setToolTipEditedProperties(["X","Y"],[this.xStart,this.yStart],this.xStart,this.yStart):(null==this.newWall&&this.createNextWall(),null==this.wallArcExtent?n.setToolTipEditedProperties(["LENGTH","ANGLE","THICKNESS"],[this.newWall.getLength(),this.getWallAngleInDegrees$com_eteks_sweethome3d_model_Wall(this.newWall),this.newWall.getThickness()],this.newWall.getXEnd(),this.newWall.getYEnd()):n.setToolTipEditedProperties(["ARC_EXTENT"],[new Number(0|Math.round((t=this.wallArcExtent,180*t/Math.PI))).valueOf()],this.newWall.getXEnd(),this.newWall.getYEnd())),this.__parent.feedbackDisplayed&&this.showWallFeedback();else if(null==this.newWall){var o=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().isMetric()?LengthUnit.footToCentimeter(10):300;this.xLastEnd=this.xStart+o,this.yLastEnd=this.yStart,this.newWall=this.__parent.createWall(this.xStart,this.yStart,this.xLastEnd,this.yLastEnd,this.wallStartAtStart,this.wallEndAtStart),this.newWalls.push(this.newWall),n.deleteFeedback(),this.setEditionActivated(!0)}else if(this.roundWall&&null==this.wallArcExtent)this.wallArcExtent=Math.PI,this.newWall.setArcExtent(this.wallArcExtent),this.setEditionActivated(!0);else if(Date.now()-this.lastWallCreationTime<300)this.newWalls.length>1&&(!function(e){var t=e.indexOf(i.newWall);t>=0&&e.splice(t,1)}(this.newWalls),this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.deleteWall(this.newWall)),this.validateDrawnWalls();else{if(this.endWallCreation(),this.newWalls.length>2&&null!=this.wallStartAtEnd)return this.__parent.joinNewWallEndToWall(this.lastWall,this.wallStartAtEnd,null),void this.validateDrawnWalls();this.createNextWall(),n.deleteToolTipFeedback(),this.setEditionActivated(!0)}},i.prototype.createNextWall=function(){var e=null!=this.wallEndAtStart?this.wallEndAtStart:this.wallStartAtStart,t=Math.PI-Math.atan2(e.getYStart()-e.getYEnd(),e.getXStart()-e.getXEnd());t-=Math.PI/2;var i=e.getStartPointToEndPointDistance();this.xLastEnd=this.xStart+i*Math.cos(t),this.yLastEnd=this.yStart-i*Math.sin(t),this.newWall=this.__parent.createWall(this.xStart,this.yStart,this.xLastEnd,this.yLastEnd,this.wallStartAtStart,e),this.newWall.setThickness(e.getThickness()),this.newWalls.push(this.newWall),this.lastWallCreationTime=Date.now(),this.__parent.deselectAll()},i.prototype.updateEditableProperty=function(e,t){if(null==this.newWall){var i=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMaximumLength();switch(e){case"X":this.xStart=null!=t?t:0,this.xStart=Math.max(-i,Math.min(this.xStart,i));break;case"Y":this.yStart=null!=t?t:0,this.yStart=Math.max(-i,Math.min(this.yStart,i))}}else if("THICKNESS"===e){var n=null!=t?Math.abs(t):0;n=Math.max(.01,Math.min(n,1e3)),this.newWall.setThickness(n)}else{if("ARC_EXTENT"===e){var o=(null!=t?t:0)*Math.PI/180;return this.wallArcExtent=function(e){return e>0?1:e<0?-1:0}(o)*Math.min(Math.abs(o),3*Math.PI/2),this.newWall.setArcExtent(this.wallArcExtent),void(this.__parent.feedbackDisplayed&&this.showWallAngleFeedback(this.newWall,!1))}switch(e){case"LENGTH":var r=null!=t?t:0;r=Math.max(.001,Math.min(r,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMaximumLength()));var l=Math.PI-Math.atan2(this.yStart-this.yLastEnd,this.xStart-this.xLastEnd);this.xLastEnd=this.xStart+r*Math.cos(l),this.yLastEnd=this.yStart-r*Math.sin(l);break;case"ANGLE":l=function(e){return e*Math.PI/180}(null!=t?t:0);var a=this.newWall.getWallAtStart();null!=a&&a.getStartPointToEndPointDistance()>0&&(l-=Math.atan2(a.getYStart()-a.getYEnd(),a.getXStart()-a.getXEnd()));var s=this.newWall.getStartPointToEndPointDistance();this.xLastEnd=this.xStart+s*Math.cos(l),this.yLastEnd=this.yStart-s*Math.sin(l);break;default:return}this.newWall.setXEnd(this.xLastEnd),this.newWall.setYEnd(this.yLastEnd)}this.__parent.feedbackDisplayed&&this.showWallFeedback()},i.prototype.showWallFeedback=function(){var e=this.__parent.getView();null==this.newWall?(e.setAlignmentFeedback(Wall,null,this.xStart,this.yStart,!0),e.makePointVisible(this.xStart,this.yStart)):(e.setAlignmentFeedback(Wall,this.newWall,this.xLastEnd,this.yLastEnd,!1),this.showWallAngleFeedback(this.newWall,!1),e.makePointVisible(this.xStart,this.yStart),e.makePointVisible(this.xLastEnd,this.yLastEnd),this.newWalls.length>2&&null==this.newWalls[0].getWallAtStart()&&this.newWalls[0].containsWallStartAt(this.xLastEnd,this.yLastEnd,.001)?(this.wallStartAtEnd=this.newWalls[0],this.__parent.selectItem(this.wallStartAtEnd)):(this.wallStartAtEnd=null,this.__parent.deselectAll()))},i.prototype.toggleMagnetism=function(e){this.magnetismEnabled=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled()!==e,null!=this.newWall&&this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())},i.prototype.setAlignmentActivated=function(e){this.alignmentActivated=e,this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())},i.prototype.setDuplicationActivated=function(e){this.roundWall=e},i.prototype.escape=function(){var e,t,i=this;null!=this.newWall&&(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.deleteWall(this.newWall),e=this.newWalls,(t=e.indexOf(i.newWall))>=0&&e.splice(t,1)),this.validateDrawnWalls()},i.prototype.exit=function(){this.__parent.getView().deleteFeedback(),this.wallStartAtStart=null,this.wallEndAtStart=null,this.newWall=null,this.wallArcExtent=null,this.wallStartAtEnd=null,this.wallEndAtEnd=null,this.lastWall=null,this.oldSelection=null,this.newWalls=null},i}(e.AbstractWallState);e.WallDrawingState=qe,qe.__class="com.eteks.sweethome3d.viewcontroller.PlanController.WallDrawingState",function(e){var t=function(){function e(e,t){this.sidePoint=t,this.__parent=e}return e.prototype.compare=function(e,t){return java.awt.geom.Point2D.distanceSq(e.getXStart(),e.getYStart(),this.sidePoint[0],this.sidePoint[1])-java.awt.geom.Point2D.distanceSq(t.getXStart(),t.getYStart(),this.sidePoint[0],this.sidePoint[1])},e}();e.WallDrawingState$0=t}(qe=e.WallDrawingState||(e.WallDrawingState={}));var Ze=function(t){function i(e){var i=t.call(this,e)||this;return i.__parent=e,void 0===i.selectedWall&&(i.selectedWall=null),void 0===i.startPoint&&(i.startPoint=!1),void 0===i.oldX&&(i.oldX=0),void 0===i.oldY&&(i.oldY=0),void 0===i.deltaXToResizePoint&&(i.deltaXToResizePoint=0),void 0===i.deltaYToResizePoint&&(i.deltaYToResizePoint=0),void 0===i.magnetismEnabled&&(i.magnetismEnabled=!1),void 0===i.alignmentActivated&&(i.alignmentActivated=!1),i}return __extends(i,t),i.prototype.getMode=function(){return e.Mode.SELECTION_$LI$()},i.prototype.isModificationState=function(){return!0},i.prototype.isBasePlanModificationState=function(){return!0},i.prototype.enter=function(){t.prototype.enter.call(this),this.selectedWall=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0],this.startPoint=this.selectedWall===this.__parent.getResizedWallStartAt(this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress()),this.startPoint?(this.oldX=this.selectedWall.getXStart(),this.oldY=this.selectedWall.getYStart()):(this.oldX=this.selectedWall.getXEnd(),this.oldY=this.selectedWall.getYEnd()),this.deltaXToResizePoint=this.__parent.getXLastMousePress()-this.oldX,this.deltaYToResizePoint=this.__parent.getYLastMousePress()-this.oldY,this.alignmentActivated=this.__parent.wasAlignmentActivatedLastMousePress(),this.toggleMagnetism(this.__parent.wasMagnetismToggledLastMousePress());var e=this.__parent.getView();e.setResizeIndicatorVisible(!0),this.__parent.feedbackDisplayed&&(e.setToolTipFeedback(this.getToolTipFeedbackText(this.selectedWall,!0),this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress()),e.setAlignmentFeedback(Wall,this.selectedWall,this.oldX,this.oldY,!1),this.showWallAngleFeedback(this.selectedWall,!0),e.setDimensionLinesFeedback(this.getDimensionLinesAlongWall(this.selectedWall)))},i.prototype.moveMouse=function(t,i){var n,o=this.__parent.getView(),r=t-this.deltaXToResizePoint,l=i-this.deltaYToResizePoint,a=this.startPoint?this.selectedWall.getXEnd():this.selectedWall.getXStart(),s=this.startPoint?this.selectedWall.getYEnd():this.selectedWall.getYStart();this.alignmentActivated?(r=(n=new e.PointWithAngleMagnetism(a,s,r,l,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit(),o.getPixelLength())).getX(),l=n.getY()):this.magnetismEnabled&&(r=(n=new e.WallPointWithAngleMagnetism(this.__parent,this.selectedWall,a,s,r,l)).getX(),l=n.getY());e.moveWallPoint(this.selectedWall,r,l,this.startPoint),this.__parent.feedbackDisplayed&&(o.setToolTipFeedback(this.getToolTipFeedbackText(this.selectedWall,!0),t,i),o.setAlignmentFeedback(Wall,this.selectedWall,r,l,!1),this.showWallAngleFeedback(this.selectedWall,!0),o.setDimensionLinesFeedback(this.getDimensionLinesAlongWall(this.selectedWall))),o.makePointVisible(t,i)},i.prototype.getDimensionLinesAlongWall=function(e){var t=[];if(null==e.getArcExtent()||0===e.getArcExtent()){for(var i=20/this.__parent.getView().getScale(),n=e.getPoints$(),o=this.__parent.getRoomPathsFromWalls(),r=0;r<o.length;r++)for(var l=this.__parent.getPathPoints(o[r],!0),a=0;a<l.length;a++){var s=l[a],h=l[(a+1)%l.length];(java.awt.geom.Line2D.ptLineDistSq(n[0][0],n[0][1],n[1][0],n[1][1],s[0],s[1])<1e-4&&java.awt.geom.Line2D.ptLineDistSq(n[0][0],n[0][1],n[1][0],n[1][1],h[0],h[1])<1e-4?java.awt.geom.Line2D.ptSegDistSq(n[0][0],n[0][1],n[1][0],n[1][1],s[0],s[1])<1e-4||java.awt.geom.Line2D.ptSegDistSq(n[0][0],n[0][1],n[1][0],n[1][1],h[0],h[1])<1e-4||java.awt.geom.Line2D.ptSegDistSq(s[0],s[1],h[0],h[1],n[0][0],n[0][1])<1e-4||java.awt.geom.Line2D.ptSegDistSq(s[0],s[1],h[0],h[1],n[1][0],n[1][1])<1e-4:java.awt.geom.Line2D.ptLineDistSq(n[2][0],n[2][1],n[3][0],n[3][1],s[0],s[1])<1e-4&&java.awt.geom.Line2D.ptLineDistSq(n[2][0],n[2][1],n[3][0],n[3][1],h[0],h[1])<1e-4&&(java.awt.geom.Line2D.ptSegDistSq(n[2][0],n[2][1],n[3][0],n[3][1],s[0],s[1])<1e-4||java.awt.geom.Line2D.ptSegDistSq(n[2][0],n[2][1],n[3][0],n[3][1],h[0],h[1])<1e-4||java.awt.geom.Line2D.ptSegDistSq(s[0],s[1],h[0],h[1],n[2][0],n[2][1])<1e-4||java.awt.geom.Line2D.ptSegDistSq(s[0],s[1],h[0],h[1],n[3][0],n[3][1])<1e-4))&&t.push(this.__parent.getDimensionLineBetweenPoints(s,h,this.isDimensionInsideWall(e,s,h)?-i:i,!1))}for(r=t.length-1;r>=0;r--)t[r].getLength()<.01&&t.splice(r,1)[0];2===t.length&&Math.abs(t[0].getLength()-t[1].getLength())<.01&&t.splice(1,1)[0]}return t},i.prototype.isDimensionInsideWall=function(e,t,i){var n=java.awt.geom.AffineTransform.getRotateInstance(Math.atan2(i[1]-t[1],i[0]-t[0]),t[0],t[1]),o=[t[0]+java.awt.geom.Point2D.distance(t[0],t[1],i[0],i[1])/2,t[1]+.01];return n.transform(o,0,o,0,1),e.containsPoint$float$float$float(o[0],o[1],0)},i.prototype.releaseMouse=function(e,t){this.__parent.postWallResize(this.selectedWall,this.oldX,this.oldY,this.startPoint),this.__parent.setState(this.__parent.getSelectionState())},i.prototype.toggleMagnetism=function(e){this.magnetismEnabled=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled()!==e,this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())},i.prototype.setAlignmentActivated=function(e){this.alignmentActivated=e,this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())},i.prototype.escape=function(){e.moveWallPoint(this.selectedWall,this.oldX,this.oldY,this.startPoint),this.__parent.setState(this.__parent.getSelectionState())},i.prototype.exit=function(){var e=this.__parent.getView();e.setResizeIndicatorVisible(!1),e.deleteFeedback(),this.selectedWall=null},i}(e.AbstractWallState);e.WallResizeState=Ze,Ze.__class="com.eteks.sweethome3d.viewcontroller.PlanController.WallResizeState";var Qe=function(t){function i(e){var i=t.call(this,e)||this;return i.__parent=e,void 0===i.selectedWall&&(i.selectedWall=null),void 0===i.oldArcExtent&&(i.oldArcExtent=null),void 0===i.deltaXToMiddlePoint&&(i.deltaXToMiddlePoint=0),void 0===i.deltaYToMiddlePoint&&(i.deltaYToMiddlePoint=0),void 0===i.magnetismEnabled&&(i.magnetismEnabled=!1),void 0===i.alignmentActivated&&(i.alignmentActivated=!1),i}return __extends(i,t),i.prototype.getMode=function(){return e.Mode.SELECTION_$LI$()},i.prototype.isModificationState=function(){return!0},i.prototype.isBasePlanModificationState=function(){return!0},i.prototype.enter=function(){t.prototype.enter.call(this),this.selectedWall=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0],this.oldArcExtent=this.selectedWall.getArcExtent();var e=this.selectedWall.getPoints$(),i=e.length/4|0,n=e.length-1-i;e.length%4==0&&i--;var o=(e[i][0]+e[n][0])/2,r=(e[i][1]+e[n][1])/2;this.deltaXToMiddlePoint=this.__parent.getXLastMousePress()-o,this.deltaYToMiddlePoint=this.__parent.getYLastMousePress()-r,this.alignmentActivated=this.__parent.wasAlignmentActivatedLastMousePress(),this.magnetismEnabled=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled()!==this.__parent.wasMagnetismToggledLastMousePress();var l=this.__parent.getView();l.setResizeIndicatorVisible(!0),this.__parent.feedbackDisplayed&&(l.setToolTipFeedback(this.getToolTipFeedbackText(this.selectedWall,!1),this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress()),this.showWallAngleFeedback(this.selectedWall,!1))},i.prototype.moveMouse=function(e,t){var i=this.__parent.getView(),n=e-this.deltaXToMiddlePoint,o=t-this.deltaYToMiddlePoint,r=this.getArcExtent(this.selectedWall.getXStart(),this.selectedWall.getYStart(),this.selectedWall.getXEnd(),this.selectedWall.getYEnd(),n,o);(this.alignmentActivated||this.magnetismEnabled)&&(r=function(e){return e*Math.PI/180}(Math.round(180*r/Math.PI))),this.selectedWall.setArcExtent(r),this.__parent.feedbackDisplayed&&(i.setToolTipFeedback(this.getToolTipFeedbackText(this.selectedWall,!1),e,t),this.showWallAngleFeedback(this.selectedWall,!1)),i.makePointVisible(e,t)},i.prototype.releaseMouse=function(e,t){this.__parent.postWallArcExtent(this.selectedWall,this.oldArcExtent),this.__parent.setState(this.__parent.getSelectionState())},i.prototype.toggleMagnetism=function(e){this.magnetismEnabled=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled()!==e,this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())},i.prototype.setAlignmentActivated=function(e){this.alignmentActivated=e,this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())},i.prototype.escape=function(){this.selectedWall.setArcExtent(this.oldArcExtent),this.__parent.setState(this.__parent.getSelectionState())},i.prototype.exit=function(){var e=this.__parent.getView();e.setResizeIndicatorVisible(!1),e.deleteFeedback(),this.selectedWall=null},i}(e.AbstractWallState);e.WallArcExtentState=Qe,Qe.__class="com.eteks.sweethome3d.viewcontroller.PlanController.WallArcExtentState";var et=function(t){function i(e){var i=t.call(this,e)||this;return i.__parent=e,void 0===i.xPreviousPoint&&(i.xPreviousPoint=0),void 0===i.yPreviousPoint&&(i.yPreviousPoint=0),void 0===i.newRoom&&(i.newRoom=null),void 0===i.newPoint&&(i.newPoint=null),void 0===i.oldSelection&&(i.oldSelection=null),void 0===i.oldBasePlanLocked&&(i.oldBasePlanLocked=!1),void 0===i.oldAllLevelsSelection&&(i.oldAllLevelsSelection=!1),void 0===i.magnetismEnabled&&(i.magnetismEnabled=!1),void 0===i.alignmentActivated&&(i.alignmentActivated=!1),void 0===i.lastPointCreationTime&&(i.lastPointCreationTime=0),i}return __extends(i,t),i.prototype.getMode=function(){return e.Mode.ROOM_CREATION_$LI$()},i.prototype.isModificationState=function(){return!0},i.prototype.isBasePlanModificationState=function(){return!0},i.prototype.setMode=function(t){this.escape(),t===e.Mode.SELECTION_$LI$()?this.__parent.setState(this.__parent.getSelectionState()):t===e.Mode.PANNING_$LI$()?this.__parent.setState(this.__parent.getPanningState()):t===e.Mode.WALL_CREATION_$LI$()?this.__parent.setState(this.__parent.getWallCreationState()):t===e.Mode.POLYLINE_CREATION_$LI$()?this.__parent.setState(this.__parent.getPolylineCreationState()):t===e.Mode.DIMENSION_LINE_CREATION_$LI$()?this.__parent.setState(this.__parent.getDimensionLineCreationState()):t===e.Mode.LABEL_CREATION_$LI$()&&this.__parent.setState(this.__parent.getLabelCreationState())},i.prototype.enter=function(){if(t.prototype.enter.call(this),this.oldSelection=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems(),this.oldBasePlanLocked=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked(),this.oldAllLevelsSelection=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection(),this.newRoom=null,this.alignmentActivated=this.__parent.wasAlignmentActivatedLastMousePress(),this.toggleMagnetism(this.__parent.wasMagnetismToggledLastMousePress()),this.magnetismEnabled){var i=new e.PointMagnetizedToClosestWallOrRoomPoint(this.__parent,this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove());if(i.isMagnetized())this.xPreviousPoint=i.getX(),this.yPreviousPoint=i.getY();else{var n=new e.RoomPointWithAngleMagnetism(this.__parent,null,-1,this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove(),this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove());this.xPreviousPoint=n.getX(),this.yPreviousPoint=n.getY()}this.__parent.feedbackDisplayed&&this.__parent.getView().setAlignmentFeedback(Room,null,this.xPreviousPoint,this.yPreviousPoint,i.isMagnetized())}else this.xPreviousPoint=this.__parent.getXLastMousePress(),this.yPreviousPoint=this.__parent.getYLastMousePress(),this.__parent.feedbackDisplayed&&this.__parent.getView().setAlignmentFeedback(Room,null,this.xPreviousPoint,this.yPreviousPoint,!1);this.__parent.deselectAll()},i.prototype.moveMouse=function(t,i){var n=this.__parent.getView(),o=t,r=i,l=!1;if(this.alignmentActivated)o=(s=new e.PointWithAngleMagnetism(this.xPreviousPoint,this.yPreviousPoint,t,i,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit(),n.getPixelLength())).getX(),r=s.getY();else if(this.magnetismEnabled){var a=null!=this.newRoom?new e.PointMagnetizedToClosestWallOrRoomPoint(this.__parent,this.newRoom,this.newRoom.getPointCount()-1,t,i):new e.PointMagnetizedToClosestWallOrRoomPoint(this.__parent,t,i);if(l=a.isMagnetized())o=a.getX(),r=a.getY();else{var s,h=null!=this.newRoom?this.newRoom.getPointCount()-1:-1;o=(s=new e.RoomPointWithAngleMagnetism(this.__parent,this.newRoom,h,this.xPreviousPoint,this.yPreviousPoint,t,i)).getX(),r=s.getY()}}if(null==this.newRoom)this.newRoom=this.createAndSelectRoom(this.xPreviousPoint,this.yPreviousPoint,o,r);else if(null!=this.newPoint){var u=this.newRoom.getPoints();this.xPreviousPoint=u[u.length-1][0],this.yPreviousPoint=u[u.length-1][1],this.newRoom.addPoint$float$float(o,r),this.newPoint=null}else this.newRoom.setPoint(o,r,this.newRoom.getPointCount()-1);this.__parent.feedbackDisplayed&&(n.setToolTipFeedback(this.getToolTipFeedbackText(this.newRoom,this.newRoom.getPointCount()-1),t,i),n.setAlignmentFeedback(Room,this.newRoom,o,r,l),this.showRoomAngleFeedback(this.newRoom,this.newRoom.getPointCount()-1),n.setDimensionLinesFeedback(this.getTriangulationDimensionLines(this.newRoom,this.newRoom.getPointCount()-1))),n.makePointVisible(t,i)},i.prototype.createAndSelectRoom=function(e,t,i,n){var o=this.__parent.createRoom([[e,t],[i,n]]),r=this.__parent.getInsideWallsArea();return o.setCeilingVisible(r.contains(e,t)),this.__parent.selectItem(o),o},i.prototype.pressMouse=function(e,t,i,n,o){if(2===i){if(null==this.newRoom){var r=this.__parent.computeRoomPointsAt(e,t);null!=r&&(this.newRoom=this.__parent.createRoom(r),this.__parent.selectItem(this.newRoom))}this.validateDrawnRoom()}else this.endRoomSide()},i.prototype.validateDrawnRoom=function(){null!=this.newRoom&&(this.newRoom.getPoints().length<3?this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.deleteRoom(this.newRoom):this.__parent.postCreateRooms([this.newRoom].slice(0),this.oldSelection,this.oldBasePlanLocked,this.oldAllLevelsSelection));this.__parent.getPointerTypeLastMousePress()===View.PointerType.TOUCH?this.__parent.setState(this.__parent.getSelectionState()):this.__parent.setState(this.__parent.getRoomCreationState())},i.prototype.endRoomSide=function(){if(null!=this.newRoom&&this.getRoomSideLength(this.newRoom,this.newRoom.getPointCount()-1)>0&&(this.newPoint=[0,0],this.newRoom.isCeilingVisible())){var e=this.newRoom.getPoints(),t=e[e.length-1];this.__parent.getInsideWallsArea().contains(t[0],t[1])||this.newRoom.setCeilingVisible(!1)}},i.prototype.setEditionActivated=function(e){var t=this.__parent.getView();if(e){if(t.deleteFeedback(),null==this.newRoom)t.setToolTipEditedProperties(["X","Y"],[this.xPreviousPoint,this.yPreviousPoint],this.xPreviousPoint,this.yPreviousPoint);else null!=this.newPoint&&this.createNextSide(),(n=this.newRoom.getPoints()).length>2?t.setToolTipEditedProperties(["LENGTH","DIAGONAL","ANGLE"],[this.getRoomSideLength(this.newRoom,n.length-1),this.getRoomDiagonalLength(this.newRoom,n.length-1),this.getRoomSideAngle(this.newRoom,n.length-1)],n[n.length-1][0],n[n.length-1][1]):t.setToolTipEditedProperties(["LENGTH","ANGLE"],[this.getRoomSideLength(this.newRoom,n.length-1),this.getRoomSideAngle(this.newRoom,n.length-1)],n[n.length-1][0],n[n.length-1][1]);this.showRoomFeedback()}else if(null==this.newRoom){var i=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().isMetric()?300:LengthUnit.footToCentimeter(10);this.newRoom=this.createAndSelectRoom(this.xPreviousPoint,this.yPreviousPoint,this.xPreviousPoint+i,this.yPreviousPoint),t.deleteFeedback(),this.setEditionActivated(!0)}else if(Date.now()-this.lastPointCreationTime<300)this.escape();else{var n;if(this.endRoomSide(),(n=this.newRoom.getPoints()).length>2&&0===this.newRoom.getPointIndexAt(n[n.length-1][0],n[n.length-1][1],.001))return this.newRoom.removePoint(this.newRoom.getPointCount()-1),void this.validateDrawnRoom();this.createNextSide(),t.deleteToolTipFeedback(),this.setEditionActivated(!0)}},i.prototype.createNextSide=function(){var e=this.newRoom.getPoints();this.xPreviousPoint=e[e.length-1][0],this.yPreviousPoint=e[e.length-1][1];var t=Math.PI-Math.atan2(e[e.length-2][1]-e[e.length-1][1],e[e.length-2][0]-e[e.length-1][0]);t-=Math.PI/2;var i=this.getRoomSideLength(this.newRoom,e.length-1);this.newRoom.addPoint$float$float(this.xPreviousPoint+i*Math.cos(t),this.yPreviousPoint-i*Math.sin(t)),this.newPoint=null,this.lastPointCreationTime=Date.now()},i.prototype.updateEditableProperty=function(e,t){if(null==this.newRoom){var i=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMaximumLength();switch(e){case"X":this.xPreviousPoint=null!=t?t:0,this.xPreviousPoint=Math.max(-i,Math.min(this.xPreviousPoint,i));break;case"Y":this.yPreviousPoint=null!=t?t:0,this.yPreviousPoint=Math.max(-i,Math.min(this.yPreviousPoint,i))}}else{var n=this.__parent.getView(),o=this.newRoom.getPoints(),r=o[o.length-2],l=o[o.length-1];switch(e){case"LENGTH":var a=null!=t?t:0;a=Math.max(.001,Math.min(a,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMaximumLength()));var s=Math.PI-Math.atan2(r[1]-l[1],r[0]-l[0]),h=r[0]+a*Math.cos(s),u=r[1]-a*Math.sin(s);this.newRoom.setPoint(h,u,o.length-1),o.length>2&&n.setToolTipEditedPropertyValue("DIAGONAL",this.getRoomDiagonalLength(this.newRoom,o.length-1));break;case"DIAGONAL":var d=null!=t?t:0;a=this.getRoomSideLength(this.newRoom,o.length-1);var c=this.getRoomSideLength(this.newRoom,o.length-2);if(d>=a&&d<=a+c){var p=(a*a+c*c-d*d)/(2*a*c);s=((g=this.getRoomSideAngle(this.newRoom,o.length-1))>0?1:g<0?-1:0)*Math.acos(p),s-=Math.atan2(o[o.length-3][1]-r[1],o[o.length-3][0]-r[0]),h=r[0]+a*Math.cos(s),u=r[1]-a*Math.sin(s),this.newRoom.setPoint(h,u,o.length-1),n.setToolTipEditedPropertyValue("ANGLE",this.getRoomSideAngle(this.newRoom,o.length-1))}break;case"ANGLE":s=function(e){return e*Math.PI/180}(null!=t?t:0),o.length>2&&(s-=Math.atan2(o[o.length-3][1]-r[1],o[o.length-3][0]-r[0])),a=this.getRoomSideLength(this.newRoom,o.length-1),h=r[0]+a*Math.cos(s),u=r[1]-a*Math.sin(s),this.newRoom.setPoint(h,u,o.length-1),o.length>2&&n.setToolTipEditedPropertyValue("DIAGONAL",this.getRoomDiagonalLength(this.newRoom,o.length-1));break;default:return}}var g;this.showRoomFeedback()},i.prototype.showRoomFeedback=function(){var e=this.__parent.getView();if(null==this.newRoom)this.__parent.feedbackDisplayed&&e.setAlignmentFeedback(Room,null,this.xPreviousPoint,this.yPreviousPoint,!0),e.makePointVisible(this.xPreviousPoint,this.yPreviousPoint);else{var t=this.newRoom.getPoints(),i=t[t.length-1];this.__parent.feedbackDisplayed&&(e.setAlignmentFeedback(Room,this.newRoom,i[0],i[1],!1),this.showRoomAngleFeedback(this.newRoom,t.length-1),e.setDimensionLinesFeedback(this.getTriangulationDimensionLines(this.newRoom,t.length-1)));var n=t[t.length-2];e.makePointVisible(n[0],n[1]),e.makePointVisible(i[0],i[1])}},i.prototype.toggleMagnetism=function(e){this.magnetismEnabled=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled()!==e,null!=this.newRoom&&this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())},i.prototype.setAlignmentActivated=function(e){this.alignmentActivated=e,this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())},i.prototype.escape=function(){null!=this.newRoom&&null==this.newPoint&&this.newRoom.removePoint(this.newRoom.getPointCount()-1),this.validateDrawnRoom()},i.prototype.exit=function(){this.__parent.getView().deleteFeedback(),this.newRoom=null,this.newPoint=null,this.oldSelection=null},i}(e.AbstractRoomState);e.RoomDrawingState=et,et.__class="com.eteks.sweethome3d.viewcontroller.PlanController.RoomDrawingState";var tt=function(t){function i(e){var i=t.call(this,e)||this;return i.__parent=e,void 0===i.selectedRoom&&(i.selectedRoom=null),void 0===i.roomPointIndex&&(i.roomPointIndex=0),void 0===i.oldX&&(i.oldX=0),void 0===i.oldY&&(i.oldY=0),void 0===i.deltaXToResizePoint&&(i.deltaXToResizePoint=0),void 0===i.deltaYToResizePoint&&(i.deltaYToResizePoint=0),void 0===i.magnetismEnabled&&(i.magnetismEnabled=!1),void 0===i.alignmentActivated&&(i.alignmentActivated=!1),i}return __extends(i,t),i.prototype.getMode=function(){return e.Mode.SELECTION_$LI$()},i.prototype.isModificationState=function(){return!0},i.prototype.isBasePlanModificationState=function(){return!0},i.prototype.enter=function(){t.prototype.enter.call(this),this.selectedRoom=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0];var e=this.__parent.getIndicatorMargin();this.roomPointIndex=this.selectedRoom.getPointIndexAt(this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress(),e);var i=this.selectedRoom.getPoints();this.oldX=i[this.roomPointIndex][0],this.oldY=i[this.roomPointIndex][1],this.deltaXToResizePoint=this.__parent.getXLastMousePress()-this.oldX,this.deltaYToResizePoint=this.__parent.getYLastMousePress()-this.oldY,this.alignmentActivated=this.__parent.wasAlignmentActivatedLastMousePress(),this.toggleMagnetism(this.__parent.wasMagnetismToggledLastMousePress());var n=this.__parent.getView();n.setResizeIndicatorVisible(!0),this.__parent.feedbackDisplayed&&(n.setToolTipFeedback(this.getToolTipFeedbackText(this.selectedRoom,this.roomPointIndex),this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress()),this.showRoomAngleFeedback(this.selectedRoom,this.roomPointIndex),n.setDimensionLinesFeedback(this.getTriangulationDimensionLines(this.selectedRoom,this.roomPointIndex)))},i.prototype.moveMouse=function(t,i){var n=this.__parent.getView(),o=t-this.deltaXToResizePoint,r=i-this.deltaYToResizePoint,l=this.selectedRoom.getPoints(),a=0===this.roomPointIndex?l.length-1:this.roomPointIndex-1,s=l[a][0],h=l[a][1],u=!1;if(this.alignmentActivated)o=(d=new e.PointWithAngleMagnetism(s,h,o,r,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit(),n.getPixelLength())).getX(),r=d.getY();else if(this.magnetismEnabled){var d,c=new e.PointMagnetizedToClosestWallOrRoomPoint(this.__parent,this.selectedRoom,this.roomPointIndex,o,r);if(u=c.isMagnetized())o=c.getX(),r=c.getY();else o=(d=new e.RoomPointWithAngleMagnetism(this.__parent,this.selectedRoom,this.roomPointIndex,s,h,o,r)).getX(),r=d.getY()}e.moveRoomPoint(this.selectedRoom,o,r,this.roomPointIndex),this.__parent.feedbackDisplayed&&(n.setToolTipFeedback(this.getToolTipFeedbackText(this.selectedRoom,this.roomPointIndex),t,i),n.setAlignmentFeedback(Room,this.selectedRoom,o,r,u),this.showRoomAngleFeedback(this.selectedRoom,this.roomPointIndex),n.setDimensionLinesFeedback(this.getTriangulationDimensionLines(this.selectedRoom,this.roomPointIndex))),n.makePointVisible(t,i)},i.prototype.releaseMouse=function(e,t){this.__parent.postRoomResize(this.selectedRoom,this.oldX,this.oldY,this.roomPointIndex),this.__parent.setState(this.__parent.getSelectionState())},i.prototype.toggleMagnetism=function(e){this.magnetismEnabled=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled()!==e,this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())},i.prototype.setAlignmentActivated=function(e){this.alignmentActivated=e,this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())},i.prototype.escape=function(){e.moveRoomPoint(this.selectedRoom,this.oldX,this.oldY,this.roomPointIndex),this.__parent.setState(this.__parent.getSelectionState())},i.prototype.exit=function(){var e=this.__parent.getView();e.setResizeIndicatorVisible(!1),e.deleteFeedback(),this.selectedRoom=null},i}(e.AbstractRoomState);e.RoomResizeState=tt,tt.__class="com.eteks.sweethome3d.viewcontroller.PlanController.RoomResizeState";var it=function(t){function i(e){var i=t.call(this,e)||this;return i.__parent=e,void 0===i.xPreviousPoint&&(i.xPreviousPoint=0),void 0===i.yPreviousPoint&&(i.yPreviousPoint=0),void 0===i.newPolyline&&(i.newPolyline=null),void 0===i.newPoint&&(i.newPoint=null),void 0===i.oldSelection&&(i.oldSelection=null),void 0===i.oldBasePlanLocked&&(i.oldBasePlanLocked=!1),void 0===i.oldAllLevelsSelection&&(i.oldAllLevelsSelection=!1),void 0===i.magnetismEnabled&&(i.magnetismEnabled=!1),void 0===i.alignmentActivated&&(i.alignmentActivated=!1),void 0===i.curvedPolyline&&(i.curvedPolyline=!1),void 0===i.lastPointCreationTime&&(i.lastPointCreationTime=0),i}return __extends(i,t),i.prototype.getMode=function(){return e.Mode.POLYLINE_CREATION_$LI$()},i.prototype.isModificationState=function(){return!0},i.prototype.isBasePlanModificationState=function(){return!0},i.prototype.setMode=function(t){this.escape(),t===e.Mode.SELECTION_$LI$()?this.__parent.setState(this.__parent.getSelectionState()):t===e.Mode.PANNING_$LI$()?this.__parent.setState(this.__parent.getPanningState()):t===e.Mode.WALL_CREATION_$LI$()?this.__parent.setState(this.__parent.getWallCreationState()):t===e.Mode.ROOM_CREATION_$LI$()?this.__parent.setState(this.__parent.getRoomCreationState()):t===e.Mode.DIMENSION_LINE_CREATION_$LI$()?this.__parent.setState(this.__parent.getDimensionLineCreationState()):t===e.Mode.LABEL_CREATION_$LI$()&&this.__parent.setState(this.__parent.getLabelCreationState())},i.prototype.enter=function(){t.prototype.enter.call(this),this.oldSelection=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems(),this.oldBasePlanLocked=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked(),this.oldAllLevelsSelection=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection(),this.newPolyline=null,this.alignmentActivated=this.__parent.wasAlignmentActivatedLastMousePress(),this.toggleMagnetism(this.__parent.wasMagnetismToggledLastMousePress()),this.xPreviousPoint=this.__parent.getXLastMousePress(),this.yPreviousPoint=this.__parent.getYLastMousePress(),this.setDuplicationActivated(this.__parent.wasDuplicationActivatedLastMousePress()),this.__parent.deselectAll()},i.prototype.moveMouse=function(t,i){var n=this.__parent.getView(),o=t,r=i;if(this.alignmentActivated||this.magnetismEnabled){var l=new e.PointWithAngleMagnetism(this.xPreviousPoint,this.yPreviousPoint,t,i,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit(),n.getPixelLength());o=l.getX(),r=l.getY()}if(null==this.newPolyline)this.newPolyline=this.createAndSelectPolyline(this.xPreviousPoint,this.yPreviousPoint,o,r);else if(null!=this.newPoint){var a=this.newPolyline.getPoints();this.xPreviousPoint=a[a.length-1][0],this.yPreviousPoint=a[a.length-1][1],this.newPolyline.addPoint$float$float(o,r),this.newPoint[0]=o,this.newPoint[1]=r,this.newPoint=null}else this.newPolyline.setPoint(o,r,this.newPolyline.getPointCount()-1);this.__parent.feedbackDisplayed&&(n.setAlignmentFeedback(Polyline,null,t,i,!1),n.setToolTipFeedback(this.getToolTipFeedbackText(this.newPolyline,this.newPolyline.getPointCount()-1),t,i),this.newPolyline.getJoinStyle()!==Polyline.JoinStyle.CURVED&&this.showPolylineAngleFeedback(this.newPolyline,this.newPolyline.getPointCount()-1)),n.makePointVisible(t,i)},i.prototype.createAndSelectPolyline=function(e,t,i,n){var o=this.__parent.createPolyline([[e,t],[i,n]]);return this.curvedPolyline&&o.setJoinStyle(Polyline.JoinStyle.CURVED),this.__parent.selectItems([o].slice(0)),o},i.prototype.pressMouse=function(e,t,i,n,o){2===i?null!=this.newPolyline?(0===this.newPolyline.getPointIndexAt(e,t,this.__parent.getSelectionMargin())&&(this.newPolyline.removePoint(this.newPolyline.getPointCount()-1),this.newPolyline.setClosedPath(!0)),this.validateDrawnPolyline()):this.__parent.getPointerTypeLastMousePress()===View.PointerType.TOUCH?this.__parent.setState(this.__parent.getSelectionState()):this.__parent.setState(this.__parent.getPolylineCreationState()):this.endPolylineSegment()},i.prototype.validateDrawnPolyline=function(){null!=this.newPolyline&&(this.newPolyline.getPoints().length<2?this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.deletePolyline(this.newPolyline):this.__parent.postCreatePolylines([this.newPolyline].slice(0),this.oldSelection,this.oldBasePlanLocked,this.oldAllLevelsSelection));this.__parent.getPointerTypeLastMousePress()===View.PointerType.TOUCH?this.__parent.setState(this.__parent.getSelectionState()):this.__parent.setState(this.__parent.getPolylineCreationState())},i.prototype.endPolylineSegment=function(){null!=this.newPolyline&&this.getPolylineSegmentLength(this.newPolyline,this.newPolyline.getPointCount()-1)>0&&(this.newPoint=[0,0],this.newPolyline.getPointCount()<=2&&this.curvedPolyline&&this.newPolyline.getJoinStyle()!==Polyline.JoinStyle.CURVED&&this.newPolyline.setJoinStyle(Polyline.JoinStyle.CURVED))},i.prototype.setEditionActivated=function(e){var t=this.__parent.getView();if(e){if(t.deleteFeedback(),null==this.newPolyline)t.setToolTipEditedProperties(["X","Y"],[this.xPreviousPoint,this.yPreviousPoint],this.xPreviousPoint,this.yPreviousPoint);else{null!=this.newPoint&&this.createNextSegment();var i=this.newPolyline.getPoints();t.setToolTipEditedProperties(["LENGTH","ANGLE"],[this.getPolylineSegmentLength(this.newPolyline,i.length-1),this.getPolylineSegmentAngle(this.newPolyline,i.length-1)],i[i.length-1][0],i[i.length-1][1])}this.showPolylineFeedback()}else if(null==this.newPolyline){var n=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().isMetric()?300:LengthUnit.footToCentimeter(10);this.newPolyline=this.createAndSelectPolyline(this.xPreviousPoint,this.yPreviousPoint,this.xPreviousPoint+n,this.yPreviousPoint),t.deleteFeedback(),this.setEditionActivated(!0)}else if(Date.now()-this.lastPointCreationTime<300)this.escape();else{if(this.endPolylineSegment(),(i=this.newPolyline.getPoints()).length>2&&0===this.newPolyline.getPointIndexAt(i[i.length-1][0],i[i.length-1][1],.001))return this.newPolyline.removePoint(this.newPolyline.getPointCount()-1),this.newPolyline.setClosedPath(!0),void this.validateDrawnPolyline();this.createNextSegment(),t.deleteToolTipFeedback(),this.setEditionActivated(!0)}},i.prototype.createNextSegment=function(){var e=this.newPolyline.getPoints();this.xPreviousPoint=e[e.length-1][0],this.yPreviousPoint=e[e.length-1][1];var t=Math.PI-Math.atan2(e[e.length-2][1]-e[e.length-1][1],e[e.length-2][0]-e[e.length-1][0]);t-=Math.PI/2;var i=this.getPolylineSegmentLength(this.newPolyline,e.length-1);this.newPolyline.addPoint$float$float(this.xPreviousPoint+i*Math.cos(t),this.yPreviousPoint-i*Math.sin(t)),this.newPoint=null,this.lastPointCreationTime=Date.now()},i.prototype.updateEditableProperty=function(e,t){if(null==this.newPolyline)switch(e){case"X":this.xPreviousPoint=null!=t?t:0,this.xPreviousPoint=Math.max(-1e5,Math.min(this.xPreviousPoint,1e5));break;case"Y":this.yPreviousPoint=null!=t?t:0,this.yPreviousPoint=Math.max(-1e5,Math.min(this.yPreviousPoint,1e5))}else{var i=this.newPolyline.getPoints(),n=i[i.length-2],o=i[i.length-1],r=void 0,l=void 0;switch(e){case"LENGTH":var a=null!=t?t:0;a=Math.max(.001,Math.min(a,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMaximumLength()));var s=Math.PI-Math.atan2(n[1]-o[1],n[0]-o[0]);r=n[0]+a*Math.cos(s),l=n[1]-a*Math.sin(s);break;case"ANGLE":s=(null!=t?t:0)*Math.PI/180,i.length>2&&(s-=Math.atan2(i[i.length-3][1]-n[1],i[i.length-3][0]-n[0]));var h=this.getPolylineSegmentLength(this.newPolyline,i.length-1);r=n[0]+h*Math.cos(s),l=n[1]-h*Math.sin(s);break;default:return}this.newPolyline.setPoint(r,l,i.length-1)}this.showPolylineFeedback()},i.prototype.showPolylineFeedback=function(){var e=this.__parent.getView();if(null==this.newPolyline)this.__parent.feedbackDisplayed&&e.setAlignmentFeedback(Polyline,null,this.xPreviousPoint,this.yPreviousPoint,!0),e.makePointVisible(this.xPreviousPoint,this.yPreviousPoint);else{var t=this.newPolyline.getPoints(),i=t[t.length-2],n=t[t.length-1];this.__parent.feedbackDisplayed&&(this.newPolyline.getJoinStyle()!==Polyline.JoinStyle.CURVED&&this.showPolylineAngleFeedback(this.newPolyline,t.length-1),e.setAlignmentFeedback(Polyline,null,n[0],n[1],!1)),e.makePointVisible(i[0],i[1]),e.makePointVisible(n[0],n[1])}},i.prototype.toggleMagnetism=function(e){this.magnetismEnabled=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled()!==e,null!=this.newPolyline&&this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())},i.prototype.setAlignmentActivated=function(e){this.alignmentActivated=e,this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())},i.prototype.setDuplicationActivated=function(e){this.curvedPolyline=e},i.prototype.escape=function(){null!=this.newPolyline&&null==this.newPoint&&this.newPolyline.removePoint(this.newPolyline.getPointCount()-1),this.validateDrawnPolyline()},i.prototype.exit=function(){this.__parent.getView().deleteFeedback(),this.newPolyline=null,this.newPoint=null,this.oldSelection=null},i}(e.AbstractPolylineState);e.PolylineDrawingState=it,it.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PolylineDrawingState";var nt=function(t){function i(e){var i=t.call(this,e)||this;return i.__parent=e,void 0===i.polylines&&(i.polylines=null),void 0===i.selectedPolyline&&(i.selectedPolyline=null),void 0===i.polylinePointIndex&&(i.polylinePointIndex=0),void 0===i.oldX&&(i.oldX=0),void 0===i.oldY&&(i.oldY=0),void 0===i.deltaXToResizePoint&&(i.deltaXToResizePoint=0),void 0===i.deltaYToResizePoint&&(i.deltaYToResizePoint=0),void 0===i.magnetismEnabled&&(i.magnetismEnabled=!1),void 0===i.alignmentActivated&&(i.alignmentActivated=!1),i}return __extends(i,t),i.prototype.getMode=function(){return e.Mode.SELECTION_$LI$()},i.prototype.isModificationState=function(){return!0},i.prototype.isBasePlanModificationState=function(){return!0},i.prototype.enter=function(){var e,i,n=this;t.prototype.enter.call(this),this.selectedPolyline=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0],this.polylines=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getPolylines().slice(0),e=this.polylines,(i=e.indexOf(n.selectedPolyline))>=0&&e.splice(i,1);var o=this.__parent.getIndicatorMargin();this.polylinePointIndex=this.selectedPolyline.getPointIndexAt(this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress(),o);var r=this.selectedPolyline.getPoints();this.oldX=r[this.polylinePointIndex][0],this.oldY=r[this.polylinePointIndex][1],this.deltaXToResizePoint=this.__parent.getXLastMousePress()-this.oldX,this.deltaYToResizePoint=this.__parent.getYLastMousePress()-this.oldY,this.alignmentActivated=this.__parent.wasAlignmentActivatedLastMousePress(),this.toggleMagnetism(this.__parent.wasMagnetismToggledLastMousePress());var l=this.__parent.getView();l.setResizeIndicatorVisible(!0);var a=this.getToolTipFeedbackText(this.selectedPolyline,this.polylinePointIndex);this.__parent.feedbackDisplayed&&null!=a&&(l.setToolTipFeedback(a,this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress()),this.selectedPolyline.getJoinStyle()!==Polyline.JoinStyle.CURVED&&this.showPolylineAngleFeedback(this.selectedPolyline,this.polylinePointIndex))},i.prototype.moveMouse=function(t,i){var n=this.__parent.getView(),o=t-this.deltaXToResizePoint,r=i-this.deltaYToResizePoint;if(this.alignmentActivated||this.magnetismEnabled){var l=this.selectedPolyline.getPoints(),a=0===this.polylinePointIndex?this.selectedPolyline.isClosedPath()?l.length-1:1:this.polylinePointIndex-1,s=l[a][0],h=l[a][1],u=new e.PointWithAngleMagnetism(s,h,o,r,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit(),n.getPixelLength());o=u.getX(),r=u.getY()}this.selectedPolyline.setPoint(o,r,this.polylinePointIndex),this.__parent.feedbackDisplayed&&(n.setToolTipFeedback(this.getToolTipFeedbackText(this.selectedPolyline,this.polylinePointIndex),t,i),this.selectedPolyline.getJoinStyle()!==Polyline.JoinStyle.CURVED&&this.showPolylineAngleFeedback(this.selectedPolyline,this.polylinePointIndex)),n.makePointVisible(t,i)},i.prototype.releaseMouse=function(e,t){this.__parent.postPolylineResize(this.selectedPolyline,this.oldX,this.oldY,this.polylinePointIndex),this.__parent.setState(this.__parent.getSelectionState())},i.prototype.toggleMagnetism=function(e){this.magnetismEnabled=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled()!==e,this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())},i.prototype.setAlignmentActivated=function(e){this.alignmentActivated=e,this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())},i.prototype.escape=function(){this.selectedPolyline.setPoint(this.oldX,this.oldY,this.polylinePointIndex),this.__parent.setState(this.__parent.getSelectionState())},i.prototype.exit=function(){var e=this.__parent.getView();e.setResizeIndicatorVisible(!1),e.deleteFeedback(),this.selectedPolyline=null},i}(e.AbstractPolylineState);e.PolylineResizeState=nt,nt.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PolylineResizeState";var ot=function(){function t(e,t){this.walls=t,this.__parent=e}return t.prototype.compare=function(t,i){var n=e.computeIntersection(t.getXStart(),t.getYStart(),t.getXEnd(),t.getYEnd(),this.walls[0].getXStart(),this.walls[0].getYStart(),this.walls[0].getXEnd(),this.walls[0].getYEnd()),o=e.computeIntersection(i.getXStart(),i.getYStart(),i.getXEnd(),i.getYEnd(),this.walls[0].getXStart(),this.walls[0].getYStart(),this.walls[0].getXEnd(),this.walls[0].getYEnd());return Math.min(java.awt.geom.Point2D.distanceSq(this.walls[0].getXStart(),this.walls[0].getYStart(),n[0],n[1]),java.awt.geom.Point2D.distanceSq(this.walls[0].getXEnd(),this.walls[0].getYEnd(),n[0],n[1]))-Math.min(java.awt.geom.Point2D.distanceSq(this.walls[0].getXStart(),this.walls[0].getYStart(),o[0],o[1]),java.awt.geom.Point2D.distanceSq(this.walls[0].getXEnd(),this.walls[0].getYEnd(),o[0],o[1]))},t}();e.PlanController$0=ot;var rt=function(){function e(e){this.__parent=e}return e.prototype.selectionChanged=function(e){this.__parent.selectLevelFromSelectedItems(),null!=this.__parent.getView()&&this.__parent.getView().makeSelectionVisible()},e}();e.PlanController$1=rt,rt.__interfaces=["com.eteks.sweethome3d.model.SelectionListener"];var lt=function(){function e(e){this.__parent=e}return e.prototype.propertyChange=function(e){this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems().indexOf(e.getSource())>=0&&null!=this.__parent.getView()&&this.__parent.getView().makeSelectionVisible()},e}();e.PlanController$2=lt;var at=function(){function e(e){this.__parent=e}return e.prototype.propertyChange=function(e){var t,i,n=e.getPropertyName();if("X_START"===n||"X_END"===n||"Y_START"===n||"Y_END"===n||"WALL_AT_START"===n||"WALL_AT_END"===n||"THICKNESS"===n||"ARC_EXTENT"===n||"LEVEL"===n||"HEIGHT"===n||"HEIGHT_AT_END"===n||"LEFT_SIDE_BASEBOARD"===n||"RIGHT_SIDE_BASEBOARD"===n){this.__parent.resetAreaCache();var o=e.getSource();if(!o.isAtLevel(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel())){var r=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems().slice(0);(i=(t=r).indexOf(o))>=0&&(t.splice(i,1),1)&&this.__parent.selectItems(r,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection())}}},e}();e.PlanController$3=at;var st=function(){function e(e){this.__parent=e}return e.prototype.propertyChange=function(e){var t=e.getPropertyName();"X"!==t&&"Y"!==t&&"WIDTH_IN_PLAN"!==t&&"DEPTH_IN_PLAN"!==t||function(e,t){null==e.entries&&(e.entries=[]);for(var i=0;i<e.entries.length;i++)if(null==e.entries[i].key&&null==t||null!=e.entries[i].key.equals&&e.entries[i].key.equals(t)||e.entries[i].key===t)return e.entries.splice(i,1)[0]}(this.__parent.furnitureSidesCache,e.getSource())},e}();e.PlanController$4=st;var ht=function(){function e(e){this.__parent=e}return e.prototype.propertyChange=function(e){var t=e.getSource(),i=e.getPropertyName();if("MODEL"===i||"MODEL_MIRRORED"===i||"MODEL_ROTATION"===i||"WIDTH"===i||"DEPTH"===i||"HEIGHT"===i||"ROLL"===i||"PITCH"===i){var n=this.__parent.getView().getPieceOfFurnitureSizeInPlan(t);if(null!=n)t.setWidthInPlan(n[0]),t.setDepthInPlan(n[1]),t.setHeightInPlan(n[2]);else if("WIDTH"===i){var o=t.getWidth()/e.getOldValue();t.setWidthInPlan(o*t.getWidthInPlan()),t.setDepthInPlan(o*t.getDepthInPlan()),t.setHeightInPlan(o*t.getHeightInPlan())}}},e}();e.PlanController$5=ht;var ut=function(){function e(e){this.__parent=e}return e.prototype.propertyChange=function(e){this.__parent.resetAreaCache()},e}();e.PlanController$6=ut;var dt=function(){function e(e){this.__parent=e}return e.prototype.compare=function(e,t){return-(e.getGroundElevation()-t.getGroundElevation())},e}();e.PlanController$7=dt}(PlanController||(PlanController={})),PlanController.Mode.LABEL_CREATION_$LI$(),PlanController.Mode.DIMENSION_LINE_CREATION_$LI$(),PlanController.Mode.POLYLINE_CREATION_$LI$(),PlanController.Mode.ROOM_CREATION_$LI$(),PlanController.Mode.WALL_CREATION_$LI$(),PlanController.Mode.PANNING_$LI$(),PlanController.Mode.SELECTION_$LI$(),Home.LEVEL_ELEVATION_COMPARATOR_$LI$(),HomeController.UserPreferencesChangeListener.writingPreferences_$LI$(),CatalogLight.EMPTY_LIGHT_SOURCE_MATERIAL_NAMES_$LI$(),CatalogLight.EMPTY_LIGHT_SOURCES_$LI$(),CatalogShelfUnit.EMPTY_SHELF_BOXES_$LI$(),CatalogShelfUnit.EMPTY_SHELF_ELEVATIONS_$LI$(),HomePieceOfFurniture.SORTABLE_PROPERTY_COMPARATORS_$LI$(),HomePieceOfFurniture.EMPTY_PROPERTY_ARRAY_$LI$(),HomePieceOfFurniture.ROUND_WALL_ANGLE_MARGIN_$LI$(),HomePieceOfFurniture.STRAIGHT_WALL_ANGLE_MARGIN_$LI$(),HomePieceOfFurniture.TWICE_PI_$LI$(),HomePieceOfFurniture.__static_initialize(),Label.TWICE_PI_$LI$(),Room.TWICE_PI_$LI$(),ExportableView.FormatType.CSV_$LI$(),ExportableView.FormatType.SVG_$LI$(),TransferableView.DataType.FURNITURE_LIST_$LI$(),TransferableView.DataType.PLAN_IMAGE_$LI$(),FurnitureCategory.COMPARATOR_$LI$(),CatalogPieceOfFurniture.recentFilters_$LI$(),CatalogPieceOfFurniture.COMPARATOR_$LI$(),CatalogPieceOfFurniture.EMPTY_CRITERIA_$LI$(),CatalogPieceOfFurniture.__static_initialize(),Baseboard.baseboardsCache_$LI$(),TextStyle.textStylesCache_$LI$(),CatalogTexture.recentFilters_$LI$(),CatalogTexture.COMPARATOR_$LI$(),CatalogTexture.EMPTY_CRITERIA_$LI$(),CatalogTexture.__static_initialize(),TexturesCategory.COMPARATOR_$LI$(),void 0===Math.fround&&(doubleToFloatConverter=new Float32Array(1),Math.fround=function(e){return doubleToFloatConverter[0]=e,doubleToFloatConverter[0]}),Node3D.READING_MODEL="Reading model",Node3D.PARSING_MODEL="Parsing model",Node3D.BUILDING_MODEL="Building model",Node3D.BINDING_MODEL="Binding model",Node3D.prototype.setCapability=function(e){void 0===this.capabilities&&(this.capabilities=0),this.capabilities|=e},Node3D.prototype.getCapability=function(e){return void 0!==this.capabilities&&0!=(this.capabilities&e)},Node3D.prototype.getParent=function(){return void 0===this.parent?null:this.parent},Node3D.prototype.getUserData=function(){return void 0===this.userData?null:this.userData},Node3D.prototype.setUserData=function(e){this.userData=e},Node3D.prototype.getName=function(){return void 0===this.name?null:this.name},Node3D.prototype.setName=function(e){this.name=e},Node3D.prototype.addPropertyChangeListener=function(e,t){void 0===this.propertyChangeSupport&&(this.propertyChangeSupport=new PropertyChangeSupport(this)),this.propertyChangeSupport.addPropertyChangeListener(e,t)},Node3D.prototype.removePropertyChangeListener=function(e,t){void 0!==this.propertyChangeSupport&&this.propertyChangeSupport.removePropertyChangeListener(e,t)},Node3D.prototype.getPropertyChangeListeners=function(){return void 0!==this.propertyChangeSupport?this.propertyChangeSupport.getPropertyChangeListeners():[]},Node3D.prototype.setPickable=function(e){this.pickable=e},Node3D.prototype.isPickable=function(){return void 0===this.pickable||this.pickable},Node3D.prototype.clone=function(){var e=new Node3D;return this.cloneNodeAttributes(e),e},Node3D.prototype.cloneNodeAttributes=function(e){void 0!==this.capabilities&&(e.capabilities=this.capabilities),void 0!==this.userData&&(e.userData=this.userData),void 0!==this.name&&(e.name=this.name),void 0!==this.pickable&&(e.pickable=this.pickable)},Shape3D.prototype=Object.create(Node3D.prototype),Shape3D.prototype.constructor=Shape3D,Shape3D.ALLOW_GEOMETRY_WRITE=2,Shape3D.prototype.addGeometry=function(e){this.geometries.push(e);var t=vec3.fromValues(1/0,1/0,1/0),i=vec3.fromValues(-1/0,-1/0,-1/0);null!==this.bounds&&(this.bounds.getLower(t),this.bounds.getUpper(i));for(var n=0;n<e.vertexIndices.length;n++){var o=e.vertices[e.vertexIndices[n]];vec3.min(t,t,o),vec3.max(i,i,o)}this.bounds=new BoundingBox3D(t,i),void 0!==this.propertyChangeSupport&&this.propertyChangeSupport.firePropertyChange("GEOMETRY",null,e)},Shape3D.prototype.setGeometry=function(e,t){var i=this.geometries[t];this.geometries[t]=e,this.bounds=null,void 0!==this.propertyChangeSupport&&this.propertyChangeSupport.firePropertyChange("GEOMETRY",i,e)},Shape3D.prototype.removeGeometry=function(e){var t=this.geometries[e];this.geometries.splice(e,1),this.bounds=null,void 0!==this.propertyChangeSupport&&this.propertyChangeSupport.firePropertyChange("GEOMETRY",t,null)},Shape3D.prototype.getBounds=function(){if(0===this.geometries.length)return new BoundingBox3D(vec3.fromValues(1/0,1/0,1/0),vec3.fromValues(-1/0,-1/0,-1/0));if(null===this.bounds){for(var e=vec3.fromValues(1/0,1/0,1/0),t=vec3.fromValues(-1/0,-1/0,-1/0),i=0;i<this.geometries.length;i++){var n=this.geometries[i];if(n.vertexIndices)for(var o=0;o<n.vertexIndices.length;o++){var r=n.vertices[n.vertexIndices[o]];vec3.min(e,e,r),vec3.max(t,t,r)}}this.bounds=new BoundingBox3D(e,t)}return this.bounds.clone()},Shape3D.prototype.getGeometries=function(){return this.geometries},Shape3D.prototype.getAppearance=function(){return this.appearance},Shape3D.prototype.setAppearance=function(e){this.appearance=e},Shape3D.prototype.clone=function(){var e=new Shape3D(null,this.appearance);return this.cloneNodeAttributes(e),e.geometries=this.geometries,e.bounds=this.bounds,e},Background3D.prototype=Object.create(Node3D.prototype),Background3D.prototype.constructor=Background3D,Background3D.prototype.getGeometry=function(){return this.geometry},Background3D.prototype.clone=function(){var e=new Background3D(this.geometry);return this.cloneNodeAttributes(e),e},Light3D.prototype=Object.create(Node3D.prototype),Light3D.prototype.constructor=Light3D,Light3D.prototype.getColor=function(){return this.color},Light3D.prototype.setColor=function(e){var t=this.color;this.color=e,void 0!==this.propertyChangeSupport&&this.propertyChangeSupport.firePropertyChange("COLOR",t,e)},AmbientLight3D.prototype=Object.create(Light3D.prototype),AmbientLight3D.prototype.constructor=AmbientLight3D,AmbientLight3D.prototype.clone=function(){var e=new AmbientLight3D(this.color);return this.cloneNodeAttributes(e),e},DirectionalLight3D.prototype=Object.create(Light3D.prototype),DirectionalLight3D.prototype.constructor=DirectionalLight3D,DirectionalLight3D.prototype.getDirection=function(){return this.direction},DirectionalLight3D.prototype.clone=function(){var e=new DirectionalLight3D(this.color,this.direction);return this.cloneNodeAttributes(e),e},Group3D.prototype=Object.create(Node3D.prototype),Group3D.prototype.constructor=Group3D,Group3D.ALLOW_CHILDREN_EXTEND=1,Group3D.prototype.addChild=function(e){this.insertChild(e,this.children.length)},Group3D.prototype.insertChild=function(e,t){if(this.children.splice(t,0,e),e.parent=this,void 0!==this.childrenListeners)for(var i={source:this,child:e,index:t},n=this.childrenListeners.slice(0),o=0;o<n.length;o++)n[o].childAdded(i)},Group3D.prototype.getChild=function(e){return this.children[e]},Group3D.prototype.getChildren=function(){return this.children},Group3D.prototype.removeChild=function(e){var t;if(e instanceof Node3D?(t=e,e=this.children.indexOf(t)):t=this.children[e],this.children.splice(e,1),delete t.parent,void 0!==this.childrenListeners)for(var i={source:this,child:t,index:e},n=this.childrenListeners.slice(0),o=0;o<n.length;o++)n[o].childRemoved(i)},Group3D.prototype.removeAllChildren=function(){for(var e=this.children.length-1;e>=0;e--)this.removeChild(e)},Group3D.prototype.addChildrenListener=function(e){void 0===this.childrenListeners&&(this.childrenListeners=[]),this.childrenListeners.push(e)},Group3D.prototype.removeChildrenListener=function(e){if(void 0!==this.childrenListeners){var t=this.childrenListeners.indexOf(e);-1!==t&&this.childrenListeners.splice(t,1)}},Group3D.prototype.getChildrenListeners=function(){return void 0!==this.childrenListeners?this.childrenListeners.slice(0):[]},Group3D.prototype.setPickable=function(e){Node3D.prototype.setPickable.call(this,e);for(var t=0;t<this.children.length;t++)this.children[t].setPickable(e)},Group3D.prototype.clone=function(){var e=new Group3D;return this.cloneNodeAttributes(e),e},BranchGroup3D.prototype=Object.create(Group3D.prototype),BranchGroup3D.prototype.constructor=BranchGroup3D,BranchGroup3D.prototype.detach=function(){this.parent&&this.parent.removeChild(this)},BranchGroup3D.prototype.clone=function(){var e=new BranchGroup3D;return this.cloneNodeAttributes(e),e},SharedGroup3D.prototype=Object.create(Group3D.prototype),SharedGroup3D.prototype.constructor=SharedGroup3D,SharedGroup3D.prototype.clone=function(){var e=new SharedGroup3D;return this.cloneNodeAttributes(e),e},Link3D.prototype=Object.create(Node3D.prototype),Link3D.prototype.constructor=Link3D,Link3D.prototype.getSharedGroup=function(){return this.sharedGroup},Link3D.prototype.setSharedGroup=function(e){this.sharedGroup=e},Link3D.prototype.setPickable=function(e){Node3D.prototype.setPickable.call(this,e),this.sharedGroup.setPickable(e)},Link3D.prototype.clone=function(){var e=new Link3D(this.sharedGroup);return this.cloneNodeAttributes(e),e},TransformGroup3D.prototype=Object.create(Group3D.prototype),TransformGroup3D.prototype.constructor=TransformGroup3D,TransformGroup3D.ALLOW_TRANSFORM_WRITE=4,TransformGroup3D.prototype.getTransform=function(e){mat4.copy(e,this.transform)},TransformGroup3D.prototype.setTransform=function(e){if(!TransformGroup3D.areTransformationsEqual(this.transform,e)){var t=mat4.clone(this.transform);mat4.copy(this.transform,e),void 0!==this.propertyChangeSupport&&this.propertyChangeSupport.firePropertyChange("TRANSFORM",t,e)}},TransformGroup3D.areTransformationsEqual=function(e,t){if(e&&t&&e.length===t.length){for(var i=0;i<e.length;i++)if(e[i]!==t[i])return!1;return!0}return e===t},TransformGroup3D.isIdentity=function(e){return void 0===TransformGroup3D.IDENTITY&&(TransformGroup3D.IDENTITY=mat4.create()),mat4.exactEquals(e,TransformGroup3D.IDENTITY)},TransformGroup3D.prototype.clone=function(){var e=new TransformGroup3D(this.transform);return this.cloneNodeAttributes(e),e},Appearance3D.CULL_NONE=0,Appearance3D.CULL_BACK=1,Appearance3D.CULL_FRONT=2,Appearance3D.prototype.addPropertyChangeListener=function(e){void 0===this.propertyChangeSupport&&(this.propertyChangeSupport=new PropertyChangeSupport(this)),this.propertyChangeSupport.addPropertyChangeListener(e)},Appearance3D.prototype.removePropertyChangeListener=function(e){void 0!==this.propertyChangeSupport&&this.propertyChangeSupport.removePropertyChangeListener(e)},Appearance3D.prototype.setName=function(e){this.name=e},Appearance3D.prototype.getName=function(){return this.name},Appearance3D.prototype.setAmbientColor=function(e){var t=this.ambientColor;this.ambientColor=e,void 0!==this.propertyChangeSupport&&this.propertyChangeSupport.firePropertyChange("AMBIENT_COLOR",t,e)},Appearance3D.prototype.getAmbientColor=function(){return this.ambientColor},Appearance3D.prototype.setEmissiveColor=function(e){var t=this.emissiveColor;this.emissiveColor=e,void 0!==this.propertyChangeSupport&&this.propertyChangeSupport.firePropertyChange("EMISSIVE_COLOR",t,e)},Appearance3D.prototype.getEmissiveColor=function(){return this.emissiveColor},Appearance3D.prototype.setDiffuseColor=function(e){var t=this.diffuseColor;this.diffuseColor=e,void 0!==this.propertyChangeSupport&&this.propertyChangeSupport.firePropertyChange("DIFFUSE_COLOR",t,e)},Appearance3D.prototype.getDiffuseColor=function(){return this.diffuseColor},Appearance3D.prototype.setSpecularColor=function(e){var t=this.specularColor;this.specularColor=e,void 0!==this.propertyChangeSupport&&this.propertyChangeSupport.firePropertyChange("SPECULAR_COLOR",t,e)},Appearance3D.prototype.getSpecularColor=function(){return this.specularColor},Appearance3D.prototype.setShininess=function(e){e=Math.max(e,1);var t=this.shininess;this.shininess=e,void 0!==this.propertyChangeSupport&&this.propertyChangeSupport.firePropertyChange("SHININESS",t,e)},Appearance3D.prototype.getShininess=function(){return this.shininess},Appearance3D.prototype.setTransparency=function(e){var t=this.transparency;this.transparency=e,void 0!==this.propertyChangeSupport&&this.propertyChangeSupport.firePropertyChange("TRANSPARENCY",t,e)},Appearance3D.prototype.getTransparency=function(){return this.transparency},Appearance3D.prototype.setIllumination=function(e){var t=this.illumination;this.illumination=e,void 0!==this.propertyChangeSupport&&this.propertyChangeSupport.firePropertyChange("ILLUMINATION",t,e)},Appearance3D.prototype.getIllumination=function(){return this.illumination},Appearance3D.prototype.setTextureImage=function(e){if(this.textureImage!==e){var t=this.textureImage;this.textureImage=e,void 0!==this.propertyChangeSupport&&this.propertyChangeSupport.firePropertyChange("TEXTURE_IMAGE",t,e)}},Appearance3D.prototype.getTextureImage=function(){return this.textureImage},Appearance3D.isPowerOfTwo=function(e){return 0==(e&e-1)},Appearance3D.getNextHighestPowerOfTwo=function(e){--e;for(var t=1;t<32;t<<=1)e|=e>>t;return e+1},Appearance3D.prototype.setTextureCoordinatesGeneration=function(e){if(!Appearance3D.areTextureCoordinatesGenerationsEqual(this.textureCoordinatesGeneration,e)){var t=this.textureCoordinatesGeneration;this.textureCoordinatesGeneration=e,void 0!==this.propertyChangeSupport&&this.propertyChangeSupport.firePropertyChange("TEXTURE_COORDINATES_GENERATION",t,e)}},Appearance3D.areTextureCoordinatesGenerationsEqual=function(e,t){if(e&&t){var i=e.planeS,n=t.planeS;if(i&&n&&vec4.equals(i,n)){var o=e.planeT,r=t.planeT;return o&&r&&vec4.equals(o,r)}return!1}return e===t},Appearance3D.prototype.getTextureCoordinatesGeneration=function(){return this.textureCoordinatesGeneration},Appearance3D.prototype.setTextureTransform=function(e){if(!TransformGroup3D.areTransformationsEqual(this.textureTransform,e)){var t=this.textureTransform;this.textureTransform=e,void 0!==this.propertyChangeSupport&&this.propertyChangeSupport.firePropertyChange("TEXTURE_TRANSFORM",t,e)}},Appearance3D.prototype.getTextureTransform=function(){return this.textureTransform},Appearance3D.prototype.setVisible=function(e){var t=this.visible;this.visible=e,void 0!==this.propertyChangeSupport&&this.propertyChangeSupport.firePropertyChange("VISIBLE",t,e)},Appearance3D.prototype.isVisible=function(){return!1!==this.visible},Appearance3D.prototype.setCullFace=function(e){var t=this.cullFace;this.cullFace=e,void 0!==this.propertyChangeSupport&&this.propertyChangeSupport.firePropertyChange("CULL_FACE",t,e)},Appearance3D.prototype.getCullFace=function(){return this.cullFace},Appearance3D.prototype.setBackFaceNormalFlip=function(e){var t=this.backFaceNormalFlip;this.backFaceNormalFlip=e,void 0!==this.propertyChangeSupport&&this.propertyChangeSupport.firePropertyChange("BACK_FACE_NORMAL_FLIP",t,e)},Appearance3D.prototype.getBackFaceNormalFlip=function(){return this.backFaceNormalFlip},Appearance3D.prototype.isBackFaceNormalFlip=function(){return!0===this.backFaceNormalFlip},Appearance3D.prototype.clone=function(){var e=new Appearance3D(this.name);for(var t in this)this.hasOwnProperty(t)&&(e[t]=this[t]);return e},IndexedGeometryArray3D.prototype.hasTextureCoordinates=function(){return this.textureCoordinatesDefined},IndexedGeometryArray3D.prototype.disposeCoordinates=function(){delete this.textureCoordinates,delete this.textureCoordinateIndices},IndexedLineArray3D.prototype=Object.create(IndexedGeometryArray3D.prototype),IndexedLineArray3D.prototype.constructor=IndexedLineArray3D,IndexedTriangleArray3D.prototype=Object.create(IndexedGeometryArray3D.prototype),IndexedTriangleArray3D.prototype.constructor=IndexedTriangleArray3D,IndexedTriangleArray3D.prototype.disposeCoordinates=function(){IndexedGeometryArray3D.prototype.disposeCoordinates.call(this),delete this.normals,delete this.normalIndices},BoundingBox3D.prototype.getLower=function(e){vec3.copy(e,this.lower)},BoundingBox3D.prototype.getUpper=function(e){vec3.copy(e,this.upper)},BoundingBox3D.prototype.isEmpty=function(){return this.lower[0]===1/0&&this.lower[1]===1/0&&this.lower[2]===1/0&&this.upper[0]===-1/0&&this.upper[1]===-1/0&&this.upper[2]===-1/0},BoundingBox3D.prototype.combine=function(e){if(e instanceof BoundingBox3D)this.lower[0]>e.lower[0]&&(this.lower[0]=e.lower[0]),this.lower[1]>e.lower[1]&&(this.lower[1]=e.lower[1]),this.lower[2]>e.lower[2]&&(this.lower[2]=e.lower[2]),this.upper[0]<e.upper[0]&&(this.upper[0]=e.upper[0]),this.upper[1]<e.upper[1]&&(this.upper[1]=e.upper[1]),this.upper[2]<e.upper[2]&&(this.upper[2]=e.upper[2]);else{var t=e;this.lower[0]>t[0]&&(this.lower[0]=t[0]),this.lower[1]>t[1]&&(this.lower[1]=t[1]),this.lower[2]>t[2]&&(this.lower[2]=t[2]),this.upper[0]<t[0]&&(this.upper[0]=t[0]),this.upper[1]<t[1]&&(this.upper[1]=t[1]),this.upper[2]<t[2]&&(this.upper[2]=t[2])}},BoundingBox3D.prototype.intersect=function(e){return!this.isEmpty()&&e[0]>=this.lower[0]&&e[0]<=this.upper[0]&&e[1]>=this.lower[1]&&e[1]<=this.upper[1]&&e[2]>=this.lower[2]&&e[2]<=this.upper[2]},BoundingBox3D.prototype.transform=function(e){if(!this.isEmpty()){var t=this.upper[0],i=this.upper[1],n=this.upper[2],o=this.lower[0],r=this.lower[1],l=this.lower[2],a=vec3.fromValues(t,i,n);vec3.transformMat4(a,a,e),this.upper[0]=a[0],this.upper[1]=a[1],this.upper[2]=a[2],this.lower[0]=a[0],this.lower[1]=a[1],this.lower[2]=a[2],vec3.set(a,o,i,n),vec3.transformMat4(a,a,e),a[0]>this.upper[0]&&(this.upper[0]=a[0]),a[1]>this.upper[1]&&(this.upper[1]=a[1]),a[2]>this.upper[2]&&(this.upper[2]=a[2]),a[0]<this.lower[0]&&(this.lower[0]=a[0]),a[1]<this.lower[1]&&(this.lower[1]=a[1]),a[2]<this.lower[2]&&(this.lower[2]=a[2]),vec3.set(a,o,r,n),vec3.transformMat4(a,a,e),a[0]>this.upper[0]&&(this.upper[0]=a[0]),a[1]>this.upper[1]&&(this.upper[1]=a[1]),a[2]>this.upper[2]&&(this.upper[2]=a[2]),a[0]<this.lower[0]&&(this.lower[0]=a[0]),a[1]<this.lower[1]&&(this.lower[1]=a[1]),a[2]<this.lower[2]&&(this.lower[2]=a[2]),vec3.set(a,t,r,n),vec3.transformMat4(a,a,e),a[0]>this.upper[0]&&(this.upper[0]=a[0]),a[1]>this.upper[1]&&(this.upper[1]=a[1]),a[2]>this.upper[2]&&(this.upper[2]=a[2]),a[0]<this.lower[0]&&(this.lower[0]=a[0]),a[1]<this.lower[1]&&(this.lower[1]=a[1]),a[2]<this.lower[2]&&(this.lower[2]=a[2]),vec3.set(a,o,i,l),vec3.transformMat4(a,a,e),a[0]>this.upper[0]&&(this.upper[0]=a[0]),a[1]>this.upper[1]&&(this.upper[1]=a[1]),a[2]>this.upper[2]&&(this.upper[2]=a[2]),a[0]<this.lower[0]&&(this.lower[0]=a[0]),a[1]<this.lower[1]&&(this.lower[1]=a[1]),a[2]<this.lower[2]&&(this.lower[2]=a[2]),vec3.set(a,t,i,l),vec3.transformMat4(a,a,e),a[0]>this.upper[0]&&(this.upper[0]=a[0]),a[1]>this.upper[1]&&(this.upper[1]=a[1]),a[2]>this.upper[2]&&(this.upper[2]=a[2]),a[0]<this.lower[0]&&(this.lower[0]=a[0]),a[1]<this.lower[1]&&(this.lower[1]=a[1]),a[2]<this.lower[2]&&(this.lower[2]=a[2]),vec3.set(a,o,r,l),vec3.transformMat4(a,a,e),a[0]>this.upper[0]&&(this.upper[0]=a[0]),a[1]>this.upper[1]&&(this.upper[1]=a[1]),a[2]>this.upper[2]&&(this.upper[2]=a[2]),a[0]<this.lower[0]&&(this.lower[0]=a[0]),a[1]<this.lower[1]&&(this.lower[1]=a[1]),a[2]<this.lower[2]&&(this.lower[2]=a[2]),vec3.set(a,t,r,l),vec3.transformMat4(a,a,e),a[0]>this.upper[0]&&(this.upper[0]=a[0]),a[1]>this.upper[1]&&(this.upper[1]=a[1]),a[2]>this.upper[2]&&(this.upper[2]=a[2]),a[0]<this.lower[0]&&(this.lower[0]=a[0]),a[1]<this.lower[1]&&(this.lower[1]=a[1]),a[2]<this.lower[2]&&(this.lower[2]=a[2])}},BoundingBox3D.prototype.clone=function(){return new BoundingBox3D(this.lower,this.upper)},Box3D.prototype=Object.create(Shape3D.prototype),Box3D.prototype.constructor=Box3D,GeometryInfo3D.TRIANGLE_ARRAY=0,GeometryInfo3D.TRIANGLE_STRIP_ARRAY=1,GeometryInfo3D.TRIANGLE_FAN_ARRAY=2,GeometryInfo3D.QUAD_ARRAY=10,GeometryInfo3D.POLYGON_ARRAY=20,GeometryInfo3D.prototype.setCoordinates=function(e){this.vertices=e},GeometryInfo3D.prototype.setCoordinateIndices=function(e){this.coordinatesIndices=e},GeometryInfo3D.prototype.setNormals=function(e){this.normals=e},GeometryInfo3D.prototype.setNormalIndices=function(e){this.normalIndices=e},GeometryInfo3D.prototype.setTextureCoordinates=function(e){this.textureCoordinates=e},GeometryInfo3D.prototype.setTextureCoordinateIndices=function(e){this.textureCoordinateIndices=e},GeometryInfo3D.prototype.setStripCounts=function(e){this.stripCounts=e},GeometryInfo3D.prototype.setContourCounts=function(e){this.contourCounts=e},GeometryInfo3D.prototype.setCreaseAngle=function(e){this.creaseAngle=e},GeometryInfo3D.prototype.setGeneratedNormals=function(e){this.generatedNormals=e},GeometryInfo3D.prototype.computeNormals=function(e,t,i,n){var o;o=void 0===this.creaseAngle?44*Math.PI/180:this.creaseAngle;var r=vec3.create(),l=vec3.create();if(o>0){for(var a=[],s=0;s<t.length;s+=3){var h=e[t[s+1]];vec3.sub(r,e[t[s+2]],h),vec3.sub(l,e[t[s]],h);for(var u=vec3.cross(vec3.create(),r,l),d=0;d<3;d++){var c={normal:u},p=t[s+d];c.nextVertex=a[p],a[p]=c,i.push(u),n.push(i.length-1)}}var g=vec3.create();for(s=0;s<t.length;s+=3)for(d=0;d<3;d++){p=t[s+d];var m=i[v=n[s+d]];for(u=vec3.create(),c=a[p];void 0!==c;c=c.nextVertex)if(c.normal===m)vec3.add(u,u,c.normal);else{var f=vec3.dot(c.normal,m);if(f>0||o>Math.PI/2)Math.abs(Math.atan2(vec3.length(vec3.cross(g,c.normal,m)),f))<o-.001&&vec3.add(u,u,c.normal)}0!==vec3.squaredLength(u)||vec3.copy(u,m),vec3.normalize(u,u),i[v]=u}}else for(s=0;s<t.length;s+=3){h=e[t[s+1]];vec3.sub(r,e[t[s+2]],h),vec3.sub(l,e[t[s]],h);u=vec3.cross(vec3.create(),r,l);vec3.normalize(u,u);var v=i.length-1;0!==i.length&&vec3.exactEquals(i[v],u)||(i.push(u),v++);for(d=0;d<3;d++)n.push(v)}},GeometryInfo3D.prototype.getIndexedGeometryArray=function(){if(this.vertices&&!this.coordinatesIndices)if(this.coordinatesIndices=new Array(this.vertices.length),this.generatedNormals&&(void 0===this.creaseAngle||this.creaseAngle>0)){for(var e=0;e<this.coordinatesIndices.length;e++)for(var t=0;t<this.vertices.length;t++)if(vec3.exactEquals(this.vertices[e],this.vertices[t])){this.coordinatesIndices[e]=t;break}}else for(e=0;e<this.coordinatesIndices.length;e++)this.coordinatesIndices[e]=e;if(this.textureCoordinates&&!this.textureCoordinateIndices){this.textureCoordinateIndices=new Array(this.textureCoordinates.length);for(e=0;e<this.textureCoordinateIndices.length;e++)this.textureCoordinateIndices[e]=e}if(this.normals&&!this.normalIndices&&!this.generatedNormals){this.normalIndices=new Array(this.normals.length);for(e=0;e<this.normalIndices.length;e++)this.normalIndices[e]=e}var i,n,o,r;if(this.type===GeometryInfo3D.POLYGON_ARRAY)i=[],n=[],o=[],(new Triangulator).triangulate(this.vertices,this.coordinatesIndices,this.textureCoordinates?this.textureCoordinateIndices:[],this.normals?this.normalIndices:[],this.stripCounts,i,n,o);else if(this.type===GeometryInfo3D.QUAD_ARRAY){i=[],n=[],o=[];for(e=0;e<this.coordinatesIndices.length;e+=4)i.push(this.coordinatesIndices[e]),i.push(this.coordinatesIndices[e+1]),i.push(this.coordinatesIndices[e+2]),i.push(this.coordinatesIndices[e+2]),i.push(this.coordinatesIndices[e+3]),i.push(this.coordinatesIndices[e]),this.textureCoordinateIndices&&(n.push(this.textureCoordinateIndices[e]),n.push(this.textureCoordinateIndices[e+1]),n.push(this.textureCoordinateIndices[e+2]),n.push(this.textureCoordinateIndices[e+2]),n.push(this.textureCoordinateIndices[e+3]),n.push(this.textureCoordinateIndices[e])),this.normalIndices&&(o.push(this.normalIndices[e]),o.push(this.normalIndices[e+1]),o.push(this.normalIndices[e+2]),o.push(this.normalIndices[e+2]),o.push(this.normalIndices[e+3]),o.push(this.normalIndices[e]))}else if(this.type===GeometryInfo3D.TRIANGLE_STRIP_ARRAY){i=[],n=[],o=[];e=0;for(var l=0;e<this.stripCounts.length;e++){for(var a=this.stripCounts[e],s=0;s<a-2;s++){var h=l+(s%2==0?s+1:s+2),u=l+(s%2==0?s+2:s+1);i.push(this.coordinatesIndices[l+s]),i.push(this.coordinatesIndices[h]),i.push(this.coordinatesIndices[u]),this.textureCoordinateIndices&&(n.push(this.textureCoordinateIndices[l+s]),n.push(this.textureCoordinateIndices[h]),n.push(this.textureCoordinateIndices[u])),this.normalIndices&&(o.push(this.normalIndices[l+s]),o.push(this.normalIndices[h]),o.push(this.normalIndices[u]))}l+=a}}else if(this.type===GeometryInfo3D.TRIANGLE_FAN_ARRAY){i=[],n=[],o=[];for(e=0,l=0;e<this.stripCounts.length;e++){for(a=this.stripCounts[e],s=0;s<a-2;s++)i.push(this.coordinatesIndices[l]),i.push(this.coordinatesIndices[l+s+1]),i.push(this.coordinatesIndices[l+s+2]),this.textureCoordinateIndices&&(n.push(this.textureCoordinateIndices[l]),n.push(this.textureCoordinateIndices[l+s+1]),n.push(this.textureCoordinateIndices[l+s+2])),this.normalIndices&&(o.push(this.normalIndices[l]),o.push(this.normalIndices[l+s+1]),o.push(this.normalIndices[l+s+2]));l+=a}}else i=this.vertices?this.coordinatesIndices:[],n=this.textureCoordinates?this.textureCoordinateIndices:[],o=this.normals?this.normalIndices:[];return this.generatedNormals?(r=[],o=[],this.computeNormals(this.vertices,i,r,o)):r=this.normals,new IndexedTriangleArray3D(this.vertices,i,this.textureCoordinates,n,r,o)},HTMLCanvas3D.MAX_DIRECTIONAL_LIGHT=16,HTMLCanvas3D.VEC4_DEFAULT_PLANE_S=vec4.fromValues(1,0,0,0),HTMLCanvas3D.VEC4_DEFAULT_PLANE_T=vec4.fromValues(0,1,0,0),HTMLCanvas3D.MAT3_IDENTITY=mat3.create(),HTMLCanvas3D.PARALLEL_PROJECTION=0,HTMLCanvas3D.PERSPECTIVE_PROJECTION=1,HTMLCanvas3D.prototype.createShader=function(e,t){var i=this.gl.createShader(e);if(this.gl.shaderSource(i,t),this.gl.compileShader(i),!this.gl.getShaderParameter(i,this.gl.COMPILE_STATUS))throw"Invalid shader: "+t;return i},HTMLCanvas3D.prototype.getCanvas=function(){return this.canvas},HTMLCanvas3D.prototype.getHTMLElement=function(){return this.getCanvas()},HTMLCanvas3D.prototype.getDepthBits=function(){return this.gl.getParameter(this.gl.DEPTH_BITS)},HTMLCanvas3D.prototype.setFieldOfView=function(e){this.fieldOfView!=e&&(this.fieldOfView=e,this.repaint())},HTMLCanvas3D.prototype.setFrontClipDistance=function(e){this.frontClipDistance!=e&&(this.frontClipDistance=e,this.repaint())},HTMLCanvas3D.prototype.setBackClipDistance=function(e){this.backClipDistance!=e&&(this.backClipDistance=e,this.repaint())},HTMLCanvas3D.prototype.getViewPlatformTransform=function(e){return mat4.copy(e,this.viewPlatformTransform)},HTMLCanvas3D.prototype.setViewPlatformTransform=function(e){this.viewPlatformTransform!=e&&(this.viewPlatformTransform=e,this.repaint())},HTMLCanvas3D.prototype.updateViewportSize=function(){var e;try{e=this.canvas.getBoundingClientRect()}catch(t){e={width:this.canvas.width,height:this.canvas.height}}var t=0!==e.width&&0!==e.height;t||(e={width:this.canvas.width,height:this.canvas.height}),this.viewportWidth==e.width&&this.viewportHeight==e.height||(this.viewportWidth=e.width,this.viewportHeight=e.height,this.canvas.width=this.viewportWidth,this.canvas.height=this.viewportHeight,void 0!==this.pickingFrameBuffer&&(this.gl.deleteFramebuffer(this.pickingFrameBuffer),delete this.pickingFrameBuffer),t&&this.repaint())},HTMLCanvas3D.prototype.setScene=function(e,t){var i=[],n=[],o=[],r=[],l=this.countDisplayedGeometries(e);if(this.prepareScene(e,i,n,o,!1,[],r,mat4.create(),t,l),this.scene=e,this.sharedGeometries=i,this.sceneGeometries=n,this.backgroundGeometries=o,this.lights=r,this.offscreen)this.canvasNeededRepaint=!0,void 0!==t&&t(ModelLoader.BINDING_MODEL,"",1);else{var a=this;setTimeout((function(){void 0!==t&&t(ModelLoader.BINDING_MODEL,"",1),a.drawScene()}),0)}},HTMLCanvas3D.prototype.getScene=function(){return this.scene},HTMLCanvas3D.prototype.countDisplayedGeometries=function(e){if(e instanceof Group3D){for(var t=0,i=e.getChildren(),n=0;n<i.length;n++)t+=this.countDisplayedGeometries(i[n]);return t}return e instanceof Link3D?this.countDisplayedGeometries(e.getSharedGroup()):e instanceof Shape3D?e.getGeometries().length:0},HTMLCanvas3D.DEFAULT_APPEARANCE=new Appearance3D,HTMLCanvas3D.prototype.prepareScene=function(e,t,i,n,o,r,l,a,s,h){var u=this;if(e instanceof Group3D){if(e instanceof TransformGroup3D){var d=mat4.create();e.getTransform(d),a=mat4.mul(mat4.create(),a,d),e.getCapability(TransformGroup3D.ALLOW_TRANSFORM_WRITE)&&e.addPropertyChangeListener("TRANSFORM",{propertyChange:function(t){for(var a=e.getChildren(),s=0;s<a.length;s++)u.updateChildrenTransformation(a[s],o?n:i,r,l,u.getTransformFromRoot(e));u.repaint()}})}for(var c=e.getChildren(),p=0;p<c.length;p++)this.prepareScene(c[p],t,i,n,o,r,l,a,s,h);e.getCapability(Group3D.ALLOW_CHILDREN_EXTEND)&&e.addChildrenListener({childAdded:function(a){u.prepareScene(a.child,t,i,n,o,r,l,u.getTransformFromRoot(e)),u.repaint()},childRemoved:function(e){u.removeDisplayedItems(e.child,t,o?n:i,l),u.removeNodeListeners(e.child),u.repaint()}})}else if(e instanceof Link3D)(r=r.slice(0)).push(e),this.prepareScene(e.getSharedGroup(),t,i,n,o,r,l,a,s,h);else if(e instanceof Shape3D){void 0!==s&&!o&&Math.floor((i.length-1)/h*10)<Math.floor(i.length/h*10)&&s(ModelLoader.BINDING_MODEL,"",i.length/h);var g=e.getAppearance();g||(g=HTMLCanvas3D.DEFAULT_APPEARANCE);var m=null;g.getTextureImage()&&(m=this.prepareTexture(g.getTextureImage()));var f=e.getGeometries();for(p=0;p<f.length;p++)this.prepareGeometry(f[p],g,m,e,t,i,n,o,r,a);e.getCapability(Shape3D.ALLOW_GEOMETRY_WRITE)&&e.addPropertyChangeListener("GEOMETRY",{propertyChange:function(l){if(l.getOldValue()){removedGeometry=l.getOldValue();for(var a=0;a<i.length;a++){var s=i[a];if(s.nodeGeometry===removedGeometry){u.clearGeometryBuffers(s),i.splice(a,1);break}}}if(l.getNewValue()){addedGeometry=l.getNewValue();var h=e.getAppearance();h||(h=HTMLCanvas3D.DEFAULT_APPEARANCE);var d=null;h.getTextureImage()&&(d=u.prepareTexture(h.getTextureImage())),u.prepareGeometry(addedGeometry,h,d,e,t,i,n,o,r,u.getTransformFromRoot(e))}}}),g!==HTMLCanvas3D.DEFAULT_APPEARANCE&&g.addPropertyChangeListener({propertyChange:function(t){for(var r=o?n:i,l=0;l<r.length;l++){var a=r[l];if(a.node===e){var s=t.getNewValue();switch(t.getPropertyName()){case"AMBIENT_COLOR":a.ambientColor=s;break;case"DIFFUSE_COLOR":a.diffuseColor=s;break;case"SPECULAR_COLOR":a.specularColor=s;break;case"SHININESS":a.shininess=s;break;case"TRANSPARENCY":a.transparency=null!=s?1-s:1;break;case"ILLUMINATION":a.lightingEnabled=(null==s||s>=1)&&a.mode===u.gl.TRIANGLES;break;case"TEXTURE_IMAGE":a.texture=null!=s?u.prepareTexture(s):void 0;break;case"TEXTURE_COORDINATES_GENERATION":var h=s;a.textureCoordinatesGeneration=h;break;case"TEXTURE_TRANSFORM":a.textureTransform=s;break;case"VISIBLE":a.visible=!1!==s;break;case"CULL_FACE":a.cullFace=s;break;case"BACK_FACE_NORMAL_FLIP":a.backFaceNormalFlip=!0===s}}}u.repaint()}})}else if(e instanceof Background3D)this.prepareScene(e.getGeometry(),t,i,n,!0,r,l,a);else if(e instanceof Light3D){var v={node:e,color:e.getColor()};e instanceof DirectionalLight3D&&(v.direction=e.getDirection(),v.transform=a),l.push(v),e.addPropertyChangeListener("COLOR",{canvas3D:u,propertyChange:function(t){for(var i=0;i<l.length;i++){var n=l[i];if(l[i].node===e){n.color=t.getNewValue();break}}u.repaint()}})}},HTMLCanvas3D.prototype.getTransformFromRoot=function(e){var t=mat4.create();if(e instanceof TransformGroup3D&&e.getTransform(t),null!==e){var i=e.getParent();i instanceof Group3D&&mat4.mul(t,this.getTransformFromRoot(i),t)}return t},HTMLCanvas3D.prototype.prepareGeometry=function(e,t,i,n,o,r,l,a,s,h){var u=null;if(!n.getCapability(Shape3D.ALLOW_GEOMETRY_WRITE))for(var d=0;d<o.length;d++)if(o[d].nodeGeometry===e){u={node:n,center:o[d].center,nodeGeometry:e,vertexCount:o[d].vertexCount,vertexBuffer:o[d].vertexBuffer,textureCoordinatesBuffer:o[d].textureCoordinatesBuffer,normalBuffer:o[d].normalBuffer,mode:o[d].mode},o[d].referenceCount++;break}if(null===u){var c=n.getBounds(),p=vec3.create();c.getLower(p);var g=vec3.create();c.getUpper(g);var m=vec3.fromValues((p[0]+g[0])/2,(p[1]+g[1])/2,(p[2]+g[2])/2);(u={node:n,center:m,nodeGeometry:e,vertexCount:e.vertexIndices.length}).vertexBuffer=this.prepareBuffer(e.vertices,e.vertexIndices),e.hasTextureCoordinates()?u.textureCoordinatesBuffer=this.prepareBuffer(e.textureCoordinates,e.textureCoordinateIndices):u.textureCoordinatesBuffer=null,e instanceof IndexedTriangleArray3D?(u.mode=this.gl.TRIANGLES,u.normalBuffer=this.prepareBuffer(e.normals,e.normalIndices)):u.mode=this.gl.LINES,n.getCapability(Shape3D.ALLOW_GEOMETRY_WRITE)||o.push({nodeGeometry:e,center:m,vertexCount:u.vertexCount,vertexBuffer:u.vertexBuffer,textureCoordinatesBuffer:u.textureCoordinatesBuffer,normalBuffer:u.normalBuffer,mode:u.mode,referenceCount:1})}u.transform=h,s.length>0&&(u.parentLinks=s);var f=t.getAmbientColor();void 0!==f&&(u.ambientColor=f);var v=t.getDiffuseColor();void 0!==v&&(u.diffuseColor=v);var _=t.getSpecularColor();void 0!==_&&(u.specularColor=_);var S=t.getShininess();void 0!==S&&(u.shininess=S);var y=t.getTextureCoordinatesGeneration();void 0!==y&&(u.textureCoordinatesGeneration=y);var E=t.getTextureTransform();void 0!==E&&(u.textureTransform=E),null!==i&&(u.texture=i),u.backFaceNormalFlip=t.isBackFaceNormalFlip(),void 0!==t.getCullFace()&&(u.cullFace=t.getCullFace());var C=t.getIllumination();u.lightingEnabled=(null==C||C>=1)&&null!==u.normalBuffer,u.transparency=null!=t.getTransparency()?1-t.getTransparency():1,u.visible=t.isVisible(),(a?l:r).push(u)},HTMLCanvas3D.prototype.updateChildrenTransformation=function(e,t,i,n,o){if(e instanceof Group3D){if(e instanceof TransformGroup3D){var r=mat4.create();e.getTransform(r),o=mat4.mul(mat4.create(),o,r)}for(var l=e.getChildren(),a=0;a<l.length;a++)this.updateChildrenTransformation(l[a],t,i,n,o)}else if(e instanceof Link3D)(i=i.slice(0)).push(e),this.updateChildrenTransformation(e.getSharedGroup(),t,i,n,o);else if(e instanceof Shape3D){for(a=0;a<t.length;a++)if(t[a].node===e){var s=void 0===t[a].parentLinks;if(!s&&t[a].parentLinks.length===i.length){var h;for(h=0;h<i.length&&t[a].parentLinks[h]===i[h];h++);s=h===i.length}if(s){t[a].transform=o;break}}}else if(e instanceof Light3D)for(a=0;a<n.length;a++)if(n[a].node===e){n[a].transform=o;break}},HTMLCanvas3D.prototype.removeDisplayedItems=function(e,t,i,n){if(e instanceof Group3D)for(var o=e.getChildren(),r=0;r<o.length;r++)this.removeDisplayedItems(o[r],t,i,n);else if(e instanceof Link3D)this.removeDisplayedItems(e.getSharedGroup(),t,i,n);else if(e instanceof Shape3D){var l=e.getGeometries().length;for(r=i.length-1;l>0&&r>=0;r--){var a=i[r];if(a.node===e){if(e.getCapability(Shape3D.ALLOW_GEOMETRY_WRITE))this.clearGeometryBuffers(a);else for(var s=0;s<t.length;s++){var h=t[s];if(h.nodeGeometry===a.nodeGeometry){0==--h.referenceCount&&(this.clearGeometryBuffers(a),t.splice(s,1));break}}i.splice(r,1),l--}}}else if(e instanceof Light3D)for(r=0;r<n.length;r++)if(n[r].node===e){n.splice(r,1);break}},HTMLCanvas3D.prototype.removeNodeListeners=function(e){for(var t=e.getPropertyChangeListeners(),i=0;i<t.length;i++)t[i].canvas3D===this&&e.removePropertyChangeListener(t[i]);if(e instanceof Group3D){t=e.getChildrenListeners();for(i=0;i<t.length;i++)t[i].canvas3D===this&&e.removeChildrenListener(t[i]);var n=e.getChildren();for(i=0;i<n.length;i++)this.removeNodeListeners(n[i])}else e instanceof Link3D&&this.removeNodeListeners(e.getSharedGroup())},HTMLCanvas3D.prototype.prepareTexture=function(e){if(void 0!==e.url)for(var t=0;t<this.textures.length;t++)if(this.textures[t].image.url==e.url)return this.textures[t];var i=this.gl.createTexture();if(null!==i){if(i.image=e,0!==e.width)this.bindTextureAndRepaint(i,!0);else{var n=this,o=function(){e.removeEventListener("load",o),n.bindTextureAndRepaint(i,!1)};e.addEventListener("load",o)}return this.textures.push(i),i}return console.log("Can't create texture"),this.errorTexture},HTMLCanvas3D.resizeTransparentTextures=!0,HTMLCanvas3D.prototype.bindTextureAndRepaint=function(e,t){if(Appearance3D.isPowerOfTwo(e.image.naturalWidth)&&Appearance3D.isPowerOfTwo(e.image.naturalHeight)||e.image.transparent&&!HTMLCanvas3D.resizeTransparentTextures)this.bindTexture(e),t||this.repaint();else{var i=document.createElement("canvas");i.width=Appearance3D.getNextHighestPowerOfTwo(e.image.naturalWidth),i.height=Appearance3D.getNextHighestPowerOfTwo(e.image.naturalHeight),i.getContext("2d").drawImage(e.image,0,0,e.image.naturalWidth,e.image.naturalHeight,0,0,i.width,i.height);var n=new Image;n.crossOrigin="anonymous",n.url=e.image.url,n.transparent=e.image.transparent;var o=this,r=function(){n.removeEventListener("load",r),o.bindTexture(e),o.repaint()};n.addEventListener("load",r),n.src=i.toDataURL(),e.image=n}},HTMLCanvas3D.prototype.bindTexture=function(e){this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!0),this.gl.pixelStorei(this.gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,e.image),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),Appearance3D.isPowerOfTwo(e.image.naturalWidth)&&Appearance3D.isPowerOfTwo(e.image.naturalHeight)?(this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR_MIPMAP_NEAREST),this.gl.generateMipmap(this.gl.TEXTURE_2D)):(this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE)),this.gl.bindTexture(this.gl.TEXTURE_2D,null),delete e.image.src,e.image.bound=!0},HTMLCanvas3D.prototype.prepareBuffer=function(e,t){if(t.length>0&&e.length>0){var i=this.gl.createBuffer();this.gl.bindBuffer(this.gl.ARRAY_BUFFER,i);for(var n=e[0].length,o=new Float32Array(t.length*n),r=0,l=0;r<t.length;r++,l+=n)o.set(e[t[r]],l);return this.gl.bufferData(this.gl.ARRAY_BUFFER,o,this.gl.STATIC_DRAW),i}return null},HTMLCanvas3D.prototype.drawScene=function(){this.gl.viewport(0,0,this.viewportWidth,this.viewportHeight);var e=getComputedStyle(this.canvas).backgroundColor;if(""==e&&(e=this.canvas.style.backgroundColor),e=e.substring(4,e.length-1).replace(/ /g,"").split(","),this.gl.clearColor(e[0]/256,e[1]/256,e[2]/256,4===e.length?e[3]:1),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),null!==this.scene){for(var t=vec3.create(),i=0,n=[],o=[],r=mat4.invert(mat4.create(),this.viewPlatformTransform),l=mat4.create(),a=0;a<this.lights.length;a++){var s=this.lights[a];if(void 0!==s.direction){var h=vec3.transformMat3(vec3.create(),s.direction,mat3.fromMat4(mat3.create(),mat4.mul(l,r,s.transform)));vec3.normalize(h,h),vec3.negate(h,h),n.push.apply(n,s.color),o.push.apply(o,h),i++}else vec3.add(t,t,s.color)}if(this.gl.uniform1i(this.shaderProgram.directionalLightCount,i),i<HTMLCanvas3D.MAX_DIRECTIONAL_LIGHT){for(var u=new Array(3*(HTMLCanvas3D.MAX_DIRECTIONAL_LIGHT-i)),d=0;d<u.length;d++)u[d]=0;n.push.apply(n,u),o.push.apply(o,u)}this.gl.uniform3fv(this.shaderProgram.directionalLightColors,n),this.gl.uniform3fv(this.shaderProgram.lightDirections,o);var c=2*Math.atan(this.viewportHeight/this.viewportWidth*Math.tan(this.fieldOfView/2)),p=mat4.create();this.projectionPolicy===HTMLCanvas3D.PARALLEL_PROJECTION?mat4.ortho(p,-1,1,-1,1,.001,1):mat4.perspective(p,c,this.viewportWidth/this.viewportHeight,.001,1),this.gl.uniformMatrix4fv(this.shaderProgram.projectionTransform,!1,p);var g=mat4.clone(this.viewPlatformTransform);g[12]=0,g[13]=0,g[14]=0;var m=mat4.invert(mat4.create(),g);for(a=0;a<this.backgroundGeometries.length;a++){var f=this.backgroundGeometries[a];this.drawGeometry(f,m,t,f.lightingEnabled,!0,!0)}this.gl.clear(this.gl.DEPTH_BUFFER_BIT),this.getVirtualWorldToImageTransform(p),this.gl.uniformMatrix4fv(this.shaderProgram.projectionTransform,!1,p),this.gl.enable(this.gl.DEPTH_TEST);var v=[];for(a=0;a<this.sceneGeometries.length;a++){(S=this.sceneGeometries[a]).visible&&(void 0!==S.transparency&&1!==S.transparency||void 0!==S.texture&&void 0!==S.texture.image&&S.texture.image.transparent?S.transparency>0&&v.push(S):this.drawGeometry(S,r,t,S.lightingEnabled,!0,!0))}this.gl.enable(this.gl.BLEND),this.gl.blendFunc(this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA);var _=vec3.create();for(a=0;a<v.length;a++){var S=v[a];vec3.transformMat4(_,S.center,S.transform),vec3.transformMat4(_,_,r),S.zOrder=_[2]}v.sort((function(e,t){return e.zOrder-t.zOrder}));for(a=0;a<v.length;a++){S=v[a];this.drawGeometry(S,r,t,S.lightingEnabled,!0,!0)}}var y=Date.now();Math.floor(y/1e3)>Math.floor(this.lastDrawSceneTime/1e3)&&(this.framesPerSecond=Math.round(this.drawnFrameCount/(y-this.previousFramesPerSecondTime)*1e4)/10,this.previousFramesPerSecondTime=y,this.drawnFrameCount=0),void 0===this.drawnFrameCount&&(this.previousFramesPerSecondTime=y,this.drawnFrameCount=0),this.drawnFrameCount++,this.lastDrawSceneTime=y},HTMLCanvas3D.prototype.drawGeometry=function(e,t,i,n,o,r){if(e.cullFace!==this.shaderCullFace&&(this.shaderCullFace=e.cullFace,void 0!==this.shaderCullFace?this.shaderCullFace===Appearance3D.CULL_NONE?this.gl.disable(this.gl.CULL_FACE):(this.gl.enable(this.gl.CULL_FACE),this.gl.cullFace(this.shaderCullFace===Appearance3D.CULL_BACK?this.gl.BACK:this.gl.FRONT)):(this.gl.enable(this.gl.CULL_FACE),this.gl.cullFace(this.gl.BACK))),mat4.copy(this.geometryModelViewTransform,t),mat4.mul(this.geometryModelViewTransform,this.geometryModelViewTransform,e.transform),mat4.exactEquals(this.shaderModelViewTransform,this.geometryModelViewTransform)||(mat4.copy(this.shaderModelViewTransform,this.geometryModelViewTransform),this.gl.uniformMatrix4fv(this.shaderProgram.modelViewTransform,!1,this.shaderModelViewTransform)),this.shaderLightingEnabled!==n&&(this.shaderLightingEnabled=n,this.gl.uniform1i(this.shaderProgram.lightingEnabled,this.shaderLightingEnabled)),n&&(void 0!==e.ambientColor&&void 0===e.texture?vec3.mul(this.geometryAmbientColor,e.ambientColor,i):vec3.set(this.geometryAmbientColor,0,0,0),vec3.exactEquals(this.shaderAmbientColor,this.geometryAmbientColor)||(vec3.copy(this.shaderAmbientColor,this.geometryAmbientColor),this.gl.uniform3fv(this.shaderProgram.ambientColor,this.shaderAmbientColor)),this.ignoreShininess||void 0===e.specularColor||void 0===e.shininess?vec3.set(this.geometrySpecularColor,0,0,0):(this.shaderShininess!==e.shininess&&(this.shaderShininess=e.shininess,this.gl.uniform1f(this.shaderProgram.shininess,this.shaderShininess)),vec3.copy(this.geometrySpecularColor,e.specularColor)),vec3.exactEquals(this.shaderSpecularColor,this.geometrySpecularColor)||(vec3.copy(this.shaderSpecularColor,this.geometrySpecularColor),this.gl.uniform3fv(this.shaderProgram.vertexSpecularColor,this.shaderSpecularColor)),mat3.fromMat4(this.geometryNormalTransform,this.geometryModelViewTransform),mat3.exactEquals(this.shaderNormalTransform,this.geometryNormalTransform)||(mat3.copy(this.shaderNormalTransform,this.geometryNormalTransform),this.gl.uniformMatrix3fv(this.shaderProgram.normalTransform,!1,this.shaderNormalTransform)),this.shaderIgnoreNormal!==(e.mode===this.gl.LINES)&&(this.shaderIgnoreNormal=e.mode===this.gl.LINES,this.gl.uniform1i(this.shaderProgram.ignoreNormal,this.shaderIgnoreNormal)),this.shaderBackFaceNormalFlip!==e.backFaceNormalFlip&&(this.shaderBackFaceNormalFlip=e.backFaceNormalFlip,this.gl.uniform1i(this.shaderProgram.backFaceNormalFlip,this.shaderBackFaceNormalFlip))),vec3.set(this.geometryDiffuseColor,1,1,1),o&&void 0!==e.texture&&(void 0===e.texture.image||e.texture.image.bound)){this.gl.activeTexture(this.gl.TEXTURE0),e.textureCoordinatesGeneration?(this.gl.uniform4fv(this.shaderProgram.planeS,e.textureCoordinatesGeneration.planeS),this.gl.uniform4fv(this.shaderProgram.planeT,e.textureCoordinatesGeneration.planeT),this.shaderTextureCoordinatesGenerated||(this.shaderTextureCoordinatesGenerated=!0,this.gl.uniform1i(this.shaderProgram.textureCoordinatesGenerated,!0))):null===e.textureCoordinatesBuffer?(this.gl.uniform4fv(this.shaderProgram.planeS,HTMLCanvas3D.VEC4_DEFAULT_PLANE_S),this.gl.uniform4fv(this.shaderProgram.planeT,HTMLCanvas3D.VEC4_DEFAULT_PLANE_T),this.shaderTextureCoordinatesGenerated||(this.shaderTextureCoordinatesGenerated=!0,this.gl.uniform1i(this.shaderProgram.textureCoordinatesGenerated,!0))):this.shaderTextureCoordinatesGenerated&&(this.shaderTextureCoordinatesGenerated=!1,this.gl.uniform1i(this.shaderProgram.textureCoordinatesGenerated,!1));var l=void 0!==e.textureTransform?e.textureTransform:HTMLCanvas3D.MAT3_IDENTITY;mat3.exactEquals(this.shaderTextureTransform,l)||(mat3.copy(this.shaderTextureTransform,l),this.gl.uniformMatrix3fv(this.shaderProgram.textureCoordTransform,!1,this.shaderTextureTransform)),this.gl.bindTexture(this.gl.TEXTURE_2D,e.texture),this.shaderUseTextures||(this.shaderUseTextures=!0,this.gl.uniform1i(this.shaderProgram.useTextures,!0))}else this.shaderTextureCoordinatesGenerated&&(this.shaderTextureCoordinatesGenerated=!1,this.gl.uniform1i(this.shaderProgram.textureCoordinatesGenerated,!1)),this.shaderUseTextures&&(this.shaderUseTextures=!1,this.gl.uniform1i(this.shaderProgram.useTextures,!1)),void 0!==e.diffuseColor&&vec3.copy(this.geometryDiffuseColor,e.diffuseColor);vec3.exactEquals(this.shaderDiffuseColor,this.geometryDiffuseColor)||(vec3.copy(this.shaderDiffuseColor,this.geometryDiffuseColor),this.gl.uniform3fv(this.shaderProgram.vertexDiffuseColor,this.shaderDiffuseColor)),this.gl.enableVertexAttribArray(this.shaderProgram.vertexPositionAttribute),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,e.vertexBuffer),this.gl.vertexAttribPointer(this.shaderProgram.vertexPositionAttribute,3,this.gl.FLOAT,!1,0,0),n&&e.mode===this.gl.TRIANGLES?(this.gl.enableVertexAttribArray(this.shaderProgram.normalAttribute),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,e.normalBuffer),this.gl.vertexAttribPointer(this.shaderProgram.normalAttribute,3,this.gl.FLOAT,!1,0,0)):this.gl.disableVertexAttribArray(this.shaderProgram.normalAttribute),o&&null!==e.textureCoordinatesBuffer&&void 0!==e.texture?(this.gl.enableVertexAttribArray(this.shaderProgram.textureCoordAttribute),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,e.textureCoordinatesBuffer),this.gl.vertexAttribPointer(this.shaderProgram.textureCoordAttribute,2,this.gl.FLOAT,!1,0,0)):this.gl.disableVertexAttribArray(this.shaderProgram.textureCoordAttribute);var a=e.transparency&&r?e.transparency:1;this.shaderAlpha!==a&&(this.shaderAlpha=a,this.gl.uniform1f(this.shaderProgram.alpha,this.shaderAlpha)),this.gl.drawArrays(e.mode,0,e.vertexCount)},HTMLCanvas3D.prototype.getFramesPerSecond=function(){return this.framesPerSecond},HTMLCanvas3D.prototype.repaint=function(){if(!this.canvasNeededRepaint&&(this.canvasNeededRepaint=!0,!this.offscreen)){var e=this;requestAnimationFrame((function(){e.canvasNeededRepaint&&(e.drawScene(),e.canvasNeededRepaint=!1,e.pickingFrameBufferNeededRepaint=!0)}))}},HTMLCanvas3D.prototype.getVirtualWorldToImageTransform=function(e,t){void 0===t&&(t=this.viewportWidth/this.viewportHeight);var i=2*Math.atan(Math.tan(this.fieldOfView/2)/t);return this.projectionPolicy===HTMLCanvas3D.PARALLEL_PROJECTION?mat4.ortho(e,-1,1,-1,1,this.frontClipDistance,this.backClipDistance):mat4.perspective(e,i,t,this.frontClipDistance,this.backClipDistance),e},HTMLCanvas3D.prototype.isLoadingCompleted=function(){return this.isTextureLoadingCompleted(this.backgroundGeometries)&&this.isTextureLoadingCompleted(this.sceneGeometries)},HTMLCanvas3D.prototype.isTextureLoadingCompleted=function(e){for(var t=0;t<e.length;t++){var i=e[t].texture;if(void 0!==i&&void 0!==i.image&&!i.image.bound)return!1}return!0},HTMLCanvas3D.prototype.getImage=function(e){this.canvasNeededRepaint&&(this.drawScene(),this.canvasNeededRepaint=!1);var t,i=new Image;return i.crossOrigin="anonymous",void 0!==e&&(t=function(n){i.removeEventListener("load",t),e(i)},i.addEventListener("load",t)),i.src=this.canvas.toDataURL(),0!==i.width&&void 0!==e&&t(),i},HTMLCanvas3D.prototype.clear=function(){for(var e=0;e<this.textures.length;e++)delete this.textures[e].src,this.gl.deleteTexture(this.textures[e]);this.textures=[],this.gl.deleteTexture(this.errorTexture),this.errorTexture=null,this.clearGeometries(this.sharedGeometries),this.clearGeometries(this.sceneGeometries),this.clearGeometries(this.backgroundGeometries),this.lights=[],void 0!==this.pickingFrameBuffer&&(this.gl.deleteFramebuffer(this.pickingFrameBuffer),delete this.pickingFrameBuffer);var t=this.gl.getAttachedShaders(this.shaderProgram);for(e=0;e<t.length;e++)this.gl.detachShader(this.shaderProgram,t[e]);this.scene=null,this.repaint()},HTMLCanvas3D.prototype.clearGeometries=function(e){for(var t=0;t<e.length;t++)this.clearGeometryBuffers(e[t]);e.length=0},HTMLCanvas3D.prototype.clearGeometryBuffers=function(e){this.gl.deleteBuffer(e.vertexBuffer),null!==e.textureCoordinatesBuffer&&void 0!==e.texture&&this.gl.deleteBuffer(e.textureCoordinatesBuffer),void 0!==e.normalBuffer&&this.gl.deleteBuffer(e.normalBuffer)},HTMLCanvas3D.prototype.setProjectionPolicy=function(e){this.projectionPolicy=e},HTMLCanvas3D.prototype.setIgnoreShininess=function(e){this.ignoreShininess=e,this.repaint()},HTMLCanvas3D.prototype.getClosestShapeAt=function(e,t){if(void 0===this.pickingFrameBuffer){this.pickingFrameBuffer=this.gl.createFramebuffer(),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.pickingFrameBuffer),this.pickingFrameBuffer.width=Appearance3D.isPowerOfTwo(this.canvas.width)?this.canvas.width:Appearance3D.getNextHighestPowerOfTwo(this.canvas.width),this.pickingFrameBuffer.height=Appearance3D.isPowerOfTwo(this.canvas.height)?this.canvas.height:Appearance3D.getNextHighestPowerOfTwo(this.canvas.height),this.pickingFrameBuffer.colorMap=new Uint8Array(this.pickingFrameBuffer.width*this.pickingFrameBuffer.height*4);var i=this.gl.createTexture();this.gl.bindTexture(this.gl.TEXTURE_2D,i),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.pickingFrameBuffer.width,this.pickingFrameBuffer.height,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,null);var n=this.gl.createRenderbuffer();this.gl.bindRenderbuffer(this.gl.RENDERBUFFER,n),this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER,this.gl.COLOR_ATTACHMENT0,this.gl.TEXTURE_2D,i,0),this.gl.renderbufferStorage(this.gl.RENDERBUFFER,this.gl.DEPTH_COMPONENT16,this.pickingFrameBuffer.width,this.pickingFrameBuffer.height),this.gl.framebufferRenderbuffer(this.gl.FRAMEBUFFER,this.gl.DEPTH_ATTACHMENT,this.gl.RENDERBUFFER,n),this.gl.bindTexture(this.gl.TEXTURE_2D,null)}if(this.pickingFrameBufferNeededRepaint){this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.pickingFrameBuffer),this.gl.viewport(0,0,this.pickingFrameBuffer.width,this.pickingFrameBuffer.height),this.gl.clearColor(1,1,1,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT);var o=mat4.create();this.getVirtualWorldToImageTransform(o,this.canvas.width/this.canvas.height),this.gl.uniformMatrix4fv(this.shaderProgram.projectionTransform,!1,o),this.gl.enable(this.gl.DEPTH_TEST);for(var r=mat4.invert(mat4.create(),this.viewPlatformTransform),l=vec3.create(),a=0;a<this.sceneGeometries.length;a++){var s=this.sceneGeometries[a];if(s.visible&&s.node.isPickable()){var h=s.diffuseColor;vec3.set(l,(a>>>16&255)/255,(a>>>8&255)/255,(255&a)/255),s.diffuseColor=l,this.drawGeometry(s,r,null,!1,!1,!1),void 0!==h&&(s.diffuseColor=h)}}this.gl.readPixels(0,0,this.pickingFrameBuffer.width,this.pickingFrameBuffer.height,this.gl.RGBA,this.gl.UNSIGNED_BYTE,this.pickingFrameBuffer.colorMap),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this.pickingFrameBufferNeededRepaint=!1}var u=this.canvas.getBoundingClientRect();if(e>=u.left&&t>=u.top&&e<u.right&&t<u.bottom){e-=u.left,t-=u.top;var d=(this.pickingFrameBuffer.height-1-Math.floor(t/u.height*this.pickingFrameBuffer.height))*this.pickingFrameBuffer.width+Math.floor(e/u.width*this.pickingFrameBuffer.width);d*=4;var c=65536*this.pickingFrameBuffer.colorMap[d]+256*this.pickingFrameBuffer.colorMap[d+1]+this.pickingFrameBuffer.colorMap[d+2];if(16777215!=c)return this.sceneGeometries[c].node}return null};var CoreTools={unavailableResources:[],loadJSON:function(e,t){if(0!==e.indexOf("/")&&e.indexOf("://")<0&&(e=ZIPTools.getScriptFolder()+e),CoreTools.unavailableResources.indexOf(e)<0)try{var i=new XMLHttpRequest;if(i.open("GET",e,void 0!==t),void 0!==t&&(i.addEventListener("load",(function(){if(i.readyState===XMLHttpRequest.DONE)if(0===i.status||200===i.status)try{t.jsonLoaded(JSON.parse(i.responseText))}catch(i){CoreTools.unavailableResources.push(e),void 0!==t&&void 0!==t.jsonError&&t.jsonError(i,i.message)}else void 0!==t.jsonError&&t.jsonError(i.status,i.statusText)})),i.addEventListener("error",(function(){CoreTools.unavailableResources.push(e),void 0!==t.jsonError&&t.jsonError(i.status,i.statusText)}))),i.send(),void 0===t)return JSON.parse(i.responseText)}catch(i){CoreTools.unavailableResources.push(e),void 0!==t&&void 0!==t.jsonError&&t.jsonError(i,i.message)}else void 0!==t&&void 0!==t.jsonError&&t.jsonError(404,"No "+e)},format:function(e,t){if(void 0===t||0===t.length)return e;var i,n=/%%|%08X|%s|%d|%\d+\$s|%\d+\$d/g,o="",r=0,l=Array.isArray(t)?t:Array.prototype.slice.call(arguments,1),a=0;for(n.lastIndex=0;null!==(i=n.exec(e));){var s;if(o+=e.slice(r,n.lastIndex-i[0].length),"%%"==i[0]&&(o+="%"),"%08X"==i[0]){var h=l[0];h<0&&(h=4294967295+h+1);for(var u=h.toString(16).toUpperCase(),d=8-u.length;d>0;d--)o+="0";o+=u}else{if(null!==(s=/%(\d+)\$s/g.exec(i[0])))o+=l[parseInt(s[1])-1];else if(null!==(s=/%(\d+)\$d/g.exec(i[0])))o+=l[parseInt(s[1])-1];else a<l.length&&(o+=l[a],a++)}r=n.lastIndex}return o+=e.slice(r)},removeAccents:function(e){return null!=e?"function"==typeof e.normalize?e.normalize("NFD").replace(/[\u0300-\u036f]/g,""):e.replace(/[]/g,"a").replace(/[]/g,"e").replace(/[]/g,"i").replace(/[]/g,"o").replace(/[]/g,"u"):e},loadResourceBundles:function(e,t,i){var n=i?"?requestId="+UUID.randomUUID():"",o=[];return t&&(o.push(CoreTools.loadJSON(e+"_"+t+".json"+n)),t.indexOf("_")>0&&o.push(CoreTools.loadJSON(e+"_"+t.split("_")[0]+".json"+n))),o.push(CoreTools.loadJSON(e+".json"+n)),o},getStringFromKey:function(e,t,i){for(var n=0;n<e.length;n++)if(null!=e[n]&&void 0!==e[n][t])return CoreTools.format.apply(null,[e[n][t]].concat(Array.prototype.slice.call(arguments,2)));throw new IllegalArgumentException("Can't find resource bundle for "+t)},getKeys:function(e){for(var t={},i=0;i<e.length;i++)null!=e[i]&&CoreTools.merge(t,e[i]);return Object.getOwnPropertyNames(t)},getFromMap:function(e,t){if("string"==typeof t)return void 0===e[t]?null:e[t];null==e.entries&&(e.entries=[]);for(var i="function"==typeof t.hashCode?t.hashCode():void 0,n=0;n<e.entries.length;n++)if((void 0===i||e.entries[n].keyHashCode===i)&&void 0!==e.entries[n].key.equals&&e.entries[n].key.equals(t)||e.entries[n].key===t)return e.entries[n].value;return null},putToMap:function(e,t,i){if("string"==typeof t)e[t]=i;else{null==e.entries&&(e.entries=[]);for(var n="function"==typeof t.hashCode?t.hashCode():void 0,o=0;o<e.entries.length;o++)if((void 0===n||e.entries[o].keyHashCode===n)&&void 0!==e.entries[o].key.equals&&e.entries[o].key.equals(t)||e.entries[o].key===t)return void(e.entries[o].value=i);var r={key:t,value:i,getKey:function(){return this.key},getValue:function(){return this.value}};"function"==typeof t.hashCode&&(r.keyHashCode=t.hashCode()),e.entries.push(r)}},removeFromMap:function(e,t){if("string"==typeof t)return void 0!==(o=e[t])&&delete e[t],void 0!==o?o:null;for(var i="function"==typeof t.hashCode?t.hashCode():void 0,n=0;n<e.entries.length;n++)if((void 0===i||e.entries[n].keyHashCode===i)&&void 0!==e.entries[n].key.equals&&e.entries[n].key.equals(t)||e.entries[n].key===t){var o=e.entries[n].value;return e.entries.splice(n,1),o}return null},valuesFromMap:function(e){var t=[];return void 0===e.entries?Object.getOwnPropertyNames(e).forEach((function(i){t.push(e[i])})):e.entries.forEach((function(e){t.push(e.value)})),t},sortArray:function(e,t){t.compare?e.sort((function(e,i){return t.compare(e,i)})):e.sort(t)},merge:function(e,t){for(var i in t)e[i]=t[i]},intersection:function(e,t){return e.filter((function(e){return-1!==t.indexOf(e)}))},loadAvailableFontNames:function(e){var t=["Arial","Arial Black","Bahnschrift","Calibri","Cambria","Cambria Math","Candara","Comic Sans MS","Consolas","Constantia","Corbel","Courier New","Ebrima","Franklin Gothic Medium","Gabriola","Gadugi","Georgia","HoloLens MDL2 Assets","Impact","Ink Free","Javanese Text","Leelawadee UI","Lucida Console","Lucida Sans Unicode","Malgun Gothic","Marlett","Microsoft Himalaya","Microsoft JhengHei","Microsoft New Tai Lue","Microsoft PhagsPa","Microsoft Sans Serif","Microsoft Tai Le","Microsoft YaHei","Microsoft Yi Baiti","MingLiU-ExtB","Mongolian Baiti","MS Gothic","MV Boli","Myanmar Text","Nirmala UI","Palatino Linotype","Segoe MDL2 Assets","Segoe Print","Segoe Script","Segoe UI","Segoe UI Historic","Segoe UI Emoji","Segoe UI Symbol","SimSun","Sitka","Sylfaen","Symbol","Tahoma","Times New Roman","Trebuchet MS","Verdana","Webdings","Wingdings","Yu Gothic"],i=["American Typewriter","Andale Mono","Arial","Arial Black","Arial Narrow","Arial Rounded MT Bold","Arial Unicode MS","Avenir","Avenir Next","Avenir Next Condensed","Baskerville","Big Caslon","Bodoni 72","Bodoni 72 Oldstyle","Bodoni 72 Smallcaps","Bradley Hand","Brush Script MT","Chalkboard","Chalkboard SE","Chalkduster","Charter","Cochin","Comic Sans MS","Copperplate","Courier","Courier New","Didot","DIN Alternate","DIN Condensed","Futura","Geneva","Georgia","Gill Sans","Helvetica","Helvetica Neue","Herculanum","Hoefler Text","Impact","Lucida Grande","Luminari","Marker Felt","Menlo","Microsoft Sans Serif","Monaco","Noteworthy","Optima","Palatino","Papyrus","Phosphate","Rockwell","Savoye LET","SignPainter","Skia","Snell Roundhand","Tahoma","Times","Times New Roman","Trattatello","Trebuchet MS","Verdana","Zapfino"];document.fonts&&!document.fonts.check("12px '@$#%#$@")?document.fonts.ready.then((function(){for(var n=[],o=t.concat(i),r=0;r<o.length;r++){var l=o[r];n.indexOf(l)<0&&document.fonts.check("12px '"+l+"'")&&n.push(l)}e(n.sort())})):OperatingSystem.isWindows()?e(t):OperatingSystem.isMacOSX()?e(i):e(["Arial","Brush Script MT","Courier New","Garamond","Georgia","Helvetica","Tahoma","Times New Roman","Trebuchet MS","Verdana"])}},ColorTools={integerToHexadecimalString:function(e){return"#"+("00000"+(16777215&e).toString(16).toUpperCase()).slice(-6)},styleToHexadecimalString:function(e){var t="rgb(",i=e.indexOf(t);if(i<0&&(t="rgba(",i=e.indexOf(t)),i>=0){var n=e.slice(t.length,e.indexOf(")")).split(",");return ColorTools.integerToHexadecimalString((parseInt(n[0])<<16)+(parseInt(n[1])<<8)+parseInt(n[2]))}return""},styleToInteger:function(e){var t="rgb(",i=e.indexOf(t);if(i<0&&(t="rgba(",i=e.indexOf(t)),i>=0){var n=e.slice(t.length,e.indexOf(")")).split(",");return(parseInt(n[0])<<16)+(parseInt(n[1])<<8)+parseInt(n[2])}return-1},isTransparent:function(e){var t="rgba(";if(e.indexOf(t)>=0){var i=e.slice(5,e.indexOf(")")).split(",");return 0===parseFloat(i[3])}return!1},hexadecimalStringToInteger:function(e){return 0!==e.indexOf("#")||7!==e.length&&9!==e.length?-1:(e=e.slice(1),(parseInt(e.slice(0,2),16)<<16)+(parseInt(e.slice(2,4),16)<<8)+parseInt(e.slice(4,6),16))},toRGBAStyle:function(e,t){var i=ColorTools.hexadecimalStringToInteger(e);return"rgba("+((16711680&i)>>16)+","+((65280&i)>>8)+","+(255&i)+","+t+")"}},ImageTools={};function ModelLoader(e){this.modelExtension=e,this.parserBusy=!1,this.waitingParsedEntries=[]}function OBJLoader(){ModelLoader.call(this,"obj"),null===OBJLoader.defaultAppearances&&(OBJLoader.defaultAppearances={},OBJLoader.parseMaterial("newmtl amber\nKa 0.0531 0.0531 0.0531\nKd 0.5755 0.2678 0.0000\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 60.0000\n\nnewmtl amber_trans\nKa 0.0531 0.0531 0.0531\nKd 0.5755 0.2678 0.0000\nKs 0.3000 0.3000 0.3000\nillum 2\nd 0.1600\nNs 60.0000\n\nnewmtl charcoal\nKa 0.0082 0.0082 0.0082\nKd 0.0041 0.0041 0.0041\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 60.0000\n\nnewmtl lavendar\nKa 0.1281 0.0857 0.2122\nKd 0.2187 0.0906 0.3469\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 60.0000\n\nnewmtl navy_blue\nKa 0.0000 0.0000 0.0490\nKd 0.0000 0.0000 0.0531\nKs 0.1878 0.1878 0.1878\nillum 2\nNs 91.4700\n\nnewmtl pale_green\nKa 0.0444 0.0898 0.0447\nKd 0.0712 0.3796 0.0490\nKs 0.1878 0.1878 0.1878\nillum 2\nNs 91.4700\n\nnewmtl pale_pink\nKa 0.0898 0.0444 0.0444\nKd 0.6531 0.2053 0.4160\nKs 0.1878 0.1878 0.1878\nillum 2\nNs 91.4700\n\nnewmtl pale_yellow\nKa 0.3606 0.3755 0.0935\nKd 0.6898 0.6211 0.1999\nKs 0.1878 0.1878 0.1878\nillum 2\nNs 91.4700\n\nnewmtl peach\nKa 0.3143 0.1187 0.0167\nKd 0.6367 0.1829 0.0156\nKs 0.1878 0.1878 0.1878\nillum 2\nNs 91.4700\n\nnewmtl periwinkle\nKa 0.0000 0.0000 0.1184\nKd 0.0000 0.0396 0.8286\nKs 0.1878 0.1878 0.1878\nillum 2\nNs 91.4700\n\nnewmtl redwood\nKa 0.0204 0.0027 0.0000\nKd 0.2571 0.0330 0.0000\nKs 0.1878 0.1878 0.1878\nillum 2\nNs 91.4700\n\nnewmtl smoked_glass\nKa 0.0000 0.0000 0.0000\nKd 0.0041 0.0041 0.0041\nKs 0.1878 0.1878 0.1878\nillum 2\nd 0.0200\nNs 91.4700\n\nnewmtl aqua_filter\nKa 0.0000 0.0000 0.0000\nKd 0.3743 0.6694 0.5791\nKs 0.1878 0.1878 0.1878\nillum 2\nd 0.0200\nNs 91.4700\n\nnewmtl yellow_green\nKa 0.0000 0.0000 0.0000\nKd 0.1875 0.4082 0.0017\nKs 0.1878 0.1878 0.1878\nillum 2\nNs 91.4700\n\nnewmtl bluetint\nKa 0.1100 0.4238 0.5388\nKd 0.0468 0.7115 0.9551\nKs 0.3184 0.3184 0.3184\nillum 9\nd 0.4300\nNs 60.0000\nsharpness 60.0000\n\nnewmtl plasma\nKa 0.4082 0.0816 0.2129\nKd 1.0000 0.0776 0.4478\nKs 0.3000 0.3000 0.3000\nillum 9\nd 0.2500\nNs 60.0000\nsharpness 60.0000\n\nnewmtl emerald\nKa 0.0470 1.0000 0.0000\nKd 0.0470 1.0000 0.0000\nKs 0.2000 0.2000 0.2000\nillum 9\nd 0.2500\nNs 60.0000\nsharpness 60.0000\n\nnewmtl ruby\nKa 1.0000 0.0000 0.0000\nKd 1.0000 0.0000 0.0000\nKs 0.2000 0.2000 0.2000\nillum 9\nd 0.2500\nNs 60.0000\nsharpness 60.0000\n\nnewmtl sapphire\nKa 0.0235 0.0000 1.0000\nKd 0.0235 0.0000 1.0000\nKs 0.2000 0.2000 0.2000\nillum 9\nd 0.2500\nNs 60.0000\nsharpness 60.0000\n\nnewmtl white\nKa 0.4000 0.4000 0.4000\nKd 1.0000 1.0000 1.0000\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 60.0000\n\nnewmtl red\nKa 0.4449 0.0000 0.0000\nKd 0.7714 0.0000 0.0000\nKs 0.8857 0.0000 0.0000\nillum 2\nNs 136.4300\n\nnewmtl blue_pure\nKa 0.0000 0.0000 0.5000\nKd 0.0000 0.0000 1.0000\nKs 0.0000 0.0000 0.5000\nillum 2\nNs 65.8900\n\nnewmtl lime\nKa 0.0000 0.5000 0.0000\nKd 0.0000 1.0000 0.0000\nKs 0.0000 0.5000 0.0000\nillum 2\nNs 65.8900\n\nnewmtl green\nKa 0.0000 0.2500 0.0000\nKd 0.0000 0.2500 0.0000\nKs 0.0000 0.2500 0.0000\nillum 2\nNs 65.8900\n\nnewmtl yellow\nKa 1.0000 0.6667 0.0000\nKd 1.0000 0.6667 0.0000\nKs 1.0000 0.6667 0.0000\nillum 2\nNs 65.8900\n\nnewmtl purple\nKa 0.5000 0.0000 1.0000\nKd 0.5000 0.0000 1.0000\nKs 0.5000 0.0000 1.0000\nillum 2\nNs 65.8900\n\nnewmtl orange\nKa 1.0000 0.1667 0.0000\nKd 1.0000 0.1667 0.0000\nKs 1.0000 0.1667 0.0000\nillum 2\nNs 65.8900\n\nnewmtl grey\nKa 0.5000 0.5000 0.5000\nKd 0.1837 0.1837 0.1837\nKs 0.5000 0.5000 0.5000\nillum 2\nNs 65.8900\n\nnewmtl rubber\nKa 0.0000 0.0000 0.0000\nKd 0.0100 0.0100 0.0100\nKs 0.1000 0.1000 0.1000\nillum 2\nNs 65.8900\n\nnewmtl flaqua\nKa 0.0000 0.4000 0.4000\nKd 0.0000 0.5000 0.5000\nillum 1\n\nnewmtl flblack\nKa 0.0000 0.0000 0.0000\nKd 0.0041 0.0041 0.0041\nillum 1\n\nnewmtl flblue_pure\nKa 0.0000 0.0000 0.5592\nKd 0.0000 0.0000 0.7102\nillum 1\n\nnewmtl flgrey\nKa 0.2163 0.2163 0.2163\nKd 0.5000 0.5000 0.5000\nillum 1\n\nnewmtl fllime\nKa 0.0000 0.3673 0.0000\nKd 0.0000 1.0000 0.0000\nillum 1\n\nnewmtl florange\nKa 0.6857 0.1143 0.0000\nKd 1.0000 0.1667 0.0000\nillum 1\n\nnewmtl flpurple\nKa 0.2368 0.0000 0.4735\nKd 0.3755 0.0000 0.7510\nillum 1\n\nnewmtl flred\nKa 0.4000 0.0000 0.0000\nKd 1.0000 0.0000 0.0000\nillum 1\n\nnewmtl flyellow\nKa 0.7388 0.4925 0.0000\nKd 1.0000 0.6667 0.0000\nillum 1\n\nnewmtl pink\nKa 0.9469 0.0078 0.2845\nKd 0.9878 0.1695 0.6702\nKs 0.7429 0.2972 0.2972\nillum 2\nNs 106.2000\n\nnewmtl flbrown\nKa 0.0571 0.0066 0.0011\nKd 0.1102 0.0120 0.0013\nillum 1\n\nnewmtl brown\nKa 0.1020 0.0185 0.0013\nKd 0.0857 0.0147 0.0000\nKs 0.1633 0.0240 0.0000\nillum 2\nNs 65.8900\n\nnewmtl glass\nKa 1.0000 1.0000 1.0000\nKd 0.4873 0.4919 0.5306\nKs 0.6406 0.6939 0.9020\nillum 2\nNs 200.0000\n\nnewmtl flesh\nKa 0.4612 0.3638 0.2993\nKd 0.5265 0.4127 0.3374\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 60.0000\n\nnewmtl aqua\nKa 0.0000 0.4000 0.4000\nKd 0.0000 0.5000 0.5000\nKs 0.5673 0.5673 0.5673\nillum 2\nNs 60.0000\n\nnewmtl black\nKa 0.0000 0.0000 0.0000\nKd 0.0020 0.0020 0.0020\nKs 0.5184 0.5184 0.5184\nillum 2\nNs 157.3600\n\nnewmtl silver\nKa 0.9551 0.9551 0.9551\nKd 0.6163 0.6163 0.6163\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 60.0000\n\nnewmtl dkblue_pure\nKa 0.0000 0.0000 0.0449\nKd 0.0000 0.0000 0.1347\nKs 0.0000 0.0000 0.5673\nillum 2\nNs 65.8900\n\nnewmtl fldkblue_pure\nKa 0.0000 0.0000 0.0449\nKd 0.0000 0.0000 0.1347\nillum 1\n\nnewmtl dkgreen\nKa 0.0000 0.0122 0.0000\nKd 0.0058 0.0245 0.0000\nKs 0.0000 0.0490 0.0000\nillum 2\nNs 60.0000\n\nnewmtl dkgrey\nKa 0.0490 0.0490 0.0490\nKd 0.0490 0.0490 0.0490\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 60.0000\n\nnewmtl ltbrown\nKa 0.1306 0.0538 0.0250\nKd 0.2776 0.1143 0.0531\nKs 0.3000 0.1235 0.0574\nillum 2\nNs 60.0000\n\nnewmtl fldkgreen\nKa 0.0000 0.0122 0.0000\nKd 0.0058 0.0245 0.0000\nillum 1\n\nnewmtl flltbrown\nKa 0.1306 0.0538 0.0250\nKd 0.2776 0.1143 0.0531\nillum 1\n\nnewmtl tan\nKa 0.4000 0.3121 0.1202\nKd 0.6612 0.5221 0.2186\nKs 0.5020 0.4118 0.2152\nillum 2\nNs 60.0000\n\nnewmtl fltan\nKa 0.4000 0.3121 0.1202\nKd 0.6612 0.4567 0.1295\nillum 1\n\nnewmtl brzskin\nKa 0.4408 0.2694 0.1592\nKd 0.3796 0.2898 0.2122\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 25.0000\n\nnewmtl lips\nKa 0.4408 0.2694 0.1592\nKd 0.9265 0.2612 0.2898\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 25.0000\n\nnewmtl redorange\nKa 0.3918 0.0576 0.0000\nKd 0.7551 0.0185 0.0000\nKs 0.4694 0.3224 0.1667\nillum 2\nNs 132.5600\n\nnewmtl blutan\nKa 0.4408 0.2694 0.1592\nKd 0.0776 0.2571 0.2041\nKs 0.1467 0.1469 0.0965\nillum 2\nNs 25.0000\n\nnewmtl bluteal\nKa 0.0041 0.1123 0.1224\nKd 0.0776 0.2571 0.2041\nKs 0.1467 0.1469 0.0965\nillum 2\nNs 25.0000\n\nnewmtl pinktan\nKa 0.4408 0.2694 0.1592\nKd 0.6857 0.2571 0.2163\nKs 0.1467 0.1469 0.0965\nillum 2\nNs 25.0000\n\nnewmtl brnhair\nKa 0.0612 0.0174 0.0066\nKd 0.0898 0.0302 0.0110\nKs 0.1306 0.0819 0.0352\nillum 2\nNs 60.4700\n\nnewmtl blondhair\nKa 0.4449 0.2632 0.0509\nKd 0.5714 0.3283 0.0443\nKs 0.7755 0.4602 0.0918\nillum 2\nNs 4.6500\n\nnewmtl flblonde\nKa 0.4449 0.2632 0.0509\nKd 0.5714 0.3283 0.0443\nillum 1\n\nnewmtl yelloworng\nKa 0.5837 0.1715 0.0000\nKd 0.8857 0.2490 0.0000\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 60.0000\n\nnewmtl bone\nKa 0.3061 0.1654 0.0650\nKd 0.9000 0.7626 0.4261\nKs 0.8939 0.7609 0.5509\nillum 2\nNs 200.0000\n\nnewmtl teeth\nKa 0.6408 0.5554 0.3845\nKd 0.9837 0.7959 0.4694\nillum 1\n\nnewmtl brass\nKa 0.2490 0.1102 0.0000\nKd 0.4776 0.1959 0.0000\nKs 0.5796 0.5796 0.5796\nillum 2\nNs 134.8800\n\nnewmtl dkred\nKa 0.0939 0.0000 0.0000\nKd 0.2286 0.0000 0.0000\nKs 0.2490 0.0000 0.0000\nillum 2\nNs 60.0000\n\nnewmtl taupe\nKa 0.1061 0.0709 0.0637\nKd 0.2041 0.1227 0.1058\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 84.5000\n\nnewmtl dkteal\nKa 0.0000 0.0245 0.0163\nKd 0.0000 0.0653 0.0449\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 55.0400\n\nnewmtl dkdkgrey\nKa 0.0000 0.0000 0.0000\nKd 0.0122 0.0122 0.0122\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 60.0000\n\nnewmtl dkblue\nKa 0.0000 0.0029 0.0408\nKd 0.0000 0.0041 0.0571\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 60.0000\n\nnewmtl gold\nKa 0.7224 0.1416 0.0000\nKd 1.0000 0.4898 0.0000\nKs 0.7184 0.3695 0.3695\nillum 2\nNs 123.2600\n\nnewmtl redbrick\nKa 0.1102 0.0067 0.0067\nKd 0.3306 0.0398 0.0081\nillum 1\n\nnewmtl flmustard\nKa 0.4245 0.2508 0.0000\nKd 0.8898 0.3531 0.0073\nillum 1\n\nnewmtl flpinegreen\nKa 0.0367 0.0612 0.0204\nKd 0.1061 0.2163 0.0857\nillum 1\n\nnewmtl fldkred\nKa 0.0939 0.0000 0.0000\nKd 0.2286 0.0082 0.0082\nillum 1\n\nnewmtl fldkgreen2\nKa 0.0025 0.0122 0.0014\nKd 0.0245 0.0694 0.0041\nillum 1\n\nnewmtl flmintgreen\nKa 0.0408 0.1429 0.0571\nKd 0.1306 0.2898 0.1673\nillum 1\n\nnewmtl olivegreen\nKa 0.0167 0.0245 0.0000\nKd 0.0250 0.0367 0.0000\nKs 0.2257 0.2776 0.1167\nillum 2\nNs 97.6700\n\nnewmtl skin\nKa 0.2286 0.0187 0.0187\nKd 0.1102 0.0328 0.0139\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 17.8300\n\nnewmtl redbrown\nKa 0.1469 0.0031 0.0000\nKd 0.2816 0.0060 0.0000\nKs 0.3714 0.3714 0.3714\nillum 2\nNs 141.0900\n\nnewmtl deepgreen\nKa 0.0000 0.0050 0.0000\nKd 0.0000 0.0204 0.0050\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 113.1800\n\nnewmtl flltolivegreen\nKa 0.0167 0.0245 0.0000\nKd 0.0393 0.0531 0.0100\nillum 1\n\nnewmtl jetflame\nKa 0.7714 0.0000 0.0000\nKd 0.9510 0.4939 0.0980\nKs 0.8531 0.5222 0.0000\nillum 2\nNs 132.5600\n\nnewmtl brownskn\nKa 0.0122 0.0041 0.0000\nKd 0.0204 0.0082 0.0000\nKs 0.0735 0.0508 0.0321\nillum 2\nNs 20.1600\n\nnewmtl greenskn\nKa 0.0816 0.0449 0.0000\nKd 0.0000 0.0735 0.0000\nKs 0.0490 0.1224 0.0898\nillum 3\nNs 46.5100\nsharpness 146.5100\n\nnewmtl ltgrey\nKa 0.5000 0.5000 0.5000\nKd 0.3837 0.3837 0.3837\nKs 0.5000 0.5000 0.5000\nillum 2\nNs 65.8900\n\nnewmtl bronze\nKa 0.0449 0.0204 0.0000\nKd 0.0653 0.0367 0.0122\nKs 0.0776 0.0408 0.0000\nillum 3\nNs 137.2100\nsharpness 125.5800\n\nnewmtl bone1\nKa 0.6408 0.5554 0.3845\nKd 0.9837 0.7959 0.4694\nillum 1\n\nnewmtl flwhite1\nKa 0.9306 0.9306 0.9306\nKd 1.0000 1.0000 1.0000\nillum 1\n\nnewmtl flwhite\nKa 0.6449 0.6116 0.5447\nKd 0.9837 0.9309 0.8392\nKs 0.8082 0.7290 0.5708\nillum 2\nNs 200.0000\n\nnewmtl shadow\nKd 0.0350 0.0248 0.0194\nillum 0\nd 0.2500\n\nnewmtl fldkolivegreen\nKa 0.0056 0.0082 0.0000\nKd 0.0151 0.0204 0.0038\nillum 1\n\nnewmtl fldkdkgrey\nKa 0.0000 0.0000 0.0000\nKd 0.0122 0.0122 0.0122\nillum 1\n\nnewmtl lcdgreen\nKa 0.4000 0.4000 0.4000\nKd 0.5878 1.0000 0.5061\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 60.0000\n\nnewmtl brownlips\nKa 0.1143 0.0694 0.0245\nKd 0.1429 0.0653 0.0408\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 25.0000\n\nnewmtl muscle\nKa 0.2122 0.0077 0.0154\nKd 0.4204 0.0721 0.0856\nKs 0.1184 0.1184 0.1184\nillum 2\nNs 25.5800\n\nnewmtl flltgrey\nKa 0.5224 0.5224 0.5224\nKd 0.8245 0.8245 0.8245\nillum 1\n\nnewmtl offwhite.warm\nKa 0.5184 0.4501 0.3703\nKd 0.8367 0.6898 0.4490\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 60.0000\n\nnewmtl offwhite.cool\nKa 0.5184 0.4501 0.3703\nKd 0.8367 0.6812 0.5703\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 60.0000\n\nnewmtl yellowbrt\nKa 0.4000 0.4000 0.4000\nKd 1.0000 0.7837 0.0000\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 60.0000\n\nnewmtl chappie\nKa 0.4000 0.4000 0.4000\nKd 0.5837 0.1796 0.0367\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 60.0000\n\nnewmtl archwhite\nKa 0.2816 0.2816 0.2816\nKd 0.9959 0.9959 0.9959\nillum 1\n\nnewmtl archwhite2\nKa 0.2816 0.2816 0.2816\nKd 0.8408 0.8408 0.8408\nillum 1\n\nnewmtl lighttan\nKa 0.0980 0.0536 0.0220\nKd 0.7020 0.4210 0.2206\nKs 0.8286 0.8057 0.5851\nillum 2\nNs 177.5200\n\nnewmtl lighttan2\nKa 0.0980 0.0492 0.0144\nKd 0.3143 0.1870 0.0962\nKs 0.8286 0.8057 0.5851\nillum 2\nNs 177.5200\n\nnewmtl lighttan3\nKa 0.0980 0.0492 0.0144\nKd 0.1796 0.0829 0.0139\nKs 0.8286 0.8057 0.5851\nillum 2\nNs 177.5200\n\nnewmtl lightyellow\nKa 0.5061 0.1983 0.0000\nKd 1.0000 0.9542 0.3388\nKs 1.0000 0.9060 0.0000\nillum 2\nNs 177.5200\n\nnewmtl lighttannew\nKa 0.0980 0.0492 0.0144\nKd 0.7878 0.6070 0.3216\nKs 0.8286 0.8057 0.5851\nillum 2\nNs 177.5200\n\nnewmtl default\nKa 0.4000 0.4000 0.4000\nKd 0.7102 0.7020 0.6531\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 128.0000\n\nnewmtl ship2\nKa 0.0000 0.0000 0.0000\nKd 1.0000 1.0000 1.0000\nKs 0.1143 0.1143 0.1143\nillum 2\nNs 60.0000\n\nnewmtl dkpurple\nKa 0.0082 0.0000 0.0163\nKd 0.0245 0.0000 0.0490\nKs 0.1266 0.0000 0.2531\nillum 2\nNs 65.8900\n\nnewmtl dkorange\nKa 0.4041 0.0123 0.0000\nKd 0.7143 0.0350 0.0000\nKs 0.7102 0.0870 0.0000\nillum 2\nNs 65.8900\n\nnewmtl mintgrn\nKa 0.0101 0.1959 0.0335\nKd 0.0245 0.4776 0.0816\nKs 0.0245 0.4776 0.0816\nillum 2\nNs 65.8900\n\nnewmtl fgreen\nKa 0.0000 0.0449 0.0000\nKd 0.0000 0.0449 0.0004\nKs 0.0062 0.0694 0.0000\nillum 2\nNs 106.2000\n\nnewmtl glassblutint\nKa 0.4000 0.4000 0.4000\nKd 0.5551 0.8000 0.7730\nKs 0.7969 0.9714 0.9223\nillum 4\nd 0.6700\nNs 60.0000\nsharpness 60.0000\n\nnewmtl bflesh\nKa 0.0122 0.0122 0.0122\nKd 0.0245 0.0081 0.0021\nKs 0.0531 0.0460 0.0153\nillum 2\nNs 20.1600\n\nnewmtl meh\nKa 0.4000 0.4000 0.4000\nKd 0.5551 0.8000 0.7730\nKs 0.7969 0.9714 0.9223\nillum 4\nd 0.2500\nNs 183.7200\nsharpness 60.0000\n\nnewmtl violet\nKa 0.0083 0.0000 0.1265\nKd 0.0287 0.0269 0.1347\nKs 0.2267 0.4537 0.6612\nillum 2\nNs 96.9000\n\nnewmtl iris\nKa 0.3061 0.0556 0.0037\nKd 0.0000 0.0572 0.3184\nKs 0.8041 0.6782 0.1477\nillum 2\nNs 188.3700\n\nnewmtl blugrn\nKa 0.4408 0.4144 0.1592\nKd 0.0811 0.6408 0.2775\nKs 0.1467 0.1469 0.0965\nillum 2\nNs 25.0000\n\nnewmtl glasstransparent\nKa 0.2163 0.2163 0.2163\nKd 0.4694 0.4694 0.4694\nKs 0.6082 0.6082 0.6082\nillum 4\nd 0.2500\nNs 200.0000\nsharpness 60.0000\n\nnewmtl fleshtransparent\nKa 0.4000 0.2253 0.2253\nKd 0.6898 0.2942 0.1295\nKs 0.7388 0.4614 0.4614\nillum 4\nd 0.2500\nNs 6.2000\nsharpness 60.0000\n\nnewmtl fldkgrey\nKa 0.0449 0.0449 0.0449\nKd 0.0939 0.0939 0.0939\nillum 1\n\nnewmtl sky_blue\nKa 0.1363 0.2264 0.4122\nKd 0.1241 0.5931 0.8000\nKs 0.0490 0.0490 0.0490\nillum 2\nNs 13.9500\n\nnewmtl fldkpurple\nKa 0.0443 0.0257 0.0776\nKd 0.1612 0.0000 0.3347\nKs 0.0000 0.0000 0.0000\nillum 2\nNs 13.9500\n\nnewmtl dkbrown\nKa 0.0143 0.0062 0.0027\nKd 0.0087 0.0038 0.0016\nKs 0.2370 0.2147 0.1821\nillum 3\nNs 60.0000\nsharpness 60.0000\n\nnewmtl bone2\nKa 0.6408 0.5388 0.3348\nKd 0.9837 0.8620 0.6504\nillum 1\n\nnewmtl bluegrey\nKa 0.4000 0.4000 0.4000\nKd 0.1881 0.2786 0.2898\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 14.7300\n\nnewmtl metal\nKa 0.9102 0.8956 0.1932\nKd 0.9000 0.7626 0.4261\nKs 0.8939 0.8840 0.8683\nillum 2\nNs 200.0000\n\nnewmtl sand_stone\nKa 0.1299 0.1177 0.0998\nKd 0.1256 0.1138 0.0965\nKs 0.2370 0.2147 0.1821\nillum 3\nNs 60.0000\nsharpness 60.0000\n\nnewmtl hair\nKa 0.0013 0.0012 0.0010\nKd 0.0008 0.0007 0.0006\nKs 0.0000 0.0000 0.0000\nillum 3\nNs 60.0000\nsharpness 60.0000\n",OBJLoader.defaultAppearances,null,null))}function DAELoader(){ModelLoader.call(this,"dae")}function DAEHandler(e,t){DefaultHandler.call(this),this.sceneRoot=e,this.daeEntryName=t,this.parentGroups=[],this.parentElements=[],this.buffer="",this.postProcessingBinders=[],this.textures={},this.effectAppearances={},this.materialEffects={},this.materialNames={},this.surface2DIds={},this.sampler2DIds={},this.geometries={},this.sources={},this.positions={},this.normals={},this.textureCoordinates={},this.floatArrays={},this.sourceAccessorStrides=[],this.appearanceGeometries={},this.facesAndLinesPrimitives=[],this.polygonsPrimitives=[],this.polygonsHoles=[],this.nodes={},this.controllersSkinMeshes={},this.instantiatedNodes={},this.visualScenes={},this.visualScene=null,this.floats=null,this.geometryVertices=[],this.geometryNormals=[],this.geometryTextureCoordinates=[],this.vcount=[],this.transparentColor=[],this.transparency=null,this.inRootAsset=!1,this.reverseTransparency=!1,this.imageId=null,this.materialId=null,this.effectId=null,this.newParamSid=null,this.inSurface2D=!1,this.inPhongBlinnOrLambert=!1,this.techniqueProfile=null,this.inConstant=!1,this.geometryId=null,this.meshSourceId=null,this.verticesId=null,this.floatArrayId=null,this.controllerId=null,this.geometryAppearance=null,this.geometryVertexOffset=0,this.geometryNormalOffset=0,this.geometryTextureCoordinatesOffset=0,this.axis=null,this.meterScale=1,this.floatValue=0,this.opaque=null,this.inputCount=0}function Max3DSLoader(){ModelLoader.call(this,"3ds"),null===Max3DSLoader.DEFAULT_APPEARANCE&&(Max3DSLoader.DEFAULT_APPEARANCE=new Appearance3D("Default"),Max3DSLoader.DEFAULT_APPEARANCE.setAmbientColor(vec3.fromValues(.4,.4,.4)),Max3DSLoader.DEFAULT_APPEARANCE.setDiffuseColor(vec3.fromValues(.7102,.702,.6531)),Max3DSLoader.DEFAULT_APPEARANCE.setSpecularColor(vec3.fromValues(.3,.3,.3)),Max3DSLoader.DEFAULT_APPEARANCE.setShininess(128))}function ModelManager(){this.loadedModelNodes={},this.loadingModelObservers={}}function ModelPreviewComponent(e,t,i){if(void 0===i&&(i=!1),this.canvas3D=new HTMLCanvas3D(e),this.pickedMaterial=null,this.setDefaultTransform(),t){var n=this,o={pointerTouches:{},boundedPitch:!1,pickedTransformGroup:null,pivotCenterPixel:null,translationFromOrigin:null,translationToOrigin:null,modelBounds:null,mousePressed:function(e){o.mousePressedInCanvas=!0,n.stopRotationAnimation();var t=n.getHTMLElement().getBoundingClientRect();o.updatePickedMaterial(e.clientX-t.left,e.clientY-t.top),e.stopPropagation()},windowMouseMoved:function(e){if(o.mousePressedInCanvas){var t=n.getHTMLElement().getBoundingClientRect();o.mouseDragged(e.clientX-t.left,e.clientY-t.top,e.altKey)}},windowMouseReleased:function(e){o.mousePressedInCanvas=!1},pointerPressed:function(e){"mouse"==e.pointerType?o.mousePressed(e):(o.copyPointerToTargetTouches(e),o.touchStarted(e))},pointerMousePressed:function(e){e.stopPropagation()},windowPointerMoved:function(e){"mouse"==e.pointerType?o.windowMouseMoved(e):(o.copyPointerToTargetTouches(e),o.touchMoved(e))},windowPointerReleased:function(e){"mouse"==e.pointerType?o.windowMouseReleased(e):(delete o.pointerTouches[e.pointerId],o.touchEnded(e))},touchStarted:function(e){if(e.preventDefault(),1==e.targetTouches.length){o.mousePressedInCanvas=!0;var t=n.getHTMLElement().getBoundingClientRect();o.updatePickedMaterial(e.targetTouches[0].clientX-t.left,e.targetTouches[0].clientY-t.top)}else 2==e.targetTouches.length&&(o.distanceLastPinch=o.distance(e.targetTouches[0].clientX,e.targetTouches[0].clientY,e.targetTouches[1].clientX,e.targetTouches[1].clientY));n.stopRotationAnimation()},touchMoved:function(e){if(e.preventDefault(),1==e.targetTouches.length){var t=n.getHTMLElement().getBoundingClientRect();o.mouseDragged(e.targetTouches[0].clientX-t.left,e.targetTouches[0].clientY-t.top,!1)}else if(2==e.targetTouches.length){var i=o.distance(e.targetTouches[0].clientX,e.targetTouches[0].clientY,e.targetTouches[1].clientX,e.targetTouches[1].clientY),r=o.distanceLastPinch/i;n.setViewScale(Math.max(.5,Math.min(1.3,n.viewScale*r))),o.distanceLastPinch=i}},touchEnded:function(e){o.mousePressedInCanvas=!1},copyPointerToTargetTouches:function(e){for(var t in o.pointerTouches[e.pointerId]={clientX:e.clientX,clientY:e.clientY},e.targetTouches=[],o.pointerTouches)o.pointerTouches.hasOwnProperty(t)&&e.targetTouches.push(o.pointerTouches[t])},distance:function(e,t,i,n){return Math.sqrt(Math.pow(i-e,2)+Math.pow(n-t,2))},mouseScrolled:function(e){e.preventDefault(),o.zoomUpdater(e.detail)},mouseWheelMoved:function(e){e.preventDefault(),o.zoomUpdater(void 0!==e.deltaY?e.deltaY/2:-e.wheelDelta/3)},visibilityChanged:function(e){"hidden"==document.visibilityState&&n.stopRotationAnimation()},updatePickedMaterial:function(e,t){if(o.xLastMove=e,o.yLastMove=t,o.pickedTransformGroup=null,o.pivotCenterPixel=null,o.boundedPitch=!0,n.pickedMaterial=null,void 0!==HomeMaterial&&null!==n.getModelNode()){var r=ModelManager.getInstance();i&&(o.boundedPitch=!r.containsDeformableNode(n.getModelNode()));var l=n.getHTMLElement().getBoundingClientRect(),a=n.canvas3D.getClosestShapeAt(e+l.left,t+l.top);if(null!==a){var s=r.getMaterials(a);s.length>0&&(n.pickedMaterial=s[0]);for(var h=a;null!==(h=h.getParent());)if(h instanceof TransformGroup3D){o.pickedTransformGroup=h;break}if(i&&null!=o.pickedTransformGroup){for(var u=o.pickedTransformGroup.getParent(),d=u.getChildren().indexOf(o.pickedTransformGroup)-1;d>=0&&u.getChild(d)instanceof TransformGroup3D;)d--;if(d>=0){var c=u.getChild(d),p=r.getCenter(c),g=vec3.clone(p),m=o.getTransformBetweenNodes(c.getParent(),n.canvas3D.getScene(),!1);vec3.transformMat4(g,g,m);var f=n.canvas3D.getVirtualWorldToImageTransform(mat4.create()),v=n.canvas3D.getViewPlatformTransform(mat4.create());mat4.invert(v,v),mat4.mul(f,f,v),vec3.transformMat4(g,g,f),o.pivotCenterPixel=[(g[0]/2+.5)*l.width,l.height*(.5-g[1]/2)];var _=o.pickedTransformGroup.getName();o.translationFromOrigin=mat4.create(),o.translationFromOrigin[12]=p[0],o.translationFromOrigin[13]=p[1],o.translationFromOrigin[14]=p[2];var S=mat4.create();mat4.fromXRotation(S,n.viewPitch);var y=mat4.create();if(mat4.fromYRotation(y,n.viewYaw),0===_.indexOf(ModelManager.HINGE_PREFIX)||0===_.indexOf(ModelManager.RAIL_PREFIX)){var E=mat4.create(),C=r.getSize(c),P=o.getModelRoot(c),w=o.getTransformBetweenNodes(P,n.getModelNode(),!0);vec3.transformMat4(C,C,w),C[0]=Math.abs(C[0]),C[1]=Math.abs(C[1]),C[2]=Math.abs(C[2]);var L=mat4.clone(y);if(mat4.mul(L,L,S),mat4.invert(L,L),C[1]>C[0]&&C[1]>C[2]){var T=vec3.fromValues(0,1,0);vec3.transformMat4(T,T,L),(0===_.indexOf(ModelManager.RAIL_PREFIX)?T[1]>0:T[2]<0)?mat4.fromXRotation(E,Math.PI/2):mat4.fromXRotation(E,-Math.PI/2)}else if(C[2]>C[0]&&C[2]>C[1]){var A=vec3.fromValues(0,0,1);vec3.transformMat4(A,A,L),(0===_.indexOf(ModelManager.RAIL_PREFIX)?A[0]>0:A[2]<0)&&mat4.fromXRotation(E,Math.PI)}else{var I=vec3.fromValues(1,0,0);vec3.transformMat4(I,I,L),(0===_.indexOf(ModelManager.RAIL_PREFIX)?I[0]>0:I[2]<0)?mat4.fromYRotation(E,-Math.PI/2):mat4.fromYRotation(E,Math.PI/2)}mat4.invert(w,w),mat4.mul(o.translationFromOrigin,o.translationFromOrigin,w),mat4.mul(o.translationFromOrigin,o.translationFromOrigin,E)}else mat4.mul(o.translationFromOrigin,o.translationFromOrigin,mat4.invert(mat4.create(),o.getTransformBetweenNodes(c.getParent(),n.getModelNode(),!0))),mat4.mul(o.translationFromOrigin,o.translationFromOrigin,y),mat4.mul(o.translationFromOrigin,o.translationFromOrigin,S);o.translationToOrigin=mat4.invert(mat4.create(),o.translationFromOrigin),o.modelBounds=r.getBounds(n.getModelNode())}}}}},getTransformBetweenNodes:function(e,t,i){var n=mat4.create();if(e instanceof TransformGroup3D&&(e.getTransform(n),i&&(n[12]=0,n[13]=0,n[14]=0)),e!==t){var r=e.getParent();if(!(r instanceof Group3D))throw new IllegalStateException("Can't retrieve node transform");mat4.mul(n,o.getTransformBetweenNodes(r,t,i),n)}return n},getModelRoot:function(e){return e instanceof Group3D&&e.getUserData()instanceof URLContent?e:null!=e.getParent()?o.getModelRoot(e.getParent()):null},mouseDragged:function(e,i,r){if(null!==n.getModelNode())if(null!==o.pivotCenterPixel){var l=o.pickedTransformGroup.getName(),a=mat4.create();if(0===l.indexOf(ModelManager.RAIL_PREFIX))mat4.translate(a,a,vec3.fromValues(0,0,o.distance(e,i,o.xLastMove,o.yLastMove)*(o.xLastMove-e<0?-1:o.xLastMove-e==0?0:1)));else{var s=Math.atan2(o.pivotCenterPixel[1]-i,e-o.pivotCenterPixel[0])-Math.atan2(o.pivotCenterPixel[1]-o.yLastMove,o.xLastMove-o.pivotCenterPixel[0]);mat4.fromZRotation(a,s)}mat4.mul(a,a,o.translationToOrigin),mat4.mul(a,o.translationFromOrigin,a);var h=mat4.create();o.pickedTransformGroup.getTransform(h),mat4.mul(h,a,h),o.pickedTransformGroup.setTransform(h);var u=vec3.create();o.modelBounds.getLower(u);var d=vec3.create();o.modelBounds.getUpper(d);var c=ModelManager.getInstance().getBounds(n.getModelNode()),p=vec3.create();c.getLower(p);var g=vec3.create();c.getUpper(g);var m=n.previewedPiece;m.setX(m.getX()+(g[0]+p[0])/2-(d[0]+u[0])/2),m.setY(m.getY()+(g[2]+p[2])/2-(d[2]+u[2])/2),m.setElevation(m.getElevation()+(p[1]-u[1])),m.setWidth(g[0]-p[0]),m.setDepth(g[2]-p[2]),m.setHeight(g[1]-p[1]),o.modelBounds=c;var f=n.previewedPiece.getModelTransformations(),v=[];null!==f&&v.push.apply(v,f),l=l.substring(0,l.length-ModelManager.DEFORMABLE_TRANSFORM_GROUP_SUFFIX.length);for(var _=0;_<v.length;_++)if(l==v[_].getName()){v.splice(_,1);break}v.push(new Transformation(l,[[h[0],h[4],h[8],h[12]],[h[1],h[5],h[9],h[13]],[h[2],h[6],h[10],h[14]]])),n.previewedPiece.setModelTransformations(v)}else if(r||n.setViewYaw(n.viewYaw-.02*(e-o.xLastMove)),t&&r)o.zoomUpdater(i-o.yLastMove);else if(t&&!r){var S=n.viewPitch-.02*(i-o.yLastMove);o.boundedPitch?n.setViewPitch(Math.max(-Math.PI/4,Math.min(0,S))):n.setViewPitch(S)}o.xLastMove=e,o.yLastMove=i},zoomUpdater:function(e){n.setViewScale(Math.max(.5,Math.min(1.3,n.viewScale*Math.exp(.02*e)))),n.stopRotationAnimation()}};OperatingSystem.isInternetExplorerOrLegacyEdge()&&window.PointerEvent?(this.canvas3D.getHTMLElement().addEventListener("pointerdown",o.pointerPressed),this.canvas3D.getHTMLElement().addEventListener("mousedown",o.pointerMousePressed),window.addEventListener("pointermove",o.windowPointerMoved),window.addEventListener("pointerup",o.windowPointerReleased)):(this.canvas3D.getHTMLElement().addEventListener("touchstart",o.touchStarted),this.canvas3D.getHTMLElement().addEventListener("touchmove",o.touchMoved),this.canvas3D.getHTMLElement().addEventListener("touchend",o.touchEnded),this.canvas3D.getHTMLElement().addEventListener("mousedown",o.mousePressed),window.addEventListener("mousemove",o.windowMouseMoved),window.addEventListener("mouseup",o.windowMouseReleased)),this.canvas3D.getHTMLElement().addEventListener("DOMMouseScroll",o.mouseScrolled),this.canvas3D.getHTMLElement().addEventListener("mousewheel",o.mouseWheelMoved),document.addEventListener("visibilitychange",o.visibilityChanged),this.userActionsListener=o}}ImageTools.isImageWithAlpha=function(e){var t=document.createElement("canvas"),i=t.getContext("2d");return t.width=e.width,t.height=e.height,i.drawImage(e,0,0,e.width,e.height),ImageTools.isCanvasWithAlpha(t,i)},ImageTools.isCanvasWithAlpha=function(e,t){for(var i=(t=t||e.getContext("2d")).getImageData(0,0,e.width,e.height).data,n=!1,o=3,r=i.length;o<r;o+=4)if(i[o]<255){n=!0;break}return n},ImageTools.resize=function(e,t,i,n,o){var r=document.createElement("canvas");r.width=t,r.height=i,r.getContext("2d").drawImage(e,0,0,t,i);var l=new Image;l.addEventListener("load",(function(){n(l)})),l.src=r.toDataURL(o||"image/png")},ModelLoader.READING_MODEL=Node3D.READING_MODEL,ModelLoader.PARSING_MODEL=Node3D.PARSING_MODEL,ModelLoader.BUILDING_MODEL=Node3D.BUILDING_MODEL,ModelLoader.BINDING_MODEL=Node3D.BINDING_MODEL,ModelLoader.prototype.load=function(e,t,i){void 0===i&&(i=t,t=!1);var n=null;if(0===e.indexOf("jar:")){var o=e.indexOf("!/");n=e.substring(o+2),e=e.substring(4,o)}i.progression(ModelLoader.READING_MODEL,e,0);var r=this,l={zipReady:function(o){try{if(null===n){for(var a=o.file(/.*/),s=0;s<a.length;s++)if(a[s].name.toLowerCase().match(new RegExp("."+r.modelExtension.toLowerCase()+"$")))return void r.parseModelEntry(a[s],o,e,t,i);if(!(a.length>0))return void(void 0!==i.modelError&&i.modelError("Empty file"));n=a[0].name}r.parseModelEntry(o.file(decodeURIComponent(n)),o,e,t,i)}catch(e){l.zipError(e)}},zipError:function(e){void 0!==i.modelError&&i.modelError(e)},progression:function(e,t,n){void 0!==i.progression&&i.progression(ModelLoader.READING_MODEL,t,n)}};ZIPTools.getZIP(e,t,l)},ModelLoader.prototype.clear=function(){this.waitingParsedEntries=[]},ModelLoader.prototype.parseModelEntry=function(e,t,i,n,o){if(n){var r=this.getModelContent(e);o.progression(ModelLoader.READING_MODEL,e.name,1);var l={};this.parseDependencies(r,e.name,t,l);var a=this.parseEntryScene(r,e.name,t,l,null,o.progression);this.loadTextureImages(a,{},t,i,!0),o.modelLoaded(a)}else{var s={modelEntry:e,zip:t,zipUrl:i,loadingModelObserver:o};this.waitingParsedEntries.push(s),this.parseNextWaitingEntry()}},ModelLoader.prototype.parseNextWaitingEntry=function(){if(!this.parserBusy)for(var e in this.waitingParsedEntries)if(this.waitingParsedEntries.hasOwnProperty(e)){var t=this.waitingParsedEntries[e],i=t.modelEntry.name,n=this.getModelContent(t.modelEntry);t.loadingModelObserver.progression(ModelLoader.READING_MODEL,i,1);var o={};this.parseDependencies(n,i,t.zip,o);var r=this;setTimeout((function(){r.parseEntryScene(n,i,t.zip,o,(function(e){r.loadTextureImages(e,{},t.zip,t.zipUrl,!0),t.loadingModelObserver.modelLoaded(e),r.parserBusy=!1,r.parseNextWaitingEntry()}),t.loadingModelObserver.progression)}),0),this.parserBusy=!0,delete this.waitingParsedEntries[e];break}},ModelLoader.prototype.loadTextureImages=function(e,t,i,n,o){if(e instanceof Group3D)for(var r=0;r<e.children.length;r++)this.loadTextureImages(e.children[r],t,i,n,o);else if(e instanceof Link3D)this.loadTextureImages(e.getSharedGroup(),t,i,n,o);else if(e instanceof Shape3D){var l=e.getAppearance();if(l){var a=l.imageEntryName;if(void 0!==a)if(delete l[a],a in t)l.setTextureImage(t[a]);else{var s=new Image;s.crossOrigin="anonymous",l.setTextureImage(s),s.url="jar:"+n+"!/"+a,t[a]=s;var h=function(){var e=i.file(decodeURIComponent(a));if(null!==e){var t=e.asBinary(),n=btoa(t),o=a.substring(a.lastIndexOf(".")+1).toLowerCase(),r=ZIPTools.isJPEGImage(t)?"image/jpeg":ZIPTools.isPNGImage(t)?"image/png":"image/"+o;s.transparent=ZIPTools.isTransparentImage(t),s.src="data:"+r+";base64,"+n}else l.setTextureImage(null)};o?h():setTimeout(h,0)}}}},ModelLoader.prototype.getModelContent=function(e){return e.asBinary()},ModelLoader.prototype.parseDependencies=function(e,t,i,n){},ModelLoader.prototype.parseEntryScene=function(e,t,i,n,o,r){},OBJLoader.prototype=Object.create(ModelLoader.prototype),OBJLoader.prototype.constructor=OBJLoader,OBJLoader.defaultAppearances=null,OBJLoader.prototype.createScene=function(e,t,i,n,o,r,l){var a=new Group3D;if(null===r){for(var s in l(ModelLoader.BUILDING_MODEL,"",0),n)this.createGroupShapes(e,t,i,n[s],o,a);return l(ModelLoader.BUILDING_MODEL,"",1),a}var h=0;for(var s in n)h+=n[s].geometries.length;var u=0,d=this,c=function(){l(ModelLoader.BUILDING_MODEL,"",0!==h?u/h:0);var s=Date.now();for(var p in n)if(d.createGroupShapes(e,t,i,n[p],o,a),u+=n[p].geometries.length,delete n[p],u<h&&Date.now()-s>10)return void setTimeout(c,0);setTimeout((function(){l(ModelLoader.BUILDING_MODEL,"",1),r(a)}),0)};c()},OBJLoader.prototype.createGroupShapes=function(e,t,i,n,o,r){var l=n.geometries;if(l.length>0)for(var a=0;a<l.length;){for(var s=l[a],h=s.textureCoordinateIndices.length>0,u=s instanceof OBJLoader.OBJFace&&s.normalIndices.length>0,d=s instanceof OBJLoader.OBJFace&&s.smooth,c=s.material,p=OBJLoader.getAppearance(o,c),g=a;++g<l.length;){var m=l[g],f=m.material;if(m.constructor!==s.constructor||null===f&&null!==c||null!==f&&OBJLoader.getAppearance(o,f)!==p||d^(m instanceof OBJLoader.OBJFace&&m.smooth)||h^m.textureCoordinateIndices.length>0||u^(m instanceof OBJLoader.OBJFace&&m.normalIndices.length>0))break}null!==p&&(p=p.clone());for(var v=g-a,_=[],S=[],y=!0,E=0;E<v;E++){var C=l[a+E].vertexIndices;_.push.apply(_,C),S.push(C.length),y&&3!==C.length&&(y=!1)}var P,w=[];if(h)for(E=0;E<v;E++)w.push.apply(w,l[a+E].textureCoordinateIndices);if(s instanceof OBJLoader.OBJFace){var L=[];if(u)for(E=0;E<v;E++)L.push.apply(L,l[a+E].normalIndices);var T=new GeometryInfo3D(y?GeometryInfo3D.TRIANGLE_ARRAY:GeometryInfo3D.POLYGON_ARRAY);T.setCoordinates(e),T.setCoordinateIndices(_),T.setNormals(i),T.setNormalIndices(L),T.setTextureCoordinates(t),T.setTextureCoordinateIndices(w),T.setStripCounts(S),u||(T.setCreaseAngle(d?Math.PI/2:0),T.setGeneratedNormals(!0)),P=T.getIndexedGeometryArray()}else{for(var A=[],I=[],b=(E=0,0);E<v;b+=S[E],E++)for(var O=0;O<S[E]-1;O++)A.push(_[b+O]),A.push(_[b+O+1]),w.length>0&&(I.push(w[b+O]),I.push(w[b+O+1]));P=new IndexedLineArray3D(e,A,t,I)}var M=new Shape3D(P,p);r.addChild(M),M.setName(n.name+(0===a?"":"_"+a)),a=g}},OBJLoader.getAppearance=function(e,t){var i=void 0;return null!==t&&(i=e[t]),void 0===i&&(i=OBJLoader.defaultAppearances.default),i},OBJLoader.prototype.parseDependencies=function(e,t,i,n){for(var o in n.appearances={},OBJLoader.defaultAppearances){var r=OBJLoader.defaultAppearances[o];n.appearances[r.getName()]=r}try{for(var l=e.indexOf("mtllib");-1!==l;){for(var a=l+6;a<e.length&&"\n"!=e.charAt(a)&&"\r"!=e.charAt(a);)a++;var s=e.substring(l,a).trim(),h=s.substring(7,s.length).trim();this.parseMaterialEntry(h,n.appearances,t,i),l=e.indexOf("mtllib",a)}}catch(e){n.appearances={}}},OBJLoader.prototype.parseEntryScene=function(e,t,i,n,o,r){var l=[],a=[],s=[],h=new OBJLoader.OBJGroup("default"),u={default:h},d={},c={group:h,material:"default",smooth:!1};if(null===o)try{r(ModelLoader.PARSING_MODEL,t,0);for(var p=0;p<=e.length;)p=this.parseObjectLine(e,p,l,a,s,u,d,c);return r(ModelLoader.PARSING_MODEL,t,1),this.createScene(l,a,s,u,n.appearances,null,r)}catch(e){return r(ModelLoader.PARSING_MODEL,t,1),this.createScene([],[],[],{},n.appearances,null,r)}else{p=0;var g=this,m=function(){try{r(ModelLoader.PARSING_MODEL,t,p/e.length);for(var i=p+2e5,h=Date.now();p<=e.length;)if((p=g.parseObjectLine(e,p,l,a,s,u,d,c))<=e.length&&p>i&&Date.now()-h>10)return void setTimeout(m,0);setTimeout((function(){r(ModelLoader.PARSING_MODEL,t,1),g.createScene(l,a,s,u,n.appearances,(function(e){o(e)}),r)}),0)}catch(e){r(ModelLoader.PARSING_MODEL,t,1),g.createScene([],[],[],{},n.appearances,o,r)}};m()}},OBJLoader.prototype.parseObjectLine=function(e,t,i,n,o,r,l,a){for(var s=t+1;s<e.length&&"\n"!=e.charAt(s)&&"\r"!=e.charAt(s);)s++;if(0===(h=e.substring(t,s)).indexOf("v")||0===h.indexOf("f ")||0===h.indexOf("l "))for(;"\\"===h.charAt(h.length-1);){for(h=h.substring(0,h.length-1)+" ",(t=s+1)<e.length&&"\r"==e.charAt(s)&&"\n"==e.charAt(t)&&t++,s=t+1;s<e.length&&"\n"!=e.charAt(s)&&"\r"!=e.charAt(s);)s++;h+=e.substring(t,s)}var h,u=(h=h.trim()).split(/\s+/),d=u[0];if("v"===d)i.push(OBJLoader.parseVector3f(u));else if("vt"===d)n.push(OBJLoader.parseVector2f(u));else if("vn"===d)try{o.push(OBJLoader.parseVector3f(u))}catch(t){console.log(e+" "+h)}else if("l"===d)(h=this.parseLine(u,a.material)).vertexIndices.length>1&&a.group.addGeometry(h);else if("f"===d){var c=this.parseFace(u,a.smooth,a.material);c.vertexIndices.length>2&&(0===c.normalIndices.length||0===a.group.name.indexOf("sweethome3d_")?a.group.addGeometry(c):(c.material in l||(l[c.material]=a.group),l[c.material].addGeometry(c)))}else if("g"===d||"o"===d)if(u.length>1){var p=u[1];a.group=r[p],void 0===a.group&&(a.group=new OBJLoader.OBJGroup(p),r[p]=a.group)}else a.group=r.default;else"s"===d?a.smooth="off"!=u[1]:"usemtl"===d&&(a.material=h.substring(7,h.length).trim());return(t=s+1)<e.length&&"\r"==e.charAt(s)&&"\n"==e.charAt(t)&&t++,t},OBJLoader.prototype.parseLine=function(e,t){for(var i=[],n=[],o=0;o<e.length;o++){var r=e[o];if(o>0&&r.length>0){var l=r.indexOf("/");-1===l?i.push(OBJLoader.parseInteger(r)-1):(i.push(OBJLoader.parseInteger(r.substring(0,l))-1),n.push(OBJLoader.parseInteger(r.substring(l+1))-1))}}return i.length!==n.length&&(n=[]),new OBJLoader.OBJLine(i,n,t)},OBJLoader.prototype.parseFace=function(e,t,i){for(var n=[],o=[],r=[],l=0;l<e.length;l++){var a=e[l];if(l>0&&a.length>0){var s=a.indexOf("/");if(-1===s)n.push(OBJLoader.parseInteger(a)-1);else{n.push(OBJLoader.parseInteger(a.substring(0,s))-1);var h=a.lastIndexOf("/");s===h?o.push(OBJLoader.parseInteger(a.substring(s+1))-1):(s+1!==h&&o.push(OBJLoader.parseInteger(a.substring(s+1,h))-1),r.push(OBJLoader.parseInteger(a.substring(h+1))-1))}}}return n.length!==o.length&&(o=[]),n.length!==r.length&&(r=[]),new OBJLoader.OBJFace(n,o,r,t,i)},OBJLoader.prototype.parseMaterialEntry=function(e,t,i,n){var o=i.lastIndexOf("/");o>=0&&(e=i.substring(0,o+1)+e);var r=n.file(e);null!==r&&OBJLoader.parseMaterial(r.asBinary(),t,i,n)},OBJLoader.parseVector3f=function(e){return vec3.fromValues(OBJLoader.parseNumber(e[1]),OBJLoader.parseNumber(e[2]),OBJLoader.parseNumber(e[3]))},OBJLoader.parseVector2f=function(e){return vec2.fromValues(OBJLoader.parseNumber(e[1]),OBJLoader.parseNumber(e[2]))},OBJLoader.parseInteger=function(e){var t=parseInt(e);if(isNaN(t))throw new IncorrectFormat3DException("Incorrect integer "+e);return t},OBJLoader.parseNumber=function(e){var t=parseFloat(e);if(isNaN(t)){if("NaN"==e)return NaN;throw new IncorrectFormat3DException("Incorrect number "+e)}return t},OBJLoader.parseMaterial=function(e,t,i,n){for(var o=null,r=e.match(/^.*$/gm),l=0;l<r.length;l++){var a=r[l].trim(),s=a.split(/\s+/),h=s[0];if("newmtl"==h)t[(o=new Appearance3D(a.substring(7,a.length).trim())).getName()]=o;else if(null!==o)if("Ka"==h)o.setAmbientColor(OBJLoader.parseVector3f(s));else if("Kd"==h)o.setDiffuseColor(OBJLoader.parseVector3f(s));else if("Ks"==h)o.setSpecularColor(OBJLoader.parseVector3f(s));else if("Ns"==h)o.setShininess(Math.max(1,Math.min(OBJLoader.parseNumber(s[1]),128)));else if("d"==h)o.setTransparency(1-Math.max(0,OBJLoader.parseNumber("-halo"==s[1]?s[2]:s[1])));else if("illum"==h)o.setIllumination(OBJLoader.parseInteger(s[1]));else if("map_Kd"==h){var u=s[s.length-1],d=i.lastIndexOf("/");d>=0&&(u=i.substring(0,d+1)+u);var c=n.file(u);null===c&&s.length>2&&(u=a.substring(7,a.length).trim(),d>=0&&(u=i.substring(0,d+1)+u),c=n.file(u)),null!==c&&(o.imageEntryName=u)}}},OBJLoader.OBJGroup=function(e){this.name=e,this.geometries=[]},OBJLoader.OBJGroup.prototype.addGeometry=function(e){this.geometries.push(e)},OBJLoader.OBJLine=function(e,t,i){this.vertexIndices=e,this.textureCoordinateIndices=t,this.material=i},OBJLoader.OBJFace=function(e,t,i,n,o){this.vertexIndices=e,this.textureCoordinateIndices=t,this.normalIndices=i,this.smooth=n,this.material=o},DAELoader.prototype=Object.create(ModelLoader.prototype),DAELoader.prototype.constructor=DAELoader,DAELoader.prototype.parseEntryScene=function(e,t,i,n,o,r){var l=new Group3D,a=new DAEHandler(l,t),s=new SAXParser(a,a,a,a,a);r(ModelLoader.PARSING_MODEL,t,0);try{s.parseString(e)}catch(e){l.removeAllChildren()}if(null===o)return r(ModelLoader.PARSING_MODEL,t,1),l;setTimeout((function(){r(ModelLoader.PARSING_MODEL,t,1),o(l)}),0)},DAEHandler.prototype=Object.create(DefaultHandler.prototype),DAEHandler.prototype.constructor=DAEHandler,DAEHandler.prototype.startElement=function(e,t,i,n){this.buffer="";var o=0===this.parentElements.length?null:this.parentElements[this.parentElements.length-1];if(null===o&&"COLLADA"!=i)throw new SAXException("Expected COLLADA element");if("COLLADA"==i){var r=n.getValue("version");if(0!==r.indexOf("1.4"))throw new SAXException("Version "+r+" not supported")}else if("COLLADA"==o&&"asset"==i)this.inRootAsset=!0;else if("asset"==o&&"unit"==i){var l=n.getValue("meter");null!==l&&(this.meterScale=parseFloat(l))}else if("image"==i)this.imageId=n.getValue("id");else if("material"==i)this.materialId=n.getValue("id"),this.materialNames[this.materialId]=n.getValue("name");else if("material"==o&&"instance_effect"==i){var a=n.getValue("url");if(0===a.indexOf("#")){var s=a.substring(1);this.materialEffects[this.materialId]=s}}else if("effect"==i)this.effectId=n.getValue("id"),this.effectAppearances[this.effectId]=new Appearance3D;else if(null!==this.effectId){if("profile_COMMON"==o&&"newparam"==i)this.newParamSid=n.getValue("sid");else if("newparam"==o&&"surface"==i&&"2D"==n.getValue("type"))this.inSurface2D=!0;else if("extra"==o&&"technique"==i)this.techniqueProfile=n.getValue("profile");else if("phong"==i||"blinn"==i)this.inPhongBlinnOrLambert=!0;else if("lambert"==i)this.inPhongBlinnOrLambert=!0,this.effectAppearances[this.effectId].setSpecularColor(vec3.fromValues(0,0,0)),this.effectAppearances[this.effectId].setShininess(1);else if("constant"==i)this.inConstant=!0;else if(this.inConstant||this.inPhongBlinnOrLambert&&"transparent"==i)this.opaque=n.getValue("opaque"),null===this.opaque&&(this.opaque="A_ONE");else if("texture"==i&&"diffuse"==o){var h=this.surface2DIds[this.sampler2DIds[n.getValue("texture")]],u=this.effectAppearances[this.effectId],d=this;this.postProcessingBinders.push((function(){u.imageEntryName=d.textures[h]}))}}else if("geometry"==i)this.geometryId=n.getValue("id"),this.geometries[this.geometryId]=[];else if(null!==this.geometryId)if("mesh"==o&&"source"==i)this.meshSourceId=n.getValue("id");else if("mesh"==o&&"vertices"==i)this.verticesId=n.getValue("id");else if(null!==this.meshSourceId){if("float_array"==i)this.floatArrayId=n.getValue("id");else if("technique_common"==o&&"accessor"==i){var c=n.getValue("source").substring(1),p=n.getValue("stride");p=null!==p?parseInt(p):1,this.sourceAccessorStrides.push({floatArray:this.floatArrays[c],stride:p})}}else if(null!==this.verticesId&&"input"==i){var g=n.getValue("source").substring(1);if(void 0!==(v=this.sources[g]))if("POSITION"==n.getValue("semantic")){this.positions[this.verticesId]=new Array(v.length/3);for(var m=0,f=0;f<v.length;m++,f+=3)this.positions[this.verticesId][m]=vec3.fromValues(v[f],v[f+1],v[f+2])}else if("NORMAL"==n.getValue("semantic")){this.normals[this.verticesId]=new Array(v.length/3);for(m=0,f=0;f<v.length;m++,f+=3)this.normals[this.verticesId][m]=vec3.fromValues(v[f],v[f+1],v[f+2])}else if("TEXCOORD"==n.getValue("semantic")){this.textureCoordinates[this.verticesId]=new Array(v.length/2);for(m=0,f=0;f<v.length;m++,f+=2)this.textureCoordinates[this.verticesId][m]=vec2.fromValues(v[f],v[f+1])}}else if(null===this.verticesId&&"input"==i){g=n.getValue("source").substring(1);var v,_=parseInt(n.getValue("offset"));if(this.inputCount<_+1&&(this.inputCount=_+1),"VERTEX"==n.getValue("semantic"))this.geometryVertices=this.positions[g],void 0===this.geometryVertices&&(this.geometryVertices=null),this.geometryVertexOffset=_,null===this.geometryNormals&&(this.geometryNormals=this.normals[g],this.geometryNormalOffset=_),null===this.geometryTextureCoordinates&&(this.geometryTextureCoordinates=this.textureCoordinates[g],this.geometryTextureCoordinatesOffset=_);else if("NORMAL"==n.getValue("semantic")){if(void 0!==(v=this.sources[g])){this.geometryNormals=new Array(v.length/3);for(m=0,f=0;f<v.length;m++,f+=3)this.geometryNormals[m]=vec3.fromValues(v[f],v[f+1],v[f+2]);this.geometryNormalOffset=_}}else if("TEXCOORD"==n.getValue("semantic"))if(void 0!==(v=this.sources[g])){this.geometryTextureCoordinates=new Array(v.length/2);for(m=0,f=0;f<v.length;m++,f+=2)this.geometryTextureCoordinates[m]=vec2.fromValues(v[f],v[f+1]);this.geometryTextureCoordinatesOffset=_}}else"triangles"!=i&&"trifans"!=i&&"tristrips"!=i&&"polylist"!=i&&"polygons"!=i&&"lines"!=i&&"linestrips"!=i||(this.geometryAppearance=n.getValue("material"),this.inputCount=0,this.facesAndLinesPrimitives=[],this.polygonsPrimitives=[],this.polygonsHoles=[],this.vcount=null);else if("controller"==i)this.controllerId=n.getValue("id");else if("skin"==i){var S=n.getValue("source");if(0===S.indexOf("#")){var y=S.substring(1);this.controllersSkinMeshes[this.controllerId]=y}}else if("visual_scene"==i){var E=new TransformGroup3D;this.parentGroups.push(E),this.visualScenes[n.getValue("id")]=E}else if("node"==i){var C=new TransformGroup3D;this.parentGroups.length>0&&this.parentGroups[this.parentGroups.length-1].addChild(C),this.parentGroups.push(C),this.nodes[n.getValue("id")]=C,null!==(x=n.getValue("name"))&&C.setName(x)}else if("node"!=o||"instance_geometry"!=i&&"instance_controller"!=i){if("instance_node"==i){var P=n.getValue("url");if(0===P.indexOf("#")){var w=P.substring(1),L=this.parentGroups[this.parentGroups.length-1];d=this;this.postProcessingBinders.push((function(){var e=d.instantiatedNodes[w];void 0===e&&((e=new SharedGroup3D).addChild(d.nodes[w]),d.instantiatedNodes[w]=e),L.addChild(new Link3D(e))}))}}else if("instance_material"==i&&this.parentGroups.length>0){var T=n.getValue("target");if(0==T.indexOf("#")){var A=T.substring(1),I=n.getValue("symbol"),b=this.parentGroups[this.parentGroups.length-1];d=this;this.postProcessingBinders.push((function(){var e=d.effectAppearances[d.materialEffects[A]],t=function(e,i,n){if(e instanceof Group3D){for(var o=!1,r=e.getChildren(),l=0;l<r.length;l++)o|=t(r[l],i,n);return o}if(e instanceof Link3D)return t(e.getSharedGroup(),i,n);if(e instanceof Shape3D){var a=n?e.getGeometries():d.appearanceGeometries[I];if(void 0!==a)for(l=0;l<a.length;l++)if(a[l]===e.getGeometries()[0])return e.setAppearance(i),!0}return!1};t(b,e,!1)||t(b,e,!0),e.setName(d.materialNames[A])}))}}else if("instance_visual_scene"==i){var O=n.getValue("url");if(0===O.indexOf("#")){var M=O.substring(1);d=this;this.postProcessingBinders.push((function(){d.visualScene=d.visualScenes[M]}))}}}else{var D=n.getValue("url");if(0===D.indexOf("#")){var R="instance_controller"==i,F=D.substring(1),x=n.getValue("name"),N=new Group3D;this.parentGroups[this.parentGroups.length-1].addChild(N),this.parentGroups.push(N);var d=this;this.postProcessingBinders.push((function(){for(var e=0,t=R?d.geometries[d.controllersSkinMeshes[F]]:d.geometries[F],i=0;i<t.length;i++){var n=new Shape3D(t[i]);N.addChild(n),null!==x&&(0===e?n.setName(x):n.setName(x+"_"+e),e++)}}))}}this.parentElements.push(i)},DAEHandler.prototype.characters=function(e,t,i){this.buffer+=e.substring(t,t+i)},DAEHandler.prototype.endElement=function(e,t,i){this.parentElements.pop();var n=0===this.parentElements.length?null:this.parentElements[this.parentElements.length-1];if("color"==i||"float_array"==i||"matrix"==i||"rotate"==i||"scale"==i||"translate"==i){var o=this.getCharacters().split(/\s/);this.floats=new Array(o.length);for(var r=0,l=0;l<o.length;l++)if(o[l].length>0){var a=parseFloat(o[l]);isNaN(a)&&(a=0),this.floats[r++]=a}r!==o.length&&this.floats.splice(r,this.floats.length-r),null!==this.floatArrayId&&(this.floatArrays[this.floatArrayId]=this.floats,this.floatArrayId=null)}else"float"==i&&(this.floatValue=parseFloat(this.getCharacters()));if(this.inRootAsset)this.handleRootAssetElementsEnd(i);else if("image"==i)this.imageId=null;else if(null!==this.imageId)this.handleImageElementsEnd(i);else if("material"==i)this.materialId=null;else if("effect"==i)this.effectId=null;else if(null!==this.effectId)this.handleEffectElementsEnd(i,n);else if("geometry"==i)this.geometryId=null;else if(null!==this.geometryId)this.handleGeometryElementsEnd(i,n);else if("controller"==i)this.controllerId=null;else if("visual_scene"==i||"node"==i||"node"==n&&"instance_geometry"==i)this.parentGroups.pop();else if("matrix"==i){var s=mat4.fromValues(this.floats[0],this.floats[4],this.floats[8],this.floats[12],this.floats[1],this.floats[5],this.floats[9],this.floats[13],this.floats[2],this.floats[6],this.floats[10],this.floats[14],this.floats[3],this.floats[7],this.floats[11],this.floats[15]);this.mulTransformGroup(s)}else if("node"==n&&"rotate"==i){var h=mat4.create();mat4.fromRotation(h,this.floats[3]*Math.PI/180,vec3.fromValues(this.floats[0],this.floats[1],this.floats[2])),this.mulTransformGroup(h)}else if("scale"==i){var u=mat4.create();mat4.scale(u,u,vec3.fromValues(this.floats[0],this.floats[1],this.floats[2])),this.mulTransformGroup(u)}else if("node"==n&&"translate"==i){var d=mat4.create();mat4.translate(d,d,vec3.fromValues(this.floats[0],this.floats[1],this.floats[2])),this.mulTransformGroup(d)}},DAEHandler.prototype.getCharacters=function(){return this.buffer.trim()},DAEHandler.prototype.handleRootAssetElementsEnd=function(e){if("asset"==e)this.inRootAsset=!1;else if("up_axis"==e)this.axis=this.getCharacters();else if("subject"==e)this.scene.setName(this.getCharacters());else if("authoring_tool"==e){var t=this.getCharacters();if(0===t.indexOf("Google SketchUp")){var i=t.substring(15).trim();if(i.length>0){var n=i.indexOf("."),o=-1===n?i:i.substring(0,n),r=parseInt(o);(r<7||7==r&&(n>=i.length-1||i[n+1]<"1"))&&(this.reverseTransparency=!0)}}}},DAEHandler.prototype.handleImageElementsEnd=function(e){if("init_from"==e){var t=this.getCharacters();if(0===t.indexOf("./")&&(t=t.substring(2)),this.daeEntryName.lastIndexOf("/")>=0){var i=this.daeEntryName.split("/"),n=t.split("/");for(i.splice(i.length-1,1);".."==n[0]||"."==n[0];)".."==n[0]&&i.splice(i.length-1,1),n.splice(0,1);t="";for(var o=0;o<i.length;o++)t+=i[o]+"/";for(o=0;o<n.length;o++)t+=n[o]+"/";t=t.substring(0,t.length-1)}this.textures[this.imageId]=t}else if("data"==e)throw new SAXException("<data> not supported")},DAEHandler.prototype.handleEffectElementsEnd=function(e,t){if("profile_COMMON"==t&&"newparam"==e)this.newParamSid=null;else if("newparam"==t&&"surface"==e)this.inSurface2D=!1;else if(null!==this.newParamSid)this.inSurface2D&&"init_from"==e?this.surface2DIds[this.newParamSid]=this.getCharacters():"sampler2D"==t&&"source"==e&&(this.sampler2DIds[this.newParamSid]=this.getCharacters());else if("extra"==t&&"technique"==e)this.techniqueProfile=null;else if("phong"==e||"blinn"==e||"lambert"==e||"constant"==e){var i;null!==this.transparentColor?"RGB_ZERO"==this.opaque?(i=.212671*this.transparentColor[0]+.71516*this.transparentColor[1]+.072169*this.transparentColor[2],null!==this.transparency&&(i*=this.transparency)):(i=null!==this.transparency?1-this.transparentColor[3]*this.transparency:1-this.transparentColor[3],this.reverseTransparency&&(i=1-i)):i=0;var n=this.effectAppearances[this.effectId];i>0&&n.setTransparency(i);var o=null!=this.transparentColor?vec3.fromValues(this.transparentColor[0],this.transparentColor[1],this.transparentColor[2]):vec3.fromValues(0,0,0);n.getAmbientColor()||n.getDiffuseColor()||n.getSpecularColor()||(n.getAmbientColor()||n.setAmbientColor(o),n.getDiffuseColor()||n.setDiffuseColor(o),n.getSpecularColor()||n.setSpecularColor(o),n.getShininess()||n.setShininess(1),"constant"==e&&this.effectAppearances[this.effectId].setIllumination(0)),this.transparentColor=null,this.transparency=null,this.inPhongBlinnOrLambert=!1,this.inConstant=!1}else this.inConstant||this.inPhongBlinnOrLambert?"color"==e?"emission"==t?this.inPhongBlinnOrLambert?this.effectAppearances[this.effectId].setEmissiveColor(vec3.fromValues(this.floats[0],this.floats[1],this.floats[2])):(this.effectAppearances[this.effectId].setDiffuseColor(vec3.fromValues(this.floats[0],this.floats[1],this.floats[2])),this.effectAppearances[this.effectId].setIllumination(0)):"ambient"==t?this.effectAppearances[this.effectId].setAmbientColor(vec3.fromValues(this.floats[0],this.floats[1],this.floats[2])):"diffuse"==t?this.effectAppearances[this.effectId].setDiffuseColor(vec3.fromValues(this.floats[0],this.floats[1],this.floats[2])):"specular"==t?this.effectAppearances[this.effectId].setSpecularColor(vec3.fromValues(this.floats[0],this.floats[1],this.floats[2])):"transparent"==t&&(this.transparentColor=this.floats):"float"==e&&("shininess"==t?this.effectAppearances[this.effectId].setShininess(this.floatValue):"transparency"==t&&(this.transparency=this.floatValue)):"double_sided"!=e||"1"!=this.getCharacters()||"GOOGLEEARTH"!=this.techniqueProfile&&"MAX3D"!=this.techniqueProfile&&"MAYA"!=this.techniqueProfile||this.effectAppearances[this.effectId].setCullFace(Appearance3D.CULL_NONE)},DAEHandler.prototype.handleGeometryElementsEnd=function(e,t){if("mesh"==t&&"source"==e)null!==this.floats&&(this.sources[this.meshSourceId]=this.floats,this.floats=null),this.meshSourceId=null;else if("mesh"==t&&"vertices"==e)this.verticesId=null;else if("p"==e||"h"==e||"vcount"==e){for(var i=this.getCharacters().split(/\s/),n=new Array(i.length),o=0,r=0;r<i.length;r++)i[r].length>0&&(n[o++]=parseInt(i[r]));o!==i.length&&n.splice(o,n.length-o),"ph"!=t&&"p"==e?this.facesAndLinesPrimitives.push(n):"vcount"==e?this.vcount=n:"ph"==t&&("p"==e?this.polygonsPrimitives.push(n):"h"==e&&(this.polygonsPrimitives.length>this.polygonsHoles.length&&this.polygonsHoles.push([]),this.polygonsHoles[this.polygonsPrimitives.length-1].push(n)))}else if(("triangles"==e||"trifans"==e||"tristrips"==e||"polylist"==e||"polygons"==e||"lines"==e||"linestrips"==e)&&null!==this.geometryVertices){var l;if(null!==(l="lines"==e||"linestrips"==e?this.getLinesGeometry(e):this.getFacesGeometry(e))&&(this.geometries[this.geometryId].push(l),null!==this.geometryAppearance)){var a=this.appearanceGeometries[this.geometryAppearance];void 0===a&&(a=[],this.appearanceGeometries[this.geometryAppearance]=a),a.push(l)}this.geometryAppearance=null,this.geometryVertices=null,this.geometryNormals=null,this.geometryTextureCoordinates=null,this.facesAndLinesPrimitives=[],this.polygonsPrimitives=[],this.polygonsHoles=[],this.vcount=null}},DAEHandler.prototype.getFacesGeometry=function(e){var t=new GeometryInfo3D("triangles"==e?GeometryInfo3D.TRIANGLE_ARRAY:"trifans"==e?GeometryInfo3D.TRIANGLE_FAN_ARRAY:"tristrips"==e?GeometryInfo3D.TRIANGLE_STRIP_ARRAY:GeometryInfo3D.POLYGON_ARRAY);if(t.setCoordinates(this.geometryVertices),t.setCoordinateIndices(this.getIndices(this.geometryVertexOffset)),this.geometryNormals&&(t.setNormals(this.geometryNormals),t.setNormalIndices(this.getIndices(this.geometryNormalOffset))),this.geometryTextureCoordinates){for(var i,n,o=0;o<this.sourceAccessorStrides.length;o++){var r=this.sourceAccessorStrides[o];if(r.floatArray===this.geometryTextureCoordinates){i=r.stride;break}}if(i>2){n=new Array(this.geometryTextureCoordinates.length/i*2);o=0;for(var l=0;l<this.geometryTextureCoordinates.length;l+=i)n[o++]=this.geometryTextureCoordinates[l],n[o++]=this.geometryTextureCoordinates[l+1]}else n=this.geometryTextureCoordinates;t.setTextureCoordinates(n),t.setTextureCoordinateIndices(this.getIndices(this.geometryTextureCoordinatesOffset))}if("tristrips"==e||"trifans"==e){var a=new Array(this.facesAndLinesPrimitives.length);for(o=0;o<a.length;o++)a[o]=this.facesAndLinesPrimitives[o].length/this.inputCount;t.setStripCounts(a)}else if("polylist"==e)t.setStripCounts(this.vcount);else if("polygons"==e){var s=0;for(o=0;o<this.polygonsHoles.length;o++)s+=this.polygonsHoles[o].length;a=new Array(this.facesAndLinesPrimitives.length+this.polygonsPrimitives.length+s);var h=new Array(this.facesAndLinesPrimitives.length+this.polygonsPrimitives.length),u=0,d=0;for(o=0;o<this.facesAndLinesPrimitives.length;o++)a[u++]=this.facesAndLinesPrimitives[o].length/this.inputCount,h[d++]=1;for(o=0;o<this.polygonsPrimitives.length;o++){a[u++]=this.polygonsPrimitives[o].length/this.inputCount;var c=this.polygonsHoles[o];for(l=0;l<c.length;l++)a[u++]=c[l].length/this.inputCount;h[d++]=1+c.length}t.setStripCounts(a),t.setContourCounts(h)}return this.geometryNormals||(t.setCreaseAngle(Math.PI/2),t.setGeneratedNormals(!0)),t.getIndexedGeometryArray()},DAEHandler.prototype.getLinesGeometry=function(e){var t=this.getIndices(this.geometryVertexOffset);if(0!==t.length){var i=this.geometryTextureCoordinates?this.getIndices(this.geometryTextureCoordinatesOffset):[];if("linestrips"==e){for(var n=[],o=[],r=0,l=0;r<this.facesAndLinesPrimitives.length;r++){for(var a=this.facesAndLinesPrimitives[r].length/this.inputCount,s=0;s<a-1;s++)n.push(t[l+s]),n.push(t[l+s+1]),textureCoordinateIndices.length>0&&(o.push(textureCoordinateIndices[l+s]),o.push(textureCoordinateIndices[l+s+1]));l+=a}t=n,i=o}return new IndexedLineArray3D(this.geometryVertices,t,this.geometryTextureCoordinates,i)}return null},DAEHandler.prototype.getIndices=function(e){if(1===this.facesAndLinesPrimitives.length&&1===this.polygonsPrimitives.length&&1===this.inputCount)return facesAndLinesPrimitives[0];var t=this.getIndexCount(this.facesAndLinesPrimitives);t+=this.getIndexCount(this.polygonsPrimitives);for(var i=0;i<this.polygonsHoles.length;i++)t+=this.getIndexCount(this.polygonsHoles[i]);for(var n=new Array(t/this.inputCount),o=(i=0,0);o<this.facesAndLinesPrimitives.length;o++)for(var r=this.facesAndLinesPrimitives[o],l=e;l<r.length;l+=this.inputCount)n[i++]=r[l];for(o=0;o<this.polygonsPrimitives.length;o++){var a=this.polygonsPrimitives[o];for(l=e;l<a.length;l+=this.inputCount)n[i++]=a[l];var s=this.polygonsHoles[o];for(l=0;l<s.length;l++)for(var h=s[l],u=e;u<h.length;u+=this.inputCount)n[i++]=h[u]}return n},DAEHandler.prototype.getIndexCount=function(e){for(var t=0,i=0;i<e.length;i++)t+=e[i].length;return t},DAEHandler.prototype.mulTransformGroup=function(e){var t=this.parentGroups[this.parentGroups.length-1],i=mat4.create();t.getTransform(i),mat4.mul(i,i,e),t.setTransform(i)},DAEHandler.prototype.endDocument=function(){for(var e=0;e<this.postProcessingBinders.length;e++)this.postProcessingBinders[e]();if(null!==this.visualScene){var t=mat4.create();this.visualScene.getTransform(t);var i=new BoundingBox3D(vec3.fromValues(1/0,1/0,1/0),vec3.fromValues(-1/0,-1/0,-1/0));this.computeBounds(this.visualScene,i,mat4.create());var n=vec3.create();if(i.getLower(n),n[0]!==1/0){var o=vec3.create();i.getUpper(o);var r=mat4.create();mat4.translate(r,r,vec3.fromValues(-n[0]-(o[0]-n[0])/2,-n[1]-(o[1]-n[1])/2,-n[2]-(o[2]-n[2])/2)),mat4.mul(r,r,t),t=r}var l=mat4.create();mat4.scale(l,l,vec3.fromValues(100*this.meterScale,100*this.meterScale,100*this.meterScale)),mat4.mul(l,l,t);var a=mat4.create();"Z_UP"==this.axis?mat4.fromXRotation(a,-Math.PI/2):"X_UP"==this.axis&&mat4.fromZRotation(a,Math.PI/2),mat4.mul(a,a,l),this.visualScene.setTransform(a),this.sceneRoot.addChild(this.visualScene)}},DAEHandler.prototype.computeBounds=function(e,t,i){if(e instanceof Group3D){if(e instanceof TransformGroup3D){i=mat4.clone(i);var n=mat4.create();e.getTransform(n),mat4.mul(i,i,n)}for(var o=e.getChildren(),r=0;r<o.length;r++)this.computeBounds(o[r],t,i)}else if(e instanceof Link3D)this.computeBounds(e.getSharedGroup(),t,i);else if(e instanceof Shape3D){var l=e.getBounds();l.transform(i),t.combine(l)}},Max3DSLoader.prototype=Object.create(ModelLoader.prototype),Max3DSLoader.prototype.constructor=Max3DSLoader,Max3DSLoader.NULL_CHUNK=0,Max3DSLoader.M3DMAGIC=19789,Max3DSLoader.MLIBMAGIC=15786,Max3DSLoader.CMAGIC=49725,Max3DSLoader.M3D_VERSION=2,Max3DSLoader.COLOR_FLOAT=16,Max3DSLoader.COLOR_24=17,Max3DSLoader.LINEAR_COLOR_24=18,Max3DSLoader.LINEAR_COLOR_FLOAT=19,Max3DSLoader.PERCENTAGE_INT=48,Max3DSLoader.PERCENTAGE_FLOAT=49,Max3DSLoader.EDITOR_DATA=15677,Max3DSLoader.MESH_VERSION=15678,Max3DSLoader.MASTER_SCALE=256,Max3DSLoader.MATERIAL_ENTRY=45055,Max3DSLoader.MATERIAL_NAME=40960,Max3DSLoader.MATERIAL_AMBIENT=40976,Max3DSLoader.MATERIAL_DIFFUSE=40992,Max3DSLoader.MATERIAL_SPECULAR=41008,Max3DSLoader.MATERIAL_SHININESS=41024,Max3DSLoader.MATERIAL_TRANSPARENCY=41040,Max3DSLoader.MATERIAL_TWO_SIDED=41089,Max3DSLoader.MATERIAL_TEXMAP=41472,Max3DSLoader.MATERIAL_MAPNAME=41728,Max3DSLoader.NAMED_OBJECT=16384,Max3DSLoader.TRIANGLE_MESH_OBJECT=16640,Max3DSLoader.POINT_ARRAY=16656,Max3DSLoader.FACE_ARRAY=16672,Max3DSLoader.MESH_MATERIAL_GROUP=16688,Max3DSLoader.SMOOTHING_GROUP=16720,Max3DSLoader.MESH_BOXMAP=16784,Max3DSLoader.TEXTURE_COORDINATES=16704,Max3DSLoader.MESH_MATRIX=16736,Max3DSLoader.MESH_COLOR=16741,Max3DSLoader.KEY_FRAMER_DATA=45056,Max3DSLoader.OBJECT_NODE_TAG=45058,Max3DSLoader.NODE_ID=45104,Max3DSLoader.NODE_HIERARCHY=45072,Max3DSLoader.PIVOT=45075,Max3DSLoader.POSITION_TRACK_TAG=45088,Max3DSLoader.ROTATION_TRACK_TAG=45089,Max3DSLoader.SCALE_TRACK_TAG=45090,Max3DSLoader.TRACK_KEY_USE_TENS=1,Max3DSLoader.TRACK_KEY_USE_CONT=2,Max3DSLoader.TRACK_KEY_USE_BIAS=4,Max3DSLoader.TRACK_KEY_USE_EASE_TO=8,Max3DSLoader.TRACK_KEY_USE_EASE_FROM=16,Max3DSLoader.DEFAULT_APPEARANCE=null,Max3DSLoader.prototype.createScene=function(e,t,i,n,o,r,l){var a=new Group3D,s=mat4.create();mat4.fromXRotation(s,-Math.PI/2),mat4.scale(s,s,vec3.fromValues(o,o,o));var h=new TransformGroup3D(s);a.addChild(h),n.getChildren().length>0&&(h.addChild(n),h=n);var u={};for(var d in i){var c=i[d],p=new Appearance3D(d);if(null!==c.ambientColor&&p.setAmbientColor(c.ambientColor),null!==c.diffuseColor&&p.setDiffuseColor(c.diffuseColor),null!==c.shininess&&p.setShininess(128*c.shininess*.6),null!==c.specularColor)if(null!==c.shininess){var g=vec3.clone(c.specularColor);vec3.scale(g,g,c.shininess),p.setSpecularColor(g)}else p.setSpecularColor(c.specularColor);null!==c.transparency&&c.transparency>0&&p.setTransparency(Math.min(1,c.transparency)),c.texture&&(p.imageEntryName=c.texture),u[d]=p}if(null===r){l(ModelLoader.BUILDING_MODEL,"",0);for(var m=0;m<e.length;m++)this.createShapes(e[m],t,u,a,h);return l(ModelLoader.BUILDING_MODEL,"",1),a}var f=e.length,v=0,_=this,S=function(){l(ModelLoader.BUILDING_MODEL,"",0!==f?v/f:0);for(var i=Date.now();e.length>0;)if(_.createShapes(e[0],t,u,a,h),v++,e.splice(0,1),v<f&&Date.now()-i>10)return void setTimeout(S,0);setTimeout((function(){l(ModelLoader.BUILDING_MODEL,"",1),r(a)}),0)};S()},Max3DSLoader.prototype.createShapes=function(e,t,i,n,o){var r=mat4.create(),l=e.faces;if(null!==l&&l.length>0){for(var a=e.vertices,s=new Array(a.length),h=0;h<s.length;h++)s[h]=null;for(var u=new Array(3*l.length),d=vec3.create(),c=vec3.create(),p=(h=0,0);h<l.length;h++)for(var g=(k=l[h]).vertexIndices,m=0;m<3;m++,p++){var f=g[m];vec3.subtract(d,a[g[m<2?m+1:0]],a[f]),vec3.subtract(c,a[g[m>0?m-1:2]],a[f]);var v=vec3.create();vec3.cross(v,d,c);var _=vec3.length(v);if(_>0){var S=Math.atan2(_,vec3.dot(d,c));vec3.scale(v,v,S/_)}(P=new Max3DSLoader.Mesh3DSSharedVertex(h,v)).nextVertex=s[f],s[f]=P,u[p]=v}var y,E=new Array(3*l.length);for(h=0,p=0;h<l.length;h++){g=(k=l[h]).vertexIndices;var C=new Array(3);for(m=0;m<3;m++,p++){f=g[m],v=vec3.create();if(null===k.smoothingGroup)for(var P=s[f];null!==P;P=P.nextVertex)null===l[P.faceIndex].smoothingGroup&&(P.normal===u[p]||vec3.dot(P.normal,u[p])>0)&&vec3.add(v,v,P.normal);else{var w=k.smoothingGroup;for(P=s[f];null!==P;P=P.nextVertex){null!==(L=l[P.faceIndex]).smoothingGroup&&0!=(k.smoothingGroup&L.smoothingGroup)&&(w|=L.smoothingGroup)}for(P=s[f];null!==P;P=P.nextVertex){var L;null!==(L=l[P.faceIndex]).smoothingGroup&&0!=(w&L.smoothingGroup)&&vec3.add(v,v,P.normal)}}0!==vec3.squaredLength(v)?vec3.normalize(v,v):(vec3.copy(v,u[p]),0!==vec3.squaredLength(v)&&vec3.normalize(v,v)),E[p]=v,C[m]=p}k.normalIndices=C}l.sort((function(e,t){var i=e.material,n=t.material;return null===i?null===n?e.index-t.index:-1:null===n?1:0}));var T=t[e.name];if(void 0===T)y=o;else if(1===T.length)y=T[0];else{var A=new SharedGroup3D;for(h=0;h<T.length;h++)T[h].addChild(new Link3D(A));y=A}var I=e.transform;if(null!==I&&!mat4.exactEquals(I,r)){var b=new TransformGroup3D(I);y.addChild(b),y=b}for(var O=e.textureCoordinates,M=(h=0,null),D=null;h<l.length;){for(var R=l[h].material,F=h;++F<l.length&&R===l[F].material;);var x=F-h,N=new Array(3*x);for(C=new Array(3*x),m=0,p=0;m<x;m++){g=(k=l[h+m]).vertexIndices;for(var k,H=k.normalIndices,V=0;V<3;V++,p++)N[p]=g[V],C[p]=H[V]}var U=new GeometryInfo3D(GeometryInfo3D.TRIANGLE_ARRAY);if(U.setCoordinates(a),U.setCoordinateIndices(N),U.setNormals(E),U.setNormalIndices(C),null!==O&&(U.setTextureCoordinates(O),U.setTextureCoordinateIndices(N)),geometryArray=U.getIndexedGeometryArray(),null===M||D!==R){D=R;var W=Max3DSLoader.DEFAULT_APPEARANCE;null!==R&&void 0!==i[R.name]&&(W=i[R.name]),W=W.clone(),null!==R&&R.twoSided&&W.setCullFace(Appearance3D.CULL_NONE),M=new Shape3D(geometryArray,W),y.addChild(M),M.setName(e.name+(0===h?"":"_"+h))}else M.addGeometry(geometryArray);h=F}}},Max3DSLoader.prototype.getModelContent=function(e){return e.asUint8Array()},Max3DSLoader.prototype.parseEntryScene=function(e,t,i,n,o,r){var l,a=[],s={},h={},u=new TransformGroup3D;if(null===o)return r(ModelLoader.PARSING_MODEL,t,0),l=this.parse3DSStream(new Max3DSLoader.ChunksInputStream(e),t,i,a,s,h,u),r(ModelLoader.PARSING_MODEL,t,1),this.createScene(a,s,h,u,l,null,r);var d=this;l=this.parse3DSStream(new Max3DSLoader.ChunksInputStream(e),t,i,a,s,h,u);setTimeout((function(){r(ModelLoader.PARSING_MODEL,t,1),d.createScene(a,s,h,u,l,(function(e){o(e)}),r)}),0)},Max3DSLoader.prototype.parse3DSStream=function(e,t,i,n,o,r,l){var a=1;try{var s=!1;switch(e.readChunkHeader().id){case Max3DSLoader.M3DMAGIC:case Max3DSLoader.MLIBMAGIC:case Max3DSLoader.CMAGIC:for(s=!0;!e.isChunckEndReached();){switch(e.readChunkHeader().id){case Max3DSLoader.M3D_VERSION:e.readLittleEndianUnsignedInt();break;case Max3DSLoader.EDITOR_DATA:this.parseEditorData(e,t,i,n,r);break;case Max3DSLoader.KEY_FRAMER_DATA:this.parseKeyFramerData(e,o,l);break;default:e.readUntilChunkEnd()}e.releaseChunk()}break;case Max3DSLoader.EDITOR_DATA:a=this.parseEditorData(e,t,i,n,r);break;default:if(!s)throw new IncorrectFormat3DException("Bad magic number");e.readUntilChunkEnd()}e.releaseChunk()}catch(e){n.length=0}return a},Max3DSLoader.prototype.parseEditorData=function(e,t,i,n,o){for(var r=1;!e.isChunckEndReached();){switch(e.readChunkHeader().id){case Max3DSLoader.MESH_VERSION:e.readLittleEndianInt();break;case Max3DSLoader.MASTER_SCALE:r=e.readLittleEndianFloat();break;case Max3DSLoader.NAMED_OBJECT:this.parseNamedObject(e,n,o);break;case Max3DSLoader.MATERIAL_ENTRY:var l=this.parseMaterial(e,t,i);o[l.name]=l;break;default:e.readUntilChunkEnd()}e.releaseChunk()}return r},Max3DSLoader.prototype.parseNamedObject=function(e,t,i){for(var n=e.readString();!e.isChunckEndReached();){if(e.readChunkHeader().id===Max3DSLoader.TRIANGLE_MESH_OBJECT)t.push(this.parseMeshData(e,n,i));else e.readUntilChunkEnd();e.releaseChunk()}},Max3DSLoader.prototype.parseMeshData=function(e,t,i){for(var n=null,o=null,r=null,l=null,a=null;!e.isChunckEndReached();){switch(e.readChunkHeader().id){case Max3DSLoader.MESH_MATRIX:r=this.parseMatrix(e),r=mat4.invert(r,r);break;case Max3DSLoader.MESH_COLOR:l=e.readUnsignedByte();break;case Max3DSLoader.POINT_ARRAY:n=new Array(e.readLittleEndianUnsignedShort());for(var s=0;s<n.length;s++)n[s]=vec3.fromValues(e.readLittleEndianFloat(),e.readLittleEndianFloat(),e.readLittleEndianFloat());break;case Max3DSLoader.FACE_ARRAY:for(a=this.parseFacesData(e);!e.isChunckEndReached();){switch(e.readChunkHeader().id){case Max3DSLoader.MESH_MATERIAL_GROUP:var h=e.readString(),u=null;null!==i&&(u=i[h]);s=0;for(var d=e.readLittleEndianUnsignedShort();s<d;s++){var c=e.readLittleEndianUnsignedShort();c<a.length&&(a[c].material=u)}break;case Max3DSLoader.SMOOTHING_GROUP:for(s=0;s<a.length;s++)a[s].smoothingGroup=e.readLittleEndianUnsignedInt();break;case Max3DSLoader.MESH_BOXMAP:default:e.readUntilChunkEnd()}e.releaseChunk()}break;case Max3DSLoader.TEXTURE_COORDINATES:o=new Array(e.readLittleEndianUnsignedShort());for(s=0;s<o.length;s++)o[s]=vec2.fromValues(e.readLittleEndianFloat(),e.readLittleEndianFloat());break;default:e.readUntilChunkEnd()}e.releaseChunk()}return new Max3DSLoader.Mesh3DS(t,n,o,a,l,r)},Max3DSLoader.prototype.parseKeyFramerData=function(e,t,i){for(var n=[],o=[],r=null;!e.isChunckEndReached();){if(e.readChunkHeader().id===Max3DSLoader.OBJECT_NODE_TAG){for(var l=!0,a=null,s=null,h=0,u=null,d=null,c=-1;!e.isChunckEndReached();){switch(e.readChunkHeader().id){case Max3DSLoader.NODE_ID:c=e.readLittleEndianShort();break;case Max3DSLoader.NODE_HIERARCHY:var p=e.readString();l="$$$DUMMY"!=p,e.readLittleEndianUnsignedShort(),e.readLittleEndianUnsignedShort();var g=e.readLittleEndianShort(),m=new TransformGroup3D;if(-1===g)i.addChild(m);else{for(var f=!1,v=0;v<o.length;v++)if(g===o[v]){n[v].addChild(m),f=!0;break}if(!f)throw new IncorrectFormat3DException("Inconsistent nodes hierarchy")}if(o.push(c),n.push(m),l){var _=t[p];void 0===_&&(_=[],t[p]=_),_.push(m)}r=m;break;case Max3DSLoader.PIVOT:a=this.parseVector(e);break;case Max3DSLoader.POSITION_TRACK_TAG:this.parseKeyFramerTrackStart(e),s=this.parseVector(e),e.readUntilChunkEnd();break;case Max3DSLoader.ROTATION_TRACK_TAG:this.parseKeyFramerTrackStart(e),h=e.readLittleEndianFloat(),u=this.parseVector(e),e.readUntilChunkEnd();break;case Max3DSLoader.SCALE_TRACK_TAG:this.parseKeyFramerTrackStart(e),d=this.parseVector(e),e.readUntilChunkEnd();break;default:e.readUntilChunkEnd()}e.releaseChunk()}var S=mat4.create();if(null!==s&&mat4.translate(S,S,s),null!==u&&0!==h){var y=vec3.length(u);if(y>0){var E=-h/2,C=Math.sin(E)/y,P=Math.cos(E),w=mat4.create();mat4.fromQuat(w,quat.fromValues(u[0]*C,u[1]*C,u[2]*C,P)),mat4.mul(S,S,w)}}null!==d&&mat4.scale(S,S,d),null!==a&&l&&(vec3.negate(a,a),mat4.translate(S,S,a)),r.setTransform(S)}else e.readUntilChunkEnd();e.releaseChunk()}},Max3DSLoader.prototype.parseKeyFramerTrackStart=function(e){e.readLittleEndianUnsignedShort(),e.readLittleEndianUnsignedInt(),e.readLittleEndianUnsignedInt(),e.readLittleEndianInt(),e.readLittleEndianInt();var t=e.readLittleEndianUnsignedShort();0!=(t&Max3DSLoader.TRACK_KEY_USE_TENS)&&e.readLittleEndianFloat(),0!=(t&Max3DSLoader.TRACK_KEY_USE_CONT)&&e.readLittleEndianFloat(),0!=(t&Max3DSLoader.TRACK_KEY_USE_BIAS)&&e.readLittleEndianFloat(),0!=(t&Max3DSLoader.TRACK_KEY_USE_EASE_TO)&&e.readLittleEndianFloat(),0!=(t&Max3DSLoader.TRACK_KEY_USE_EASE_FROM)&&e.readLittleEndianFloat()},Max3DSLoader.prototype.parseFacesData=function(e){for(var t=new Array(e.readLittleEndianUnsignedShort()),i=0;i<t.length;i++)t[i]=new Max3DSLoader.Face3DS(i,e.readLittleEndianUnsignedShort(),e.readLittleEndianUnsignedShort(),e.readLittleEndianUnsignedShort(),e.readLittleEndianUnsignedShort());return t},Max3DSLoader.prototype.parseMaterial=function(e,t,i){for(var n=null,o=null,r=null,l=null,a=null,s=null,h=!1,u=null;!e.isChunckEndReached();){switch(e.readChunkHeader().id){case Max3DSLoader.MATERIAL_NAME:n=e.readString();break;case Max3DSLoader.MATERIAL_AMBIENT:o=this.parseColor(e);break;case Max3DSLoader.MATERIAL_DIFFUSE:r=this.parseColor(e);break;case Max3DSLoader.MATERIAL_SPECULAR:l=this.parseColor(e);break;case Max3DSLoader.MATERIAL_SHININESS:a=this.parsePercentage(e);break;case Max3DSLoader.MATERIAL_TRANSPARENCY:s=this.parsePercentage(e);break;case Max3DSLoader.MATERIAL_TWO_SIDED:h=!0;break;case Max3DSLoader.MATERIAL_TEXMAP:u=this.parseTextureMap(e,t,i);break;default:e.readUntilChunkEnd()}e.releaseChunk()}return new Max3DSLoader.Material3DS(n,o,r,l,a,s,u,h)},Max3DSLoader.prototype.parseColor=function(e){for(var t,i=!1,n=null;!e.isChunckEndReached();){switch(e.readChunkHeader().id){case Max3DSLoader.LINEAR_COLOR_24:i=!0,n=vec3.fromValues(e.readUnsignedByte()/255,e.readUnsignedByte()/255,e.readUnsignedByte()/255);break;case Max3DSLoader.COLOR_24:t=vec3.fromValues(e.readUnsignedByte()/255,e.readUnsignedByte()/255,e.readUnsignedByte()/255),i||(n=t);break;case Max3DSLoader.LINEAR_COLOR_FLOAT:i=!0,n=vec3.fromValues(e.readLittleEndianFloat(),e.readLittleEndianFloat(),e.readLittleEndianFloat());break;case Max3DSLoader.COLOR_FLOAT:t=vec3.fromValues(e.readLittleEndianFloat(),e.readLittleEndianFloat(),e.readLittleEndianFloat()),i||(n=t);break;default:e.readUntilChunkEnd()}e.releaseChunk()}if(null!==n)return n;throw new IncorrectFormat3DException("Expected color value")},Max3DSLoader.prototype.parsePercentage=function(e){for(var t=null;!e.isChunckEndReached();){switch(e.readChunkHeader().id){case Max3DSLoader.PERCENTAGE_INT:t=e.readLittleEndianShort()/100;break;case Max3DSLoader.PERCENTAGE_FLOAT:t=e.readLittleEndianFloat();break;default:e.readUntilChunkEnd()}e.releaseChunk()}if(null!==t)return t;throw new IncorrectFormat3DException("Expected percentage value")},Max3DSLoader.prototype.parseTextureMap=function(e,t,i){for(var n=null;!e.isChunckEndReached();){switch(e.readChunkHeader().id){case Max3DSLoader.MATERIAL_MAPNAME:n=e.readString();break;case Max3DSLoader.PERCENTAGE_INT:default:e.readUntilChunkEnd()}e.releaseChunk()}if(null!==n){var o=t.lastIndexOf("/");return o>=0&&(n=t.substring(0,o+1)+n),null!==i.file(n)?n:this.getEntryNameIgnoreCase(i,n)}return null},Max3DSLoader.prototype.getEntryNameIgnoreCase=function(e,t){t=t.toUpperCase();for(var i=e.file(/.*/),n=0;n<i.length;n++)if(i[n].name.toUpperCase()==t)return i[n].name;return null},Max3DSLoader.prototype.parseMatrix=function(e){return mat4.fromValues(e.readLittleEndianFloat(),e.readLittleEndianFloat(),e.readLittleEndianFloat(),0,e.readLittleEndianFloat(),e.readLittleEndianFloat(),e.readLittleEndianFloat(),0,e.readLittleEndianFloat(),e.readLittleEndianFloat(),e.readLittleEndianFloat(),0,e.readLittleEndianFloat(),e.readLittleEndianFloat(),e.readLittleEndianFloat(),1)},Max3DSLoader.prototype.parseVector=function(e){return vec3.fromValues(e.readLittleEndianFloat(),e.readLittleEndianFloat(),e.readLittleEndianFloat())},Max3DSLoader.Chunk3DS=function(e,t){if(t<6)throw new IncorrectFormat3DException("Invalid chunk "+e+" length "+t);this.id=e,this.length=t,this.readLength=6},Max3DSLoader.Chunk3DS.prototype.incrementReadLength=function(e){this.readLength+=e},Max3DSLoader.Chunk3DS.prototype.toString=function(){return this.id+" "+this.length},Max3DSLoader.ChunksInputStream=function(e){this.input=e,this.index=0,this.stack=[]},Max3DSLoader.ChunksInputStream.prototype.read=function(){return this.index>=this.input.length?-1:this.input[this.index++]},Max3DSLoader.ChunksInputStream.prototype.readChunkHeader=function(){var e=this.readLittleEndianUnsignedShort(!1),t=new Max3DSLoader.Chunk3DS(e,this.readLittleEndianUnsignedInt(!1));return this.stack.push(t),t},Max3DSLoader.ChunksInputStream.prototype.releaseChunk=function(){var e=this.stack.pop();if(e.length!==e.readLength)throw new IncorrectFormat3DException("Chunk "+e.id+" invalid length. Expected to read "+e.length+" bytes, but actually read "+e.readLength+" bytes");0!==this.stack.length&&this.stack[this.stack.length-1].incrementReadLength(e.length)},Max3DSLoader.ChunksInputStream.prototype.isChunckEndReached=function(){var e=this.stack[this.stack.length-1];return e.length===e.readLength},Max3DSLoader.ChunksInputStream.prototype.readUntilChunkEnd=function(){for(var e=this.stack[this.stack.length-1],t=e.length-e.readLength,i=t;i>0;i--)if(this.read()<0)throw new IncorrectFormat3DException("Chunk "+e.id+" too short");e.incrementReadLength(t)},Max3DSLoader.ChunksInputStream.prototype.readUnsignedByte=function(){var e=this.read();if(-1===e)throw new IncorrectFormat3DException("Unexpected EOF");return this.stack[this.stack.length-1].incrementReadLength(1),e},Max3DSLoader.ChunksInputStream.prototype.readLittleEndianUnsignedShort=function(e){void 0===e&&(e=!0);var t=this.read();if(-1===t)throw new IncorrectFormat3DException("Unexpected EOF");var i=this.read();if(-1===i)throw new IncorrectFormat3DException("Can't read short");return e&&this.stack[this.stack.length-1].incrementReadLength(2),i<<8|t},Max3DSLoader.ChunksInputStream.prototype.readLittleEndianShort=function(e){var t=this.readLittleEndianUnsignedShort(e);return 32768&t&&(t|=-32768),t},Max3DSLoader.ChunksInputStream.converter=new Int8Array(4),Max3DSLoader.ChunksInputStream.int32Converter=new Int32Array(Max3DSLoader.ChunksInputStream.converter.buffer,0,1),Max3DSLoader.ChunksInputStream.float32Converter=new Float32Array(Max3DSLoader.ChunksInputStream.converter.buffer,0,1),Max3DSLoader.ChunksInputStream.prototype.readLittleEndianFloat=function(){return Max3DSLoader.ChunksInputStream.int32Converter[0]=this.readLittleEndianUnsignedInt(!0),Max3DSLoader.ChunksInputStream.float32Converter[0]},Max3DSLoader.ChunksInputStream.prototype.readLittleEndianUnsignedInt=function(e){void 0===e&&(e=!0);var t=this.read();if(-1===t)throw new IncorrectFormat3DException("Unexpected EOF");var i=this.read(),n=this.read(),o=this.read();if(-1===i||-1===n||-1===o)throw new IncorrectFormat3DException("Can't read int");return e&&this.stack[this.stack.length-1].incrementReadLength(4),o<<24|n<<16|i<<8|t},Max3DSLoader.ChunksInputStream.prototype.readLittleEndianInt=function(e){var t=this.readLittleEndianUnsignedInt(e);return 2147483648&t&&(t|=-2147483648),t},Max3DSLoader.ChunksInputStream.prototype.readString=function(){for(var e,t="";-1!==(e=this.read())&&0!==e;)t+=String.fromCharCode(e);if(-1===e)throw new IncorrectFormat3DException("Unexpected end of file");return this.stack[this.stack.length-1].incrementReadLength(t.length+1),t},Max3DSLoader.Mesh3DS=function(e,t,i,n,o,r){this.name=e,this.vertices=t,this.textureCoordinates=i,this.faces=n,this.color=o,this.transform=r},Max3DSLoader.Face3DS=function(e,t,i,n,o){this.index=e,this.vertexIndices=[t,i,n],this.normalIndices=null,this.material=null,this.smoothingGroup=null},Max3DSLoader.Material3DS=function(e,t,i,n,o,r,l,a){this.name=e,this.ambientColor=t,this.diffuseColor=i,this.specularColor=n,this.shininess=o,this.transparency=r,this.texture=l,this.twoSided=a},Max3DSLoader.Mesh3DSSharedVertex=function(e,t){this.faceIndex=e,this.normal=t,this.nextVertex=null},ModelManager.SPECIAL_SHAPE_PREFIX="sweethome3d_",ModelManager.WINDOW_PANE_SHAPE_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"window_pane",ModelManager.MIRROR_SHAPE_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"window_mirror",ModelManager.LIGHT_SHAPE_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"light",ModelManager.MANNEQUIN_ABDOMEN_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"mannequin_abdomen",ModelManager.MANNEQUIN_CHEST_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"mannequin_chest",ModelManager.MANNEQUIN_PELVIS_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"mannequin_pelvis",ModelManager.MANNEQUIN_NECK_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"mannequin_neck",ModelManager.MANNEQUIN_HEAD_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"mannequin_head",ModelManager.MANNEQUIN_LEFT_SHOULDER_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"mannequin_left_shoulder",ModelManager.MANNEQUIN_LEFT_ARM_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"mannequin_left_arm",ModelManager.MANNEQUIN_LEFT_ELBOW_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"mannequin_left_elbow",ModelManager.MANNEQUIN_LEFT_FOREARM_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"mannequin_left_forearm",ModelManager.MANNEQUIN_LEFT_WRIST_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"mannequin_left_wrist",ModelManager.MANNEQUIN_LEFT_HAND_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"mannequin_left_hand",ModelManager.MANNEQUIN_LEFT_HIP_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"mannequin_left_hip",ModelManager.MANNEQUIN_LEFT_THIGH_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"mannequin_left_thigh",ModelManager.MANNEQUIN_LEFT_KNEE_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"mannequin_left_knee",ModelManager.MANNEQUIN_LEFT_LEG_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"mannequin_left_leg",ModelManager.MANNEQUIN_LEFT_ANKLE_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"mannequin_left_ankle",ModelManager.MANNEQUIN_LEFT_FOOT_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"mannequin_left_foot",ModelManager.MANNEQUIN_RIGHT_SHOULDER_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"mannequin_right_shoulder",ModelManager.MANNEQUIN_RIGHT_ARM_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"mannequin_right_arm",ModelManager.MANNEQUIN_RIGHT_ELBOW_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"mannequin_right_elbow",ModelManager.MANNEQUIN_RIGHT_FOREARM_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"mannequin_right_forearm",ModelManager.MANNEQUIN_RIGHT_WRIST_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"mannequin_right_wrist",ModelManager.MANNEQUIN_RIGHT_HAND_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"mannequin_right_hand",ModelManager.MANNEQUIN_RIGHT_HIP_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"mannequin_right_hip",ModelManager.MANNEQUIN_RIGHT_THIGH_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"mannequin_right_thigh",ModelManager.MANNEQUIN_RIGHT_KNEE_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"mannequin_right_knee",ModelManager.MANNEQUIN_RIGHT_LEG_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"mannequin_right_leg",ModelManager.MANNEQUIN_RIGHT_ANKLE_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"mannequin_right_ankle",ModelManager.MANNEQUIN_RIGHT_FOOT_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"mannequin_right_foot",ModelManager.MANNEQUIN_ABDOMEN_CHEST_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"mannequin_abdomen_chest",ModelManager.MANNEQUIN_ABDOMEN_PELVIS_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"mannequin_abdomen_pelvis",ModelManager.BALL_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"ball_",ModelManager.ARM_ON_BALL_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"arm_on_ball_",ModelManager.HINGE_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"hinge_",ModelManager.OPENING_ON_HINGE_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"opening_on_hinge_",ModelManager.WINDOW_PANE_ON_HINGE_PREFIX=ModelManager.WINDOW_PANE_SHAPE_PREFIX+"_on_hinge_",ModelManager.MIRROR_ON_HINGE_PREFIX=ModelManager.MIRROR_SHAPE_PREFIX+"_on_hinge_",ModelManager.UNIQUE_RAIL_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"unique_rail",ModelManager.RAIL_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"rail_",ModelManager.OPENING_ON_RAIL_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"opening_on_rail_",ModelManager.WINDOW_PANE_ON_RAIL_PREFIX=ModelManager.WINDOW_PANE_SHAPE_PREFIX+"_on_rail_",ModelManager.MIRROR_ON_RAIL_PREFIX=ModelManager.MIRROR_SHAPE_PREFIX+"_on_rail_",ModelManager.SUB_TRANSFORMATION_SEPARATOR="_and_",ModelManager.DEFORMABLE_TRANSFORM_GROUP_SUFFIX="_transformation",ModelManager.EDGE_COLOR_MATERIAL_PREFIX="edge_color",ModelManager.instance=null,ModelManager.getInstance=function(){return null==ModelManager.instance&&(ModelManager.instance=new ModelManager),ModelManager.instance},ModelManager.prototype.clear=function(){if(this.loadedModelNodes={},this.loadingModelObservers={},this.modelLoaders)for(var e=0;e<this.modelLoaders.length;e++)this.modelLoaders[e].clear()},ModelManager.prototype.getMinimumSize=function(){return.001},ModelManager.prototype.getSize=function(e,t){void 0===t&&(t=mat4.create());var i=this.getBounds(e,t),n=vec3.create();i.getLower(n);var o=vec3.create();return i.getUpper(o),vec3.fromValues(Math.max(this.getMinimumSize(),o[0]-n[0]),Math.max(this.getMinimumSize(),o[1]-n[1]),Math.max(this.getMinimumSize(),o[2]-n[2]))},ModelManager.prototype.getCenter=function(e){var t=this.getBounds(e),i=vec3.create();t.getLower(i);var n=vec3.create();return t.getUpper(n),vec3.fromValues((i[0]+n[0])/2,(i[1]+n[1])/2,(i[2]+n[2])/2)},ModelManager.prototype.getBounds=function(e,t){void 0===t&&(t=mat4.create());var i=new BoundingBox3D(vec3.fromValues(1/0,1/0,1/0),vec3.fromValues(-1/0,-1/0,-1/0));return this.computeBounds(e,i,t,!this.isOrthogonalRotation(t),this.isDeformed(e)),i},ModelManager.prototype.isOrthogonalRotation=function(e){for(var t=0;t<3;t++)for(var i=0;i<3;i++)if(Math.abs(e[4*t+i])>1e-6&&Math.abs(e[4*t+i]-1)>1e-6&&Math.abs(e[4*t+i]+1)>1e-6)return!1;return!0},ModelManager.prototype.computeBounds=function(e,t,i,n,o){if(e instanceof Group3D){e instanceof TransformGroup3D&&(i=mat4.clone(i),mat4.mul(i,i,e.transform));for(var r=0;r<e.children.length;r++)this.computeBounds(e.children[r],t,i,n,o)}else{var l;if(e instanceof Link3D)this.computeBounds(e.getSharedGroup(),t,i,n,o);else if(e instanceof Shape3D)n||o&&!this.isOrthogonalRotation(i)?l=this.computeTransformedGeometryBounds(e,i):(l=e.getBounds()).transform(i),t.combine(l)}},ModelManager.prototype.computeTransformedGeometryBounds=function(e,t){for(var i=vec3.fromValues(1/0,1/0,1/0),n=vec3.fromValues(-1/0,-1/0,-1/0),o=0;o<e.geometries.length;o++)for(var r=e.geometries[o],l=vec3.create(),a=0;a<r.vertexIndices.length;a++)vec3.copy(l,r.vertices[r.vertexIndices[a]]),this.updateBounds(l,t,i,n);return new BoundingBox3D(i,n)},ModelManager.prototype.updateBounds=function(e,t,i,n){null!==t&&vec3.transformMat4(e,e,t),vec3.min(i,i,e),vec3.max(n,n,e)},ModelManager.prototype.getNormalizedTransformGroup=function(e,t,i,n){return new TransformGroup3D(this.getNormalizedTransform(e,t,i,!1!==n))},ModelManager.prototype.getNormalizedTransform=function(e,t,i,n){var o=this.getBounds(e),r=vec3.create();o.getLower(r);var l=vec3.create();o.getUpper(l);var a,s=mat4.create();if(mat4.translate(s,s,vec3.fromValues(-r[0]-(l[0]-r[0])/2,-r[1]-(l[1]-r[1])/2,-r[2]-(l[2]-r[2])/2)),null!=t){var h=this.getRotationTransformation(t);mat4.mul(h,h,s);var u=this.getBounds(e,h);u.getLower(r),u.getUpper(l),a=mat4.create(),n&&mat4.translate(a,a,vec3.fromValues(-r[0]-(l[0]-r[0])/2,-r[1]-(l[1]-r[1])/2,-r[2]-(l[2]-r[2])/2)),mat4.mul(a,a,h)}else a=s;var d=mat4.create();return mat4.scale(d,d,vec3.fromValues(i/Math.max(this.getMinimumSize(),l[0]-r[0]),i/Math.max(this.getMinimumSize(),l[1]-r[1]),i/Math.max(this.getMinimumSize(),l[2]-r[2]))),mat4.mul(d,d,a),d},ModelManager.prototype.getRotationTransformation=function(e){var t=mat4.create();return t[0]=e[0][0],t[4]=e[0][1],t[8]=e[0][2],t[1]=e[1][0],t[5]=e[1][1],t[9]=e[1][2],t[2]=e[2][0],t[6]=e[2][1],t[10]=e[2][2],t},ModelManager.prototype.getPieceOfFurnitureNormalizedModelTransformation=function(e,t){var i,n,o=mat4.create(),r=e.getWidth();if(e.isModelMirrored()&&(r*=-1),mat4.scale(o,o,vec3.fromValues(r,e.getHeight(),e.getDepth())),e.isHorizontallyRotated()&&null!=t){var l=mat4.create();if(0!=e.getPitch()&&mat4.fromXRotation(l,-e.getPitch()),0!=e.getRoll()){var a=mat4.create();mat4.fromZRotation(a,-e.getRoll()),mat4.mul(l,a,l)}mat4.mul(l,l,o);var s=this.getBounds(t,l),h=vec3.create();s.getLower(h);var u=vec3.create();s.getUpper(u),i=mat4.create(),mat4.translate(i,i,vec3.fromValues(-h[0]-(u[0]-h[0])/2,-h[1]-(u[1]-h[1])/2,-h[2]-(u[2]-h[2])/2)),mat4.mul(i,i,l),n=Math.max(this.getMinimumSize(),u[1]-h[1])}else i=o,n=e.getHeight();var d=mat4.create();mat4.fromYRotation(d,-e.getAngle()),mat4.mul(d,d,i);var c,p=mat4.create();return c=null!==e.getLevel()?e.getLevel().getElevation():0,mat4.translate(p,p,vec3.fromValues(e.getX(),e.getElevation()+n/2+c,e.getY())),mat4.mul(p,p,d),p},ModelManager.prototype.getPieceOFFurnitureNormalizedModelTransformation=ModelManager.prototype.getPieceOfFurnitureNormalizedModelTransformation,ModelManager.prototype.loadModel=function(e,t,i){void 0===i&&(i=t,t=!1);var n=this,o=e.getURL();if(o in this.loadedModelNodes){var r=this.loadedModelNodes[o];void 0!==i.modelUpdated&&i.modelUpdated(this.cloneNode(r))}else if(t)this.load(e,t,{modelLoaded:function(e){n.loadedModelNodes[o]=e,void 0!==i.modelUpdated&&i.modelUpdated(n.cloneNode(e))},modelError:function(e){void 0!==i.modelError&&i.modelError(e)},progression:function(e,t,n){void 0!==i.progression&&i.progression(e,t,n)}});else if(o in this.loadingModelObservers)this.loadingModelObservers[o].push(i);else{var l=[];l.push(i),this.loadingModelObservers[o]=l,this.load(e,t,{modelLoaded:function(e){n.loadedModelNodes[o]=e;var t=n.loadingModelObservers[o];if(t)for(var i=0;i<t.length;i++)void 0!==t[i].modelUpdated&&t[i].modelUpdated(n.cloneNode(e))},modelError:function(e){var t=n.loadingModelObservers[o];if(t){delete n.loadingModelObservers[o];for(var i=0;i<t.length;i++)void 0!==t[i].modelError&&t[i].modelError(e)}},progression:function(e,t,i){var r=n.loadingModelObservers[o];if(r)for(var l=0;l<r.length;l++)void 0!==r[l].progression&&r[l].progression(e,t,i)}})}},ModelManager.prototype.unloadModel=function(e,t){var i=e.getURL(),n=this.loadedModelNodes[i];delete this.loadedModelNodes[i],delete this.loadingModelObservers[i],t&&this.disposeGeometries(n)},ModelManager.prototype.disposeGeometries=function(e){if(e instanceof Group3D)for(var t=0;t<e.children.length;t++)this.disposeGeometries(e.children[t]);else if(e instanceof Link3D)this.disposeGeometries(e.getSharedGroup());else if(e instanceof Shape3D){var i=e.getGeometries();for(t=0;t<i.length;t++)i[t].disposeCoordinates()}},ModelManager.prototype.cloneNode=function(e,t){if(void 0===t)return this.cloneNode(e,[]);var i=e.clone();if(e instanceof Shape3D){e.getAppearance()&&i.setAppearance(e.getAppearance().clone())}else{if(e instanceof Link3D){var n=e.clone(),o=n.getSharedGroup();if(null!==o){for(var r=null,l=0;l<t.length;l++)if(t[l].sharedGroup===o){r=t[l].clonedSharedGroup;break}null===r&&(r=this.cloneNode(o,t),t.push({sharedGroup:o,clonedSharedGroup:r})),n.setSharedGroup(r)}return n}if(i=e.clone(),e instanceof Group3D){var a=e.getChildren();for(l=0;l<a.length;l++){var s=this.cloneNode(a[l],t);i.addChild(s)}}}return i},ModelManager.prototype.load=function(e,t,i){void 0===i&&(i=t,t=!1);var n=e.getURL();this.modelLoaders||(this.modelLoaders=[new OBJLoader],void 0!==DAELoader&&this.modelLoaders.push(new DAELoader),void 0!==Max3DSLoader&&this.modelLoaders.push(new Max3DSLoader));var o=this,r={modelLoaderIndex:0,modelLoaded:function(r){o.getBounds(r).isEmpty()?++this.modelLoaderIndex<o.modelLoaders.length?o.modelLoaders[this.modelLoaderIndex].load(n,t,this):this.modelError("Unsupported 3D format"):(o.updateWindowPanesTransparency(r),o.updateDeformableModelHierarchy(r),o.replaceMultipleSharedShapes(r),r.setUserData(e),i.modelLoaded(r))},modelError:function(e){i.modelError(e)},progression:function(e,t,n){i.progression(e,t,n)}};o.modelLoaders[0].load(n,t,r)},ModelManager.prototype.updateWindowPanesTransparency=function(e){if(e instanceof Group3D)for(var t=0;t<e.children.length;t++)this.updateWindowPanesTransparency(e.children[t]);else if(e instanceof Link3D)this.updateWindowPanesTransparency(e.getSharedGroup());else if(e instanceof Shape3D){var i=e.getName();if(i&&0===i.indexOf(ModelManager.WINDOW_PANE_SHAPE_PREFIX)){var n=e.getAppearance();null===n&&(n=new Appearance3D,e.setAppearance(n)),void 0===n.getTransparency()&&n.setTransparency(.5)}}},ModelManager.prototype.updateDeformableModelHierarchy=function(e){if(this.containsNode(e,ModelManager.MANNEQUIN_ABDOMEN_PREFIX)&&this.containsNode(e,ModelManager.MANNEQUIN_CHEST_PREFIX)&&this.containsNode(e,ModelManager.MANNEQUIN_PELVIS_PREFIX)&&this.containsNode(e,ModelManager.MANNEQUIN_NECK_PREFIX)&&this.containsNode(e,ModelManager.MANNEQUIN_HEAD_PREFIX)&&this.containsNode(e,ModelManager.MANNEQUIN_LEFT_SHOULDER_PREFIX)&&this.containsNode(e,ModelManager.MANNEQUIN_LEFT_ARM_PREFIX)&&this.containsNode(e,ModelManager.MANNEQUIN_LEFT_ELBOW_PREFIX)&&this.containsNode(e,ModelManager.MANNEQUIN_LEFT_FOREARM_PREFIX)&&this.containsNode(e,ModelManager.MANNEQUIN_LEFT_WRIST_PREFIX)&&this.containsNode(e,ModelManager.MANNEQUIN_LEFT_HAND_PREFIX)&&this.containsNode(e,ModelManager.MANNEQUIN_LEFT_HIP_PREFIX)&&this.containsNode(e,ModelManager.MANNEQUIN_LEFT_THIGH_PREFIX)&&this.containsNode(e,ModelManager.MANNEQUIN_LEFT_KNEE_PREFIX)&&this.containsNode(e,ModelManager.MANNEQUIN_LEFT_LEG_PREFIX)&&this.containsNode(e,ModelManager.MANNEQUIN_LEFT_ANKLE_PREFIX)&&this.containsNode(e,ModelManager.MANNEQUIN_LEFT_FOOT_PREFIX)&&this.containsNode(e,ModelManager.MANNEQUIN_RIGHT_SHOULDER_PREFIX)&&this.containsNode(e,ModelManager.MANNEQUIN_RIGHT_ARM_PREFIX)&&this.containsNode(e,ModelManager.MANNEQUIN_RIGHT_ELBOW_PREFIX)&&this.containsNode(e,ModelManager.MANNEQUIN_RIGHT_FOREARM_PREFIX)&&this.containsNode(e,ModelManager.MANNEQUIN_RIGHT_WRIST_PREFIX)&&this.containsNode(e,ModelManager.MANNEQUIN_RIGHT_HAND_PREFIX)&&this.containsNode(e,ModelManager.MANNEQUIN_RIGHT_HIP_PREFIX)&&this.containsNode(e,ModelManager.MANNEQUIN_RIGHT_THIGH_PREFIX)&&this.containsNode(e,ModelManager.MANNEQUIN_RIGHT_KNEE_PREFIX)&&this.containsNode(e,ModelManager.MANNEQUIN_RIGHT_LEG_PREFIX)&&this.containsNode(e,ModelManager.MANNEQUIN_RIGHT_ANKLE_PREFIX)&&this.containsNode(e,ModelManager.MANNEQUIN_RIGHT_FOOT_PREFIX)){var t=this.extractNodes(e,ModelManager.MANNEQUIN_HEAD_PREFIX,null),i=this.createPickableTransformGroup(ModelManager.MANNEQUIN_NECK_PREFIX,[t]),n=this.extractNodes(e,ModelManager.MANNEQUIN_LEFT_HAND_PREFIX,null),o=this.createPickableTransformGroup(ModelManager.MANNEQUIN_LEFT_WRIST_PREFIX,[n]),r=this.extractNodes(e,ModelManager.MANNEQUIN_LEFT_FOREARM_PREFIX,null),l=this.extractNodes(e,ModelManager.MANNEQUIN_LEFT_WRIST_PREFIX,null),a=this.createPickableTransformGroup(ModelManager.MANNEQUIN_LEFT_ELBOW_PREFIX,[r,l,o]),s=this.extractNodes(e,ModelManager.MANNEQUIN_LEFT_ARM_PREFIX,null),h=this.extractNodes(e,ModelManager.MANNEQUIN_LEFT_ELBOW_PREFIX,null),u=this.createPickableTransformGroup(ModelManager.MANNEQUIN_LEFT_SHOULDER_PREFIX,[s,h,a]),d=this.extractNodes(e,ModelManager.MANNEQUIN_RIGHT_HAND_PREFIX,null),c=this.createPickableTransformGroup(ModelManager.MANNEQUIN_RIGHT_WRIST_PREFIX,[d]),p=this.extractNodes(e,ModelManager.MANNEQUIN_RIGHT_FOREARM_PREFIX,null),g=this.extractNodes(e,ModelManager.MANNEQUIN_RIGHT_WRIST_PREFIX,null),m=this.createPickableTransformGroup(ModelManager.MANNEQUIN_RIGHT_ELBOW_PREFIX,[p,g,c]),f=this.extractNodes(e,ModelManager.MANNEQUIN_RIGHT_ARM_PREFIX,null),v=this.extractNodes(e,ModelManager.MANNEQUIN_RIGHT_ELBOW_PREFIX,null),_=this.createPickableTransformGroup(ModelManager.MANNEQUIN_RIGHT_SHOULDER_PREFIX,[f,v,m]),S=this.extractNodes(e,ModelManager.MANNEQUIN_CHEST_PREFIX,null),y=this.extractNodes(e,ModelManager.MANNEQUIN_LEFT_SHOULDER_PREFIX,null),E=this.extractNodes(e,ModelManager.MANNEQUIN_RIGHT_SHOULDER_PREFIX,null),C=this.extractNodes(e,ModelManager.MANNEQUIN_NECK_PREFIX,null),P=this.createPickableTransformGroup(ModelManager.MANNEQUIN_ABDOMEN_CHEST_PREFIX,[S,y,u,E,_,C,i]),w=this.extractNodes(e,ModelManager.MANNEQUIN_LEFT_FOOT_PREFIX,null),L=this.createPickableTransformGroup(ModelManager.MANNEQUIN_LEFT_ANKLE_PREFIX,[w]),T=this.extractNodes(e,ModelManager.MANNEQUIN_LEFT_LEG_PREFIX,null),A=this.extractNodes(e,ModelManager.MANNEQUIN_LEFT_ANKLE_PREFIX,null),I=this.createPickableTransformGroup(ModelManager.MANNEQUIN_LEFT_KNEE_PREFIX,[T,A,L]),b=this.extractNodes(e,ModelManager.MANNEQUIN_LEFT_THIGH_PREFIX,null),O=this.extractNodes(e,ModelManager.MANNEQUIN_LEFT_KNEE_PREFIX,null),M=this.createPickableTransformGroup(ModelManager.MANNEQUIN_LEFT_HIP_PREFIX,[b,O,I]),D=this.extractNodes(e,ModelManager.MANNEQUIN_RIGHT_FOOT_PREFIX,null),R=this.createPickableTransformGroup(ModelManager.MANNEQUIN_RIGHT_ANKLE_PREFIX,[D]),F=this.extractNodes(e,ModelManager.MANNEQUIN_RIGHT_LEG_PREFIX,null),x=this.extractNodes(e,ModelManager.MANNEQUIN_RIGHT_ANKLE_PREFIX,null),N=this.createPickableTransformGroup(ModelManager.MANNEQUIN_RIGHT_KNEE_PREFIX,[F,x,R]),k=this.extractNodes(e,ModelManager.MANNEQUIN_RIGHT_THIGH_PREFIX,null),H=this.extractNodes(e,ModelManager.MANNEQUIN_RIGHT_KNEE_PREFIX,null),V=this.createPickableTransformGroup(ModelManager.MANNEQUIN_RIGHT_HIP_PREFIX,[k,H,N]),U=this.extractNodes(e,ModelManager.MANNEQUIN_PELVIS_PREFIX,null),W=this.extractNodes(e,ModelManager.MANNEQUIN_LEFT_HIP_PREFIX,null),B=this.extractNodes(e,ModelManager.MANNEQUIN_RIGHT_HIP_PREFIX,null),G=this.createPickableTransformGroup(ModelManager.MANNEQUIN_ABDOMEN_PELVIS_PREFIX,[U,W,M,B,V]),Y=this.extractNodes(e,ModelManager.MANNEQUIN_ABDOMEN_PREFIX,null);e.addChild(Y),e.addChild(P),e.addChild(G)}else{this.updateSimpleDeformableModelHierarchy(e,null,ModelManager.HINGE_PREFIX,ModelManager.OPENING_ON_HINGE_PREFIX,ModelManager.WINDOW_PANE_ON_HINGE_PREFIX,ModelManager.MIRROR_ON_HINGE_PREFIX),this.updateSimpleDeformableModelHierarchy(e,null,ModelManager.BALL_PREFIX,ModelManager.ARM_ON_BALL_PREFIX,null,null),this.updateSimpleDeformableModelHierarchy(e,ModelManager.UNIQUE_RAIL_PREFIX,ModelManager.RAIL_PREFIX,ModelManager.OPENING_ON_RAIL_PREFIX,ModelManager.WINDOW_PANE_ON_RAIL_PREFIX,ModelManager.MIRROR_ON_RAIL_PREFIX);for(var $=[];this.updateDeformableModelSubTransformedHierarchy(e,e,[ModelManager.HINGE_PREFIX,ModelManager.BALL_PREFIX,ModelManager.RAIL_PREFIX],[ModelManager.OPENING_ON_HINGE_PREFIX,ModelManager.ARM_ON_BALL_PREFIX,ModelManager.OPENING_ON_RAIL_PREFIX],$););}},ModelManager.prototype.updateSimpleDeformableModelHierarchy=function(e,t,i,n,o,r){if(this.containsNode(e,n+1)||null!==o&&this.containsNode(e,o+1)||null!==r&&this.containsNode(e,r+1))if(this.containsNode(e,i+1)){var l=1;do{var a=this.extractNodes(e,i+l,null),s=this.extractNodes(e,n+l,null),h=null!==o?this.extractNodes(e,o+l,null):null,u=null!==r?this.extractNodes(e,r+l,null):null,d=this.createPickableTransformGroup(i+l,[s,h,u]);e.addChild(a),e.addChild(d),l++}while(this.containsNode(e,i+l)&&(this.containsNode(e,n+l)||null!==o&&this.containsNode(e,o+l)||null!==r&&this.containsNode(e,r+l)))}else if(null!==t&&this.containsNode(e,t)){a=this.extractNodes(e,t,null);e.addChild(a);l=1;do{s=this.extractNodes(e,n+l,null),h=this.extractNodes(e,o+l,null),u=this.extractNodes(e,r+l,null);e.addChild(this.createPickableTransformGroup(i+l,[s,h,u])),l++}while(this.containsNode(e,n+l)||this.containsNode(e,o+l)||this.containsNode(e,r+l))}},ModelManager.prototype.containsNode=function(e,t){var i=e.getName();if(null!==i&&0===i.indexOf(t))return!0;if(e instanceof Group3D)for(var n=e.getChildren().length-1;n>=0;n--)if(this.containsNode(e.getChild(n),t))return!0;return!1},ModelManager.prototype.extractNodes=function(e,t,i){if(null!==e.getName()&&0===e.getName().indexOf(t)&&(e.getParent().removeChild(e),null===i&&(i=new Group3D),i.addChild(e)),e instanceof Group3D)for(var n=e.getChildren().length-1;n>=0;n--)i=this.extractNodes(e.getChild(n),t,i);return i},ModelManager.prototype.createPickableTransformGroup=function(e,t){var i=new TransformGroup3D;i.setCapability(TransformGroup3D.ALLOW_TRANSFORM_WRITE),i.setName(e+ModelManager.DEFORMABLE_TRANSFORM_GROUP_SUFFIX);for(var n=0;n<t.length;n++)null!==t[n]&&i.addChild(t[n]);return i},ModelManager.prototype.updateDeformableModelSubTransformedHierarchy=function(e,t,i,n,o){if(e!==t&&o.indexOf(t)<0){var r=t.getName();if(null!==r)for(var l=0;l<i.length;l++){var a=i[l];if(0===r.indexOf(a)){var s=r.indexOf(ModelManager.SUB_TRANSFORMATION_SEPARATOR);if(s>0)for(var h=0;h<n.length;h++){var u=r.indexOf(n[h],s+ModelManager.SUB_TRANSFORMATION_SEPARATOR.length);if(u>=0){o.indexOf(t)<0&&o.push(t);var d=t.getParent(),c=d.getParent();if(null!==c){for(var p=c.getChildren().indexOf(d),g=c.getChild(++p);!(g instanceof TransformGroup3D);)g=c.getChild(++p);for(var m=u+n[h].length;m<r.length&&r.charAt(m)>="0"&&r.charAt(m)<="9";)m++;if(this.attachNodesToPickableTransformGroup(e,i[h]+r.substring(u+n[h].length,m),[d,g]))return!0}}}}}}if(t instanceof Group3D){var f=t.getChildren();for(l=f.length-1;l>=0;l--)if(this.updateDeformableModelSubTransformedHierarchy(e,f[l],i,n,o))return!0}return!1},ModelManager.prototype.attachNodesToPickableTransformGroup=function(e,t,i){if(e instanceof TransformGroup3D&&t+ModelManager.DEFORMABLE_TRANSFORM_GROUP_SUFFIX==e.getName()){for(var n=e,o=0;o<i.length;o++){var r=i[o];r.getParent().removeChild(r),n.addChild(r)}return!0}if(e instanceof Group3D){var l=e.getChildren();for(o=0;o<l.length;o++)if(this.attachNodesToPickableTransformGroup(l[o],t,i))return!0}return!1},ModelManager.prototype.containsDeformableNode=function(e){if(e instanceof TransformGroup3D&&null!==e.getName()&&e.getName().indexOf(ModelManager.DEFORMABLE_TRANSFORM_GROUP_SUFFIX)>=0&&e.getName().indexOf(ModelManager.DEFORMABLE_TRANSFORM_GROUP_SUFFIX)===e.getName().length-ModelManager.DEFORMABLE_TRANSFORM_GROUP_SUFFIX.length)return!0;if(e instanceof Group3D)for(var t=e.getChildren(),i=0;i<t.length;i++)if(this.containsDeformableNode(t[i]))return!0;return!1},ModelManager.prototype.isDeformed=function(e){if(e instanceof TransformGroup3D&&null!==e.getName()&&e.getName().indexOf(ModelManager.DEFORMABLE_TRANSFORM_GROUP_SUFFIX)>=0&&e.getName().indexOf(ModelManager.DEFORMABLE_TRANSFORM_GROUP_SUFFIX)===e.getName().length-ModelManager.DEFORMABLE_TRANSFORM_GROUP_SUFFIX.length){var t=mat4.create();return e.getTransform(t),!TransformGroup3D.isIdentity(t)}if(e instanceof Group3D)for(var i=e.getChildren(),n=0;n<i.length;n++)if(this.isDeformed(i[n]))return!0;return!1},ModelManager.prototype.getMaterials=function(e,t,i){void 0===i&&(void 0===t?(t=!1,i=null):i=t);var n=[];this.searchAppearances(e,t,n);for(var o=[],r=0;r<n.length;r++){var l=n[r],a=null,s=null,h=l.getDiffuseColor();null!=h&&(a=4278190080|Math.round(255*h[0])<<16|Math.round(255*h[1])<<8|Math.round(255*h[2]),s=null!=l.getShininess()?l.getShininess()/128:null);var u=l.getTextureImage(),d=null;if(null!=u){var c=u.url;if(null!=c){var p=new SimpleURLContent(c),g=c.substring(c.lastIndexOf("/")+1),m=g.lastIndexOf(".");-1!==m&&(g=g.substring(0,m)),d=new HomeTexture(new CatalogTexture(null,g,p,-1,-1,i))}}var f=l.getName();void 0===f&&(f=null);for(var v=new HomeMaterial(f,a,d,s),_=0;_<o.length;_++)if(o[_].getName()==v.getName()){v=null;break}null!=v&&o.push(v)}return o.sort((function(e,t){var i=e.getName(),n=t.getName();return null!=i?null!=n?i.localeCompare(n):1:null!=n?-1:0})),o},ModelManager.prototype.searchAppearances=function(e,t,i){if(e instanceof Group3D)for(var n=e.getChildren(),o=0;o<n.length;o++)this.searchAppearances(n[o],t,i);else if(e instanceof Link3D)this.searchAppearances(e.getSharedGroup(),t,i);else if(e instanceof Shape3D){var r=e.getAppearance();null===r||t&&0===r.getName().indexOf(ModelManager.EDGE_COLOR_MATERIAL_PREFIX)||-1!==i.indexOf(r)||i.push(r)}},ModelManager.prototype.replaceMultipleSharedShapes=function(e){var t=[];this.searchSharedShapes(e,t,!1);for(var i=0;i<t.length;i++)if(t[i].value>1){var n=[],o=t[i].key;this.searchShapeTransformations(e,o,n,mat4.create());for(var r=o.clone(),l=r.getGeometries(),a=0;a<l.length;a++){var s=this.getTransformedGeometry(l[a],n);if(null===s)return;r.setGeometry(s,a)}this.removeSharedShape(e,o),e.addChild(r)}},ModelManager.prototype.searchSharedShapes=function(e,t,i){if(e instanceof Group3D)for(var n=e.getChildren(),o=0;o<n.length;o++)this.searchSharedShapes(n[o],t,i);else if(e instanceof Link3D)this.searchSharedShapes(e.getSharedGroup(),t,!0);else if(e instanceof Shape3D&&i){for(o=0;o<t.length;o++)if(t[o].key===e)return void t[o].value++;t.push({key:e,value:1})}},ModelManager.prototype.searchShapeTransformations=function(e,t,i,n){if(e instanceof Group3D){if(!(e instanceof TransformGroup3D&&this.isDeformed(e))){if(e instanceof TransformGroup3D){n=mat4.clone(n);var o=mat4.create();e.getTransform(o),mat4.mul(n,n,o)}for(var r=e.getChildren(),l=0;l<r.length;l++)this.searchShapeTransformations(r[l],t,i,n)}}else e instanceof Link3D?this.searchShapeTransformations(e.getSharedGroup(),t,i,n):e===t&&i.push(n)},ModelManager.prototype.getTransformedGeometry=function(e,t){for(var i=0,n=0,o=new Array(t.length*e.vertexIndices.length),r=0;r<t.length;r++){for(var l=0,a=e.vertexIndices.length;l<a;l++)o[i+l]=n+e.vertexIndices[l];i+=e.vertexIndices.length,n+=e.vertices.length}var s=new Array(t.length*e.textureCoordinateIndices.length);i=0;for(r=0;r<t.length;r++){for(l=0,a=e.textureCoordinateIndices.length;l<a;l++)s[i+l]=e.textureCoordinateIndices[l];i+=e.textureCoordinateIndices.length}n=0;var h=new Array(t.length*e.vertices.length);for(r=0;r<t.length;r++){for(l=0,a=e.vertices.length;l<a;l++){var u=vec3.clone(e.vertices[l]);vec3.transformMat4(u,u,t[r]),h[n+l]=u}n+=e.vertices.length}if(e instanceof IndexedLineArray3D)return new IndexedLineArray3D(h,o,e.textureCoordinates,s);if(e instanceof IndexedTriangleArray3D){var d=new Array(t.length*e.normalIndices.length);i=0;var c=0;for(r=0;r<t.length;r++){for(l=0,a=e.normalIndices.length;l<a;l++)d[i+l]=c+e.normalIndices[l];i+=e.normalIndices.length,c+=e.normals.length}c=0;var p=new Array(t.length*e.normals.length);for(r=0;r<t.length;r++){for(l=0,a=e.normals.length;l<a;l++){var g=vec3.clone(e.normals[l]);vec3.transformMat4(g,g,t[r]),vec3.normalize(g,g),p[c+l]=g}c+=e.normals.length}return new IndexedTriangleArray3D(h,o,e.textureCoordinates,s,p,d)}return null},ModelManager.prototype.removeSharedShape=function(e,t){if(e instanceof Group3D){if(!(e instanceof TransformGroup3D&&this.isDeformed(e))){for(var i=e.getChildren(),n=i.length-1;n>=0;n--)this.removeSharedShape(i[n],t);0===i.length&&e.getParent()instanceof Group3D&&e.getParent().removeChild(e)}}else if(e instanceof Link3D){var o=e.getSharedGroup();this.removeSharedShape(o,t),0==o.children.length&&e.getParent().removeChild(e)}else e===t&&e.getParent().removeChild(e)},ModelManager.prototype.getFrontArea=function(e,t){var i;if(null!==e)(i=new java.awt.geom.Area(this.getShape(e))).transform(java.awt.geom.AffineTransform.getScaleInstance(1,-1)),i.transform(java.awt.geom.AffineTransform.getTranslateInstance(-.5,.5));else if(this.getVertexCount(t)<1e6){var n=new java.awt.geom.Area;this.computeBottomOrFrontArea(t,n,mat4.create(),!1,!1),i=new java.awt.geom.Area;for(var o=[],r=null,l=n.getPathIterator(null,1);!l.isDone();l.next()){var a=[0,0];switch(l.currentSegment(a)){case java.awt.geom.PathIterator.SEG_MOVETO:case java.awt.geom.PathIterator.SEG_LINETO:null!==r&&a[0]===r[0]&&a[1]===r[1]||o.push(a),r=a;break;case java.awt.geom.PathIterator.SEG_CLOSE:if(o[0][0]===r[0]&&o[0][1]===r[1]&&o.splice(o.length-1,1),o.length>2){var s=o.slice(0),h=new Room(s);if(h.getArea()>0&&!h.isClockwise()){var u=new java.awt.geom.GeneralPath;u.moveTo(s[0][0],s[0][1]);for(var d=1;d<s.length;d++)u.lineTo(s[d][0],s[d][1]);u.closePath(),i.add(new java.awt.geom.Area(u))}}o.length=0,r=null}}var c=n.getBounds2D();i.transform(java.awt.geom.AffineTransform.getTranslateInstance(-c.getCenterX(),-c.getCenterY())),i.transform(java.awt.geom.AffineTransform.getScaleInstance(1/c.getWidth(),1/c.getHeight()))}else i=new java.awt.geom.Area(new java.awt.geom.Rectangle2D.Float(-.5,-.5,1,1));return i},ModelManager.prototype.getAreaOnFloor=function(e){if(e instanceof Node3D){var t;if(this.getVertexCount(e)<1e4)t=new java.awt.geom.Area,this.computeBottomOrFrontArea(e,t,mat4.create(),!0,!0);else{var i=[];if(this.computeVerticesOnFloor(e,i,mat4.create()),i.length>0){var n=this.getSurroundingPolygon(i.slice(0)),o=new java.awt.geom.GeneralPath(java.awt.geom.Path2D.WIND_NON_ZERO,n.length);o.moveTo(n[0][0],n[0][1]);for(var r=0;r<n.length;r++)o.lineTo(n[r][0],n[r][1]);o.closePath(),t=new java.awt.geom.Area(o)}else t=new java.awt.geom.Area}return t}var l=e;if(null===l.getStaircaseCutOutShape())throw new IllegalArgumentException("No cut out shape associated to piece");var a=this.getShape(l.getStaircaseCutOutShape()),s=new java.awt.geom.Area(a);l.isModelMirrored()&&(s=this.getMirroredArea(s));var h=java.awt.geom.AffineTransform.getTranslateInstance(l.getX()-l.getWidth()/2,l.getY()-l.getDepth()/2);return h.concatenate(java.awt.geom.AffineTransform.getRotateInstance(l.getAngle(),l.getWidth()/2,l.getDepth()/2)),h.concatenate(java.awt.geom.AffineTransform.getScaleInstance(l.getWidth(),l.getDepth())),s.transform(h),s},ModelManager.prototype.getVertexCount=function(e){var t=0;if(e instanceof Group3D)for(var i=e.getChildren(),n=0;n<i.length;n++)t+=this.getVertexCount(i[n]);else if(e instanceof Link3D)t=this.getVertexCount(e.getSharedGroup());else if(e instanceof Shape3D&&e.getAppearance().isVisible())for(var o=e.getGeometries(),r=(n=0,o.length);n<r;n++){t+=o[n].vertices.length}return t},ModelManager.prototype.computeBottomOrFrontArea=function(e,t,i,n,o){if(e instanceof Group3D){if(e instanceof TransformGroup3D){i=mat4.clone(i);var r=mat4.create();e.getTransform(r),mat4.mul(i,i,r)}for(var l=e.getChildren(),a=0;a<l.length;a++)this.computeBottomOrFrontArea(l[a],t,i,n,o)}else if(e instanceof Link3D)this.computeBottomOrFrontArea(e.getSharedGroup(),t,i,n,o);else if(e instanceof Shape3D){var s=e.getAppearance();if(s.isVisible()&&(!n||void 0===s.getTransparency()||s.getTransparency()<1))for(var h=e.getGeometries(),u=(a=0,h.length);a<u;a++){var d=h[a];this.computeBottomOrFrontGeometryArea(d,t,i,o)}}},ModelManager.prototype.computeBottomOrFrontGeometryArea=function(e,t,i,n){if(e instanceof IndexedTriangleArray3D){for(var o=e.vertices.length,r=new Array(2*o),l=vec3.create(),a=0,s=0;a<r.length;s++)vec3.copy(l,e.vertices[s]),vec3.transformMat4(l,l,i),r[a++]=l[0],r[a++]=n?l[2]:l[1];geometryPath=new java.awt.geom.GeneralPath(java.awt.geom.Path2D.WIND_NON_ZERO,1e3);s=0;for(var h=0,u=e.vertexIndices.length;s<u;s+=3)this.addTriangleToPath(e,e.vertexIndices[s],e.vertexIndices[s+1],e.vertexIndices[s+2],r,geometryPath,h++,t);t.add(new java.awt.geom.Area(geometryPath))}},ModelManager.prototype.addTriangleToPath=function(e,t,i,n,o,r,l,a){var s=o[2*t],h=o[2*t+1],u=o[2*i],d=o[2*i+1],c=o[2*n],p=o[2*n+1];(u-s)*(p-d)-(d-h)*(c-u)>0&&(l>0&&l%1e3==0&&(a.add(new java.awt.geom.Area(r)),r.reset()),r.moveTo(s,h),r.lineTo(u,d),r.lineTo(c,p),r.closePath())},ModelManager.prototype.computeVerticesOnFloor=function(e,t,i){if(e instanceof Group3D){if(e instanceof TransformGroup3D){i=mat4.clone(i);var n=mat4.create();e.getTransform(n),mat4.mul(i,i,n)}for(var o=e.getChildren(),r=0;r<o.length;r++)this.computeVerticesOnFloor(o[r],t,i)}else if(e instanceof Link3D)this.computeVerticesOnFloor(e.getSharedGroup(),t,i);else if(e instanceof Shape3D){var l=e.getAppearance();if(l.isVisible()&&(void 0===l.getTransparency()||l.getTransparency()<1))for(var a=e.getGeometries(),s=(r=0,a.length);r<s;r++)for(var h=a[r],u=h.vertices.length,d=vec3.create(),c=0,p=0;c<u;p++,c++)vec3.copy(d,h.vertices[p]),vec3.transformMat4(d,d,i),t.push([d[0],d[2]])}},ModelManager.prototype.getSurroundingPolygon=function(e){e.sort((function(e,t){var i;return(i=e[0]===t[0]?t[1]-e[1]:t[0]-e[0])>0?1:i<0?-1:0}));var t,i,n,o,r=new Array(e.length),l=-1,a=e[0][0];for(i=1;i<e.length&&e[i][0]===a;i++);if((n=i-1)===e.length-1){r[++l]=e[0],e[n][1]!==e[0][1]&&(r[++l]=e[n]),r[++l]=e[0];var s=new Array(l+1);return System.arraycopy(r,0,s,0,s.length),s}var h=e.length-1,u=e[e.length-1][0];for(i=e.length-2;i>=0&&e[i][0]===u;i--);for(o=i+1,r[++l]=e[0],i=n;++i<=o;)if(!(this.isLeft(e[0],e[o],e[i])>=0&&i<o)){for(;l>0&&!(this.isLeft(r[l-1],r[l],e[i])>0);)l--;r[++l]=e[i]}for(h!==o&&(r[++l]=e[h]),t=l,i=o;--i>=n;)if(!(this.isLeft(e[h],e[n],e[i])>=0&&i>n)){for(;l>t&&!(this.isLeft(r[l-1],r[l],e[i])>0);)l--;r[++l]=e[i]}0!==n&&(r[++l]=e[0]);s=new Array(l+1);return System.arraycopy(r,0,s,0,s.length),s},ModelManager.prototype.isLeft=function(e,t,i){return(t[0]-e[0])*(i[1]-e[1])-(i[0]-e[0])*(t[1]-e[1])},ModelManager.prototype.getMirroredArea=function(e){for(var t=new java.awt.geom.GeneralPath,i=[0,0,0,0,0,0],n=e.getPathIterator(null);!n.isDone();n.next())switch(n.currentSegment(i)){case java.awt.geom.PathIterator.SEG_MOVETO:t.moveTo(1-i[0],i[1]);break;case java.awt.geom.PathIterator.SEG_LINETO:t.lineTo(1-i[0],i[1]);break;case java.awt.geom.PathIterator.SEG_QUADTO:t.quadTo(1-i[0],i[1],1-i[2],i[3]);break;case java.awt.geom.PathIterator.SEG_CUBICTO:t.curveTo(1-i[0],i[1],1-i[2],i[3],1-i[4],i[5]);break;case java.awt.geom.PathIterator.SEG_CLOSE:t.closePath()}return new java.awt.geom.Area(t)},ModelManager.prototype.getShape=function(e){return ShapeTools.getShape(e)},ModelPreviewComponent.prototype.getHTMLElement=function(){return this.canvas3D.getHTMLElement()},ModelPreviewComponent.prototype.setDefaultTransform=function(){this.viewYaw=Math.PI/8,this.viewPitch=-Math.PI/16,this.viewScale=1,this.updateViewPlatformTransform()},ModelPreviewComponent.prototype.getViewYaw=function(){return this.viewYaw},ModelPreviewComponent.prototype.setViewYaw=function(e){this.viewYaw=e,this.updateViewPlatformTransform()},ModelPreviewComponent.prototype.getViewScale=function(){return this.viewScale},ModelPreviewComponent.prototype.setViewScale=function(e){this.viewScale=e,this.updateViewPlatformTransform()},ModelPreviewComponent.prototype.getViewPitch=function(){return this.viewPitch},ModelPreviewComponent.prototype.setViewPitch=function(e){this.viewPitch=e,this.updateViewPlatformTransform()},ModelPreviewComponent.prototype.updateViewPlatformTransform=function(){var e=1.4/Math.tan(Math.PI/8),t=mat4.create();mat4.translate(t,t,vec3.fromValues(0,0,e));var i=mat4.create();mat4.rotateX(i,i,this.viewPitch);var n=mat4.create();mat4.rotateY(n,n,this.viewYaw);var o=mat4.create();mat4.scale(o,o,vec3.fromValues(this.viewScale,this.viewScale,this.viewScale)),mat4.mul(i,i,t),mat4.mul(n,n,i),mat4.mul(o,o,n),this.canvas3D.setViewPlatformTransform(o)},ModelPreviewComponent.prototype.setModel=function(e,t,i,n,o,r,l,a){if(void 0===o&&void 0===r&&void 0===l&&void 0===a&&(a=n,l=i,i=t,t=0,n=-1,o=-1,r=-1),this.model=e,this.canvas3D.clear(),void 0!==HomePieceOfFurniture&&(this.previewedPiece=null),null!==e){var s=this;ModelManager.getInstance().loadModel(e,{modelUpdated:function(l){if(e===s.model){var h,u=ModelManager.getInstance(),d=n<0?u.getSize(l):vec3.fromValues(n,r,o),c=1.8/Math.max(Math.max(d[0],d[2]),d[1]);if(void 0!==HomePieceOfFurniture){"boolean"==typeof t&&(t=t?PieceOfFurniture.SHOW_BACK_FACE:0),s.previewedPiece=new HomePieceOfFurniture(new CatalogPieceOfFurniture(null,null,e,d[0],d[2],d[1],0,!1,null,null,i,t,null,null,0,0,1,!1)),s.previewedPiece.setX(0),s.previewedPiece.setY(0),s.previewedPiece.setElevation(-s.previewedPiece.getHeight()/2);var p=mat4.create();mat4.scale(p,p,vec3.fromValues(c,c,c)),h=new TransformGroup3D(p);var g=new HomePieceOfFurniture3D(s.previewedPiece,null,!0);h.addChild(g)}else{p=i?u.getRotationTransformation(i):mat4.create();mat4.scale(p,p,vec3.fromValues(c,c,c)),mat4.scale(p,p,d),mat4.mul(p,p,u.getNormalizedTransform(l,null,1)),(h=new TransformGroup3D(p)).addChild(l)}var m=new BranchGroup3D;m.addChild(h),m.addChild(new DirectionalLight3D(vec3.fromValues(.9,.9,.9),vec3.fromValues(1.732,-.8,-1))),m.addChild(new DirectionalLight3D(vec3.fromValues(.9,.9,.9),vec3.fromValues(-1.732,-.8,-1))),m.addChild(new DirectionalLight3D(vec3.fromValues(.9,.9,.9),vec3.fromValues(0,-.8,1))),m.addChild(new DirectionalLight3D(vec3.fromValues(.66,.66,.66),vec3.fromValues(0,1,0))),m.addChild(new AmbientLight3D(vec3.fromValues(.2,.2,.2))),s.setDefaultTransform(),s.canvas3D.setScene(m,a),s.canvas3D.updateViewportSize()}},modelError:function(t){e===s.model&&void 0!==l&&l(t)},progression:function(t,i,n){e===s.model&&void 0!==a&&a(t,i,n)}})}},ModelPreviewComponent.prototype.getModelNode=function(){var e=this.canvas3D.getScene().getChild(0);return e.getChildren().length>0?e.getChild(0):null},ModelPreviewComponent.prototype.setModelMaterials=function(e){null!=this.previewedPiece&&(this.previewedPiece.setModelMaterials(e),this.getModelNode().update())},ModelPreviewComponent.prototype.setModelTransformations=function(e){null!=this.previewedPiece&&(this.previewedPiece.setModelTransformations(e),this.getModelNode().update())},ModelPreviewComponent.prototype.setPresetModelTransformations=function(e){if(null!=this.previewedPiece){var t=ModelManager.getInstance(),i=t.getBounds(this.getModelNode()),n=vec3.create();i.getLower(n);var o=vec3.create();i.getUpper(o),this.setNodeTransformations(this.getModelNode(),e);var r=t.getBounds(this.getModelNode()),l=vec3.create();r.getLower(l);var a=vec3.create();r.getUpper(a),this.previewedPiece.setX(this.previewedPiece.getX()+(a[0]+l[0])/2-(o[0]+n[0])/2),this.previewedPiece.setY(this.previewedPiece.getY()+(a[2]+l[2])/2-(o[2]+n[2])/2),this.previewedPiece.setElevation(this.previewedPiece.getElevation()+(l[1]-n[1])),this.previewedPiece.setWidth(a[0]-l[0]),this.previewedPiece.setDepth(a[2]-l[2]),this.previewedPiece.setHeight(a[1]-l[1]),this.previewedPiece.setModelTransformations(e)}},ModelPreviewComponent.prototype.resetModelTransformations=function(){this.setPresetModelTransformations(null)},ModelPreviewComponent.prototype.setNodeTransformations=function(e,t){if(e instanceof Group3D){if(e instanceof TransformGroup3D&&null!==e.getName()&&e.getName().lastIndexOf(ModelManager.DEFORMABLE_TRANSFORM_GROUP_SUFFIX)===e.getName().length-ModelManager.DEFORMABLE_TRANSFORM_GROUP_SUFFIX.length&&(e.setTransform(mat4.create()),null!=t)){var i=e.getName();i=i.substring(0,i.length-ModelManager.DEFORMABLE_TRANSFORM_GROUP_SUFFIX.length);for(var n=0;n<t.length;n++){var o=t[n];if(i==o.getName()){var r=o.getMatrix(),l=mat4.create();mat4.set(l,r[0][0],r[1][0],r[2][0],0,r[0][1],r[1][1],r[2][1],0,r[0][2],r[1][2],r[2][2],0,r[0][3],r[1][3],r[2][3],1),e.setTransform(l)}}}var a=e.getChildren();for(n=0;n<a.length;n++)this.setNodeTransformations(a[n],t)}},ModelPreviewComponent.prototype.getModelTransformations=function(){return null!=this.previewedPiece?this.previewedPiece.getModelTransformations():null},ModelPreviewComponent.prototype.getModelX=function(){return this.previewedPiece.getX()},ModelPreviewComponent.prototype.getModelY=function(){return this.previewedPiece.getY()},ModelPreviewComponent.prototype.getModelElevation=function(){return this.previewedPiece.getElevation()},ModelPreviewComponent.prototype.getModelWidth=function(){return this.previewedPiece.getWidth()},ModelPreviewComponent.prototype.getModelDepth=function(){return this.previewedPiece.getDepth()},ModelPreviewComponent.prototype.getModelHeight=function(){return this.previewedPiece.getHeight()},ModelPreviewComponent.prototype.getPickedMaterial=function(){return this.pickedMaterial},ModelPreviewComponent.prototype.clear=function(){this.stopRotationAnimation(),this.canvas3D.clear()},ModelPreviewComponent.prototype.dispose=function(){OperatingSystem.isInternetExplorerOrLegacyEdge()&&window.PointerEvent?(window.removeEventListener("pointermove",this.userActionsListener.windowPointerMoved),window.removeEventListener("pointerup",this.userActionsListener.windowPointerReleased)):(window.removeEventListener("mousemove",this.userActionsListener.windowMouseMoved),window.removeEventListener("mouseup",this.userActionsListener.windowMouseReleased)),document.removeEventListener("visibilitychange",this.userActionsListener.visibilityChanged),this.clear()},ModelPreviewComponent.prototype.startRotationAnimation=function(e){this.roundsPerMinute=void 0!==e?e:5,this.rotationAnimationStarted||(this.rotationAnimationStarted=!0,this.animate())},ModelPreviewComponent.prototype.animate=function(){if(this.rotationAnimationStarted){var e=Date.now();if(void 0!==this.lastRotationAnimationTime){var t=2*this.roundsPerMinute*Math.PI/6e4;this.viewYaw+=(e-this.lastRotationAnimationTime)*t%(2*Math.PI),this.updateViewPlatformTransform()}this.lastRotationAnimationTime=e;var i=this;requestAnimationFrame((function(){i.animate()}))}},ModelPreviewComponent.prototype.stopRotationAnimation=function(){delete this.lastRotationAnimationTime,delete this.rotationAnimationStarted};var ShapeTools={parsedShapes:{}};function HomeComponent3D(e,t,i,n,o){this.home=t,this.preferences=i,this.object3dFactory=null!==n?n:new Object3DBranchFactory(i),this.homeObjects=[],this.homeObjects3D=[],this.sceneLights=[],this.camera=null,this.windowResizeListener=null,this.preferencesChangeListener=null,this.cameraChangeListener=null,this.homeCameraListener=null,this.groundChangeListener=null,this.backgroundChangeListener=null,this.lightColorListener=null,this.elevationChangeListener=null,this.wallsAlphaListener=null,this.selectionListener=null,this.levelListener=null,this.levelChangeListener=null,this.wallListener=null,this.wallChangeListener=null,this.furnitureListener=null,this.furnitureChangeListener=null,this.roomListener=null,this.roomChangeListener=null,this.polylineChangeListener=null,this.polylineListener=null,this.dimensionLineChangeListener=null,this.dimensionLineListener=null,this.labelChangeListener=null,this.labelListener=null,this.approximateHomeBoundsCache=null,this.homeHeightCache=null,this.createComponent3D(e,i,o)}function Object3DBranchFactory(e){void 0!==e&&(this.preferences=e)}function Object3DBranch(e,t,i){BranchGroup3D.call(this),void 0!==e&&(this.setUserData(e),this.home=t,this.userPreferences=i)}function HomePieceOfFurniture3D(e,t,i,n){void 0===n&&(n=i,i=null),Object3DBranch.call(this,e,t,i),this.createPieceOfFurnitureNode(e,n)}function Room3D(e,t,i,n,o){void 0===o&&(waitModelAndTextureLoadingEnd=n,n=i,i=null),Object3DBranch.call(this,e,t,i),void 0===n&&(n=!1,o=!1),this.addChild(this.createRoomPartShape()),this.addChild(this.createRoomPartShape());var r=new Shape3D;r.setAppearance(this.getSelectionAppearance()),r.setCapability(Shape3D.ALLOW_GEOMETRY_WRITE),r.setPickable(!1),this.addChild(r),this.updateRoomGeometry(),this.updateRoomAppearance(o),n&&this.removeChild(Room3D.CEILING_PART)}function Wall3D(e,t,i,n){void 0===n&&(n=i,i=null),Object3DBranch.call(this,e,t,i);for(var o=0;o<8;o++){var r=new Group3D;r.addChild(this.createWallPartShape()),this.addChild(r)}var l=new Shape3D;l.setAppearance(this.getSelectionAppearance()),l.setCapability(Shape3D.ALLOW_GEOMETRY_WRITE),l.setPickable(!1),this.addChild(l),this.updateWallGeometry(n),this.updateWallAppearance(n)}function Ground3D(e,t,i,n,o,r){Object3DBranch.call(this),this.setUserData(e),this.originX=t,this.originY=i,this.width=n,this.depth=o;var l=new Appearance3D,a=new Shape3D;a.setCapability(Shape3D.ALLOW_GEOMETRY_WRITE),a.setAppearance(l),this.addChild(a);var s=new Appearance3D;this.updateAppearanceMaterial(s,Object3DBranch.DEFAULT_COLOR,Object3DBranch.DEFAULT_COLOR,0),s.setCullFace(Appearance3D.CULL_NONE);var h=new TransformGroup3D;h.setCapability(TransformGroup3D.ALLOW_TRANSFORM_WRITE);var u=new Shape3D(new IndexedTriangleArray3D([vec3.fromValues(-.5,0,-.5),vec3.fromValues(-.5,0,.5),vec3.fromValues(.5,0,.5),vec3.fromValues(.5,0,-.5)],[0,1,2,0,2,3],[vec2.fromValues(0,0),vec2.fromValues(1,0),vec2.fromValues(1,1),vec2.fromValues(0,1)],[3,0,1,3,1,2],[vec3.fromValues(0,1,0)],[0,0,0,0,0,0]),s);h.addChild(u),this.addChild(h),this.update(r)}function Polyline3D(e,t,i,n){void 0===n&&(n=i,i=null),Object3DBranch.call(this,e,t,i),null===Polyline3D.ARROW&&(Polyline3D.ARROW=new java.awt.geom.GeneralPath,Polyline3D.ARROW.moveTo(-5,-2),Polyline3D.ARROW.lineTo(0,0),Polyline3D.ARROW.lineTo(-5,2)),this.setCapability(Group3D.ALLOW_CHILDREN_EXTEND),this.update()}function DimensionLine3D(e,t,i,n){Object3DBranch.call(this,e,t,i),this.dimensionLineRotations=null,this.cameraChangeListener=null,this.homeCameraListener=null,this.dimensionLinesListener=null,this.setCapability(Group3D.ALLOW_CHILDREN_EXTEND),this.update()}function Label3D(e,t,i,n){void 0===n&&(n=i,i=null),Object3DBranch.call(this,e,t,i),this.setCapability(Group3D.ALLOW_CHILDREN_EXTEND),this.update()}function TextureManager(){this.loadedTextureImages={},this.loadingTextureObservers={}}ShapeTools.getStroke=function(e,t,i,n,o){var r,l;switch(t){case Polyline.CapStyle.ROUND:r=java.awt.BasicStroke.CAP_ROUND;break;case Polyline.CapStyle.SQUARE:r=java.awt.BasicStroke.CAP_SQUARE;break;default:r=java.awt.BasicStroke.CAP_BUTT}switch(i){case Polyline.JoinStyle.ROUND:case Polyline.JoinStyle.CURVED:l=java.awt.BasicStroke.JOIN_ROUND;break;case Polyline.JoinStyle.BEVEL:l=java.awt.BasicStroke.JOIN_BEVEL;break;default:l=java.awt.BasicStroke.JOIN_MITER}var a=0;if(null!=n)if(Array.isArray(n)){n=n.slice(0);for(var s=0;s<n.length;s++)n[s]*=e,a+=n[s];a*=o}else n=void 0,a=void 0;return new java.awt.BasicStroke(e,r,l,10,n,a)},ShapeTools.getPolylineShape=function(e,t,i){if(t){for(var n=new java.awt.geom.GeneralPath,o=0,r=i?e.length:e.length-1;o<r;o++){var l=new java.awt.geom.CubicCurve2D.Float,a=e[0===o?e.length-1:o-1],s=e[o],h=e[o===e.length-1?0:o+1],u=[h[0]-a[0],h[1]-a[1]],d=e[(o+2)%e.length],c=[s[0]-d[0],s[1]-d[1]];l.setCurve(s[0],s[1],s[0]+(0!==o||i?u[0]/3.625:0),s[1]+(0!==o||i?u[1]/3.625:0),h[0]+(o!==e.length-2||i?c[0]/3.625:0),h[1]+(o!==e.length-2||i?c[1]/3.625:0),h[0],h[1]),n.append(l,!0)}return n}return ShapeTools.getShape(e,i,null)},ShapeTools.getShape=function(e,t,i){if(e instanceof Array){var n=new java.awt.geom.GeneralPath;n.moveTo(Math.fround(e[0][0]),Math.fround(e[0][1]));for(var o=1;o<e.length;o++)n.lineTo(Math.fround(e[o][0]),Math.fround(e[o][1]));return t&&n.closePath(),null!=i&&n.transform(i),n}var r=e,l=ShapeTools.parsedShapes[r];if(!l){l=new java.awt.geom.Rectangle2D.Float(0,0,1,1);try{var a=new org.apache.batik.parser.AWTPathProducer,s=new org.apache.batik.parser.PathParser;s.setPathHandler(a),s.parse(r),l=a.getShape()}catch(e){}ShapeTools.parsedShapes[r]=l}return l},HomeComponent3D.__interfaces=["com.eteks.sweethome3d.viewcontroller.View3D","com.eteks.sweethome3d.viewcontroller.View"],HomeComponent3D.LONG_TOUCH_DELAY=200,HomeComponent3D.LONG_TOUCH_DELAY_WHEN_DRAGGING=400,HomeComponent3D.LONG_TOUCH_DURATION_AFTER_DELAY=800,HomeComponent3D.DOUBLE_TOUCH_DELAY=500,HomeComponent3D.prototype.createComponent3D=function(e,t,i){this.canvas3D=new HTMLCanvas3D(e);var n=this;this.preferencesChangeListener=function(e){switch(e.getPropertyName()){case"DEFAULT_FONT_NAME":case"UNIT":n.updateObjects(n.home.getDimensionLines());break;case"EDITING_IN_3D_VIEW_ENABLED":n.updateObjectsAndFurnitureGroups(n.home.getSelectedItems());break;case"NAVIGATION_PANEL_VISIBLE":n.setNavigationPanelVisible(e.getNewValue())}},i&&(this.addMouseListeners(i,t,this.canvas3D),null!==t&&(this.navigationPanelId=this.createNavigationPanel(this.home,t,i),this.setNavigationPanelVisible(t.isNavigationPanelVisible()),t.addPropertyChangeListener("NAVIGATION_PANEL_VISIBLE",this.preferencesChangeListener),t.addPropertyChangeListener("EDITING_IN_3D_VIEW_ENABLED",this.preferencesChangeListener)),this.createActions(i),this.installKeyboardActions()),this.updateView(this.home.getCamera()),this.updateViewPlatformTransform(this.home.getCamera(),!1),this.addCameraListeners(),this.canvas3D.setScene(this.createSceneTree(!0,!1)),null!==t&&(t.addPropertyChangeListener("UNIT",this.preferencesChangeListener),t.addPropertyChangeListener("DEFAULT_FONT_NAME",this.preferencesChangeListener))},HomeComponent3D.prototype.getHTMLElement=function(){return this.canvas3D.getHTMLElement()},HomeComponent3D.prototype.disposeGeometries=function(){this.home.structure&&ModelManager.getInstance().unloadModel(this.home.structure,!0),ModelManager.getInstance().disposeGeometries(this.canvas3D.getScene())},HomeComponent3D.prototype.revalidate=function(){var e=this.canvas3D.getHTMLElement().getBoundingClientRect();null!=this.navigationPanelId&&(navigationPanelDiv=document.getElementById(this.navigationPanelId),void 0!==navigationPanelDiv&&void 0!==navigationPanelDiv.style&&(navigationPanelDiv.style.left=e.left+window.pageXOffset+"px",navigationPanelDiv.style.top=e.top+window.pageYOffset+"px")),this.canvas3D.updateViewportSize()},HomeComponent3D.prototype.createNavigationPanel=function(e,t,i){var n,o=this.getSimulatedKeyElements(document.getElementsByTagName("body")[0]),r=null;try{n=t.getLocalizedString("HomeComponent3D","navigationPanel.innerHTML")}catch(e){n='<img src="'+ZIPTools.getScriptFolder("gl-matrix-min.js")+'navigationPanel.png"     style="width: 56px; height:59px; margin:5px; user-drag: none; user-select: none; -moz-user-select: none; -webkit-user-drag: none; -webkit-user-select: none; -ms-user-select: none;"     usemap="#navigationPanelMap"/><map name="navigationPanelMap" id="navigationPanelMap">  <area shape="poly" coords="28,4,33,8,33,19,22,19,22,8,29,4" data-simulated-key="UP" />  <area shape="poly" coords="4,28,8,23,19,23,19,34,8,34,4,29" data-simulated-key="LEFT" />  <area shape="poly" coords="28,54,33,50,33,39,22,39,22,50,29,54" data-simulated-key="DOWN" />  <area shape="poly" coords="51,28,47,23,36,23,36,34,47,34,51,29" data-simulated-key="RIGHT" />  <area shape="poly" coords="28,22,33,26,33,28,22,28,22,26,29,22" data-simulated-key="PAGE_UP" />  <area shape="poly" coords="28,36,33,32,33,30,22,30,22,32,29,36" data-simulated-key="PAGE_DOWN" /></map>'}var l=this;if(null!==n){(r=document.createElement("div")).setAttribute("id","div"+Math.floor(1e10*Math.random())),r.style.position="absolute",this.windowResizeListener=function(e){l.revalidate()},window.addEventListener("resize",this.windowResizeListener);for(var a=0,s=this.canvas3D.getHTMLElement();s&&s.style&&isNaN(a=parseInt(s.style.zIndex));s=s.parentElement);r.style.zIndex=isNaN(a)?"1":(a+1).toString(),r.style.visibility="hidden",r.innerHTML=n,o.push.apply(o,this.getSimulatedKeyElements(r));var h=document.getElementsByTagName("body")[0];h.insertBefore(r,h.firstChild),r.addEventListener("mousedown",(function(e){l.mouseListener.mousePressed(e)}))}this.simulatedEventListener={mousePressed:function(e){var t=e.target,i=function(){var i=t.getAttribute("data-simulated-key"),n=i.substring(i.indexOf(":")+1),o="";(e.ctrlKey||-1!=n.indexOf("control "))&&(o+="control "),(e.altKey||-1!=n.indexOf("alt "))&&(o+="alt "),(e.metaKey||-1!=n.indexOf("meta "))&&(o+="meta "),(e.shiftKey||-1!=n.indexOf("shift "))&&(o+="shift "),o+="pressed "+n,l.callAction(e,o)},n=function(e){window.clearInterval(o),OperatingSystem.isInternetExplorerOrLegacyEdge()&&window.PointerEvent?(t.removeEventListener("pointerup",n),t.removeEventListener("pointerleave",n)):(t.removeEventListener("touchend",n),t.removeEventListener("mouseup",n),t.removeEventListener("mouseleave",n)),l.mouseListener.windowMouseReleased(e),e.stopPropagation()};OperatingSystem.isInternetExplorerOrLegacyEdge()&&window.PointerEvent?(t.addEventListener("pointerup",n),t.addEventListener("pointerleave",n)):(t.addEventListener("touchend",n),t.addEventListener("mouseup",n),t.addEventListener("mouseleave",n)),i();var o=window.setInterval(i,80)},pointerMousePressed:function(e){e.stopPropagation()},touchStarted:function(e){e.preventDefault(),l.simulatedEventListener.mousePressed(e)}};for(var u=0;u<o.length;u++)OperatingSystem.isInternetExplorerOrLegacyEdge()&&window.PointerEvent?(o[u].addEventListener("pointerdown",this.simulatedEventListener.mousePressed),o[u].addEventListener("mousedown",this.simulatedEventListener.pointerMousePressed)):(o[u].addEventListener("touchstart",this.simulatedEventListener.touchStarted),o[u].addEventListener("mousedown",this.simulatedEventListener.mousePressed));return null!==r?r.getAttribute("id"):null},HomeComponent3D.prototype.getSimulatedKeyElements=function(e){var t=[];if(e.hasChildNodes())for(var i=0;i<e.childNodes.length;i++){var n=e.childNodes[i];if(n.hasAttribute&&n.hasAttribute("data-simulated-key")){var o=n.getAttribute("data-simulated-key");-1!==o.indexOf(":")&&0!==o.indexOf(this.canvas3D.getHTMLElement().getAttribute("id")+":")||t.push(n)}t.push.apply(t,this.getSimulatedKeyElements(n))}return t},HomeComponent3D.prototype.setNavigationPanelVisible=function(e){null!=this.navigationPanelId&&(document.getElementById(this.navigationPanelId).style.visibility=e?"visible":"hidden",e&&this.revalidate())},HomeComponent3D.prototype.removeHomeListeners=function(){this.home.removePropertyChangeListener("CAMERA",this.homeCameraListener);var e=this.home.getEnvironment();e.removePropertyChangeListener("SKY_COLOR",this.backgroundChangeListener),e.removePropertyChangeListener("SKY_TEXTURE",this.backgroundChangeListener),e.removePropertyChangeListener("GROUND_COLOR",this.backgroundChangeListener),e.removePropertyChangeListener("GROUND_TEXTURE",this.backgroundChangeListener),e.removePropertyChangeListener("GROUND_COLOR",this.groundChangeListener),e.removePropertyChangeListener("GROUND_TEXTURE",this.groundChangeListener),e.removePropertyChangeListener("BACKGROUND_IMAGE_VISIBLE_ON_GROUND_3D",this.groundChangeListener),this.home.removePropertyChangeListener("BACKGROUND_IMAGE",this.groundChangeListener),e.removePropertyChangeListener("LIGHT_COLOR",this.lightColorListener),e.removePropertyChangeListener("WALLS_ALPHA",this.wallsAlphaListener),this.home.getCamera().removePropertyChangeListener(this.cameraChangeListener),this.home.removePropertyChangeListener("CAMERA",this.elevationChangeListener),this.home.getCamera().removePropertyChangeListener(this.elevationChangeListener),this.home.removeSelectionListener(this.selectionListener),this.home.removeLevelsListener(this.levelListener);for(var t=this.home.getLevels(),i=0;i<t.length;i++)t[i].removePropertyChangeListener(this.levelChangeListener);this.home.removeWallsListener(this.wallListener);var n=this.home.getWalls();for(i=0;i<n.length;i++)n[i].removePropertyChangeListener(this.wallChangeListener);this.home.removeFurnitureListener(this.furnitureListener);var o=this.home.getFurniture();for(i=0;i<o.length;i++)this.removePropertyChangeListener(o[i],this.furnitureChangeListener);this.home.removeRoomsListener(this.roomListener);var r=this.home.getRooms();for(i=0;i<r.length;i++)r[i].removePropertyChangeListener(this.roomChangeListener);this.home.removePolylinesListener(this.polylineListener);var l=this.home.getPolylines();for(i=0;i<l.length;i++)l[i].removePropertyChangeListener(this.polylineChangeListener);this.home.removeDimensionLinesListener(this.dimensionLineListener);var a=this.home.getDimensionLines();for(i=0;i<a.length;i++)a[i].removePropertyChangeListener(this.dimensionLineChangeListener);this.home.removeLabelsListener(this.labelListener);var s=this.home.getLabels();for(i=0;i<s.length;i++)s[i].removePropertyChangeListener(this.labelChangeListener)},HomeComponent3D.prototype.removeMouseListeners=function(e){this.mouseListener&&(OperatingSystem.isInternetExplorerOrLegacyEdge()&&window.PointerEvent?(e.getHTMLElement().removeEventListener("pointerdown",this.mouseListener.pointerPressed),e.getHTMLElement().removeEventListener("mousedown",this.mouseListener.pointerMousePressed),e.getHTMLElement().removeEventListener("dblclick",this.mouseListener.mouseDoubleClicked),window.removeEventListener("pointermove",this.mouseListener.windowPointerMoved),window.removeEventListener("pointerup",this.mouseListener.windowPointerReleased)):(e.getHTMLElement().removeEventListener("touchstart",this.mouseListener.touchStarted),e.getHTMLElement().removeEventListener("touchmove",this.mouseListener.touchMoved),e.getHTMLElement().removeEventListener("touchend",this.mouseListener.touchEnded),e.getHTMLElement().removeEventListener("mousedown",this.mouseListener.mousePressed),e.getHTMLElement().removeEventListener("dblclick",this.mouseListener.mouseDoubleClicked),window.removeEventListener("mousemove",this.mouseListener.windowMouseMoved),window.removeEventListener("mouseup",this.mouseListener.windowMouseReleased)),e.getHTMLElement().removeEventListener("contextmenu",this.mouseListener.contextMenuDisplayed),e.getHTMLElement().removeEventListener("DOMMouseScroll",this.mouseListener.mouseScrolled),e.getHTMLElement().removeEventListener("mousewheel",this.mouseListener.mouseWheelMoved))},HomeComponent3D.prototype.dispose=function(){if(this.removeHomeListeners(),this.removeMouseListeners(this.canvas3D),null!=this.navigationPanelId){this.preferences.removePropertyChangeListener("NAVIGATION_PANEL_VISIBLE",this.preferencesChangeListener),window.removeEventListener("resize",this.windowResizeListener);for(var e=this.getSimulatedKeyElements(document.getElementsByTagName("body")[0]),t=0;t<e.length;t++)OperatingSystem.isInternetExplorerOrLegacyEdge()&&window.PointerEvent?(e[t].removeEventListener("pointerdown",this.simulatedEventListener.mousePressed),e[t].removeEventListener("mousedown",this.simulatedEventListener.pointerMousePressed)):(e[t].removeEventListener("touchstart",this.simulatedEventListener.touchStarted),e[t].removeEventListener("mousedown",this.simulatedEventListener.mousePressed));var i=document.getElementById(this.navigationPanelId);i.parentElement.removeChild(i),this.navigationPanelId=null}null!==this.preferences&&(this.preferences.removePropertyChangeListener("EDITING_IN_3D_VIEW_ENABLED",this.preferencesChangeListener),this.preferences.removePropertyChangeListener("UNIT",this.preferencesChangeListener),this.preferences.removePropertyChangeListener("DEFAULT_FONT_NAME",this.preferencesChangeListener)),this.canvas3D.clear()},HomeComponent3D.prototype.addCameraListeners=function(){var e=this,t=this.home;this.cameraChangeListener=function(i){e.cameraChangeListener.updater||(e.cameraChangeListener.updater=function(){e.canvas3D&&(e.updateView(t.getCamera()),e.updateViewPlatformTransform(t.getCamera(),!0)),delete e.cameraChangeListener.updater},setTimeout(e.cameraChangeListener.updater,0))},t.getCamera().addPropertyChangeListener(this.cameraChangeListener),this.homeCameraListener=function(i){e.updateView(t.getCamera()),e.updateViewPlatformTransform(t.getCamera(),!1),i.getOldValue().removePropertyChangeListener(e.cameraChangeListener),t.getCamera().addPropertyChangeListener(e.cameraChangeListener)},this.home.addPropertyChangeListener("CAMERA",this.homeCameraListener)},HomeComponent3D.prototype.updateView=function(e){var t=e.getFieldOfView();0===t&&(t=63*Math.PI/180),this.canvas3D.setFieldOfView(t);var i=2.5,n=5e5;if(this.canvas3D.getDepthBits()<=16){n=3e3;var o=this.getApproximateHomeBounds();if(null!=o&&!o.intersect(vec3.fromValues(e.getX(),e.getY(),e.getZ()))){var r=this.getDistanceToBox(e.getX(),e.getY(),e.getZ(),o);isNaN(r)||(i=Math.max(i,.1*r))}}else{var l=this.getHomeHeight();e.getZ()>l&&(i=Math.max(i,(e.getZ()-l)/10))}var a=this.canvas3D.getHTMLElement().getBoundingClientRect();if(e.getZ()>0&&0!==a.width&&0!==a.height){var s=Math.atan(Math.tan(t/2)*a.height/a.width),h=e.getPitch()+s;if(h>0){var u=e.getZ()/Math.sin(h);(i=Math.min(i,.35*u))*n<u&&(i=u/n)}}this.canvas3D.setFrontClipDistance(i),this.canvas3D.setBackClipDistance(i*n)},HomeComponent3D.prototype.getApproximateHomeBounds=function(){if(null===this.approximateHomeBoundsCache){for(var e=null,t=this.home.getFurniture(),i=0;i<t.length;i++){var n=t[i];if(n.isVisible()&&(null===n.getLevel()||n.getLevel().isViewable())){var o=Math.max(n.getWidthInPlan(),n.getDepthInPlan())/2,r=n.getGroundElevation(),l=vec3.fromValues(n.getX()-o,n.getY()-o,r);null===e?e=new BoundingBox3D(l,l):e.combine(l),e.combine(vec3.fromValues(n.getX()+o,n.getY()+o,r+n.getHeightInPlan()))}}var a=this.home.getWalls();for(i=0;i<a.length;i++){var s=a[i];if(null===s.getLevel()||s.getLevel().isViewable()){var h=vec3.fromValues(s.getXStart(),s.getYStart(),null!==s.getLevel()?s.getLevel().getElevation():0);null===e?e=new BoundingBox3D(h,h):e.combine(h),e.combine(vec3.fromValues(s.getXEnd(),s.getYEnd(),h.z+(null!==s.getHeight()?s.getHeight():this.home.getWallHeight())))}}var u=this.home.getRooms();for(i=0;i<u.length;i++){var d=u[i];if(null===d.getLevel()||d.getLevel().isViewable()){var c=vec3.fromValues(d.getXCenter(),d.getYCenter(),null!==d.getLevel()?d.getLevel().getElevation():0);null===e?e=new BoundingBox3D(c,c):e.combine(c)}}var p=this.home.getDimensionLines();for(i=0;i<p.length;i++){var g=p[i];if((null==g.getLevel()||g.getLevel().isViewable())&&g.isVisibleIn3D()){var m=null!=g.getLevel()?g.getLevel().getElevation():0;h=vec3.fromValues(g.getXStart(),g.getYStart(),m+g.getElevationStart());null==e?e=new BoundingBox3D(h,h):e.combine(h),e.combine(vec3.fromValues(g.getXEnd(),g.getYEnd(),m+g.getElevationEnd()))}}var f=this.home.getLabels();for(i=0;i<f.length;i++){var v=f[i];if((null===v.getLevel()||v.getLevel().isViewable())&&null!==v.getPitch()){c=vec3.fromValues(v.getX(),v.getY(),v.getGroundElevation());null==e?e=new BoundingBox3D(c,c):e.combine(c)}}var _=this.home.getPolylines();for(i=0;i<_.length;i++){var S=_[i];if((null==S.getLevel()||S.getLevel().isViewable())&&S.isVisibleIn3D())for(var y=S.getPoints(),E=0;E<y.length;E++){var C=vec3.fromValues(y[E][0],y[E][1],S.getGroundElevation());null==e?e=new BoundingBox3D(C,C):e.combine(C)}}this.approximateHomeBoundsCache=e}return this.approximateHomeBoundsCache},HomeComponent3D.prototype.getDistanceToBox=function(e,t,i,n){var o=vec3.fromValues(e,t,i),r=vec3.create();n.getLower(r);var l=vec3.create();n.getUpper(l);for(var a=[vec3.fromValues(r[0],r[1],r[2]),vec3.fromValues(l[0],r[1],r[2]),vec3.fromValues(r[0],l[1],r[2]),vec3.fromValues(l[0],l[1],r[2]),vec3.fromValues(r[0],r[1],l[2]),vec3.fromValues(l[0],r[1],l[2]),vec3.fromValues(r[0],l[1],l[2]),vec3.fromValues(l[0],l[1],l[2])],s=new Array(a.length),h=0;h<s.length;h++)s[h]=vec3.squaredDistance(o,a[h]);var u=[this.getDistanceToSide(o,a,s,0,1,3,2,2),this.getDistanceToSide(o,a,s,0,1,5,4,1),this.getDistanceToSide(o,a,s,0,2,6,4,0),this.getDistanceToSide(o,a,s,4,5,7,6,2),this.getDistanceToSide(o,a,s,2,3,7,6,1),this.getDistanceToSide(o,a,s,1,3,7,5,0)],d=u[0];for(h=1;h<u.length;h++)d=Math.min(d,u[h]);return d},HomeComponent3D.prototype.getDistanceToSide=function(e,t,i,n,o,r,l,a){switch(a){case 0:if(e[1]<=t[n][1])return e[2]<=t[n][2]?Math.sqrt(i[n]):e[2]>=t[l][2]?Math.sqrt(i[l]):this.getDistanceToLine(e,t[n],t[l]);if(e[1]>=t[o][1])return e[2]<=t[o][2]?Math.sqrt(i[o]):e[2]>=t[r][2]?Math.sqrt(i[r]):this.getDistanceToLine(e,t[o],t[r]);if(e[2]<=t[n][2])return this.getDistanceToLine(e,t[n],t[o]);if(e[2]>=t[l][2])return this.getDistanceToLine(e,t[r],t[l]);break;case 1:if(e[0]<=t[n][0])return e[2]<=t[n][2]?Math.sqrt(i[n]):e[2]>=t[l][2]?Math.sqrt(i[l]):this.getDistanceToLine(e,t[n],t[l]);if(e[0]>=t[o][0])return e[2]<=t[o][2]?Math.sqrt(i[o]):e[2]>=t[r][2]?Math.sqrt(i[r]):this.getDistanceToLine(e,t[o],t[r]);if(e[2]<=t[n][2])return this.getDistanceToLine(e,t[n],t[o]);if(e[2]>=t[l][2])return this.getDistanceToLine(e,t[r],t[l]);break;case 2:if(e[0]<=t[n][0])return e[1]<=t[n][1]?Math.sqrt(i[n]):e[1]>=t[l][1]?Math.sqrt(i[l]):this.getDistanceToLine(e,t[n],t[l]);if(e[0]>=t[o][0])return e[1]<=t[o][1]?Math.sqrt(i[o]):e[1]>=t[r][1]?Math.sqrt(i[r]):this.getDistanceToLine(e,t[o],t[r]);if(e[1]<=t[n][1])return this.getDistanceToLine(e,t[n],t[o]);if(e[1]>=t[l][1])return this.getDistanceToLine(e,t[r],t[l])}var s=vec3.fromValues(t[o][0]-t[n][0],t[o][1]-t[n][1],t[o][2]-t[n][2]),h=vec3.fromValues(t[r][0]-t[n][0],t[r][1]-t[n][1],t[r][2]-t[n][2]),u=vec3.create();return vec3.cross(u,s,h),Math.abs(vec3.dot(u,vec3.fromValues(t[n][0]-e[0],t[n][1]-e[1],t[n][2]-e[2])))/vec3.length(u)},HomeComponent3D.prototype.getDistanceToLine=function(e,t,i){var n=vec3.fromValues(i[0]-t[0],i[1]-t[1],i[2]-t[2]),o=vec3.fromValues(e[0]-t[0],e[1]-t[1],e[2]-t[2]),r=vec3.create();return vec3.cross(r,n,o),vec3.length(r)/vec3.length(n)},HomeComponent3D.prototype.getHomeHeight=function(){if(null===this.homeHeightCache){for(var e=0,t=this.home.getFurniture(),i=0;i<t.length;i++){var n=t[i];n.isVisible()&&(null==n.getLevel()||n.getLevel().isViewable())&&(e=Math.max(e,n.getGroundElevation()+n.getHeight()))}var o=this.home.getWalls();for(i=0;i<o.length;i++){var r=o[i];if(null==r.getLevel()||r.getLevel().isViewable()){var l=null!=r.getLevel()?r.getLevel().getElevation():0;null!=r.getHeight()?(e=Math.max(e,l+r.getHeight()),null!=r.getHeightAtEnd()&&(e=Math.max(e,l+r.getHeightAtEnd()))):e=Math.max(e,l+this.home.getWallHeight())}}var a=this.home.getRooms();for(i=0;i<a.length;i++){var s=a[i];null!=s.getLevel()&&s.getLevel().isViewable()&&(e=Math.max(e,s.getLevel().getElevation()))}var h=this.home.getPolylines();for(i=0;i<h.length;i++){var u=h[i];u.isVisibleIn3D()&&(null==u.getLevel()||u.getLevel().isViewable())&&(e=Math.max(e,u.getGroundElevation()))}var d=this.home.getDimensionLines();for(i=0;i<d.length;i++){var c=d[i];if(c.isVisibleIn3D()&&(null==c.getLevel()||c.getLevel().isViewable())){var p=null!=c.getLevel()?c.getLevel().getElevation():0;e=Math.max(e,p+Math.max(c.getElevationStart(),c.getElevationEnd()))}}var g=this.home.getLabels();for(i=0;i<g.length;i++){var m=g[i];null==m.getPitch()||null!=m.getLevel()&&!m.getLevel().isViewable()||(e=Math.max(e,m.getGroundElevation()))}this.homeHeightCache=e}return this.homeHeightCache},HomeComponent3D.prototype.updateViewPlatformTransform=function(e,t){if(t)this.moveCameraWithAnimation(e);else{delete this.cameraInterpolator;var i=mat4.create();this.computeViewPlatformTransform(i,e.getX(),e.getY(),e.getZ(),e.getYaw(),e.getPitch()),this.canvas3D.setViewPlatformTransform(i)}},HomeComponent3D.prototype.moveCameraWithAnimation=function(e){if(void 0===this.cameraInterpolator&&(this.cameraInterpolator={initialCamera:null,finalCamera:null,alpha:null}),null===this.cameraInterpolator.finalCamera||this.cameraInterpolator.finalCamera.getX()!==e.getX()||this.cameraInterpolator.finalCamera.getY()!==e.getY()||this.cameraInterpolator.finalCamera.getZ()!==e.getZ()||this.cameraInterpolator.finalCamera.getYaw()!==e.getYaw()||this.cameraInterpolator.finalCamera.getPitch()!==e.getPitch()){if(null===this.cameraInterpolator.alpha||1===this.cameraInterpolator.alpha)this.cameraInterpolator.initialCamera=new Camera(this.camera.getX(),this.camera.getY(),this.camera.getZ(),this.camera.getYaw(),this.camera.getPitch(),this.camera.getFieldOfView());else if(this.cameraInterpolator.alpha<.3){var t=mat4.create();this.computeViewPlatformTransform(t,this.cameraInterpolator.finalCamera.getX(),this.cameraInterpolator.finalCamera.getY(),this.cameraInterpolator.finalCamera.getZ(),this.cameraInterpolator.finalCamera.getYaw(),this.cameraInterpolator.finalCamera.getPitch()),this.canvas3D.setViewPlatformTransform(t),this.cameraInterpolator.initialCamera=this.cameraInterpolator.finalCamera}else this.cameraInterpolator.initialCamera=new Camera(this.cameraInterpolator.initialCamera.getX()+(this.cameraInterpolator.finalCamera.getX()-this.cameraInterpolator.initialCamera.getX())*this.cameraInterpolator.alpha,this.cameraInterpolator.initialCamera.getY()+(this.cameraInterpolator.finalCamera.getY()-this.cameraInterpolator.initialCamera.getY())*this.cameraInterpolator.alpha,this.cameraInterpolator.initialCamera.getZ()+(this.cameraInterpolator.finalCamera.getZ()-this.cameraInterpolator.initialCamera.getZ())*this.cameraInterpolator.alpha,this.cameraInterpolator.initialCamera.getYaw()+(this.cameraInterpolator.finalCamera.getYaw()-this.cameraInterpolator.initialCamera.getYaw())*this.cameraInterpolator.alpha,this.cameraInterpolator.initialCamera.getPitch()+(this.cameraInterpolator.finalCamera.getPitch()-this.cameraInterpolator.initialCamera.getPitch())*this.cameraInterpolator.alpha,e.getFieldOfView());this.cameraInterpolator.finalCamera=new Camera(e.getX(),e.getY(),e.getZ(),e.getYaw(),e.getPitch(),e.getFieldOfView()),null===this.cameraInterpolator.alpha&&(this.cameraInterpolator.animationDuration=75),this.cameraInterpolator.startTime=Date.now(),this.cameraInterpolator.alpha=0;var i=this;requestAnimationFrame((function(){i.interpolateUntilAlphaEquals1()}))}},HomeComponent3D.prototype.interpolateUntilAlphaEquals1=function(){if(this.cameraInterpolator){var e=Date.now(),t=Math.min(1,(e-this.cameraInterpolator.startTime)/this.cameraInterpolator.animationDuration);if(this.cameraInterpolator.alpha!==t){var i=mat4.create();this.computeTransform(t,i),this.canvas3D.setViewPlatformTransform(i),this.cameraInterpolator.alpha=t}if(this.cameraInterpolator.alpha<1){var n=this;requestAnimationFrame((function(){n.interpolateUntilAlphaEquals1()}))}}},HomeComponent3D.prototype.computeTransform=function(e,t){this.computeViewPlatformTransform(t,this.cameraInterpolator.initialCamera.getX()+(this.cameraInterpolator.finalCamera.getX()-this.cameraInterpolator.initialCamera.getX())*e,this.cameraInterpolator.initialCamera.getY()+(this.cameraInterpolator.finalCamera.getY()-this.cameraInterpolator.initialCamera.getY())*e,this.cameraInterpolator.initialCamera.getZ()+(this.cameraInterpolator.finalCamera.getZ()-this.cameraInterpolator.initialCamera.getZ())*e,this.cameraInterpolator.initialCamera.getYaw()+(this.cameraInterpolator.finalCamera.getYaw()-this.cameraInterpolator.initialCamera.getYaw())*e,this.cameraInterpolator.initialCamera.getPitch()+(this.cameraInterpolator.finalCamera.getPitch()-this.cameraInterpolator.initialCamera.getPitch())*e)},HomeComponent3D.prototype.computeViewPlatformTransform=function(e,t,i,n,o,r){var l=mat4.create();mat4.fromYRotation(l,-o+Math.PI);var a=mat4.create();mat4.fromXRotation(a,-r),mat4.mul(l,l,a),mat4.identity(e),mat4.translate(e,e,vec3.fromValues(t,n,i)),mat4.mul(e,e,l),this.camera=new Camera(t,i,n,o,r,0)},HomeComponent3D.prototype.addMouseListeners=function(e,t,i){var n=this,o={initialPointerLocation:null,lastPointerLocation:null,touchEventType:!1,buttonPressed:-1,pointerTouches:{},lastEventType:null,lastTargetTouches:[],distanceLastPinch:-1,firstTouchStartedTimeStamp:0,longTouchActivated:!1,doubleLongTouchActivated:!1,longTouchStartTime:0,actionStartedInComponent3D:!1,contextMenuEventType:!1,mousePressed:function(t){o.touchEventType||o.contextMenuEventType||0!==t.button||(o.updateCoordinates(t,"mousePressed"),o.initialPointerLocation=[t.canvasX,t.canvasY],o.lastPointerLocation=[t.canvasX,t.canvasY],o.actionStartedInComponent3D=!0,e.pressMouse(t.canvasX,t.canvasY,t.clickCount,o.isShiftDown(t),o.isAlignmentActivated(t),o.isDuplicationActivated(t),o.isMagnetismToggled(t),View.PointerType.MOUSE)),t.stopPropagation()},isShiftDown:function(e){return e.shiftKey&&!e.altKey&&!e.ctrlKey&&!e.metaKey},isAlignmentActivated:function(e){return OperatingSystem.isWindows()||OperatingSystem.isMacOSX()?e.shiftKey:e.shiftKey&&!e.altKey},isDuplicationActivated:function(e){return OperatingSystem.isMacOSX()?e.altKey:e.ctrlKey},isMagnetismToggled:function(e){return OperatingSystem.isWindows()?e.altKey:OperatingSystem.isMacOSX()?e.metaKey:e.shiftKey&&e.altKey},mouseDoubleClicked:function(e){o.updateCoordinates(e,"mouseDoubleClicked"),o.mousePressed(e),o.actionStartedInComponent3D=!1},windowMouseMoved:function(t){o.touchEventType||o.contextMenuEventType||(o.updateCoordinates(t,"mouseMoved"),null==o.initialPointerLocation||o.initialPointerLocation[0]===t.canvasX&&o.initialPointerLocation[1]===t.canvasY||(o.initialPointerLocation=null),null==o.initialPointerLocation&&(0===t.buttons&&o.isInCanvas(t)||o.actionStartedInComponent3D)&&(e.isEditingState()?e.moveMouse(t.canvasX,t.canvasY):o.actionStartedInComponent3D&&document.activeElement===n.canvas3D.getHTMLElement()&&o.moveCamera(t.canvasX,t.canvasY,o.lastPointerLocation[0],o.lastPointerLocation[1],t.altKey,t.shiftKey)),o.lastPointerLocation=[t.canvasX,t.canvasY])},windowMouseReleased:function(t){o.touchEventType||null!=o.lastPointerLocation&&(o.actionStartedInComponent3D&&document.activeElement===n.canvas3D.getHTMLElement()&&0===t.button&&(o.contextMenuEventType?e.releaseMouse(o.initialPointerLocation[0],o.initialPointerLocation[1]):(o.updateCoordinates(t,"mouseReleased"),e.releaseMouse(t.canvasX,t.canvasY))),o.initialPointerLocation=null,o.lastPointerLocation=null,o.actionStartedInComponent3D=!1),o.contextMenuEventType=!1},pointerPressed:function(e){"mouse"==e.pointerType?o.mousePressed(e):(o.copyPointerToTargetTouches(e,!1),o.touchStarted(e))},pointerMousePressed:function(e){e.stopPropagation()},windowPointerMoved:function(e){"mouse"==e.pointerType?o.windowMouseMoved(e):(o.copyPointerToTargetTouches(e,!1),o.touchMoved(e))},windowPointerReleased:function(e){"mouse"==e.pointerType?o.windowMouseReleased(e):(e.preventDefault(),o.copyPointerToTargetTouches(e,!0),o.touchEnded(e))},contextMenuDisplayed:function(e){o.contextMenuEventType=!0},touchStarted:function(i){if(o.touchEventType=void 0===i.pointerType,i.preventDefault(),document.activeElement!==n.canvas3D.getHTMLElement()&&n.canvas3D.getHTMLElement().focus(),o.updateCoordinates(i,"touchStarted"),null!=o.longTouch&&(clearTimeout(o.longTouch),o.longTouch=null,n.stopLongTouchAnimation()),1===i.targetTouches.length){var r=1;null!=o.initialPointerLocation&&o.distance(i.canvasX,i.canvasY,o.initialPointerLocation[0],o.initialPointerLocation[1])<5&&i.timeStamp-o.firstTouchStartedTimeStamp<=HomeComponent3D.DOUBLE_TOUCH_DELAY?(r=2,o.firstTouchStartedTimeStamp=0,o.initialPointerLocation=null):(o.firstTouchStartedTimeStamp=i.timeStamp,o.initialPointerLocation=[i.canvasX,i.canvasY]),o.longTouchActivated=!1,o.doubleLongTouchActivated=!1,o.distanceLastPinch=null,o.lastPointerLocation=[i.canvasX,i.canvasY],o.actionStartedInComponent3D=!0,o.longTouchWhenDragged=!1,t.isEditingIn3DViewEnabled()&&1==r&&null!==n.getClosestSelectableItemAt(i.canvasX,i.canvasY)&&(o.longTouch=setTimeout((function(){n.startLongTouchAnimation(i.canvasX,i.canvasY,(function(){o.longTouchActivated=!0,e.setAlignmentActivated(!0)}))}),HomeComponent3D.LONG_TOUCH_DELAY),o.longTouchStartTime=Date.now()),e.pressMouse(i.canvasX,i.canvasY,r,o.isShiftDown(i),o.isAlignmentActivated(i),o.isDuplicationActivated(i),o.isMagnetismToggled(i),View.PointerType.TOUCH)}else o.longTouchActivated&&2===i.targetTouches.length?(o.doubleLongTouchActivated=!0,e.setDuplicationActivated(!0)):e.escape(),2===i.targetTouches.length&&(o.actionStartedInComponent3D=!0,o.initialPointerLocation=null,o.distanceLastPinch=o.distance(i.targetTouches[0].clientX,i.targetTouches[0].clientY,i.targetTouches[1].clientX,i.targetTouches[1].clientY))},touchMoved:function(t){if(o.actionStartedInComponent3D&&(t.preventDefault(),t.stopPropagation(),o.updateCoordinates(t,"touchMoved")))if(o.initialPointerLocation=null,1==t.targetTouches.length)null!=o.longTouch&&(clearTimeout(o.longTouch),o.longTouch=null,n.stopLongTouchAnimation()),e.isEditingState()?o.doubleLongTouchActivated||e.moveMouse(t.canvasX,t.canvasY):n.home.getCamera()===n.home.getObserverCamera()?o.moveCamera(-t.canvasX,-t.canvasY,-o.lastPointerLocation[0],-o.lastPointerLocation[1],!1,!1):o.moveCamera(t.canvasX,t.canvasY,o.lastPointerLocation[0],o.lastPointerLocation[1],!1,!1),o.lastPointerLocation=[t.canvasX,t.canvasY];else if(2==t.targetTouches.length&&null!=o.distanceLastPinch)if(e.isEditingState())e.moveMouse(t.targetTouches[1].clientX,t.targetTouches[1].clientY);else{var i=o.distance(t.targetTouches[0].clientX,t.targetTouches[0].clientY,t.targetTouches[1].clientX,t.targetTouches[1].clientY),r=i/o.distanceLastPinch;o.zoomCamera(50*(1-r),!1),o.distanceLastPinch=i}},touchEnded:function(t){o.actionStartedInComponent3D&&(o.updateCoordinates(t,"touchEnded"),0==t.targetTouches.length?(null!=o.longTouch&&(clearTimeout(o.longTouch),o.longTouch=null,n.stopLongTouchAnimation()),e.releaseMouse(o.lastPointerLocation[0],o.lastPointerLocation[1]),o.isLongTouch()&&t.preventDefault(),o.actionStartedInComponent3D=!1):1==t.targetTouches.length?o.lastPointerLocation=[t.canvasX,t.canvasY]:2==t.targetTouches.length&&null!=o.distanceLastPinch&&(o.distanceLastPinch=o.distance(t.targetTouches[0].clientX,t.targetTouches[0].clientY,t.targetTouches[1].clientX,t.targetTouches[1].clientY)))},copyPointerToTargetTouches:function(e,t){for(var i in t?(e.changedTouches=[o.pointerTouches[e.pointerId]],delete o.pointerTouches[e.pointerId]):o.pointerTouches[e.pointerId]={clientX:e.clientX,clientY:e.clientY},e.targetTouches=[],o.pointerTouches)o.pointerTouches.hasOwnProperty(i)&&e.targetTouches.push(o.pointerTouches[i])},updateCoordinates:function(e,t){var i=n.canvas3D.getHTMLElement().getBoundingClientRect(),r=!0;if(0===t.indexOf("touch")){var l,a="touchStarted"==o.lastEventType?5:1.5;if(1===e.targetTouches.length&&"touchMoved"==t&&o.distance(o.lastTargetTouches[0].clientX,o.lastTargetTouches[0].clientY,e.targetTouches[0].clientX,e.targetTouches[0].clientY)<a||0===e.targetTouches.length&&"touchEnded"==t&&o.distance(o.lastTargetTouches[0].clientX,o.lastTargetTouches[0].clientY,e.changedTouches[0].clientX,e.changedTouches[0].clientY)<a?(l=o.lastTargetTouches,r=!1):(l=0==e.targetTouches.length?e.changedTouches:e.targetTouches,o.lastEventType=t),1==l.length){e.canvasX=l[0].clientX-i.left,e.canvasY=l[0].clientY-i.top;i=n.canvas3D.getHTMLElement().getBoundingClientRect();e.clientX=l[0].clientX,e.clientY=l[0].clientY,e.button=0}if(e.clickCount=1,r){o.lastTargetTouches=[];for(var s=0;void 0!==l[s];s++)o.lastTargetTouches.push({clientX:l[s].clientX,clientY:l[s].clientY})}}else e.canvasX=e.clientX-i.left,e.canvasY=e.clientY-i.top;return void 0===e.clickCount&&(e.clickCount="mouseDoubleClicked"==t?2:"mousePressed"==t||"mouseReleased"==t?1:0),"mouseWheelMoved"==t&&(e.wheelRotation=(void 0!==e.deltaY?e.deltaX+e.deltaY:-e.wheelDelta)/4),r},isLongTouch:function(e){return Date.now()-o.longTouchStartTime>(e?HomeComponent3D.LONG_TOUCH_DELAY_WHEN_DRAGGING:HomeComponent3D.LONG_TOUCH_DELAY)+HomeComponent3D.LONG_TOUCH_DURATION_AFTER_DELAY},distance:function(e,t,i,n){return Math.sqrt(Math.pow(i-e,2)+Math.pow(n-t,2))},isInCanvas:function(e){return e.canvasX>=0&&e.canvasX<n.canvas3D.getHTMLElement().clientWidth&&e.canvasY>=0&&e.canvasY<n.canvas3D.getHTMLElement().clientHeight},mouseScrolled:function(e){o.zoomCamera(e.detail,e.shiftKey)},mouseWheelMoved:function(t){t.preventDefault(),e.isEditingState()||o.zoomCamera((void 0!==t.deltaY?t.deltaY:-t.wheelDelta)/4,t.shiftKey)},zoomCamera:function(t,i){t*=-2.5;i&&(t*=5),e.moveCamera(t)},moveCamera:function(t,i,n,r,l,a){if(o.actionStartedInComponent3D&&(o.lastPointerLocation[0]!==t||o.lastPointerLocation[1]!==i))if(l){var s=1.25*(r-i);a&&(s*=5),e.moveCamera(s)}else{var h=.005*(t-n);a&&(h*=5),e.rotateCameraYaw(h);var u=.005*(i-r);e.rotateCameraPitch(u)}}};OperatingSystem.isInternetExplorerOrLegacyEdge()&&window.PointerEvent?(i.getHTMLElement().addEventListener("pointerdown",o.pointerPressed),i.getHTMLElement().addEventListener("mousedown",o.pointerMousePressed),i.getHTMLElement().addEventListener("dblclick",o.mouseDoubleClicked),window.addEventListener("pointermove",o.windowPointerMoved),window.addEventListener("pointerup",o.windowPointerReleased)):(i.getHTMLElement().addEventListener("touchstart",o.touchStarted),i.getHTMLElement().addEventListener("touchmove",o.touchMoved),i.getHTMLElement().addEventListener("touchend",o.touchEnded),i.getHTMLElement().addEventListener("mousedown",o.mousePressed),i.getHTMLElement().addEventListener("dblclick",o.mouseDoubleClicked),window.addEventListener("mousemove",o.windowMouseMoved),window.addEventListener("mouseup",o.windowMouseReleased)),i.getHTMLElement().addEventListener("contextmenu",o.contextMenuDisplayed),i.getHTMLElement().addEventListener("DOMMouseScroll",o.mouseScrolled),i.getHTMLElement().addEventListener("mousewheel",o.mouseWheelMoved),this.mouseListener=o},HomeComponent3D.prototype.startLongTouchAnimation=function(e,t,i){if(void 0===this.touchOverlay){this.touchOverlay=document.createElement("div"),this.touchOverlay.id="touch-overlay-timer",this.touchOverlay.classList.add("touch-overlay-timer"),this.touchOverlay.style.position="absolute",this.touchOverlay.style.top="0px",this.touchOverlay.style.left="0px",this.touchOverlay.innerHTML='<div class="touch-overlay-timer-content"></div><div class="touch-overlay-timer-bg"></div><div class="touch-overlay-timer-hidder"></div><div class="touch-overlay-timer-loader1"></div><div class="touch-overlay-timer-loader2"></div>',document.body.appendChild(this.touchOverlay);for(var n=0;n<this.touchOverlay.children.length;n++){var o=this.touchOverlay.children.item(n);(o.classList.contains("overlay-timer-loader1")||o.classList.contains("overlay-timer-loader2"))&&(o.style.borderTopColor="#0000B5",o.style.borderRightColor="#0000B5"),o.classList.contains("touch-overlay-timer-content")&&(o.style.color="#000000",o.innerHTML="<span style='font-weight: bold; font-family: sans-serif; font-size: 140%; line-height: 90%'>&#x21EA;</span>"),o.style.animationDuration=PlanComponent.LONG_TOUCH_DURATION_AFTER_DELAY+"ms"}}this.touchOverlay.style.visibility="visible",this.touchOverlay.style.left=this.getHTMLElement().getBoundingClientRect().left+e-this.touchOverlay.clientWidth/2+"px",this.touchOverlay.style.top=this.getHTMLElement().getBoundingClientRect().top+t-this.touchOverlay.clientHeight-40+"px";for(n=0;n<this.touchOverlay.children.length;n++)this.touchOverlay.children.item(n).classList.add("animated");void 0!==i&&(this.longTouchAnimationPostTask=setTimeout(i,HomeComponent3D.LONG_TOUCH_DURATION_AFTER_DELAY))},HomeComponent3D.prototype.stopLongTouchAnimation=function(e,t){if(void 0!==this.touchOverlay){this.touchOverlay.style.visibility="hidden";for(var i=0;i<this.touchOverlay.children.length;i++)this.touchOverlay.children.item(i).classList.remove("animated");void 0!==this.longTouchAnimationPostTask&&(clearTimeout(this.longTouchAnimationPostTask),delete this.longTouchAnimationPostTask)}},HomeComponent3D.prototype.installKeyboardActions=function(){this.inputMap={"shift pressed UP":"MOVE_CAMERA_FAST_FORWARD","alt shift pressed UP":"MOVE_CAMERA_FAST_FORWARD","shift pressed W":"MOVE_CAMERA_FAST_FORWARD","pressed UP":"MOVE_CAMERA_FORWARD","alt pressed UP":"MOVE_CAMERA_FORWARD","pressed W":"MOVE_CAMERA_FORWARD","shift pressed DOWN":"MOVE_CAMERA_FAST_BACKWARD","alt shift pressed DOWN":"MOVE_CAMERA_FAST_BACKWARD","shift pressed S":"MOVE_CAMERA_FAST_BACKWARD","pressed DOWN":"MOVE_CAMERA_BACKWARD","alt pressed DOWN":"MOVE_CAMERA_BACKWARD","pressed S":"MOVE_CAMERA_BACKWARD","alt shift pressed LEFT":"MOVE_CAMERA_FAST_LEFT","alt pressed LEFT":"MOVE_CAMERA_LEFT","alt shift pressed RIGHT":"MOVE_CAMERA_FAST_RIGHT","alt pressed RIGHT":"MOVE_CAMERA_RIGHT","shift pressed LEFT":"ROTATE_CAMERA_YAW_FAST_LEFT","shift pressed A":"ROTATE_CAMERA_YAW_FAST_LEFT","pressed LEFT":"ROTATE_CAMERA_YAW_LEFT","pressed A":"ROTATE_CAMERA_YAW_LEFT","shift pressed RIGHT":"ROTATE_CAMERA_YAW_FAST_RIGHT","shift pressed D":"ROTATE_CAMERA_YAW_FAST_RIGHT","pressed RIGHT":"ROTATE_CAMERA_YAW_RIGHT","pressed D":"ROTATE_CAMERA_YAW_RIGHT","shift pressed PAGE_UP":"ROTATE_CAMERA_PITCH_FAST_UP","pressed PAGE_UP":"ROTATE_CAMERA_PITCH_UP","shift pressed PAGE_DOWN":"ROTATE_CAMERA_PITCH_FAST_DOWN","pressed PAGE_DOWN":"ROTATE_CAMERA_PITCH_DOWN","shift pressed HOME":"ELEVATE_CAMERA_FAST_UP","pressed HOME":"ELEVATE_CAMERA_UP","shift pressed END":"ELEVATE_CAMERA_FAST_DOWN","pressed END":"ELEVATE_CAMERA_DOWN","pressed ESCAPE":"ESCAPE","shift pressed ESCAPE":"ESCAPE"},OperatingSystem.isMacOSX()?(this.inputMap["alt pressed ALT"]="ACTIVATE_DUPLICATION",this.inputMap["released ALT"]="DEACTIVATE_DUPLICATION",this.inputMap["shift alt pressed ALT"]="ACTIVATE_DUPLICATION",this.inputMap["shift released ALT"]="DEACTIVATE_DUPLICATION",this.inputMap["meta alt pressed ALT"]="ACTIVATE_DUPLICATION",this.inputMap["meta released ALT"]="DEACTIVATE_DUPLICATION",this.inputMap["shift meta alt pressed ALT"]="ACTIVATE_DUPLICATION",this.inputMap["shift meta released ALT"]="DEACTIVATE_DUPLICATION",this.inputMap["alt pressed ESCAPE"]="ESCAPE"):(this.inputMap["control pressed CONTROL"]="ACTIVATE_DUPLICATION",this.inputMap["released CONTROL"]="DEACTIVATE_DUPLICATION",this.inputMap["shift control pressed CONTROL"]="ACTIVATE_DUPLICATION",this.inputMap["shift released CONTROL"]="DEACTIVATE_DUPLICATION",this.inputMap["meta control pressed CONTROL"]="ACTIVATE_DUPLICATION",this.inputMap["meta released CONTROL"]="DEACTIVATE_DUPLICATION",this.inputMap["shift meta control pressed CONTROL"]="ACTIVATE_DUPLICATION",this.inputMap["shift meta released CONTROL"]="DEACTIVATE_DUPLICATION",this.inputMap["control pressed ESCAPE"]="ESCAPE"),OperatingSystem.isWindows()?(this.inputMap["alt pressed ALT"]="TOGGLE_MAGNETISM_ON",this.inputMap["released ALT"]="TOGGLE_MAGNETISM_OFF",this.inputMap["shift alt pressed ALT"]="TOGGLE_MAGNETISM_ON",this.inputMap["shift released ALT"]="TOGGLE_MAGNETISM_OFF",this.inputMap["control alt pressed ALT"]="TOGGLE_MAGNETISM_ON",this.inputMap["control released ALT"]="TOGGLE_MAGNETISM_OFF",this.inputMap["shift control alt pressed ALT"]="TOGGLE_MAGNETISM_ON",this.inputMap["shift control released ALT"]="TOGGLE_MAGNETISM_OFF",this.inputMap["alt pressed ESCAPE"]="ESCAPE"):OperatingSystem.isMacOSX()?(this.inputMap["meta pressed META"]="TOGGLE_MAGNETISM_ON",this.inputMap["released META"]="TOGGLE_MAGNETISM_OFF",this.inputMap["shift meta pressed META"]="TOGGLE_MAGNETISM_ON",this.inputMap["shift released META"]="TOGGLE_MAGNETISM_OFF",this.inputMap["alt meta pressed META"]="TOGGLE_MAGNETISM_ON",this.inputMap["alt released META"]="TOGGLE_MAGNETISM_OFF",this.inputMap["shift alt meta pressed META"]="TOGGLE_MAGNETISM_ON",this.inputMap["shift alt released META"]="TOGGLE_MAGNETISM_OFF",this.inputMap["meta pressed ESCAPE"]="ESCAPE"):(this.inputMap["shift alt pressed ALT"]="TOGGLE_MAGNETISM_ON",this.inputMap["alt shift pressed SHIFT"]="TOGGLE_MAGNETISM_ON",this.inputMap["alt released SHIFT"]="TOGGLE_MAGNETISM_OFF",this.inputMap["shift released ALT"]="TOGGLE_MAGNETISM_OFF",this.inputMap["control shift alt pressed ALT"]="TOGGLE_MAGNETISM_ON",this.inputMap["control alt shift pressed SHIFT"]="TOGGLE_MAGNETISM_ON",this.inputMap["control alt released SHIFT"]="TOGGLE_MAGNETISM_OFF",this.inputMap["control shift released ALT"]="TOGGLE_MAGNETISM_OFF",this.inputMap["alt shift ESCAPE"]="ESCAPE",this.inputMap["control alt shift pressed ESCAPE"]="ESCAPE"),this.inputMap["shift pressed SHIFT"]="ACTIVATE_ALIGNMENT",this.inputMap["released SHIFT"]="DEACTIVATE_ALIGNMENT",OperatingSystem.isWindows()?(this.inputMap["control shift pressed SHIFT"]="ACTIVATE_ALIGNMENT",this.inputMap["control released SHIFT"]="DEACTIVATE_ALIGNMENT",this.inputMap["alt shift pressed SHIFT"]="ACTIVATE_ALIGNMENT",this.inputMap["alt released SHIFT"]="DEACTIVATE_ALIGNMENT"):OperatingSystem.isMacOSX()?(this.inputMap["alt shift pressed SHIFT"]="ACTIVATE_ALIGNMENT",this.inputMap["alt released SHIFT"]="DEACTIVATE_ALIGNMENT",this.inputMap["meta shift pressed SHIFT"]="ACTIVATE_ALIGNMENT",this.inputMap["meta released SHIFT"]="DEACTIVATE_ALIGNMENT"):(this.inputMap["control shift pressed SHIFT"]="ACTIVATE_ALIGNMENT",this.inputMap["control released SHIFT"]="DEACTIVATE_ALIGNMENT",this.inputMap["shift released ALT"]="ACTIVATE_ALIGNMENT",this.inputMap["control shift released ALT"]="ACTIVATE_ALIGNMENT");var e=this;this.canvas3D.getHTMLElement().addEventListener("keydown",(function(t){e.callAction(t,KeyStroke.getKeyStrokeForEvent(t,"keydown"))}),!1),this.canvas3D.getHTMLElement().addEventListener("keyup",(function(t){e.callAction(t,KeyStroke.getKeyStrokeForEvent(t,"keyup"))}),!1)},HomeComponent3D.prototype.callAction=function(e,t){if(void 0!==t){var i=this.inputMap[t];if(void 0!==i){var n=this.actionMap[i];void 0!==n&&n.actionPerformed(e),e.stopPropagation()}}},HomeComponent3D.prototype.createActions=function(e){function t(e){this.delta=e}function i(e){this.delta=e}function n(e){this.delta=e}function o(e){this.delta=e}function r(e){this.delta=e}t.prototype.actionPerformed=function(t){e.moveCamera(this.delta)},i.prototype.actionPerformed=function(t){e.moveCameraSideways(this.delta)},n.prototype.actionPerformed=function(t){e.elevateCamera(this.delta)},o.prototype.actionPerformed=function(t){e.rotateCameraYaw(this.delta)},r.prototype.actionPerformed=function(t){e.rotateCameraPitch(this.delta)},this.actionMap={MOVE_CAMERA_FORWARD:new t(6.5),MOVE_CAMERA_FAST_FORWARD:new t(32.5),MOVE_CAMERA_BACKWARD:new t(-6.5),MOVE_CAMERA_FAST_BACKWARD:new t(-32.5),MOVE_CAMERA_LEFT:new i(-2.5),MOVE_CAMERA_FAST_LEFT:new i(-10),MOVE_CAMERA_RIGHT:new i(2.5),MOVE_CAMERA_FAST_RIGHT:new i(10),ELEVATE_CAMERA_DOWN:new n(-2.5),ELEVATE_CAMERA_FAST_DOWN:new n(-10),ELEVATE_CAMERA_UP:new n(2.5),ELEVATE_CAMERA_FAST_UP:new n(10),ROTATE_CAMERA_YAW_LEFT:new o(-Math.PI/60),ROTATE_CAMERA_YAW_FAST_LEFT:new o(-Math.PI/12),ROTATE_CAMERA_YAW_RIGHT:new o(Math.PI/60),ROTATE_CAMERA_YAW_FAST_RIGHT:new o(Math.PI/12),ROTATE_CAMERA_PITCH_UP:new r(-Math.PI/120),ROTATE_CAMERA_PITCH_FAST_UP:new r(-Math.PI/24),ROTATE_CAMERA_PITCH_DOWN:new r(Math.PI/120),ROTATE_CAMERA_PITCH_FAST_DOWN:new r(Math.PI/24),ESCAPE:{actionPerformed:function(t){e.escape()}},ACTIVATE_ALIGNMENT:{actionPerformed:function(t){e.setAlignmentActivated(!0)}},DEACTIVATE_ALIGNMENT:{actionPerformed:function(t){e.setAlignmentActivated(!1)}},TOGGLE_MAGNETISM_ON:{actionPerformed:function(t){e.toggleMagnetism(!0)}},TOGGLE_MAGNETISM_OFF:{actionPerformed:function(t){e.toggleMagnetism(!1)}},ACTIVATE_DUPLICATION:{actionPerformed:function(t){e.setDuplicationActivated(!0)}},DEACTIVATE_DUPLICATION:{actionPerformed:function(t){e.setDuplicationActivated(!1)}}}},HomeComponent3D.prototype.getActionMap=function(){return this.actionMap},HomeComponent3D.prototype.getInputMap=function(){return this.inputMap},HomeComponent3D.prototype.getClosestItemAt=function(e,t){for(var i=this.canvas3D.getClosestShapeAt(e,t),n=-1;null!==i&&(n=this.homeObjects3D.indexOf(i))<0;)i=i.getParent();return null!=i?this.homeObjects[n]:null},HomeComponent3D.prototype.getClosestSelectableItemAt=function(e,t){var i=component3D.canvas3D.getHTMLElement().getBoundingClientRect();return this.getClosestItemAt(e+i.left,t+i.top)},HomeComponent3D.prototype.convertPixelLocationToVirtualWorldPoint=function(e,t){var i=this.canvas3D.getVirtualWorldToImageTransform(mat4.create());mat4.invert(i,i),mat4.mul(i,this.canvas3D.getViewPlatformTransform(mat4.create()),i);var n=this.getHTMLElement().getBoundingClientRect(),o=vec3.fromValues(2*(e/n.width-.5),2*(.5-t/n.height),0);return vec3.transformMat4(o,o,i),o},HomeComponent3D.prototype.convertPixelLocationToVirtualWorld=function(e,t){var i=this.convertPixelLocationToVirtualWorldPoint(e,t);return[i[0],i[2],i[1]]},HomeComponent3D.prototype.getVirtualWorldPointAt=function(e,t,i){var n=this.convertPixelLocationToVirtualWorldPoint(e,t),o=this.home.getCamera(),r=vec3.fromValues(o.getX(),o.getZ(),o.getY()),l=vec3.sub(vec3.fromValues(0,0,0),n,r);l[1]>0&&(l[1]=-l[1]);var a=(i-n[1])/l[1];return[n[0]+a*l[0],n[2]+a*l[2],i]},HomeComponent3D.prototype.createSceneTree=function(e,t){var i=new Group3D;i.addChild(this.createBackgroundNode(e,t));var n=this.createGroundNode(-5e4,-5e4,1e5,1e5,e,t);i.addChild(n),i.addChild(this.createHomeTree(e,t)),this.sceneLights=this.createLights(e);for(var o=0;o<this.sceneLights.length;o++)i.addChild(this.sceneLights[o]);return i},HomeComponent3D.prototype.createBackgroundNode=function(e,t){var i=new Appearance3D,n=new Shape3D(this.createHalfSphereGeometry(!0),i),o=new BranchGroup3D;o.addChild(n),o.addChild(new Shape3D(this.createHalfSphereGeometry(!1)));var r=new Appearance3D,l=new Shape3D(new IndexedTriangleArray3D([vec3.fromValues(-1,-.01,-1),vec3.fromValues(-1,-.01,1),vec3.fromValues(1,-.01,1),vec3.fromValues(1,-.01,-1)],[0,1,2,0,2,3],[],[],[vec3.fromValues(0,1,0)],[0,0,0,0,0,0]),r);o.addChild(l);var a=new Background3D(o);if(this.updateBackgroundColorAndTexture(i,r,this.home,t),r.setVisible(this.home.getCamera().getZ()>=0),e){var s=this;this.backgroundChangeListener=function(e){s.updateBackgroundColorAndTexture(i,r,s.home,t)},s.home.getEnvironment().addPropertyChangeListener("SKY_COLOR",this.backgroundChangeListener),s.home.getEnvironment().addPropertyChangeListener("SKY_TEXTURE",this.backgroundChangeListener),s.home.getEnvironment().addPropertyChangeListener("GROUND_COLOR",this.backgroundChangeListener),s.home.getEnvironment().addPropertyChangeListener("GROUND_TEXTURE",this.backgroundChangeListener),this.elevationChangeListener=function(e){e.getSource()===s.home&&(e.getOldValue().removePropertyChangeListener(s.elevationChangeListener),s.home.getCamera().addPropertyChangeListener(s.elevationChangeListener)),e.getSource()!==s.home&&"Z"!==e.getPropertyName()||r.setVisible(s.home.getCamera().getZ()>=0)},this.home.getCamera().addPropertyChangeListener(this.elevationChangeListener),this.home.addPropertyChangeListener("CAMERA",this.elevationChangeListener)}return a},HomeComponent3D.prototype.createHalfSphereGeometry=function(e){for(var t=48,i=[],n=[],o=[],r=0,l=0;r<t;r++)for(var a=2*r*Math.PI/t,s=Math.cos(a),h=Math.sin(a),u=2*(r+1)*Math.PI/t,d=Math.cos(u),c=Math.sin(u),p=0;p<12;p++,l+=4){var g=2*p*Math.PI/t,m=Math.cos(g),f=Math.sin(g),v=0!==p?e?f:-f:-.01,_=2*(p+1)*Math.PI/t;e||(_=-_);var S=Math.cos(_),y=Math.sin(_);i.push(vec3.fromValues(s*m,v,h*m)),i.push(vec3.fromValues(d*m,v,c*m)),i.push(vec3.fromValues(d*S,y,c*S)),i.push(vec3.fromValues(s*S,y,h*S)),e?(n.push(l),n.push(l+1),n.push(l+2),n.push(l),n.push(l+2),n.push(l+3),o.push(vec2.fromValues(r/t,p/12)),o.push(vec2.fromValues((r+1)/t,p/12)),o.push(vec2.fromValues((r+1)/t,(p+1)/12)),o.push(vec2.fromValues(r/t,(p+1)/12))):(n.push(l),n.push(l+2),n.push(l+1),n.push(l),n.push(l+3),n.push(l+2))}return new IndexedTriangleArray3D(i,n,o,n,[],[])},HomeComponent3D.prototype.updateBackgroundColorAndTexture=function(e,t,i,n){var o=i.getEnvironment().getSkyColor();e.setDiffuseColor(vec3.fromValues((o>>>16&255)/255,(o>>>8&255)/255,(255&o)/255));var r=i.getEnvironment().getSkyTexture();if(null!==r){var l=mat3.create();mat3.fromTranslation(l,vec2.fromValues(-r.getXOffset(),0)),TextureManager.getInstance().loadTexture(r.getImage(),0,n,{textureUpdated:function(t){e.setTextureImage(t),e.setTextureTransform(l)},textureError:function(e){return this.textureUpdated(TextureManager.getInstance().getErrorImage())}})}else e.setTextureImage(null);var a=i.getEnvironment().getGroundColor(),s=vec3.fromValues((a>>>16&255)/255,(a>>>8&255)/255,(255&a)/255);t.setDiffuseColor(s),t.setAmbientColor(s);var h=i.getEnvironment().getGroundTexture();null!==h?TextureManager.getInstance().loadTexture(h.getImage(),0,n,{textureUpdated:function(e){t.setTextureImage(e),t.setTextureCoordinatesGeneration({planeS:vec4.fromValues(1e5,0,0,0),planeT:vec4.fromValues(0,0,1e5,0)})},textureError:function(e){return this.textureUpdated(TextureManager.getInstance().getErrorImage())}}):t.setTextureImage(null)},HomeComponent3D.prototype.createGroundNode=function(e,t,i,n,o,r){if(this.home.structure){var l=new BranchGroup3D;return l.setCapability(Group3D.ALLOW_CHILDREN_EXTEND),ModelManager.getInstance().loadModel(this.home.structure,r,{modelUpdated:function(e){l.addChild(e)},modelError:function(e){var t=new Appearance3D;t.setDiffuseColor(vec3.fromValues(1,0,0)),l.addChild(new Box3D(1e7,0,1e7,t))}}),this.groundChangeListener=function(e){},l}var a=void 0!==Ground3D?new Ground3D(this.home,e,t,i,n,r):new Box3D(1e7,0,1e7,new Appearance3D),s=mat4.create();mat4.translate(s,s,vec3.fromValues(0,-.2,0));var h=new TransformGroup3D(s);if(h.addChild(a),o){var u=this;this.groundChangeListener=function(e){u.groundChangeListener.updater||(u.groundChangeListener.updater=function(){a.update(),delete u.groundChangeListener.updater},setTimeout(u.groundChangeListener.updater,0))};var d=this.home.getEnvironment();d.addPropertyChangeListener("GROUND_COLOR",this.groundChangeListener),d.addPropertyChangeListener("BACKGROUND_IMAGE_VISIBLE_ON_GROUND_3D",this.groundChangeListener),d.addPropertyChangeListener("GROUND_TEXTURE",this.groundChangeListener),this.home.addPropertyChangeListener("BACKGROUND_IMAGE",this.groundChangeListener)}return h},HomeComponent3D.prototype.createLights=function(e){for(var t=[new DirectionalLight3D(vec3.fromValues(.9,.9,.9),vec3.fromValues(1.5,-.8,-1)),new DirectionalLight3D(vec3.fromValues(.9,.9,.9),vec3.fromValues(-1.5,-.8,-1)),new DirectionalLight3D(vec3.fromValues(.9,.9,.9),vec3.fromValues(0,-.8,1)),new DirectionalLight3D(vec3.fromValues(.7,.7,.7),vec3.fromValues(0,1,0)),new AmbientLight3D(vec3.fromValues(.2,.2,.2))],i=0;i<t.length-1;i++)t[i].defaultColor=t[i].getColor(),this.updateLightColor(t[i]);if(e){var n=this;this.lightColorListener=function(e){for(var i=0;i<t.length-1;i++)n.updateLightColor(t[i])},this.home.getEnvironment().addPropertyChangeListener("LIGHT_COLOR",this.lightColorListener)}return t},HomeComponent3D.prototype.updateLightColor=function(e){var t=e.defaultColor,i=this.home.getEnvironment().getLightColor();e.setColor(vec3.fromValues((i>>>16&255)/255*t[0],(i>>>8&255)/255*t[1],(255&i)/255*t[2]))},HomeComponent3D.prototype.createHomeTree=function(e,t){var i=new BranchGroup3D;i.setCapability(Group3D.ALLOW_CHILDREN_EXTEND);for(var n=this.home.getLabels(),o=0;o<n.length;o++)this.addObject(i,n[o],e,t);var r=this.home.getDimensionLines();for(o=0;o<r.length;o++)this.addObject(i,r[o],e,t);var l=this.home.getPolylines();for(o=0;o<l.length;o++)this.addObject(i,l[o],e,t);var a=this.home.getRooms();for(o=0;o<a.length;o++)this.addObject(i,a[o],e,t);var s=this.home.getWalls();for(o=0;o<s.length;o++)this.addObject(i,s[o],e,t);var h=this.home.getFurniture();for(o=0;o<h.length;o++){var u=h[o];if(u instanceof HomeFurnitureGroup)for(var d=u.getAllFurniture(),c=0;c<d.length;c++){var p=d[c];p instanceof HomeFurnitureGroup||this.addObject(i,p,e,t)}else this.addObject(i,u,e,t)}return e&&(this.addLevelListener(i),this.addWallListener(i),this.addFurnitureListener(i),this.addRoomListener(i),this.addPolylineListener(i),this.addDimensionLineListener(i),this.addLabelListener(i),this.addEnvironmentListeners(),component3D=this,this.selectionListener={selectionChanged:function(e){component3D.updateObjectsAndFurnitureGroups(e.getOldSelectedItems()),component3D.updateObjectsAndFurnitureGroups(e.getSelectedItems())}},this.home.addSelectionListener(this.selectionListener)),i},HomeComponent3D.prototype.addLevelListener=function(e){var t=this;this.levelChangeListener=function(e){var i=e.getPropertyName();if("VISIBLE"==i||"VIEWABLE"==i){for(var n=t.homeObjects,o=[],r=0;r<n.length;r++){var l=n[r];(l instanceof Room||void 0!==l.isAtLevel||l.isAtLevel(e.getSource()))&&o.push(l)}t.updateObjects(o),t.groundChangeListener(null)}else"ELEVATION"==i||"ELEVATION_INDEX"==i?(t.updateObjects(t.homeObjects.slice(0)),t.groundChangeListener(null)):"BACKGROUND_IMAGE"==i?t.groundChangeListener(null):"FLOOR_THICKNESS"==i?(t.updateObjects(t.home.getWalls()),t.updateObjects(t.home.getRooms())):"HEIGHT"==i&&t.updateObjects(t.home.getRooms())};for(var i=this.home.getLevels(),n=0;n<i.length;n++)i[n].addPropertyChangeListener(this.levelChangeListener);this.levelListener=function(e){var i=e.getItem();switch(e.getType()){case CollectionEvent.Type.ADD:i.addPropertyChangeListener(t.levelChangeListener);break;case CollectionEvent.Type.DELETE:i.removePropertyChangeListener(t.levelChangeListener)}t.updateObjects(t.home.getRooms())},this.home.addLevelsListener(this.levelListener)},HomeComponent3D.prototype.addWallListener=function(e){var t=this;this.wallChangeListener=function(e){if("PATTERN"!=e.getPropertyName()){var i=e.getSource();t.updateWall(i);var n=t.home.getLevels();(null===i.getLevel()||i.isAtLevel(n[n.length-1]))&&t.updateObjects(t.home.getRooms()),null!=i.getLevel()&&i.getLevel().getElevation()<0&&t.groundChangeListener(null)}};for(var i=this.home.getWalls(),n=0;n<i.length;n++)i[n].addPropertyChangeListener(this.wallChangeListener);this.wallListener=function(i){var n=i.getItem();switch(i.getType()){case CollectionEvent.Type.ADD:t.addObject(e,n,!0,!1),n.addPropertyChangeListener(t.wallChangeListener);break;case CollectionEvent.Type.DELETE:t.deleteObject(n),n.removePropertyChangeListener(t.wallChangeListener)}t.updateObjects(t.home.getRooms()),t.groundChangeListener(null)},this.home.addWallsListener(this.wallListener)},HomeComponent3D.prototype.addFurnitureListener=function(e){var t=this,i=function(e,i,n){if(t.updateObjects([e]),t.containsDoorsAndWindows(e)){if(null!==n){var o=e.clone();"X"==i?o.setX(n):"Y"==i?o.setY(n):"ANGLE"==i?o.setAngle(n):"WIDTH"==i?o.setWidth(n):"DEPTH"==i&&o.setDepth(n),t.updateIntersectingWalls([o,e])}else t.updateIntersectingWalls([e]);t.updateObjects(t.home.getWalls())}else t.containsStaircases(e)&&t.updateObjects(t.home.getRooms());null!==e.getLevel()&&e.getLevel().getElevation()<0&&t.groundChangeListener(null)};this.furnitureChangeListener=function(e){var n=e.getSource(),o=e.getPropertyName();"X"==o||"Y"==o||"ANGLE"==o||"ROLL"==o||"PITCH"==o||"WIDTH"==o||"DEPTH"==o?i(n,o,e.getOldValue()):"HEIGHT"==o||"ELEVATION"==o||"MODEL"==o||"MODEL_ROTATION"==o||"MODEL_MIRRORED"==o||"MODEL_FLAGS"==o||"MODEL_TRANSFORMATIONS"==o||"STAIRCASE_CUT_OUT_SHAPE"==o||"VISIBLE"==o||"LEVEL"==o?i(n,null,null):"CUT_OUT_SHAPE"==o||"WALL_CUT_OUT_ON_BOTH_SIDES"==o||"WALL_WIDTH"==o||"WALL_LEFT"==o||"WALL_HEIGHT"==o||"WALL_TOP"==o?t.containsDoorsAndWindows(n)&&t.updateIntersectingWalls([n]):("COLOR"==o||"TEXTURE"==o||"MODEL_MATERIALS"==o||"SHININESS"==o||"POWER"==o&&t.home.getEnvironment().getSubpartSizeUnderLight()>0)&&t.updateObjects([n])};for(var n=this.home.getFurniture(),o=0;o<n.length;o++)this.addPropertyChangeListener(n[o],this.furnitureChangeListener);this.furnitureListener=function(i){var n=i.getItem();switch(i.getType()){case CollectionEvent.Type.ADD:t.addPieceOfFurniture(e,n,!0,!1),t.addPropertyChangeListener(n,t.furnitureChangeListener);break;case CollectionEvent.Type.DELETE:t.deletePieceOfFurniture(n),t.removePropertyChangeListener(n,t.furnitureChangeListener)}t.containsDoorsAndWindows(n)?t.updateIntersectingWalls([n]):t.containsStaircases(n)?t.updateObjects(t.home.getRooms()):(t.approximateHomeBoundsCache=null,t.homeHeightCache=null),t.groundChangeListener(null)},this.home.addFurnitureListener(this.furnitureListener)},HomeComponent3D.prototype.addPropertyChangeListener=function(e,t){if(e instanceof HomeFurnitureGroup)for(var i=e.getFurniture(),n=0;n<i.length;n++)this.addPropertyChangeListener(i[n],t);else e.addPropertyChangeListener(t)},HomeComponent3D.prototype.removePropertyChangeListener=function(e,t){if(e instanceof HomeFurnitureGroup)for(var i=e.getFurniture(),n=0;n<i.length;n++)this.removePropertyChangeListener(i[n],t);else e.removePropertyChangeListener(t)},HomeComponent3D.prototype.containsDoorsAndWindows=function(e){if(e instanceof HomeFurnitureGroup){for(var t=e.getFurniture(),i=0;i<t.length;i++)if(this.containsDoorsAndWindows(t[i]))return!0;return!1}return e.isDoorOrWindow()},HomeComponent3D.prototype.containsStaircases=function(e){if(e instanceof HomeFurnitureGroup){for(var t=e.getFurniture(),i=0;i<t.length;i++)if(this.containsStaircases(t[i]))return!0;return!1}return null!==e.getStaircaseCutOutShape()},HomeComponent3D.prototype.addRoomListener=function(e){var t=this;this.roomChangeListener=function(e){var i=e.getSource(),n=e.getPropertyName();if("FLOOR_COLOR"==n||"FLOOR_TEXTURE"==n||"FLOOR_SHININESS"==n||"CEILING_COLOR"==n||"CEILING_TEXTURE"==n||"CEILING_SHININESS"==n||"CEILING_FLAT"==n)t.updateObjects([i]);else if("FLOOR_VISIBLE"==n||"CEILING_VISIBLE"==n||"LEVEL"==n)t.updateObjects(t.home.getRooms()),t.groundChangeListener(null);else if("POINTS"==n){if(t.homeObjectsToUpdate)t.updateObjects(t.home.getRooms());else{t.updateObjects([i]);for(var o=new java.awt.geom.Area(t.getShape(e.getOldValue())),r=new java.awt.geom.Area(t.getShape(e.getNewValue())),l=i.getLevel(),a=t.home.getRooms(),s=0;s<a.length;s++){var h=a[s],u=h.getLevel();if(h!=i&&(null==u||Math.abs(l.getElevation()+l.getHeight()-(u.getElevation()+u.getHeight()))<1e-5||Math.abs(l.getElevation()+l.getHeight()-(u.getElevation()-u.getFloorThickness()))<1e-5)){var d=new java.awt.geom.Area(t.getShape(h.getPoints())),c=new java.awt.geom.Area(d);c.intersect(r),c.isEmpty()?(d.intersect(o),d.isEmpty()||t.updateObjects([h])):t.updateObjects([h])}}}t.groundChangeListener(null)}};for(var i=this.home.getRooms(),n=0;n<i.length;n++)i[n].addPropertyChangeListener(this.roomChangeListener);this.roomListener=function(i){var n=i.getItem();switch(i.getType()){case CollectionEvent.Type.ADD:t.addObject(e,n,i.getIndex(),!0,!1),n.addPropertyChangeListener(t.roomChangeListener);break;case CollectionEvent.Type.DELETE:t.deleteObject(n),n.removePropertyChangeListener(t.roomChangeListener)}t.updateObjects(t.home.getRooms()),t.groundChangeListener(null)},this.home.addRoomsListener(this.roomListener)},HomeComponent3D.prototype.getShape=function(e){var t=new java.awt.geom.GeneralPath;t.moveTo(e[0][0],e[0][1]);for(var i=1;i<e.length;i++)t.lineTo(e[i][0],e[i][1]);return t.closePath(),t},HomeComponent3D.prototype.addPolylineListener=function(e){var t=this;this.polylineChangeListener=function(e){var i=e.getSource();t.updateObjects([i])};for(var i=this.home.getPolylines(),n=0;n<i.length;n++)i[n].addPropertyChangeListener(this.polylineChangeListener);this.polylineListener=function(i){var n=i.getItem();switch(i.getType()){case CollectionEvent.Type.ADD:t.addObject(e,n,!0,!1),n.addPropertyChangeListener(t.polylineChangeListener);break;case CollectionEvent.Type.DELETE:t.deleteObject(n),n.removePropertyChangeListener(t.polylineChangeListener)}},this.home.addPolylinesListener(this.polylineListener)},HomeComponent3D.prototype.addDimensionLineListener=function(e){var t=this;this.dimensionLineChangeListener=function(e){var i=e.getSource();t.updateObjects([i])};for(var i=this.home.getDimensionLines(),n=0;n<i.length;n++)i[n].addPropertyChangeListener(this.dimensionLineChangeListener);this.dimensionLineListener=function(i){var n=i.getItem();switch(i.getType()){case CollectionEvent.Type.ADD:t.addObject(e,n,!0,!1),n.addPropertyChangeListener(t.dimensionLineChangeListener);break;case CollectionEvent.Type.DELETE:t.deleteObject(n),n.removePropertyChangeListener(t.dimensionLineChangeListener)}},this.home.addDimensionLinesListener(this.dimensionLineListener)},HomeComponent3D.prototype.addLabelListener=function(e){var t=this;this.labelChangeListener=function(e){var i=e.getSource();t.updateObjects([i])};for(var i=this.home.getLabels(),n=0;n<i.length;n++)i[n].addPropertyChangeListener(this.labelChangeListener);this.labelListener=function(i){var n=i.getItem();switch(i.getType()){case CollectionEvent.Type.ADD:t.addObject(e,n,!0,!1),n.addPropertyChangeListener(t.labelChangeListener);break;case CollectionEvent.Type.DELETE:t.deleteObject(n),n.removePropertyChangeListener(t.labelChangeListener)}},this.home.addLabelsListener(this.labelListener)},HomeComponent3D.prototype.addEnvironmentListeners=function(){var e=this;this.wallsAlphaListener=function(t){e.updateObjects(e.home.getWalls()),e.updateObjects(e.home.getRooms())},this.home.getEnvironment().addPropertyChangeListener("WALLS_ALPHA",this.wallsAlphaListener)},HomeComponent3D.prototype.addObject=function(e,t,i,n,o){void 0===o&&(o=n,n=i,i=-1);var r=this.object3dFactory.createObject3D(this.home,t,o);return n&&(t.object3D=r,this.homeObjects.push(t),this.homeObjects3D.push(r)),-1===i?e.addChild(r):e.insertChild(r,i),r},HomeComponent3D.prototype.addPieceOfFurniture=function(e,t,i,n){if(t instanceof HomeFurnitureGroup)for(var o=t.getFurniture(),r=0;r<o.length;r++)this.addPieceOfFurniture(e,o[r],i,n);else this.addObject(e,t,i,n)},HomeComponent3D.prototype.deleteObject=function(e){if(e.object3D){e.object3D.detach(),delete e.object3D;var t=this.homeObjects.indexOf(e);if(this.homeObjects.splice(t,1),this.homeObjects3D.splice(t,1),this.homeObjectsToUpdate){var i=this.homeObjectsToUpdate.indexOf(e);i>=0&&this.homeObjectsToUpdate.splice(i,1)}}},HomeComponent3D.prototype.deletePieceOfFurniture=function(e){if(e instanceof HomeFurnitureGroup)for(var t=e.getFurniture(),i=0;i<t.length;i++)this.deletePieceOfFurniture(t[i]);else this.deleteObject(e)},HomeComponent3D.prototype.updateObjects=function(e){if(this.homeObjectsToUpdate)for(var t=0;t<e.length;t++){var i=e[t];this.homeObjectsToUpdate.indexOf(i)<=-1&&this.homeObjectsToUpdate.push(i)}else this.homeObjectsToUpdate=e.slice(0),setTimeout((function(e){for(var t=0;t<e.homeObjectsToUpdate.length;t++){var i=e.homeObjectsToUpdate[t];i.object3D&&i.object3D.update()}delete e.homeObjectsToUpdate}),0,this);this.approximateHomeBoundsCache=null,this.homeHeightCache=null},HomeComponent3D.prototype.updateObjectsAndFurnitureGroups=function(e){this.updateObjects(e);for(var t=0;t<e.length;t++){var i=e[t];i instanceof HomeFurnitureGroup&&this.updateObjects(i.getAllFurniture())}},HomeComponent3D.prototype.updateIntersectingWalls=function(e){var t=this.home.getWalls(),i=0;if(this.homeObjectsToUpdate)for(var n=0;n<this.homeObjectsToUpdate.length;n++)this.homeObjectsToUpdate[n]instanceof Wall&&i++;if(i!==t.length){var o=[],r=null;for(n=0;n<e.length;n++){var l=e[n].getPoints();null===r?r=new java.awt.geom.Rectangle2D.Float(l[0][0],l[0][1],0,0):r.add(l[0][0],l[0][1]);for(var a=1;a<l.length;a++)r.add(l[a][0],l[a][1])}for(n=0;n<t.length;n++){var s=t[n];s.intersectsRectangle(r.getX(),r.getY(),r.getX()+r.getWidth(),r.getY()+r.getHeight())&&o.push(s)}this.updateObjects(o)}},HomeComponent3D.prototype.updateWall=function(e){var t=[];t.push(e),null!=e.getWallAtStart()&&t.push(e.getWallAtStart()),null!=e.getWallAtEnd()&&t.push(e.getWallAtEnd()),this.updateObjects(t)},Object3DBranchFactory.prototype.createObject3D=function(e,t,i){return t instanceof HomePieceOfFurniture?new HomePieceOfFurniture3D(t,e,this.preferences,i):t instanceof Wall?new Wall3D(t,e,this.preferences,i):t instanceof Room?new Room3D(t,e,this.preferences,!1,i):t instanceof Polyline?new Polyline3D(t,e,this.preferences,i):t instanceof DimensionLine?new DimensionLine3D(t,e,this.preferences,i):t instanceof Label?new Label3D(t,e,this.preferences,i):new Group3D},Object3DBranch.prototype=Object.create(BranchGroup3D.prototype),Object3DBranch.prototype.constructor=Object3DBranch,Object3DBranch.DEFAULT_COLOR=16777215,Object3DBranch.DEFAULT_AMBIENT_COLOR=3355443,Object3DBranch.prototype.getHome=function(){return void 0!==this.home?this.home:null},Object3DBranch.prototype.getUserPreferences=function(){return void 0!==this.userPreferences?this.userPreferences:null},Object3DBranch.prototype.getShape=function(e){return ShapeTools.getShape(e,!0,null)},Object3DBranch.prototype.updateAppearanceMaterial=function(e,t,i,n){null!==t?(e.setAmbientColor(vec3.fromValues((i>>>16&255)/255,(i>>>8&255)/255,(255&i)/255)),e.setDiffuseColor(vec3.fromValues((t>>>16&255)/255,(t>>>8&255)/255,(255&t)/255)),e.setSpecularColor(vec3.fromValues(n,n,n)),e.setShininess(Math.max(1,128*n))):(e.setAmbientColor(vec3.fromValues(.2,.2,.2)),e.setDiffuseColor(vec3.fromValues(1,1,1)),e.setSpecularColor(vec3.fromValues(n,n,n)),e.setShininess(Math.max(1,128*n)))},Object3DBranch.prototype.updateTextureTransform=function(e,t,i){var n=t.getWidth(),o=t.getHeight();-1!==n&&-1!==o||(n=100,o=100);var r=t.getXOffset(),l=t.getYOffset(),a=1/t.getScale(),s=mat3.create();mat3.rotate(s,s,t.getAngle());var h=mat3.create(),u=mat3.create();i?(mat3.fromTranslation(h,vec2.fromValues(-r/a*n,-l/a*o)),mat3.scale(u,u,vec2.fromValues(a/n,a/o))):(mat3.fromTranslation(h,vec2.fromValues(-r/a,-l/a)),mat3.multiplyScalar(u,u,a)),mat3.mul(s,s,h),mat3.mul(u,u,s),e.setTextureTransform(u)},Object3DBranch.prototype.updateTextureTransformFittingArea=function(e,t,i,n){for(var o=Number.POSITIVE_INFINITY,r=Number.POSITIVE_INFINITY,l=Number.NEGATIVE_INFINITY,a=Number.NEGATIVE_INFINITY,s=0;s<i.length;s++)o=Math.min(o,i[s][0]),r=Math.min(r,i[s][1]),l=Math.max(l,i[s][0]),a=Math.max(a,i[s][1]);(l-o<=0||a-r<=0)&&this.updateTextureTransform(e,t,!0);var h=mat3.create();mat3.fromTranslation(h,vec2.fromValues(-o,n?r:-r));var u=mat3.create();mat3.scale(u,u,vec2.fromValues(1/(l-o),1/(a-r))),mat3.mul(u,u,h),e.setTextureTransform(u)},Object3DBranch.prototype.getSelectionAppearance=function(){var e=new Appearance3D;return e.setCullFace(Appearance3D.CULL_NONE),e.setIllumination(0),e.setDiffuseColor(vec3.fromValues(0,0,.7102)),e},Object3DBranch.prototype.getAreaPoints=function(e,t,i,n,o){void 0===n&&void 0===o&&(n=t,o=i,t=null,i=null);for(var r=[],l=[],a=null,s=null,h=e.getPathIterator(null,n);!h.isDone();h.next()){var u=[0,0];switch(h.currentSegment(u)){case java.awt.geom.PathIterator.SEG_MOVETO:(a=[]).push(u),s=u;break;case java.awt.geom.PathIterator.SEG_LINETO:u[0]===s[0]&&u[1]===s[1]||a.push(u),s=u;break;case java.awt.geom.PathIterator.SEG_CLOSE:var d=a[0];if(d[0]===s[0]&&d[1]===s[1]&&a.splice(a.length-1,1),a.length>2){var c=a,p=new Room(c);if(p.getArea()>0){var g=p.isClockwise();g?l.push(a):r.push(a),null===t&&null===i||(g!==o&&(c=a.slice(0)).reverse(),g?null!=i&&i.push(c):null!=t&&t.push(c))}}}}var m=[];if(0===l.length&&null!==t)m.push.apply(m,t);else if(0===r.length&&0!==l.length)null!==i&&(i.length=0);else{var f,v=[];if(r.length>1){f=[];for(var _=0;0!==r.length;){for(var S=r[_],y=0;y<r.length;y++)if(_!==y){for(var E=r[y],C=null,P=0;P<v.length;P++)if(v[P].key===E){C=v[P].value;break}if(null==C&&(C=new java.awt.geom.Area(this.getShape(E.slice(0))),v.push({key:E,value:C})),C.contains(S[0][0],S[0][1]))break}y===r.length?(r.splice(_,1),f.push(S),_=0):_<r.length?_++:_=0}}else f=r;for(_=f.length-1;_>=0;_--){var w=f[_];for(C=null,P=0;P<v.length;P++)if(v[P].key===w){C=v[P].value;break}null===C&&(C=new java.awt.geom.Area(this.getShape(w.slice(0))));var L=[];for(P=0;P<l.length;P++){var T=l[P];C.contains(T[0][0],T[0][1])&&L.push(T)}for(var A=null;0!==L.length;){var I=Number.MAX_VALUE,b=0,O=0,M=0;for(y=0;y<L.length&&I>0;y++)for(T=L[y],P=0;P<T.length&&I>0;P++)for(var D=0;D<w.length&&I>0;D++){var R=w[D],F=java.awt.geom.Point2D.distanceSq(T[P][0],T[P][1],R[0],R[1]);F<I&&A!==R&&(I=F,b=y,O=P,M=D)}var x=L[b];0!==I&&(A=w[M],w.splice(M,0,A),w.splice(++M,0,x[O]));var N=x.slice(O,x.length);for(P=0;P<N.length;P++,M++)w.splice(M,0,N[P]);var k=x.slice(0,O);for(P=0;P<k.length;P++,M++)w.splice(M,0,k[P]);L.splice(b,1),l.splice(x,1)}}for(P=0;P<f.length;P++){var H=f[P];o&&H.reverse(),m.push(H.slice(0))}}return m},Object3DBranch.areModelRotationsEqual=function(e,t){if(e===t)return!0;if(null==e||null==t)return!1;for(var i=0;i<e.length;i++)for(var n=0;n<t.length;n++)if(e[i][n]!==t[i][n])return!1;return!0},HomePieceOfFurniture3D.prototype=Object.create(Object3DBranch.prototype),HomePieceOfFurniture3D.prototype.constructor=HomePieceOfFurniture3D,HomePieceOfFurniture3D.DEFAULT_BOX=new Object,HomePieceOfFurniture3D.SELECTION_BOX_GEOMETRY=new IndexedLineArray3D([vec3.fromValues(-.5,-.5,-.5),vec3.fromValues(.5,-.5,-.5),vec3.fromValues(.5,.5,-.5),vec3.fromValues(-.5,.5,-.5),vec3.fromValues(-.5,-.5,.5),vec3.fromValues(.5,-.5,.5),vec3.fromValues(.5,.5,.5),vec3.fromValues(-.5,.5,.5)],[0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7,4,6,5,7]),HomePieceOfFurniture3D.prototype.createPieceOfFurnitureNode=function(e,t){var i=new TransformGroup3D;i.setCapability(Group3D.ALLOW_CHILDREN_EXTEND),i.setCapability(TransformGroup3D.ALLOW_TRANSFORM_WRITE),this.addChild(i),this.loadPieceOfFurnitureModel(t)},HomePieceOfFurniture3D.prototype.loadPieceOfFurnitureModel=function(e){var t=new BranchGroup3D,i=new TransformGroup3D;i.addChild(this.getModelBox(vec3.fromValues(1,1,1))),i.setUserData(PieceOfFurniture.IDENTITY_ROTATION),t.addChild(i);var n=this.getChild(0);n.removeAllChildren(),n.addChild(t),this.updatePieceOfFurnitureTransform();var o=this.getUserData(),r=o.getModel();n.setUserData(r);var l=this;ModelManager.getInstance().loadModel(r,"function"!=typeof e&&e,{modelUpdated:function(t){l.updateModelTransformations(t);var i=o.getModelRotation(),n=ModelManager.getInstance().getNormalizedTransformGroup(t,i,1,o.isModelCenteredAtOrigin());n.setUserData(i),l.updatePieceOfFurnitureModelNode(t,n,e)},modelError:function(t){l.updatePieceOfFurnitureModelNode(l.getModelBox(vec3.fromValues(1,0,0)),new TransformGroup3D,e)}})},HomePieceOfFurniture3D.prototype.update=function(){if(this.isVisible()){var e=this.getUserData(),t=this.getChild(0),i=t.getChild(0).getChild(0);e.getModel().equals(t.getUserData())&&Object3DBranch.areModelRotationsEqual(e.getModelRotation(),i.getUserData())?(this.updatePieceOfFurnitureModelTransformations(),this.updatePieceOfFurnitureTransform(),this.updatePieceOfFurnitureColorAndTexture(!1)):this.loadPieceOfFurnitureModel(!1)}this.updatePieceOfFurnitureVisibility()},HomePieceOfFurniture3D.prototype.updatePieceOfFurnitureTransform=function(){var e=this.getChild(0),t=ModelManager.getInstance().getPieceOfFurnitureNormalizedModelTransformation(this.getUserData(),e.getChild(0).getChild(0));e.setTransform(t)},HomePieceOfFurniture3D.prototype.updatePieceOfFurnitureColorAndTexture=function(e){var t=this.getUserData(),i=this.getModelNode(),n=i.getChild(0);n.getUserData()!==HomePieceOfFurniture3D.DEFAULT_BOX&&(null!==t.getColor()?this.setColorAndTexture(i,t.getColor(),null,t.getShininess(),null,t.isModelMirrored(),t.getModelFlags(),!1,null,null,[]):null!==t.getTexture()?this.setColorAndTexture(i,null,t.getTexture(),t.getShininess(),null,t.isModelMirrored(),t.getModelFlags(),e,vec3.fromValues(t.getWidth(),t.getHeight(),t.getDepth()),ModelManager.getInstance().getBounds(n),[]):null!==t.getModelMaterials()?this.setColorAndTexture(i,null,null,null,t.getModelMaterials(),t.isModelMirrored(),t.getModelFlags(),e,vec3.fromValues(t.getWidth(),t.getHeight(),t.getDepth()),ModelManager.getInstance().getBounds(n),[]):this.setColorAndTexture(i,null,null,t.getShininess(),null,t.isModelMirrored(),t.getModelFlags(),!1,null,null,[]))},HomePieceOfFurniture3D.prototype.getModelNode=function(){return this.getChild(0).getChild(0).getChild(0)},HomePieceOfFurniture3D.prototype.getSelectionNode=function(){var e=this.getChild(0).getChild(0);return e.getChildren().length>1&&e.getChild(1)instanceof Shape3D?e.getChild(1):null},HomePieceOfFurniture3D.prototype.updatePieceOfFurnitureVisibility=function(){var e=this.getUserData(),t=this.isVisible(),i=null===e.getColor()&&null===e.getTexture()?e.getModelMaterials():null;this.setVisible(this.getModelNode(),t,e.getModelFlags(),i);var n=this.getSelectionNode();null!=n&&this.setVisible(n,null!=this.getUserPreferences()&&this.getUserPreferences().isEditingIn3DViewEnabled()&&t&&null!=this.getHome()&&this.isSelected(this.getHome().getSelectedItems()),0,null)},HomePieceOfFurniture3D.prototype.updatePieceOfFurnitureModelTransformations=function(){var e=this.getUserData(),t=this.getModelNode();if(t.getChild(0).getUserData()!==HomePieceOfFurniture3D.DEFAULT_BOX&&this.updateModelTransformations(this)){var i=ModelManager.getInstance().getNormalizedTransform(t.getChild(0),e.getModelRotation(),1,e.isModelCenteredAtOrigin());t.setTransform(i)}},HomePieceOfFurniture3D.prototype.updateModelTransformations=function(e){var t=!1,i=this.getUserData().getModelTransformations(),n=null;if(null!==i)for(var o=0;o<i.length;o++){var r=i[o],l=r.getName()+ModelManager.DEFORMABLE_TRANSFORM_GROUP_SUFFIX;null===n&&(n=[]),n.push(l),t|=this.updateTransformation(e,l,r.getMatrix())}return t|=this.setNotUpdatedTranformationsToIdentity(e,n)},HomePieceOfFurniture3D.prototype.updateTransformation=function(e,t,i){var n=!1;if(e instanceof Group3D)if(e instanceof TransformGroup3D&&t==e.getName()){var o=mat4.create();e.getTransform(o),i[0][0]===o[0]&&i[0][1]===o[4]&&i[0][2]===o[8]&&i[0][3]===o[12]&&i[1][0]===o[1]&&i[1][1]===o[5]&&i[1][2]===o[9]&&i[1][3]===o[13]&&i[2][0]===o[2]&&i[2][1]===o[6]&&i[2][2]===o[10]&&i[2][3]===o[14]||(mat4.set(o,i[0][0],i[1][0],i[2][0],0,i[0][1],i[1][1],i[2][1],0,i[0][2],i[1][2],i[2][2],0,i[0][3],i[1][3],i[2][3],1),e.setTransform(o),n=!0)}else for(var r=e.getChildren(),l=0;l<r.length;l++)n|=this.updateTransformation(r[l],t,i);return n},HomePieceOfFurniture3D.prototype.setNotUpdatedTranformationsToIdentity=function(e,t){var i=!1;if(e instanceof Group3D){if(e instanceof TransformGroup3D&&null!==e.getName()&&e.getName().indexOf(ModelManager.DEFORMABLE_TRANSFORM_GROUP_SUFFIX)>=0&&e.getName().indexOf(ModelManager.DEFORMABLE_TRANSFORM_GROUP_SUFFIX)===e.getName().length-ModelManager.DEFORMABLE_TRANSFORM_GROUP_SUFFIX.length&&(null===t||t.indexOf(e.getName())<0)){var n=e,o=mat4.create();n.getTransform(o),TransformGroup3D.isIdentity(o)||(mat4.identity(o),n.setTransform(o),i=!0)}for(var r=e.getChildren(),l=0;l<r.length;l++)i|=this.setNotUpdatedTranformationsToIdentity(r[l],t)}return i},HomePieceOfFurniture3D.prototype.updatePieceOfFurnitureModelNode=function(e,t,i){t.setCapability(TransformGroup3D.ALLOW_TRANSFORM_WRITE),t.addChild(e);var n=new BranchGroup3D;if(n.addChild(t),null!=this.getHome()){var o=new Shape3D(HomePieceOfFurniture3D.SELECTION_BOX_GEOMETRY,this.getSelectionAppearance());o.setPickable(!1),n.addChild(o)}var r=this.getUserData();r.isDoorOrWindow()&&this.setTransparentShapeNotPickable(e);var l=this.getChild(0);l.removeAllChildren(),l.addChild(n),r.isHorizontallyRotated()&&this.updatePieceOfFurnitureTransform(),r.isBackFaceShown()&&this.setBackFaceNormalFlip(this.getModelNode(),!0),this.modifiedTexturesCount=0,this.updatePieceOfFurnitureColorAndTexture(i),this.updatePieceOfFurnitureVisibility(),0===this.modifiedTexturesCount&&"function"==typeof i&&i(this)},HomePieceOfFurniture3D.prototype.getModelBox=function(e){var t=new Appearance3D;t.setDiffuseColor(e),t.setAmbientColor(vec3.scale(vec3.create(),e,.7));var i=new Box3D(.5,.5,.5,t);return i.setUserData(HomePieceOfFurniture3D.DEFAULT_BOX),i},HomePieceOfFurniture3D.prototype.setColorAndTexture=function(e,t,i,n,o,r,l,a,s,h,u){if(e instanceof Group3D)for(var d=e.getChildren(),c=0;c<d.length;c++)this.setColorAndTexture(d[c],t,i,n,o,r,l,a,s,h,u);else if(e instanceof Link3D)this.setColorAndTexture(e.getSharedGroup(),t,i,n,o,r,l,a,s,h,u);else if(e instanceof Shape3D){var p=e,g=p.getName(),m=p.getAppearance();if(null===m&&(m=new Appearance3D,e.setAppearance(m)),-1===u.indexOf(m)){var f=null,v=null!==t,_=!v&&null!==i,S=!v&&!_&&null!==o&&o.length>0,y=v||_||S||null!==n||r||0!=l,E=null!==g&&0===g.indexOf(ModelManager.WINDOW_PANE_SHAPE_PREFIX);(!E&&y||E&&S)&&(void 0===m.defaultAppearance&&(m.defaultAppearance=m.clone()),f=m.defaultAppearance);var C=0;if(y&&(C=null!==n?n:void 0!==m.getSpecularColor()&&void 0!==m.getShininess()?m.getShininess()/128:0),v)E?this.restoreDefaultAppearance(m,null):(this.updateAppearanceMaterial(m,t,t,C),void 0!==f.getTransparency()&&m.setTransparency(f.getTransparency()),void 0!==f.getCullFace()&&m.setCullFace(f.getCullFace()),m.setTextureCoordinatesGeneration(f.getTextureCoordinatesGeneration()),m.setTextureImage(null));else if(_)E?this.restoreDefaultAppearance(m,null):(m.setTextureCoordinatesGeneration(this.getTextureCoordinates(m,i,s,h)),this.updateTextureTransform(m,i,!0),this.updateAppearanceMaterial(m,Object3DBranch.DEFAULT_COLOR,Object3DBranch.DEFAULT_AMBIENT_COLOR,C),TextureManager.getInstance().loadTexture(i.getImage(),0,"function"!=typeof a&&a,this.getTextureObserver(m,r,l,a)));else if(S){var P=!1;for(c=0;c<o.length;c++){var w=o[c];if(null!==w&&(null!=w.getKey()&&w.getKey()==m.getName()||null==w.getKey()&&w.getName()==m.getName())){if(null!==w.getShininess()&&(C=w.getShininess()),null!==(t=w.getColor())&&0!=(4278190080&t))this.updateAppearanceMaterial(m,t,t,C),void 0!==f.getTransparency()&&m.setTransparency(f.getTransparency()),void 0!==f.getCullFace()&&m.setCullFace(f.getCullFace()),m.setTextureImage(null);else if(null===t&&null!==w.getTexture()){var L=w.getTexture();this.isTexturesCoordinatesDefined(p)?(this.restoreDefaultTextureCoordinatesGeneration(m),this.updateTextureTransform(m,L)):(m.setTextureCoordinatesGeneration(this.getTextureCoordinates(m,w.getTexture(),s,h)),this.updateTextureTransform(m,L,!0)),this.updateAppearanceMaterial(m,Object3DBranch.DEFAULT_COLOR,Object3DBranch.DEFAULT_AMBIENT_COLOR,C);L=w.getTexture();TextureManager.getInstance().loadTexture(L.getImage(),0,"function"!=typeof a&&a,this.getTextureObserver(m,r,l,a))}else this.restoreDefaultAppearance(m,w.getShininess());P=!0;break}}P||this.restoreDefaultAppearance(m,null)}else this.restoreDefaultAppearance(m,n);this.setCullFace(m,r,0!=(l&PieceOfFurniture.SHOW_BACK_FACE)),u.push(m)}}},HomePieceOfFurniture3D.prototype.getTextureObserver=function(e,t,i,n){var o=this;return this.modifiedTexturesCount++,{textureUpdated:function(r){if(TextureManager.getInstance().isTextureTransparent(r))e.setCullFace(Appearance3D.CULL_NONE);else{var l=e.defaultAppearance;null!==l&&null!==l.getCullFace()&&e.setCullFace(l.getCullFace())}e.getTextureImage()!==r&&e.setTextureImage(r),o.setCullFace(e,t,0!=(i&PieceOfFurniture.SHOW_BACK_FACE)),0==--o.modifiedTexturesCount&&"function"==typeof n&&n(o)},textureError:function(e){return this.textureUpdated(TextureManager.getInstance().getErrorImage())}}},HomePieceOfFurniture3D.prototype.getTextureCoordinates=function(e,t,i,n){var o=vec3.create();n.getLower(o);var r=vec3.create();n.getUpper(r);var l=ModelManager.getInstance().getMinimumSize(),a=i[0]/Math.max(r[0]-o[0],l),s=-o[0]*a,h=i[1]/Math.max(r[1]-o[1],l),u=i[2]/Math.max(r[2]-o[2],l),d=-o[1]*h+r[2]*u;return{planeS:vec4.fromValues(a,0,0,s),planeT:vec4.fromValues(0,h,-u,d)}},HomePieceOfFurniture3D.prototype.isTexturesCoordinatesDefined=function(e){for(var t=e.getGeometries(),i=0,n=t.length;i<n;i++)if(!t[i].hasTextureCoordinates())return!1;return!0},HomePieceOfFurniture3D.prototype.setCullFace=function(e,t,i){if(e.getCullFace()!==Appearance3D.CULL_NONE){var n=void 0!==e.getCullFace()?e.getCullFace():Appearance3D.CULL_BACK,o=e.defaultCullFace;void 0===o&&(e.defaultCullFace=o=n),e.setCullFace(t^i^o===Appearance3D.CULL_FRONT?Appearance3D.CULL_FRONT:Appearance3D.CULL_BACK)}},HomePieceOfFurniture3D.prototype.restoreDefaultAppearance=function(e,t){if(void 0!==e.defaultAppearance){var i=e.defaultAppearance;void 0!==i.getAmbientColor()&&e.setAmbientColor(i.getAmbientColor()),void 0!==i.getDiffuseColor()&&(e.setDiffuseColor(i.getDiffuseColor()),null!==t?(e.setSpecularColor(vec3.fromValues(t,t,t)),e.setShininess(128*t)):(e.setSpecularColor(i.getSpecularColor()),e.setShininess(i.getShininess()))),void 0!==i.getTransparency()&&e.setTransparency(i.getTransparency()),void 0!==e.getCullFace()&&e.setCullFace(i.getCullFace()),void 0!==i.getTextureCoordinatesGeneration()&&e.setTextureCoordinatesGeneration(i.getTextureCoordinatesGeneration()),void 0!==e.getTextureImage()&&e.setTextureImage(i.getTextureImage())}},HomePieceOfFurniture3D.prototype.restoreDefaultTextureCoordinatesGeneration=function(e){if(void 0!==e.defaultAppearance){var t=e.defaultAppearance;void 0!==t.getTextureCoordinatesGeneration()&&e.setTextureCoordinatesGeneration(t.getTextureCoordinatesGeneration())}},HomePieceOfFurniture3D.prototype.setVisible=function(e,t,i,n){if(e instanceof Group3D)for(var o=e.getChildren(),r=0;r<o.length;r++)this.setVisible(o[r],t,i,n);else if(e instanceof Link3D)this.setVisible(e.getSharedGroup(),t,i,n);else if(e instanceof Shape3D){var l=e,a=l.getAppearance();null===a&&(a=new Appearance3D,e.setAppearance(a));var s=l.getName();if(t&&null!==s&&0===s.indexOf(ModelManager.LIGHT_SHAPE_PREFIX)&&null!==this.getHome()&&!this.isSelected(this.getHome().getSelectedItems())&&(void 0===HomeLight||this.getUserData()instanceof HomeLight)&&(t=!1),t){var h=a.getName();if(null!=h)if(0!=(i&PieceOfFurniture.HIDE_EDGE_COLOR_MATERIAL)&&0===h.indexOf(ModelManager.EDGE_COLOR_MATERIAL_PREFIX))t=!1;else if(null!=n)for(r=0;r<n.length;r++){var u=n[r];if(null!==u&&u.getName()==h){var d=u.getColor();t=null===d||0!=(4278190080&d);break}}}a.setVisible(t)}},HomePieceOfFurniture3D.prototype.isVisible=function(){var e=this.getUserData();return e.isVisible()&&(null===e.getLevel()||e.getLevel().isViewableAndVisible())},HomePieceOfFurniture3D.prototype.isSelected=function(e){for(var t=0;t<e.length;t++){var i=e[t];if(i===this.getUserData()||i instanceof HomeFurnitureGroup&&this.isSelected(i.getFurniture()))return!0}return!1},HomePieceOfFurniture3D.prototype.setBackFaceNormalFlip=function(e,t){if(e instanceof Group3D)for(var i=e.getChildren(),n=0;n<i.length;n++)this.setBackFaceNormalFlip(i[n],t);else if(e instanceof Link3D)this.setBackFaceNormalFlip(e.getSharedGroup(),t);else if(e instanceof Shape3D){var o=e.getAppearance();null===o&&(o=new Appearance3D,e.setAppearance(o)),o.setBackFaceNormalFlip(t^o.getCullFace()===Appearance3D.CULL_FRONT)}},HomePieceOfFurniture3D.prototype.setTransparentShapeNotPickable=function(e){if(e instanceof Group3D)for(var t=e.getChildren(),i=0;i<t.length;i++)this.setTransparentShapeNotPickable(t[i]);else if(e instanceof Link3D)this.setTransparentShapeNotPickable(e.getSharedGroup());else if(e instanceof Shape3D){var n=e.getAppearance();null!==n&&n.getTransparency()>0&&e.setPickable(!1)}},Room3D.prototype=Object.create(Object3DBranch.prototype),Room3D.prototype.constructor=Room3D,Room3D.FLOOR_PART=0,Room3D.CEILING_PART=1,Room3D.prototype.createRoomPartShape=function(){var e=new Shape3D;e.setCapability(Shape3D.ALLOW_GEOMETRY_WRITE);var t=new Appearance3D;return e.setAppearance(t),this.updateAppearanceMaterial(t,Object3DBranch.DEFAULT_COLOR,Object3DBranch.DEFAULT_AMBIENT_COLOR,0),e},Room3D.prototype.update=function(){this.updateRoomGeometry(),this.updateRoomAppearance(!1)},Room3D.prototype.updateRoomGeometry=function(){this.updateRoomPartGeometry(Room3D.FLOOR_PART,this.getUserData().getFloorTexture()),this.updateRoomPartGeometry(Room3D.CEILING_PART,this.getUserData().getCeilingTexture());var e=this.getUserData();this.setPickable(0==this.getHome().getEnvironment().getWallsAlpha()||null==e.getLevel()||e.getLevel().getElevation()<=0)},Room3D.prototype.updateRoomPartGeometry=function(e,t){var i=this.getChild(e),n=i.getGeometries().length,o=this.getUserData();if(null==o.getLevel()||o.getLevel().isViewableAndVisible())for(var r=this.createRoomGeometries(e,t),l=0;l<r.length;l++)i.addGeometry(r[l]);for(l=n-1;l>=0;l--)i.removeGeometry(l);var a=this.getChild(2);a.addGeometry(this.createRoomSelectionGeometry()),a.getGeometries().length>1&&a.removeGeometry(0)},Room3D.prototype.createRoomGeometries=function(e,t){var i=this.getUserData(),n=i.getPoints();if((e===Room3D.FLOOR_PART&&i.isFloorVisible()||e===Room3D.CEILING_PART&&i.isCeilingVisible())&&n.length>2){var o,r,l,a=i.getLevel(),s=this.getHome().getLevels(),h=this.isLastLevel(a,s);null!=a?o=(r=a.getElevation())-a.getFloorThickness():(r=0,o=0),l=0===s.length?0:s[0].getElevation();for(var u,d=e===Room3D.FLOOR_PART&&null!==a&&r!==l,c=[],p=[],g=this.getHome().getRooms(),m=0;m<g.length;m++){var f=g[m],v=f.getLevel();(null===v||v.isViewableAndVisible())&&(i===f||a===v&&(e===Room3D.FLOOR_PART&&f.isFloorVisible()||e===Room3D.CEILING_PART&&f.isCeilingVisible())||null!=a&&null!=v&&(e===Room3D.FLOOR_PART&&f.isFloorVisible()&&Math.abs(r-v.getElevation())<1e-4||e===Room3D.CEILING_PART&&f.isCeilingVisible()&&!h&&!this.isLastLevel(v,s)&&Math.abs(r+a.getHeight()-(v.getElevation()+v.getHeight()))<1e-4)?c.push(f):d&&null!=v&&f.isCeilingVisible()&&!this.isLastLevel(v,s)&&Math.abs(o-(v.getElevation()+v.getHeight()))<1e-4&&p.push(f))}null!=a&&c.sort((function(e,t){var i=e.getLevel().getElevation()-t.getLevel().getElevation();return 0!==i?i:e.getLevel().getElevationIndex()-t.getLevel().getElevationIndex()})),u=null===a||e===Room3D.CEILING_PART&&h?[]:this.getVisibleStaircases(this.getHome().getFurniture(),e,a,a.getElevation()===l);var _,S,y,E,C=!0;if(e===Room3D.CEILING_PART&&(null===a||h)){var P=this.getRoomHeightAt(n[0][0],n[0][1]);for(m=1;m<n.length&&C;m++)C=this.getRoomHeightAt(n[m][0],n[m][1])===P}if(!i.isSingular()||C&&(c[c.length-1]!==i||u.length>0)){if(E=new java.awt.geom.Area(this.getShape(n)),c.indexOf(i)>=0)for(m=c.length-1;m>0&&c[m]!==i;m--){var w=c[m];E.subtract(new java.awt.geom.Area(this.getShape(w.getPoints())))}this.removeStaircasesFromArea(u,E),_=[],S=[],y=this.getAreaPoints(E,_,S,1,e===Room3D.CEILING_PART)}else{var L=i.isClockwise();(L&&e===Room3D.FLOOR_PART||!L&&e===Room3D.CEILING_PART)&&(n=this.getReversedArray(n)),y=_=[n],S=[],E=null}var T=[],A=this.getHome().getEnvironment().getSubpartSizeUnderLight();if(0!==y.length){var I=[],b=!0;for(m=0;m<y.length;m++){for(var O=y[m],M=new Array(O.length),D=0;D<O.length;D++)M[D]=e===Room3D.FLOOR_PART?r:this.getRoomHeightAt(O[D][0],O[D][1]),b&&D>0&&(b=M[D]===M[D-1]);I.push(M)}if(b&&A>0)for(D=0;D<y.length;D++){O=y[D];var R=Number.MAX_VALUE,F=Number.MIN_VALUE,x=Number.MAX_VALUE,N=Number.MIN_VALUE;for(m=0;m<O.length;m++){var k=O[m];R=Math.min(R,k[0]),F=Math.max(F,k[0]),x=Math.min(x,k[1]),N=Math.max(N,k[1])}for(var H=new java.awt.geom.Area(this.getShape(O)),V=R;V<F;V+=A)for(var U=x;U<N;U+=A){var W=new java.awt.geom.Area(new java.awt.geom.Rectangle2D.Float(V,U,A,A));if(W.intersect(H),!W.isEmpty())0!=(X=this.getAreaPoints(W,1,e===Room3D.CEILING_PART)).length&&T.push(this.computeRoomPartGeometry(X,null,a,I[m][0],o,e===Room3D.FLOOR_PART,!1,t))}}else T.push(this.computeRoomPartGeometry(y,I,a,r,o,e===Room3D.FLOOR_PART,!1,t));null!=a&&e===Room3D.FLOOR_PART&&a.getElevation()!==l&&T.push(this.computeRoomBorderGeometry(_,S,a,r,t))}if(d){var B;if(null!=E||p.length>0){var G=null!=E?E:new java.awt.geom.Area(this.getShape(n));for(m=0;m<p.length;m++){w=p[m];G.subtract(new java.awt.geom.Area(this.getShape(w.getPoints())))}B=this.getAreaPoints(G,1,!0)}else B=[this.getReversedArray(n)];if(0!==B.length)if(A>0)for(m=0;m<B.length;m++){var Y=B[m];for(R=Number.MAX_VALUE,F=Number.MIN_VALUE,x=Number.MAX_VALUE,N=Number.MIN_VALUE,D=0;D<Y.length;D++){k=Y[D];R=Math.min(R,k[0]),F=Math.max(F,k[0]),x=Math.min(x,k[1]),N=Math.max(N,k[1])}var $=new java.awt.geom.Area(this.getShape(Y));for(V=R;V<F;V+=A)for(U=x;U<N;U+=A){var X,z=new java.awt.geom.Area(new java.awt.geom.Rectangle2D.Float(V,U,A,A));if(z.intersect($),!z.isEmpty())0!==(X=this.getAreaPoints(z,1,!0)).length&&T.push(this.computeRoomPartGeometry(X,null,a,r,o,!0,!0,t))}}else T.push(this.computeRoomPartGeometry(B,null,a,r,o,!0,!0,t))}return T.slice(0)}return[]},Room3D.prototype.computeRoomPartGeometry=function(e,t,i,n,o,r,l,a){for(var s=new Array(e.length),h=0,u=0;u<e.length;u++){var d=e[u];s[u]=d.length,h+=s[u]}for(var c=new Array(h),p=(u=0,0);p<e.length;p++){d=e[p];for(var g=null!=t?t[p]:null,m=0;m<d.length;m++){var f=l?o:null!=g?g[m]:n;c[u++]=vec3.fromValues(d[m][0],f,d[m][1])}}var v=new GeometryInfo3D(GeometryInfo3D.POLYGON_ARRAY);if(v.setCoordinates(c),v.setStripCounts(s),null!=a){var _=new Array(h);u=0;for(p=0;p<e.length;p++)for(d=e[p],m=0;m<d.length;m++)_[u++]=vec2.fromValues(d[m][0],r?-d[m][1]:d[m][1]);v.setTextureCoordinates(_)}return v.setGeneratedNormals(!0),v.getIndexedGeometryArray()},Room3D.prototype.computeRoomBorderGeometry=function(e,t,i,n,o){for(var r=0,l=0;l<e.length;l++)r+=e[l].length;for(l=0;l<t.length;l++)r+=t[l].length;r*=4;l=0;for(var a=new Array(r),s=n-i.getFloorThickness(),h=0;h<e.length;h++)for(var u=e[h],d=0;d<u.length;d++){a[l++]=vec3.fromValues(u[d][0],n,u[d][1]),a[l++]=vec3.fromValues(u[d][0],s,u[d][1]);var c=d<u.length-1?d+1:0;a[l++]=vec3.fromValues(u[c][0],s,u[c][1]),a[l++]=vec3.fromValues(u[c][0],n,u[c][1])}for(h=0;h<t.length;h++){var p=t[h];for(d=0;d<p.length;d++){a[l++]=vec3.fromValues(p[d][0],n,p[d][1]);c=d<p.length-1?d+1:0;a[l++]=vec3.fromValues(p[c][0],n,p[c][1]),a[l++]=vec3.fromValues(p[c][0],s,p[c][1]),a[l++]=vec3.fromValues(p[d][0],s,p[d][1])}}var g=new GeometryInfo3D(GeometryInfo3D.QUAD_ARRAY);if(g.setCoordinates(a),null!=o){var m=new Array(r);if(l=0,o.isFittingArea()){for(h=0;h<e.length;h++)for(u=e[h],d=0;d<u.length;d++){m[l++]=m[l++]=vec2.fromValues(u[d][0],-u[d][1]);c=d<u.length-1?d+1:0;m[l++]=m[l++]=vec2.fromValues(u[c][0],-u[c][1])}for(h=0;h<t.length;h++)for(p=t[h],d=0;d<p.length;d++){m[l]=vec2.fromValues(p[d][0],-p[d][1]);c=d<p.length-1?d+1:0;m[l+1]=vec2.fromValues(p[c][0],-p[c][1]),m[l+2]=m[l+1],m[l+3]=m[l],l+=4}}else{for(h=0;h<e.length;h++)for(u=e[h],d=0;d<u.length;d++){m[l++]=vec2.fromValues(0,i.getFloorThickness()),m[l++]=vec2.fromValues(0,0);c=d<u.length-1?d+1:0;var f=java.awt.geom.Point2D.distance(u[d][0],u[d][1],u[c][0],u[c][1]);m[l++]=vec2.fromValues(f,0),m[l++]=vec2.fromValues(f,i.getFloorThickness())}for(h=0;h<t.length;h++)for(p=t[h],d=0;d<p.length;d++){m[l++]=vec2.fromValues(0,0);c=d<p.length-1?d+1:0,f=java.awt.geom.Point2D.distance(p[d][0],p[d][1],p[c][0],p[c][1]);m[l++]=vec2.fromValues(f,0),m[l++]=vec2.fromValues(f,i.getFloorThickness()),m[l++]=vec2.fromValues(0,i.getFloorThickness())}}g.setTextureCoordinates(m)}return g.setCreaseAngle(Math.PI/8),g.setGeneratedNormals(!0),g.getIndexedGeometryArray()},Room3D.prototype.removeStaircasesFromArea=function(e,t){for(var i=ModelManager.getInstance(),n=0;n<e.length;n++){var o=e[n];t.subtract(i.getAreaOnFloor(o))}},Room3D.prototype.getVisibleStaircases=function(e,t,i,n){for(var o=[],r=0;r<e.length;r++){var l=e[r];l.isVisible()&&(null===l.getLevel()||l.getLevel().isViewableAndVisible())&&(l instanceof HomeFurnitureGroup?o.push.apply(o,this.getVisibleStaircases(l.getFurniture(),t,i,n)):null!=l.getStaircaseCutOutShape()&&"false"!=l.getStaircaseCutOutShape().toLowerCase()&&(t===Room3D.FLOOR_PART&&l.getGroundElevation()<i.getElevation()&&l.getGroundElevation()+l.getHeight()>=i.getElevation()-(n?0:i.getFloorThickness())||t===Room3D.CEILING_PART&&l.getGroundElevation()<i.getElevation()+i.getHeight()&&l.getGroundElevation()+l.getHeight()>=i.getElevation()+i.getHeight())&&o.push(l))}return o},Room3D.prototype.getReversedArray=function(e){return(e=e.slice(0)).reverse()},Room3D.prototype.getRoomHeightAt=function(e,t){var i=1/0,n=this.getUserData(),o=this.getHome(),r=n.getLevel(),l=(null!==r?r.getElevation():0)+(null==r?o.getWallHeight():r.getHeight()),a=o.getLevels();if(null==r||this.isLastLevel(r,a)){var s=o.getWalls();if(n.isCeilingFlat())for(var h=!1,u=0;u<s.length;u++){if((null===(f=s[u]).getLevel()||f.getLevel().isViewable())&&f.isAtLevel(r)){if(null!==f.getHeight()){var d=f.getHeight();null!==f.getLevel()&&(d+=f.getLevel().getElevation()),h?l=Math.max(l,d):(l=d,h=!0)}if(null!==f.getHeightAtEnd()){var c=f.getHeightAtEnd();null!==f.getLevel()&&(c+=f.getLevel().getElevation()),h?l=Math.max(l,c):(l=c,h=!0)}}}else{var p=null,g=null,m=-1;for(u=0;u<s.length;u++){var f;if((null===(f=s[u]).getLevel()||f.getLevel().isViewable())&&f.isAtLevel(r))for(var v=f.getPoints(),_=0;_<v.length;_++){var S=java.awt.geom.Point2D.distanceSq(v[_][0],v[_][1],e,t);S<i&&(p=f,g=v,m=_,i=S)}}if(null!=p){l=null==p.getLevel()?0:p.getLevel().getElevation();var y=p.getHeight();if(0===m||m===g.length-1)l+=null!=y?y:o.getWallHeight();else if(p.isTrapezoidal()){var E=p.getArcExtent();if(null==E||0===E||m===Math.floor(g.length/2)||m===Math.floor(g.length/2)-1)l+=p.getHeightAtEnd();else{var C=p.getXArcCircleCenter(),P=p.getYArcCircleCenter(),w=g[m][0],L=g[m][1],T=java.awt.geom.Point2D.distance(C,P,w,L),A=p.getXStart(),I=p.getYStart(),b=(w-C)*(A-C)+(L-P)*(I-P);b/=T*java.awt.geom.Point2D.distance(C,P,A,I);var O=Math.acos(b)*(E>0?1:E<0?-1:0);l+=y+(p.getHeightAtEnd()-y)*O/E}}else l+=null!=y?y:o.getWallHeight()}}}return l},Room3D.prototype.isLastLevel=function(e,t){return t.indexOf(e)===t.length-1},Room3D.prototype.createRoomSelectionGeometry=function(){var e,t,i,n=this.getUserData(),o=n.getLevel(),r=this.getHome().getLevels();null!=o?e=(t=o.getElevation())-o.getFloorThickness():(t=0,e=0),i=0==r.length?0:r[0].getElevation();var l=n.isFloorVisible(),a=l&&null!=o&&t!=i,s=n.getPoints(),h=n.isCeilingVisible();l||h||(l=!0);var u=new Array(s.length*((l?a?2:1:0)+(h?1:0))),d=new Array((l?a?6*s.length:2*s.length:0)+(h?2*s.length:0)),c=0,p=0;if(l){for(var g=0;g<s.length;g++,c++)u[c]=vec3.fromValues(s[g][0],t,s[g][1]),d[p++]=c,g>0&&(d[p++]=c);if(d[p++]=0,a){for(g=0;g<s.length;g++,c++)u[c]=vec3.fromValues(s[g][0],e,s[g][1]),d[p++]=c,g>0&&(d[p++]=c);d[p++]=s.length;for(g=0;g<s.length;g++)d[p++]=g,d[p++]=g+s.length}}if(h){for(g=0;g<s.length;g++,c++)u[c]=vec3.fromValues(s[g][0],this.getRoomHeightAt(s[g][0],s[g][1]),s[g][1]),d[p++]=c,g>0&&(d[p++]=c);d[p++]=u.length-s.length}return new IndexedLineArray3D(u,d)},Room3D.prototype.updateRoomAppearance=function(e){var t=this.getUserData(),i=null==t.getLevel()||t.getLevel().getElevation()<=0;this.updateRoomPartAppearance(this.getChild(Room3D.FLOOR_PART).getAppearance(),t.getFloorTexture(),e,t.getFloorColor(),t.getFloorShininess(),t.isFloorVisible(),i,!0);var n=this.getChildren().length;if(n>2){var o=null==t.getLevel();this.updateRoomPartAppearance(this.getChild(Room3D.CEILING_PART).getAppearance(),t.getCeilingTexture(),e,t.getCeilingColor(),t.getCeilingShininess(),t.isCeilingVisible(),o,!1)}this.getChild(n>2?2:1).getAppearance().setVisible(null!=this.getUserPreferences()&&this.getUserPreferences().isEditingIn3DViewEnabled()&&this.getHome().isItemSelected(t))},Room3D.prototype.updateRoomPartAppearance=function(e,t,i,n,o,r,l,a){if(null==t)this.updateAppearanceMaterial(e,n,n,o),e.setTextureImage(null);else{this.updateAppearanceMaterial(e,Object3DBranch.DEFAULT_COLOR,Object3DBranch.DEFAULT_AMBIENT_COLOR,o);var s=this.getUserData();t.isFittingArea()?this.updateTextureTransformFittingArea(e,t,s.getPoints(),a):this.updateTextureTransform(e,t,!0),TextureManager.getInstance().loadTexture(t.getImage(),i,{textureUpdated:function(t){e.setTextureImage(t)},textureError:function(e){return this.textureUpdated(TextureManager.getInstance().getErrorImage())}})}var h=this.getHome().getEnvironment().getWallsAlpha();l||0===h?e.setTransparency(0):e.setTransparency(h),e.setVisible(r)},Wall3D.prototype=Object.create(Object3DBranch.prototype),Wall3D.prototype.constructor=Wall3D,Wall3D.LEVEL_ELEVATION_SHIFT=.1,Wall3D.FULL_FACE_CUT_OUT_AREA=new java.awt.geom.Area(new java.awt.geom.Rectangle2D.Float(-.5,.5,1,1)),Wall3D.WALL_LEFT_SIDE=0,Wall3D.WALL_RIGHT_SIDE=1,Wall3D.rotatedModelsFrontAreas=[],Wall3D.prototype.createWallPartShape=function(){var e=new Shape3D;e.setCapability(Shape3D.ALLOW_GEOMETRY_WRITE);var t=new Appearance3D;return e.setAppearance(t),this.updateAppearanceMaterial(t,Object3DBranch.DEFAULT_COLOR,Object3DBranch.DEFAULT_AMBIENT_COLOR,0),e},Wall3D.prototype.update=function(){this.updateWallGeometry(!1),this.updateWallAppearance(!1)},Wall3D.prototype.updateWallGeometry=function(e){this.updateWallSideGeometry(Wall3D.WALL_LEFT_SIDE,e),this.updateWallSideGeometry(Wall3D.WALL_RIGHT_SIDE,e),this.setPickable(0==this.getHome().getEnvironment().getWallsAlpha());var t=this.getChild(8);t.addGeometry(this.createWallSelectionGeometry()),t.getGeometries().length>1&&t.removeGeometry(0)},Wall3D.prototype.updateWallSideGeometry=function(e,t){var i,n,o=this.getUserData();e===Wall3D.WALL_LEFT_SIDE?(i=o.getLeftSideTexture(),n=o.getLeftSideBaseboard()):(i=o.getRightSideTexture(),n=o.getRightSideBaseboard());for(var r=[this.getChild(e),this.getChild(e+2),this.getChild(e+4),this.getChild(e+6)],l=new Array(r.length),a=new Array(r.length),s=0;s<r.length;s++)l[s]=r[s].getChild(0),a[s]=l[s].getGeometries().length;if(null==o.getLevel()||o.getLevel().isViewableAndVisible()){var h=[[],[],[],[]];if(this.createWallGeometries(h[0],h[2],h[3],e,null,i,t),null!=n){var u=n.getTexture();null===u&&null===n.getColor()&&(u=i),this.createWallGeometries(h[1],h[1],h[1],e,n,u,t)}for(s=0;s<r.length;s++)for(var d=0;d<h[s].length;d++){var c=h[s][d];null!==c&&l[s].addGeometry(c)}}for(s=0;s<r.length;s++)for(d=a[s]-1;d>=0;d--)l[s].removeGeometry(d)},Wall3D.prototype.createWallGeometries=function(e,t,i,n,o,r,l){var a,s,h=this.getUserData(),u=this.getShape(h.getPoints()),d=this.getWallSidePoints(n),c=this.getShape(d),p=null==o?d:this.getWallBaseboardPoints(n),g=this.getShape(p),m=new java.awt.geom.Area(g),f=n===Wall3D.WALL_LEFT_SIDE?p[0].slice(0):p[p.length-1].slice(0),v=this.getWallElevation(null!==o);null===o?(a=this.getWallTopElevationAtStart(),s=this.getWallTopElevationAtEnd()):a=s=this.getBaseboardTopElevation(o);var _,S,y=Math.max(a,s),E=Math.atan2(h.getYEnd()-h.getYStart(),h.getXEnd()-h.getXStart()),C=Math.cos(E),P=Math.sin(E),w=C*h.getXStart()+P*h.getYStart(),L=C*h.getXEnd()+P*h.getYEnd(),T=h.getArcExtent(),A=null!==T&&0!==T;a===s?(_=0,S=a):S=a-(_=(s-a)/(L-w))*w;for(var I=[],b=[],O=this.getVisibleDoorsAndWindows(this.getHome().getFurniture()),M=0;M<O.length;M++){var D=(ce=O[M]).getGroundElevation();if(D+ce.getHeight()>v&&D<y){var R=new java.awt.geom.Area(this.getShape(ce.getPoints())),F=new java.awt.geom.Area(u);if(F.intersect(R),!F.isEmpty()){var x=null;ce.isParallelToWall(h)&&(null!==o&&(x=ce.clone()).setDepthInPlan(x.getDepth()+2*o.getThickness()),void 0!==HomeDoorOrWindow&&ce instanceof HomeDoorOrWindow&&ce.isWallCutOutOnBothSides()&&(null===x&&(x=ce.clone()),x.setDepthInPlan(x.getDepth()+4*h.getThickness()))),null!==x?(R=new java.awt.geom.Area(this.getShape(x.getPoints())),(F=new java.awt.geom.Area(g)).intersect(R)):(F=new java.awt.geom.Area(c)).intersect(R),F.isEmpty()||h.isTrapezoidal()&&!(D<this.getMaxElevationAtWallIntersection(F,C,P,_,S))||(I.push(new Wall3D.DoorOrWindowArea(F,[ce])),b.push(ce),m.subtract(R))}}}if(I.length>1)for(var N=0;N<I.length;N++){var k=I[N],H=[],V=0;for(M=0;M<I.length;M++){var U=I[M];if(k.getArea().isEmpty())break;if(V>N){var W=new java.awt.geom.Area(U.getArea());if(W.intersect(k.getArea()),!W.isEmpty())U.getArea().subtract(W),k.getArea().subtract(W),(K=k.getDoorsOrWindows().slice(0)).push.apply(K,U.getDoorsOrWindows()),H.push(new Wall3D.DoorOrWindowArea(W,K))}V++}I.push.apply(I,H)}for(var B=[],G=null,Y=m.getPathIterator(null);!Y.isDone();Y.next()){var $=[0,0];if(Y.currentSegment($)===java.awt.geom.PathIterator.SEG_CLOSE){if(B.length>2&&(B[0][0]===B[B.length-1][0]&&B[0][1]===B[B.length-1][1]&&B.splice(B.length-1,1),B.length>2)){var X=B.slice(0);t.push(this.createVerticalPartGeometry(h,X,v,C,P,_,S,o,r,f,n)),e.push(this.createHorizontalPartGeometry(X,v,!0,A)),i.push(this.createTopPartGeometry(X,C,P,_,S,A))}B.length=0,G=null}else null!==G&&$[0]===G[0]&&$[1]===G[1]||(B.push($),G=$)}var z=h.getLevel();G=null;for(var j=0;j<I.length;j++){if(!(k=I[j]).getArea().isEmpty())for(Y=k.getArea().getPathIterator(null);!Y.isDone();Y.next()){$=[0,0];if(Y.currentSegment($)===java.awt.geom.PathIterator.SEG_CLOSE){if(B[0][0]===B[B.length-1][0]&&B[0][1]===B[B.length-1][1]&&B.splice(B.length-1,1),B.length>2){var K;X=B.slice(0);(K=k.getDoorsOrWindows()).length>1&&K.sort((function(e,t){var i=e.getGroundElevation(),n=t.getGroundElevation();return i<n?-1:i>n?1:0}));var J=K[0],q=J.getGroundElevation();q>v&&(null!=z&&z.getElevation()!==v&&J.getElevation()<Wall3D.LEVEL_ELEVATION_SHIFT&&(q-=Wall3D.LEVEL_ELEVATION_SHIFT),t.push(this.createVerticalPartGeometry(h,X,v,C,P,0,q,o,r,f,n)),e.push(this.createHorizontalPartGeometry(X,v,!0,A)),t.push(this.createHorizontalPartGeometry(X,q,!1,A)));for(M=0;M<K.length-1;){for(var Z=K[M],Q=Z.getGroundElevation(),ee=K[++M],te=ee.getGroundElevation();Q+Z.getHeight()>=te+ee.getHeight()&&++M<K.length;)ee=K[M];M<K.length&&Q+Z.getHeight()<te&&(t.push(this.createVerticalPartGeometry(h,X,Q+Z.getHeight(),C,P,0,te,o,r,f,n)),t.push(this.createHorizontalPartGeometry(X,Q+Z.getHeight(),!0,A)),t.push(this.createHorizontalPartGeometry(X,te,!1,A)))}var ie=K[K.length-1],ne=ie.getGroundElevation();for(M=K.length-2;M>=0;M--){var oe=K[M];oe.getGroundElevation()+oe.getHeight()>ne+ie.getHeight()&&(ie=oe)}var re=ne+ie.getHeight(),le=!0;for(M=0;M<X.length;M++){var ae=C*X[M][0]+P*X[M][1],se=_*ae+S;if(re>se){if(0===_||A){le=!1;break}var he=(re-se)/_;X[M][0]+=he*C,X[M][1]+=he*P}}le&&(t.push(this.createVerticalPartGeometry(h,X,re,C,P,_,S,o,r,f,n)),t.push(this.createHorizontalPartGeometry(X,re,!0,A)),i.push(this.createTopPartGeometry(X,C,P,_,S,A)))}B.length=0,G=null}else null!=G&&$[0]===G[0]&&$[1]===G[1]||(B.push($),G=$)}}if(!A&&b.length>0){var ue=Math.PI/720,de=[];for(M=0;M<b.length;M++){var ce=b[M];if(void 0!==HomeDoorOrWindow&&ce instanceof HomeDoorOrWindow&&(PieceOfFurniture.DEFAULT_CUT_OUT_SHAPE!=ce.getCutOutShape()||1!==ce.getWallWidth()||0!==ce.getWallLeft()||1!==ce.getWallHeight()||0!==ce.getWallTop())){var pe=Math.abs(E-ce.getAngle())%(2*Math.PI);if(pe<ue||pe>2*Math.PI-ue||Math.abs(pe-Math.PI)<ue){var ge=Math.abs(pe-Math.PI)<ue?1:-1,me=Wall3D.getRotatedModelFrontArea(ce);null===me||0!==de.length&&l?de.push(ce):this.createGeometriesSurroundingDoorOrWindow(ce,me,ge,h,t,i,p,v,C,P,_,S,r,f,n)}}}if(de.length>0){var fe=ModelManager.getInstance();de=de.slice(0);var ve=this;for(M=0;M<de.length;M++){var _e={doorOrWindow:de[M],modelUpdated:function(e){var o;if(null===Wall3D.getRotatedModelFrontArea(this.doorOrWindow)){var a=new TransformGroup3D(fe.getRotationTransformation(this.doorOrWindow.getModelRotation()));a.addChild(e),o=fe.getFrontArea(this.doorOrWindow.getCutOutShape(),a),Wall3D.rotatedModelsFrontAreas.push({model:this.doorOrWindow.getModel(),modelRotation:this.doorOrWindow.getModelRotation(),cutOutShape:this.doorOrWindow.getCutOutShape(),frontArea:o})}var s=Math.abs(E-this.doorOrWindow.getAngle())%(2*Math.PI),u=Math.abs(s-Math.PI)<ue?1:-1;l?ve.createGeometriesSurroundingDoorOrWindow(this.doorOrWindow,o,u,h,t,i,p,v,C,P,_,S,r,f,n):(de.splice(de.indexOf(this.doorOrWindow),1),0===de.length&&null==this.baseboard&&setTimeout((function(){ve.updateWallSideGeometry(n,l)}),0))},modelError:function(e){null===Wall3D.getRotatedModelFrontArea(this.doorOrWindow)&&Wall3D.rotatedModelsFrontAreas.push({model:this.doorOrWindow.getModel(),modelRotation:this.doorOrWindow.getModelRotation(),cutOutShape:this.doorOrWindow.getCutOutShape(),frontArea:Wall3D.FULL_FACE_CUT_OUT_AREA}),l||de.splice(de.indexOf(this.doorOrWindow),1)}};fe.loadModel(de[M].getModel(),l,_e)}}}},Wall3D.getRotatedModelFrontArea=function(e){for(var t=0;t<Wall3D.rotatedModelsFrontAreas.length;t++)if(Wall3D.rotatedModelsFrontAreas[t].model.equals(e.getModel())&&Object3DBranch.areModelRotationsEqual(Wall3D.rotatedModelsFrontAreas[t].modelRotation,e.getModelRotation())&&Wall3D.rotatedModelsFrontAreas[t].cutOutShape==e.getCutOutShape())return Wall3D.rotatedModelsFrontAreas[t].frontArea;return null},Wall3D.prototype.getVisibleDoorsAndWindows=function(e){for(var t=[],i=0;i<e.length;i++){var n=e[i];n.isVisible()&&(null==n.getLevel()||n.getLevel().isViewableAndVisible())&&(n instanceof HomeFurnitureGroup?t.push.apply(t,this.getVisibleDoorsAndWindows(n.getFurniture())):n.isDoorOrWindow()&&t.push(n))}return t},Wall3D.prototype.getWallSidePoints=function(e){var t=this.getUserData().getPoints();if(e===Wall3D.WALL_LEFT_SIDE)for(var i=t.length/2|0;i<t.length;i++)t[i][0]=(t[i][0]+t[t.length-i-1][0])/2,t[i][1]=(t[i][1]+t[t.length-i-1][1])/2;else{i=0;for(var n=t.length/2|0;i<n;i++)t[i][0]=(t[i][0]+t[t.length-i-1][0])/2,t[i][1]=(t[i][1]+t[t.length-i-1][1])/2}return t},Wall3D.prototype.getWallBaseboardPoints=function(e){var t=this.getUserData(),i=t.getPoints$boolean(!0),n=t.getPoints();if(e===Wall3D.WALL_LEFT_SIDE)for(var o=Math.floor(i.length/2);o<i.length;o++)i[o]=n[n.length-o-1];else{o=0;for(var r=Math.floor(n.length/2);o<r;o++)i[o]=n[n.length-o-1]}return i},Wall3D.prototype.createVerticalPartGeometry=function(e,t,i,n,o,r,l,a,s,h,u){var d=this.getHome().getEnvironment().getSubpartSizeUnderLight(),c=e.getArcExtent();if((null===c||0===c)&&d>0){var p=[];p.push(t[0]);for(var g=1;g<t.length;g++){for(var m=java.awt.geom.Point2D.distance(t[g-1][0],t[g-1][1],t[g][0],t[g][1])-d/2,f=Math.atan2(t[g][1]-t[g-1][1],t[g][0]-t[g-1][0]),v=Math.cos(f),_=Math.sin(f),S=0;S<m;S+=d)p.push([t[g-1][0]+S*v,t[g-1][1]+S*_]);p.push(t[g])}t=p.slice(0)}var y=new Array(t.length),E=new Array(t.length),C=new Array(t.length),P=e.getXStart(),w=e.getYStart(),L=e.getXEnd(),T=e.getYEnd(),A=null,I=0,b=0;null!==c&&0!==c&&(A=[e.getXArcCircleCenter(),e.getYArcCircleCenter()],I=java.awt.geom.Point2D.distance(A[0],A[1],P,w),b=Math.fround(Math.atan2(h[1]-A[1],h[0]-A[0])));for(g=0;g<t.length;g++){y[g]=vec3.fromValues(t[g][0],i,t[g][1]);var O=this.getWallPointElevation(t[g][0],t[g][1],n,o,r,l);E[g]=vec3.fromValues(t[g][0],O,t[g][1])}var M=new Array(t.length);for(g=0;g<t.length;g++)null===A?M[g]=java.awt.geom.Line2D.ptLineDistSq(P,w,L,T,y[g][0],y[g][2]):(M[g]=I-java.awt.geom.Point2D.distance(A[0],A[1],y[g][0],y[g][2]),M[g]*=M[g]);var D=t.length,R=new Array(t.length);if(null===a){for(g=0;g<t.length-1;g++)R[g]=M[g]>.001||M[g+1]>.001,R[g]||D--;if(R[R.length-1]=M[0]>.001||M[t.length-1]>.001,R[R.length-1]||D--,0===D)return null}else for(g=0;g<R.length;g++)R[g]=!0;for(var F=[],x=0;x<t.length;x++)if(R[x]){var N=i,k=y[x],H=y[j=(x+1)%t.length];if(d>0)for(var V=Math.min(E[x][1],E[j][1])-d/2;N<V;N+=d)F.push(k),F.push(H),k=vec3.fromValues(y[x][0],N,y[x][2]),H=vec3.fromValues(y[j][0],N,y[j][2]),F.push(H),F.push(k);F.push(k),F.push(H),F.push(E[j]),F.push(E[x])}var U=new GeometryInfo3D(GeometryInfo3D.QUAD_ARRAY);if(U.setCoordinates(F.slice(0)),null!==s){var W;null!==a?(W=e.getThickness()/2+a.getThickness(),W*=W):W=e.getThickness()*e.getThickness()/4;var B=new Array(F.length),G=vec2.fromValues(0,i),Y=0,$=null===A?e.getThickness()/1e4:W/4;for(x=0;x<t.length;x++)if(R[x]){var X,z,j=(x+1)%t.length;if(Math.abs(M[x]-W)<$&&Math.abs(M[j]-W)<$){var K,J;if(null===A)K=java.awt.geom.Point2D.distance(h[0],h[1],t[x][0],t[x][1]),J=java.awt.geom.Point2D.distance(h[0],h[1],t[j][0],t[j][1]);else{if(void 0===C[x]){var q=Math.fround(Math.atan2(t[x][1]-A[1],t[x][0]-A[0]));q=this.adjustAngleOnReferencePointAngle(q,b,c),C[x]=(q-b)*I}if(void 0===C[j]){q=Math.fround(Math.atan2(t[j][1]-A[1],t[j][0]-A[0]));q=this.adjustAngleOnReferencePointAngle(q,b,c),C[j]=(q-b)*I}K=C[x],J=C[j]}u===Wall3D.WALL_LEFT_SIDE&&s.isLeftToRightOriented()&&(K=-K,J=-J),X=vec2.fromValues(K,i),z=vec2.fromValues(J,i)}else{X=G;var Z=java.awt.geom.Point2D.distance(t[x][0],t[x][1],t[j][0],t[j][1]);z=vec2.fromValues(Z,i)}if(d>0)for(N=i,V=Math.min(E[x][1],E[j][1])-d/2;N<V;N+=d)B[Y++]=X,B[Y++]=z,X=vec2.fromValues(X[0],N),z=vec2.fromValues(z[0],N),B[Y++]=z,B[Y++]=X;B[Y++]=X,B[Y++]=z,B[Y++]=vec2.fromValues(z[0],E[j][1]),B[Y++]=vec2.fromValues(X[0],E[x][1])}U.setTextureCoordinates(B)}return null===A&&U.setCreaseAngle(0),U.setGeneratedNormals(!0),U.getIndexedGeometryArray()},Wall3D.prototype.getMaxElevationAtWallIntersection=function(e,t,i,n,o){for(var r=-1/0,l=e.getPathIterator(null);!l.isDone();l.next()){var a=[0,0];l.currentSegment(a)!==java.awt.geom.PathIterator.SEG_CLOSE&&(r=Math.max(r,this.getWallPointElevation(a[0],a[1],t,i,n,o)))}return r},Wall3D.prototype.getWallPointElevation=function(e,t,i,n,o,r){return o*(i*e+n*t)+r},Wall3D.prototype.adjustAngleOnReferencePointAngle=function(e,t,i){return i>0?(t>0&&(e<0||e<t)||t<0&&e<t)&&(e+=2*Math.PI):(t<0&&(e>0||t<e)||t>0&&t<e)&&(e-=2*Math.PI),e},Wall3D.prototype.createHorizontalPartGeometry=function(e,t,i,n){for(var o=new Array(e.length),r=0;r<e.length;r++)o[r]=vec3.fromValues(e[r][0],t,e[r][1]);var l=new GeometryInfo3D(GeometryInfo3D.POLYGON_ARRAY);return l.setCoordinates(i?o.reverse():o),l.setStripCounts([o.length]),n&&l.setCreaseAngle(0),l.setGeneratedNormals(!0),l.getIndexedGeometryArray()},Wall3D.prototype.createTopPartGeometry=function(e,t,i,n,o,r){for(var l=new Array(e.length),a=0;a<e.length;a++){var s=n*(t*e[a][0]+i*e[a][1])+o;l[a]=vec3.fromValues(e[a][0],s,e[a][1])}var h=new GeometryInfo3D(GeometryInfo3D.POLYGON_ARRAY);return h.setCoordinates(l),h.setStripCounts([l.length]),r&&h.setCreaseAngle(0),h.setGeneratedNormals(!0),h.getIndexedGeometryArray()},Wall3D.prototype.createGeometriesSurroundingDoorOrWindow=function(e,t,i,n,o,r,l,a,s,h,u,d,c,p,g){null!==e.getModelTransformations()&&((t=new java.awt.geom.Area(t)).transform(java.awt.geom.AffineTransform.getTranslateInstance(.5,.5)),t.transform(java.awt.geom.AffineTransform.getScaleInstance(e.getWidth()*e.getWallWidth(),e.getHeight()*e.getWallHeight())),t.transform(java.awt.geom.AffineTransform.getTranslateInstance(e.getWallLeft()*e.getWidth(),(1-e.getWallHeight()-e.getWallTop())*e.getHeight())),t.transform(java.awt.geom.AffineTransform.getScaleInstance(1/e.getWidth(),1/e.getHeight())),t.transform(java.awt.geom.AffineTransform.getTranslateInstance(-.5,-.5)));var m=new java.awt.geom.Area(Wall3D.FULL_FACE_CUT_OUT_AREA);if(m.subtract(t),!m.isEmpty()){var f=e.getDepth(),v=e.getX()-i*f/2*Math.sin(e.getAngle()),_=e.getY()+i*f/2*Math.cos(e.getAngle()),S=g===Wall3D.WALL_LEFT_SIDE?l[0]:l[l.length-1],y=g===Wall3D.WALL_LEFT_SIDE?l[(l.length/2|0)-1]:l[l.length/2|0],E=java.awt.geom.Line2D.ptLineDist(S[0],S[1],y[0],y[1],v,_),C=i*(.5-java.awt.geom.Line2D.relativeCCW(S[0],S[1],y[0],y[1],v,_)*E/f),P=ModelManager.getInstance().getPieceOfFurnitureNormalizedModelTransformation(e,null),w=mat4.create();mat4.fromTranslation(w,vec3.fromValues(0,0,C)),mat4.mul(P,P,w);var L=mat4.create();mat4.invert(L,P);var T=new java.awt.geom.GeneralPath,A=vec3.fromValues(S[0],a,S[1]);vec3.transformMat4(A,A,L),T.moveTo(A[0],A[1]),A=vec3.fromValues(y[0],a,y[1]),vec3.transformMat4(A,A,L),T.lineTo(A[0],A[1]);var I=vec3.fromValues(y[0],this.getWallPointElevation(y[0],y[1],s,h,u,d),y[1]);vec3.transformMat4(I,I,L),T.lineTo(I[0],I[1]);var b=vec3.fromValues(S[0],this.getWallPointElevation(S[0],S[1],s,h,u,d),S[1]);vec3.transformMat4(b,b,L),T.lineTo(b[0],b[1]),T.closePath();var O=new java.awt.geom.GeneralPath;O.moveTo(-.5,-.5),O.lineTo(-.5,.5),O.lineTo(.5,.5),O.lineTo(.5,-.5),O.closePath();var M=new java.awt.geom.Area(O);M.intersect(new java.awt.geom.Area(T)),M.subtract(t);var D=.5/Math.max(e.getWidth(),e.getHeight());if(!M.isEmpty()){var R=i>0!=(g===Wall3D.WALL_RIGHT_SIDE)!==e.isModelMirrored(),F=this.getAreaPoints(M,D,R);if(0!==F.length){for(var x=new Array(F.length),N=0,k=0;k<F.length;k++){var H=F[k];x[k]=H.length+1,N+=x[k]}var V=n.getThickness()/2,U=V*h,W=-V*s;g===Wall3D.WALL_LEFT_SIDE&&(U*=-1,W*=-1);var B,G,Y=new Array(N),$=[],X=[];null!=c?(B=new Array(Y.length),G=[]):(B=null,G=null);k=0;for(var z=0;z<F.length;z++){H=F[z];var j=vec3.fromValues(H[0][0],H[0][1],0);vec3.transformMat4(j,j,P);var K=null;if(null!=c){var J=java.awt.geom.Point2D.distance(p[0],p[1],j[0],j[2]);g===Wall3D.WALL_LEFT_SIDE&&c.isLeftToRightOriented()&&(J=-J),K=vec2.fromValues(J,j[1])}for(var q=java.awt.geom.Line2D.ptLineDistSq(I[0],I[1],b[0],b[1],H[0][0],H[0][1]),Z=0;Z<H.length;Z++,k++){Y[k]=j,null!=c&&(B[k]=K);var Q,ee=Z<H.length-1?Z+1:0,te=java.awt.geom.Line2D.ptLineDistSq(I[0],I[1],b[0],b[1],H[ee][0],H[ee][1]);Q=q<1e-10&&te<1e-10?X:$;var ie=vec3.fromValues(H[ee][0],H[ee][1],0);vec3.transformMat4(ie,ie,P),Q.push(j),Q.push(vec3.fromValues(j[0]+U,j[1],j[2]+W)),Q.push(vec3.fromValues(ie[0]+U,ie[1],ie[2]+W)),Q.push(ie);var ne=null;if(null!=c){J=java.awt.geom.Point2D.distance(p[0],p[1],ie[0],ie[2]);g===Wall3D.WALL_LEFT_SIDE&&c.isLeftToRightOriented()&&(J=-J),ne=vec2.fromValues(J,ie[1]),Q===$&&(G.push(K),G.push(K),G.push(ne),G.push(ne))}q=te,j=ie,K=ne}Y[k]=j,null!=c&&(B[k]=K),k++}var oe=new GeometryInfo3D(GeometryInfo3D.POLYGON_ARRAY);oe.setStripCounts(x),oe.setCoordinates(Y),null!==c&&oe.setTextureCoordinates(B),oe.setGeneratedNormals(!0),o.push(oe.getIndexedGeometryArray()),$.length>0&&((oe=new GeometryInfo3D(GeometryInfo3D.QUAD_ARRAY)).setCoordinates($.slice(0)),null!==c&&oe.setTextureCoordinates(G.slice(0)),oe.setCreaseAngle(Math.PI/2),oe.setGeneratedNormals(!0),o.push(oe.getIndexedGeometryArray())),X.length>0&&((oe=new GeometryInfo3D(GeometryInfo3D.QUAD_ARRAY)).setCoordinates(X.slice(0)),oe.setGeneratedNormals(!0),r.push(oe.getIndexedGeometryArray()))}}}},Wall3D.prototype.getWallElevation=function(e){var t=this.getUserData().getLevel();if(null===t)return 0;if(e)return t.getElevation();var i=this.getFloorThicknessBottomWall();return i>0&&(i-=Wall3D.LEVEL_ELEVATION_SHIFT),t.getElevation()-i},Wall3D.prototype.getFloorThicknessBottomWall=function(){var e=this.getUserData().getLevel();if(null==e)return 0;var t=this.getHome().getLevels();return 0!==t.length&&t[0].getElevation()===e.getElevation()?0:e.getFloorThickness()},Wall3D.prototype.getWallTopElevationAtStart=function(){var e=this.getUserData().getHeight();return(null!==e?e+this.getWallElevation(!1)+this.getFloorThicknessBottomWall():this.getHome().getWallHeight()+this.getWallElevation(!1)+this.getFloorThicknessBottomWall())+this.getTopElevationShift()},Wall3D.prototype.getTopElevationShift=function(){var e=this.getUserData().getLevel();if(null!==e){var t=this.getHome().getLevels();if(t[t.length-1]!==e)return Wall3D.LEVEL_ELEVATION_SHIFT}return 0},Wall3D.prototype.getWallTopElevationAtEnd=function(){var e=this.getUserData();return e.isTrapezoidal()?e.getHeightAtEnd()+this.getWallElevation(!1)+this.getFloorThicknessBottomWall()+this.getTopElevationShift():this.getWallTopElevationAtStart()},Wall3D.prototype.getBaseboardTopElevation=function(e){return e.getHeight()+this.getWallElevation(!0)},Wall3D.prototype.createWallSelectionGeometry=function(){for(var e=this.getUserData(),t=this.getWallElevation(!0),i=e.getLeftSideBaseboard(),n=e.getRightSideBaseboard(),o=e.getPoints(),r=e.getPoints(!0),l=new Array(2*o.length+(null!=i?4:0)+(null!=n?4:0)),a=new Array(4*o.length+(null!=i?12:4)+(null!=n?12:4)),s=0,h=0,u=0;u<o.length;u++,s++)l[s]=vec3.fromValues(r[u][0],t,r[u][1]),a[h++]=s,u>0&&(a[h++]=s);a[h++]=0;var d,c,p=this.getWallTopElevationAtStart(),g=this.getWallTopElevationAtEnd(),m=Math.atan2(e.getYEnd()-e.getYStart(),e.getXEnd()-e.getXStart()),f=Math.cos(m),v=Math.sin(m),_=f*e.getXStart()+v*e.getYStart(),S=f*e.getXEnd()+v*e.getYEnd();p==g?(d=0,c=p):c=p-(d=(g-p)/(S-_))*_;for(u=0;u<o.length;u++,s++){var y=d*(f*o[u][0]+v*o[u][1])+c;l[s]=vec3.fromValues(o[u][0],y,o[u][1]),a[h++]=s,u>0&&(a[h++]=s)}if(a[h++]=o.length,a[h++]=0,null!=i){var E=this.getBaseboardTopElevation(i);l[s]=vec3.fromValues(r[0][0],Math.min(E,p),r[0][1]),a[h++]=s,a[h++]=s++,l[s]=vec3.fromValues(o[0][0],Math.min(E,p),o[0][1]),a[h++]=s,a[h++]=s++}if(a[h++]=o.length,a[h++]=o.length/2-1,null!=i){E=this.getBaseboardTopElevation(i);l[s]=vec3.fromValues(r[o.length/2-1][0],Math.min(E,g),r[o.length/2-1][1]),a[h++]=s,a[h++]=s++,l[s]=vec3.fromValues(o[o.length/2-1][0],Math.min(E,g),o[o.length/2-1][1]),a[h++]=s,a[h++]=s++}if(a[h++]=o.length+o.length/2-1,a[h++]=o.length-1,null!=n){var C=this.getBaseboardTopElevation(n);l[s]=vec3.fromValues(r[o.length-1][0],Math.min(C,p),r[o.length-1][1]),a[h++]=s,a[h++]=s++,l[s]=vec3.fromValues(o[o.length-1][0],Math.min(C,p),o[o.length-1][1]),a[h++]=s,a[h++]=s++}if(a[h++]=2*o.length-1,a[h++]=o.length/2,null!=n){C=this.getBaseboardTopElevation(n);l[s]=vec3.fromValues(r[o.length/2][0],Math.min(C,g),r[o.length/2][1]),a[h++]=s,a[h++]=s++,l[s]=vec3.fromValues(o[o.length/2][0],Math.min(C,g),o[o.length/2][1]),a[h++]=s,a[h++]=s++}return a[h++]=o.length+o.length/2,new IndexedLineArray3D(l,a)},Wall3D.prototype.updateWallAppearance=function(e){for(var t=this.getUserData(),i=t.getTopColor(),n=[this.getChild(0),this.getChild(2),this.getChild(4),this.getChild(6)],o=[this.getChild(1),this.getChild(3),this.getChild(5),this.getChild(7)],r=0;r<n.length;r++)if(1===r){var l=t.getLeftSideBaseboard();if(null!=l){var a=l.getTexture();null===(h=l.getColor())&&null===a&&(a=t.getLeftSideTexture(),h=t.getLeftSideColor()),this.updateFilledWallSideAppearance(n[r].getChild(0).getAppearance(),a,e,h,t.getLeftSideShininess())}var s=t.getRightSideBaseboard();if(null!=s){var h;a=s.getTexture();null==(h=s.getColor())&&null==a&&(a=t.getRightSideTexture(),h=t.getRightSideColor()),this.updateFilledWallSideAppearance(o[r].getChild(0).getAppearance(),a,e,h,t.getRightSideShininess())}}else 3!==r||null==i?(this.updateFilledWallSideAppearance(n[r].getChild(0).getAppearance(),t.getLeftSideTexture(),e,t.getLeftSideColor(),t.getLeftSideShininess()),this.updateFilledWallSideAppearance(o[r].getChild(0).getAppearance(),t.getRightSideTexture(),e,t.getRightSideColor(),t.getRightSideShininess())):(this.updateFilledWallSideAppearance(n[r].getChild(0).getAppearance(),null,e,i,0),this.updateFilledWallSideAppearance(o[r].getChild(0).getAppearance(),null,e,i,0));this.getChild(8).getAppearance().setVisible(null!=this.getUserPreferences()&&this.getUserPreferences().isEditingIn3DViewEnabled()&&this.getHome().isItemSelected(t))},Wall3D.prototype.updateFilledWallSideAppearance=function(e,t,i,n,o){null==t?(this.updateAppearanceMaterial(e,n,n,o),e.setTextureImage(null)):(this.updateAppearanceMaterial(e,Object3DBranch.DEFAULT_COLOR,Object3DBranch.DEFAULT_AMBIENT_COLOR,o),this.updateTextureTransform(e,t,!0),TextureManager.getInstance().loadTexture(t.getImage(),i,{textureUpdated:function(t){e.setTextureImage(t)},textureError:function(e){return this.textureUpdated(TextureManager.getInstance().getErrorImage())}}));var r=this.getHome().getEnvironment().getWallsAlpha();e.setTransparency(r)},Wall3D.DoorOrWindowArea=function(e,t){this.area=e,this.doorsOrWindows=t},Wall3D.DoorOrWindowArea.prototype.getArea=function(){return this.area},Wall3D.DoorOrWindowArea.prototype.getDoorsOrWindows=function(){return this.doorsOrWindows},Ground3D.prototype=Object.create(Object3DBranch.prototype),Ground3D.prototype.constructor=Ground3D,Ground3D.prototype.update=function(e){void 0===e&&(e=!1);var t=this.getUserData(),i=this.getChild(1),n=i.getChild(0).getAppearance(),o=null;if(t.getEnvironment().isBackgroundImageVisibleOnGround3D()){var r=t.getLevels();if(r.length>0)for(var l=r.length-1;l>=0;l--){var a=r[l];if(0==a.getElevation()&&a.isViewableAndVisible()&&null!==a.getBackgroundImage()&&a.getBackgroundImage().isVisible()){o=a.getBackgroundImage();break}}else null!==t.getBackgroundImage()&&t.getBackgroundImage().isVisible()&&(o=t.getBackgroundImage())}if(null!==o){var s=this;TextureManager.getInstance().loadTexture(o.getImage(),e,{textureUpdated:function(t){var r=o.getScale(),l=r*t.width,a=r*t.height,h=mat4.create();mat4.scale(h,h,vec3.fromValues(l,1,a));var u=mat4.create();mat4.fromTranslation(u,vec3.fromValues(l/2-o.getXOrigin(),0,a/2-o.getYOrigin())),mat4.mul(h,u,h),n.setTextureImage(t),i.setTransform(h),s.updateGround(e,new java.awt.geom.Rectangle2D.Float(-o.getXOrigin(),-o.getYOrigin(),l,a))},textureError:function(e){return this.textureUpdated(TextureManager.getInstance().getErrorImage())},progression:function(e,t,i){}}),n.setVisible(!0)}else n.setVisible(!1),this.updateGround(e,null)},Ground3D.prototype.updateGround=function(e,t){var i=this.getUserData(),n=this.getChild(0),o=n.getGeometries().length,r=n.getAppearance(),l=i.getEnvironment().getGroundTexture();if(null===l){var a=i.getEnvironment().getGroundColor();this.updateAppearanceMaterial(r,a,a,0),r.setTextureImage(null)}else this.updateAppearanceMaterial(r,Object3DBranch.DEFAULT_COLOR,Object3DBranch.DEFAULT_COLOR,0),this.updateTextureTransform(r,l,!0),TextureManager.getInstance().loadTexture(l.getImage(),e,{textureUpdated:function(e){r.setTextureImage(e)},textureError:function(e){return this.textureUpdated(TextureManager.getInstance().getErrorImage())}});var s=new java.awt.geom.Area;null!==t&&s.add(new java.awt.geom.Area(t));for(var h=[],u=i.getRooms(),d=0;d<u.length;d++){var c=u[d],p=c.getLevel();if((null===p||p.isViewable())&&c.isFloorVisible()){var g=c.getPoints();if(g.length>2){var m=new java.awt.geom.Area(this.getShape(g)),f=null!==p&&p.getElevation()<0?this.getUndergroundAreas(h,p):null;(null===p||p.getElevation()<=0&&p.isViewableAndVisible())&&(s.add(m),null!==f&&f.roomArea.add(m)),null!==f&&f.undergroundArea.add(m)}}}this.updateUndergroundAreasDugByFurniture(h,i.getFurniture());var v=i.getWalls();for(d=0;d<v.length;d++){var _=v[d],S=_.getLevel();if(null!==S&&S.isViewable()&&S.getElevation()<0)(f=this.getUndergroundAreas(h,S)).wallArea.add(new java.awt.geom.Area(this.getShape(_.getPoints())))}var y=h;for(d=0;d<y.length;d++){f=y[d];for(var E=this.getPoints(f.wallArea),C=0;C<E.length;C++){var P=E[C];new Room(P).isClockwise()||f.undergroundArea.add(new java.awt.geom.Area(this.getShape(P)))}}y.sort((function(e,t){var i=-(e.level.getElevation()-t.level.getElevation());return 0!==i?i:e.level.getElevationIndex()-t.level.getElevationIndex()}));for(d=0;d<y.length;d++){var w=(f=y[d]).level,L=f.undergroundArea,T=L.clone();f.undergroundSideArea.add(L.clone());for(C=0;C<y.length;C++){var A=y[C];if(A.level.getElevation()<w.getElevation()){E=this.getPoints(A.undergroundArea);for(var I=0;I<E.length;I++){P=E[I];if(!new Room(P).isClockwise()){var b=new java.awt.geom.Area(this.getShape(P));L.subtract(b),f.undergroundSideArea.add(b)}}}}for(E=this.getPoints(L),C=0;C<E.length;C++){P=E[C];if(new Room(P).isClockwise()){var O=new java.awt.geom.Area(this.getShape(P));O.exclusiveOr(T),O.subtract(T),f.upperLevelArea.add(O)}else s.add(new java.awt.geom.Area(this.getShape(P)))}}for(d=0;d<y.length;d++){null!==(m=(f=y[d]).roomArea)&&f.undergroundArea.subtract(m)}var M=new java.awt.geom.Area(this.getShape([[this.originX,this.originY],[this.originX,this.originY+this.depth],[this.originX+this.width,this.originY+this.depth],[this.originX+this.width,this.originY]])),D=s.getBounds2D();if(!M.getBounds2D().equals(D)){var R=M;s.isEmpty()?(D=new java.awt.geom.Rectangle2D.Float(Math.max(-5e3,this.originX),Math.max(-5e3,this.originY),0,0)).add(Math.min(5e3,this.originX+this.width),Math.min(5e3,this.originY+this.depth)):(D.add(Math.max(D.getMinX()-5e3,this.originX),Math.max(D.getMinY()-5e3,this.originY)),D.add(Math.min(D.getMaxX()+5e3,this.originX+this.width),Math.min(D.getMaxY()+5e3,this.originY+this.depth))),M=new java.awt.geom.Area(D),R.subtract(M),this.addAreaGeometry(n,l,R,0)}M.subtract(s),y.splice(0,0,new Ground3D.LevelAreas(new Level("Ground",0,0,0),M));var F=0;for(d=0;d<y.length;d++){var x=(f=y[d]).level.getElevation();if(this.addAreaGeometry(n,l,f.undergroundArea,x),F-x>0){for(E=this.getPoints(f.undergroundSideArea),C=0;C<E.length;C++){P=E[C];this.addAreaSidesGeometry(n,l,P,x,F-x)}this.addAreaGeometry(n,l,f.upperLevelArea,F)}F=x}for(d=o-1;d>=0;d--)n.removeGeometry(d)},Ground3D.prototype.getPoints=function(e){for(var t=[],i=[],n=null,o=e.getPathIterator(null,1);!o.isDone();o.next()){var r=[0,0];o.currentSegment(r)===java.awt.geom.PathIterator.SEG_CLOSE?(i[0][0]===n[0]&&i[0][1]===n[1]&&i.splice(i.length-1,1),i.length>2&&t.push(i.slice(0)),i.length=0,n=null):(null!==n&&r[0]===n[0]&&r[1]===n[1]||i.push(r),n=r)}return t},Ground3D.prototype.getUndergroundAreas=function(e,t){for(var i=null,n=0;n<e.length;n++)if(e[n].level===t){i=e[n];break}return null===i&&e.push(i=new Ground3D.LevelAreas(t)),i},Ground3D.prototype.updateUndergroundAreasDugByFurniture=function(e,t){for(var i=0;i<t.length;i++){var n=t[i],o=n.getLevel();if(n.getGroundElevation()<0&&n.isVisible()&&null!==o&&o.isViewable()&&o.getElevation()<0)if(n instanceof HomeFurnitureGroup)this.updateUndergroundAreasDugByFurniture(e,n.getFurniture());else{var r=this.getUndergroundAreas(e,o);null===n.getStaircaseCutOutShape()?r.undergroundArea.add(new java.awt.geom.Area(this.getShape(n.getPoints()))):r.undergroundArea.add(ModelManager.getInstance().getAreaOnFloor(n))}}},Ground3D.prototype.addAreaGeometry=function(e,t,i,n){var o=this.getAreaPoints(i,1,!1);if(0!==o.length){for(var r=0,l=new Array(o.length),a=0;a<l.length;a++)l[a]=o[a].length,r+=l[a];for(var s=new Array(r),h=null!==t?new Array(r):null,u=0,d=0;d<o.length;d++){var c=o[d];for(a=0;a<c.length;a++,u++){var p=c[a];s[u]=vec3.fromValues(p[0],n,p[1]),null!==t&&(h[u]=vec2.fromValues(p[0]-this.originX,this.originY-p[1]))}}var g=new GeometryInfo3D(GeometryInfo3D.POLYGON_ARRAY);g.setCoordinates(s),null!==t&&g.setTextureCoordinates(h),g.setStripCounts(l),g.setCreaseAngle(0),g.setGeneratedNormals(!0),e.addGeometry(g.getIndexedGeometryArray())}},Ground3D.prototype.addAreaSidesGeometry=function(e,t,i,n,o){for(var r=new Array(4*i.length),l=null!==t?new Array(r.length):null,a=0,s=0;a<i.length;a++){var h=i[a],u=i[a<i.length-1?a+1:0];if(r[s++]=vec3.fromValues(h[0],n,h[1]),r[s++]=vec3.fromValues(h[0],n+o,h[1]),r[s++]=vec3.fromValues(u[0],n+o,u[1]),r[s++]=vec3.fromValues(u[0],n,u[1]),null!==t){var d=java.awt.geom.Point2D.distance(h[0],h[1],u[0],u[1]);l[s-4]=vec2.fromValues(h[0],n),l[s-3]=vec2.fromValues(h[0],n+o),l[s-2]=vec2.fromValues(h[0]-d,n+o),l[s-1]=vec2.fromValues(h[0]-d,n)}}var c=new GeometryInfo3D(GeometryInfo3D.QUAD_ARRAY);c.setCoordinates(r),null!==t&&c.setTextureCoordinates(l),c.setCreaseAngle(0),c.setGeneratedNormals(!0),e.addGeometry(c.getIndexedGeometryArray())},Ground3D.LevelAreas=function(e,t){void 0===t&&(t=new java.awt.geom.Area),this.level=e,this.undergroundArea=t,this.roomArea=new java.awt.geom.Area,this.wallArea=new java.awt.geom.Area,this.undergroundSideArea=new java.awt.geom.Area,this.upperLevelArea=new java.awt.geom.Area},Polyline3D.prototype=Object.create(Object3DBranch.prototype),Polyline3D.prototype.constructor=Polyline3D,Polyline3D.ARROW=null,Polyline3D.prototype.update=function(){var e=this.getUserData();if(e.isVisibleIn3D()&&(null==e.getLevel()||e.getLevel().isViewableAndVisible())){for(var t=ShapeTools.getStroke(e.getThickness(),e.getCapStyle(),e.getJoinStyle(),e.getDashStyle()!==Polyline.DashStyle.SOLID?e.getDashPattern():null,e.getDashOffset()),i=ShapeTools.getPolylineShape(e.getPoints(),e.getJoinStyle()===Polyline.JoinStyle.CURVED,e.isClosedPath()),n=null,o=null,r=null,l=null,a=i.getPathIterator(null,.5);!a.isDone();a.next()){var s=[0,0];a.currentSegment(s)!==java.awt.geom.PathIterator.SEG_CLOSE&&(null===n?n=s:null===o&&(o=s),r=l,l=s)}for(var h=Math.atan2(n[1]-o[1],n[0]-o[0]),u=Math.atan2(l[1]-r[1],l[0]-r[0]),d=e.getCapStyle()!==Polyline.CapStyle.BUTT?e.getThickness()/2:0,c=[this.getArrowShape(n,h,e.getStartArrowStyle(),e.getThickness(),d),this.getArrowShape(l,u,e.getEndArrowStyle(),e.getThickness(),d),t.createStrokedShape(i)],p=new java.awt.geom.Area,g=0;g<c.length;g++){null!=(N=c[g])&&p.add(new java.awt.geom.Area(N))}var m=this.getAreaPoints(p,.5,!1),f=0;for(g=0;g<m.length;g++)f+=m[g].length;for(var v=new Array(f),_=new Array(m.length),S=new Array(2*f),y=(g=0,0),E=0;g<m.length;g++){for(var C=m[g],P=y,w=0;w<C.length;w++){var L=C[w];S[E++]=y,w>0&&(S[E++]=y),v[y++]=vec3.fromValues(L[0],0,L[1])}S[E++]=P,_[g]=C.length}var T=new GeometryInfo3D(GeometryInfo3D.POLYGON_ARRAY);T.setCoordinates(v);var A=new Array(v.length),I=vec3.fromValues(0,1,0);for(g=0;g<v.length;g++)A[g]=I;T.setNormals(A),T.setStripCounts(_);var b,O=T.getIndexedGeometryArray(),M=new IndexedLineArray3D(v,S);if(0===this.getChildren().length){var D=new BranchGroup3D;(b=new TransformGroup3D).setCapability(TransformGroup3D.ALLOW_TRANSFORM_WRITE),D.addChild(b);var R=new Appearance3D;this.updateAppearanceMaterial(R,Object3DBranch.DEFAULT_COLOR,Object3DBranch.DEFAULT_AMBIENT_COLOR,0),R.setCullFace(Appearance3D.CULL_NONE),(N=new Shape3D(O,R)).setCapability(Shape3D.ALLOW_GEOMETRY_WRITE),b.addChild(N),this.addChild(D);var F,x=new Shape3D(M,F=this.getSelectionAppearance());x.setCapability(Shape3D.ALLOW_GEOMETRY_WRITE),x.setPickable(!1),b.addChild(x)}else{var N;(N=(b=this.getChild(0).getChild(0)).getChild(0)).setGeometry(O,0),(x=b.getChild(1)).setGeometry(M,0),F=x.getAppearance()}var k=mat4.create();mat4.fromTranslation(k,vec3.fromValues(0,e.getGroundElevation()+(e.getElevation()<.05?.05:0),0)),b.setTransform(k),this.updateAppearanceMaterial(b.getChild(0).getAppearance(),e.getColor(),e.getColor(),0),F.setVisible(null!=this.getUserPreferences()&&this.getUserPreferences().isEditingIn3DViewEnabled()&&this.getHome().isItemSelected(e))}else this.removeAllChildren()},Polyline3D.prototype.getArrowShape=function(e,t,i,n,o){if(null!=i&&i!==Polyline.ArrowStyle.NONE){var r=java.awt.geom.AffineTransform.getTranslateInstance(e[0],e[1]);r.rotate(t),r.translate(o,0);var l=2*Math.pow(n,.66);r.scale(l,l);var a=new java.awt.geom.GeneralPath;switch(i){case Polyline.ArrowStyle.DISC:a.append(new java.awt.geom.Ellipse2D.Float(-3.5,-2,4,4),!1);break;case Polyline.ArrowStyle.OPEN:var s=new java.awt.BasicStroke(n/l/.9,java.awt.BasicStroke.CAP_BUTT,java.awt.BasicStroke.JOIN_MITER);a.append(s.createStrokedShape(Polyline3D.ARROW).getPathIterator(java.awt.geom.AffineTransform.getScaleInstance(.9,.9),0),!1);break;case Polyline.ArrowStyle.DELTA:var h=new java.awt.geom.GeneralPath(Polyline3D.ARROW);h.closePath(),a.append(h.getPathIterator(java.awt.geom.AffineTransform.getTranslateInstance(1.65,0),0),!1);break;default:return null}return a.createTransformedShape(r)}return null},DimensionLine3D.prototype=Object.create(Object3DBranch.prototype),DimensionLine3D.prototype.constructor=DimensionLine3D,DimensionLine3D.prototype.update=function(){var e=this.getUserData();if(e.isVisibleIn3D()&&(null==e.getLevel()||e.getLevel().isViewableAndVisible())){var t=e.getLength(),i=this.getUserPreferences().getLengthUnit().getFormat().format(t),n=e.getLengthStyle();null==n&&(n=this.getUserPreferences().getDefaultTextStyle(DimensionLine)),null==n.getFontName()&&(n=n.deriveStyle(this.getUserPreferences().getDefaultFontName()));var o=n.getFontName();null===o&&(o="sans-serif");var r=n.getFontSize();-1===["Times","Serif","Helvetica"].indexOf(o)&&(r*=1.18);var l,a,s,h,u=.23*r,d=r-u,c=e.getOffset(),p=c<=0?-u-1:d+1;if(0===this.getChildren().length){var g=new BranchGroup3D;(l=new TransformGroup3D).setCapability(TransformGroup3D.ALLOW_TRANSFORM_WRITE),labelTransformGroup=new TransformGroup3D,labelTransformGroup.setCapability(TransformGroup3D.ALLOW_TRANSFORM_WRITE),l.addChild(labelTransformGroup),(v=new Label(i,0,p)).setColor(e.getColor()),v.setStyle(n),v.setPitch(0);var m=new Label3D(v,null,!1);labelTransformGroup.addChild(m);var f=new Shape3D;(a=new Appearance3D).setIllumination(0),f.setAppearance(a),f.setCapability(Shape3D.ALLOW_GEOMETRY_WRITE),l.addChild(f),s=new Shape3D,h=this.getSelectionAppearance(),s.setAppearance(this.getSelectionAppearance()),s.setCapability(Shape3D.ALLOW_GEOMETRY_WRITE),s.setPickable(!1),l.addChild(s),g.addChild(l),this.addChild(g)}else{var v;(v=(m=(l=this.getChild(0).getChild(0)).getChild(0).getChild(0)).getUserData()).setText(i),v.setY(p),v.setColor(e.getColor()),v.setStyle(n),m.update(),a=(f=l.getChild(1)).getAppearance(),h=(s=l.getChild(2)).getAppearance()}var _=e.getElevationStart(),S=mat4.create();mat4.fromTranslation(S,vec3.fromValues(e.getXStart(),null!=e.getLevel()?e.getLevel().getElevation()+_:_,e.getYStart())),null==this.dimensionLineRotations&&(this.dimensionLineRotations=mat4.create());var y=Math.atan2(e.getElevationEnd()-_,e.getXEnd()-e.getXStart());mat4.fromZRotation(this.dimensionLineRotations,y);var E=mat4.create(),C=Math.atan2(e.getYStart()-e.getYEnd(),e.getXEnd()-e.getXStart());mat4.fromYRotation(E,C),mat4.mul(this.dimensionLineRotations,this.dimensionLineRotations,E),E=mat4.create(),mat4.fromXRotation(E,-e.getPitch()),mat4.mul(this.dimensionLineRotations,this.dimensionLineRotations,E),mat4.mul(S,S,this.dimensionLineRotations);var P=mat4.create();mat4.fromTranslation(P,vec3.fromValues(0,0,c)),mat4.mul(S,S,P),l.setTransform(S);var w=e.getEndMarkSize()/2,L=new Array(14);L[0]=vec3.fromValues(0,0,0),L[1]=vec3.fromValues(t,0,0),L[2]=vec3.fromValues(-w,0,w),L[3]=vec3.fromValues(w,0,-w),L[4]=vec3.fromValues(0,0,w),L[5]=vec3.fromValues(0,0,-w),L[6]=vec3.fromValues(t-w,0,w),L[7]=vec3.fromValues(t+w,0,-w),L[8]=vec3.fromValues(t,0,w),L[9]=vec3.fromValues(t,0,-w),L[10]=vec3.fromValues(0,0,-c),L[11]=vec3.fromValues(0,0,-w),L[12]=vec3.fromValues(t,0,-c),L[13]=vec3.fromValues(t,0,-w);var T=new IndexedLineArray3D(L,[0,1,2,3,4,5,6,7,8,9,10,11,12,13]);f.setGeometry(T,0),s.setGeometry(T,0),this.updateAppearanceMaterial(a,null!=e.getColor()?e.getColor():0,0,0);var A=this.getHome(),I=null!=this.getUserPreferences()&&this.getUserPreferences().isEditingIn3DViewEnabled()&&A.isItemSelected(e);h.setVisible(I),a.setVisible(!I),this.updateLengthLabelDirection(A.getCamera());var b=this;null==this.cameraChangeListener&&(this.cameraChangeListener=function(e){var t=b.getUserData();if(b.getChildren().length>0&&t.isVisibleIn3D()&&(null==t.getLevel()||t.getLevel().isViewableAndVisible())){var i=e.getPropertyName();"X"!=i&&"Y"!=i&&"Z"!=i||b.updateLengthLabelDirection(e.getSource())}},this.homeCameraListener=function(e){e.getOldValue().removePropertyChangeListener(b.cameraChangeListener),e.getNewValue().addPropertyChangeListener(b.cameraChangeListener),b.updateLengthLabelDirection(A.getCamera())},this.dimensionLinesListener=function(t){t.getType()===CollectionEvent.Type.DELETE&&t.getItem()===e&&(A.getCamera().removePropertyChangeListener(b.cameraChangeListener),A.removePropertyChangeListener("CAMERA",b.homeCameraListener),A.removeDimensionLinesListener(b.dimensionLinesListener))},A.getCamera().addPropertyChangeListener(this.cameraChangeListener),A.addPropertyChangeListener("CAMERA",this.homeCameraListener),A.addDimensionLinesListener(this.dimensionLinesListener))}else this.removeAllChildren(),this.dimensionLineRotations=null,null!=this.cameraChangeListener&&(this.getHome().getCamera().removePropertyChangeListener(this.cameraChangeListener),this.getHome().removePropertyChangeListener("CAMERA",this.homeCameraListener),this.getHome().removeDimensionLinesListener(this.dimensionLinesListener),this.cameraChangeListener=null,this.homeCameraListener=null,this.dimensionLinesListener=null)},DimensionLine3D.prototype.updateLengthLabelDirection=function(e){var t=this.getUserData(),i=vec3.fromValues(0,1,0);vec3.transformMat4(i,i,this.dimensionLineRotations);var n=vec3.fromValues((t.getXEnd()+t.getXStart())/2-e.getX(),(t.getElevationEnd()+t.getElevationStart())/2-e.getZ(),(t.getYEnd()+t.getYStart())/2-e.getY()),o=this.getChild(0).getChild(0).getChild(0),r=mat4.create();mat4.fromTranslation(r,vec3.fromValues(t.getLength()/2,0,0));var l=mat4.create();mat4.fromZRotation(l,vec3.dot(i,n)>0?Math.PI:0),mat4.mul(r,r,l),o.setTransform(r)},Label3D.prototype=Object.create(Object3DBranch.prototype),Label3D.prototype.constructor=Label3D,Label3D.dummyContext=document.createElement("canvas").getContext("2d"),Label3D.prototype.update=function(){var e=this.getUserData(),t=e.getPitch(),i=e.getStyle();if(null==t||null==i||null!=e.getLevel()&&!e.getLevel().isViewableAndVisible())this.clear();else{var n=e.getText(),o=e.getColor(),r=e.getOutlineColor();if(n!=this.text||null==i&&null!=this.style||null!=i&&!i.equals(this.style)||null==o&&null!=this.color||null!=o&&o!==this.color){var l="";i.isBold()&&(l="bold "),i.isItalic()&&(l+="italic ");var a=i.getFontName();null===a&&(a="sans-serif");var s=50;-1===["Times","Serif","Helvetica"].indexOf(a)&&(s*=1.18);var h=50/i.getFontSize(),u=.23*s,d=l+" 50px "+a;Label3D.dummyContext.font=d;for(var c=n.replace(/\n*$/,"").split("\n"),p=new Array(c.length),g=-1/0,m=-u+s*c.length,f=0;f<c.length;f++)p[f]=Label3D.dummyContext.measureText(c[f]).width,i.isItalic()&&(p[f]+=.154*s),g=Math.max(p[f],g);var v,_,S,y=s*c.length,E=Math.sqrt(g/y);if((E=Math.sqrt(g/y))>1?(S=(v=Math.ceil(Math.max(255*E,Math.min(g,511*E))))/g,_=Math.ceil(S*y)):(S=(_=Math.ceil(Math.max(255*E,Math.min(y,511/E))))/y,v=Math.ceil(S*g)),v>0&&_>0){var C=document.createElement("canvas");C.width=Appearance3D.getNextHighestPowerOfTwo(v)/2,C.height=Appearance3D.getNextHighestPowerOfTwo(_)/2,C.transparent=!0;var P=C.getContext("2d");P.scale(S/v*C.width,S/_*C.height),P.translate(0,m),P.font=d,null!==o&&(P.fillStyle="rgb("+(o>>>16&255)+","+(o>>>8&255)+","+(255&o)+")"),null!==r&&(P.strokeStyle="rgb("+(r>>>16&255)+","+(r>>>8&255)+","+(255&r)+")");for(f=c.length-1;f>=0;f--){var w=c[f];L=i.getAlignment()===TextStyle.Alignment.LEFT?0:i.getAlignment()===TextStyle.Alignment.RIGHT?g-p[f]:(g-p[f])/2,P.translate(L,0),P.fillText(w,0,0),null!==r&&P.strokeText(w,0,0),P.translate(-L,-s)}var L,T=mat4.create();mat4.scale(T,T,vec3.fromValues(g/h,1,y/h)),this.baseLineTransform=mat4.create(),L=i.getAlignment()==TextStyle.Alignment.LEFT?g/2:i.getAlignment()==TextStyle.Alignment.RIGHT?-g/2:0,mat4.fromTranslation(this.baseLineTransform,vec3.fromValues(L/h,0,(y/2-m)/h)),mat4.mul(this.baseLineTransform,this.baseLineTransform,T),this.texture=C,this.text=n,this.style=i,this.color=o}else this.clear()}if(null!==this.texture){var A;if(0===this.getChildren().length){var I=new BranchGroup3D;(D=new TransformGroup3D).setCapability(TransformGroup3D.ALLOW_TRANSFORM_WRITE),I.addChild(D);var b=new Appearance3D;this.updateAppearanceMaterial(b,Object3DBranch.DEFAULT_COLOR,Object3DBranch.DEFAULT_AMBIENT_COLOR,0),b.setCullFace(Appearance3D.CULL_NONE);var O=new Shape3D(new IndexedTriangleArray3D([vec3.fromValues(-.5,0,-.5),vec3.fromValues(-.5,0,.5),vec3.fromValues(.5,0,.5),vec3.fromValues(.5,0,-.5)],[0,1,2,0,2,3],[vec2.fromValues(0,0),vec2.fromValues(1,0),vec2.fromValues(1,1),vec2.fromValues(0,1)],[3,0,1,3,1,2],[vec3.fromValues(0,1,0)],[0,0,0,0,0,0]),b);D.addChild(O),(M=new Shape3D(new IndexedLineArray3D([vec3.fromValues(-.5,0,-.5),vec3.fromValues(.5,0,-.5),vec3.fromValues(.5,0,.5),vec3.fromValues(-.5,0,.5)],[0,1,1,2,2,3,3,0]),A=this.getSelectionAppearance())).setPickable(!1),D.addChild(M),this.addChild(I)}else{var M;A=(M=(D=this.getChild(0).getChild(0)).getChild(1)).getAppearance()}var D=this.getChild(0).getChild(0),R=mat4.create();mat4.fromXRotation(R,t),mat4.mul(R,R,this.baseLineTransform);var F=mat4.create();mat4.fromYRotation(F,-e.getAngle()),mat4.mul(F,F,R);var x=mat4.create();mat4.fromTranslation(x,vec3.fromValues(e.getX(),e.getGroundElevation()+(0==t&&e.getElevation()<.1?.1:0),e.getY())),mat4.mul(x,x,F),D.setTransform(x),D.getChild(0).getAppearance().setTextureImage(this.texture),A.setVisible(null!=this.getUserPreferences()&&this.getUserPreferences().isEditingIn3DViewEnabled()&&this.getHome().isItemSelected(e))}}},Label3D.prototype.clear=function(){this.removeAllChildren(),this.text=null,this.style=null,this.color=null,this.texture=null,this.baseLineTransform=null},TextureManager.READING_TEXTURE="Reading texture",TextureManager.instance=null,TextureManager.getInstance=function(){return null==TextureManager.instance&&(TextureManager.instance=new TextureManager),TextureManager.instance},TextureManager.prototype.clear=function(){this.loadedTextureImages={},this.loadingTextureObservers={}},TextureManager.prototype.loadTexture=function(e,t,i,n){if(void 0===i?(n=t,t=0,i=!1):void 0===n&&(n=i,i=!1),i&&!e.isStreamURLReady())throw new IllegalStateException("Can't run synchronously with unavailable URL");var o=this,r=e.getURL();e.getStreamURL({urlReady:function(e){if(r in o.loadedTextureImages)void 0!==n.textureUpdated&&n.textureUpdated(o.loadedTextureImages[r]);else if(i)o.load(e,i,{textureLoaded:function(e){o.loadedTextureImages[r]=e,void 0!==n.textureUpdated&&n.textureUpdated(e)},textureError:function(e){void 0!==n.textureError&&n.textureError(e)},progression:function(e,t,i){void 0!==n.progression&&n.progression(e,t,i)}});else if(r in o.loadingTextureObservers)o.loadingTextureObservers[r].push(n);else{var t=[];t.push(n),o.loadingTextureObservers[r]=t,o.load(e,i,{textureLoaded:function(e){var t=o.loadingTextureObservers[r];if(t){delete o.loadingTextureObservers[r],o.loadedTextureImages[r]=e;for(var i=0;i<t.length;i++)void 0!==t[i].textureUpdated&&t[i].textureUpdated(e)}},textureError:function(e){var t=o.loadingTextureObservers[r];if(t){delete o.loadingTextureObservers[r];for(var i=0;i<t.length;i++)void 0!==t[i].textureError&&t[i].textureError(e)}},progression:function(e,t,i){var n=o.loadingTextureObservers[r];if(n)for(var l=0;l<n.length;l++)void 0!==n[l].progression&&n[l].progression(e,t,i)}})}},urlError:function(e,t){n.textureError(e)}})},TextureManager.prototype.load=function(e,t,i){i.progression(TextureManager.READING_TEXTURE,e,0);var n=new Image;n.crossOrigin="anonymous",n.url=e;var o=function(t){n.removeEventListener("load",r),n.removeEventListener("error",o),i.textureError("Can't load "+e)},r=function(){if(n.removeEventListener("load",r),n.removeEventListener("error",o),i.progression(TextureManager.READING_TEXTURE,e,1),void 0===n.transparent){var l=new XMLHttpRequest;l.open("GET",e,t||e.indexOf("app://")>=0),l.addEventListener("load",(function(){l.readyState!==XMLHttpRequest.DONE||0!==l.status&&200!==l.status||(n.transparent=ZIPTools.isTransparentImage(l.response)),i.textureLoaded(n)})),l.send()}else i.textureLoaded(n)};if(0===e.indexOf("jar:")){var l=e.indexOf("!/"),a=decodeURIComponent(e.substring(l+2)),s=e.substring(4,l);ZIPTools.getZIP(s,t,{zipReady:function(e){try{n.addEventListener("load",r),n.addEventListener("error",o);var i=e.file(a).asBinary(),l=btoa(i);n.transparent=ZIPTools.isTransparentImage(i),n.src="data:image;base64,"+l,(0!==n.width||t)&&r()}catch(e){this.zipError(e)}},zipError:function(e){i.textureError("Can't load "+s)},progression:function(e,t,n){i.progression(e,t,n)}})}else n.addEventListener("load",r),n.addEventListener("error",o),n.src=e,0!==n.width&&r()},TextureManager.prototype.isTextureTransparent=function(e){return!0===e.transparent},TextureManager.prototype.getRotatedTextureWidth=function(e){var t=e.getAngle();return 0!==t?Math.round(Math.abs(e.getWidth()*Math.cos(t))+Math.abs(e.getHeight()*Math.sin(t))):e.getWidth()},TextureManager.prototype.getRotatedTextureHeight=function(e){var t=e.getAngle();return 0!==t?Math.round(Math.abs(e.getWidth()*Math.sin(t))+Math.abs(e.getHeight()*Math.cos(t))):e.getHeight()},TextureManager.prototype.getErrorImage=function(){return void 0===TextureManager.errorImage&&(TextureManager.errorImage=this.getColoredImage("#FF0000")),TextureManager.errorImage},TextureManager.prototype.getWaitImage=function(){return void 0===TextureManager.waitImage&&(TextureManager.waitImage=this.getColoredImage("#FFFFFF")),TextureManager.waitImage},TextureManager.prototype.getColoredImage=function(e){var t=document.createElement("canvas");t.width=2,t.height=2;var i=t.getContext("2d");i.fillStyle=e,i.fillRect(0,0,2,2);var n=t.toDataURL(),o=new Image;return o.url=n,o.src=n,o};var LengthUnit={};function MeterFamilyFormat(e,t,i){DecimalFormat.call(this,e),this.setGroupingUsed(!0),this.unitMultiplier=t,this.unit=i}function SquareMeterAreaFormatWithUnit(e){DecimalFormat.call(this,"0.##"),this.setGroupingUsed(!0),this.squareMeterUnit=e}function InchFractionFormat(e,t){DecimalFormat.call(this,"0.###"),this.setGroupingUsed(!0),this.footInch=e,this.footInchSeparator=t}function SquareFootAreaFormatWithUnit(e,t){DecimalFormat.call(this,e),this.setGroupingUsed(!0),this.unit=t}function InchDecimalsFormat(e,t){DecimalFormat.call(this,e),this.setGroupingUsed(!0),this.unit=t}function FootDecimalsFormat(e,t){DecimalFormat.call(this,e),this.setGroupingUsed(!0),this.unit=t}function UserPreferences(){this.propertyChangeSupport=new PropertyChangeSupport(this),this.initSupportedLanguages(UserPreferences.DEFAULT_SUPPORTED_LANGUAGES),this.resourceBundles=[],this.furnitureCatalogResourceBundles=[],this.texturesCatalogResourceBundles=[],this.furnitureCatalog=null,this.texturesCatalog=null,this.patternsCatalog=null,this.currency=null,this.valueAddedTaxEnabled=!1,this.defaultValueAddedTaxPercentage=null,this.unit=null,this.furnitureCatalogViewedInTree=!1,this.navigationPanelVisible=!0,this.editingIn3DViewEnabled=!1,this.aerialViewCenteredOnSelectionEnabled=!1,this.observerCameraSelectedAtChange=!0,this.magnetismEnabled=!0,this.rulersVisible=!0,this.gridVisible=!0,this.defaultFontName=null,this.furnitureViewedFromTop=!0,this.furnitureModelIconSize=128,this.roomFloorColoredOrTextured=!0,this.wallPattern=null,this.newWallPattern=null,this.newWallThickness=7.5,this.newWallHeight=250,this.newWallBaseboardThickness=1,this.newWallBaseboardHeight=7,this.newRoomFloorColor=null,this.newFloorThickness=12,this.autoSaveDelayForRecovery=0,this.recentHomes=[],this.autoCompletionStrings={},this.recentColors=[],this.recentTextures=[],this.homeExamples=[],this.ignoredActionTips={}}function DefaultUserPreferences(e,t,i,n){var o,r;UserPreferences.call(this),void 0!==e&&"boolean"==typeof e?(o=e,r=t,this.furnitureCatalogUrls=void 0,this.furnitureResourcesUrlBase=void 0,this.texturesCatalogUrls=void 0,this.texturesResourcesUrlBase=void 0):(o=!0,r=Locale.getDefault(),this.furnitureCatalogUrls=e,this.furnitureResourcesUrlBase=t,this.texturesCatalogUrls=i,this.texturesResourcesUrlBase=n);var l=[];l.push(new DefaultPatternTexture("foreground")),l.push(new DefaultPatternTexture("reversedHatchUp")),l.push(new DefaultPatternTexture("reversedHatchDown")),l.push(new DefaultPatternTexture("reversedCrossHatch")),l.push(new DefaultPatternTexture("background")),l.push(new DefaultPatternTexture("hatchUp")),l.push(new DefaultPatternTexture("hatchDown")),l.push(new DefaultPatternTexture("crossHatch"));var a=new PatternsCatalog(l);this.setPatternsCatalog(a),this.setFurnitureCatalog(o&&"function"==typeof DefaultFurnitureCatalog?Array.isArray(e)?new DefaultFurnitureCatalog(e,t):new DefaultFurnitureCatalog(this):new FurnitureCatalog),this.setTexturesCatalog(o&&"function"==typeof DefaultTexturesCatalog?Array.isArray(i)?new DefaultTexturesCatalog(i,n):new DefaultTexturesCatalog(this):new TexturesCatalog),"en_US"==r?(this.setUnit(LengthUnit.INCH),this.setNewWallThickness(7.62),this.setNewWallHeight(243.84),this.setNewWallBaseboardThickness(.9525),this.setNewWallBaseboardHeight(6.35)):(this.setUnit(LengthUnit.CENTIMETER),this.setNewWallThickness(7.5),this.setNewWallHeight(250),this.setNewWallBaseboardThickness(1),this.setNewWallBaseboardHeight(7)),this.setNewFloorThickness(12),this.setNavigationPanelVisible(!1),this.setWallPattern(a.getPattern("hatchUp")),this.setNewWallPattern(this.getWallPattern()),this.setAerialViewCenteredOnSelectionEnabled(!0),this.setAutoSaveDelayForRecovery(6e4)}function DefaultPatternTexture(e){this.name=e,this.image=new URLContent(ZIPTools.getScriptFolder()+"resources/patterns/"+this.name+".png")}function RecordedUserPreferences(e){var t;UserPreferences.call(this),void 0!==e&&(this.furnitureCatalogUrls=e.furnitureCatalogURLs,this.furnitureResourcesUrlBase=e.furnitureResourcesURLBase,this.texturesCatalogUrls=e.texturesCatalogURLs,this.texturesResourcesUrlBase=e.texturesResourcesURLBase,this.writePreferencesUrl=e.writePreferencesURL,this.readPreferencesUrl=e.readPreferencesURL,this.writeResourceUrl=void 0!==e.writePreferencesResourceURL?e.writePreferencesResourceURL:e.writeResourceURL,this.readResourceUrl=void 0!==e.readPreferencesResourceURL?e.readPreferencesResourceURL:e.readResourceURL,this.writingObserver=e.writingObserver),t=void 0!==e&&void 0!==e.defaultUserLanguage?e.defaultUserLanguage:this.getLanguage(),this.uploadingBlobs={},this.properties={},this.setFurnitureCatalog(new FurnitureCatalog),this.setTexturesCatalog(new TexturesCatalog),this.readPreferencesUrl?(this.updatePreferencesFromProperties(this.properties,t,!1),this.readPreferences(this.properties,t)):(this.updatePreferencesFromProperties(this.properties,t,!0),this.addListeners())}function ResourceAction(e,t,i,n,o,r,l){AbstractAction.call(this),void 0===n&&(l=r,r=o,o=n,n=!1),this.putValue(ResourceAction.RESOURCE_CLASS,t),this.putValue(ResourceAction.RESOURCE_PREFIX,i),this.putValue(ResourceAction.VISIBLE,!0),this.readActionProperties(e,t,i),this.setEnabled(n),this.controller=o,this.controllerMethod=r,this.parameters=l;var a=this;return e.addPropertyChangeListener("LANGUAGE",{propertyChange:function(e){null==a?e.getSource().removePropertyChangeListener("LANGUAGE",this):a.readActionProperties(e.getSource(),a.getValue(ResourceAction.RESOURCE_CLASS),a.getValue(ResourceAction.RESOURCE_PREFIX))}}),this}function PlanComponent(e,t,i,n,o){this.home=t,this.preferences=i,null==o&&(o=n,n=new Object3DBranchFactory),this.object3dFactory=n;var r=this;this.pointerType=View.PointerType.MOUSE,this.canvasNeededRepaint=!1,this.container=document.getElementById(e);var l=window.getComputedStyle(this.container);this.font=[l.fontStyle,l.fontSize,l.fontFamily].join(" "),"absolute"!=l.position&&(this.container.style.position="relative"),this.container instanceof HTMLCanvasElement?(this.canvas=this.view=this.container,this.canvas.width=this.canvas.clientWidth,this.canvas.height=this.canvas.clientHeight):(this.canvas=document.createElement("canvas"),this.canvas.setAttribute("id",e+".canvas"),this.canvas.style.width="100%",this.canvas.style.height="100%",void 0===PlanComponent.initialBackgroundColor&&(PlanComponent.initialBackgroundColor=l.backgroundColor,PlanComponent.initialForegroundColor=l.color),this.canvas.style.backgroundColor=PlanComponent.initialBackgroundColor,this.canvas.style.color=PlanComponent.initialForegroundColor,this.canvas.style.font=l.font,this.scrollPane=document.createElement("div"),this.scrollPane.setAttribute("id",e+".scrollPane"),this.scrollPane.style.width="100%",this.scrollPane.style.height="100%",this.container.style.overflow?this.scrollPane.style.overflow=this.container.style.overflow:this.scrollPane.style.overflow="scroll",this.view=document.createElement("div"),this.view.setAttribute("id",e+".view"),this.container.appendChild(this.scrollPane),this.container.appendChild(this.canvas),this.scrollPane.appendChild(this.view),this.canvas.style.position="absolute",this.canvas.style.left="0px",this.canvas.style.top="0px",this.scrollPane.style.position="absolute",this.scrollPane.style.left="0px",this.scrollPane.style.top="0px",this.scrollPane.addEventListener("scroll",(function(e){r.repaint()}))),this.windowResizeListener=function(){r.revalidate()},window.addEventListener("resize",this.windowResizeListener),this.tooltip=document.createElement("div"),this.tooltip.style.position="absolute",this.tooltip.style.visibility="hidden",this.tooltip.style.backgroundColor=ColorTools.toRGBAStyle(this.getBackground(),.7),this.tooltip.style.borderWidth="2px",this.tooltip.style.paddingLeft="2px",this.tooltip.style.borderStyle="solid",this.tooltip.style.whiteSpace="nowrap",this.tooltip.style.borderColor=ColorTools.toRGBAStyle(this.getForeground(),.7),this.tooltip.style.font=this.font,this.tooltip.style.color=this.canvas.style.color,this.tooltip.style.zIndex=101,document.body.appendChild(this.tooltip),this.touchOverlay=document.createElement("div"),this.touchOverlay.classList.add("touch-overlay-timer"),this.touchOverlay.style.position="absolute",this.touchOverlay.style.top="0px",this.touchOverlay.style.left="0px",this.touchOverlay.innerHTML='<div id="plan-touch-overlay-timer-content" class="touch-overlay-timer-content"></div><div class="touch-overlay-timer-bg"></div><div class="touch-overlay-timer-hidder"></div><div class="touch-overlay-timer-loader1"></div><div class="touch-overlay-timer-loader2"></div>',document.body.appendChild(this.touchOverlay);for(var a=0;a<this.touchOverlay.children.length;a++){var s=this.touchOverlay.children.item(a);(s.classList.contains("overlay-timer-loader1")||s.classList.contains("overlay-timer-loader2"))&&(s.style.borderTopColor=this.getSelectionColor(),s.style.borderRightColor=this.getSelectionColor()),s.classList.contains("touch-overlay-timer-content")&&(s.style.color=this.getForeground()),s.style.animationDuration=PlanComponent.LONG_TOUCH_DURATION_AFTER_DELAY+"ms"}this.resolutionScale=this.scrollPane?PlanComponent.HIDPI_SCALE_FACTOR:1,this.selectedItemsOutlinePainted=!0,this.backgroundPainted=!0,this.planBoundsCacheValid=!1,this.setOpaque(!0),this.addModelListeners(t,i,o),null!=o&&(this.addMouseListeners(o),this.addFocusListener(o),this.addControllerListener(o),this.createActions(o),this.installDefaultKeyboardActions()),this.rotationCursor=PlanComponent.createCustomCursor("rotation","alias"),this.elevationCursor=PlanComponent.createCustomCursor("elevation","row-resize"),this.heightCursor=PlanComponent.createCustomCursor("height","ns-resize"),this.powerCursor=PlanComponent.createCustomCursor("power","cell"),this.resizeCursor=PlanComponent.createCustomCursor("resize","ew-resize"),this.moveCursor=PlanComponent.createCustomCursor("move","move"),this.panningCursor=PlanComponent.createCustomCursor("panning","move"),this.duplicationCursor="copy",this.patternImagesCache={},this.setScale(.5),setTimeout(this.windowResizeListener)}function HomePane(e,t,i,n){null!=e&&(this.container=document.getElementById(e)),this.container||(this.container=document.body),this.home=t,this.preferences=i,this.controller=n,this.clipboardEmpty=!0,this.actionMap={},this.inputMap={},this.transferHandlerEnabled=!1,this.createActions(t,i,n),this.initActions(i),this.addHomeListener(t),this.addLevelVisibilityListener(t),this.addUserPreferencesListener(i),this.addPlanControllerListener(n.getPlanController()),this.addFocusListener(),this.createToolBar(t,i,n),this.createPopupMenus(t,i),this.initSplitters(),this.addOrientationChangeListener();var o=this;this.keydownListener=function(e){if(null===JSDialog.getTopMostDialog()){var t=KeyStroke.getKeyStrokeForEvent(e);if(void 0!==t){for(var i in o.actionMap){if((n=o.actionMap[i])instanceof AbstractAction&&n.isEnabled()&&n.getValue(AbstractAction.ACCELERATOR_KEY)==t)return n.actionPerformed(),void e.stopPropagation()}var n,r=o.inputMap[t];if(void 0!==r)void 0!==(n=o.actionMap[r])&&n.actionPerformed(e),e.stopPropagation()}}},document.addEventListener("keydown",this.keydownListener,!1);var r=n.getPlanController().getView();if(null!=r){var l=t.getNumericProperty(HomePane.PLAN_VIEWPORT_X_VISUAL_PROPERTY),a=t.getNumericProperty(HomePane.PLAN_VIEWPORT_Y_VISUAL_PROPERTY);null!=l&&null!=a&&(r.scrollPane.scrollLeft=0|l,r.scrollPane.scrollTop=0|a),r.scrollPane.addEventListener("scroll",(function(e){n.setHomeProperty(HomePane.PLAN_VIEWPORT_X_VISUAL_PROPERTY,r.scrollPane.scrollLeft.toString()),n.setHomeProperty(HomePane.PLAN_VIEWPORT_Y_VISUAL_PROPERTY,r.scrollPane.scrollTop.toString())}))}this.levelSelector=document.getElementById("level-selector");var s=function(){if(o.levelSelector)if(o.levelSelector.innerHTML="",t.getLevels().length<2)o.levelSelector.style.display="none";else{for(var e=0;e<t.getLevels().length;e++){var i=document.createElement("option");i.value=e,i.innerHTML=t.getLevels()[e].getName(),t.getLevels()[e]===t.getSelectedLevel()&&(i.selected="selected"),o.levelSelector.appendChild(i)}o.levelSelector.style.display="inline"}};s(),this.levelSelector&&(this.levelSelectorChangeListener=function(e){n.getPlanController().setSelectedLevel(t.getLevels()[parseInt(e.target.value)]),s()},this.levelSelector.addEventListener("change",this.levelSelectorChangeListener)),t.addPropertyChangeListener("SELECTED_LEVEL",s);for(var h=function(e){"NAME"!=e.getPropertyName()&&"ELEVATION"!=e.getPropertyName()&&"ELEVATION_INDEX"!=e.getPropertyName()||s()},u=t.getLevels(),d=0;d<u.length;d++)u[d].addPropertyChangeListener(h);t.addLevelsListener((function(e){e.getType()===CollectionEvent.Type.ADD?e.getItem().addPropertyChangeListener(h):e.getType()===CollectionEvent.Type.DELETE&&e.getItem().removePropertyChangeListener(h),s()})),setTimeout((function(){null!=r?r.getHTMLElement().focus():null!=n.getHomeController3D().getView()&&n.getHomeController3D().getView().getHTMLElement().focus()}))}function ContentDigestManager(){this.contentDigestsCache={},this.permanentContents={}}function DefaultFurnitureCatalog(e,t,i){FurnitureCatalog.call(this),this.libraries=[];var n=[];if(void 0===t)this.readDefaultFurnitureCatalogs(e,n);else if(i=t,null!=(t=e))for(var o=0;o<t.length;o++){var r=t[o],l=CoreTools.loadResourceBundles(r.substring(0,r.lastIndexOf(".json")),Locale.getDefault());this.readFurniture(l,r,i,n)}}function DefaultTexturesCatalog(e,t,i){TexturesCatalog.call(this),this.libraries=[];var n=[];if(void 0===t)this.readDefaultTexturesCatalogs(e,n);else if(i=t,null!=(t=e))for(var o=0;o<t.length;o++){var r=t[o],l=CoreTools.loadResourceBundles(r.substring(0,r.lastIndexOf(".json")),Locale.getDefault());this.readTextures(l,r,i,n)}}function FurnitureCatalogListPanel(e,t,i,n){this.container=document.getElementById(e),this.controller=n,this.preferences=i,this.createComponents(t,i,n)}function FurnitureTablePanel(e,t,i,n){this.container=document.getElementById(e),this.preferences=i,this.controller=n,this.defaultDecimalFormat=new DecimalFormat,this.integerFormat=new IntegerFormat,this.treeTable=new JSTreeTable(this.container,this.preferences,this.createTableModel(t)),this.addHomeListeners(t),this.addUserPreferencesListeners(t),this.updateData(t)}function JSComponent(e,t,i){if(this.preferences=e,t instanceof HTMLElement&&!0===i)this.container=t;else{var n="";null!=t&&(n="string"==typeof t?t:t.innerHTML),this.container=document.createElement("div"),this.container.innerHTML=this.buildHtmlFromTemplate(n)}}function JSDialog(e,t,i,n){JSComponent.call(this,e,i,n);var o=this;null!=n&&(this.applier=n.applier,this.disposer=n.disposer),this.getHTMLElement().classList.add("dialog-container"),n.size&&this.getHTMLElement().classList.add(n.size),this.getHTMLElement()._dialogBoxInstance=this,document.body.appendChild(this.getHTMLElement()),null!=t&&this.setTitle(t),this.registerEventListener(this.getCloseButton(),"click",(function(){o.cancel()})),this.registerEventListener(this.getHTMLElement(),"mousedown",(function(e){e.stopPropagation()})),this.buttonsPanel=this.findElement(".dialog-buttons"),OperatingSystem.isMacOSX()&&this.buttonsPanel.classList.add("mac"),this.appendButtons(this.buttonsPanel),this.getHTMLElement().classList.add("buttons-"+this.buttonsPanel.querySelectorAll("button").length)}function JSWizardDialog(e,t,i,n){JSDialog.call(this,e,i,'<div class="wizard">  <div stepIcon><div></div></div>  <div stepView></div></div>',n),this.getHTMLElement().classList.add("wizard-dialog"),this.controller=t,this.stepIconPanel=this.findElement("[stepIcon]"),this.stepViewPanel=this.findElement("[stepView]");var o=this;this.cancelButton=this.findElement(".wizard-cancel-button"),this.backButton=this.findElement(".wizard-back-button"),this.nextButton=this.findElement(".wizard-next-button"),this.registerEventListener(this.cancelButton,"click",(function(e){o.cancel()})),this.backButton.disabled=!t.isBackStepEnabled(),this.registerPropertyChangeListener(t,"BACK_STEP_ENABLED",(function(e){o.backButton.disabled=!t.isBackStepEnabled()})),this.nextButton.disabled=!t.isNextStepEnabled(),this.registerPropertyChangeListener(t,"NEXT_STEP_ENABLED",(function(e){o.nextButton.disabled=!t.isNextStepEnabled()})),this.updateNextButtonText(),this.registerPropertyChangeListener(t,"LAST_STEP",(function(e){o.updateNextButtonText()})),this.registerEventListener(this.backButton,"click",(function(e){t.goBackToPreviousStep()})),this.registerEventListener(this.nextButton,"click",(function(e){t.isLastStep()?(t.finish(),null!=o&&o.validate()):t.goToNextStep()})),this.updateStepView(),this.registerPropertyChangeListener(t,"STEP_VIEW",(function(e){o.updateStepView()})),this.updateStepIcon(),this.registerPropertyChangeListener(t,"STEP_ICON",(function(e){o.updateStepIcon()})),this.registerPropertyChangeListener(t,"TITLE",(function(e){o.setTitle(t.getTitle())}))}function JSImageResizingDialog(e,t,i,n,o,r,l,a){this.cancelButtonMessage=JSComponent.substituteWithLocale(e,n),this.keepUnchangedButtonMessage=JSComponent.substituteWithLocale(e,o),this.okButtonMessage=JSComponent.substituteWithLocale(e,r),JSDialog.call(this,e,JSComponent.substituteWithLocale(e,t),"<div>"+JSComponent.substituteWithLocale(e,i).replace("<br>"," ")+"</div>",{applier:function(e){e.resizeRequested?l():a()}});var s=this,h=this.findElement(".dialog-cancel-button");this.registerEventListener(h,"click",(function(e){s.cancel()}));var u=this.findElements(".dialog-ok-button");this.registerEventListener(u,"click",(function(e){s.resizeRequested=!e.target.classList.contains("keep-image-unchanged-button"),s.validate()}))}function JSPopupMenu(e,t,i){if(null==t||0===t.length)throw new Error("Cannot register a context menu on an empty list of elements");JSComponent.call(this,e,""),this.sourceElements=t,Array.isArray(t)||(this.sourceElements=[t]),this.build=i,this.getHTMLElement().classList.add("popup-menu"),document.body.appendChild(this.getHTMLElement());var n=this;this.registerEventListener(t,"contextmenu",(function(e){e.preventDefault(),null!=JSPopupMenu.current&&JSPopupMenu.current.close(),n.showSourceElement(this,e)}))}if(LengthUnit.UNITS_LOCALIZATION={"":{meterUnit:"m",centimeterUnit:"cm",millimeterUnit:"mm",inchUnit:"inch",footUnit:"ft",squareMeterUnit:"m",squareFootUnit:"sq ft"},ar:{meterUnit:"",centimeterUnit:"",millimeterUnit:"",inchUnit:"",squareMeterUnit:" ",squareFootUnit:" "},bg:{inchUnit:"inch"},cs:{inchUnit:"palce",squareFootUnit:"ft"},de:{inchUnit:"inch",footUnit:"ft",squareFootUnit:"ft"},el:{inchUnit:"",squareMeterUnit:"m",squareFootUnit:" "},es:{inchUnit:"pulgada",squareFootUnit:"ft"},eu:{inchUnit:"hazbete",squareFootUnit:"sq ft"},fi:{inchUnit:'"',squareFootUnit:"ft"},fr:{inchUnit:"pouce",footUnit:"pied",squareFootUnit:"ft"},hu:{inchUnit:"inch",squareFootUnit:"ft"},in:{inchUnit:"inci",squareFootUnit:"ft"},it:{inchUnit:"pollice",squareFootUnit:"ft"},ja:{inchUnit:"inch",squareFootUnit:"sq ft"},nl:{inchUnit:"inch",squareFootUnit:"vt"},pl:{inchUnit:"cal",squareFootUnit:"ft"},pt_BR:{inchUnit:"pol",squareFootUnit:"ft"},pt:{inchUnit:"pol",squareFootUnit:"p"},ru:{meterUnit:"",centimeterUnit:"",millimeterUnit:"",inchUnit:"",squareMeterUnit:"",squareFootUnit:"ft"},sl:{inchUnit:"in",squareFootUnit:"kv l"},sr:{inchUnit:"inch",squareFootUnit:"sq ft"},sv:{inchUnit:"tum",squareFootUnit:"ft"},th:{meterUnit:".",centimeterUnit:".",millimeterUnit:".",inchUnit:"",squareMeterUnit:".",squareFootUnit:""},tr:{inchUnit:"in",squareFootUnit:"kare ft "},uk:{meterUnit:"",centimeterUnit:"",millimeterUnit:"",inchUnit:"",squareMeterUnit:"",squareFootUnit:". "},vi:{inchUnit:"inch",squareFootUnit:"sq ft"},zh_CN:{centimeterUnit:"",inchUnit:"",millimeterUnit:"",meterUnit:"",squareMeterUnit:"m",squareFootUnit:""},zh_TW:{centimeterUnit:"",inchUnit:"",millimeterUnit:"",meterUnit:"",squareMeterUnit:"m",squareFootUnit:"ft"}},LengthUnit.getLocalizedUnit=function(e){var t,i,n=Locale.getDefault();if(void 0!==(t=LengthUnit.UNITS_LOCALIZATION[n])&&void 0!==(i=t[e]))return i;if(n.indexOf("_")>0&&(n=n.substring(0,n.indexOf("_")),void 0!==(t=LengthUnit.UNITS_LOCALIZATION[n])&&void 0!==(i=t[e])))return i;return LengthUnit.UNITS_LOCALIZATION[""][e]},LengthUnit.getMagnetizedMeterLength=function(e,t){var i=.1;(t*=2)>100?i=100:t>10?i=10:t>5?i=5:t>1?i=1:t>.5&&(i=.5);var n=Math.round(e/i)*i;return 0===n&&e>0?e:n},LengthUnit.getMagnetizedInchLength=function(e,t){var i=1/8;(t=2*LengthUnit.centimeterToInch(t))>6?i=6:t>3?i=3:t>1?i=1:t>.5?i=.5:t>.25&&(i=.25);var n=LengthUnit.inchToCentimeter(Math.round(LengthUnit.centimeterToInch(e)/i)*i);return 0===n&&e>0?e:n},LengthUnit.skipWhiteSpaces=function(e,t){for(;t.getIndex()<e.length&&/\s/.test(e.charAt(t.getIndex()));)t.setIndex(t.getIndex()+1)},LengthUnit.centimeterToInch=function(e){return e/2.54},LengthUnit.centimeterToFoot=function(e){return e/2.54/12},LengthUnit.inchToCentimeter=function(e){return 2.54*e},LengthUnit.footToCentimeter=function(e){return 2.54*e*12},LengthUnit.nameOf=function(e){if(null!=e)for(var t=Object.keys(LengthUnit),i=0;i<t.length;i++){var n=t[i];if(LengthUnit[n]==e)return n}return null},LengthUnit.valueOf=function(e){return LengthUnit[e]},LengthUnit.MILLIMETER={formatLocale:null},LengthUnit.MILLIMETER.name=function(){return LengthUnit.nameOf(this)},LengthUnit.MILLIMETER.getFormatWithUnit=function(){return this.checkLocaleChange(),this.lengthFormatWithUnit},LengthUnit.MILLIMETER.getAreaFormatWithUnit=function(){return this.checkLocaleChange(),this.areaFormatWithUnit},LengthUnit.MILLIMETER.getFormat=function(){return this.checkLocaleChange(),this.lengthFormat},LengthUnit.MILLIMETER.getName=function(){return this.checkLocaleChange(),this.unitName},LengthUnit.MILLIMETER.checkLocaleChange=function(){if(Locale.getDefault()!=this.formatLocale){this.formatLocale=Locale.getDefault(),this.unitName=LengthUnit.getLocalizedUnit("millimeterUnit"),this.lengthFormatWithUnit=new MeterFamilyFormat("0",10,this.unitName),this.lengthFormat=new MeterFamilyFormat("0",10);var e=LengthUnit.getLocalizedUnit("squareMeterUnit");this.areaFormatWithUnit=new SquareMeterAreaFormatWithUnit(e)}},LengthUnit.MILLIMETER.getMagnetizedLength=function(e,t){return LengthUnit.getMagnetizedMeterLength(e,t)},LengthUnit.MILLIMETER.getMinimumLength=function(){return.1},LengthUnit.MILLIMETER.getMaximumLength=function(){return 1e5},LengthUnit.MILLIMETER.getMaximumElevation=function(){return this.getMaximumLength()/10},LengthUnit.MILLIMETER.getStepSize=function(){return.5},LengthUnit.MILLIMETER.centimeterToUnit=function(e){return 10*e},LengthUnit.MILLIMETER.unitToCentimeter=function(e){return e/10},LengthUnit.MILLIMETER.isMetric=function(){return!0},LengthUnit.CENTIMETER={formatLocale:null},LengthUnit.CENTIMETER.name=function(){return LengthUnit.nameOf(this)},LengthUnit.CENTIMETER.getFormatWithUnit=function(){return this.checkLocaleChange(),this.lengthFormatWithUnit},LengthUnit.CENTIMETER.getAreaFormatWithUnit=function(){return this.checkLocaleChange(),this.areaFormatWithUnit},LengthUnit.CENTIMETER.getFormat=function(){return this.checkLocaleChange(),this.lengthFormat},LengthUnit.CENTIMETER.getName=function(){return this.checkLocaleChange(),this.unitName},LengthUnit.CENTIMETER.checkLocaleChange=function(){if(Locale.getDefault()!=this.formatLocale){this.formatLocale=Locale.getDefault(),this.unitName=LengthUnit.getLocalizedUnit("centimeterUnit"),this.lengthFormatWithUnit=new MeterFamilyFormat("0.#",1,this.unitName),this.lengthFormat=new MeterFamilyFormat("0.#",1);var e=LengthUnit.getLocalizedUnit("squareMeterUnit");this.areaFormatWithUnit=new SquareMeterAreaFormatWithUnit(e)}},LengthUnit.CENTIMETER.getMagnetizedLength=function(e,t){return LengthUnit.getMagnetizedMeterLength(e,t)},LengthUnit.CENTIMETER.getMinimumLength=function(){return.1},LengthUnit.CENTIMETER.getMaximumLength=function(){return 1e5},LengthUnit.CENTIMETER.getMaximumElevation=function(){return this.getMaximumLength()/10},LengthUnit.CENTIMETER.getStepSize=function(){return.5},LengthUnit.CENTIMETER.centimeterToUnit=function(e){return e},LengthUnit.CENTIMETER.unitToCentimeter=function(e){return e},LengthUnit.CENTIMETER.isMetric=function(){return!0},LengthUnit.METER={formatLocale:null},LengthUnit.METER.name=function(){return LengthUnit.nameOf(this)},LengthUnit.METER.getFormatWithUnit=function(){return this.checkLocaleChange(),this.lengthFormatWithUnit},LengthUnit.METER.getAreaFormatWithUnit=function(){return this.checkLocaleChange(),this.areaFormatWithUnit},LengthUnit.METER.getFormat=function(){return this.checkLocaleChange(),this.lengthFormat},LengthUnit.METER.getName=function(){return this.checkLocaleChange(),this.unitName},LengthUnit.METER.checkLocaleChange=function(){if(Locale.getDefault()!=this.formatLocale){this.formatLocale=Locale.getDefault(),this.unitName=LengthUnit.getLocalizedUnit("meterUnit"),this.lengthFormatWithUnit=new MeterFamilyFormat("0.00#",.01,this.unitName),this.lengthFormat=new MeterFamilyFormat("0.00#",.01);var e=LengthUnit.getLocalizedUnit("squareMeterUnit");this.areaFormatWithUnit=new SquareMeterAreaFormatWithUnit(e)}},LengthUnit.METER.getMagnetizedLength=function(e,t){return LengthUnit.getMagnetizedMeterLength(e,t)},LengthUnit.METER.getMinimumLength=function(){return.1},LengthUnit.METER.getMaximumLength=function(){return 1e5},LengthUnit.METER.getMaximumElevation=function(){return this.getMaximumLength()/10},LengthUnit.METER.getStepSize=function(){return.5},LengthUnit.METER.centimeterToUnit=function(e){return e/100},LengthUnit.METER.unitToCentimeter=function(e){return 100*e},LengthUnit.METER.isMetric=function(){return!0},LengthUnit.INCH={formatLocale:null},LengthUnit.INCH.name=function(){return LengthUnit.nameOf(this)},LengthUnit.INCH.getFormatWithUnit=function(){return this.checkLocaleChange(),this.lengthFormat},LengthUnit.INCH.getFormat=function(){return this.getFormatWithUnit()},LengthUnit.INCH.getAreaFormatWithUnit=function(){return this.checkLocaleChange(),this.areaFormatWithUnit},LengthUnit.INCH.getName=function(){return this.checkLocaleChange(),this.unitName},LengthUnit.INCH.checkLocaleChange=function(){if(Locale.getDefault()!=this.formatLocale){this.formatLocale=Locale.getDefault(),this.unitName=LengthUnit.getLocalizedUnit("inchUnit");this.lengthFormat=new InchFractionFormat(!0,"");var e=LengthUnit.getLocalizedUnit("squareFootUnit");this.areaFormatWithUnit=new SquareFootAreaFormatWithUnit("0",e)}},LengthUnit.INCH.getMagnetizedLength=function(e,t){return LengthUnit.getMagnetizedInchLength(e,t)},LengthUnit.INCH.getMinimumLength=function(){return LengthUnit.inchToCentimeter(.125)},LengthUnit.INCH.getMaximumLength=function(){return LengthUnit.footToCentimeter(3280)},LengthUnit.INCH.getMaximumElevation=function(){return this.getMaximumLength()/10},LengthUnit.INCH.getStepSize=function(){return LengthUnit.inchToCentimeter(.125)},LengthUnit.INCH.centimeterToUnit=function(e){return LengthUnit.centimeterToInch(e)},LengthUnit.INCH.unitToCentimeter=function(e){return LengthUnit.inchToCentimeter(e)},LengthUnit.INCH.isMetric=function(){return!1},LengthUnit.INCH_FRACTION={formatLocale:null},LengthUnit.INCH_FRACTION.name=function(){return LengthUnit.nameOf(this)},LengthUnit.INCH_FRACTION.getFormatWithUnit=function(){return this.checkLocaleChange(),this.lengthFormat},LengthUnit.INCH_FRACTION.getFormat=function(){return this.getFormatWithUnit()},LengthUnit.INCH_FRACTION.getAreaFormatWithUnit=function(){return this.checkLocaleChange(),this.areaFormatWithUnit},LengthUnit.INCH_FRACTION.getName=function(){return this.checkLocaleChange(),this.unitName},LengthUnit.INCH_FRACTION.checkLocaleChange=function(){if(Locale.getDefault()!=this.formatLocale){this.formatLocale=Locale.getDefault(),this.unitName=LengthUnit.getLocalizedUnit("inchUnit");this.lengthFormat=new InchFractionFormat(!1,"");var e=LengthUnit.getLocalizedUnit("squareFootUnit");this.areaFormatWithUnit=new SquareFootAreaFormatWithUnit("0",e)}},LengthUnit.INCH_FRACTION.getMagnetizedLength=function(e,t){return LengthUnit.getMagnetizedInchLength(e,t)},LengthUnit.INCH_FRACTION.getMinimumLength=function(){return LengthUnit.inchToCentimeter(.125)},LengthUnit.INCH_FRACTION.getMaximumLength=function(){return LengthUnit.footToCentimeter(3280)},LengthUnit.INCH_FRACTION.getMaximumElevation=function(){return this.getMaximumLength()/10},LengthUnit.INCH_FRACTION.getStepSize=function(){return LengthUnit.inchToCentimeter(.125)},LengthUnit.INCH_FRACTION.centimeterToUnit=function(e){return LengthUnit.centimeterToInch(e)},LengthUnit.INCH_FRACTION.unitToCentimeter=function(e){return LengthUnit.inchToCentimeter(e)},LengthUnit.INCH_FRACTION.isMetric=function(){return!1},LengthUnit.INCH_DECIMALS={formatLocale:null},LengthUnit.INCH_DECIMALS.name=function(){return LengthUnit.nameOf(this)},LengthUnit.INCH_DECIMALS.getFormatWithUnit=function(){return this.checkLocaleChange(),this.lengthFormatWithUnit},LengthUnit.INCH_DECIMALS.getFormat=function(){return this.checkLocaleChange(),this.lengthFormat},LengthUnit.INCH_DECIMALS.getAreaFormatWithUnit=function(){return this.checkLocaleChange(),this.areaFormatWithUnit},LengthUnit.INCH_DECIMALS.getName=function(){return this.checkLocaleChange(),this.unitName},LengthUnit.INCH_DECIMALS.checkLocaleChange=function(){if(Locale.getDefault()!=this.formatLocale){this.formatLocale=Locale.getDefault(),this.unitName=LengthUnit.getLocalizedUnit("inchUnit"),this.lengthFormat=new InchDecimalsFormat("0.###"),this.lengthFormatWithUnit=new InchDecimalsFormat("0.###",'"');var e=LengthUnit.getLocalizedUnit("squareFootUnit");this.areaFormatWithUnit=new SquareFootAreaFormatWithUnit("0.##",e)}},LengthUnit.INCH_DECIMALS.getMagnetizedLength=function(e,t){return LengthUnit.getMagnetizedInchLength(e,t)},LengthUnit.INCH_DECIMALS.getMinimumLength=function(){return LengthUnit.inchToCentimeter(.125)},LengthUnit.INCH_DECIMALS.getMaximumLength=function(){return LengthUnit.footToCentimeter(3280)},LengthUnit.INCH_DECIMALS.getMaximumElevation=function(){return this.getMaximumLength()/10},LengthUnit.INCH_DECIMALS.getStepSize=function(){return LengthUnit.inchToCentimeter(.125)},LengthUnit.INCH_DECIMALS.centimeterToUnit=function(e){return LengthUnit.centimeterToInch(e)},LengthUnit.INCH_DECIMALS.unitToCentimeter=function(e){return LengthUnit.inchToCentimeter(e)},LengthUnit.INCH_DECIMALS.isMetric=function(){return!1},LengthUnit.FOOT_DECIMALS={formatLocale:null},LengthUnit.FOOT_DECIMALS.name=function(){return LengthUnit.nameOf(this)},LengthUnit.FOOT_DECIMALS.getFormatWithUnit=function(){return this.checkLocaleChange(),this.lengthFormatWithUnit},LengthUnit.FOOT_DECIMALS.getFormat=function(){return this.checkLocaleChange(),this.lengthFormat},LengthUnit.FOOT_DECIMALS.getAreaFormatWithUnit=function(){return this.checkLocaleChange(),this.areaFormatWithUnit},LengthUnit.FOOT_DECIMALS.getName=function(){return this.checkLocaleChange(),this.unitName},LengthUnit.FOOT_DECIMALS.checkLocaleChange=function(){if(Locale.getDefault()!=this.formatLocale){this.formatLocale=Locale.getDefault(),this.unitName=LengthUnit.getLocalizedUnit("footUnit"),this.lengthFormat=new FootDecimalsFormat("0.###"),this.lengthFormatWithUnit=new FootDecimalsFormat("0.###","'");var e=LengthUnit.getLocalizedUnit("squareFootUnit");this.areaFormatWithUnit=new SquareFootAreaFormatWithUnit("0.##",e)}},LengthUnit.FOOT_DECIMALS.getMagnetizedLength=function(e,t){return LengthUnit.getMagnetizedInchLength(e,t)},LengthUnit.FOOT_DECIMALS.getMinimumLength=function(){return LengthUnit.inchToCentimeter(.125)},LengthUnit.FOOT_DECIMALS.getMaximumLength=function(){return LengthUnit.footToCentimeter(3280)},LengthUnit.FOOT_DECIMALS.getMaximumElevation=function(){return this.getMaximumLength()/10},LengthUnit.FOOT_DECIMALS.getStepSize=function(){return LengthUnit.inchToCentimeter(.125)},LengthUnit.FOOT_DECIMALS.centimeterToUnit=function(e){return LengthUnit.centimeterToFoot(e)},LengthUnit.FOOT_DECIMALS.unitToCentimeter=function(e){return LengthUnit.footToCentimeter(e)},LengthUnit.FOOT_DECIMALS.isMetric=function(){return!1},MeterFamilyFormat.prototype=Object.create(DecimalFormat.prototype),MeterFamilyFormat.prototype.constructor=MeterFamilyFormat,MeterFamilyFormat.prototype.format=function(e){return DecimalFormat.prototype.format.call(this,e*this.unitMultiplier)+(this.unit?" "+this.unit:"")},MeterFamilyFormat.prototype.parse=function(e,t){var i=DecimalFormat.prototype.parse.call(this,e,t);return null===i?null:i/this.unitMultiplier},SquareMeterAreaFormatWithUnit.prototype=Object.create(DecimalFormat.prototype),SquareMeterAreaFormatWithUnit.prototype.constructor=SquareMeterAreaFormatWithUnit,SquareMeterAreaFormatWithUnit.prototype.format=function(e){return DecimalFormat.prototype.format.call(this,e/1e4)+(this.squareMeterUnit?" "+this.squareMeterUnit:"")},InchFractionFormat.prototype=Object.create(DecimalFormat.prototype),InchFractionFormat.prototype.constructor=InchFractionFormat,InchFractionFormat.INCH_FRACTION_CHARACTERS=["","","","","","",""],InchFractionFormat.INCH_FRACTION_STRINGS=["1/8","1/4","3/8","1/2","5/8","3/4","7/8"],InchFractionFormat.prototype.format=function(e){var t=Math.abs(e),i=Math.floor(LengthUnit.centimeterToFoot(t)),n=LengthUnit.centimeterToInch(t-LengthUnit.footToCentimeter(i));n>=11.9375&&(i++,n-=12);var o=e>=0?"":"-",r=DecimalFormat.prototype.format.call(this,i);if(n>=5e-4){var l=Math.floor(n),a=n-l,s=Math.round(8*a);this.footInch?(o+=r,0===s||8===s?(o+="'",o+=Math.round(8*n)/8):(o+="'",o+=l,o+=InchFractionFormat.INCH_FRACTION_CHARACTERS[s-1])):0===s||8===s?o+=12*i+Math.round(8*n)/8:(o+=12*i+l,o+=InchFractionFormat.INCH_FRACTION_CHARACTERS[s-1]),o+='"'}else this.footInch?(o+=r,o+="'"):(o+=DecimalFormat.prototype.format.call(this,12*i),o+='"');return o},InchFractionFormat.prototype.parse=function(e,t){var i=0,n=new ParsePosition(t.getIndex());LengthUnit.skipWhiteSpaces(e,n);var o=NumberFormat.getIntegerInstance(),r=e.indexOf("'",t.getIndex()),l=n.getIndex()<e.length&&"-"===e.charAt(n.getIndex()),a=!1;if(-1!==r){var s=o.parse(e,n);if(null===s)return t.setErrorIndex(n.getErrorIndex()),null;if(LengthUnit.skipWhiteSpaces(e,n),n.getIndex()===r){if(i=LengthUnit.footToCentimeter(s),a=!0,n=new ParsePosition(r+1),LengthUnit.skipWhiteSpaces(e,n),n.getIndex()<e.length&&this.footInchSeparator.indexOf(e.charAt(n.getIndex()))>=0&&(n.setIndex(n.getIndex()+1),LengthUnit.skipWhiteSpaces(e,n)),n.getIndex()===e.length)return t.setIndex(e.length),i}else{if(this.decimalSeparator===e.charAt(n.getIndex())){var h=new ParsePosition(t.getIndex());if(null!==DecimalFormat.prototype.parse.call(this,e,h)&&h.getIndex()===r)return t.setErrorIndex(n.getErrorIndex()),null}n.setIndex(t.getIndex())}}var u=DecimalFormat.prototype.parse.call(this,e,n);if(null===u)return a?(t.setIndex(n.getIndex()),i):(t.setErrorIndex(n.getErrorIndex()),null);if(l?-1===r?i=LengthUnit.inchToCentimeter(u):i-=LengthUnit.inchToCentimeter(u):i+=LengthUnit.inchToCentimeter(u),LengthUnit.skipWhiteSpaces(e,n),n.getIndex()===e.length)return t.setIndex(e.length),i;if('"'===e.charAt(n.getIndex()))return t.setIndex(n.getIndex()+1),i;for(var d=e.charAt(n.getIndex()),c=e.length-n.getIndex()>=3?e.substring(n.getIndex(),n.getIndex()+3):null,p=0;p<InchFractionFormat.INCH_FRACTION_CHARACTERS.length;p++){if(InchFractionFormat.INCH_FRACTION_CHARACTERS[p]===d||InchFractionFormat.INCH_FRACTION_STRINGS[p]==c)return e.lastIndexOf(this.decimalSeparator,n.getIndex()-1)>r?null:(l?i-=LengthUnit.inchToCentimeter((p+1)/8):i+=LengthUnit.inchToCentimeter((p+1)/8),t.setIndex(n.getIndex()+(InchFractionFormat.INCH_FRACTION_CHARACTERS[p]===d?1:3)),LengthUnit.skipWhiteSpaces(e,t),t.getIndex()<e.length&&'"'===e.charAt(t.getIndex())&&t.setIndex(t.getIndex()+1),i)}return t.setIndex(n.getIndex()),i},SquareFootAreaFormatWithUnit.prototype=Object.create(DecimalFormat.prototype),SquareFootAreaFormatWithUnit.prototype.constructor=SquareFootAreaFormatWithUnit,SquareFootAreaFormatWithUnit.prototype.format=function(e){return DecimalFormat.prototype.format.call(this,e/929.0304)+(this.unit?" "+this.unit:"")},InchDecimalsFormat.prototype=Object.create(DecimalFormat.prototype),InchDecimalsFormat.prototype.constructor=InchDecimalsFormat,InchDecimalsFormat.prototype.format=function(e){return DecimalFormat.prototype.format.call(this,LengthUnit.centimeterToInch(e))+(this.unit?this.unit:"")},InchDecimalsFormat.prototype.parse=function(e,t){var i=new ParsePosition(t.getIndex());LengthUnit.skipWhiteSpaces(e,i);var n=DecimalFormat.prototype.parse.call(this,e,i);if(null===n)return t.setErrorIndex(i.getErrorIndex()),null;var o=LengthUnit.inchToCentimeter(n);return LengthUnit.skipWhiteSpaces(e,i),i.getIndex()<e.length&&'"'===e.charAt(i.getIndex())?t.setIndex(i.getIndex()+1):t.setIndex(i.getIndex()),o},FootDecimalsFormat.prototype=Object.create(DecimalFormat.prototype),FootDecimalsFormat.prototype.constructor=FootDecimalsFormat,FootDecimalsFormat.prototype.format=function(e){return DecimalFormat.prototype.format.call(this,LengthUnit.centimeterToFoot(e))+(this.unit?this.unit:"")},FootDecimalsFormat.prototype.parse=function(e,t){var i=new ParsePosition(t.getIndex());LengthUnit.skipWhiteSpaces(e,i);var n=DecimalFormat.prototype.parse.call(this,e,i);if(null===n)return t.setErrorIndex(i.getErrorIndex()),null;var o=LengthUnit.footToCentimeter(n);return LengthUnit.skipWhiteSpaces(e,i),i.getIndex()<e.length&&"'"===e.charAt(i.getIndex())?t.setIndex(i.getIndex()+1):t.setIndex(i.getIndex()),o},UserPreferences.DEFAULT_SUPPORTED_LANGUAGES=["bg","cs","de","el","en","es","fr","it","ja","hu","nl","pl","pt","pt_BR","ru","sv","vi","zh_CN","zh_TW"],UserPreferences.DEFAULT_TEXT_STYLE=new TextStyle(18),UserPreferences.DEFAULT_ROOM_TEXT_STYLE=new TextStyle(24),UserPreferences.prototype.initSupportedLanguages=function(e){if(this.supportedLanguages=e,!this.language||-1===this.supportedLanguages.indexOf(this.language)){var t=Locale.getDefault();null===t&&(t="en"),this.defaultCountry="";var i=t;t.indexOf("_")>0&&(this.defaultCountry=t.substring(t.indexOf("_")+1,t.length),i=this.language?this.language.substring(0,this.language.indexOf("_")):t.substring(0,t.indexOf("_")));for(var n=0;n<this.supportedLanguages.length;n++){var o=this.supportedLanguages[n];if(""!=this.defaultCountry&&o==i+"_"+this.defaultCountry||""==this.defaultCountry&&o==i){this.language=o;break}void 0===this.language&&0===o.indexOf(i)&&(this.language=o)}void 0===this.language&&(this.language="en"),this.updateDefaultLocale()}},UserPreferences.prototype.updateDefaultLocale=function(){-1!==this.language.indexOf("_")||""==this.defaultCountry?Locale.setDefault(this.language):Locale.setDefault(this.language+"_"+this.defaultCountry)},UserPreferences.prototype.write=function(){},UserPreferences.prototype.addPropertyChangeListener=function(e){this.propertyChangeSupport.addPropertyChangeListener(e)},UserPreferences.prototype.removePropertyChangeListener=function(e){this.propertyChangeSupport.removePropertyChangeListener(e)},UserPreferences.prototype.addPropertyChangeListener=function(e,t){this.propertyChangeSupport.addPropertyChangeListener(e,t)},UserPreferences.prototype.removePropertyChangeListener=function(e,t){this.propertyChangeSupport.removePropertyChangeListener(e,t)},UserPreferences.prototype.getFurnitureCatalog=function(){return this.furnitureCatalog},UserPreferences.prototype.setFurnitureCatalog=function(e){this.furnitureCatalog=e},UserPreferences.prototype.getTexturesCatalog=function(){return this.texturesCatalog},UserPreferences.prototype.setTexturesCatalog=function(e){this.texturesCatalog=e},UserPreferences.prototype.getPatternsCatalog=function(){return this.patternsCatalog},UserPreferences.prototype.setPatternsCatalog=function(e){this.patternsCatalog=e},UserPreferences.prototype.getLengthUnit=function(){return this.unit},UserPreferences.prototype.setUnit=function(e){if(this.unit!==e){var t=this.unit;this.unit=e,this.propertyChangeSupport.firePropertyChange("UNIT",t,e)}},UserPreferences.prototype.getLanguage=function(){return this.language},UserPreferences.prototype.setLanguage=function(e){if(e!=this.language&&this.isLanguageEditable()){var t=this.language;this.language=e,this.updateDefaultLocale(),this.resourceBundles=[],this.furnitureCatalogResourceBundles=[],this.texturesCatalogResourceBundles=[],this.propertyChangeSupport.firePropertyChange("LANGUAGE",t,e)}},UserPreferences.prototype.isLanguageEditable=function(){return!0},UserPreferences.prototype.getDefaultSupportedLanguages=function(){return UserPreferences.DEFAULT_SUPPORTED_LANGUAGES.slice(0)},UserPreferences.prototype.getSupportedLanguages=function(){return this.supportedLanguages.slice(0)},UserPreferences.prototype.setSupportedLanguages=function(e){if(this.supportedLanguages!=e){var t=this.supportedLanguages,i=this.language;this.initSupportedLanguages(e.slice(0)),this.propertyChangeSupport.firePropertyChange("SUPPORTED_LANGUAGES",t,e),i!=this.language&&this.propertyChangeSupport.firePropertyChange("LANGUAGE",i,language)}},UserPreferences.prototype.getLocalizedString=function(e,t,i){if(this.getResourceBundles(e),"DefaultFurnitureCatalog"==e)return CoreTools.getStringFromKey.apply(null,[this.furnitureCatalogResourceBundles,t].concat(Array.prototype.slice.call(arguments,2)));if("DefaultTexturesCatalog"==e)return CoreTools.getStringFromKey.apply(null,[this.texturesCatalogResourceBundles,t].concat(Array.prototype.slice.call(arguments,2)));if(e.__class){var n=e.__class.split(".");e=n[n.length-1]}var o=e+"."+t;return CoreTools.getStringFromKey.apply(null,[this.resourceBundles,o].concat(Array.prototype.slice.call(arguments,2)))},UserPreferences.prototype.getLocalizedStringKeys=function(e){if("DefaultFurnitureCatalog"==resourceClass){for(var t={},i=0;i<resourceBundles.length;i++)null!=resourceBundles[i]&&CoreTools.merge(t,resourceBundles[i]);return Object.getOwnPropertyNames(t)}throw new IllegalArgumentException("unsupported family")},UserPreferences.prototype.getResourceBundles=function(e){return"DefaultFurnitureCatalog"==e?(0==this.furnitureCatalogResourceBundles.length&&(this.furnitureCatalogResourceBundles=CoreTools.loadResourceBundles("resources/DefaultFurnitureCatalog",Locale.getDefault())),this.furnitureCatalogResourceBundles):"DefaultTexturesCatalog"==e?(0==this.texturesCatalogResourceBundles.length&&(this.texturesCatalogResourceBundles=CoreTools.loadResourceBundles("resources/DefaultTexturesCatalog",Locale.getDefault())),this.texturesCatalogResourceBundles):(0==this.resourceBundles.length&&(this.resourceBundles=CoreTools.loadResourceBundles("resources/localization",Locale.getDefault())),this.resourceBundles)},UserPreferences.prototype.getCurrency=function(){return this.currency},UserPreferences.prototype.setCurrency=function(e){if(e!=this.currency){var t=this.currency;this.currency=e,this.propertyChangeSupport.firePropertyChange("CURRENCY",t,e)}},UserPreferences.prototype.isValueAddedTaxEnabled=function(){return this.valueAddedTaxEnabled},UserPreferences.prototype.setValueAddedTaxEnabled=function(e){this.valueAddedTaxEnabled!==e&&(this.valueAddedTaxEnabled=e,this.propertyChangeSupport.firePropertyChange("VALUE_ADDED_TAX_ENABLED",!e,e))},UserPreferences.prototype.getDefaultValueAddedTaxPercentage=function(){return this.defaultValueAddedTaxPercentage},UserPreferences.prototype.setDefaultValueAddedTaxPercentage=function(e){if(e!==this.defaultValueAddedTaxPercentage&&(null==e||null==this.defaultValueAddedTaxPercentage||!e.eq(this.defaultValueAddedTaxPercentage))){var t=this.defaultValueAddedTaxPercentage;this.defaultValueAddedTaxPercentage=e,this.propertyChangeSupport.firePropertyChange("DEFAULT_VALUE_ADDED_TAX_PERCENTAGE",t,e)}},UserPreferences.prototype.isFurnitureCatalogViewedInTree=function(){return this.furnitureCatalogViewedInTree},UserPreferences.prototype.setFurnitureCatalogViewedInTree=function(e){this.furnitureCatalogViewedInTree!==e&&(this.furnitureCatalogViewedInTree=e,this.propertyChangeSupport.firePropertyChange("FURNITURE_CATALOG_VIEWED_IN_TREE",!e,e))},UserPreferences.prototype.isNavigationPanelVisible=function(){return this.navigationPanelVisible},UserPreferences.prototype.setNavigationPanelVisible=function(e){this.navigationPanelVisible!==e&&(this.navigationPanelVisible=e,this.propertyChangeSupport.firePropertyChange("NAVIGATION_PANEL_VISIBLE",!e,e))},UserPreferences.prototype.isEditingIn3DViewEnabled=function(){return this.editingIn3DViewEnabled},UserPreferences.prototype.setEditingIn3DViewEnabled=function(e){e!=this.editingIn3DViewEnabled&&(this.editingIn3DViewEnabled=e,this.propertyChangeSupport.firePropertyChange("EDITING_IN_3D_VIEW_ENABLED",!e,e))},UserPreferences.prototype.isAerialViewCenteredOnSelectionEnabled=function(){return this.aerialViewCenteredOnSelectionEnabled},UserPreferences.prototype.setAerialViewCenteredOnSelectionEnabled=function(e){e!==this.aerialViewCenteredOnSelectionEnabled&&(this.aerialViewCenteredOnSelectionEnabled=e,this.propertyChangeSupport.firePropertyChange("AERIAL_VIEW_CENTERED_ON_SELECTION_ENABLED",!e,e))},UserPreferences.prototype.isObserverCameraSelectedAtChange=function(){return this.observerCameraSelectedAtChange},UserPreferences.prototype.setObserverCameraSelectedAtChange=function(e){e!==this.observerCameraSelectedAtChange&&(this.observerCameraSelectedAtChange=e,this.propertyChangeSupport.firePropertyChange("OBSERVER_CAMERA_SELECTED_AT_CHANGE",!e,e))},UserPreferences.prototype.isMagnetismEnabled=function(){return this.magnetismEnabled},UserPreferences.prototype.setMagnetismEnabled=function(e){this.magnetismEnabled!==e&&(this.magnetismEnabled=e,this.propertyChangeSupport.firePropertyChange("MAGNETISM_ENABLED",!e,e))},UserPreferences.prototype.isRulersVisible=function(){return this.rulersVisible},UserPreferences.prototype.setRulersVisible=function(e){this.rulersVisible!==e&&(this.rulersVisible=e,this.propertyChangeSupport.firePropertyChange("RULERS_VISIBLE",!e,e))},UserPreferences.prototype.isGridVisible=function(){return this.gridVisible},UserPreferences.prototype.setGridVisible=function(e){this.gridVisible!==e&&(this.gridVisible=e,this.propertyChangeSupport.firePropertyChange("GRID_VISIBLE",!e,e))},UserPreferences.prototype.getDefaultFontName=function(){return this.defaultFontName},UserPreferences.prototype.setDefaultFontName=function(e){if(e!=this.defaultFontName){var t=this.defaultFontName;this.defaultFontName=e,this.propertyChangeSupport.firePropertyChange("DEFAULT_FONT_NAME",t,e)}},UserPreferences.prototype.isFurnitureViewedFromTop=function(){return this.furnitureViewedFromTop},UserPreferences.prototype.setFurnitureViewedFromTop=function(e){this.furnitureViewedFromTop!==e&&(this.furnitureViewedFromTop=e,this.propertyChangeSupport.firePropertyChange("FURNITURE_VIEWED_FROM_TOP",!e,e))},UserPreferences.prototype.getFurnitureModelIconSize=function(){return this.furnitureModelIconSize},UserPreferences.prototype.setFurnitureModelIconSize=function(e){if(e!==this.furnitureModelIconSize){var t=this.furnitureModelIconSize;this.furnitureModelIconSize=e,this.propertyChangeSupport.firePropertyChange("FURNITURE_MODEL_ICON_SIZE",t,e)}},UserPreferences.prototype.isRoomFloorColoredOrTextured=function(){return this.roomFloorColoredOrTextured},UserPreferences.prototype.setFloorColoredOrTextured=function(e){this.roomFloorColoredOrTextured!==e&&(this.roomFloorColoredOrTextured=e,this.propertyChangeSupport.firePropertyChange("ROOM_FLOOR_COLORED_OR_TEXTURED",!e,e))},UserPreferences.prototype.getWallPattern=function(){return this.wallPattern},UserPreferences.prototype.setWallPattern=function(e){if(this.wallPattern!==e){var t=this.wallPattern;this.wallPattern=e,this.propertyChangeSupport.firePropertyChange("WALL_PATTERN",t,e)}},UserPreferences.prototype.getNewWallPattern=function(){return this.newWallPattern},UserPreferences.prototype.setNewWallPattern=function(e){if(this.newWallPattern!==e){var t=this.newWallPattern;this.newWallPattern=e,this.propertyChangeSupport.firePropertyChange("NEW_WALL_PATTERN",t,e)}},UserPreferences.prototype.getNewWallThickness=function(){return this.newWallThickness},UserPreferences.prototype.setNewWallThickness=function(e){if(this.newWallThickness!==e){var t=this.newWallThickness;this.newWallThickness=e,this.propertyChangeSupport.firePropertyChange("NEW_WALL_THICKNESS",t,e)}},UserPreferences.prototype.getNewWallHeight=function(){return this.newWallHeight},UserPreferences.prototype.setNewWallHeight=function(e){if(this.newWallHeight!==e){var t=this.newWallHeight;this.newWallHeight=e,this.propertyChangeSupport.firePropertyChange("NEW_WALL_HEIGHT",t,e)}},UserPreferences.prototype.getNewWallBaseboardThickness=function(){return this.newWallBaseboardThickness},UserPreferences.prototype.setNewWallBaseboardThickness=function(e){if(this.newWallBaseboardThickness!==e){var t=this.newWallBaseboardThickness;this.newWallBaseboardThickness=e,this.propertyChangeSupport.firePropertyChange("NEW_WALL_SIDEBOARD_THICKNESS",t,e)}},UserPreferences.prototype.getNewWallBaseboardHeight=function(){return this.newWallBaseboardHeight},UserPreferences.prototype.setNewWallBaseboardHeight=function(e){if(this.newWallBaseboardHeight!==e){var t=this.newWallBaseboardHeight;this.newWallBaseboardHeight=e,this.propertyChangeSupport.firePropertyChange("NEW_WALL_SIDEBOARD_HEIGHT",t,e)}},UserPreferences.prototype.getNewRoomFloorColor=function(){return this.newRoomFloorColor},UserPreferences.prototype.setNewRoomFloorColor=function(e){if(this.newRoomFloorColor!==e){var t=this.newRoomFloorColor;this.newRoomFloorColor=e,this.propertyChangeSupport.firePropertyChange("NEW_ROOM_FLOOR_COLOR",t,e)}},UserPreferences.prototype.getNewFloorThickness=function(){return this.newFloorThickness},UserPreferences.prototype.setNewFloorThickness=function(e){if(this.newFloorThickness!==e){var t=this.newFloorThickness;this.newFloorThickness=e,this.propertyChangeSupport.firePropertyChange("NEW_FLOOR_THICKNESS",t,e)}},UserPreferences.prototype.getAutoSaveDelayForRecovery=function(){return this.autoSaveDelayForRecovery},UserPreferences.prototype.setAutoSaveDelayForRecovery=function(e){if(this.autoSaveDelayForRecovery!==e){var t=this.autoSaveDelayForRecovery;this.autoSaveDelayForRecovery=e,this.propertyChangeSupport.firePropertyChange("AUTO_SAVE_DELAY_FOR_RECOVERY",t,e)}},UserPreferences.prototype.getRecentHomes=function(){return this.recentHomes.slice(0)},UserPreferences.prototype.setRecentHomes=function(e){if(e!=this.recentHomes){var t=this.recentHomes;this.recentHomes=e.slice(0),this.propertyChangeSupport.firePropertyChange("RECENT_HOMES",t,this.getRecentHomes())}},UserPreferences.prototype.getRecentHomesMaxCount=function(){return 10},UserPreferences.prototype.getStoredCamerasMaxCount=function(){return 50},UserPreferences.prototype.setActionTipIgnored=function(e){this.propertyChangeSupport.firePropertyChange("IGNORED_ACTION_TIP",null,e)},UserPreferences.prototype.isActionTipIgnored=function(e){return!0},UserPreferences.prototype.resetIgnoredActionTips=function(){this.propertyChangeSupport.firePropertyChange("IGNORED_ACTION_TIP",null,null)},UserPreferences.prototype.getDefaultTextStyle=function(e){return"Room"==e.name?UserPreferences.DEFAULT_ROOM_TEXT_STYLE:UserPreferences.DEFAULT_TEXT_STYLE},UserPreferences.prototype.getAutoCompletionStrings=function(e){var t=this.autoCompletionStrings.get(e);return void 0!==t?t.slice(0):[]},UserPreferences.prototype.addAutoCompletionString=function(e,t){if(null!==t&&t.length>0){var i=this.autoCompletionStrings[e];if(void 0===i)i=[];else{if(!(i.indexOf(t)<0))return;i=i.slice(0)}i.splice(0,0,t),this.setAutoCompletionStrings(e,i)}},UserPreferences.prototype.setAutoCompletionStrings=function(e,t){t!=this.autoCompletionStrings[e]&&(this.autoCompletionStrings[e]=t.slice(0),this.propertyChangeSupport.firePropertyChange("AUTO_COMPLETION_STRINGS",null,e))},UserPreferences.prototype.getAutoCompletedProperties=function(){return null!==this.autoCompletionStrings?Object.keys(this.autoCompletionStrings):[]},UserPreferences.prototype.getRecentColors=function(){return this.recentColors},UserPreferences.prototype.setRecentColors=function(e){if(e!=this.recentColors){var t=this.recentColors;this.recentColors=e.slice(0),this.propertyChangeSupport.firePropertyChange("RECENT_COLORS",t,this.getRecentColors())}},UserPreferences.prototype.getRecentTextures=function(){return this.recentTextures},UserPreferences.prototype.setRecentTextures=function(e){if(e!=this.recentTextures){var t=this.recentTextures;this.recentTextures=e.slice(0),this.propertyChangeSupport.firePropertyChange("RECENT_TEXTURES",t,this.getRecentTextures())}},UserPreferences.prototype.setHomeExamples=function(e){if(e!=this.homeExamples){var t=this.homeExamples;this.homeExamples=e.slice(0),this.propertyChangeSupport.firePropertyChange("HOME_EXAMPLES",t,this.getHomeExamples())}},UserPreferences.prototype.getHomeExamples=function(){return this.homeExamples},UserPreferences.prototype.isCheckUpdatesEnabled=function(){},UserPreferences.prototype.setCheckUpdatesEnabled=function(e){},UserPreferences.prototype.isImportedImageResizedWithoutPrompting=function(){return!0},DefaultUserPreferences.prototype=Object.create(UserPreferences.prototype),DefaultUserPreferences.prototype.constructor=DefaultUserPreferences,DefaultUserPreferences.prototype.write=function(){UserPreferences.prototype.write.call(this)},DefaultPatternTexture.__class="com.eteks.sweethome3d.io.DefaultPatternTexture",DefaultPatternTexture.__interfaces=["com.eteks.sweethome3d.model.TextureImage"],DefaultPatternTexture.__transients=["image"],DefaultPatternTexture.prototype.getName=function(){return this.name},DefaultPatternTexture.prototype.getCreator=function(){return null},DefaultPatternTexture.prototype.getImage=function(){return this.image},DefaultPatternTexture.prototype.getWidth=function(){return 10},DefaultPatternTexture.prototype.getHeight=function(){return 10},DefaultPatternTexture.prototype.equals=function(e){return e===this||e instanceof DefaultPatternTexture&&e.name==this.name},RecordedUserPreferences.prototype=Object.create(UserPreferences.prototype),RecordedUserPreferences.prototype.constructor=RecordedUserPreferences,RecordedUserPreferences.LANGUAGE="language",RecordedUserPreferences.UNIT="unit",RecordedUserPreferences.CURRENCY="currency",RecordedUserPreferences.VALUE_ADDED_TAX_ENABLED="valueAddedTaxEnabled",RecordedUserPreferences.DEFAULT_VALUE_ADDED_TAX_PERCENTAGE="defaultValueAddedTaxPercentage",RecordedUserPreferences.FURNITURE_CATALOG_VIEWED_IN_TREE="furnitureCatalogViewedInTree",RecordedUserPreferences.NAVIGATION_PANEL_VISIBLE="navigationPanelVisible",RecordedUserPreferences.EDITING_IN_3D_VIEW_ENABLED="editingIn3DViewEnabled",RecordedUserPreferences.AERIAL_VIEW_CENTERED_ON_SELECTION_ENABLED="aerialViewCenteredOnSelectionEnabled",RecordedUserPreferences.OBSERVER_CAMERA_SELECTED_AT_CHANGE="observerCameraSelectedAtChange",RecordedUserPreferences.MAGNETISM_ENABLED="magnetismEnabled",RecordedUserPreferences.RULERS_VISIBLE="rulersVisible",RecordedUserPreferences.GRID_VISIBLE="gridVisible",RecordedUserPreferences.DEFAULT_FONT_NAME="defaultFontName",RecordedUserPreferences.FURNITURE_VIEWED_FROM_TOP="furnitureViewedFromTop",RecordedUserPreferences.FURNITURE_MODEL_ICON_SIZE="furnitureModelIconSize",RecordedUserPreferences.ROOM_FLOOR_COLORED_OR_TEXTURED="roomFloorColoredOrTextured",RecordedUserPreferences.WALL_PATTERN="wallPattern",RecordedUserPreferences.NEW_WALL_PATTERN="newWallPattern",RecordedUserPreferences.NEW_WALL_THICKNESS="newWallThickness",RecordedUserPreferences.NEW_WALL_HEIGHT="newHomeWallHeight",RecordedUserPreferences.NEW_WALL_BASEBOARD_THICKNESS="newWallBaseboardThickness",RecordedUserPreferences.NEW_WALL_BASEBOARD_HEIGHT="newWallBaseboardHeight",RecordedUserPreferences.NEW_FLOOR_THICKNESS="newFloorThickness",RecordedUserPreferences.AUTO_SAVE_DELAY_FOR_RECOVERY="autoSaveDelayForRecovery",RecordedUserPreferences.RECENT_HOMES="recentHomes#",RecordedUserPreferences.IGNORED_ACTION_TIP="ignoredActionTip#",RecordedUserPreferences.TEXTURE_NAME="textureName#",RecordedUserPreferences.TEXTURE_CREATOR="textureCreator#",RecordedUserPreferences.TEXTURE_CATEGORY="textureCategory#",RecordedUserPreferences.TEXTURE_IMAGE="textureImage#",RecordedUserPreferences.TEXTURE_WIDTH="textureWidth#",RecordedUserPreferences.TEXTURE_HEIGHT="textureHeight#",RecordedUserPreferences.prototype.getProperty=function(e,t,i){return void 0===e[t]||null===e[t]?i:e[t]},RecordedUserPreferences.prototype.getProperties=function(){return this.properties},RecordedUserPreferences.prototype.setProperty=function(e,t,i){e[t]=i},RecordedUserPreferences.prototype.removeProperty=function(e,t){delete e[t]},RecordedUserPreferences.prototype.updatePreferencesFromProperties=function(e,t,i){this.setLanguage(this.getProperty(e,RecordedUserPreferences.LANGUAGE,t)),i&&this.updateDefaultCatalogs(),this.readModifiableTexturesCatalog(e);var n=new DefaultUserPreferences(!1,t);n.setLanguage(this.getLanguage());var o=n.getPatternsCatalog();this.setPatternsCatalog(o);var r=LengthUnit[this.getProperty(e,RecordedUserPreferences.UNIT)];r||(r=n.getLengthUnit()),this.setUnit(r),this.setCurrency(this.getProperty(e,RecordedUserPreferences.CURRENCY,n.getCurrency())),this.setValueAddedTaxEnabled("true"==this.getProperty(e,RecordedUserPreferences.VALUE_ADDED_TAX_ENABLED,""+n.isValueAddedTaxEnabled()));var l=this.getProperty(e,RecordedUserPreferences.DEFAULT_VALUE_ADDED_TAX_PERCENTAGE),a=n.getDefaultValueAddedTaxPercentage();if(null!==l)try{a=new Big(l)}catch(e){}this.setDefaultValueAddedTaxPercentage(a),this.setFurnitureCatalogViewedInTree("true"==this.getProperty(e,RecordedUserPreferences.FURNITURE_CATALOG_VIEWED_IN_TREE,""+n.isFurnitureCatalogViewedInTree())),this.setNavigationPanelVisible("true"==this.getProperty(e,RecordedUserPreferences.NAVIGATION_PANEL_VISIBLE,""+n.isNavigationPanelVisible())),this.setEditingIn3DViewEnabled("true"==this.getProperty(e,RecordedUserPreferences.EDITING_IN_3D_VIEW_ENABLED,""+n.isEditingIn3DViewEnabled())),this.setAerialViewCenteredOnSelectionEnabled("true"==this.getProperty(e,RecordedUserPreferences.AERIAL_VIEW_CENTERED_ON_SELECTION_ENABLED,""+n.isAerialViewCenteredOnSelectionEnabled())),this.setObserverCameraSelectedAtChange("true"==this.getProperty(e,RecordedUserPreferences.OBSERVER_CAMERA_SELECTED_AT_CHANGE,""+n.isObserverCameraSelectedAtChange())),this.setMagnetismEnabled("true"==this.getProperty(e,RecordedUserPreferences.MAGNETISM_ENABLED,"true")),this.setRulersVisible("true"==this.getProperty(e,RecordedUserPreferences.RULERS_VISIBLE,""+n.isMagnetismEnabled())),this.setGridVisible("true"==this.getProperty(e,RecordedUserPreferences.GRID_VISIBLE,""+n.isGridVisible())),this.setDefaultFontName(this.getProperty(e,RecordedUserPreferences.DEFAULT_FONT_NAME,n.getDefaultFontName())),this.setFurnitureViewedFromTop("true"==this.getProperty(e,RecordedUserPreferences.FURNITURE_VIEWED_FROM_TOP,""+n.isFurnitureViewedFromTop())),this.setFurnitureModelIconSize(parseInt(this.getProperty(e,RecordedUserPreferences.FURNITURE_MODEL_ICON_SIZE,""+n.getFurnitureModelIconSize()))),this.setFloorColoredOrTextured("true"==this.getProperty(e,RecordedUserPreferences.ROOM_FLOOR_COLORED_OR_TEXTURED,""+n.isRoomFloorColoredOrTextured()));try{this.setWallPattern(o.getPattern(this.getProperty(e,RecordedUserPreferences.WALL_PATTERN,n.getWallPattern().getName())))}catch(e){this.setWallPattern(n.getWallPattern())}try{null!=n.getNewWallPattern()&&this.setNewWallPattern(o.getPattern(this.getProperty(e,RecordedUserPreferences.NEW_WALL_PATTERN,n.getNewWallPattern().getName())))}catch(e){}this.setNewWallThickness(parseFloat(this.getProperty(e,RecordedUserPreferences.NEW_WALL_THICKNESS,""+n.getNewWallThickness()))),this.setNewWallHeight(parseFloat(this.getProperty(e,RecordedUserPreferences.NEW_WALL_HEIGHT,""+n.getNewWallHeight()))),this.setNewWallBaseboardThickness(n.getNewWallBaseboardThickness()),this.setNewWallBaseboardHeight(n.getNewWallBaseboardHeight()),this.setNewWallBaseboardThickness(parseFloat(this.getProperty(e,RecordedUserPreferences.NEW_WALL_BASEBOARD_THICKNESS,""+n.getNewWallBaseboardThickness()))),this.setNewWallBaseboardHeight(parseFloat(this.getProperty(e,RecordedUserPreferences.NEW_WALL_BASEBOARD_HEIGHT,""+n.getNewWallBaseboardHeight()))),this.setNewFloorThickness(parseFloat(this.getProperty(e,RecordedUserPreferences.NEW_FLOOR_THICKNESS,""+n.getNewFloorThickness()))),this.setAutoSaveDelayForRecovery(parseInt(this.getProperty(e,RecordedUserPreferences.AUTO_SAVE_DELAY_FOR_RECOVERY,""+n.getAutoSaveDelayForRecovery())));for(var s=[],h=1;h<=this.getRecentHomesMaxCount();h++){var u=this.getProperty(e,RecordedUserPreferences.RECENT_HOMES+h);null!=u&&s.push(u)}this.setRecentHomes(s);for(h=1;;h++){var d=this.getProperty(e,RecordedUserPreferences.IGNORED_ACTION_TIP+h,"");if(0==d.length)break;this.ignoredActionTips[d]=!0}},RecordedUserPreferences.prototype.addListeners=function(){var e=this;this.addPropertyChangeListener("LANGUAGE",(function(){e.updateDefaultCatalogs()}));for(var t=function(){e.writtenPropertiesUpdated=!0},i=["LANGUAGE","UNIT","CURRENCY","VALUE_ADDED_TAX_ENABLED","DEFAULT_VALUE_ADDED_TAX_PERCENTAGE","FURNITURE_CATALOG_VIEWED_IN_TREE","NAVIGATION_PANEL_VISIBLE","EDITING_IN_3D_VIEW_ENABLED","AERIAL_VIEW_CENTERED_ON_SELECTION_ENABLED","OBSERVER_CAMERA_SELECTED_AT_CHANGE","MAGNETISM_ENABLED","GRID_VISIBLE","DEFAULT_FONT_NAME","FURNITURE_VIEWED_FROM_TOP","FURNITURE_MODEL_ICON_SIZE","ROOM_FLOOR_COLORED_OR_TEXTURED","NEW_WALL_PATTERN","NEW_WALL_THICKNESS","NEW_WALL_HEIGHT","NEW_WALL_BASEBOARD_THICKNESS","NEW_WALL_BASEBOARD_HEIGHT","NEW_FLOOR_THICKNESS"],n=0;n<i.length;n++){var o=i[n];this.addPropertyChangeListener(o,t)}this.getTexturesCatalog().addTexturesListener(t)},RecordedUserPreferences.prototype.readPreferences=function(e,t){try{var i=this,n=function(n){if(null!=n){var o=JSON.parse(n);for(var r in o)e[r]=o[r]}i.updatePreferencesFromProperties(e,t,!0),i.addListeners()};if(0===this.readPreferencesUrl.indexOf(LocalStorageURLContent.LOCAL_STORAGE_PREFIX)){var o=this.readPreferencesUrl.substring(LocalStorageURLContent.LOCAL_STORAGE_PREFIX.length);n(localStorage.getItem(o))}else if(0===this.readPreferencesUrl.indexOf(IndexedDBURLContent.INDEXED_DB_PREFIX))new IndexedDBURLContent(this.readPreferencesUrl).getBlob({blobReady:function(e){var t=new FileReader;t.onload=function(){n(t.result)},t.readAsText(e)},blobError:function(e,t){i.updateDefaultCatalogs(),i.addListeners(),-1!=e&&console.log("Can't read preferences from indexedDB "+e+" "+t)}});else{var r=new XMLHttpRequest,l=-1!=this.readPreferencesUrl.indexOf("?")?"&":"?";r.open("GET",this.readPreferencesUrl+l+"requestId="+UUID.randomUUID(),!0),r.addEventListener("load",(function(){r.readyState===XMLHttpRequest.DONE&&200===r.status?n(r.responseText):(i.updateDefaultCatalogs(),i.addListeners())}));var a=function(e){console.log("Can't read preferences from server"),i.updateDefaultCatalogs(),i.addListeners()};r.addEventListener("error",a),r.addEventListener("timeout",a),r.timeout=1e4,r.send()}}catch(e){console.log(e),i.updateDefaultCatalogs(),i.addListeners()}},RecordedUserPreferences.prototype.updateDefaultCatalogs=function(){for(var e=this.getFurnitureCatalog(),t=e.getCategories().length-1;t>=0;t--)for(var i=(o=e.getCategory(t)).getFurniture().length-1;i>=0;i--){(r=o.getPieceOfFurniture(i)).isModifiable()||e.delete(r)}var n="function"==typeof DefaultFurnitureCatalog?Array.isArray(this.furnitureCatalogUrls)?this.readFurnitureCatalogFromResource(this.furnitureCatalogUrls,this.furnitureResourcesUrlBase):new DefaultFurnitureCatalog(this):new FurnitureCatalog;for(t=0;t<n.getCategories().length;t++){var o=n.getCategory(t);for(i=0;i<o.getFurniture().length;i++){var r=o.getPieceOfFurniture(i);e.add(o,r)}}var l=this.getTexturesCatalog();for(t=l.getCategories().length-1;t>=0;t--)for(i=(o=l.getCategory(t)).getTextures().length-1;i>=0;i--){(s=o.getTexture(i)).isModifiable()||l.delete(s)}var a="function"==typeof DefaultTexturesCatalog?Array.isArray(this.texturesCatalogUrls)?this.readTexturesCatalogFromResource(this.texturesCatalogUrls,this.texturesResourcesUrlBase):new DefaultTexturesCatalog(this):new TexturesCatalog;for(t=0;t<a.getCategories().length;t++)for(o=a.getCategory(t),i=0;i<o.getTextures().length;i++){var s=o.getTexture(i);l.add(o,s)}},RecordedUserPreferences.prototype.readFurnitureCatalogFromResource=function(e,t){return new DefaultFurnitureCatalog(e,t)},RecordedUserPreferences.prototype.readTexturesCatalogFromResource=function(e,t){return new DefaultTexturesCatalog(e,t)},RecordedUserPreferences.prototype.readModifiableTexturesCatalog=function(e){for(var t,i=1;null!=(t=this.readModifiableTexture(e,i));i++)if(""!=t.getImage().getURL()){var n=this.readModifiableTextureCategory(e,i);this.getTexturesCatalog().add(n,t)}},RecordedUserPreferences.prototype.readModifiableTexture=function(e,t){var i=this.getProperty(e,RecordedUserPreferences.TEXTURE_NAME+t,null);if(null==i)return null;var n=URLContent.fromURL(this.getProperty(e,RecordedUserPreferences.TEXTURE_IMAGE+t,"")),o=parseFloat(this.getProperty(e,RecordedUserPreferences.TEXTURE_WIDTH+t,"0.1")),r=parseFloat(this.getProperty(e,RecordedUserPreferences.TEXTURE_HEIGHT+t,"0.1")),l=this.getProperty(e,RecordedUserPreferences.TEXTURE_CREATOR+t,null);return new CatalogTexture(null,i,n,o,r,l,!0)},RecordedUserPreferences.prototype.readModifiableTextureCategory=function(e,t){var i=this.getProperty(e,RecordedUserPreferences.TEXTURE_CATEGORY+t,"");return new TexturesCategory(i)},RecordedUserPreferences.prototype.write=function(){if(UserPreferences.prototype.write.call(this),this.writtenPropertiesUpdated){var e=this.getProperties();this.writeModifiableTexturesCatalog(e),this.setProperty(e,RecordedUserPreferences.LANGUAGE,this.getLanguage()),this.setProperty(e,RecordedUserPreferences.UNIT,this.getLengthUnit().name());var t=this.getCurrency();null===t?this.removeProperty(e,RecordedUserPreferences.CURRENCY):this.setProperty(e,RecordedUserPreferences.CURRENCY,t),this.setProperty(e,RecordedUserPreferences.VALUE_ADDED_TAX_ENABLED,""+this.isValueAddedTaxEnabled());var i=this.getDefaultValueAddedTaxPercentage();null===i?this.removeProperty(e,RecordedUserPreferences.DEFAULT_VALUE_ADDED_TAX_PERCENTAGE):this.setProperty(e,RecordedUserPreferences.DEFAULT_VALUE_ADDED_TAX_PERCENTAGE,i.toString()),this.setProperty(e,RecordedUserPreferences.FURNITURE_CATALOG_VIEWED_IN_TREE,""+this.isFurnitureCatalogViewedInTree()),this.setProperty(e,RecordedUserPreferences.NAVIGATION_PANEL_VISIBLE,""+this.isNavigationPanelVisible()),this.setProperty(e,RecordedUserPreferences.EDITING_IN_3D_VIEW_ENABLED,""+this.isEditingIn3DViewEnabled()),this.setProperty(e,RecordedUserPreferences.AERIAL_VIEW_CENTERED_ON_SELECTION_ENABLED,""+this.isAerialViewCenteredOnSelectionEnabled()),this.setProperty(e,RecordedUserPreferences.OBSERVER_CAMERA_SELECTED_AT_CHANGE,""+this.isObserverCameraSelectedAtChange()),this.setProperty(e,RecordedUserPreferences.MAGNETISM_ENABLED,""+this.isMagnetismEnabled()),this.setProperty(e,RecordedUserPreferences.RULERS_VISIBLE,""+this.isRulersVisible()),this.setProperty(e,RecordedUserPreferences.GRID_VISIBLE,""+this.isGridVisible());var n=this.getDefaultFontName();null==n?this.removeProperty(e,RecordedUserPreferences.DEFAULT_FONT_NAME):this.setProperty(e,RecordedUserPreferences.DEFAULT_FONT_NAME,n),this.setProperty(e,RecordedUserPreferences.FURNITURE_VIEWED_FROM_TOP,""+this.isFurnitureViewedFromTop()),this.setProperty(e,RecordedUserPreferences.FURNITURE_MODEL_ICON_SIZE,""+this.getFurnitureModelIconSize()),this.setProperty(e,RecordedUserPreferences.ROOM_FLOOR_COLORED_OR_TEXTURED,""+this.isRoomFloorColoredOrTextured()),this.setProperty(e,RecordedUserPreferences.WALL_PATTERN,this.getWallPattern().getName());var o=this.getNewWallPattern();null!=o&&this.setProperty(e,RecordedUserPreferences.NEW_WALL_PATTERN,o.getName()),this.setProperty(e,RecordedUserPreferences.NEW_WALL_THICKNESS,""+this.getNewWallThickness()),this.setProperty(e,RecordedUserPreferences.NEW_WALL_HEIGHT,""+this.getNewWallHeight()),this.setProperty(e,RecordedUserPreferences.NEW_WALL_BASEBOARD_THICKNESS,""+this.getNewWallBaseboardThickness()),this.setProperty(e,RecordedUserPreferences.NEW_WALL_BASEBOARD_HEIGHT,""+this.getNewWallBaseboardHeight()),this.setProperty(e,RecordedUserPreferences.NEW_FLOOR_THICKNESS,""+this.getNewFloorThickness()),this.setProperty(e,RecordedUserPreferences.AUTO_SAVE_DELAY_FOR_RECOVERY,""+this.getAutoSaveDelayForRecovery());for(var r=this.getRecentHomes(),l=0;l<r.length&&l<this.getRecentHomesMaxCount();l++)this.setProperty(e,RecordedUserPreferences.RECENT_HOMES+(l+1),r[l]);var a=Object.keys(this.ignoredActionTips);for(l=0;l<a.length;l++){var s=a[l];this.ignoredActionTips[s]&&this.setProperty(e,RecordedUserPreferences.IGNORED_ACTION_TIP+(l+1),s)}if(Object.keys(this.uploadingBlobs).length>0){var h=this;setTimeout((function(){h.write()}),1e3)}else this.writtenPropertiesUpdated=!1,this.writePreferences(e)}},RecordedUserPreferences.prototype.writePreferences=function(e){if(this.writePreferencesUrl){var t=this;if(this.writingPreferences)setTimeout((function(){t.writePreferences(e)}),100);else{this.writingPreferences=!0;var i=JSON.stringify(e),n=function(){void 0!==t.writingObserver&&t.writingObserver.writeSucceeded&&t.writingObserver.writeSucceeded(e),setTimeout((function(){delete t.writingPreferences}),500)},o=function(i,n){void 0!==t.writingObserver&&t.writingObserver.writeFailed&&t.writingObserver.writeFailed(e,i,n),setTimeout((function(){delete t.writingPreferences,t.writePreferences(e)}),1e4)};if(0===this.writePreferencesUrl.indexOf(LocalStorageURLContent.LOCAL_STORAGE_PREFIX))try{var r=this.writePreferencesUrl.substring(LocalStorageURLContent.LOCAL_STORAGE_PREFIX.length);localStorage.setItem(r,i),n(),delete t.writingPreferences}catch(e){o(e,e.message)}else if(0===this.writePreferencesUrl.indexOf(IndexedDBURLContent.INDEXED_DB_PREFIX)){var l=new BlobURLContent(new Blob([i],{type:"application/json"}));l.writeBlob(this.writePreferencesUrl,"",{blobSaved:function(e,t){URL.revokeObjectURL(l.getURL()),n()},blobError:function(e,t){URL.revokeObjectURL(l.getURL()),o(e,t)}})}else{var a=new XMLHttpRequest,s=-1!=this.writePreferencesUrl.indexOf("?")?"&":"?";a.open("POST",this.writePreferencesUrl+s+"updateId="+UUID.randomUUID(),!0),a.addEventListener("load",(function(e){a.readyState===XMLHttpRequest.DONE&&(200===a.status?n():o(a.status,a.responseText))}));var h=function(e){o(0,"Can't post "+t.writePreferencesUrl)};a.addEventListener("error",h),a.addEventListener("timeout",h),a.send(i)}}}},RecordedUserPreferences.prototype.setActionTipIgnored=function(e){this.ignoredActionTips[e]=!0,UserPreferences.prototype.setActionTipIgnored.call(this,e)},RecordedUserPreferences.prototype.isActionTipIgnored=function(e){return!0===this.ignoredActionTips[e]},RecordedUserPreferences.prototype.resetIgnoredActionTips=function(){for(var e=Object.keys(this.ignoredActionTips),t=0;t<e.length;t++)this.ignoredActionTips[e[t]]=!1;UserPreferences.prototype.resetIgnoredActionTips.call(this)},RecordedUserPreferences.prototype.addLanguageLibrary=function(e){throw new UnsupportedOperationException},RecordedUserPreferences.prototype.languageLibraryExists=function(e){throw new UnsupportedOperationException},RecordedUserPreferences.prototype.furnitureLibraryExists=function(e){throw new UnsupportedOperationException},RecordedUserPreferences.prototype.addFurnitureLibrary=function(e){throw new UnsupportedOperationException},RecordedUserPreferences.prototype.texturesLibraryExists=function(e){throw new UnsupportedOperationException},RecordedUserPreferences.prototype.addTexturesLibrary=function(e){throw new UnsupportedOperationException},RecordedUserPreferences.prototype.getLibraries=function(){throw new UnsupportedOperationException},RecordedUserPreferences.prototype.writeModifiableTexturesCatalog=function(e){if(this.writeResourceUrl&&this.readResourceUrl){for(var t=1,i=this.getTexturesCatalog(),n=this,o=0;o<i.getCategoriesCount();o++)for(var r=i.getCategory(o),l=0;l<r.getTexturesCount();l++){var a=r.getTexture(l),s=a.getImage();if(a.isModifiable()&&s instanceof URLContent){if(this.setProperty(e,RecordedUserPreferences.TEXTURE_NAME+t,a.getName()),this.setProperty(e,RecordedUserPreferences.TEXTURE_CATEGORY+t,r.getName()),this.setProperty(e,RecordedUserPreferences.TEXTURE_WIDTH+t,a.getWidth()),this.setProperty(e,RecordedUserPreferences.TEXTURE_HEIGHT+t,a.getHeight()),null!=a.getCreator()?this.setProperty(e,RecordedUserPreferences.TEXTURE_CREATOR+t,a.getCreator()):this.removeProperty(e,RecordedUserPreferences.TEXTURE_CREATOR+t),!(s instanceof LocalURLContent)||s instanceof LocalStorageURLContent&&!(this.writeResourceUrl.indexOf(LocalStorageURLContent.LOCAL_STORAGE_PREFIX)<0)||s instanceof IndexedDBURLContent&&!(this.writeResourceUrl.indexOf(IndexedDBURLContent.INDEXED_DB_PREFIX)<0))s instanceof URLContent&&this.setProperty(e,RecordedUserPreferences.TEXTURE_IMAGE+t,s.getURL());else if(this.isSavedContentInResourceScope(s))delete n.uploadingBlobs[s.getURL()],this.setProperty(e,RecordedUserPreferences.TEXTURE_IMAGE+t,s.getSavedContent().getURL());else{var h=this.uploadingBlobs[s.getURL()];void 0===h&&s.getBlob({textureImage:s,blobReady:function(i){h=UUID.randomUUID(),n.uploadingBlobs[this.textureImage.getURL()]=h;var o="image/png"==i.type?".png":".jpg";n.writeResource(s,h+o,t,(function(t,i,o){if(!n.isSavedContentInResourceScope(t)){var r=URLContent.fromURL(CoreTools.format(n.readResourceUrl.replace(/(%[^s])/g,"%$1"),encodeURIComponent(i)));t.setSavedContent(r)}delete n.uploadingBlobs[t.getURL()],n.setProperty(e,RecordedUserPreferences.TEXTURE_IMAGE+o,t.getSavedContent().getURL())}))},blobError:function(e,t){contentsObserver.resourcesError(e,t)}})}t++}}for(;null!=this.getProperty(e,RecordedUserPreferences.TEXTURE_NAME+t,null);t++)this.removeProperty(e,RecordedUserPreferences.TEXTURE_NAME+t),this.removeProperty(e,RecordedUserPreferences.TEXTURE_IMAGE+t),this.removeProperty(e,RecordedUserPreferences.TEXTURE_CATEGORY+t),this.removeProperty(e,RecordedUserPreferences.TEXTURE_WIDTH+t),this.removeProperty(e,RecordedUserPreferences.TEXTURE_HEIGHT+t),this.removeProperty(e,RecordedUserPreferences.TEXTURE_CREATOR+t)}},RecordedUserPreferences.prototype.isSavedContentInResourceScope=function(e){var t=e.getSavedContent();return null!==t&&(!(t instanceof IndexedDBURLContent)||this.writeResourceUrl.indexOf(IndexedDBURLContent.INDEXED_DB_PREFIX)<0||0===t.getURL().indexOf(this.writeResourceUrl.substring(0,this.writeResourceUrl.indexOf("?"))))},RecordedUserPreferences.prototype.writeResource=function(e,t,i,n){var o=this;e.writeBlob(this.writeResourceUrl,t,{blobSaved:function(e,r){void 0!==o.writingObserver&&o.writingObserver.writeSucceeded&&o.writingObserver.writeSucceeded(e.getBlob()),n(e,t,i)},blobError:function(r,l){void 0!==o.writingObserver&&o.writingObserver.writeFailed&&o.writingObserver.writeFailed(e.getBlob(),r,l),setTimeout((function(){null===e.getSavedContent()?o.writeResource(e,t,i,n):n(e,i)}),1e4)}})},ResourceAction.prototype=Object.create(AbstractAction.prototype),ResourceAction.prototype.constructor=ResourceAction,ResourceAction.RESOURCE_CLASS="ResourceClass",ResourceAction.RESOURCE_PREFIX="ResourcePrefix",ResourceAction.VISIBLE="Visible",ResourceAction.POPUP="Popup",ResourceAction.TOGGLE_BUTTON_GROUP="ToggleButtonGroup",ResourceAction.TOOL_BAR_ICON="ToolBarIcon",ResourceAction.prototype.readActionProperties=function(e,t,i){var n=i+".";this.putValue(AbstractAction.NAME,this.getOptionalString(e,t,n+AbstractAction.NAME,!0)),this.putValue(AbstractAction.DEFAULT,this.getValue(AbstractAction.NAME)),this.putValue(ResourceAction.POPUP,this.getOptionalString(e,t,n+ResourceAction.POPUP,!0)),this.putValue(AbstractAction.SHORT_DESCRIPTION,this.getOptionalString(e,t,n+AbstractAction.SHORT_DESCRIPTION,!1)),this.putValue(AbstractAction.LONG_DESCRIPTION,this.getOptionalString(e,t,n+AbstractAction.LONG_DESCRIPTION,!1));var o=this.getOptionalString(e,t,n+AbstractAction.SMALL_ICON,!1);null!=o&&this.putValue(AbstractAction.SMALL_ICON,o);var r=this.getOptionalString(e,t,n+ResourceAction.TOOL_BAR_ICON,!1);null!=r&&this.putValue(ResourceAction.TOOL_BAR_ICON,r);var l=n+AbstractAction.ACCELERATOR_KEY,a=this.getOptionalString(e,t,l+"."+OperatingSystem.getName(),!1);null==a&&(a=this.getOptionalString(e,t,l,!1)),null!=a&&this.putValue(AbstractAction.ACCELERATOR_KEY,a);var s=this.getOptionalString(e,t,n+AbstractAction.MNEMONIC_KEY,!1);null!=s&&this.putValue(AbstractAction.MNEMONIC_KEY,s)},ResourceAction.prototype.getOptionalString=function(e,t,i,n){try{var o=n?ResourceAction.getLocalizedLabelText(e,t,i):e.getLocalizedString(t,i);return null!=o&&o.length>0?o:null}catch(e){return null}},ResourceAction.getLocalizedLabelText=function(e,t,i,n){var o=e.getLocalizedString(t,i,n),r=Locale.getDefault();if(0==r.indexOf("zh")||0==r.indexOf("ja")||0==r.indexOf("ko")||0==r.indexOf("uk")){var l=o.indexOf("(");if(-1!==l){var a=o.indexOf(")");if(l===a-2){var s=o.charAt(l+1);s>="A"&&s<="Z"&&(o=o.substring(0,l)+o.substring(a+1))}}}return o},ResourceAction.prototype.getURL=function(e){var t=this.getValue(e);return null!=t&&-1===t.indexOf("://")&&(t=ZIPTools.getScriptFolder()+t),t},ResourceAction.prototype.actionPerformed=function(e){if(null!=this.controller&&null!=this.controllerMethod)return this.controller[this.controllerMethod].apply(this.controller,this.parameters);AbstractAction.prototype.actionPerformed.call(this,e)},PlanComponent.__interfaces=["com.eteks.sweethome3d.viewcontroller.PlanView","com.eteks.sweethome3d.viewcontroller.View","com.eteks.sweethome3d.viewcontroller.ExportableView","com.eteks.sweethome3d.viewcontroller.TransferableView"],PlanComponent.initStatics=function(){PlanComponent.MARGIN=40,PlanComponent.INDICATOR_STROKE=new java.awt.BasicStroke(1.5),PlanComponent.POINT_STROKE=new java.awt.BasicStroke(2),PlanComponent.WALL_STROKE_WIDTH=1.5,PlanComponent.BORDER_STROKE_WIDTH=1,PlanComponent.ALIGNMENT_LINE_OFFSET=25,PlanComponent.ERROR_TEXTURE_IMAGE=null,PlanComponent.WAIT_TEXTURE_IMAGE=null,PlanComponent.HIDPI_SCALE_FACTOR=2,PlanComponent.POINT_INDICATOR=new java.awt.geom.Ellipse2D.Float(-1.5,-1.5,3,3),PlanComponent.FURNITURE_ROTATION_INDICATOR=new java.awt.geom.GeneralPath,PlanComponent.FURNITURE_ROTATION_INDICATOR.append(PlanComponent.POINT_INDICATOR,!1),PlanComponent.FURNITURE_ROTATION_INDICATOR.append(new java.awt.geom.Arc2D.Float(-8,-8,16,16,45,180,java.awt.geom.Arc2D.OPEN),!1),PlanComponent.FURNITURE_ROTATION_INDICATOR.moveTo(2.66,-5.66),PlanComponent.FURNITURE_ROTATION_INDICATOR.lineTo(5.66,-5.66),PlanComponent.FURNITURE_ROTATION_INDICATOR.lineTo(4,-8.3),PlanComponent.FURNITURE_PITCH_ROTATION_INDICATOR=new java.awt.geom.GeneralPath,PlanComponent.FURNITURE_PITCH_ROTATION_INDICATOR.append(PlanComponent.POINT_INDICATOR,!1),PlanComponent.FURNITURE_PITCH_ROTATION_INDICATOR.moveTo(-4.5,0),PlanComponent.FURNITURE_PITCH_ROTATION_INDICATOR.lineTo(-5.2,0),PlanComponent.FURNITURE_PITCH_ROTATION_INDICATOR.moveTo(-9,0),PlanComponent.FURNITURE_PITCH_ROTATION_INDICATOR.lineTo(-10,0),PlanComponent.FURNITURE_PITCH_ROTATION_INDICATOR.append(new java.awt.geom.Arc2D.Float(-12,-8,5,16,200,320,java.awt.geom.Arc2D.OPEN),!1),PlanComponent.FURNITURE_PITCH_ROTATION_INDICATOR.moveTo(-10,-4.5),PlanComponent.FURNITURE_PITCH_ROTATION_INDICATOR.lineTo(-12.3,-2),PlanComponent.FURNITURE_PITCH_ROTATION_INDICATOR.lineTo(-12.8,-5.8);var e=java.awt.geom.AffineTransform.getRotateInstance(-Math.PI/2);e.concatenate(java.awt.geom.AffineTransform.getScaleInstance(1,-1)),PlanComponent.FURNITURE_ROLL_ROTATION_INDICATOR=PlanComponent.FURNITURE_PITCH_ROTATION_INDICATOR.createTransformedShape(e),PlanComponent.ELEVATION_POINT_INDICATOR=new java.awt.geom.Rectangle2D.Float(-1.5,-1.5,3,3),PlanComponent.ELEVATION_INDICATOR=new java.awt.geom.GeneralPath,PlanComponent.ELEVATION_INDICATOR.moveTo(0,-5),PlanComponent.ELEVATION_INDICATOR.lineTo(0,5),PlanComponent.ELEVATION_INDICATOR.moveTo(-2.5,5),PlanComponent.ELEVATION_INDICATOR.lineTo(2.5,5),PlanComponent.ELEVATION_INDICATOR.moveTo(-1.2,1.5),PlanComponent.ELEVATION_INDICATOR.lineTo(0,4.5),PlanComponent.ELEVATION_INDICATOR.lineTo(1.2,1.5),PlanComponent.HEIGHT_POINT_INDICATOR=new java.awt.geom.Rectangle2D.Float(-1.5,-1.5,3,3),PlanComponent.FURNITURE_HEIGHT_INDICATOR=new java.awt.geom.GeneralPath,PlanComponent.FURNITURE_HEIGHT_INDICATOR.moveTo(0,-6),PlanComponent.FURNITURE_HEIGHT_INDICATOR.lineTo(0,6),PlanComponent.FURNITURE_HEIGHT_INDICATOR.moveTo(-2.5,-6),PlanComponent.FURNITURE_HEIGHT_INDICATOR.lineTo(2.5,-6),PlanComponent.FURNITURE_HEIGHT_INDICATOR.moveTo(-2.5,6),PlanComponent.FURNITURE_HEIGHT_INDICATOR.lineTo(2.5,6),PlanComponent.FURNITURE_HEIGHT_INDICATOR.moveTo(-1.2,-2.5),PlanComponent.FURNITURE_HEIGHT_INDICATOR.lineTo(0,-5.5),PlanComponent.FURNITURE_HEIGHT_INDICATOR.lineTo(1.2,-2.5),PlanComponent.FURNITURE_HEIGHT_INDICATOR.moveTo(-1.2,2.5),PlanComponent.FURNITURE_HEIGHT_INDICATOR.lineTo(0,5.5),PlanComponent.FURNITURE_HEIGHT_INDICATOR.lineTo(1.2,2.5),PlanComponent.LIGHT_POWER_POINT_INDICATOR=new java.awt.geom.Rectangle2D.Float(-1.5,-1.5,3,3),PlanComponent.LIGHT_POWER_INDICATOR=new java.awt.geom.GeneralPath,PlanComponent.LIGHT_POWER_INDICATOR.moveTo(-8,0),PlanComponent.LIGHT_POWER_INDICATOR.lineTo(-6,0),PlanComponent.LIGHT_POWER_INDICATOR.lineTo(-6,-1),PlanComponent.LIGHT_POWER_INDICATOR.closePath(),PlanComponent.LIGHT_POWER_INDICATOR.moveTo(-3,0),PlanComponent.LIGHT_POWER_INDICATOR.lineTo(-1,0),PlanComponent.LIGHT_POWER_INDICATOR.lineTo(-1,-2.5),PlanComponent.LIGHT_POWER_INDICATOR.lineTo(-3,-1.8),PlanComponent.LIGHT_POWER_INDICATOR.closePath(),PlanComponent.LIGHT_POWER_INDICATOR.moveTo(2,0),PlanComponent.LIGHT_POWER_INDICATOR.lineTo(4,0),PlanComponent.LIGHT_POWER_INDICATOR.lineTo(4,-3.5),PlanComponent.LIGHT_POWER_INDICATOR.lineTo(2,-2.8),PlanComponent.LIGHT_POWER_INDICATOR.closePath(),PlanComponent.FURNITURE_RESIZE_INDICATOR=new java.awt.geom.GeneralPath,PlanComponent.FURNITURE_RESIZE_INDICATOR.append(new java.awt.geom.Rectangle2D.Float(-1.5,-1.5,3,3),!1),PlanComponent.FURNITURE_RESIZE_INDICATOR.moveTo(5,-4),PlanComponent.FURNITURE_RESIZE_INDICATOR.lineTo(7,-4),PlanComponent.FURNITURE_RESIZE_INDICATOR.lineTo(7,7),PlanComponent.FURNITURE_RESIZE_INDICATOR.lineTo(-4,7),PlanComponent.FURNITURE_RESIZE_INDICATOR.lineTo(-4,5),PlanComponent.FURNITURE_RESIZE_INDICATOR.moveTo(3.5,3.5),PlanComponent.FURNITURE_RESIZE_INDICATOR.lineTo(9,9),PlanComponent.FURNITURE_RESIZE_INDICATOR.moveTo(7,9.5),PlanComponent.FURNITURE_RESIZE_INDICATOR.lineTo(10,10),PlanComponent.FURNITURE_RESIZE_INDICATOR.lineTo(9.5,7),PlanComponent.WALL_ORIENTATION_INDICATOR=new java.awt.geom.GeneralPath,PlanComponent.WALL_ORIENTATION_INDICATOR.moveTo(-4,-4),PlanComponent.WALL_ORIENTATION_INDICATOR.lineTo(4,0),PlanComponent.WALL_ORIENTATION_INDICATOR.lineTo(-4,4),PlanComponent.WALL_POINT=new java.awt.geom.Ellipse2D.Float(-3,-3,6,6),PlanComponent.WALL_ARC_EXTENT_INDICATOR=new java.awt.geom.GeneralPath,PlanComponent.WALL_ARC_EXTENT_INDICATOR.append(new java.awt.geom.Arc2D.Float(-4,1,8,5,210,120,java.awt.geom.Arc2D.OPEN),!1),PlanComponent.WALL_ARC_EXTENT_INDICATOR.moveTo(0,6),PlanComponent.WALL_ARC_EXTENT_INDICATOR.lineTo(0,11),PlanComponent.WALL_ARC_EXTENT_INDICATOR.moveTo(-1.8,8.7),PlanComponent.WALL_ARC_EXTENT_INDICATOR.lineTo(0,12),PlanComponent.WALL_ARC_EXTENT_INDICATOR.lineTo(1.8,8.7),PlanComponent.WALL_AND_LINE_RESIZE_INDICATOR=new java.awt.geom.GeneralPath,PlanComponent.WALL_AND_LINE_RESIZE_INDICATOR.moveTo(5,-2),PlanComponent.WALL_AND_LINE_RESIZE_INDICATOR.lineTo(5,2),PlanComponent.WALL_AND_LINE_RESIZE_INDICATOR.moveTo(6,0),PlanComponent.WALL_AND_LINE_RESIZE_INDICATOR.lineTo(11,0),PlanComponent.WALL_AND_LINE_RESIZE_INDICATOR.moveTo(8.7,-1.8),PlanComponent.WALL_AND_LINE_RESIZE_INDICATOR.lineTo(12,0),PlanComponent.WALL_AND_LINE_RESIZE_INDICATOR.lineTo(8.7,1.8),e=java.awt.geom.AffineTransform.getRotateInstance(-Math.PI/4),PlanComponent.CAMERA_YAW_ROTATION_INDICATOR=PlanComponent.FURNITURE_ROTATION_INDICATOR.createTransformedShape(e),e=java.awt.geom.AffineTransform.getRotateInstance(Math.PI),PlanComponent.CAMERA_PITCH_ROTATION_INDICATOR=PlanComponent.FURNITURE_PITCH_ROTATION_INDICATOR.createTransformedShape(e),PlanComponent.CAMERA_ELEVATION_INDICATOR=new java.awt.geom.GeneralPath,PlanComponent.CAMERA_ELEVATION_INDICATOR.moveTo(0,-4),PlanComponent.CAMERA_ELEVATION_INDICATOR.lineTo(0,4),PlanComponent.CAMERA_ELEVATION_INDICATOR.moveTo(-2.5,4),PlanComponent.CAMERA_ELEVATION_INDICATOR.lineTo(2.5,4),PlanComponent.CAMERA_ELEVATION_INDICATOR.moveTo(-1.2,.5),PlanComponent.CAMERA_ELEVATION_INDICATOR.lineTo(0,3.5),PlanComponent.CAMERA_ELEVATION_INDICATOR.lineTo(1.2,.5);var t=new java.awt.geom.GeneralPath;t.append(new java.awt.geom.Ellipse2D.Float(-.5,-.425,1,.85),!1),t.append(new java.awt.geom.Ellipse2D.Float(-.5,-.3,.24,.6),!1),t.append(new java.awt.geom.Ellipse2D.Float(.26,-.3,.24,.6),!1),PlanComponent.CAMERA_HUMAN_BODY=new java.awt.geom.Area(t);var i=new java.awt.geom.GeneralPath;i.append(new java.awt.geom.Ellipse2D.Float(-.18,-.45,.36,1),!1),i.moveTo(-.04,.55),i.lineTo(0,.65),i.lineTo(.04,.55),i.closePath(),PlanComponent.CAMERA_HUMAN_HEAD=new java.awt.geom.Area(i);var n=new java.awt.geom.GeneralPath;n.moveTo(.5,.3),n.lineTo(.45,.35),n.lineTo(.2,.35),n.lineTo(.2,.5),n.lineTo(-.2,.5),n.lineTo(-.2,.35),n.lineTo(-.3,.35),n.lineTo(-.35,.5),n.lineTo(-.5,.3),n.lineTo(-.5,-.45),n.lineTo(-.45,-.5),n.lineTo(.45,-.5),n.lineTo(.5,-.45),n.closePath(),PlanComponent.CAMERA_BODY=new java.awt.geom.Area(n),PlanComponent.CAMERA_BUTTON=new java.awt.geom.Ellipse2D.Float(-.37,-.2,.15,.32),PlanComponent.DIMENSION_LINE_MARK_END=new java.awt.geom.GeneralPath,PlanComponent.DIMENSION_LINE_MARK_END.moveTo(-5,5),PlanComponent.DIMENSION_LINE_MARK_END.lineTo(5,-5),PlanComponent.DIMENSION_LINE_MARK_END.moveTo(0,5),PlanComponent.DIMENSION_LINE_MARK_END.lineTo(0,-5),PlanComponent.VERTICAL_DIMENSION_LINE_DISC=new java.awt.geom.Ellipse2D.Float(-1.5,-1.5,3,3),PlanComponent.VERTICAL_DIMENSION_LINE=new java.awt.geom.GeneralPath,PlanComponent.VERTICAL_DIMENSION_LINE.append(new java.awt.geom.Ellipse2D.Float(-5,-5,10,10),!1),PlanComponent.DIMENSION_LINE_HEIGHT_INDICATOR=PlanComponent.FURNITURE_HEIGHT_INDICATOR,PlanComponent.TEXT_LOCATION_INDICATOR=new java.awt.geom.GeneralPath,PlanComponent.TEXT_LOCATION_INDICATOR.append(new java.awt.geom.Arc2D.Float(-2,0,4,4,190,160,java.awt.geom.Arc2D.CHORD),!1),PlanComponent.TEXT_LOCATION_INDICATOR.moveTo(0,4),PlanComponent.TEXT_LOCATION_INDICATOR.lineTo(0,12),PlanComponent.TEXT_LOCATION_INDICATOR.moveTo(-1.2,8.5),PlanComponent.TEXT_LOCATION_INDICATOR.lineTo(0,11.5),PlanComponent.TEXT_LOCATION_INDICATOR.lineTo(1.2,8.5),PlanComponent.TEXT_LOCATION_INDICATOR.moveTo(2,3),PlanComponent.TEXT_LOCATION_INDICATOR.lineTo(9,6),PlanComponent.TEXT_LOCATION_INDICATOR.moveTo(6,6.5),PlanComponent.TEXT_LOCATION_INDICATOR.lineTo(10,7),PlanComponent.TEXT_LOCATION_INDICATOR.lineTo(7.5,3.5),PlanComponent.TEXT_LOCATION_INDICATOR.moveTo(-2,3),PlanComponent.TEXT_LOCATION_INDICATOR.lineTo(-9,6),PlanComponent.TEXT_LOCATION_INDICATOR.moveTo(-6,6.5),PlanComponent.TEXT_LOCATION_INDICATOR.lineTo(-10,7),PlanComponent.TEXT_LOCATION_INDICATOR.lineTo(-7.5,3.5),PlanComponent.TEXT_ANGLE_INDICATOR=new java.awt.geom.GeneralPath,PlanComponent.TEXT_ANGLE_INDICATOR.append(new java.awt.geom.Arc2D.Float(-1.25,-1.25,2.5,2.5,10,160,java.awt.geom.Arc2D.CHORD),!1),PlanComponent.TEXT_ANGLE_INDICATOR.append(new java.awt.geom.Arc2D.Float(-8,-8,16,16,30,120,java.awt.geom.Arc2D.OPEN),!1),PlanComponent.TEXT_ANGLE_INDICATOR.moveTo(4,-5.2),PlanComponent.TEXT_ANGLE_INDICATOR.lineTo(6.9,-4),PlanComponent.TEXT_ANGLE_INDICATOR.lineTo(5.8,-7),PlanComponent.LABEL_CENTER_INDICATOR=new java.awt.geom.Ellipse2D.Float(-1,-1,2,2),PlanComponent.COMPASS_DISC=new java.awt.geom.Ellipse2D.Float(-.5,-.5,1,1);var o=new java.awt.BasicStroke(.01);PlanComponent.COMPASS=new java.awt.geom.GeneralPath(o.createStrokedShape(PlanComponent.COMPASS_DISC)),PlanComponent.COMPASS.append(o.createStrokedShape(new java.awt.geom.Line2D.Float(-.6,0,-.5,0)),!1),PlanComponent.COMPASS.append(o.createStrokedShape(new java.awt.geom.Line2D.Float(.6,0,.5,0)),!1),PlanComponent.COMPASS.append(o.createStrokedShape(new java.awt.geom.Line2D.Float(0,.6,0,.5)),!1),o=new java.awt.BasicStroke(.04,java.awt.BasicStroke.CAP_ROUND,java.awt.BasicStroke.JOIN_ROUND),PlanComponent.COMPASS.append(o.createStrokedShape(new java.awt.geom.Line2D.Float(0,0,0,0)),!1);var r=new java.awt.geom.GeneralPath;r.moveTo(0,-.47),r.lineTo(.15,.46),r.lineTo(0,.32),r.lineTo(-.15,.46),r.closePath(),o=new java.awt.BasicStroke(.03),PlanComponent.COMPASS.append(o.createStrokedShape(r),!1);var l=new java.awt.geom.GeneralPath;l.moveTo(-.07,-.55),l.lineTo(-.07,-.69),l.lineTo(.07,-.56),l.lineTo(.07,-.7),PlanComponent.COMPASS.append(o.createStrokedShape(l),!1),PlanComponent.COMPASS_ROTATION_INDICATOR=new java.awt.geom.GeneralPath,PlanComponent.COMPASS_ROTATION_INDICATOR.append(PlanComponent.POINT_INDICATOR,!1),PlanComponent.COMPASS_ROTATION_INDICATOR.append(new java.awt.geom.Arc2D.Float(-8,-7,16,16,210,120,java.awt.geom.Arc2D.OPEN),!1),PlanComponent.COMPASS_ROTATION_INDICATOR.moveTo(4,5.66),PlanComponent.COMPASS_ROTATION_INDICATOR.lineTo(7,5.66),PlanComponent.COMPASS_ROTATION_INDICATOR.lineTo(5.6,8.3),e=java.awt.geom.AffineTransform.getRotateInstance(Math.PI/2),PlanComponent.DIMENSION_LINE_HEIGHT_ROTATION_INDICATOR=PlanComponent.COMPASS_ROTATION_INDICATOR.createTransformedShape(e),PlanComponent.COMPASS_RESIZE_INDICATOR=new java.awt.geom.GeneralPath,PlanComponent.COMPASS_RESIZE_INDICATOR.append(new java.awt.geom.Rectangle2D.Float(-1.5,-1.5,3,3),!1),PlanComponent.COMPASS_RESIZE_INDICATOR.moveTo(4,-6),PlanComponent.COMPASS_RESIZE_INDICATOR.lineTo(6,-6),PlanComponent.COMPASS_RESIZE_INDICATOR.lineTo(6,6),PlanComponent.COMPASS_RESIZE_INDICATOR.lineTo(4,6),PlanComponent.COMPASS_RESIZE_INDICATOR.moveTo(5,0),PlanComponent.COMPASS_RESIZE_INDICATOR.lineTo(9,0),PlanComponent.COMPASS_RESIZE_INDICATOR.moveTo(9,-1.5),PlanComponent.COMPASS_RESIZE_INDICATOR.lineTo(12,0),PlanComponent.COMPASS_RESIZE_INDICATOR.lineTo(9,1.5),PlanComponent.ARROW=new java.awt.geom.GeneralPath,PlanComponent.ARROW.moveTo(-5,-2),PlanComponent.ARROW.lineTo(0,0),PlanComponent.ARROW.lineTo(-5,2),PlanComponent.ERROR_TEXTURE_IMAGE=TextureManager.getInstance().getErrorImage(),PlanComponent.WAIT_TEXTURE_IMAGE=TextureManager.getInstance().getWaitImage(),PlanComponent.WEBGL_AVAILABLE=!0;var a=document.createElement("canvas"),s=a.getContext("webgl");s||(s=a.getContext("experimental-webgl"))||(PlanComponent.WEBGL_AVAILABLE=!1),PlanComponent.LONG_TOUCH_DELAY=200,PlanComponent.LONG_TOUCH_DELAY_WHEN_DRAGGING=400,PlanComponent.LONG_TOUCH_DURATION_AFTER_DELAY=800,PlanComponent.DOUBLE_TOUCH_DELAY=500},PlanComponent.initStatics(),PlanComponent.PaintMode={},PlanComponent.PaintMode[PlanComponent.PaintMode.PAINT=0]="PAINT",PlanComponent.PaintMode[PlanComponent.PaintMode.PRINT=1]="PRINT",PlanComponent.PaintMode[PlanComponent.PaintMode.CLIPBOARD=2]="CLIPBOARD",PlanComponent.PaintMode[PlanComponent.PaintMode.EXPORT=3]="EXPORT",PlanComponent.ActionType={},PlanComponent.ActionType[PlanComponent.ActionType.DELETE_SELECTION=0]="DELETE_SELECTION",PlanComponent.ActionType[PlanComponent.ActionType.ESCAPE=1]="ESCAPE",PlanComponent.ActionType[PlanComponent.ActionType.MOVE_SELECTION_LEFT=2]="MOVE_SELECTION_LEFT",PlanComponent.ActionType[PlanComponent.ActionType.MOVE_SELECTION_UP=3]="MOVE_SELECTION_UP",PlanComponent.ActionType[PlanComponent.ActionType.MOVE_SELECTION_DOWN=4]="MOVE_SELECTION_DOWN",PlanComponent.ActionType[PlanComponent.ActionType.MOVE_SELECTION_RIGHT=5]="MOVE_SELECTION_RIGHT",PlanComponent.ActionType[PlanComponent.ActionType.MOVE_SELECTION_FAST_LEFT=6]="MOVE_SELECTION_FAST_LEFT",PlanComponent.ActionType[PlanComponent.ActionType.MOVE_SELECTION_FAST_UP=7]="MOVE_SELECTION_FAST_UP",PlanComponent.ActionType[PlanComponent.ActionType.MOVE_SELECTION_FAST_DOWN=8]="MOVE_SELECTION_FAST_DOWN",PlanComponent.ActionType[PlanComponent.ActionType.MOVE_SELECTION_FAST_RIGHT=9]="MOVE_SELECTION_FAST_RIGHT",PlanComponent.ActionType[PlanComponent.ActionType.TOGGLE_MAGNETISM_ON=10]="TOGGLE_MAGNETISM_ON",PlanComponent.ActionType[PlanComponent.ActionType.TOGGLE_MAGNETISM_OFF=11]="TOGGLE_MAGNETISM_OFF",PlanComponent.ActionType[PlanComponent.ActionType.ACTIVATE_ALIGNMENT=12]="ACTIVATE_ALIGNMENT",PlanComponent.ActionType[PlanComponent.ActionType.DEACTIVATE_ALIGNMENT=13]="DEACTIVATE_ALIGNMENT",PlanComponent.ActionType[PlanComponent.ActionType.ACTIVATE_DUPLICATION=14]="ACTIVATE_DUPLICATION",PlanComponent.ActionType[PlanComponent.ActionType.DEACTIVATE_DUPLICATION=15]="DEACTIVATE_DUPLICATION",PlanComponent.ActionType[PlanComponent.ActionType.ACTIVATE_EDITIION=16]="ACTIVATE_EDITIION",PlanComponent.ActionType[PlanComponent.ActionType.DEACTIVATE_EDITIION=17]="DEACTIVATE_EDITIION",PlanComponent.IndicatorType=function(e){this.name=e},PlanComponent.IndicatorType.prototype.name=function(){return this.name},PlanComponent.IndicatorType.prototype.toString=function(){return this.name},PlanComponent.IndicatorType.ROTATE=new PlanComponent.IndicatorType("ROTATE"),PlanComponent.IndicatorType.RESIZE=new PlanComponent.IndicatorType("RESIZE"),PlanComponent.IndicatorType.ELEVATE=new PlanComponent.IndicatorType("ELEVATE"),PlanComponent.IndicatorType.RESIZE_HEIGHT=new PlanComponent.IndicatorType("RESIZE_HEIGHT"),PlanComponent.IndicatorType.CHANGE_POWER=new PlanComponent.IndicatorType("CHANGE_POWER"),PlanComponent.IndicatorType.MOVE_TEXT=new PlanComponent.IndicatorType("MOVE_TEXT"),PlanComponent.IndicatorType.ROTATE_TEXT=new PlanComponent.IndicatorType("ROTATE_TEXT"),PlanComponent.IndicatorType.ROTATE_PITCH=new PlanComponent.IndicatorType("ROTATE_PITCH"),PlanComponent.IndicatorType.ROTATE_ROLL=new PlanComponent.IndicatorType("ROTATE_ROLL"),PlanComponent.IndicatorType.ARC_EXTENT=new PlanComponent.IndicatorType("ARC_EXTENT"),PlanComponent.prototype.getHTMLElement=function(){return this.container},PlanComponent.prototype.addModelListeners=function(e,t,i){var n=this,o=function(e){if(null==n.furnitureTopViewIconKeys||"MODEL"!=e.getPropertyName()&&"MODEL_ROTATION"!=e.getPropertyName()&&"MODEL_FLAGS"!=e.getPropertyName()&&"MODEL_TRANSFORMATIONS"!=e.getPropertyName()&&"ROLL"!=e.getPropertyName()&&"PITCH"!=e.getPropertyName()&&("WIDTH_IN_PLAN"!=e.getPropertyName()&&"DEPTH_IN_PLAN"!=e.getPropertyName()&&"HEIGHT_IN_PLAN"!=e.getPropertyName()||!e.getSource().isHorizontallyRotated()&&null==e.getSource().getTexture())&&("MODEL_MIRRORED"!=e.getPropertyName()||0==e.getSource().getRoll()))null==n.furnitureTopViewIconKeys||"PLAN_ICON"!=e.getPropertyName()&&"COLOR"!=e.getPropertyName()&&"TEXTURE"!=e.getPropertyName()&&"MODEL_MATERIALS"!=e.getPropertyName()&&"SHININESS"!=e.getPropertyName()?"ELEVATION"==e.getPropertyName()||"LEVEL"==e.getPropertyName()||"HEIGHT_IN_PLAN"==e.getPropertyName()?(n.sortedLevelFurniture=null,n.repaint()):"ICON"==e.getPropertyName()||"WALL_CUT_OUT_ON_BOTH_SIDES"==e.getPropertyName()?n.repaint():(null==n.doorOrWindowWallThicknessAreasCache||"WIDTH"!=e.getPropertyName()&&"DEPTH"!=e.getPropertyName()&&"ANGLE"!=e.getPropertyName()&&"MODEL_MIRRORED"!=e.getPropertyName()&&"X"!=e.getPropertyName()&&"Y"!=e.getPropertyName()&&"LEVEL"!=e.getPropertyName()&&"WALL_THICKNESS"!=e.getPropertyName()&&"WALL_DISTANCE"!=e.getPropertyName()&&"WALL_WIDTH"!=e.getPropertyName()&&"WALL_LEFT"!=e.getPropertyName()&&"CUT_OUT_SHAPE"!=e.getPropertyName()||CoreTools.removeFromMap(n.doorOrWindowWallThicknessAreasCache,e.getSource()),n.revalidate()):(n.removeTopViewIconFromCache(e.getSource()),n.repaint());else{if("HEIGHT_IN_PLAN"==e.getPropertyName()&&(n.sortedLevelFurniture=null),!(e.getSource()instanceof HomeFurnitureGroup))if(null!=i&&i.isModificationState()){if(null==n.invalidFurnitureTopViewIcons){n.invalidFurnitureTopViewIcons=[];var t=function(e){for(var o=0;o<n.invalidFurnitureTopViewIcons.length;o++)n.removeTopViewIconFromCache(n.invalidFurnitureTopViewIcons[o]);n.invalidFurnitureTopViewIcons=null,n.repaint(),i.removePropertyChangeListener("MODIFICATION_STATE",t)};i.addPropertyChangeListener("MODIFICATION_STATE",t)}n.invalidFurnitureTopViewIcons.indexOf(e.getSource())<0&&n.invalidFurnitureTopViewIcons.push(e.getSource())}else n.removeTopViewIconFromCache(e.getSource());n.revalidate()}};null!=e.getFurniture()&&e.getFurniture().forEach((function(e){e.addPropertyChangeListener(o),e instanceof HomeFurnitureGroup&&e.getAllFurniture().forEach((function(e){e.addPropertyChangeListener(o)}))}));var r=function(e){e.removePropertyChangeListener(o),n.removeTopViewIconFromCache(e),e instanceof HomeDoorOrWindow&&null!=n.doorOrWindowWallThicknessAreasCache&&CoreTools.removeFromMap(n.doorOrWindowWallThicknessAreasCache,e)};e.addFurnitureListener((function(e){var t=e.getItem();e.getType()===CollectionEvent.Type.ADD?(t.addPropertyChangeListener(o),t instanceof HomeFurnitureGroup&&t.getAllFurniture().forEach((function(e){e.addPropertyChangeListener(o)}))):e.getType()===CollectionEvent.Type.DELETE&&(r(t),t instanceof HomeFurnitureGroup&&t.getAllFurniture().forEach((function(e){r(e)}))),n.sortedLevelFurniture=null,n.revalidate()}));var l=function(e){var t=e.getPropertyName();"X_START"==t||"X_END"==t||"Y_START"==t||"Y_END"==t||"WALL_AT_START"==t||"WALL_AT_END"==t||"THICKNESS"==t||"ARC_EXTENT"==t||"PATTERN"==t?(n.home.isAllLevelsSelection()&&(n.otherLevelsWallAreaCache=null,n.otherLevelsWallsCache=null),n.wallAreasCache=null,n.doorOrWindowWallThicknessAreasCache=null,n.revalidate()):"LEVEL"!=t&&"HEIGHT"!=t&&"HEIGHT_AT_END"!=t||(n.otherLevelsWallAreaCache=null,n.otherLevelsWallsCache=null,n.wallAreasCache=null,n.repaint())};null!=e.getWalls()&&e.getWalls().forEach((function(e){e.addPropertyChangeListener(l)})),e.addWallsListener((function(e){e.getType()===CollectionEvent.Type.ADD?e.getItem().addPropertyChangeListener(l):e.getType()===CollectionEvent.Type.DELETE&&e.getItem().removePropertyChangeListener(l),n.otherLevelsWallAreaCache=null,n.otherLevelsWallsCache=null,n.wallAreasCache=null,n.doorOrWindowWallThicknessAreasCache=null,n.revalidate()}));var a=function(e){var t=e.getPropertyName();"POINTS"==t||"NAME"==t||"NAME_X_OFFSET"==t||"NAME_Y_OFFSET"==t||"NAME_STYLE"==t||"NAME_ANGLE"==t||"AREA_VISIBLE"==t||"AREA_X_OFFSET"==t||"AREA_Y_OFFSET"==t||"AREA_STYLE"==t||"AREA_ANGLE"==t||"FLOOR_VISIBLE"==t||"CEILING_VISIBLE"==t?(n.sortedLevelRooms=null,n.otherLevelsRoomAreaCache=null,n.otherLevelsRoomsCache=null,n.revalidate()):!n.preferences.isRoomFloorColoredOrTextured()||"FLOOR_COLOR"!=t&&"FLOOR_TEXTURE"!=t&&"FLOOR_VISIBLE"!=t||n.repaint()};null!=e.getRooms()&&e.getRooms().forEach((function(e){return e.addPropertyChangeListener(a)})),e.addRoomsListener((function(e){e.getType()===CollectionEvent.Type.ADD?e.getItem().addPropertyChangeListener(a):e.getType()===CollectionEvent.Type.DELETE&&e.getItem().removePropertyChangeListener(a),n.sortedLevelRooms=null,n.otherLevelsRoomAreaCache=null,n.otherLevelsRoomsCache=null,n.revalidate()}));var s=function(e){var t=e.getPropertyName();"COLOR"==t||"DASH_STYLE"==t?n.repaint():n.revalidate()};null!=e.getPolylines()&&e.getPolylines().forEach((function(e){return e.addPropertyChangeListener(s)})),e.addPolylinesListener((function(e){e.getType()===CollectionEvent.Type.ADD?e.getItem().addPropertyChangeListener(s):e.getType()===CollectionEvent.Type.DELETE&&e.getItem().removePropertyChangeListener(s),n.revalidate()}));var h=function(e){var t=e.getPropertyName();if("X_START"==t||"X_END"==t||"Y_START"==t||"Y_END"==t||"ELEVATION_START"==t||"ELEVATION_END"==t||"OFFSET"==t||"END_MARK_SIZE"==t||"PITCH"==t||"LENGTH_STYLE"==t)return n.revalidate();"COLOR"==t&&n.repaint()};null!=e.getDimensionLines()&&e.getDimensionLines().forEach((function(e){return e.addPropertyChangeListener(h)})),e.addDimensionLinesListener((function(e){e.getType()===CollectionEvent.Type.ADD?e.getItem().addPropertyChangeListener(h):e.getType()===CollectionEvent.Type.DELETE&&e.getItem().removePropertyChangeListener(h),n.revalidate()}));var u=function(e){return n.revalidate()};null!=e.getLabels()&&e.getLabels().forEach((function(e){return e.addPropertyChangeListener(u)})),e.addLabelsListener((function(e){e.getType()===CollectionEvent.Type.ADD?e.getItem().addPropertyChangeListener(u):e.getType()===CollectionEvent.Type.DELETE&&e.getItem().removePropertyChangeListener(u),n.revalidate()}));var d=function(e){var t=e.getPropertyName();"BACKGROUND_IMAGE"==t?(n.backgroundImageCache=null,n.revalidate()):"ELEVATION"!=t&&"ELEVATION_INDEX"!=t&&"VIEWABLE"!=t||(n.clearLevelCache(),n.repaint())};null!=e.getLevels()&&e.getLevels().forEach((function(e){return e.addPropertyChangeListener(d)})),e.addLevelsListener((function(e){var t=e.getItem();e.getType()===CollectionEvent.Type.ADD?t.addPropertyChangeListener(d):e.getType()===CollectionEvent.Type.DELETE&&t.removePropertyChangeListener(d),n.revalidate()})),e.addPropertyChangeListener("CAMERA",(function(e){return n.revalidate()})),e.getObserverCamera().addPropertyChangeListener((function(e){var t=e.getPropertyName();"X"!=t&&"Y"!=t&&"FIELD_OF_VIEW"!=t&&"YAW"!=t&&"WIDTH"!=t&&"DEPTH"!=t&&"HEIGHT"!=t||n.revalidate()})),e.getCompass().addPropertyChangeListener((function(e){var t=e.getPropertyName();"X"!=t&&"Y"!=t&&"NORTH_DIRECTION"!=t&&"DIAMETER"!=t&&"VISIBLE"!=t||n.revalidate()})),e.addSelectionListener({selectionChanged:function(e){return n.repaint()}}),e.addPropertyChangeListener("BACKGROUND_IMAGE",(function(e){n.backgroundImageCache=null,n.repaint()})),e.addPropertyChangeListener("SELECTED_LEVEL",(function(e){n.clearLevelCache(),n.repaint()})),this.preferencesListener=new PlanComponent.UserPreferencesChangeListener(this),t.addPropertyChangeListener("UNIT",this.preferencesListener),t.addPropertyChangeListener("LANGUAGE",this.preferencesListener),t.addPropertyChangeListener("GRID_VISIBLE",this.preferencesListener),t.addPropertyChangeListener("DEFAULT_FONT_NAME",this.preferencesListener),t.addPropertyChangeListener("FURNITURE_VIEWED_FROM_TOP",this.preferencesListener),t.addPropertyChangeListener("FURNITURE_MODEL_ICON_SIZE",this.preferencesListener),t.addPropertyChangeListener("ROOM_FLOOR_COLORED_OR_TEXTURED",this.preferencesListener),t.addPropertyChangeListener("WALL_PATTERN",this.preferencesListener)},PlanComponent.UserPreferencesChangeListener=function(e){this.planComponent=e},PlanComponent.UserPreferencesChangeListener.prototype.propertyChange=function(e){var t=this.planComponent,i=e.getSource(),n=e.getPropertyName();if(null==t)i.removePropertyChangeListener(n,this);else{switch(n){case"LANGUAGE":case"UNIT":null!=t.horizontalRuler&&t.horizontalRuler.repaint(),null!=t.verticalRuler&&t.verticalRuler.repaint();break;case"DEFAULT_FONT_NAME":t.fonts=null,t.fontsMetrics=null,t.revalidate();break;case"WALL_PATTERN":t.wallAreasCache=null;break;case"FURNITURE_VIEWED_FROM_TOP":null==t.furnitureTopViewIconKeys||i.isFurnitureViewedFromTop()||(t.furnitureTopViewIconKeys=null,t.furnitureTopViewIconsCache=null);break;case"FURNITURE_MODEL_ICON_SIZE":t.furnitureTopViewIconKeys=null,t.furnitureTopViewIconsCache=null}t.repaint()}},PlanComponent.prototype.removeTopViewIconFromCache=function(e){if(null!=this.furnitureTopViewIconKeys){var t=CoreTools.removeFromMap(this.furnitureTopViewIconKeys,e);if(null!=t){for(var i=CoreTools.valuesFromMap(this.furnitureTopViewIconKeys),n=!1,o=0;o<i.length;o++)i[o].hashCode===t.hashCode&&i[o].equals(t)&&(n=!0);n||CoreTools.removeFromMap(this.furnitureTopViewIconsCache,t)}}},PlanComponent.prototype.clearLevelCache=function(){this.backgroundImageCache=null,this.otherLevelsWallAreaCache=null,this.otherLevelsWallsCache=null,this.otherLevelsRoomAreaCache=null,this.otherLevelsRoomsCache=null,this.wallAreasCache=null,this.doorOrWindowWallThicknessAreasCache=null,this.sortedLevelRooms=null,this.sortedLevelFurniture=null},PlanComponent.prototype.isEnabled=function(){return!0},PlanComponent.prototype.revalidate=function(){this.invalidate(!0),this.validate(),this.repaint()},PlanComponent.prototype.invalidate=function(e){if(e){var t=this.planBoundsCacheValid;this.invalidPlanBounds||(this.invalidPlanBounds=this.getPlanBounds().getBounds2D()),t&&(this.planBoundsCacheValid=!1)}},PlanComponent.prototype.validate=function(){if(null!=this.invalidPlanBounds){var e=this.getPreferredSize();if(this.isScrolled()){this.view.style.width=e.width+"px",this.view.style.height=e.height+"px",this.canvas.width===this.scrollPane.clientWidth*this.resolutionScale&&this.canvas.height===this.scrollPane.clientHeight*this.resolutionScale||(this.canvas.width=this.scrollPane.clientWidth*this.resolutionScale,this.canvas.height=this.scrollPane.clientHeight*this.resolutionScale,this.canvas.style.width=this.scrollPane.clientWidth+"px",this.canvas.style.height=this.scrollPane.clientHeight+"px");var t=this.getPlanBounds().getMinX(),i=this.getPlanBounds().getMinY();if((t<this.invalidPlanBounds.getMinX()||i<this.invalidPlanBounds.getMinY())&&(this.scrollPane.clientWidth<this.view.clientWidth||this.scrollPane.clientHeight<this.view.clientHeight.height)){var n=this.convertLengthToPixel(this.invalidPlanBounds.getMinX()-t),o=this.convertLengthToPixel(this.invalidPlanBounds.getMinY()-i);this.scrollPane.scrollLeft+=n,this.scrollPane.scrollTop+=o}}else this.canvas.width===this.canvas.clientWidth&&this.canvas.height===this.canvas.clientHeight||(this.canvas.width=this.canvas.clientWidth,this.canvas.height=this.canvas.clientHeight)}delete this.invalidPlanBounds},PlanComponent.prototype.isScrolled=function(){return void 0!==this.scrollPane},PlanComponent.prototype.addMouseListeners=function(e){var t=this,i={initialPointerLocation:null,lastPointerLocation:null,touchEventType:!1,pointerTouches:{},lastEventType:null,lastTargetTouches:[],distanceLastPinch:null,panningAfterPinch:!1,firstTouchStartedTimeStamp:0,longTouchStartTime:0,autoScroll:null,longTouch:null,longTouchWhenDragged:!1,actionStartedInPlanComponent:!1,contextMenuEventType:!1,mousePressed:function(n){i.touchEventType||i.contextMenuEventType||!t.isEnabled()||0!==n.button||(i.updateCoordinates(n,"mousePressed"),i.autoScroll=null,i.initialPointerLocation=[n.canvasX,n.canvasY],i.lastPointerLocation=[n.canvasX,n.canvasY],i.actionStartedInPlanComponent=!0,e.pressMouse(t.convertXPixelToModel(n.canvasX),t.convertYPixelToModel(n.canvasY),n.clickCount,i.isShiftDown(n),i.isAlignmentActivated(n),i.isDuplicationActivated(n),i.isMagnetismToggled(n))),n.stopPropagation()},isShiftDown:function(e){return e.shiftKey&&!e.altKey&&!e.ctrlKey&&!e.metaKey},isAlignmentActivated:function(e){return OperatingSystem.isWindows()||OperatingSystem.isMacOSX()?e.shiftKey:e.shiftKey&&!e.altKey},isDuplicationActivated:function(e){return OperatingSystem.isMacOSX()?e.altKey:e.ctrlKey},isMagnetismToggled:function(e){return OperatingSystem.isWindows()?e.altKey:OperatingSystem.isMacOSX()?e.metaKey:e.shiftKey&&e.altKey},mouseDoubleClicked:function(e){i.updateCoordinates(e,"mouseDoubleClicked"),i.mousePressed(e)},windowMouseMoved:function(n){i.touchEventType||i.contextMenuEventType||(i.updateCoordinates(n,"mouseMoved"),null!=i.lastPointerLocation&&(null!=i.autoScroll||i.isInCanvas(n)||(i.autoScroll=setInterval((function(){if(i.actionStartedInPlanComponent){var e=document.createEvent("Event");e.initEvent("mousemove",!0,!0),e.clientX=n.clientX,e.clientY=n.clientY,window.dispatchEvent(e)}else clearInterval(i.autoScroll),i.autoScroll=null}),10)),null!=i.autoScroll&&i.isInCanvas(n)&&(clearInterval(i.autoScroll),i.autoScroll=null),i.lastPointerLocation=[n.canvasX,n.canvasY]),null==i.initialPointerLocation||i.initialPointerLocation[0]===n.canvasX&&i.initialPointerLocation[1]===n.canvasY||(i.initialPointerLocation=null),null==i.initialPointerLocation&&(0===n.buttons&&i.isInCanvas(n)||i.actionStartedInPlanComponent)&&t.isEnabled()&&e.moveMouse(t.convertXPixelToModel(n.canvasX),t.convertYPixelToModel(n.canvasY)))},windowMouseReleased:function(n){i.touchEventType||null!=i.lastPointerLocation&&(null!=i.autoScroll&&(clearInterval(i.autoScroll),i.autoScroll=null),i.actionStartedInPlanComponent&&t.isEnabled()&&0===n.button&&(i.contextMenuEventType?e.releaseMouse(t.convertXPixelToModel(i.initialPointerLocation[0]),t.convertYPixelToModel(i.initialPointerLocation[1])):(i.updateCoordinates(n,"mouseReleased"),e.releaseMouse(t.convertXPixelToModel(n.canvasX),t.convertYPixelToModel(n.canvasY)))),i.initialPointerLocation=null,i.lastPointerLocation=null,i.actionStartedInPlanComponent=!1),i.contextMenuEventType=!1},pointerPressed:function(e){"mouse"==e.pointerType?i.mousePressed(e):(i.copyPointerToTargetTouches(e,!1),i.touchStarted(e))},pointerMousePressed:function(e){e.stopPropagation()},windowPointerMoved:function(e){"mouse"==e.pointerType?i.windowMouseMoved(e):(i.copyPointerToTargetTouches(e,!1),i.touchMoved(e))},windowPointerReleased:function(e){"mouse"==e.pointerType?i.windowMouseReleased(e):(e.preventDefault(),i.copyPointerToTargetTouches(e,!0),i.touchEnded(e))},contextMenuDisplayed:function(e){i.contextMenuEventType=!0},touchStarted:function(n){if(i.touchEventType=void 0===n.pointerType,t.lastTouchEndX=void 0,t.lastTouchEndY=void 0,t.isEnabled())if(n.preventDefault(),document.activeElement!=t.container&&t.container.focus(),i.updateCoordinates(n,"touchStarted"),i.autoScroll=null,null!=i.longTouch&&(clearTimeout(i.longTouch),i.longTouch=null,t.stopLongTouchAnimation()),1===n.targetTouches.length){var o=1;if(null!=i.initialPointerLocation&&i.distance(n.canvasX,n.canvasY,i.initialPointerLocation[0],i.initialPointerLocation[1])<5&&n.timeStamp-i.firstTouchStartedTimeStamp<=PlanComponent.DOUBLE_TOUCH_DELAY?(o=2,i.firstTouchStartedTimeStamp=0,i.initialPointerLocation=null):(i.firstTouchStartedTimeStamp=n.timeStamp,i.initialPointerLocation=[n.canvasX,n.canvasY]),i.distanceLastPinch=null,i.lastPointerLocation=[n.canvasX,n.canvasY],i.actionStartedInPlanComponent=!0,i.longTouchWhenDragged=!1,e.getMode()!==PlanController.Mode.PANNING&&1==o){var r=e.getMode()===PlanController.Mode.SELECTION?"&#x21EA;":e.getMode()!==PlanController.Mode.POLYLINE_CREATION||e.isModificationState()?"2":"S";i.longTouch=setTimeout((function(){t.startLongTouchAnimation(n.canvasX,n.canvasY,r,(function(){e.getMode()===PlanController.Mode.SELECTION?e.setAlignmentActivated(!0):e.getMode()===PlanController.Mode.POLYLINE_CREATION&&e.setDuplicationActivated(!0)}))}),PlanComponent.LONG_TOUCH_DELAY),i.longTouchStartTime=Date.now()}e.pressMouse(t.convertXPixelToModel(n.canvasX),t.convertYPixelToModel(n.canvasY),o,i.isShiftDown(n),i.isAlignmentActivated(n),i.isDuplicationActivated(n),i.isMagnetismToggled(n),View.PointerType.TOUCH)}else null!=i.autoScroll&&(clearInterval(i.autoScroll),i.autoScroll=null),e.escape(),2===n.targetTouches.length&&(i.actionStartedInPlanComponent=!0,i.initialPointerLocation=null,i.distanceLastPinch=i.distance(n.targetTouches[0].clientX,n.targetTouches[0].clientY,n.targetTouches[1].clientX,n.targetTouches[1].clientY))},touchMoved:function(n){if(i.actionStartedInPlanComponent&&t.isEnabled()&&(n.preventDefault(),n.stopPropagation(),i.updateCoordinates(n,"touchMoved")))if(t.stopIndicatorAnimation(),i.initialPointerLocation=null,1==n.targetTouches.length)null!=i.lastPointerLocation&&(null!=i.autoScroll&&i.isInCanvas(n)&&(clearInterval(i.autoScroll),i.autoScroll=null),null!=i.autoScroll||i.isInCanvas(n)||e.getMode()===PlanController.Mode.PANNING||null==i.lastPointerLocation||(i.autoScroll=setInterval((function(){i.actionStartedInPlanComponent?i.touchMoved(n):(clearInterval(i.autoScroll),i.autoScroll=null)}),10))),null!=i.longTouch&&(clearTimeout(i.longTouch),i.longTouch=null,t.stopLongTouchAnimation()),i.lastPointerLocation=[n.canvasX,n.canvasY],e.moveMouse(t.convertXPixelToModel(n.canvasX),t.convertYPixelToModel(n.canvasY)),i.autoScroll||e.getMode()===PlanController.Mode.PANNING||e.getMode()===PlanController.Mode.SELECTION||(i.longTouch=setTimeout((function(){i.longTouchWhenDragged=!0,t.startLongTouchAnimation(n.canvasX,n.canvasY,"2")}),PlanComponent.LONG_TOUCH_DELAY_WHEN_DRAGGING),i.longTouchStartTime=Date.now());else if(2==n.targetTouches.length&&null!=i.distanceLastPinch){var o=i.distance(n.targetTouches[0].clientX,n.targetTouches[0].clientY,n.targetTouches[1].clientX,n.targetTouches[1].clientY),r=o/i.distanceLastPinch,l=t.canvas.getBoundingClientRect(),a=t.convertXPixelToModel((n.targetTouches[0].clientX+n.targetTouches[1].clientX)/2-l.left),s=t.convertYPixelToModel((n.targetTouches[0].clientY+n.targetTouches[1].clientY)/2-l.top),h=t.getScale();if(e.zoom(r),i.distanceLastPinch=o,t.isScrolled()&&t.getScale()!==h){t.scrollPane.scrollLeft=0,t.scrollPane.scrollTop=0;var u=(n.targetTouches[0].clientX+n.targetTouches[1].clientX)/2-l.left-t.convertXModelToPixel(a),d=(n.targetTouches[0].clientY+n.targetTouches[1].clientY)/2-l.top-t.convertYModelToPixel(s);t.moveView(-t.convertPixelToLength(u),-t.convertPixelToLength(d))}}},touchEnded:function(n){if(i.actionStartedInPlanComponent&&t.isEnabled()){if(i.updateCoordinates(n,"touchEnded"),i.panningAfterPinch&&(e.setMode(PlanController.Mode.SELECTION),i.panningAfterPinch=!1),0==n.targetTouches.length){null!=i.autoScroll&&(clearInterval(i.autoScroll),i.autoScroll=null),null!=i.longTouch&&(clearTimeout(i.longTouch),i.longTouch=null,t.stopLongTouchAnimation());var o=t.convertXPixelToModel(i.lastPointerLocation[0]),r=t.convertYPixelToModel(i.lastPointerLocation[1]);e.releaseMouse(o,r),e.getMode()!==PlanController.Mode.SELECTION&&(i.isLongTouch(!0)&&i.longTouchWhenDragged?(e.pressMouse(o,r,1,!1,!1,!1,!1,View.PointerType.TOUCH),e.releaseMouse(o,r),e.pressMouse(o,r,2,!1,!1,!1,!1,View.PointerType.TOUCH),e.releaseMouse(o,r)):i.isLongTouch()&&null!=i.initialPointerLocation&&(e.pressMouse(o,r,2,!1,!1,!1,!1,View.PointerType.TOUCH),e.releaseMouse(o,r))),i.isLongTouch()&&n.preventDefault(),t.stopIndicatorAnimation(),i.actionStartedInPlanComponent=!1}else 1==n.targetTouches.length?e.getMode()===PlanController.Mode.SELECTION&&(e.setMode(PlanController.Mode.PANNING),e.pressMouse(t.convertXPixelToModel(n.canvasX),t.convertYPixelToModel(n.canvasY),1,!1,!1,!1,!1,View.PointerType.TOUCH),i.panningAfterPinch=!0):2==n.targetTouches.length&&null!=i.distanceLastPinch&&(i.distanceLastPinch=i.distance(n.targetTouches[0].clientX,n.targetTouches[0].clientY,n.targetTouches[1].clientX,n.targetTouches[1].clientY));t.lastTouchEndX=t.lastTouchX,t.lastTouchEndY=t.lastTouchY,t.lastTouchX=void 0,t.lastTouchY=void 0}},copyPointerToTargetTouches:function(e,t){for(var n in t?(e.changedTouches=[i.pointerTouches[e.pointerId]],delete i.pointerTouches[e.pointerId]):i.pointerTouches[e.pointerId]={clientX:e.clientX,clientY:e.clientY},e.targetTouches=[],i.pointerTouches)i.pointerTouches.hasOwnProperty(n)&&e.targetTouches.push(i.pointerTouches[n])},updateCoordinates:function(e,n){t.lastTouchX=void 0,t.lastTouchY=void 0;var o=t.canvas.getBoundingClientRect(),r=!0;if(0===n.indexOf("touch")){t.pointerType=View.PointerType.TOUCH;var l,a="touchStarted"==i.lastEventType?5:1.5;if(1===e.targetTouches.length&&"touchMoved"==n&&i.distance(i.lastTargetTouches[0].clientX,i.lastTargetTouches[0].clientY,e.targetTouches[0].clientX,e.targetTouches[0].clientY)<a||0===e.targetTouches.length&&"touchEnded"==n&&i.distance(i.lastTargetTouches[0].clientX,i.lastTargetTouches[0].clientY,e.changedTouches[0].clientX,e.changedTouches[0].clientY)<a?(l=i.lastTargetTouches,r=!1):(l=0==e.targetTouches.length?e.changedTouches:e.targetTouches,i.lastEventType=n),1==l.length&&(e.canvasX=l[0].clientX-o.left,e.canvasY=l[0].clientY-o.top,t.lastTouchX=e.canvasX,t.lastTouchY=e.canvasY),e.clickCount=1,r){i.lastTargetTouches=[];for(var s=0;void 0!==l[s];s++)i.lastTargetTouches.push({clientX:l[s].clientX,clientY:l[s].clientY})}}else t.pointerType=View.PointerType.MOUSE,e.canvasX=e.clientX-o.left,e.canvasY=e.clientY-o.top;return void 0===e.clickCount&&(e.clickCount="mouseDoubleClicked"==n?2:"mousePressed"==n||"mouseReleased"==n?1:0),"mouseWheelMoved"==n&&(e.wheelRotation=(void 0!==e.deltaY?e.deltaX+e.deltaY:-e.wheelDelta)/4),r},isLongTouch:function(e){return Date.now()-i.longTouchStartTime>(e?PlanComponent.LONG_TOUCH_DELAY_WHEN_DRAGGING:PlanComponent.LONG_TOUCH_DELAY)+PlanComponent.LONG_TOUCH_DURATION_AFTER_DELAY},distance:function(e,t,i,n){return Math.sqrt(Math.pow(i-e,2)+Math.pow(n-t,2))},isInCanvas:function(e){return e.canvasX>=0&&e.canvasX<t.canvas.clientWidth&&e.canvasY>=0&&e.canvasY<t.canvas.clientHeight},mouseWheelMoved:function(n){if(n.preventDefault(),i.updateCoordinates(n,"mouseWheelMoved"),OperatingSystem.isMacOSX()?n.metaKey:n.ctrlKey){var o=t.convertXPixelToModel(n.canvasX),r=t.convertYPixelToModel(n.canvasY),l=t.getScale();if(e.zoom(n.wheelRotation<0?Math.pow(1.05,-n.wheelRotation):Math.pow(.95,n.wheelRotation)),t.isScrolled()&&t.getScale()!==l){t.scrollPane.scrollLeft=0,t.scrollPane.scrollTop=0;var a=n.canvasX-t.convertXModelToPixel(o),s=n.canvasY-t.convertYModelToPixel(r);t.moveView(-t.convertPixelToLength(a),-t.convertPixelToLength(s))}}else t.moveView(n.shiftKey?t.convertPixelToLength(n.wheelRotation):0,n.shiftKey?0:t.convertPixelToLength(n.wheelRotation))}};OperatingSystem.isInternetExplorerOrLegacyEdge()&&window.PointerEvent?(this.canvas.addEventListener("pointerdown",i.pointerPressed),this.canvas.addEventListener("mousedown",i.pointerMousePressed),this.canvas.addEventListener("dblclick",i.mouseDoubleClicked),window.addEventListener("pointermove",i.windowPointerMoved),window.addEventListener("pointerup",i.windowPointerReleased)):(this.canvas.addEventListener("touchstart",i.touchStarted),this.canvas.addEventListener("touchmove",i.touchMoved),this.canvas.addEventListener("touchend",i.touchEnded),this.canvas.addEventListener("mousedown",i.mousePressed),this.canvas.addEventListener("dblclick",i.mouseDoubleClicked),window.addEventListener("mousemove",i.windowMouseMoved),window.addEventListener("mouseup",i.windowMouseReleased)),this.canvas.addEventListener("contextmenu",i.contextMenuDisplayed),this.canvas.addEventListener("mousewheel",i.mouseWheelMoved),this.mouseListener=i},PlanComponent.prototype.startLongTouchAnimation=function(e,t,i,n){this.touchOverlay.style.visibility="visible",document.getElementById("plan-touch-overlay-timer-content").innerHTML="&#x21EA;"==i?"<span style='font-weight: bold; font-family: sans-serif; font-size: 140%; line-height: 90%'>&#x21EA;</span>":"<span style='font-weight: bold; font-family: sans-serif'>"+i+"</span>",this.touchOverlay.style.left=this.canvas.getBoundingClientRect().left+e-this.touchOverlay.clientWidth/2+"px",this.touchOverlay.style.top=this.canvas.getBoundingClientRect().top+t-this.touchOverlay.clientHeight-40+"px","visible"==this.tooltip.style.visibility&&this.tooltip.getBoundingClientRect().top<this.canvas.getBoundingClientRect().top+t&&(this.tooltip.style.marginTop=-(this.tooltip.clientHeight+70)+"px");for(var o=0;o<this.touchOverlay.children.length;o++)this.touchOverlay.children.item(o).classList.remove("indicator"),this.touchOverlay.children.item(o).classList.add("animated");void 0!==n&&(this.longTouchAnimationPostTask=setTimeout(n,PlanComponent.LONG_TOUCH_DURATION_AFTER_DELAY))},PlanComponent.prototype.startIndicatorAnimation=function(e,t,i){if("default"==i||"selection"==i)this.touchOverlay.style.visibility="hidden";else{this.touchOverlay.style.visibility="visible",document.getElementById("plan-touch-overlay-timer-content").innerHTML='<img src="'+ZIPTools.getScriptFolder()+"resources/cursors/"+i+'32x32.png"/>',this.touchOverlay.style.left=this.canvas.getBoundingClientRect().left+e-this.touchOverlay.clientWidth/2+"px",this.touchOverlay.style.top=this.canvas.getBoundingClientRect().top+t-this.touchOverlay.clientHeight-40+"px","visible"==this.tooltip.style.visibility&&this.tooltip.getBoundingClientRect().top<this.canvas.getBoundingClientRect().top+t&&(this.tooltip.style.marginTop=-(this.tooltip.clientHeight+70)+"px");for(var n=0;n<this.touchOverlay.children.length;n++)this.touchOverlay.children.item(n).classList.remove("animated"),this.touchOverlay.children.item(n).classList.add("indicator")}},PlanComponent.prototype.stopLongTouchAnimation=function(e,t){this.touchOverlay.style.visibility="hidden";for(var i=0;i<this.touchOverlay.children.length;i++)this.touchOverlay.children.item(i).classList.remove("animated"),this.touchOverlay.children.item(i).classList.remove("indicator");void 0!==this.longTouchAnimationPostTask&&(clearTimeout(this.longTouchAnimationPostTask),delete this.longTouchAnimationPostTask)},PlanComponent.prototype.stopIndicatorAnimation=function(){this.touchOverlay.style.visibility="hidden";for(var e=0;e<this.touchOverlay.children.length;e++)this.touchOverlay.children.item(e).classList.remove("animated"),this.touchOverlay.children.item(e).classList.remove("indicator")},PlanComponent.prototype.addFocusListener=function(e){var t=this;this.focusOutListener=function(){t.pointerType===View.PointerType.TOUCH&&t.lastTouchEndX&&t.lastTouchEndY&&e.isModificationState()&&(e.getMode()===PlanController.Mode.WALL_CREATION||e.getMode()===PlanController.Mode.ROOM_CREATION||e.getMode()===PlanController.Mode.POLYLINE_CREATION||e.getMode()===PlanController.Mode.DIMENSION_LINE_CREATION)&&(e.pressMouse(t.convertXPixelToModel(t.lastTouchEndX),t.convertYPixelToModel(t.lastTouchEndY),1,!1,!1,!1,!1,View.PointerType.TOUCH),e.releaseMouse(t.convertXPixelToModel(t.lastTouchEndX),t.convertYPixelToModel(t.lastTouchEndY))),t.mouseListener.lastPointerLocation=null,t.mouseListener.actionStartedInPlanComponent=!1,e.escape()},this.container.addEventListener("focusout",this.focusOutListener)},PlanComponent.prototype.addControllerListener=function(e){var t=this;e.addPropertyChangeListener("BASE_PLAN_MODIFICATION_STATE",(function(i){var n=e.isBasePlanModificationState();if(n&&e.getMode()!==PlanController.Mode.WALL_CREATION)for(var o=null!=t.draggedItemsFeedback?t.draggedItemsFeedback:t.home.getSelectedItems(),r=0;r<o.length;r++){var l=o[r];l instanceof Wall||l instanceof HomePieceOfFurniture&&l.isDoorOrWindow()||(n=!1)}t.wallsDoorsOrWindowsModification!==n&&(t.wallsDoorsOrWindowsModification=n,t.repaint())}))},PlanComponent.prototype.installDefaultKeyboardActions=function(){var e=this;this.inputMap={"pressed DELETE":"DELETE_SELECTION","pressed BACK_SPACE":"DELETE_SELECTION","pressed ESCAPE":"ESCAPE","shift pressed ESCAPE":"ESCAPE","pressed LEFT":"MOVE_SELECTION_LEFT","shift pressed LEFT":"MOVE_SELECTION_FAST_LEFT","pressed UP":"MOVE_SELECTION_UP","shift pressed UP":"MOVE_SELECTION_FAST_UP","pressed DOWN":"MOVE_SELECTION_DOWN","shift pressed DOWN":"MOVE_SELECTION_FAST_DOWN","pressed RIGHT":"MOVE_SELECTION_RIGHT","shift pressed RIGHT":"MOVE_SELECTION_FAST_RIGHT","pressed ENTER":"ACTIVATE_EDITIION","shift pressed ENTER":"ACTIVATE_EDITIION"},OperatingSystem.isMacOSX()?CoreTools.merge(this.inputMap,{"alt pressed ALT":"ACTIVATE_DUPLICATION","released ALT":"DEACTIVATE_DUPLICATION","shift alt pressed ALT":"ACTIVATE_DUPLICATION","shift released ALT":"DEACTIVATE_DUPLICATION","meta alt pressed ALT":"ACTIVATE_DUPLICATION","meta released ALT":"DEACTIVATE_DUPLICATION","shift meta alt pressed ALT":"ACTIVATE_DUPLICATION","shift meta released ALT":"DEACTIVATE_DUPLICATION","alt pressed ESCAPE":"ESCAPE","alt pressed ENTER":"ACTIVATE_EDITIION"}):CoreTools.merge(this.inputMap,{"control pressed CONTROL":"ACTIVATE_DUPLICATION","released CONTROL":"DEACTIVATE_DUPLICATION","shift control pressed CONTROL":"ACTIVATE_DUPLICATION","shift released CONTROL":"DEACTIVATE_DUPLICATION","meta control pressed CONTROL":"ACTIVATE_DUPLICATION","meta released CONTROL":"DEACTIVATE_DUPLICATION","shift meta control pressed CONTROL":"ACTIVATE_DUPLICATION","shift meta released CONTROL":"DEACTIVATE_DUPLICATION","control pressed ESCAPE":"ESCAPE","control pressed ENTER":"ACTIVATE_EDITIION"}),OperatingSystem.isWindows()?CoreTools.merge(this.inputMap,{"alt pressed ALT":"TOGGLE_MAGNETISM_ON","released ALT":"TOGGLE_MAGNETISM_OFF","shift alt pressed ALT":"TOGGLE_MAGNETISM_ON","shift released ALT":"TOGGLE_MAGNETISM_OFF","control alt pressed ALT":"TOGGLE_MAGNETISM_ON","control released ALT":"TOGGLE_MAGNETISM_OFF","shift control alt pressed ALT":"TOGGLE_MAGNETISM_ON","shift control released ALT":"TOGGLE_MAGNETISM_OFF","alt pressed ESCAPE":"ESCAPE","alt pressed ENTER":"ACTIVATE_EDITIION"}):OperatingSystem.isMacOSX()?CoreTools.merge(this.inputMap,{"meta pressed META":"TOGGLE_MAGNETISM_ON","released META":"TOGGLE_MAGNETISM_OFF","shift meta pressed META":"TOGGLE_MAGNETISM_ON","shift released META":"TOGGLE_MAGNETISM_OFF","alt meta pressed META":"TOGGLE_MAGNETISM_ON","alt released META":"TOGGLE_MAGNETISM_OFF","shift alt meta pressed META":"TOGGLE_MAGNETISM_ON","shift alt released META":"TOGGLE_MAGNETISM_OFF","meta pressed ESCAPE":"ESCAPE","meta pressed ENTER":"ACTIVATE_EDITIION"}):CoreTools.merge(this.inputMap,{"shift alt pressed ALT":"TOGGLE_MAGNETISM_ON","alt shift pressed SHIFT":"TOGGLE_MAGNETISM_ON","alt released SHIFT":"TOGGLE_MAGNETISM_OFF","shift released ALT":"TOGGLE_MAGNETISM_OFF","control shift alt pressed ALT":"TOGGLE_MAGNETISM_ON","control alt shift pressed SHIFT":"TOGGLE_MAGNETISM_ON","control alt released SHIFT":"TOGGLE_MAGNETISM_OFF","control shift released ALT":"TOGGLE_MAGNETISM_OFF","alt shift pressed ESCAPE":"ESCAPE","alt shift  pressed ENTER":"ACTIVATE_EDITIION","control alt shift pressed ESCAPE":"ESCAPE","control alt shift pressed ENTER":"ACTIVATE_EDITIION"}),CoreTools.merge(this.inputMap,{"shift pressed SHIFT":"ACTIVATE_ALIGNMENT","released SHIFT":"DEACTIVATE_ALIGNMENT"}),OperatingSystem.isWindows()?CoreTools.merge(this.inputMap,{"control shift pressed SHIFT":"ACTIVATE_ALIGNMENT","control released SHIFT":"DEACTIVATE_ALIGNMENT","alt shift pressed SHIFT":"ACTIVATE_ALIGNMENT","alt released SHIFT":"DEACTIVATE_ALIGNMENT"}):OperatingSystem.isMacOSX()?CoreTools.merge(this.inputMap,{"alt shift pressed SHIFT":"ACTIVATE_ALIGNMENT","alt released SHIFT":"DEACTIVATE_ALIGNMENT","meta shift pressed SHIFT":"ACTIVATE_ALIGNMENT","meta released SHIFT":"DEACTIVATE_ALIGNMENT"}):CoreTools.merge(this.inputMap,{"control shift pressed SHIFT":"ACTIVATE_ALIGNMENT","control released SHIFT":"DEACTIVATE_ALIGNMENT","shift released ALT":"ACTIVATE_ALIGNMENT","control shift released ALT":"ACTIVATE_ALIGNMENT"}),this.keyDownListener=function(t){return e.callAction(t,"keydown")},this.container.addEventListener("keydown",this.keyDownListener,!1),this.keyUpListener=function(t){return e.callAction(t,"keyup")},this.container.addEventListener("keyup",this.keyUpListener,!1)},PlanComponent.prototype.callAction=function(e,t){var i=KeyStroke.getKeyStrokeForEvent(e,t);if(void 0!==i){var n=this.inputMap[i];if(void 0!==n){var o=this.actionMap[n];void 0!==o&&o.actionPerformed(e),e.stopPropagation()}}},PlanComponent.prototype.installEditionKeyboardActions=function(){this.inputMap={ESCAPE:"ESCAPE","shift ESCAPE":"ESCAPE",ENTER:"DEACTIVATE_EDITIION","shift ENTER":"DEACTIVATE_EDITIION"},OperatingSystem.isMacOSX()?CoreTools.merge(this.inputMap,{"alt ESCAPE":"ESCAPE","alt ENTER":"DEACTIVATE_EDITIION","alt shift ENTER":"DEACTIVATE_EDITIION","alt pressed ALT":"ACTIVATE_DUPLICATION","released ALT":"DEACTIVATE_DUPLICATION","shift alt pressed ALT":"ACTIVATE_DUPLICATION","shift released ALT":"DEACTIVATE_DUPLICATION"}):CoreTools.merge(this.inputMap,{"control ESCAPE":"ESCAPE","control ENTER":"DEACTIVATE_EDITIION","control shift ENTER":"DEACTIVATE_EDITIION","control pressed CONTROL":"ACTIVATE_DUPLICATION","released CONTROL":"DEACTIVATE_DUPLICATION","shift control pressed CONTROL":"ACTIVATE_DUPLICATION","shift released CONTROL":"DEACTIVATE_DUPLICATION"})},PlanComponent.prototype.createActions=function(e){var t=this;function i(e,t){this.dx=e,this.dy=t}function n(e){this.toggle=e}function o(e){this.alignmentActivated=e}function r(e){this.duplicationActivated=e}function l(e){this.editionActivated=e}i.prototype.actionPerformed=function(i){e.moveSelection(this.dx/t.getScale(),this.dy/t.getScale())},n.prototype.actionPerformed=function(t){e.toggleMagnetism(this.toggle)},o.prototype.actionPerformed=function(t){e.setAlignmentActivated(this.alignmentActivated)},r.prototype.actionPerformed=function(t){e.setDuplicationActivated(this.duplicationActivated)},l.prototype.actionPerformed=function(t){e.setEditionActivated(this.editionActivated)},this.actionMap={DELETE_SELECTION:{actionPerformed:function(){e.deleteSelection()}},ESCAPE:{actionPerformed:function(){e.escape()}},MOVE_SELECTION_LEFT:new i(-1,0),MOVE_SELECTION_FAST_LEFT:new i(-10,0),MOVE_SELECTION_UP:new i(0,-1),MOVE_SELECTION_FAST_UP:new i(0,-10),MOVE_SELECTION_DOWN:new i(0,1),MOVE_SELECTION_FAST_DOWN:new i(0,10),MOVE_SELECTION_RIGHT:new i(1,0),MOVE_SELECTION_FAST_RIGHT:new i(10,0),TOGGLE_MAGNETISM_ON:new n(!0),TOGGLE_MAGNETISM_OFF:new n(!1),ACTIVATE_ALIGNMENT:new o(!0),DEACTIVATE_ALIGNMENT:new o(!1),ACTIVATE_DUPLICATION:new r(!0),DEACTIVATE_DUPLICATION:new r(!1),ACTIVATE_EDITIION:new l(!0),DEACTIVATE_EDITIION:new l(!1)}},PlanComponent.createCustomCursor=function(e,t){return OperatingSystem.isInternetExplorer()?t:'url("'+ZIPTools.getScriptFolder()+"/resources/cursors/"+e+"16x16"+(OperatingSystem.isMacOSX()?"-macosx":"")+'.png") 8 8, '+t},PlanComponent.prototype.getPreferredSize=function(){var e=this.getInsets(),t=this.getPlanBounds();return{width:this.convertLengthToPixel(t.getWidth()+2*PlanComponent.MARGIN)+e.left+e.right,height:this.convertLengthToPixel(t.getHeight()+2*PlanComponent.MARGIN)+e.top+e.bottom}},PlanComponent.prototype.getInsets=function(){return{top:0,bottom:0,left:0,right:0}},PlanComponent.prototype.getWidth=function(){return this.view.clientWidth},PlanComponent.prototype.getHeight=function(){return this.view.clientHeight},PlanComponent.prototype.getPlanBounds=function(){var e=this;if(!this.planBoundsCacheValid){if(null==this.planBoundsCache&&(this.planBoundsCache=new java.awt.geom.Rectangle2D.Float(0,0,1e3,1e3)),null!=this.backgroundImageCache){var t=this.home.getBackgroundImage();null!=t&&(this.planBoundsCache.add(-t.getXOrigin(),-t.getYOrigin()),this.planBoundsCache.add(this.backgroundImageCache.width*t.getScale()-t.getXOrigin(),this.backgroundImageCache.height*t.getScale()-t.getYOrigin())),this.home.getLevels().forEach((function(t){var i=t.getBackgroundImage();null!=i&&(e.planBoundsCache.add(-i.getXOrigin(),-i.getYOrigin()),e.planBoundsCache.add(e.backgroundImageCache.width*i.getScale()-i.getXOrigin(),e.backgroundImageCache.height*i.getScale()-i.getYOrigin()))}))}var i=this.getGraphics();null!=i&&this.setRenderingHints(i);var n=this.getItemsBounds(i,this.getPaintedItems());null!=n&&this.planBoundsCache.add(n),this.home.getObserverCamera().getPoints().forEach((function(t){return e.planBoundsCache.add(t[0],t[1])})),this.planBoundsCacheValid=!0}return this.planBoundsCache},PlanComponent.prototype.getPaintedItems=function(){return this.home.getSelectableViewableItems()},PlanComponent.prototype.getItemsBounds=function(e,t){for(var i=null,n=0;n<t.length;n++){var o=t[n],r=this.getItemBounds(e,o);null==i?i=r:i.add(r)}return i},PlanComponent.prototype.getItemBounds=function(e,t){for(var i,n=this,o=t.getPoints(),r=new java.awt.geom.Rectangle2D.Float(o[0][0],o[0][1],0,0),l=1;l<o.length;l++)r.add(o[l][0],o[l][1]);if(i=null!=e?e.getFont():this.getFont(),t instanceof Room){var a=t,s=a.getXCenter(),h=a.getYCenter(),u=a.getName();if(null!=u&&u.length>0&&this.addTextBounds(a.constructor,u,a.getNameStyle(),s+a.getNameXOffset(),h+a.getNameYOffset(),a.getNameAngle(),r),a.isAreaVisible()){var d=a.getArea();if(d>.01){var c=this.preferences.getLengthUnit().getAreaFormatWithUnit().format(d);this.addTextBounds(a.constructor,c,a.getAreaStyle(),s+a.getAreaXOffset(),h+a.getAreaYOffset(),a.getAreaAngle(),r)}}}else{if(t instanceof Polyline){var p=t;return ShapeTools.getPolylineShape(p.getPoints(),p.getJoinStyle()===Polyline.JoinStyle.CURVED,p.isClosedPath()).getBounds2D()}if(t instanceof HomePieceOfFurniture){if(null!=t&&t instanceof HomeDoorOrWindow){var g=t;g.getSashes().forEach((function(e){r.add(n.getDoorOrWindowSashShape(g,e).getBounds2D())}))}else t instanceof HomeFurnitureGroup&&r.add(this.getItemsBounds(e,t.getFurniture()));var m=t,f=m.getName();m.isVisible()&&m.isNameVisible()&&f.length>0&&this.addTextBounds(m.constructor,f,m.getNameStyle(),m.getX()+m.getNameXOffset(),m.getY()+m.getNameYOffset(),m.getNameAngle(),r)}else if(t instanceof DimensionLine){var v=t,_=v.getLength(),S=this.preferences.getLengthUnit().getFormat().format(_),y=v.getLengthStyle();null==y&&(y=this.preferences.getDefaultTextStyle(v.constructor));var E=java.awt.geom.AffineTransform.getTranslateInstance(v.getXStart(),v.getYStart()),C=v.isElevationDimensionLine()?(v.getPitch()+2*Math.PI)%(2*Math.PI):Math.atan2(v.getYEnd()-v.getYStart(),v.getXEnd()-v.getXStart());if(v.getElevationStart()==v.getElevationEnd()){var P=this.getFontMetrics(i,y),w=P.getStringBounds(S);E.rotate(C),E.translate(0,v.getOffset()),E.translate((_-w.getWidth())/2,v.getOffset()<=0?-P.getDescent()-1:P.getAscent()+1);for(var L=new java.awt.geom.GeneralPath(w).getPathIterator(E);!L.isDone();L.next()){var T=[0,0];L.currentSegment(T)!==java.awt.geom.PathIterator.SEG_CLOSE&&r.add(T[0],T[1])}}E.setToTranslation(v.getXStart(),v.getYStart()),E.rotate(C),E.translate(0,v.getOffset());for(L=PlanComponent.DIMENSION_LINE_MARK_END.getPathIterator(E);!L.isDone();L.next()){T=[0,0];L.currentSegment(T)!==java.awt.geom.PathIterator.SEG_CLOSE&&r.add(T[0],T[1])}E.translate(_,0);for(L=PlanComponent.DIMENSION_LINE_MARK_END.getPathIterator(E);!L.isDone();L.next()){T=[0,0];L.currentSegment(T)!==java.awt.geom.PathIterator.SEG_CLOSE&&r.add(T[0],T[1])}}else if(t instanceof Label){var A=t;this.addTextBounds(A.constructor,A.getText(),A.getStyle(),A.getX(),A.getY(),A.getAngle(),r)}else if(t instanceof Compass){var I=t;return(E=java.awt.geom.AffineTransform.getTranslateInstance(I.getX(),I.getY())).scale(I.getDiameter(),I.getDiameter()),E.rotate(I.getNorthDirection()),PlanComponent.COMPASS.createTransformedShape(E).getBounds2D()}}return r},PlanComponent.prototype.addTextBounds=function(e,t,i,n,o,r,l){null==i&&(i=this.preferences.getDefaultTextStyle(e)),this.getTextBounds(t,i,n,o,r).forEach((function(e){return l.add(e[0],e[1])}))},PlanComponent.prototype.getTextBounds=function(e,t,i,n,o){var r=this.getFontMetrics(this.getFont(),t),l=null,a=e.replace(/\n*$/,"").split("\n"),s=this.getGraphics();null!=s&&this.setRenderingHints(s);for(var h=0;h<a.length;h++){var u=r.getStringBounds(a[h]);(null==l||l.getWidth()<u.getWidth())&&(l=u)}var d,c=l.getWidth();if(d=t.getAlignment()===TextStyle.Alignment.LEFT?0:t.getAlignment()===TextStyle.Alignment.RIGHT?-c:-c/2,0===o){var p=n+l.getY(),g=p+l.getHeight();return[[i+d,p-=l.getHeight()*(a.length-1)],[i+d+c,p],[i+d+c,g],[i+d,g]]}l.add(l.getX(),l.getY()-l.getHeight()*(a.length-1));var m=new java.awt.geom.AffineTransform;m.translate(i,n),m.rotate(o),m.translate(d,0);for(var f=[],v=new java.awt.geom.GeneralPath(l).getPathIterator(m);!v.isDone();v.next()){var _=[0,0];v.currentSegment(_)!==java.awt.geom.PathIterator.SEG_CLOSE&&f.push(_)}return f.slice(0)},PlanComponent.prototype.getFont=function(e,t){if(null==e&&null==t)return this.font;null==this.fonts&&(this.fonts={});var i=CoreTools.getFromMap(this.fonts,t);if(null==i){var n="normal",o="normal";if(t.isBold()&&(o="bold"),t.isItalic()&&(n="italic"),null==e||null!=this.preferences.getDefaultFontName()||null!=t.getFontName()){var r=t.getFontName();null==r&&(r=this.preferences.getDefaultFontName()),null==r&&(r=new Font(this.font).family),e=new Font({style:n,weight:o,size:"10px",family:r}).toString()}i=new Font({style:n,weight:o,size:t.getFontSize()+"px",family:new Font(e).family}).toString(),CoreTools.putToMap(this.fonts,t,i)}return i},PlanComponent.prototype.setFont=function(e){this.font=e},PlanComponent.prototype.getFontMetrics=function(e,t){if(null==t)return new FontMetrics(e);null==this.fontsMetrics&&(this.fontsMetrics={});var i=CoreTools.getFromMap(this.fontsMetrics,t);return null==i&&(i=this.getFontMetrics(this.getFont(e,t)),CoreTools.putToMap(this.fontsMetrics,t,i)),i},PlanComponent.prototype.setBackgroundPainted=function(e){this.backgroundPainted!==e&&(this.backgroundPainted=e,this.repaint())},PlanComponent.prototype.isBackgroundPainted=function(){return this.backgroundPainted},PlanComponent.prototype.setSelectedItemsOutlinePainted=function(e){this.selectedItemsOutlinePainted!==e&&(this.selectedItemsOutlinePainted=e,this.repaint())},PlanComponent.prototype.isSelectedItemsOutlinePainted=function(){return this.selectedItemsOutlinePainted},PlanComponent.prototype.repaint=function(){var e=this;this.canvasNeededRepaint||(this.canvasNeededRepaint=!0,requestAnimationFrame((function(){e.canvasNeededRepaint&&(e.canvasNeededRepaint=!1,e.paintComponent(e.getGraphics()))})))},PlanComponent.prototype.getGraphics=function(){return this.graphics||(this.graphics=new Graphics2D(this.canvas)),this.graphics},PlanComponent.prototype.paintComponent=function(e){e.setTransform(new java.awt.geom.AffineTransform),e.clear(),this.backgroundPainted&&this.paintBackground(e,this.getBackgroundColor(PlanComponent.PaintMode.PAINT));var t=this.getInsets(),i=this.getPlanBounds(),n=this.getScale()*this.resolutionScale;this.isScrolled()&&e.translate(-this.scrollPane.scrollLeft*this.resolutionScale,-this.scrollPane.scrollTop*this.resolutionScale),e.translate(t.left*this.resolutionScale+(PlanComponent.MARGIN-i.getMinX())*n,t.top*this.resolutionScale+(PlanComponent.MARGIN-i.getMinY())*n),e.scale(n,n),this.setRenderingHints(e),this.drawPlanBounds&&(e.setColor("#FF0000"),e.draw(i)),this.paintContent(e,this.home.getSelectedLevel(),this.getScale(),PlanComponent.PaintMode.PAINT),e.dispose()},PlanComponent.prototype.getPrintPreferredScale=function(e,t){return 1},PlanComponent.prototype.getStrokeWidth=function(e,t){var i;return i=Wall===e||Room===e?PlanComponent.WALL_STROKE_WIDTH:PlanComponent.BORDER_STROKE_WIDTH,t===PlanComponent.PaintMode.PRINT&&(i*=.5),i},PlanComponent.prototype.createTransferData=function(e){return e===TransferableView.DataType.PLAN_IMAGE?this.getClipboardImage():null},PlanComponent.prototype.getClipboardImage=function(){throw new UnsupportedOperationException("Not implemented")},PlanComponent.prototype.isFormatTypeSupported=function(e){return!1},PlanComponent.prototype.exportData=function(e,t,i){throw new UnsupportedOperationException("Unsupported format "+t)},PlanComponent.prototype.setRenderingHints=function(e){},PlanComponent.prototype.paintBackground=function(e,t){this.isOpaque()&&(e.setColor(t),e.fillRect(0,0,this.canvas.width,this.canvas.height))},PlanComponent.prototype.isOpaque=function(){return!0===this.opaque},PlanComponent.prototype.setOpaque=function(e){this.opaque=e},PlanComponent.prototype.paintBackgroundImage=function(e,t,i){this.home.getSelectedLevel();var n=null;if(null!=t)for(var o=this.home.getLevels(),r=o.length-1;r>=0;r--){var l=o[r];if(l.getElevation()===t.getElevation()&&l.getElevationIndex()<=t.getElevationIndex()&&l.isViewable()&&null!=l.getBackgroundImage()&&l.getBackgroundImage().isVisible()){n=l;break}}var a=null==n?this.home.getBackgroundImage():n.getBackgroundImage();if(null!=a&&a.isVisible()){var s=e.getTransform();e.translate(-a.getXOrigin(),-a.getYOrigin());var h=a.getScale();e.scale(h,h);var u=this.setTransparency(e,.7);return e.drawImage(null!=this.backgroundImageCache?this.backgroundImageCache:this.readBackgroundImage(a.getImage()),0,0),e.setAlpha(u),e.setTransform(s),!0}return!1},PlanComponent.prototype.getForegroundColor=function(e){return e===PlanComponent.PaintMode.PAINT?this.getForeground():"#000000"},PlanComponent.prototype.getForeground=function(){return null==this.foreground&&(this.foreground=ColorTools.styleToHexadecimalString(this.canvas.style.color)),this.foreground},PlanComponent.prototype.getBackgroundColor=function(e){return e===PlanComponent.PaintMode.PAINT?this.getBackground():"#FFFFFF"},PlanComponent.prototype.getBackground=function(){return null==this.background&&(this.background=ColorTools.styleToHexadecimalString(this.canvas.style.backgroundColor)),this.background},PlanComponent.prototype.readBackgroundImage=function(e){var t=this;return this.backgroundImageCache!=PlanComponent.WAIT_TEXTURE_IMAGE&&this.backgroundImageCache!=PlanComponent.ERROR_TEXTURE_IMAGE&&(this.backgroundImageCache=PlanComponent.WAIT_TEXTURE_IMAGE,TextureManager.getInstance().loadTexture(e,{textureUpdated:function(e){t.backgroundImageCache=e,t.repaint()},textureError:function(){t.backgroundImageCache=PlanComponent.ERROR_TEXTURE_IMAGE,t.repaint()}})),this.backgroundImageCache},PlanComponent.prototype.paintOtherLevels=function(e,t,i,n,o){var r=this,l=this.home.getLevels();if(l.length&&null!=t){var a=l[0].getElevation()===t.getElevation(),s=null;if(null==this.otherLevelsRoomsCache||null==this.otherLevelsWallsCache){var h=l.indexOf(t);if(s=[],a){for(var u=h;++u<l.length&&l[u].getElevation()===t.getElevation(););if(u<l.length){var d=l[u],c=d.getElevation();do{d.isViewable()&&s.push(d)}while(++u<l.length&&(d=l[u]).getElevation()===c)}}else{for(var p=h;--p>=0&&l[p].getElevation()===t.getElevation(););if(p>=0){var g=l[p],m=g.getElevation();do{g.isViewable()&&s.push(g)}while(--p>=0&&(g=l[p]).getElevation()===m)}}if(null==this.otherLevelsRoomsCache){if(0!==s.length){var f=[];this.home.getRooms().forEach((function(e){s.forEach((function(t){e.getLevel()===t&&(a&&e.isFloorVisible()||!a&&e.isCeilingVisible())&&f.push(e)}))})),f.length>0&&(this.otherLevelsRoomAreaCache=this.getItemsArea(f),this.otherLevelsRoomsCache=f)}null==this.otherLevelsRoomsCache&&(this.otherLevelsRoomsCache=[])}if(null==this.otherLevelsWallsCache&&0!==s.length){var v=[];this.home.getWalls().forEach((function(e){r.isViewableAtLevel(e,t)||s.forEach((function(t){e.getLevel()===t&&v.push(e)}))})),v.length>0&&(this.otherLevelsWallAreaCache=this.getItemsArea(v),this.otherLevelsWallsCache=v)}null==this.otherLevelsWallsCache&&(this.otherLevelsWallsCache=[])}if(0!==this.otherLevelsRoomsCache.length){var _=this.setTransparency(e,this.preferences.isGridVisible()?.2:.1);e.setPaint("#808080"),e.fill(this.otherLevelsRoomAreaCache),e.setAlpha(_)}if(0!==this.otherLevelsWallsCache.length){_=this.setTransparency(e,this.preferences.isGridVisible()?.2:.1);this.fillAndDrawWallsArea(e,this.otherLevelsWallAreaCache,i,this.getWallPaint(e,i,n,o,this.preferences.getNewWallPattern()),o,PlanComponent.PaintMode.PAINT),e.setAlpha(_)}}},PlanComponent.prototype.setTransparency=function(e,t){var i=e.getAlpha();return e.setAlpha(t),i},PlanComponent.prototype.paintGrid=function(e,t){var i=this.getGridSize(t),n=this.getMainGridSize(t),o=this.getPlanBounds(),r=o.getMinX()-PlanComponent.MARGIN,l=o.getMinY()-PlanComponent.MARGIN,a=this.convertXPixelToModel(Math.max(this.getWidth(),this.canvas.clientWidth)),s=this.convertYPixelToModel(Math.max(this.getHeight(),this.canvas.clientHeight));this.paintGridLines(e,t,r,a,l,s,i,n)},PlanComponent.prototype.paintGridLines=function(e,t,i,n,o,r,l,a){e.setColor(this.getGridColor()),e.setStroke(new java.awt.BasicStroke(.5/t));for(var s=(i/l|0)*l;s<n;s+=l)e.draw(new java.awt.geom.Line2D.Double(s,o,s,r));for(var h=(o/l|0)*l;h<r;h+=l)e.draw(new java.awt.geom.Line2D.Double(i,h,n,h));if(a!==l){e.setStroke(new java.awt.BasicStroke(1.5/t,java.awt.BasicStroke.CAP_BUTT,java.awt.BasicStroke.JOIN_BEVEL));for(s=(i/a|0)*a;s<n;s+=a)e.draw(new java.awt.geom.Line2D.Double(s,o,s,r));for(h=(o/a|0)*a;h<r;h+=a)e.draw(new java.awt.geom.Line2D.Double(i,h,n,h))}},PlanComponent.prototype.getGridColor=function(){if(null==this.gridColor){var e=ColorTools.styleToInteger(this.canvas.style.backgroundColor),t=ColorTools.styleToInteger(this.canvas.style.color),i=255&(((255&e)+(255&t)+(65280&e)+(65280&t)+(16711680&e)+(16711680&t))/6|0);this.gridColor=ColorTools.integerToHexadecimalString(i+(i<<8)+(i<<16))}return this.gridColor},PlanComponent.prototype.getMainGridSize=function(e){var t;if(this.preferences.getLengthUnit().isMetric())t=[100,200,500,1e3,2e3,5e3,1e4];else{var i=30.48;t=[i,3*i,6*i,12*i,24*i,48*i,96*i,192*i,384*i]}for(var n=t[0],o=1;o<t.length&&n*e<50;o++)n=t[o];return n},PlanComponent.prototype.getGridSize=function(e){var t;if(this.preferences.getLengthUnit().isMetric())t=[1,2,5,10,20,50,100,200,500,1e3,2e3,5e3,1e4];else{var i=30.48;t=[2.54,5.08,7.62,15.24,i,3*i,6*i,12*i,24*i,48*i,96*i,192*i,384*i]}for(var n=t[0],o=1;o<t.length&&n*e<10;o++)n=t[o];return n},PlanComponent.prototype.paintContent=function(e,t,i,n){var o=this.getBackgroundColor(n),r=this.getForegroundColor(n);if(this.backgroundPainted&&(this.paintBackgroundImage(e,t,n),n===PlanComponent.PaintMode.PAINT&&(this.paintOtherLevels(e,t,i,o,r),this.preferences.isGridVisible()&&this.paintGrid(e,i))),t==this.home.getSelectedLevel()?this.paintHomeItems(e,i,o,r,n):this.paintHomeItems(e,t,i,o,r,n),n===PlanComponent.PaintMode.PAINT){var l=this.home.getSelectedItems(),a=this.getSelectionColor(),s=this.getFurnitureOutlineColor(),h=ColorTools.toRGBAStyle(a,.5),u=new java.awt.BasicStroke(6/i,java.awt.BasicStroke.CAP_ROUND,java.awt.BasicStroke.JOIN_ROUND),d=new java.awt.BasicStroke(4/i,java.awt.BasicStroke.CAP_ROUND,java.awt.BasicStroke.JOIN_ROUND),c=new java.awt.BasicStroke(1/i,java.awt.BasicStroke.CAP_SQUARE,java.awt.BasicStroke.JOIN_BEVEL,0,[20/i,5/i,5/i,5/i],4/i);if(this.paintCamera(e,l,h,u,a,i,o,r),null!=this.alignedObjectClass&&(Wall===this.alignedObjectClass?this.paintWallAlignmentFeedback(e,this.alignedObjectFeedback,t,this.locationFeeback,this.showPointFeedback,a,c,i,h,u):Room===this.alignedObjectClass?this.paintRoomAlignmentFeedback(e,this.alignedObjectFeedback,t,this.locationFeeback,this.showPointFeedback,a,c,i,h,u):Polyline===this.alignedObjectClass?this.showPointFeedback&&this.paintPointFeedback(e,this.locationFeeback,a,i,h,u):DimensionLine===this.alignedObjectClass&&this.paintDimensionLineAlignmentFeedback(e,this.alignedObjectFeedback,t,this.locationFeeback,this.showPointFeedback,a,c,i,h,u)),null!=this.centerAngleFeedback&&this.paintAngleFeedback(e,this.centerAngleFeedback,this.point1AngleFeedback,this.point2AngleFeedback,i,a),null!=this.dimensionLinesFeedback){this.paintDimensionLines(e,this.dimensionLinesFeedback,[],t,null,null,null,c,i,o,a,n,!0)}null!=this.draggedItemsFeedback&&(this.paintDimensionLines(e,Home.getDimensionLinesSubList(this.draggedItemsFeedback),this.draggedItemsFeedback,t,h,d,null,c,i,o,r,n,!1),this.paintLabels(e,Home.getLabelsSubList(this.draggedItemsFeedback),this.draggedItemsFeedback,t,h,d,null,i,r,n),this.paintRoomsOutline(e,this.draggedItemsFeedback,t,h,u,null,i,r),this.paintWallsOutline(e,this.draggedItemsFeedback,t,h,u,null,i,r),this.paintFurniture(e,Home.getFurnitureSubList(this.draggedItemsFeedback),l,t,i,null,r,s,n,!1),this.paintFurnitureOutline(e,this.draggedItemsFeedback,t,h,u,null,i,r)),this.paintRectangleFeedback(e,a,i)}},PlanComponent.prototype.paintHomeItems=function(e,t,i,n,o,r){void 0===r&&(r=o,o=n,n=i,i=t,t=this.home.getSelectedLevel());var l=this,a=this.home.getSelectedItems();null==this.sortedLevelFurniture&&(this.sortedLevelFurniture=[],this.home.getFurniture().forEach((function(e){l.isViewableAtLevel(e,t)&&l.sortedLevelFurniture.push(e)})),CoreTools.sortArray(this.sortedLevelFurniture,{compare:function(e,t){return e.getGroundElevation()-t.getGroundElevation()}}));var s=this.getSelectionColor(),h=ColorTools.toRGBAStyle(s,.5),u=new java.awt.BasicStroke(6/i,java.awt.BasicStroke.CAP_ROUND,java.awt.BasicStroke.JOIN_ROUND),d=new java.awt.BasicStroke(4/i,java.awt.BasicStroke.CAP_ROUND,java.awt.BasicStroke.JOIN_ROUND),c=new java.awt.BasicStroke(1/i,java.awt.BasicStroke.CAP_SQUARE,java.awt.BasicStroke.JOIN_BEVEL,0,[20/i,5/i,5/i,5/i],4/i);this.paintCompass(e,a,i,o,r),this.paintRooms(e,a,t,i,o,r),this.paintWalls(e,a,t,i,n,o,r),this.paintFurniture(e,this.sortedLevelFurniture,a,t,i,n,o,this.getFurnitureOutlineColor(),r,!0),this.paintPolylines(e,this.home.getPolylines(),a,t,h,s,i,o,r),this.paintDimensionLines(e,this.home.getDimensionLines(),a,t,h,d,s,c,i,n,o,r,!1),this.paintRoomsNameAndArea(e,a,i,o,r),this.paintFurnitureName(e,this.sortedLevelFurniture,a,i,o,r),this.paintLabels(e,this.home.getLabels(),a,t,h,d,s,i,o,r),r===PlanComponent.PaintMode.PAINT&&this.selectedItemsOutlinePainted&&(this.paintCompassOutline(e,a,h,u,s,i,o),this.paintRoomsOutline(e,a,t,h,u,s,i,o),this.paintWallsOutline(e,a,t,h,u,s,i,o),this.paintFurnitureOutline(e,a,t,h,u,s,i,o))},PlanComponent.prototype.getSelectionColor=function(){return PlanComponent.getDefaultSelectionColor(this)},PlanComponent.getDefaultSelectionColor=function(e){if(null==PlanComponent.DEFAULT_SELECTION_COLOR){var t=window.getComputedStyle(e.container,"::selection").backgroundColor;(-1===t.indexOf("rgb")||ColorTools.isTransparent(t)||t==window.getComputedStyle(e.container).backgroundColor)&&(e.container.style.color="Highlight",t=window.getComputedStyle(e.container).color),-1===t.indexOf("rgb")||ColorTools.isTransparent(t)||t==window.getComputedStyle(e.container).backgroundColor?PlanComponent.DEFAULT_SELECTION_COLOR="#0042E0":PlanComponent.DEFAULT_SELECTION_COLOR=ColorTools.styleToHexadecimalString(t)}return PlanComponent.DEFAULT_SELECTION_COLOR},PlanComponent.prototype.getFurnitureOutlineColor=function(){return ColorTools.toRGBAStyle(this.getForeground(),.33)},PlanComponent.prototype.paintRooms=function(e,t,i,n,o,r){var l=this;null==this.sortedLevelRooms&&(this.sortedLevelRooms=[],this.home.getRooms().forEach((function(e){l.isViewableAtLevel(e,i)&&l.sortedLevelRooms.push(e)})),CoreTools.sortArray(this.sortedLevelRooms,{compare:function(e,t){return e.isFloorVisible()===t.isFloorVisible()&&e.isCeilingVisible()===t.isCeilingVisible()?0:!e.isFloorVisible()&&!e.isCeilingVisible()||e.isFloorVisible()&&t.isCeilingVisible()?-1:1}}));var a=r===PlanComponent.PaintMode.PRINT?"#000000":"#808080";e.setStroke(new java.awt.BasicStroke(this.getStrokeWidth(Room,r)/n));for(var s=0;s<this.sortedLevelRooms.length;s++){var h=l.sortedLevelRooms[s],u=t.indexOf(h)>=0;if(r!==PlanComponent.PaintMode.CLIPBOARD||u){e.setPaint(a);var d=0,c=1,p=1,g=0,m=0,f=null;if(l.preferences.isRoomFloorColoredOrTextured()&&h.isFloorVisible())if(null!=h.getFloorColor())e.setPaint(ColorTools.integerToHexadecimalString(h.getFloorColor()));else if(null!=(f=h.getFloorTexture())){null==l.floorTextureImagesCache&&(l.floorTextureImagesCache={});var v=l.floorTextureImagesCache[f.getImage().getURL()];if(null==v){v=PlanComponent.WAIT_TEXTURE_IMAGE,l.floorTextureImagesCache[f.getImage().getURL()]=v;var _=r!==PlanComponent.PaintMode.PAINT;TextureManager.getInstance().loadTexture(f.getImage(),_,{floorTexture:f,textureUpdated:function(e){l.floorTextureImagesCache[this.floorTexture.getImage().getURL()]=e,_||l.repaint()},textureError:function(){l.floorTextureImagesCache[this.floorTexture.getImage().getURL()]=PlanComponent.ERROR_TEXTURE_IMAGE},progression:function(){}})}if(h.getFloorTexture().isFittingArea()){var S=h.getBoundsMinimumCoordinates(),y=h.getBoundsMaximumCoordinates();c=(y[0]-S[0])/v.naturalWidth,p=(y[1]-S[1])/v.naturalHeight,g=S[0]/c,m=S[1]/p}else{var E=f.getWidth(),C=f.getHeight();-1!==E&&-1!==C||(E=100,C=100);var P=f.getScale();c=E*P/v.naturalWidth,p=C*P/v.naturalHeight,d=f.getAngle();var w=Math.cos(d),L=Math.sin(d);g=f.getXOffset()*v.naturalWidth*w-f.getYOffset()*v.height*L,m=-f.getXOffset()*v.naturalWidth*L-f.getYOffset()*v.height*w}e.setPaint(e.createPattern(v))}var T=l.setTransparency(e,h.isFloorVisible()?.75:.5),A=null;null!=f&&(e.scale(c,p),e.rotate(d,0,0),e.translate(g,m),(A=java.awt.geom.AffineTransform.getTranslateInstance(-g,-m)).rotate(-d,0,0),A.scale(1/c,1/p));var I=ShapeTools.getShape(h.getPoints(),!0,A);l.fillShape(e,I,r),null!=f&&(e.translate(-g,-m),e.rotate(-d,0,0),e.scale(1/c,1/p),I=ShapeTools.getShape(h.getPoints(),!0)),e.setAlpha(T),e.setPaint(o),e.draw(I)}}},PlanComponent.prototype.fillShape=function(e,t,i){e.fill(t)},PlanComponent.isTextureManagerAvailable=function(){return!0},PlanComponent.prototype.paintRoomsNameAndArea=function(e,t,i,n,o){var r=this;e.setPaint(n);var l=e.getFont();this.sortedLevelRooms.forEach((function(i){var n=t.indexOf(i)>=0;if(o!==PlanComponent.PaintMode.CLIPBOARD||n){var a=i.getXCenter(),s=i.getYCenter(),h=i.getName();if(null!=h&&(h=h.trim()).length>0&&r.paintText(e,i.constructor,h,i.getNameStyle(),null,a+i.getNameXOffset(),s+i.getNameYOffset(),i.getNameAngle(),l),i.isAreaVisible()){var u=i.getArea();if(u>.01){var d=r.preferences.getLengthUnit().getAreaFormatWithUnit().format(u);r.paintText(e,i.constructor,d,i.getAreaStyle(),null,a+i.getAreaXOffset(),s+i.getAreaYOffset(),i.getAreaAngle(),l)}}}})),e.setFont(l)},PlanComponent.prototype.paintText=function(e,t,i,n,o,r,l,a,s){var h=e.getTransform();e.translate(r,l),e.rotate(a),null==n&&(n=this.preferences.getDefaultTextStyle(t));for(var u=this.getFontMetrics(s,n),d=i.replace(/\n*$/,"").split("\n"),c=new Array(d.length),p=-34028235e31,g=0;g<d.length;g++)c[g]=u.getStringBounds(d[g]).getWidth(),p=Math.max(c[g],p);var m,f=null;if(null!=o){f=new java.awt.BasicStroke(.05*n.getFontSize());var v=n.deriveStyle$float(n.getFontSize()-f.getLineWidth());m=this.getFont(s,v),e.setStroke(f)}else m=this.getFont(s,n);e.setFont(m);for(g=d.length-1;g>=0;g--){var _=d[g],S=void 0;if(S=n.getAlignment()===TextStyle.Alignment.LEFT?0:n.getAlignment()===TextStyle.Alignment.RIGHT?-c[g]:-c[g]/2,null!=o&&(S+=f.getLineWidth()/2),e.translate(S,0),null!=o){var y=e.getColor();e.setColor(ColorTools.integerToHexadecimalString(o)),e.drawStringOutline(_,0,0),e.setColor(y)}e.drawString(_,0,0),e.translate(-S,-u.getHeight())}e.setTransform(h)},PlanComponent.prototype.paintRoomsOutline=function(e,t,i,n,o,r,l,a){for(var s=Home.getRoomsSubList(t),h=e.getTransform(),u=1/l,d=0;d<s.length;d++){var c=s[d];this.isViewableAtLevel(c,i)&&(e.setPaint(n),e.setStroke(o),e.draw(ShapeTools.getShape(c.getPoints(),!0,null)),null!=r&&(e.setPaint(r),c.getPoints().forEach((function(t){e.translate(t[0],t[1]),e.scale(u,u),e.setStroke(PlanComponent.POINT_STROKE),e.fill(PlanComponent.WALL_POINT),e.setTransform(h)}))))}e.setPaint(a),e.setStroke(new java.awt.BasicStroke(this.getStrokeWidth(Room,PlanComponent.PaintMode.PAINT)/l));for(d=0;d<s.length;d++){c=s[d];this.isViewableAtLevel(c,i)&&e.draw(ShapeTools.getShape(c.getPoints(),!0,null))}if(1===t.length&&1===s.length&&null!=r){var p=s[0];this.isViewableAtLevel(c,i)&&(e.setPaint(r),this.paintPointsResizeIndicators(e,p,r,l,!0,0,0,!0),this.paintRoomNameOffsetIndicator(e,p,r,l),this.paintRoomAreaOffsetIndicator(e,p,r,l))}},PlanComponent.prototype.paintPointsResizeIndicators=function(e,t,i,n,o,r,l,a){if(this.resizeIndicatorVisible){e.setPaint(i),e.setStroke(PlanComponent.INDICATOR_STROKE);for(var s=e.getTransform(),h=1/n,u=t.getPoints(),d=this.getIndicator(t,PlanComponent.IndicatorType.RESIZE),c=0;c<u.length;c++){var p=u[c];e.translate(p[0],p[1]),e.scale(h,h);var g=0===c?u[u.length-1]:u[c-1],m=c===u.length-1?u[0]:u[c+1],f=void 0;if(o||c>0&&c<u.length-1){var v=java.awt.geom.Point2D.distance(g[0],g[1],p[0],p[1]),_=(p[1]-g[1])/v,S=(g[0]-p[0])/v,y=java.awt.geom.Point2D.distance(m[0],m[1],p[0],p[1]),E=(m[1]-p[1])/y,C=(p[0]-m[0])/y;f=Math.atan2(S+C,_+E),(a&&t.containsPoint(p[0]+Math.cos(f),p[1]+Math.sin(f),.001)||!a&&_*C-S*E<0)&&(f+=Math.PI)}else f=0===c?r:l;e.rotate(f),e.draw(d),e.setTransform(s)}}},PlanComponent.prototype.getIndicator=function(e,t){if(PlanComponent.IndicatorType.RESIZE===t)return e instanceof HomePieceOfFurniture?PlanComponent.FURNITURE_RESIZE_INDICATOR:e instanceof Compass?PlanComponent.COMPASS_RESIZE_INDICATOR:PlanComponent.WALL_AND_LINE_RESIZE_INDICATOR;if(PlanComponent.IndicatorType.ROTATE===t){if(e instanceof HomePieceOfFurniture)return PlanComponent.FURNITURE_ROTATION_INDICATOR;if(e instanceof Compass)return PlanComponent.COMPASS_ROTATION_INDICATOR;if(e instanceof Camera)return PlanComponent.CAMERA_YAW_ROTATION_INDICATOR;if(e instanceof DimensionLine)return PlanComponent.DIMENSION_LINE_HEIGHT_ROTATION_INDICATOR}else{if(PlanComponent.IndicatorType.ELEVATE===t)return e instanceof Camera?PlanComponent.CAMERA_ELEVATION_INDICATOR:PlanComponent.ELEVATION_INDICATOR;if(PlanComponent.IndicatorType.RESIZE_HEIGHT===t){if(e instanceof HomePieceOfFurniture)return PlanComponent.FURNITURE_HEIGHT_INDICATOR;if(e instanceof DimensionLine)return PlanComponent.DIMENSION_LINE_HEIGHT_INDICATOR}else if(PlanComponent.IndicatorType.CHANGE_POWER===t){if(e instanceof HomeLight)return PlanComponent.LIGHT_POWER_INDICATOR}else{if(PlanComponent.IndicatorType.MOVE_TEXT===t)return PlanComponent.TEXT_LOCATION_INDICATOR;if(PlanComponent.IndicatorType.ROTATE_TEXT===t)return PlanComponent.TEXT_ANGLE_INDICATOR;if(PlanComponent.IndicatorType.ROTATE_PITCH===t){if(e instanceof HomePieceOfFurniture)return PlanComponent.FURNITURE_PITCH_ROTATION_INDICATOR;if(e instanceof Camera)return PlanComponent.CAMERA_PITCH_ROTATION_INDICATOR}else if(PlanComponent.IndicatorType.ROTATE_ROLL===t){if(e instanceof HomePieceOfFurniture)return PlanComponent.FURNITURE_ROLL_ROTATION_INDICATOR}else if(PlanComponent.IndicatorType.ARC_EXTENT===t&&e instanceof Wall)return PlanComponent.WALL_ARC_EXTENT_INDICATOR}}return null},PlanComponent.prototype.paintRoomNameOffsetIndicator=function(e,t,i,n){if(this.resizeIndicatorVisible&&null!=t.getName()&&t.getName().trim().length>0){var o=t.getXCenter()+t.getNameXOffset(),r=t.getYCenter()+t.getNameYOffset();this.paintTextIndicators(e,t,this.getLineCount(t.getName()),t.getNameStyle(),o,r,t.getNameAngle(),i,n)}},PlanComponent.prototype.paintRoomAreaOffsetIndicator=function(e,t,i,n){if(this.resizeIndicatorVisible&&t.isAreaVisible()&&t.getArea()>.01){var o=t.getXCenter()+t.getAreaXOffset(),r=t.getYCenter()+t.getAreaYOffset();this.paintTextIndicators(e,t,1,t.getAreaStyle(),o,r,t.getAreaAngle(),i,n)}},PlanComponent.prototype.paintTextIndicators=function(e,t,i,n,o,r,l,a,s){if(this.resizeIndicatorVisible){e.setPaint(a),e.setStroke(PlanComponent.INDICATOR_STROKE);var h=e.getTransform(),u=1/s;e.translate(o,r),e.rotate(l),e.scale(u,u),t instanceof Label?e.draw(PlanComponent.LABEL_CENTER_INDICATOR):e.draw(this.getIndicator(null,PlanComponent.IndicatorType.MOVE_TEXT)),null==n&&(n=this.preferences.getDefaultTextStyle(t));var d=this.getFontMetrics(e.getFont(),n);e.setTransform(h),e.translate(o,r),e.rotate(l),e.translate(0,-d.getHeight()*(i-1)-d.getAscent()*(t instanceof Label?1:.85)),e.scale(u,u),e.draw(this.getIndicator(null,PlanComponent.IndicatorType.ROTATE_TEXT)),e.setTransform(h)}},PlanComponent.prototype.getLineCount=function(e){for(var t=1,i=e.length-1;i>=0&&"\n"==e.charAt(i);)i--;for(;i>=0;i--)"\n"==e.charAt(i)&&t++;return t},PlanComponent.prototype.paintWalls=function(e,t,i,n,o,r,l){var a,s;l!==PlanComponent.PaintMode.CLIPBOARD?s=this.getWallAreasAtLevel(i):(a=Home.getWallsSubList(t),s=this.getWallAreas(this.getDrawableWallsAtLevel(a,i)));var h=l===PlanComponent.PaintMode.PRINT?n/72*150:n,u=null;l===PlanComponent.PaintMode.PAINT&&this.backgroundPainted&&null!=this.backgroundImageCache&&this.wallsDoorsOrWindowsModification&&(u=this.setTransparency(e,.5));for(var d=null==s.entries?[]:s.entries,c=0;c<d.length;c++){var p=d[c],g=p.getKey()[0].getPattern();this.fillAndDrawWallsArea(e,p.getValue(),n,this.getWallPaint(e,h,o,r,null!=g?g:this.preferences.getWallPattern()),r,l)}null!=u&&e.setAlpha(u)},PlanComponent.prototype.fillAndDrawWallsArea=function(e,t,i,n,o,r){e.setPaint(n);var l=1/i;e.scale(l,l);var a=t.clone();a.transform(java.awt.geom.AffineTransform.getScaleInstance(1/l,1/l)),this.fillShape(e,a,r),e.scale(1/l,1/l),e.setPaint(o),e.setStroke(new java.awt.BasicStroke(this.getStrokeWidth(Wall,r)/i)),e.draw(t)},PlanComponent.prototype.paintWallsOutline=function(e,t,i,n,o,r,l,a){for(var s=1/l,h=Home.getWallsSubList(t),u=e.getTransform(),d=0;d<h.length;d++){var c=h[d];if(this.isViewableAtLevel(c,i)&&(e.setPaint(n),e.setStroke(o),e.draw(ShapeTools.getShape(c.getPoints(),!0,null)),null!=r)){e.translate(c.getXStart(),c.getYStart()),e.scale(s,s),e.setPaint(r),e.setStroke(PlanComponent.POINT_STROKE),e.fill(PlanComponent.WALL_POINT);var p=c.getArcExtent(),g=void 0,m=void 0,f=0,v=0,_=0,S=c.getStartPointToEndPointDistance(),y=Math.atan2(c.getYEnd()-c.getYStart(),c.getXEnd()-c.getXStart());if(null!=p&&0!==p?(f=c.getXArcCircleCenter(),v=c.getYArcCircleCenter(),m=(_=java.awt.geom.Point2D.distance(c.getXStart(),c.getYStart(),f,v))*Math.abs(p)*l,g=Math.atan2(v-c.getYStart(),f-c.getXStart())+(p>0?-Math.PI/2:Math.PI/2)):(m=S*l,g=y),m<30)if(e.rotate(y),null!=p){var E=Math.abs(p)>Math.PI?-(Math.PI+p)/2:(Math.PI-p)/2,C=Math.tan(E)*S/2;e.translate(S*l/2,(C-_*(Math.abs(y)>Math.PI/2?-1:1))*l)}else e.translate(m/2,0);else e.rotate(g),e.translate(8,0);e.draw(PlanComponent.WALL_ORIENTATION_INDICATOR),e.setTransform(u),e.translate(c.getXEnd(),c.getYEnd()),e.scale(s,s),e.fill(PlanComponent.WALL_POINT),m>=30&&(null!=p&&(g+=p),e.rotate(g),e.translate(-10,0),e.draw(PlanComponent.WALL_ORIENTATION_INDICATOR)),e.setTransform(u)}}e.setPaint(a),e.setStroke(new java.awt.BasicStroke(this.getStrokeWidth(Wall,PlanComponent.PaintMode.PAINT)/l));var P=CoreTools.valuesFromMap(this.getWallAreas(this.getDrawableWallsAtLevel(h,i)));for(d=0;d<P.length;d++)e.draw(P[d]);if(1===t.length&&1===h.length&&null!=r){c=h[0];this.isViewableAtLevel(c,i)&&this.paintWallResizeIndicators(e,c,r,l)}},PlanComponent.prototype.isViewableAtLevel=function(e,t){var i=e.getLevel();return null==i||i.isViewable()&&e.isAtLevel(t)},PlanComponent.prototype.isViewableAtSelectedLevel=function(e){return this.isViewableAtLevel(e,this.home.getSelectedLevel())},PlanComponent.prototype.paintWallResizeIndicators=function(e,t,i,n){if(this.resizeIndicatorVisible){e.setPaint(i),e.setStroke(PlanComponent.INDICATOR_STROKE);var o=e.getTransform(),r=1/n,l=t.getPoints(),a=l.length/4|0,s=Math.atan2(t.getYEnd()-t.getYStart(),t.getXEnd()-t.getXStart());l.length%4==0?e.translate((l[a-1][0]+l[a][0])/2,(l[a-1][1]+l[a][1])/2):e.translate(l[a][0],l[a][1]),e.scale(r,r),e.rotate(s+Math.PI),e.draw(this.getIndicator(t,PlanComponent.IndicatorType.ARC_EXTENT)),e.setTransform(o);var h=t.getArcExtent(),u=void 0;u=null!=h&&0!==h?Math.atan2(t.getYArcCircleCenter()-t.getYEnd(),t.getXArcCircleCenter()-t.getXEnd())+(h>0?-Math.PI/2:Math.PI/2):s,e.translate(t.getXEnd(),t.getYEnd()),e.scale(r,r),e.rotate(u),e.draw(this.getIndicator(t,PlanComponent.IndicatorType.RESIZE)),e.setTransform(o),u+=null!=h?Math.PI-h:Math.PI,e.translate(t.getXStart(),t.getYStart()),e.scale(r,r),e.rotate(u),e.draw(this.getIndicator(t,PlanComponent.IndicatorType.RESIZE)),e.setTransform(o)}},PlanComponent.prototype.getWallAreasAtLevel=function(e){return null==this.wallAreasCache&&(this.wallAreasCache=this.getWallAreas(this.getDrawableWallsAtLevel(this.home.getWalls(),e))),this.wallAreasCache},PlanComponent.prototype.getDrawableWallsAtLevel=function(e,t){for(var i=[],n=0;n<e.length;n++){var o=e[n];this.isViewableAtLevel(o,t)&&i.push(o)}return i},PlanComponent.prototype.getWallAreas=function(e){var t=this;if(0===e.length)return{};for(var i=e[0].getPattern(),n=!0,o=0;o<e.length;o++)if(i!==e[o].getPattern()){n=!1;break}var r={};if(n)CoreTools.putToMap(r,e,this.getItemsArea(e));else{var l={};e.forEach((function(e){var i=e.getPattern();null==i&&(i=t.preferences.getWallPattern());var n=CoreTools.getFromMap(l,i);null==n&&(n=[],CoreTools.putToMap(l,i,n)),n.push(e)}));for(e=CoreTools.valuesFromMap(l),o=0;o<e.length;o++){var a=e[o];CoreTools.putToMap(r,a,this.getItemsArea(a))}}return r},PlanComponent.prototype.getItemsArea=function(e){var t=new java.awt.geom.Area;return e.forEach((function(e){t.add(new java.awt.geom.Area(ShapeTools.getShape(e.getPoints(),!0,null)))})),t},PlanComponent.prototype.makePatternImage=function(e,t,i){var n=document.createElement("canvas");n.width=e.naturalWidth,n.height=e.naturalHeight;var o=n.getContext("2d");o.fillStyle="#FFFFFF",o.fillRect(0,0,n.width,n.height),o.drawImage(e,0,0);for(var r=o.getImageData(0,0,e.naturalWidth,e.height).data,l=ColorTools.hexadecimalStringToInteger(i),a=ColorTools.hexadecimalStringToInteger(t),s=o.createImageData(e.naturalWidth,e.height),h=0;h<r.length;h+=4)if(s.data[h+3]=255,255===r[h]&&255===r[h+1]&&255===r[h+2])s.data[h]=(16711680&l)>>16,s.data[h+1]=(65280&l)>>8,s.data[h+2]=255&l;else if(0===r[h]&&0===r[h+1]&&0===r[h+2])s.data[h]=(16711680&a)>>16,s.data[h+1]=(65280&a)>>8,s.data[h+2]=255&a;else{var u=1-(r[h]+r[h+1]+r[h+2])/3/255;s.data[h]=Math.min(255,((16711680&a)>>16)*u+((16711680&l)>>16)*(1-u)),s.data[h+1]=Math.min(255,((65280&a)>>8)*u+((65280&l)>>8)*(1-u)),s.data[h+2]=Math.min(255,(255&a)*u+(255&l)*(1-u))}return o.putImageData(s,0,0),e.src=n.toDataURL(),e},PlanComponent.prototype.getWallPaint=function(e,t,i,n,o){var r=this,l=this.patternImagesCache[o.getImage().getURL()];return null!=l&&i==this.wallsPatternBackgroundCache&&n==this.wallsPatternForegroundCache||(l=TextureManager.getInstance().getWaitImage(),this.patternImagesCache[o.getImage().getURL()]=l,TextureManager.getInstance().loadTexture(o.getImage(),!1,{textureUpdated:function(e){r.patternImagesCache[o.getImage().getURL()]=r.makePatternImage(e,r.getForeground(),r.getBackground()),r.repaint()},textureError:function(){r.patternImagesCache[o.getImage().getURL()]=PlanComponent.ERROR_TEXTURE_IMAGE},progression:function(){}}),this.wallsPatternBackgroundCache=i,this.wallsPatternForegroundCache=n),e.createPattern(l)},PlanComponent.prototype.paintFurniture=function(e,t,i,n,o,r,l,a,s,h){if(0!=t.length)for(var u=new java.awt.BasicStroke(this.getStrokeWidth(HomePieceOfFurniture,s)/o),d=0;d<t.length;d++){var c=t[d];if(c.isVisible()){var p=i.indexOf(c)>=0;if(c instanceof HomeFurnitureGroup){var g=c.getFurniture();this.paintFurniture(e,g,p?g:[],n,o,r,l,a,s,h)}else if(s!==PlanComponent.PaintMode.CLIPBOARD||p){var m=ShapeTools.getShape(c.getPoints(),!0,null),f=void 0;if(c instanceof HomeDoorOrWindow){var v=c;f=this.getDoorOrWindowWallPartShape(v),null!=this.draggedItemsFeedback&&this.draggedItemsFeedback.indexOf(c)>=0||this.paintDoorOrWindowWallThicknessArea(e,v,o,r,l,s),this.paintDoorOrWindowSashes(e,v,o,l,s)}else f=m;var _=void 0;_=!!this.preferences.isFurnitureViewedFromTop()&&(null!=c.getPlanIcon()||c instanceof HomeDoorOrWindow||PlanComponent.WEBGL_AVAILABLE),h&&_?(c instanceof HomeDoorOrWindow?(e.setPaint(r),e.fill(f),e.setPaint(l),e.setStroke(u),e.draw(f)):this.paintPieceOfFurnitureTop(e,c,f,u,o,r,l,s),s===PlanComponent.PaintMode.PAINT&&(e.setStroke(u),e.setPaint(a),e.draw(m))):(h&&this.paintPieceOfFurnitureIcon(e,c,null,f,o,r,s),e.setPaint(l),e.setStroke(u),e.draw(f),c instanceof HomeDoorOrWindow&&s===PlanComponent.PaintMode.PAINT&&(e.setPaint(a),e.draw(m)))}}}},PlanComponent.prototype.getDoorOrWindowWallPartShape=function(e){var t=this.getDoorOrWindowRectangle(e,!0),i=java.awt.geom.AffineTransform.getRotateInstance(e.getAngle(),e.getX(),e.getY()),n=t.getPathIterator(i),o=new java.awt.geom.GeneralPath;return o.append(n,!1),o},PlanComponent.prototype.getDoorOrWindowRectangle=function(e,t){var i=e.getDepth()*(t?e.getWallThickness():1),n=e.getDepth()*(t?e.getWallDistance():0),o=e.getCutOutShape(),r=e.getWidth(),l=e.getWallWidth()*r,a=e.getX()-r/2;if(a+=e.isModelMirrored()?(1-e.getWallLeft()-e.getWallWidth())*r:e.getWallLeft()*r,null!=o&&PieceOfFurniture.DEFAULT_CUT_OUT_SHAPE!=o){var s=ShapeTools.getShape(o).getBounds2D();e.isModelMirrored()?a+=(1-s.getX()-s.getWidth())*l:a+=s.getX()*l,l*=s.getWidth()}return new java.awt.geom.Rectangle2D.Float(a,e.getY()-e.getDepth()/2+n,l,i)},PlanComponent.prototype.paintDoorOrWindowWallThicknessArea=function(e,t,i,n,o,r){if(t.isWallCutOutOnBothSides()){var l=null;if(null!=this.doorOrWindowWallThicknessAreasCache&&(l=CoreTools.getFromMap(this.doorOrWindowWallThicknessAreasCache,t)),null==l){var a=this.getDoorOrWindowRectangle(t,!1),s=java.awt.geom.AffineTransform.getRotateInstance(t.getAngle(),t.getX(),t.getY()),h=a.getPathIterator(s),u=new java.awt.geom.GeneralPath;u.append(h,!1);var d=new java.awt.geom.Area(u);l=new java.awt.geom.Area;for(var c=this.home.getWalls(),p=0;p<c.length;p++){var g=c[p];if(g.isAtLevel(t.getLevel())&&t.isParallelToWall(g)){var m=ShapeTools.getShape(g.getPoints(),!0,null),f=new java.awt.geom.Area(m);if(f.intersect(d),!f.isEmpty()){h=new java.awt.geom.Rectangle2D.Float(a.getX(),a.getY()-2*g.getThickness(),a.getWidth(),a.getWidth()+4*g.getThickness()).getPathIterator(s);var v=new java.awt.geom.GeneralPath;v.append(h,!1),(f=new java.awt.geom.Area(m)).intersect(new java.awt.geom.Area(v)),l.add(f)}}}}null==this.doorOrWindowWallThicknessAreasCache&&(this.doorOrWindowWallThicknessAreasCache={}),CoreTools.putToMap(this.doorOrWindowWallThicknessAreasCache,t,l),e.setPaint(n),e.fill(l),e.setPaint(o),e.setStroke(new java.awt.BasicStroke(this.getStrokeWidth(HomePieceOfFurniture,r)/i)),e.draw(l)}},PlanComponent.prototype.paintDoorOrWindowSashes=function(e,t,i,n,o){var r=new java.awt.BasicStroke(this.getStrokeWidth(HomePieceOfFurniture,o)/i);e.setPaint(n),e.setStroke(r);for(var l=t.getSashes(),a=0;a<l.length;a++)e.draw(this.getDoorOrWindowSashShape(t,l[a]))},PlanComponent.prototype.getDoorOrWindowSashShape=function(e,t){var i=e.isModelMirrored()?-1:1,n=i*t.getXAxis()*e.getWidth(),o=t.getYAxis()*e.getDepth(),r=t.getWidth()*e.getWidth(),l=180*t.getStartAngle()/Math.PI;e.isModelMirrored()&&(l=180-l);var a=i*(180*(t.getEndAngle()-t.getStartAngle())/Math.PI),s=new java.awt.geom.Arc2D.Float(n-r,o-r,2*r,2*r,l,a,java.awt.geom.Arc2D.PIE),h=java.awt.geom.AffineTransform.getTranslateInstance(e.getX(),e.getY());h.rotate(e.getAngle()),h.translate(i*-e.getWidth()/2,-e.getDepth()/2);var u=s.getPathIterator(h),d=new java.awt.geom.GeneralPath;return d.append(u,!1),d},PlanComponent.prototype.paintFurnitureName=function(e,t,i,n,o,r){var l=e.getFont();e.setPaint(o);for(var a=0;a<t.length;a++){var s=t[a];if(s.isVisible()){var h=i.indexOf(s)>=0;if(s instanceof HomeFurnitureGroup){var u=s.getFurniture();this.paintFurnitureName(e,u,h?u:[],n,o,r)}if(s.isNameVisible()&&(r!==PlanComponent.PaintMode.CLIPBOARD||h)){var d=s.getName().trim();d.length>0&&this.paintText(e,s.constructor,d,s.getNameStyle(),null,s.getX()+s.getNameXOffset(),s.getY()+s.getNameYOffset(),s.getNameAngle(),l)}}}e.setFont(l)},PlanComponent.prototype.paintFurnitureOutline=function(e,t,i,n,o,r,l,a){for(var s=this,h=new java.awt.BasicStroke(this.getStrokeWidth(HomePieceOfFurniture,PlanComponent.PaintMode.PAINT)/l),u=new java.awt.BasicStroke(4*this.getStrokeWidth(HomePieceOfFurniture,PlanComponent.PaintMode.PAINT)/l,java.awt.BasicStroke.CAP_BUTT,java.awt.BasicStroke.JOIN_MITER),d=Home.getFurnitureSubList(t),c=[],p=null,g=new java.awt.BasicStroke(15/l,java.awt.BasicStroke.CAP_SQUARE,java.awt.BasicStroke.JOIN_ROUND),m=null,f=null,v=this.home.getFurniture(),_=0;_<d.length;_++){var S=d[_];if(S.isVisible()&&this.isViewableAtLevel(S,i)){var y=this.getPieceOfFurnitureInHomeFurniture(S,v);if(y!==S){var E=null;if(m!==y){var C=ShapeTools.getShape(y.getPoints(),!0,null);(E=new java.awt.geom.Area(C)).add(new java.awt.geom.Area(g.createStrokedShape(C)))}var P=new java.awt.geom.Area(ShapeTools.getShape(S.getPoints(),!0,null));null==p?(p=E,f=P):(m!==y&&p.add(E),f.add(P)),m=y}c.push(S)}}if(null!=p){p.subtract(f);var w=this.setTransparency(e,.6);e.setPaint(n),e.fill(p),e.setAlpha(w)}c.forEach((function(i){var d=i.getPoints(),c=ShapeTools.getShape(d,!0,null);e.setPaint(n),e.setStroke(o),e.draw(c),e.setPaint(a),e.setStroke(h),e.draw(c),e.setStroke(u),e.draw(new java.awt.geom.Line2D.Float(d[2][0],d[2][1],d[3][0],d[3][1])),1===t.length&&null!=r&&s.paintPieceOfFurnitureIndicators(e,i,r,l)}))},PlanComponent.prototype.getPieceOfFurnitureInHomeFurniture=function(e,t){if(!(t.indexOf(e)>=0))for(var i=0;i<t.length;i++){var n=t[i];if(n instanceof HomeFurnitureGroup&&n.getAllFurniture().indexOf(e)>=0)return n}return e},PlanComponent.prototype.paintPieceOfFurnitureIcon=function(e,t,i,n,o,r){var l=this;if(null==i){null==this.furnitureIconsCache&&(this.furnitureIconsCache={});var a=this.furnitureIconsCache[t.icon.getURL()];null==a&&(a=TextureManager.getInstance().getWaitImage(),TextureManager.getInstance().loadTexture(t.icon,{textureUpdated:function(e){l.furnitureIconsCache[t.icon.getURL()]=e,l.repaint()},textureError:function(){l.furnitureIconsCache[t.icon.getURL()]=TextureManager.getInstance().getErrorImage(),l.repaint()}})),i=new PlanComponent.PieceOfFurnitureTopViewIcon(a)}e.setPaint(r),e.fill(n);var s=e.getClip();e.clip(n);var h=e.getTransform(),u=n.getBounds2D();e.translate(u.getCenterX(),u.getCenterY());var d=t.getDepthInPlan();t instanceof HomeDoorOrWindow&&(d*=t.getWallThickness());var c=Math.min(t.getWidthInPlan(),d),p=Math.min(1/o,c/i.getIconHeight());t.isModelMirrored()?e.scale(-p,p):e.scale(p,p),i.paintIcon(e,-i.getIconWidth()/2|0,-i.getIconHeight()/2|0),e.setTransform(h),e.setClip(s)},PlanComponent.prototype.paintPieceOfFurnitureTop=function(e,t,i,n,o,r,l,a){null==this.furnitureTopViewIconKeys&&(this.furnitureTopViewIconKeys={},this.furnitureTopViewIconsCache={});var s,h=CoreTools.getFromMap(this.furnitureTopViewIconKeys,t);if(null==h){if(h=new PlanComponent.HomePieceOfFurnitureTopViewIconKey(t.clone()),null==(s=CoreTools.getFromMap(this.furnitureTopViewIconsCache,h))||s.isWaitIcon()&&a!==PlanComponent.PaintMode.PAINT){var u=a===PlanComponent.PaintMode.PAINT?this:null;s=null!=t.getPlanIcon()?new PlanComponent.PieceOfFurniturePlanIcon(t,u):new PlanComponent.PieceOfFurnitureModelIcon(t,this.object3dFactory,u,this.preferences.getFurnitureModelIconSize()),CoreTools.putToMap(this.furnitureTopViewIconsCache,h,s)}else for(var d=0;d<this.furnitureTopViewIconsCache.entries.length;d++){var c=this.furnitureTopViewIconsCache.entries[d].key;if(c.equals(h)){h=c;break}}CoreTools.putToMap(this.furnitureTopViewIconKeys,t,h)}else s=CoreTools.getFromMap(this.furnitureTopViewIconsCache,h);if(s.isWaitIcon()||s.isErrorIcon())this.paintPieceOfFurnitureIcon(e,t,s,i,o,r),e.setPaint(l),e.setStroke(n),e.draw(i);else{var p=e.getTransform(),g=i.getBounds2D();e.translate(g.getCenterX(),g.getCenterY()),e.rotate(t.getAngle());var m=t.getDepthInPlan();t.isModelMirrored()&&0==t.getRoll()?e.scale(-t.getWidthInPlan()/s.getIconWidth(),m/s.getIconHeight()):e.scale(t.getWidthInPlan()/s.getIconWidth(),m/s.getIconHeight()),s.paintIcon(e,-s.getIconWidth()/2|0,-s.getIconHeight()/2|0),e.setTransform(p)}},PlanComponent.prototype.paintPieceOfFurnitureIndicators=function(e,t,i,n){if(this.resizeIndicatorVisible){e.setPaint(i),e.setStroke(PlanComponent.INDICATOR_STROKE);var o=e.getTransform(),r=t.getPoints(),l=1/n,a=t.getAngle(),s=this.getIndicator(t,PlanComponent.IndicatorType.ROTATE);null!=s&&(e.translate(r[0][0],r[0][1]),e.scale(l,l),e.rotate(a),e.draw(s),e.setTransform(o));var h=this.getIndicator(t,PlanComponent.IndicatorType.ELEVATE);if(null!=h&&(e.translate(r[1][0],r[1][1]),e.scale(l,l),e.rotate(a),e.draw(PlanComponent.ELEVATION_POINT_INDICATOR),e.translate(6.5,-6.5),e.rotate(-a),e.draw(h),e.setTransform(o)),e.translate(r[3][0],r[3][1]),e.scale(l,l),e.rotate(a),0!==t.getPitch()&&this.isFurnitureSizeInPlanSupported()){var u=this.getIndicator(t,PlanComponent.IndicatorType.ROTATE_PITCH);null!=u&&e.draw(u)}else if(0!==t.getRoll()&&this.isFurnitureSizeInPlanSupported()){var d=this.getIndicator(t,PlanComponent.IndicatorType.ROTATE_ROLL);null!=d&&e.draw(d)}else if(t instanceof HomeLight){var c=this.getIndicator(t,PlanComponent.IndicatorType.CHANGE_POWER);null!=c&&(e.draw(PlanComponent.LIGHT_POWER_POINT_INDICATOR),e.translate(-7.5,7.5),e.rotate(-a),e.draw(c))}else if(t.isResizable()&&!t.isHorizontallyRotated()){var p=this.getIndicator(t,PlanComponent.IndicatorType.RESIZE_HEIGHT);null!=p&&(e.draw(PlanComponent.HEIGHT_POINT_INDICATOR),e.translate(-7.5,7.5),e.rotate(-a),e.draw(p))}if(e.setTransform(o),t.isResizable()){var g=this.getIndicator(t,PlanComponent.IndicatorType.RESIZE);null!=g&&(e.translate(r[2][0],r[2][1]),e.scale(l,l),e.rotate(a),e.draw(g),e.setTransform(o))}if(t.isNameVisible()&&t.getName().trim().length>0){var m=t.getX()+t.getNameXOffset(),f=t.getY()+t.getNameYOffset();this.paintTextIndicators(e,t,this.getLineCount(t.getName()),t.getNameStyle(),m,f,t.getNameAngle(),i,n)}}},PlanComponent.prototype.paintPolylines=function(e,t,i,n,o,r,l,a,s){for(var h=0;h<t.length;h++){var u=t[h];if(this.isViewableAtLevel(u,n)){var d=i.indexOf(u)>=0;if(s!==PlanComponent.PaintMode.CLIPBOARD||d){e.setPaint(ColorTools.integerToHexadecimalString(u.getColor()));var c=u.getThickness();e.setStroke(ShapeTools.getStroke(c,u.getCapStyle(),u.getJoinStyle(),u.getDashStyle()!==Polyline.DashStyle.SOLID?u.getDashPattern():null,u.getDashOffset()));var p=ShapeTools.getPolylineShape(u.getPoints(),u.getJoinStyle()===Polyline.JoinStyle.CURVED,u.isClosedPath());e.draw(p);for(var g=null,m=null,f=null,v=null,_=p.getPathIterator(null,.5);!_.isDone();_.next()){var S=[0,0];_.currentSegment(S)!==java.awt.geom.PathIterator.SEG_CLOSE&&(null==g?g=S:null==m&&(m=S),f=v,v=S)}var y=Math.atan2(g[1]-m[1],g[0]-m[0]),E=Math.atan2(v[1]-f[1],v[0]-f[0]),C=u.getCapStyle()!==Polyline.CapStyle.BUTT?c/2:0;if(this.paintArrow(e,g,y,u.getStartArrowStyle(),c,C),this.paintArrow(e,v,E,u.getEndArrowStyle(),c,C),d&&s===PlanComponent.PaintMode.PAINT&&(e.setPaint(o),e.setStroke(ShapeTools.getStroke(c+4/l,u.getCapStyle(),u.getJoinStyle(),null)),e.draw(p),1===i.length&&null!=r)){var P=i[0];this.isViewableAtLevel(u,n)&&(e.setPaint(r),this.paintPointsResizeIndicators(e,P,r,l,P.isClosedPath(),y,E,!1))}}}}},PlanComponent.prototype.paintArrow=function(e,t,i,n,o,r){if(null!=n&&n!==Polyline.ArrowStyle.NONE){var l=e.getTransform();e.translate(t[0],t[1]),e.rotate(i),e.translate(r,0);var a=2*Math.pow(o,.66);switch(e.scale(a,a),n){case Polyline.ArrowStyle.DISC:e.fill(new java.awt.geom.Ellipse2D.Float(-3.5,-2,4,4));break;case Polyline.ArrowStyle.OPEN:e.scale(.9,.9),e.setStroke(new java.awt.BasicStroke(o/a/.9,java.awt.BasicStroke.CAP_BUTT,java.awt.BasicStroke.JOIN_MITER)),e.draw(PlanComponent.ARROW);break;case Polyline.ArrowStyle.DELTA:e.translate(1.65,0),e.fill(PlanComponent.ARROW)}e.setTransform(l)}},PlanComponent.prototype.paintDimensionLines=function(e,t,i,n,o,r,l,a,s,h,u,d,c){var p=this;d===PlanComponent.PaintMode.CLIPBOARD&&(t=Home.getDimensionLinesSubList(i));for(var g=PlanComponent.DIMENSION_LINE_MARK_END.getBounds2D().getWidth(),m=1==i.length&&i[0]instanceof DimensionLine&&d===PlanComponent.PaintMode.PAINT&&null!=l?i[0]:null,f=e.getFont(),v=0;v<t.length;v++){var _=t[v];if(p.isViewableAtLevel(_,n)){var S=_.getColor(),y=_.getEndMarkSize()/g,E=new java.awt.BasicStroke(p.getStrokeWidth(DimensionLine,d)/y/s);e.setPaint(null!=S?ColorTools.integerToHexadecimalString(S):u);var C=e.getTransform(),P=_.isElevationDimensionLine(),w=P?(_.getPitch()+2*Math.PI)%(2*Math.PI):Math.atan2(_.getYEnd()-_.getYStart(),_.getXEnd()-_.getXStart()),L=_.getOffset(),T=_.getLength();e.translate(_.getXStart(),_.getYStart()),e.rotate(w),e.translate(0,L);var A=_.getElevationStart()==_.getElevationEnd();if(d===PlanComponent.PaintMode.PAINT&&p.selectedItemsOutlinePainted&&i.indexOf(_)>=0&&(e.setPaint(o),e.setStroke(r),A?(e.draw(new java.awt.geom.Line2D.Float(0,0,T,0)),e.scale(y,y),e.draw(PlanComponent.DIMENSION_LINE_MARK_END),e.translate(T/y,0),e.draw(PlanComponent.DIMENSION_LINE_MARK_END),e.scale(1/y,1/y),e.translate(-T,0),e.draw(new java.awt.geom.Line2D.Float(0,-L,0,0)),e.draw(new java.awt.geom.Line2D.Float(T,-L,T,0))):(e.scale(y,y),e.draw(PlanComponent.VERTICAL_DIMENSION_LINE),e.scale(1/y,1/y),Math.abs(L)>_.getEndMarkSize()/2&&e.draw(new java.awt.geom.Line2D.Float(0,-L,0,-_.getEndMarkSize()/2*(L>=0?0==L?0:1:-1)))),e.setPaint(null!=S?ColorTools.integerToHexadecimalString(S):u)),e.setStroke(E),A?(e.draw(new java.awt.geom.Line2D.Float(0,0,T,0)),e.scale(y,y),e.draw(PlanComponent.DIMENSION_LINE_MARK_END),e.translate(T/y,0),e.draw(PlanComponent.DIMENSION_LINE_MARK_END),e.scale(1/y,1/y),e.translate(-T,0),e.setStroke(a),e.draw(new java.awt.geom.Line2D.Float(0,-L,0,0)),e.draw(new java.awt.geom.Line2D.Float(T,-L,T,0))):(e.scale(y,y),e.fill(PlanComponent.VERTICAL_DIMENSION_LINE_DISC),e.draw(PlanComponent.VERTICAL_DIMENSION_LINE),e.scale(1/y,1/y),e.setStroke(a),Math.abs(L)>_.getEndMarkSize()/2&&e.draw(new java.awt.geom.Line2D.Float(0,-L,0,-_.getEndMarkSize()/2*(L>=0?0==L?0:1:-1)))),A||_===m){var I=p.preferences.getLengthUnit().getFormat().format(T),b=_.getLengthStyle();null==b&&(b=p.preferences.getDefaultTextStyle(_.constructor)),(c&&null!=p.getFont()||!A&&_==m)&&(b=b.deriveStyle$float(parseInt(new Font(p.getFont()).size)/s));var O=p.getFont(f,b),M=p.getFontMetrics(O,b),D=M.getStringBounds(I,e);if(e.setFont(O),A||_!==m?e.translate((T-D.getWidth())/2,L<=0?-M.getDescent()-1:M.getAscent()+1):(e.rotate(w>Math.PI?Math.PI/2:-Math.PI/2),e.translate(L<=0^w<=Math.PI?-D.getWidth()-g/2-5/s:g/2+5/s,M.getAscent()/2),P&&this.resizeIndicatorVisible&&e.translate(10*(L<=0^w<=Math.PI?-1:1)/s,0)),c||!A&&_===m){e.setColor(h);var R=p.setTransparency(e,.7);e.setStroke(new java.awt.BasicStroke(4/s,java.awt.BasicStroke.CAP_SQUARE,java.awt.BasicStroke.CAP_ROUND)),e.drawStringOutline(I,0,0),e.setAlpha(R),e.setColor(u),c||e.setPaint(l)}e.setFont(O),e.drawString(I,0,0)}e.setTransform(C)}}e.setFont(f),null!=m&&this.paintDimensionLineResizeIndicators(e,m,l,s)},PlanComponent.prototype.paintDimensionLineResizeIndicators=function(e,t,i,n){if(this.resizeIndicatorVisible){e.setPaint(i),e.setStroke(PlanComponent.INDICATOR_STROKE);var o=t.isElevationDimensionLine()?t.getPitch():Math.atan2(t.getYEnd()-t.getYStart(),t.getXEnd()-t.getXStart()),r=t.getElevationStart()===t.getElevationEnd(),l=e.getTransform(),a=1/n,s=this.getIndicator(t,PlanComponent.IndicatorType.RESIZE);r?(e.translate(t.getXStart(),t.getYStart()),e.rotate(o),e.translate(0,t.getOffset()),e.rotate(Math.PI),e.scale(a,a),e.draw(s),e.setTransform(l),e.translate(t.getXEnd(),t.getYEnd()),e.rotate(o),e.translate(0,t.getOffset()),e.scale(a,a),e.draw(s),e.setTransform(l),e.translate((t.getXStart()+t.getXEnd())/2,(t.getYStart()+t.getYEnd())/2)):e.translate(t.getXStart(),t.getYStart()),e.rotate(o);var h=e.getTransform();e.translate(0,t.getOffset()-(r?0:t.getEndMarkSize()/2*(t.getOffset()>0?1:-1))),e.rotate(t.getOffset()<=0?Math.PI/2:-Math.PI/2),e.scale(a,a),e.draw(s),r||(t.isElevationDimensionLine()&&(e.setTransform(h),e.translate(0,t.getOffset()+t.getEndMarkSize()/2*(t.getOffset()>0?1:-1)),e.rotate(t.getOffset()<=0?Math.PI/2:-Math.PI/2),e.scale(a,a),e.draw(this.getIndicator(t,PlanComponent.IndicatorType.ROTATE))),e.setTransform(h),e.translate(-t.getEndMarkSize()/2,t.getOffset()),e.scale(a,a),e.draw(PlanComponent.ELEVATION_POINT_INDICATOR),e.translate(-9,0),e.rotate(-o),e.draw(this.getIndicator(t,PlanComponent.IndicatorType.ELEVATE)),e.setTransform(h),e.translate(5,t.getOffset()),e.scale(a,a),e.draw(PlanComponent.HEIGHT_POINT_INDICATOR),e.translate(10,0),e.rotate(-o),e.draw(this.getIndicator(t,PlanComponent.IndicatorType.RESIZE_HEIGHT))),e.setTransform(l)}},PlanComponent.prototype.paintLabels=function(e,t,i,n,o,r,l,a,s,h){for(var u=e.getFont(),d=0;d<t.length;d++){var c=t[d];if(this.isViewableAtLevel(c,n)){var p=i.indexOf(c)>=0;if(h!==PlanComponent.PaintMode.CLIPBOARD||p){var g=c.getText(),m=c.getX(),f=c.getY(),v=c.getAngle(),_=c.getStyle();null==_&&(_=this.preferences.getDefaultTextStyle(c.constructor)),null==_.getFontName()&&null!=this.getFont()&&(_=_.deriveStyle(new Font(this.getFont()).family));var S=c.getColor();if(e.setPaint(null!=S?ColorTools.integerToHexadecimalString(S):s),this.paintText(e,c.constructor,g,_,c.getOutlineColor(),m,f,v,u),h===PlanComponent.PaintMode.PAINT&&this.selectedItemsOutlinePainted&&p){e.setPaint(o),e.setStroke(r);var y=this.getTextBounds(g,_,m,f,v);if(e.draw(ShapeTools.getShape(y,!0,null)),e.setPaint(s),null!=l&&1===i.length&&i[0]===c&&(this.paintTextIndicators(e,c,this.getLineCount(g),_,m,f,v,l,a),this.resizeIndicatorVisible&&null!=c.getPitch())){var E=this.getIndicator(c,PlanComponent.IndicatorType.ELEVATE);if(null!=E){var C=e.getTransform();_.getAlignment()===TextStyle.Alignment.LEFT?e.translate(y[3][0],y[3][1]):_.getAlignment()===TextStyle.Alignment.RIGHT?e.translate(y[2][0],y[2][1]):e.translate((y[2][0]+y[3][0])/2,(y[2][1]+y[3][1])/2);var P=1/a;e.scale(P,P),e.rotate(c.getAngle()),e.draw(PlanComponent.ELEVATION_POINT_INDICATOR),e.translate(0,10),e.rotate(-c.getAngle()),e.draw(E),e.setTransform(C)}}}}}}e.setFont(u)},PlanComponent.prototype.paintCompass=function(e,t,i,n,o){var r=this.home.getCompass();if(r.isVisible()&&(o!==PlanComponent.PaintMode.CLIPBOARD||t.indexOf(r)>=0)){var l=e.getTransform();e.translate(r.getX(),r.getY()),e.rotate(r.getNorthDirection());var a=r.getDiameter();e.scale(a,a),e.setColor(n),e.fill(PlanComponent.COMPASS),e.setTransform(l)}},PlanComponent.prototype.paintCompassOutline=function(e,t,i,n,o,r,l){var a=this.home.getCompass();if(t.indexOf(a)>=0&&a.isVisible()){var s=e.getTransform();e.translate(a.getX(),a.getY()),e.rotate(a.getNorthDirection());var h=a.getDiameter();e.scale(h,h),e.setPaint(i),e.setStroke(new java.awt.BasicStroke((5.5+r)/h/r)),e.draw(PlanComponent.COMPASS_DISC),e.setColor(l),e.setStroke(new java.awt.BasicStroke(1/h/r)),e.draw(PlanComponent.COMPASS_DISC),e.setTransform(s),1===t.length&&t[0]===a&&(e.setPaint(o),this.paintCompassIndicators(e,a,o,r))}},PlanComponent.prototype.paintCompassIndicators=function(e,t,i,n){if(this.resizeIndicatorVisible){e.setPaint(i),e.setStroke(PlanComponent.INDICATOR_STROKE);var o=e.getTransform(),r=t.getPoints(),l=1/n;e.translate((r[2][0]+r[3][0])/2,(r[2][1]+r[3][1])/2),e.scale(l,l),e.rotate(t.getNorthDirection()),e.draw(this.getIndicator(t,PlanComponent.IndicatorType.ROTATE)),e.setTransform(o),e.translate((r[1][0]+r[2][0])/2,(r[1][1]+r[2][1])/2),e.scale(l,l),e.rotate(t.getNorthDirection()),e.draw(this.getIndicator(t,PlanComponent.IndicatorType.RESIZE)),e.setTransform(o)}},PlanComponent.prototype.paintWallAlignmentFeedback=function(e,t,i,n,o,r,l,a,s,h){var u=this;if(null!=n){var d=.5/a,c=n.getX(),p=n.getY(),g=1/0,m=1/0;this.getViewedItems(this.home.getWalls(),i,this.otherLevelsWallsCache).forEach((function(e){if(e!==t){Math.abs(c-e.getXStart())<d&&(null==t||!u.equalsWallPoint(e.getXStart(),e.getYStart(),t))?Math.abs(m)>Math.abs(p-e.getYStart())&&(m=p-e.getYStart()):Math.abs(c-e.getXEnd())<d&&(null==t||!u.equalsWallPoint(e.getXEnd(),e.getYEnd(),t))&&Math.abs(m)>Math.abs(p-e.getYEnd())&&(m=p-e.getYEnd()),Math.abs(p-e.getYStart())<d&&(null==t||!u.equalsWallPoint(e.getXStart(),e.getYStart(),t))?Math.abs(g)>Math.abs(c-e.getXStart())&&(g=c-e.getXStart()):Math.abs(p-e.getYEnd())<d&&(null==t||!u.equalsWallPoint(e.getXEnd(),e.getYEnd(),t))&&Math.abs(g)>Math.abs(c-e.getXEnd())&&(g=c-e.getXEnd());var i=e.getPoints();i=[i[0],i[(i.length/2|0)-1],i[i.length/2|0],i[i.length-1]];for(var n=0;n<i.length;n++)Math.abs(c-i[n][0])<d&&(null==t||!u.equalsWallPoint(i[n][0],i[n][1],t))&&Math.abs(m)>Math.abs(p-i[n][1])&&(m=p-i[n][1]),Math.abs(p-i[n][1])<d&&(null==t||!u.equalsWallPoint(i[n][0],i[n][1],t))&&Math.abs(g)>Math.abs(c-i[n][0])&&(g=c-i[n][0])}})),e.setPaint(r),e.setStroke(l);var f=this.pointerType===View.PointerType.TOUCH?2*PlanComponent.ALIGNMENT_LINE_OFFSET:PlanComponent.ALIGNMENT_LINE_OFFSET;g!==1/0&&(g>0?e.draw(new java.awt.geom.Line2D.Float(c+f/a,p,c-g-f/a,p)):e.draw(new java.awt.geom.Line2D.Float(c-f/a,p,c-g+f/a,p))),m!==1/0&&(m>0?e.draw(new java.awt.geom.Line2D.Float(c,p+f/a,c,p-m-f/a)):e.draw(new java.awt.geom.Line2D.Float(c,p-f/a,c,p-m+f/a))),o&&this.paintPointFeedback(e,n,r,a,s,h)}},PlanComponent.prototype.getViewedItems=function(e,t,i){var n=[];null!=i&&n.push.apply(n,i);for(var o=0;o<e.length;o++){var r=e[o];this.isViewableAtLevel(r,t)&&n.push(r)}return n},PlanComponent.prototype.paintPointFeedback=function(e,t,i,n,o,r){e.setPaint(o),e.setStroke(r);var l=this.pointerType===View.PointerType.TOUCH?20:10,a=new java.awt.geom.Ellipse2D.Float(t.getX()-l/n,t.getY()-l/n,2*l/n,2*l/n);e.fill(a),e.setPaint(i),e.setStroke(new java.awt.BasicStroke(1/n)),e.draw(a),e.draw(new java.awt.geom.Line2D.Float(t.getX(),t.getY()-l/n,t.getX(),t.getY()+l/n)),e.draw(new java.awt.geom.Line2D.Float(t.getX()-l/n,t.getY(),t.getX()+l/n,t.getY()))},PlanComponent.prototype.equalsWallPoint=function(e,t,i){return e===i.getXStart()&&t===i.getYStart()||e===i.getXEnd()&&t===i.getYEnd()},PlanComponent.prototype.paintRoomAlignmentFeedback=function(e,t,i,n,o,r,l,a,s,h){if(null!=n){var u=.5/a,d=n.getX(),c=n.getY(),p=1/0,g=1/0;this.getViewedItems(this.home.getRooms(),i,this.otherLevelsRoomsCache).forEach((function(e){var i=e.getPoints(),n=-1;if(e===t)for(var o=0;o<i.length;o++)if(i[o][0]===d&&i[o][1]===c){n=o;break}for(o=0;o<i.length;o++)(-1===n||o!==n&&i.length>2)&&(Math.abs(d-i[o][0])<u&&Math.abs(g)>Math.abs(c-i[o][1])&&(g=c-i[o][1]),Math.abs(c-i[o][1])<u&&Math.abs(p)>Math.abs(d-i[o][0])&&(p=d-i[o][0]))})),this.getViewedItems(this.home.getWalls(),i,this.otherLevelsWallsCache).forEach((function(e){var t=e.getPoints();t=[t[0],t[(t.length/2|0)-1],t[t.length/2|0],t[t.length-1]];for(var i=0;i<t.length;i++)Math.abs(d-t[i][0])<u&&Math.abs(g)>Math.abs(c-t[i][1])&&(g=c-t[i][1]),Math.abs(c-t[i][1])<u&&Math.abs(p)>Math.abs(d-t[i][0])&&(p=d-t[i][0])})),e.setPaint(r),e.setStroke(l);var m=this.pointerType===View.PointerType.TOUCH?2*PlanComponent.ALIGNMENT_LINE_OFFSET:PlanComponent.ALIGNMENT_LINE_OFFSET;p!==1/0&&(p>0?e.draw(new java.awt.geom.Line2D.Float(d+m/a,c,d-p-m/a,c)):e.draw(new java.awt.geom.Line2D.Float(d-m/a,c,d-p+m/a,c))),g!==1/0&&(g>0?e.draw(new java.awt.geom.Line2D.Float(d,c+m/a,d,c-g-m/a)):e.draw(new java.awt.geom.Line2D.Float(d,c-m/a,d,c-g+m/a))),o&&this.paintPointFeedback(e,n,r,a,s,h)}},PlanComponent.prototype.paintDimensionLineAlignmentFeedback=function(e,t,i,n,o,r,l,a,s,h){var u=this;if(null!=n){var d=.5/a,c=n.getX(),p=n.getY(),g=1/0,m=1/0;this.getViewedItems(this.home.getRooms(),i,this.otherLevelsRoomsCache).forEach((function(e){for(var t=e.getPoints(),i=0;i<t.length;i++)Math.abs(c-t[i][0])<d&&Math.abs(m)>Math.abs(p-t[i][1])&&(m=p-t[i][1]),Math.abs(p-t[i][1])<d&&Math.abs(g)>Math.abs(c-t[i][0])&&(g=c-t[i][0])})),this.home.getDimensionLines().forEach((function(e){u.isViewableAtLevel(e,i)&&e!==t&&(Math.abs(c-e.getXStart())<d&&(null==t||!u.equalsDimensionLinePoint(e.getXStart(),e.getYStart(),t))?Math.abs(m)>Math.abs(p-e.getYStart())&&(m=p-e.getYStart()):Math.abs(c-e.getXEnd())<d&&(null==t||!u.equalsDimensionLinePoint(e.getXEnd(),e.getYEnd(),t))&&Math.abs(m)>Math.abs(p-e.getYEnd())&&(m=p-e.getYEnd()),Math.abs(p-e.getYStart())<d&&(null==t||!u.equalsDimensionLinePoint(e.getXStart(),e.getYStart(),t))?Math.abs(g)>Math.abs(c-e.getXStart())&&(g=c-e.getXStart()):Math.abs(p-e.getYEnd())<d&&(null==t||!u.equalsDimensionLinePoint(e.getXEnd(),e.getYEnd(),t))&&Math.abs(g)>Math.abs(c-e.getXEnd())&&(g=c-e.getXEnd()))})),this.getViewedItems(this.home.getWalls(),i,this.otherLevelsWallsCache).forEach((function(e){var t=e.getPoints();t=[t[0],t[(t.length/2|0)-1],t[t.length/2|0],t[t.length-1]];for(var i=0;i<t.length;i++)Math.abs(c-t[i][0])<d&&Math.abs(m)>Math.abs(p-t[i][1])&&(m=p-t[i][1]),Math.abs(p-t[i][1])<d&&Math.abs(g)>Math.abs(c-t[i][0])&&(g=c-t[i][0])})),this.home.getFurniture().forEach((function(e){if(e.isVisible()&&u.isViewableAtLevel(e,i))for(var t=e.getPoints(),n=0;n<t.length;n++)Math.abs(c-t[n][0])<d&&Math.abs(m)>Math.abs(p-t[n][1])&&(m=p-t[n][1]),Math.abs(p-t[n][1])<d&&Math.abs(g)>Math.abs(c-t[n][0])&&(g=c-t[n][0])})),e.setPaint(r),e.setStroke(l);var f=this.pointerType===View.PointerType.TOUCH?2*PlanComponent.ALIGNMENT_LINE_OFFSET:PlanComponent.ALIGNMENT_LINE_OFFSET;g!==1/0&&(g>0?e.draw(new java.awt.geom.Line2D.Float(c+f/a,p,c-g-f/a,p)):e.draw(new java.awt.geom.Line2D.Float(c-f/a,p,c-g+f/a,p))),m!==1/0&&(m>0?e.draw(new java.awt.geom.Line2D.Float(c,p+f/a,c,p-m-f/a)):e.draw(new java.awt.geom.Line2D.Float(c,p-f/a,c,p-m+f/a))),o&&this.paintPointFeedback(e,n,r,a,s,h)}},PlanComponent.prototype.equalsDimensionLinePoint=function(e,t,i){return e===i.getXStart()&&t===i.getYStart()||e===i.getXEnd()&&t===i.getYEnd()},PlanComponent.prototype.paintAngleFeedback=function(e,t,i,n,o,r){if(!i.equals(t)&&!n.equals(t)){e.setColor(r),e.setStroke(new java.awt.BasicStroke(1/o));var l=Math.atan2(t.getY()-i.getY(),i.getX()-t.getX());l<0&&(l=2*Math.PI+l);var a=Math.atan2(t.getY()-n.getY(),n.getX()-t.getX());a<0&&(a=2*Math.PI+a);var s=a-l;l>a&&(s=2*Math.PI+s);var h=e.getTransform();e.translate(t.getX(),t.getY());var u=20/o;e.draw(new java.awt.geom.Arc2D.Double(-u,-u,2*u,2*u,180*l/Math.PI,180*s/Math.PI,java.awt.geom.Arc2D.OPEN)),u+=5/o,e.draw(new java.awt.geom.Line2D.Double(0,0,u*Math.cos(l),-u*Math.sin(l))),e.draw(new java.awt.geom.Line2D.Double(0,0,u*Math.cos(l+s),-u*Math.sin(l+s))),e.setTransform(h)}},PlanComponent.prototype.paintCamera=function(e,t,i,n,o,r,l,a){var s=this.home.getObserverCamera();if(s===this.home.getCamera()){var h=e.getTransform();e.translate(s.getX(),s.getY()),e.rotate(s.getYaw());var u=s.getPoints(),d=java.awt.geom.Point2D.distance(u[0][0],u[0][1],u[3][0],u[3][1]),c=java.awt.geom.Point2D.distance(u[0][0],u[0][1],u[1][0],u[1][1]),p=java.awt.geom.AffineTransform.getScaleInstance(c,d),g=s.getPlanScale(),m=new java.awt.geom.Area(g<=1?PlanComponent.CAMERA_HUMAN_BODY:PlanComponent.CAMERA_BODY).createTransformedArea(p),f=new java.awt.geom.Area(g<=1?PlanComponent.CAMERA_HUMAN_HEAD:PlanComponent.CAMERA_BUTTON).createTransformedArea(p);e.setPaint(l),e.fill(m),e.setPaint(a);var v=new java.awt.BasicStroke(this.getStrokeWidth(ObserverCamera,PlanComponent.PaintMode.PAINT)/r);if(e.setStroke(v),e.draw(m),t.indexOf(s)>=0&&this.selectedItemsOutlinePainted){e.setPaint(i),e.setStroke(n);var _=new java.awt.geom.Area(m);_.add(new java.awt.geom.Area(f)),e.draw(_)}e.setPaint(l),e.fill(f),e.setPaint(a),e.setStroke(v),e.draw(f);var S=Math.sin(s.getFieldOfView()/2),y=Math.cos(s.getFieldOfView()/2),E=.9*d*S,C=.9*d*y,P=2.2*d*S,w=2.2*d*y,L=new java.awt.geom.GeneralPath;L.moveTo(E,C),L.lineTo(P,w),L.moveTo(-E,C),L.lineTo(-P,w),e.draw(L),e.setTransform(h),1===t.length&&t[0]===s&&this.paintCameraRotationIndicators(e,s,o,r)}},PlanComponent.prototype.paintCameraRotationIndicators=function(e,t,i,n){if(this.resizeIndicatorVisible){e.setPaint(i),e.setStroke(PlanComponent.INDICATOR_STROKE);var o=e.getTransform(),r=t.getPoints(),l=1/n;e.translate((r[0][0]+r[3][0])/2,(r[0][1]+r[3][1])/2),e.scale(l,l),e.rotate(t.getYaw()),e.draw(this.getIndicator(t,PlanComponent.IndicatorType.ROTATE)),e.setTransform(o),e.translate((r[1][0]+r[2][0])/2,(r[1][1]+r[2][1])/2),e.scale(l,l),e.rotate(t.getYaw()),e.draw(this.getIndicator(t,PlanComponent.IndicatorType.ROTATE_PITCH)),e.setTransform(o);var a=this.getIndicator(t,PlanComponent.IndicatorType.ELEVATE);null!=a&&(e.translate((r[0][0]+r[1][0])/2,(r[0][1]+r[1][1])/2),e.scale(l,l),e.draw(PlanComponent.POINT_INDICATOR),e.translate(8*Math.sin(t.getYaw()),8*-Math.cos(t.getYaw())),e.draw(a),e.setTransform(o))}},PlanComponent.prototype.paintRectangleFeedback=function(e,t,i){null!=this.rectangleFeedback&&(e.setPaint(ColorTools.toRGBAStyle(t,.125)),e.fill(this.rectangleFeedback),e.setPaint(t),e.setStroke(new java.awt.BasicStroke(1/i)),e.draw(this.rectangleFeedback))},PlanComponent.prototype.setRectangleFeedback=function(e,t,i,n){this.rectangleFeedback=new java.awt.geom.Rectangle2D.Float(e,t,0,0),this.rectangleFeedback.add(i,n),this.repaint()},PlanComponent.prototype.makeSelectionVisible=function(){if(this.isScrolled()&&!this.selectionScrollUpdated){this.selectionScrollUpdated=!0;var e=this;setTimeout((function(){e.selectionScrollUpdated=!1;var t=e.getSelectionBounds(!0);if(null!=t){var i=e.getShapePixelBounds(t);i=new java.awt.geom.Rectangle2D.Float(i.getX()-5,i.getY()-5,i.getWidth()+10,i.getHeight()+10);var n=new java.awt.geom.Rectangle2D.Float(0,0,e.scrollPane.clientWidth,e.scrollPane.clientHeight);i.intersects(n)||e.scrollRectToVisible(i)}}))}},PlanComponent.prototype.scrollRectToVisible=function(e){if(this.isScrolled()){var t=0,i=0;e.x<0?t=e.x:e.getX()+e.getWidth()>this.scrollPane.clientWidth&&(t=e.getX()+e.getWidth()-this.scrollPane.clientWidth),e.y<0?i=e.y:e.getY()+e.getHeight()>this.scrollPane.clientHeight&&(i=e.getY()+e.getHeight()-this.scrollPane.clientHeight),this.moveView(this.convertPixelToLength(t),this.convertPixelToLength(i))}},PlanComponent.prototype.getSelectionBounds=function(e){var t=this.getGraphics();if(null!=t&&this.setRenderingHints(t),e)return this.getItemsBounds(t,this.home.getSelectedItems());var i=this.home.getSelectedItems().slice(0),n=i.indexOf(this.home.getCamera());return n>=0&&i.splice(n,1),this.getItemsBounds(t,i)},PlanComponent.prototype.makePointVisible=function(e,t){this.scrollRectToVisible(this.getShapePixelBounds(new java.awt.geom.Rectangle2D.Float(e,t,this.getPixelLength(),this.getPixelLength())))},PlanComponent.prototype.moveView=function(e,t){!this.isScrolled()||0==e&&0==t||(this.scrollPane.scrollLeft+=this.convertLengthToPixel(e),this.scrollPane.scrollTop+=this.convertLengthToPixel(t),this.repaint())},PlanComponent.prototype.getScale=function(){return this.scale},PlanComponent.prototype.setScale=function(e){if(this.scale!==e){var t=0,i=0;if(this.isScrolled()&&(t=this.convertXPixelToModel(this.scrollPane.clientWidth/2),i=this.convertYPixelToModel(this.scrollPane.clientHeight/2)),this.scale=e,this.revalidate(),this.isScrolled()&&!isNaN(t)){var n=this.convertPixelToLength(this.scrollPane.clientWidth),o=this.convertPixelToLength(this.scrollPane.clientHeight);this.scrollPane.scrollLeft+=this.convertXModelToPixel(t-n/2),this.scrollPane.scrollTop+=this.convertYModelToPixel(i-o/2)}}},PlanComponent.prototype.convertXPixelToModel=function(e){var t=this.getInsets(),i=this.getPlanBounds();return this.convertPixelToLength(e-t.left+(this.isScrolled()?this.scrollPane.scrollLeft:0))-PlanComponent.MARGIN+i.getMinX()},PlanComponent.prototype.convertYPixelToModel=function(e){var t=this.getInsets(),i=this.getPlanBounds();return this.convertPixelToLength(e-t.top+(this.isScrolled()?this.scrollPane.scrollTop:0))-PlanComponent.MARGIN+i.getMinY()},PlanComponent.prototype.convertPixelToLength=function(e){return e*this.getPixelLength()},PlanComponent.prototype.convertXModelToPixel=function(e){var t=this.getInsets(),i=this.getPlanBounds();return this.convertLengthToPixel(e-i.getMinX()+PlanComponent.MARGIN)+t.left-(this.isScrolled()?this.scrollPane.scrollLeft:0)},PlanComponent.prototype.convertYModelToPixel=function(e){var t=this.getInsets(),i=this.getPlanBounds();return this.convertLengthToPixel(e-i.getMinY()+PlanComponent.MARGIN)+t.top-(this.isScrolled()?this.scrollPane.scrollTop:0)},PlanComponent.prototype.convertLengthToPixel=function(e){return Math.round(e/this.getPixelLength())},PlanComponent.prototype.convertXModelToScreen=function(e){return this.canvas.getBoundingClientRect().left+this.convertXModelToPixel(e)},PlanComponent.prototype.convertYModelToScreen=function(e){return this.canvas.getBoundingClientRect().top+this.convertYModelToPixel(e)},PlanComponent.prototype.getPixelLength=function(){return 1/this.getScale()},PlanComponent.prototype.getShapePixelBounds=function(e){var t=e.getBounds2D();return new java.awt.geom.Rectangle2D.Float(this.convertXModelToPixel(t.getMinX()),this.convertYModelToPixel(t.getMinY()),this.convertLengthToPixel(t.getWidth()),this.convertLengthToPixel(t.getHeight()))},PlanComponent.prototype.setCursor=function(e){if("string"==typeof e)this.canvas.style.cursor=e;else{switch(e){case PlanView.CursorType.ROTATION:case PlanView.CursorType.HEIGHT:case PlanView.CursorType.POWER:case PlanView.CursorType.ELEVATION:case PlanView.CursorType.RESIZE:null!=this.mouseListener.longTouch&&(clearTimeout(this.mouseListener.longTouch),this.mouseListener.longTouch=null,this.stopLongTouchAnimation());case PlanView.CursorType.MOVE:this.lastTouchX&&this.lastTouchY&&this.startIndicatorAnimation(this.lastTouchX,this.lastTouchY,PlanView.CursorType[e].toLowerCase())}switch(e){case PlanView.CursorType.DRAW:this.setCursor("crosshair");break;case PlanView.CursorType.ROTATION:this.setCursor(this.rotationCursor);break;case PlanView.CursorType.HEIGHT:this.setCursor(this.heightCursor);break;case PlanView.CursorType.POWER:this.setCursor(this.powerCursor);break;case PlanView.CursorType.ELEVATION:this.setCursor(this.elevationCursor);break;case PlanView.CursorType.RESIZE:this.setCursor(this.resizeCursor);break;case PlanView.CursorType.PANNING:this.setCursor(this.panningCursor);break;case PlanView.CursorType.DUPLICATION:this.setCursor(this.duplicationCursor);break;case PlanView.CursorType.MOVE:this.setCursor(this.moveCursor);break;case PlanView.CursorType.SELECTION:default:this.setCursor("default")}}},PlanComponent.prototype.setToolTipFeedback=function(e,t,i){this.tooltip.style.width="",this.tooltip.style.marginLeft="",0===e.indexOf("<html>")?this.tooltip.style.textAlign="left":this.tooltip.style.textAlign="center",this.tooltip.innerHTML=e.replace("<html>","").replace("</html>","");var n=-(this.tooltip.clientHeight+(this.pointerType===View.PointerType.TOUCH?55:20));this.tooltip.style.marginTop=n-(this.pointerType===View.PointerType.TOUCH&&"visible"==this.touchOverlay.style.visibility?15:0)+"px";var o=this.tooltip.clientWidth+10;this.tooltip.style.width=o+"px",this.tooltip.style.marginLeft=-o/2+"px";var r=this.container.getBoundingClientRect();this.tooltip.style.left=Math.max(5+o/2,Math.min(window.innerWidth-o/2-10,r.left+this.convertXModelToPixel(t)))+"px";var l=r.top+this.convertYModelToPixel(i);this.tooltip.style.top=(l+n>15?l:l-n+(this.pointerType===View.PointerType.TOUCH?100:20))+"px",this.tooltip.style.visibility="visible"},PlanComponent.prototype.setToolTipEditedProperties=function(e,t,i,n){},PlanComponent.prototype.deleteToolTipFeedback=function(){this.tooltip.style.visibility="hidden",this.tooltip.style.width="",this.tooltip.style.marginLeft="",this.tooltip.style.marginTop=""},PlanComponent.prototype.setResizeIndicatorVisible=function(e){this.resizeIndicatorVisible=e,this.repaint()},PlanComponent.prototype.setAlignmentFeedback=function(e,t,i,n,o){this.alignedObjectClass=e,this.alignedObjectFeedback=t,this.locationFeeback=new java.awt.geom.Point2D.Float(i,n),this.showPointFeedback=o,this.repaint()},PlanComponent.prototype.setAngleFeedback=function(e,t,i,n,o,r){this.centerAngleFeedback=new java.awt.geom.Point2D.Float(e,t),this.point1AngleFeedback=new java.awt.geom.Point2D.Float(i,n),this.point2AngleFeedback=new java.awt.geom.Point2D.Float(o,r)},PlanComponent.prototype.setDraggedItemsFeedback=function(e){this.draggedItemsFeedback=e,this.repaint()},PlanComponent.prototype.setDimensionLinesFeedback=function(e){this.dimensionLinesFeedback=e,this.repaint()},PlanComponent.prototype.deleteFeedback=function(){this.deleteToolTipFeedback(),this.rectangleFeedback=null,this.alignedObjectClass=null,this.alignedObjectFeedback=null,this.locationFeeback=null,this.centerAngleFeedback=null,this.point1AngleFeedback=null,this.point2AngleFeedback=null,this.draggedItemsFeedback=null,this.dimensionLinesFeedback=null,this.repaint()},PlanComponent.prototype.canImportDraggedItems=function(e,t,i){return!0},PlanComponent.prototype.getPieceOfFurnitureSizeInPlan=function(e){return 0===e.getRoll()&&0===e.getPitch()?[e.getWidth(),e.getDepth(),e.getHeight()]:this.isFurnitureSizeInPlanSupported()?PlanComponent.PieceOfFurnitureModelIcon.computePieceOfFurnitureSizeInPlan(e,this.object3dFactory):null},PlanComponent.prototype.isFurnitureSizeInPlanSupported=function(){return PlanComponent.WEBGL_AVAILABLE},PlanComponent.prototype.dispose=function(){this.container.removeEventListener("keydown",this.keyDownListener,!1),this.container.removeEventListener("keyup",this.keyUpListener,!1),this.container.removeEventListener("focusout",this.focusOutListener),OperatingSystem.isInternetExplorerOrLegacyEdge()&&window.PointerEvent?(window.removeEventListener("pointermove",this.mouseListener.windowPointerMoved),window.removeEventListener("pointerup",this.mouseListener.windowPointerReleased)):(window.removeEventListener("mousemove",this.mouseListener.windowMouseMoved),window.removeEventListener("mouseup",this.mouseListener.windowMouseReleased)),document.body.removeChild(this.touchOverlay),document.body.removeChild(this.tooltip),window.removeEventListener("resize",this.windowResizeListener),null!=this.scrollPane&&(this.container.removeChild(this.canvas),this.container.removeChild(this.scrollPane)),this.preferences.removePropertyChangeListener("UNIT",this.preferencesListener),this.preferences.removePropertyChangeListener("LANGUAGE",this.preferencesListener),this.preferences.removePropertyChangeListener("GRID_VISIBLE",this.preferencesListener),this.preferences.removePropertyChangeListener("DEFAULT_FONT_NAME",this.preferencesListener),this.preferences.removePropertyChangeListener("FURNITURE_VIEWED_FROM_TOP",this.preferencesListener),this.preferences.removePropertyChangeListener("FURNITURE_MODEL_ICON_SIZE",this.preferencesListener),this.preferences.removePropertyChangeListener("ROOM_FLOOR_COLORED_OR_TEXTURED",this.preferencesListener),this.preferences.removePropertyChangeListener("WALL_PATTERN",this.preferencesListener)},PlanComponent.prototype.getHorizontalRuler=function(){throw new UnsupportedOperationException("No rulers")},PlanComponent.prototype.getVerticalRuler=function(){throw new UnsupportedOperationException("No rulers")},PlanComponent.PieceOfFurnitureTopViewIcon=function(e){this.image=e},PlanComponent.PieceOfFurnitureTopViewIcon.prototype.getIconWidth=function(){return this.image.naturalWidth},PlanComponent.PieceOfFurnitureTopViewIcon.prototype.getIconHeight=function(){return this.image.naturalHeight},PlanComponent.PieceOfFurnitureTopViewIcon.prototype.paintIcon=function(e,t,i){e.drawImage(this.image,t,i)},PlanComponent.PieceOfFurnitureTopViewIcon.prototype.isWaitIcon=function(){return this.image===TextureManager.getInstance().getWaitImage()},PlanComponent.PieceOfFurnitureTopViewIcon.prototype.isErrorIcon=function(){return this.image===TextureManager.getInstance().getErrorImage()},PlanComponent.PieceOfFurnitureTopViewIcon.prototype.setIcon=function(e){this.image=e},PlanComponent.PieceOfFurniturePlanIcon=function(e,t){PlanComponent.PieceOfFurnitureTopViewIcon.call(this,TextureManager.getInstance().getWaitImage());var i=this;TextureManager.getInstance().loadTexture(e.getPlanIcon(),!1,{textureUpdated:function(e){i.setIcon(e),t.repaint()},textureError:function(e){i.setIcon(TextureManager.getInstance().getErrorImage()),t.repaint()}})},PlanComponent.PieceOfFurniturePlanIcon.prototype=Object.create(PlanComponent.PieceOfFurnitureTopViewIcon.prototype),PlanComponent.PieceOfFurniturePlanIcon.prototype.constructor=PlanComponent.PieceOfFurniturePlanIcon,PlanComponent.PieceOfFurnitureModelIcon=function(e,t,i,n){PlanComponent.PieceOfFurnitureTopViewIcon.call(this,TextureManager.getInstance().getWaitImage());var o=this;ModelManager.getInstance().loadModel(e.getModel(),null===i,{modelUpdated:function(r){var l=e.clone();l.isResizable()&&0==e.getRoll()&&l.setModelMirrored(!1);var a=l.getWidthInPlan(),s=l.getDepthInPlan(),h=l.getHeightInPlan();if(l.setX(0),l.setY(0),l.setElevation(-h/2),l.setLevel(null),l.setAngle(0),null!==i){setTimeout((function(){t.createObject3D(null,l,(function(e){o.createIcon(e,a,s,h,n,(function(e){o.setIcon(e),i.repaint()}))}))}),0)}else o.setIcon(o.createIcon(t.createObject3D(null,l,!0),a,s,h,n))},modelError:function(e){o.setIcon(TextureManager.getInstance().getErrorImage()),null!==i&&i.repaint()}})},PlanComponent.PieceOfFurnitureModelIcon.prototype=Object.create(PlanComponent.PieceOfFurnitureTopViewIcon.prototype),PlanComponent.PieceOfFurnitureModelIcon.prototype.constructor=PlanComponent.PieceOfFurnitureModelIcon,PlanComponent.PieceOfFurnitureModelIcon.prototype.getSceneRoot=function(e){if(!PlanComponent.PieceOfFurnitureModelIcon.canvas3D||!PlanComponent.PieceOfFurnitureModelIcon.canvas3D[e]){var t=document.createElement("canvas");t.width=e,t.height=e,t.style.backgroundColor="rgba(0, 0, 0, 0)";var i=new HTMLCanvas3D(t),n=mat4.create();mat4.fromXRotation(n,-Math.PI/2),i.setViewPlatformTransform(n),i.setProjectionPolicy(HTMLCanvas3D.PARALLEL_PROJECTION),i.setFrontClipDistance(-1.1),i.setBackClipDistance(1.1);var o=new BranchGroup3D;o.setCapability(Group3D.ALLOW_CHILDREN_EXTEND);for(var r=[new DirectionalLight3D(vec3.fromValues(.6,.6,.6),vec3.fromValues(1.5,-.8,-1)),new DirectionalLight3D(vec3.fromValues(.6,.6,.6),vec3.fromValues(-1.5,-.8,-1)),new DirectionalLight3D(vec3.fromValues(.6,.6,.6),vec3.fromValues(0,-.8,1)),new AmbientLight3D(vec3.fromValues(.2,.2,.2))],l=0;l<r.length;l++)o.addChild(r[l]);i.setScene(o),PlanComponent.PieceOfFurnitureModelIcon.canvas3D||(PlanComponent.PieceOfFurnitureModelIcon.canvas3D={}),PlanComponent.PieceOfFurnitureModelIcon.canvas3D[e]=i}if(128!==e)for(var a in PlanComponent.PieceOfFurnitureModelIcon.canvas3D)128!=a&&a!=e&&PlanComponent.PieceOfFurnitureModelIcon.canvas3D.hasOwnProperty(a)&&(PlanComponent.PieceOfFurnitureModelIcon.canvas3D[a].clear(),delete PlanComponent.PieceOfFurnitureModelIcon.canvas3D[a]);return PlanComponent.PieceOfFurnitureModelIcon.canvas3D[e].getScene()},PlanComponent.PieceOfFurnitureModelIcon.prototype.createIcon=function(e,t,i,n,o,r){var l=mat4.create();mat4.scale(l,l,vec3.fromValues(2/t,2/n,2/i));var a=new TransformGroup3D;a.setTransform(l),null!=e.getParent()&&e.getParent().removeChild(e),a.addChild(e);var s=new BranchGroup3D;s.addChild(a);var h=this.getSceneRoot(o);if(!r){h.addChild(s);var u=PlanComponent.PieceOfFurnitureModelIcon.canvas3D[o].getImage();return h.removeChild(s),u}var d=Date.now(),c=function(){h.addChild(s);var e=PlanComponent.PieceOfFurnitureModelIcon.canvas3D[o].isLoadingCompleted();(e||Date.now()-d>5e3)&&PlanComponent.PieceOfFurnitureModelIcon.canvas3D[o].getImage(r),h.removeChild(s),e||setTimeout(c,0)};c()},PlanComponent.PieceOfFurnitureModelIcon.computePieceOfFurnitureSizeInPlan=function(e,t){var i=mat4.create();if(0!==e.getPitch()&&mat4.fromXRotation(i,-e.getPitch()),0!==e.getRoll()){var n=mat4.create();mat4.fromZRotation(n,-e.getRoll()),mat4.mul(i,i,n,i)}(e=e.clone()).setX(0),e.setY(0),e.setElevation(-e.getHeight()/2),e.setLevel(null),e.setAngle(0),e.setRoll(0),e.setPitch(0),e.setWidthInPlan(e.getWidth()),e.setDepthInPlan(e.getDepth()),e.setHeightInPlan(e.getHeight());var o=ModelManager.getInstance().getBounds(t.createObject3D(null,e,!0),i),r=vec3.create();o.getLower(r);var l=vec3.create();return o.getUpper(l),[Math.max(.001,l[0]-r[0]),Math.max(.001,l[2]-r[2]),Math.max(.001,l[1]-r[1])]},PlanComponent.HomePieceOfFurnitureTopViewIconKey=function(e){var t;this.piece=e,this.hashCode=(null!=e.getPlanIcon()?e.getPlanIcon().hashCode():e.getModel().hashCode())+(null!=e.getColor()?37*e.getColor():1234),(e.isHorizontallyRotated()||null!=e.getTexture())&&(this.hashCode+=(null!=e.getTexture()?37*e.getTexture().hashCode():0)+37*(0|e.getWidthInPlan())+37*(0|e.getDepthInPlan())+37*(0|e.getHeightInPlan())),0!=e.getRoll()&&(this.hashCode+=37*(e.isModelMirrored()?1231:1237)),null!=e.getPlanIcon()&&(this.hashCode+=37*(31*(t=e.getModelRotation())[0][0]+31*t[0][1]+31*t[0][2]+37*t[1][0]+37*t[1][1]+37*t[1][2]+41*t[2][0]+41*t[2][1]+41*t[2][2]|0)+37*(e.isModelCenteredAtOrigin()?1:0)+37*(e.isBackFaceShown()?1:0)+37*(1e3*e.getPitch()|0)+37*(1e3*e.getRoll()|0)+37*function(e){var t=0;if(null!=e)for(var i=0;i<e.length;i++)null!=e[i]&&(t+=37*e[i].hashCode());return 0|t}(e.getModelTransformations())+37*function(e){var t=0;if(null!=e)for(var i=0;i<e.length;i++)null!=e[i]&&(t+=37*e[i].hashCode());return 0|t}(e.getModelMaterials())+(null!=e.getShininess()?37*(1e3*e.getShininess()|0):3456))},PlanComponent.HomePieceOfFurnitureTopViewIconKey.prototype.equals=function(e){if(e instanceof PlanComponent.HomePieceOfFurnitureTopViewIconKey){var t=e.piece;return(null!=this.piece.getPlanIcon()?this.piece.getPlanIcon().equals(t.getPlanIcon()):this.piece.getModel().equals(t.getModel()))&&this.piece.getColor()==t.getColor()&&(this.piece.getTexture()==t.getTexture()||null!=this.piece.getTexture()&&this.piece.getTexture().equals(t.getTexture()))&&(!this.piece.isHorizontallyRotated()&&!t.isHorizontallyRotated()&&null==this.piece.getTexture()&&null==t.getTexture()||this.piece.getWidthInPlan()==t.getWidthInPlan()&&this.piece.getDepthInPlan()==t.getDepthInPlan()&&this.piece.getHeightInPlan()==t.getHeightInPlan())&&(0==this.piece.getRoll()&&0==t.getRoll()||this.piece.isModelMirrored()==t.isModelMirrored())&&(null!=this.piece.getPlanIcon()||(i=this.piece.getModelRotation(),n=t.getModelRotation(),i[0][0]==n[0][0]&&i[0][1]==n[0][1]&&i[0][2]==n[0][2]&&i[1][0]==n[1][0]&&i[1][1]==n[1][1]&&i[1][2]==n[1][2]&&i[2][0]==n[2][0]&&i[2][1]==n[2][1]&&i[2][2]==n[2][2]&&this.piece.isModelCenteredAtOrigin()==t.isModelCenteredAtOrigin()&&this.piece.isBackFaceShown()==t.isBackFaceShown()&&this.piece.getPitch()==t.getPitch()&&this.piece.getRoll()==t.getRoll()&&function(e,t){if(e===t)return!0;if(null==e||null==t||e.length!==t.length)return!1;for(var i=0;i<e.length;i++)if(e[i]!==t[i]&&(null==e[i]||!e[i].equals(t[i])))return!1;return!0}(this.piece.getModelTransformations(),t.getModelTransformations())&&function(e,t){if(e===t)return!0;if(null==e||null==t||e.length!==t.length)return!1;for(var i=0;i<e.length;i++)if(e[i]!==t[i]&&(null==e[i]||!e[i].equals(t[i])))return!1;return!0}(this.piece.getModelMaterials(),t.getModelMaterials())&&this.piece.getShininess()==t.getShininess()))}return!1;var i,n},PlanComponent.HomePieceOfFurnitureTopViewIconKey.prototype.hashCode=function(){return this.hashCode},HomePane.__class="HomePane",HomePane.__interfaces=["com.eteks.sweethome3d.viewcontroller.HomeView","com.eteks.sweethome3d.viewcontroller.View"],HomePane.MAIN_PANE_DIVIDER_LOCATION_VISUAL_PROPERTY="com.eteks.sweethome3d.SweetHome3D.MainPaneDividerLocation",HomePane.CATALOG_PANE_DIVIDER_LOCATION_VISUAL_PROPERTY="com.eteks.sweethome3d.SweetHome3D.CatalogPaneDividerLocation",HomePane.PLAN_PANE_DIVIDER_LOCATION_VISUAL_PROPERTY="com.eteks.sweethome3d.SweetHome3D.PlanPaneDividerLocation",HomePane.PLAN_VIEWPORT_X_VISUAL_PROPERTY="com.eteks.sweethome3d.SweetHome3D.PlanViewportX",HomePane.PLAN_VIEWPORT_Y_VISUAL_PROPERTY="com.eteks.sweethome3d.SweetHome3D.PlanViewportY",HomePane.FURNITURE_VIEWPORT_Y_VISUAL_PROPERTY="com.eteks.sweethome3d.SweetHome3D.FurnitureViewportY",HomePane.DETACHED_VIEW_VISUAL_PROPERTY=".detachedView",HomePane.DETACHED_VIEW_DIVIDER_LOCATION_VISUAL_PROPERTY=".detachedViewDividerLocation",HomePane.DETACHED_VIEW_X_VISUAL_PROPERTY=".detachedViewX",HomePane.DETACHED_VIEW_Y_VISUAL_PROPERTY=".detachedViewY",HomePane.DETACHED_VIEW_WIDTH_VISUAL_PROPERTY=".detachedViewWidth",HomePane.DETACHED_VIEW_HEIGHT_VISUAL_PROPERTY=".detachedViewHeight",HomePane.MenuActionType={},HomePane.MenuActionType[HomePane.MenuActionType.FILE_MENU=0]="FILE_MENU",HomePane.MenuActionType[HomePane.MenuActionType.EDIT_MENU=1]="EDIT_MENU",HomePane.MenuActionType[HomePane.MenuActionType.FURNITURE_MENU=2]="FURNITURE_MENU",HomePane.MenuActionType[HomePane.MenuActionType.PLAN_MENU=3]="PLAN_MENU",HomePane.MenuActionType[HomePane.MenuActionType.VIEW_3D_MENU=4]="VIEW_3D_MENU",HomePane.MenuActionType[HomePane.MenuActionType.HELP_MENU=5]="HELP_MENU",HomePane.MenuActionType[HomePane.MenuActionType.OPEN_RECENT_HOME_MENU=6]="OPEN_RECENT_HOME_MENU",HomePane.MenuActionType[HomePane.MenuActionType.ALIGN_OR_DISTRIBUTE_MENU=7]="ALIGN_OR_DISTRIBUTE_MENU",HomePane.MenuActionType[HomePane.MenuActionType.SORT_HOME_FURNITURE_MENU=8]="SORT_HOME_FURNITURE_MENU",HomePane.MenuActionType[HomePane.MenuActionType.DISPLAY_HOME_FURNITURE_PROPERTY_MENU=9]="DISPLAY_HOME_FURNITURE_PROPERTY_MENU",HomePane.MenuActionType[HomePane.MenuActionType.MODIFY_TEXT_STYLE=10]="MODIFY_TEXT_STYLE",HomePane.MenuActionType[HomePane.MenuActionType.GO_TO_POINT_OF_VIEW=11]="GO_TO_POINT_OF_VIEW",HomePane.MenuActionType[HomePane.MenuActionType.SELECT_OBJECT_MENU=12]="SELECT_OBJECT_MENU",HomePane.MenuActionType[HomePane.MenuActionType.TOGGLE_SELECTION_MENU=13]="TOGGLE_SELECTION_MENU",HomePane.prototype.getHTMLElement=function(){return this.container},HomePane.prototype.getActionMap=function(){return this.actionMap},HomePane.prototype.getAction=function(e){return"string"==typeof e?this.actionMap[e]:this.actionMap[HomeView.ActionType[e]]},HomePane.prototype.createActions=function(e,t,i){var n=HomeView.ActionType;this.createAction(n.NEW_HOME,t,i,"newHome"),this.createAction(n.NEW_HOME_FROM_EXAMPLE,t,i,"newHomeFromExample"),this.createAction(n.OPEN,t,i,"open"),this.createAction(n.DELETE_RECENT_HOMES,t,i,"deleteRecentHomes"),this.createAction(n.CLOSE,t,i,"close"),this.createAction(n.SAVE,t,i,"save"),this.createAction(n.SAVE_AS,t,i,"saveAs"),this.createAction(n.SAVE_AND_COMPRESS,t,i,"saveAndCompress"),this.createAction(n.PAGE_SETUP,t,i,"setupPage"),this.createAction(n.PRINT_PREVIEW,t,i,"previewPrint"),this.createAction(n.PRINT,t,i,"print"),this.createAction(n.PRINT_TO_PDF,t,i,"printToPDF"),this.createAction(n.PREFERENCES,t,i,"editPreferences"),this.createAction(n.EXIT,t,i,"exit"),this.createAction(n.UNDO,t,i,"undo"),this.createAction(n.REDO,t,i,"redo"),this.createClipboardAction(n.CUT,t,null,!0),this.createClipboardAction(n.COPY,t,null,!0),this.createClipboardAction(n.PASTE,t,null,!1),this.createAction(n.PASTE_TO_GROUP,t,i,"pasteToGroup"),this.createAction(n.PASTE_STYLE,t,i,"pasteStyle"),this.createAction(n.DELETE,t,i,"delete"),this.createAction(n.SELECT_ALL,t,i,"selectAll"),this.createAction(n.ADD_HOME_FURNITURE,t,i,"addHomeFurniture"),this.createAction(n.ADD_FURNITURE_TO_GROUP,t,i,"addFurnitureToGroup");var o=i.getFurnitureController();this.createAction(n.DELETE_HOME_FURNITURE,t,o,"deleteSelection"),this.createAction(n.MODIFY_FURNITURE,t,i,"modifySelectedFurniture"),this.createAction(n.GROUP_FURNITURE,t,o,"groupSelectedFurniture"),this.createAction(n.UNGROUP_FURNITURE,t,o,"ungroupSelectedFurniture"),this.createAction(n.ALIGN_FURNITURE_ON_TOP,t,o,"alignSelectedFurnitureOnTop"),this.createAction(n.ALIGN_FURNITURE_ON_BOTTOM,t,o,"alignSelectedFurnitureOnBottom"),this.createAction(n.ALIGN_FURNITURE_ON_LEFT,t,o,"alignSelectedFurnitureOnLeft"),this.createAction(n.ALIGN_FURNITURE_ON_RIGHT,t,o,"alignSelectedFurnitureOnRight"),this.createAction(n.ALIGN_FURNITURE_ON_FRONT_SIDE,t,o,"alignSelectedFurnitureOnFrontSide"),this.createAction(n.ALIGN_FURNITURE_ON_BACK_SIDE,t,o,"alignSelectedFurnitureOnBackSide"),this.createAction(n.ALIGN_FURNITURE_ON_LEFT_SIDE,t,o,"alignSelectedFurnitureOnLeftSide"),this.createAction(n.ALIGN_FURNITURE_ON_RIGHT_SIDE,t,o,"alignSelectedFurnitureOnRightSide"),this.createAction(n.ALIGN_FURNITURE_SIDE_BY_SIDE,t,o,"alignSelectedFurnitureSideBySide"),this.createAction(n.DISTRIBUTE_FURNITURE_HORIZONTALLY,t,o,"distributeSelectedFurnitureHorizontally"),this.createAction(n.DISTRIBUTE_FURNITURE_VERTICALLY,t,o,"distributeSelectedFurnitureVertically"),this.createAction(n.RESET_FURNITURE_ELEVATION,t,o,"resetFurnitureElevation");var r=i.getHomeController3D();null!=r.getView()&&this.createAction(n.IMPORT_FURNITURE,t,i,"importFurniture"),this.createAction(n.IMPORT_FURNITURE_LIBRARY,t,i,"importFurnitureLibrary"),this.createAction(n.IMPORT_TEXTURE,t,i,"importTexture"),this.createAction(n.IMPORT_TEXTURES_LIBRARY,t,i,"importTexturesLibrary"),this.createAction(n.SORT_HOME_FURNITURE_BY_CATALOG_ID,t,o,"toggleFurnitureSort","CATALOG_ID"),this.createAction(n.SORT_HOME_FURNITURE_BY_NAME,t,o,"toggleFurnitureSort","NAME"),this.createAction(n.SORT_HOME_FURNITURE_BY_DESCRIPTION,t,o,"toggleFurnitureSort","DESCRIPTION"),this.createAction(n.SORT_HOME_FURNITURE_BY_CREATOR,t,o,"toggleFurnitureSort","CREATOR"),this.createAction(n.SORT_HOME_FURNITURE_BY_LICENSE,t,o,"toggleFurnitureSort","LICENSE"),this.createAction(n.SORT_HOME_FURNITURE_BY_WIDTH,t,o,"toggleFurnitureSort","WIDTH"),this.createAction(n.SORT_HOME_FURNITURE_BY_DEPTH,t,o,"toggleFurnitureSort","DEPTH"),this.createAction(n.SORT_HOME_FURNITURE_BY_HEIGHT,t,o,"toggleFurnitureSort","HEIGHT"),this.createAction(n.SORT_HOME_FURNITURE_BY_X,t,o,"toggleFurnitureSort","X"),this.createAction(n.SORT_HOME_FURNITURE_BY_Y,t,o,"toggleFurnitureSort","Y"),this.createAction(n.SORT_HOME_FURNITURE_BY_ELEVATION,t,o,"toggleFurnitureSort","ELEVATION"),this.createAction(n.SORT_HOME_FURNITURE_BY_ANGLE,t,o,"toggleFurnitureSort","ANGLE"),this.createAction(n.SORT_HOME_FURNITURE_BY_LEVEL,t,o,"toggleFurnitureSort","LEVEL"),this.createAction(n.SORT_HOME_FURNITURE_BY_MODEL_SIZE,t,o,"toggleFurnitureSort","MODEL_SIZE"),this.createAction(n.SORT_HOME_FURNITURE_BY_COLOR,t,o,"toggleFurnitureSort","COLOR"),this.createAction(n.SORT_HOME_FURNITURE_BY_TEXTURE,t,o,"toggleFurnitureSort","TEXTURE"),this.createAction(n.SORT_HOME_FURNITURE_BY_MOVABILITY,t,o,"toggleFurnitureSort","MOVABLE"),this.createAction(n.SORT_HOME_FURNITURE_BY_TYPE,t,o,"toggleFurnitureSort","DOOR_OR_WINDOW"),this.createAction(n.SORT_HOME_FURNITURE_BY_VISIBILITY,t,o,"toggleFurnitureSort","VISIBLE"),this.createAction(n.SORT_HOME_FURNITURE_BY_PRICE,t,o,"toggleFurnitureSort","PRICE"),this.createAction(n.SORT_HOME_FURNITURE_BY_VALUE_ADDED_TAX_PERCENTAGE,t,o,"toggleFurnitureSort","VALUE_ADDED_TAX_PERCENTAGE"),this.createAction(n.SORT_HOME_FURNITURE_BY_VALUE_ADDED_TAX,t,o,"toggleFurnitureSort","VALUE_ADDED_TAX"),this.createAction(n.SORT_HOME_FURNITURE_BY_PRICE_VALUE_ADDED_TAX_INCLUDED,t,o,"toggleFurnitureSort","PRICE_VALUE_ADDED_TAX_INCLUDED"),this.createAction(n.SORT_HOME_FURNITURE_BY_DESCENDING_ORDER,t,o,"toggleFurnitureSortOrder"),this.createAction(n.DISPLAY_HOME_FURNITURE_CATALOG_ID,t,o,"toggleFurnitureVisibleProperty","CATALOG_ID"),this.createAction(n.DISPLAY_HOME_FURNITURE_NAME,t,o,"toggleFurnitureVisibleProperty","NAME"),this.createAction(n.DISPLAY_HOME_FURNITURE_DESCRIPTION,t,o,"toggleFurnitureVisibleProperty","DESCRIPTION"),this.createAction(n.DISPLAY_HOME_FURNITURE_CREATOR,t,o,"toggleFurnitureVisibleProperty","CREATOR"),this.createAction(n.DISPLAY_HOME_FURNITURE_LICENSE,t,o,"toggleFurnitureVisibleProperty","LICENSE"),this.createAction(n.DISPLAY_HOME_FURNITURE_WIDTH,t,o,"toggleFurnitureVisibleProperty","WIDTH"),this.createAction(n.DISPLAY_HOME_FURNITURE_DEPTH,t,o,"toggleFurnitureVisibleProperty","DEPTH"),this.createAction(n.DISPLAY_HOME_FURNITURE_HEIGHT,t,o,"toggleFurnitureVisibleProperty","HEIGHT"),this.createAction(n.DISPLAY_HOME_FURNITURE_X,t,o,"toggleFurnitureVisibleProperty","X"),this.createAction(n.DISPLAY_HOME_FURNITURE_Y,t,o,"toggleFurnitureVisibleProperty","Y"),this.createAction(n.DISPLAY_HOME_FURNITURE_ELEVATION,t,o,"toggleFurnitureVisibleProperty","ELEVATION"),this.createAction(n.DISPLAY_HOME_FURNITURE_ANGLE,t,o,"toggleFurnitureVisibleProperty","ANGLE"),this.createAction(n.DISPLAY_HOME_FURNITURE_LEVEL,t,o,"toggleFurnitureVisibleProperty","LEVEL"),this.createAction(n.DISPLAY_HOME_FURNITURE_MODEL_SIZE,t,o,"toggleFurnitureVisibleProperty","MODEL_SIZE"),this.createAction(n.DISPLAY_HOME_FURNITURE_COLOR,t,o,"toggleFurnitureVisibleProperty","COLOR"),this.createAction(n.DISPLAY_HOME_FURNITURE_TEXTURE,t,o,"toggleFurnitureVisibleProperty","TEXTURE"),this.createAction(n.DISPLAY_HOME_FURNITURE_MOVABLE,t,o,"toggleFurnitureVisibleProperty","MOVABLE"),this.createAction(n.DISPLAY_HOME_FURNITURE_DOOR_OR_WINDOW,t,o,"toggleFurnitureVisibleProperty","DOOR_OR_WINDOW"),this.createAction(n.DISPLAY_HOME_FURNITURE_VISIBLE,t,o,"toggleFurnitureVisibleProperty","VISIBLE"),this.createAction(n.DISPLAY_HOME_FURNITURE_PRICE,t,o,"toggleFurnitureVisibleProperty","PRICE"),this.createAction(n.DISPLAY_HOME_FURNITURE_VALUE_ADDED_TAX_PERCENTAGE,t,o,"toggleFurnitureVisibleProperty","VALUE_ADDED_TAX_PERCENTAGE"),this.createAction(n.DISPLAY_HOME_FURNITURE_VALUE_ADDED_TAX,t,o,"toggleFurnitureVisibleProperty","VALUE_ADDED_TAX"),this.createAction(n.DISPLAY_HOME_FURNITURE_PRICE_VALUE_ADDED_TAX_INCLUDED,t,o,"toggleFurnitureVisibleProperty","PRICE_VALUE_ADDED_TAX_INCLUDED"),this.createAction(n.EXPORT_TO_CSV,t,i,"exportToCSV");var l=i.getPlanController();if(null!=l.getView()){this.createAction(n.SELECT_ALL_AT_ALL_LEVELS,t,l,"selectAllAtAllLevels");var a=[];this.createToggleAction(n.SELECT,l.getMode()==PlanController.Mode.SELECTION,a,t,i,"setMode",PlanController.Mode.SELECTION),this.createToggleAction(n.PAN,l.getMode()==PlanController.Mode.PANNING,a,t,i,"setMode",PlanController.Mode.PANNING),this.createToggleAction(n.CREATE_WALLS,l.getMode()==PlanController.Mode.WALL_CREATION,a,t,i,"setMode",PlanController.Mode.WALL_CREATION),this.createToggleAction(n.CREATE_ROOMS,l.getMode()==PlanController.Mode.ROOM_CREATION,a,t,i,"setMode",PlanController.Mode.ROOM_CREATION),this.createToggleAction(n.CREATE_POLYLINES,l.getMode()==PlanController.Mode.POLYLINE_CREATION,a,t,i,"setMode",PlanController.Mode.POLYLINE_CREATION),this.createToggleAction(n.CREATE_DIMENSION_LINES,l.getMode()==PlanController.Mode.DIMENSION_LINE_CREATION,a,t,i,"setMode",PlanController.Mode.DIMENSION_LINE_CREATION),this.createToggleAction(n.CREATE_LABELS,l.getMode()==PlanController.Mode.LABEL_CREATION,a,t,i,"setMode",PlanController.Mode.LABEL_CREATION),this.createAction(n.DELETE_SELECTION,t,l,"deleteSelection"),this.createAction(n.LOCK_BASE_PLAN,t,l,"lockBasePlan"),this.createAction(n.UNLOCK_BASE_PLAN,t,l,"unlockBasePlan"),this.createAction(n.ENABLE_MAGNETISM,t,i,"enableMagnetism"),this.createAction(n.DISABLE_MAGNETISM,t,i,"disableMagnetism"),this.createAction(n.FLIP_HORIZONTALLY,t,l,"flipHorizontally"),this.createAction(n.FLIP_VERTICALLY,t,l,"flipVertically"),this.createAction(n.MODIFY_COMPASS,t,l,"modifyCompass"),this.createAction(n.MODIFY_WALL,t,l,"modifySelectedWalls"),this.createAction(n.MODIFY_ROOM,t,l,"modifySelectedRooms"),this.createAction(n.JOIN_WALLS,t,l,"joinSelectedWalls"),this.createAction(n.REVERSE_WALL_DIRECTION,t,l,"reverseSelectedWallsDirection"),this.createAction(n.SPLIT_WALL,t,l,"splitSelectedWall"),this.createAction(n.ADD_ROOM_POINT,t),this.createAction(n.DELETE_ROOM_POINT,t),this.createAction(n.MODIFY_POLYLINE,t,l,"modifySelectedPolylines"),this.createAction(n.MODIFY_DIMENSION_LINE,t,l,"modifySelectedDimensionLines"),this.createAction(n.MODIFY_LABEL,t,l,"modifySelectedLabels"),this.createAction(n.INCREASE_TEXT_SIZE,t,l,"increaseTextSize"),this.createAction(n.DECREASE_TEXT_SIZE,t,l,"decreaseTextSize");this.createBoldStyleAction(n.TOGGLE_BOLD_STYLE,e,t,l,"toggleBoldStyle"),this.createItalicStyleToggleModel(n.TOGGLE_ITALIC_STYLE,e,t,l,"toggleItalicStyle");this.createAction(n.IMPORT_BACKGROUND_IMAGE,t,i,"importBackgroundImage"),this.createAction(n.MODIFY_BACKGROUND_IMAGE,t,i,"modifyBackgroundImage"),this.createAction(n.HIDE_BACKGROUND_IMAGE,t,i,"hideBackgroundImage"),this.createAction(n.SHOW_BACKGROUND_IMAGE,t,i,"showBackgroundImage"),this.createAction(n.DELETE_BACKGROUND_IMAGE,t,i,"deleteBackgroundImage"),this.createAction(n.ADD_LEVEL,t,l,"addLevel"),this.createAction(n.ADD_LEVEL_AT_SAME_ELEVATION,t,l,"addLevelAtSameElevation"),this.createAction(n.MAKE_LEVEL_VIEWABLE,t,l,"toggleSelectedLevelViewability"),this.createAction(n.MAKE_LEVEL_UNVIEWABLE,t,l,"toggleSelectedLevelViewability"),this.createAction(n.MAKE_LEVEL_ONLY_VIEWABLE_ONE,t,l,"setSelectedLevelOnlyViewable"),this.createAction(n.MAKE_ALL_LEVELS_VIEWABLE,t,l,"setAllLevelsViewable"),this.createAction(n.MODIFY_LEVEL,t,l,"modifySelectedLevel"),this.createAction(n.DELETE_LEVEL,t,l,"deleteSelectedLevel"),this.createAction(n.ZOOM_IN,t,i,"zoomIn"),this.createAction(n.ZOOM_OUT,t,i,"zoomOut"),this.createAction(n.EXPORT_TO_SVG,t,i,"exportToSVG")}if(null!=r.getView()){this.createAction(n.SELECT_OBJECT,t),this.createAction(n.TOGGLE_SELECTION,t);var s=[];this.createToggleAction(n.VIEW_FROM_TOP,e.getCamera()==e.getTopCamera(),s,t,r,"viewFromTop"),this.createToggleAction(n.VIEW_FROM_OBSERVER,e.getCamera()==e.getObserverCamera(),s,t,r,"viewFromObserver"),this.createAction(n.MODIFY_OBSERVER,t,l,"modifyObserverCamera"),this.createAction(n.STORE_POINT_OF_VIEW,t,i,"storeCamera"),this.createAction(n.DELETE_POINTS_OF_VIEW,t,i,"deleteCameras"),this.createAction(n.DETACH_3D_VIEW,t,i,"detachView",i.getHomeController3D().getView()),this.createAction(n.ATTACH_3D_VIEW,t,i,"attachView",i.getHomeController3D().getView());var h=e.getEnvironment().isAllLevelsVisible(),u=[];this.createToggleAction(n.DISPLAY_ALL_LEVELS,h,u,t,r,"displayAllLevels"),this.createToggleAction(n.DISPLAY_SELECTED_LEVEL,!h,u,t,r,"displaySelectedLevel"),this.createAction(n.MODIFY_3D_ATTRIBUTES,t,r,"modifyAttributes"),this.createAction(n.CREATE_PHOTO,t,i,"createPhoto"),this.createAction(n.CREATE_PHOTOS_AT_POINTS_OF_VIEW,t,i,"createPhotos"),this.createAction(n.CREATE_VIDEO,t,i,"createVideo"),this.createAction(n.EXPORT_TO_OBJ,t,i,"exportToOBJ")}this.createAction(n.HELP,t,i,"help"),this.createAction(n.ABOUT,t,i,"about");var d=new ResourceAction(t,"HomePane","SHOW_APPLICATION_MENU",!0);null==d.getValue(AbstractAction.SMALL_ICON)&&(d.putValue(AbstractAction.NAME,"SHOW_APPLICATION_MENU"),d.putValue(AbstractAction.SMALL_ICON,"menu.png"));var c=this;d.actionPerformed=function(e){e.stopPropagation(),e.preventDefault();i.getPlanController().getView().getHTMLElement();var t=document.createEvent("Event");t.initEvent("contextmenu",!0,!0),t.clientX=c.showApplicationMenuButton.clientX+c.showApplicationMenuButton.clientWidth/2,t.clientY=c.showApplicationMenuButton.clientY+c.showApplicationMenuButton.clientHeight/2,c.showApplicationMenuButton.dispatchEvent(t)},this.getActionMap().SHOW_APPLICATION_MENU=d},HomePane.prototype.createAction=function(e,t,i,n){for(var o=[],r=4;r<arguments.length;r++)o[r-4]=arguments[r];try{var l=new ResourceAction(t,HomePane,HomeView.ActionType[e],!1,i,n,o);return this.getActionMap()[HomeView.ActionType[e]]=l,l}catch(e){console.log(e)}},HomePane.prototype.createToggleAction=function(e,t,i,n,o,r){for(var l=[],a=6;a<arguments.length;a++)l[a-6]=arguments[a];var s=this.createAction.apply(this,[e,n,o,r].concat(l));return null!=i&&(i.push(s),s.putValue(ResourceAction.TOGGLE_BUTTON_GROUP,i),s.putValue(AbstractAction.SELECTED_KEY,t),s.addPropertyChangeListener((function(e){if(e.getPropertyName()==AbstractAction.SELECTED_KEY)if(e.getNewValue())for(var t=e.getSource().getValue(ResourceAction.TOGGLE_BUTTON_GROUP),i=0;i<t.length;i++)s!==t[i]&&t[i].getValue(AbstractAction.SELECTED_KEY)&&t[i].putValue(AbstractAction.SELECTED_KEY,!1);else e.getSource().putValue(AbstractAction.SELECTED_KEY,!1)}))),s},HomePane.prototype.createClipboardAction=function(e,t,i,n){var o=this.createAction(e,t),r=this;o.actionPerformed=function(t){switch(n&&(r.clipboard=Home.duplicate(r.home.getSelectedItems()),r.clipboardEmpty=!1,r.controller.enablePasteAction()),e){case HomeView.ActionType.CUT:r.controller.cut(r.home.getSelectedItems());break;case HomeView.ActionType.COPY:break;case HomeView.ActionType.PASTE:r.controller.paste(Home.duplicate(r.clipboard))}return o}},HomePane.prototype.getMenuAction=function(e){return new ResourceAction(this.preferences,HomePane,HomePane.MenuActionType[e],!0)},HomePane.prototype.addHomeListener=function(e){var t=this;e.addPropertyChangeListener("CAMERA",(function(i){t.setToggleButtonModelSelected(HomeView.ActionType.VIEW_FROM_TOP,e.getCamera()==e.getTopCamera()),t.setToggleButtonModelSelected(HomeView.ActionType.VIEW_FROM_OBSERVER,e.getCamera()==e.getObserverCamera())}))},HomePane.prototype.setToggleButtonModelSelected=function(e,t){this.getAction(e).putValue(AbstractAction.SELECTED_KEY,t)},HomePane.prototype.addLevelVisibilityListener=function(e){var t=this;e.getEnvironment().addPropertyChangeListener("ALL_LEVELS_VISIBLE",(function(i){var n=e.getEnvironment().isAllLevelsVisible();t.setToggleButtonModelSelected(HomeView.ActionType.DISPLAY_ALL_LEVELS,n),t.setToggleButtonModelSelected(HomeView.ActionType.DISPLAY_SELECTED_LEVEL,!n)}))},HomePane.prototype.addUserPreferencesListener=function(e){this.preferencesChangeListener=new HomePane.UserPreferencesChangeListener(this),e.addPropertyChangeListener("CURRENCY",this.preferencesChangeListener),e.addPropertyChangeListener("VALUE_ADDED_TAX_ENABLED",this.preferencesChangeListener)},HomePane.UserPreferencesChangeListener=function(e){this.homePane=e},HomePane.UserPreferencesChangeListener.prototype.propertyChange=function(e){var t=HomeView.ActionType,i=this.homePane,n=e.getSource(),o=e.getPropertyName();if(null==i)n.removePropertyChangeListener(o,this);else switch(o){case"CURRENCY":i.getAction(t.DISPLAY_HOME_FURNITURE_PRICE).putValue(ResourceAction.VISIBLE,null!=e.getNewValue()),i.getAction(t.SORT_HOME_FURNITURE_BY_PRICE).putValue(ResourceAction.VISIBLE,null!=e.getNewValue());break;case"VALUE_ADDED_TAX_ENABLED":i.getAction(t.DISPLAY_HOME_FURNITURE_VALUE_ADDED_TAX_PERCENTAGE).putValue(ResourceAction.VISIBLE,1==e.getNewValue()),i.getAction(t.DISPLAY_HOME_FURNITURE_VALUE_ADDED_TAX).putValue(ResourceAction.VISIBLE,1==e.getNewValue()),i.getAction(t.DISPLAY_HOME_FURNITURE_PRICE_VALUE_ADDED_TAX_INCLUDED).putValue(ResourceAction.VISIBLE,1==e.getNewValue()),i.getAction(t.SORT_HOME_FURNITURE_BY_VALUE_ADDED_TAX_PERCENTAGE).putValue(ResourceAction.VISIBLE,1==e.getNewValue()),i.getAction(t.SORT_HOME_FURNITURE_BY_VALUE_ADDED_TAX).putValue(ResourceAction.VISIBLE,1==e.getNewValue()),i.getAction(t.SORT_HOME_FURNITURE_BY_PRICE_VALUE_ADDED_TAX_INCLUDED).putValue(ResourceAction.VISIBLE,1==e.getNewValue())}},HomePane.prototype.initActions=function(e){this.getAction(HomeView.ActionType.DISPLAY_HOME_FURNITURE_CATALOG_ID).putValue(ResourceAction.VISIBLE,!1),this.getAction(HomeView.ActionType.SORT_HOME_FURNITURE_BY_CATALOG_ID).putValue(ResourceAction.VISIBLE,!1),this.getAction(HomeView.ActionType.DISPLAY_HOME_FURNITURE_PRICE).putValue(ResourceAction.VISIBLE,null!=e.getCurrency()),this.getAction(HomeView.ActionType.SORT_HOME_FURNITURE_BY_PRICE).putValue(ResourceAction.VISIBLE,null!=e.getCurrency()),this.getAction(HomeView.ActionType.DISPLAY_HOME_FURNITURE_VALUE_ADDED_TAX_PERCENTAGE).putValue(ResourceAction.VISIBLE,e.isValueAddedTaxEnabled()),this.getAction(HomeView.ActionType.DISPLAY_HOME_FURNITURE_VALUE_ADDED_TAX).putValue(ResourceAction.VISIBLE,e.isValueAddedTaxEnabled()),this.getAction(HomeView.ActionType.DISPLAY_HOME_FURNITURE_PRICE_VALUE_ADDED_TAX_INCLUDED).putValue(ResourceAction.VISIBLE,e.isValueAddedTaxEnabled()),this.getAction(HomeView.ActionType.SORT_HOME_FURNITURE_BY_VALUE_ADDED_TAX_PERCENTAGE).putValue(ResourceAction.VISIBLE,e.isValueAddedTaxEnabled()),this.getAction(HomeView.ActionType.SORT_HOME_FURNITURE_BY_VALUE_ADDED_TAX).putValue(ResourceAction.VISIBLE,e.isValueAddedTaxEnabled()),this.getAction(HomeView.ActionType.SORT_HOME_FURNITURE_BY_PRICE_VALUE_ADDED_TAX_INCLUDED).putValue(ResourceAction.VISIBLE,e.isValueAddedTaxEnabled())},HomePane.prototype.addPlanControllerListener=function(e){var t=this;e.addPropertyChangeListener("MODE",(function(i){var n=e.getMode();t.setToggleButtonModelSelected(HomeView.ActionType.SELECT,n==PlanController.Mode.SELECTION),t.setToggleButtonModelSelected(HomeView.ActionType.PAN,n==PlanController.Mode.PANNING),t.setToggleButtonModelSelected(HomeView.ActionType.CREATE_WALLS,n==PlanController.Mode.WALL_CREATION),t.setToggleButtonModelSelected(HomeView.ActionType.CREATE_ROOMS,n==PlanController.Mode.ROOM_CREATION),t.setToggleButtonModelSelected(HomeView.ActionType.CREATE_POLYLINES,n==PlanController.Mode.POLYLINE_CREATION),t.setToggleButtonModelSelected(HomeView.ActionType.CREATE_DIMENSION_LINES,n==PlanController.Mode.DIMENSION_LINE_CREATION),t.setToggleButtonModelSelected(HomeView.ActionType.CREATE_LABELS,n==PlanController.Mode.LABEL_CREATION)}))},HomePane.prototype.addFocusListener=function(){var e=this;this.focusListener=function(t){for(var i=[e.controller.getPlanController().getView(),e.controller.getHomeController3D().getView()],n=0;n<i.length;n++)for(var o=t.target;null!==o;o=o.parentElement)if(o===i[n].getHTMLElement())return void e.controller.focusedViewChanged(i[n])},this.getHTMLElement().addEventListener("focusin",this.focusListener)},HomePane.prototype.addActionToMenu=function(e,t){var i=this.getAction(e);null!=i&&null!=i.getValue(AbstractAction.NAME)&&t.addMenuItem(i)},HomePane.prototype.createAlignOrDistributeMenu=function(e){var t=HomeView.ActionType,i=this;e.addSubMenu(i.getMenuAction(HomePane.MenuActionType.ALIGN_OR_DISTRIBUTE_MENU),(function(e){i.addActionToMenu(t.ALIGN_FURNITURE_ON_TOP,e),i.addActionToMenu(t.ALIGN_FURNITURE_ON_BOTTOM,e),i.addActionToMenu(t.ALIGN_FURNITURE_ON_LEFT,e),i.addActionToMenu(t.ALIGN_FURNITURE_ON_RIGHT,e),i.addActionToMenu(t.ALIGN_FURNITURE_ON_FRONT_SIDE,e),i.addActionToMenu(t.ALIGN_FURNITURE_ON_BACK_SIDE,e),i.addActionToMenu(t.ALIGN_FURNITURE_ON_LEFT_SIDE,e),i.addActionToMenu(t.ALIGN_FURNITURE_ON_RIGHT_SIDE,e),i.addActionToMenu(t.ALIGN_FURNITURE_SIDE_BY_SIDE,e),i.addActionToMenu(t.DISTRIBUTE_FURNITURE_HORIZONTALLY,e),i.addActionToMenu(t.DISTRIBUTE_FURNITURE_VERTICALLY,e)}))},HomePane.prototype.createFurnitureSortMenu=function(e,t){var i=HomeView.ActionType,n=this;t.addSubMenu(n.getMenuAction(HomePane.MenuActionType.SORT_HOME_FURNITURE_MENU),(function(t){var o=function(i,o){var r=n.getAction(i);r&&r.getValue(AbstractAction.NAME)&&r.getValue(ResourceAction.VISIBLE)&&t.addRadioButtonItem(r.getValue(AbstractAction.NAME),(function(){r.actionPerformed()}),o==e.getFurnitureSortedProperty())};o(i.SORT_HOME_FURNITURE_BY_CATALOG_ID,"CATALOG_ID"),o(i.SORT_HOME_FURNITURE_BY_NAME,"NAME"),o(i.SORT_HOME_FURNITURE_BY_DESCRIPTION,"DESCRIPTION"),o(i.SORT_HOME_FURNITURE_BY_CREATOR,"CREATOR"),o(i.SORT_HOME_FURNITURE_BY_LICENSE,"LICENSE"),o(i.SORT_HOME_FURNITURE_BY_WIDTH,"WIDTH"),o(i.SORT_HOME_FURNITURE_BY_DEPTH,"DEPTH"),o(i.SORT_HOME_FURNITURE_BY_HEIGHT,"HEIGHT"),o(i.SORT_HOME_FURNITURE_BY_X,"X"),o(i.SORT_HOME_FURNITURE_BY_Y,"Y"),o(i.SORT_HOME_FURNITURE_BY_ELEVATION,"ELEVATION"),o(i.SORT_HOME_FURNITURE_BY_ANGLE,"ANGLE"),o(i.SORT_HOME_FURNITURE_BY_LEVEL,"LEVEL"),o(i.SORT_HOME_FURNITURE_BY_MODEL_SIZE,"MODEL_SIZE"),o(i.SORT_HOME_FURNITURE_BY_COLOR,"COLOR"),o(i.SORT_HOME_FURNITURE_BY_TEXTURE,"TEXTURE"),o(i.SORT_HOME_FURNITURE_BY_MOVABILITY,"MOVABLE"),o(i.SORT_HOME_FURNITURE_BY_TYPE,"DOOR_OR_WINDOW"),o(i.SORT_HOME_FURNITURE_BY_VISIBILITY,"VISIBLE"),o(i.SORT_HOME_FURNITURE_BY_PRICE,"PRICE"),o(i.SORT_HOME_FURNITURE_BY_VALUE_ADDED_TAX_PERCENTAGE,"VALUE_ADDED_TAX_PERCENTAGE"),o(i.SORT_HOME_FURNITURE_BY_VALUE_ADDED_TAX,"VALUE_ADDED_TAX"),o(i.SORT_HOME_FURNITURE_BY_PRICE_VALUE_ADDED_TAX_INCLUDED,"PRICE_VALUE_ADDED_TAX_INCLUDED"),t.addSeparator();var r=n.getAction(i.SORT_HOME_FURNITURE_BY_DESCENDING_ORDER);r&&r.getValue(AbstractAction.NAME)&&r.getValue(ResourceAction.VISIBLE)&&t.addCheckBoxItem(r.getValue(AbstractAction.NAME),(function(){r.actionPerformed()}),e.isFurnitureDescendingSorted())}))},HomePane.prototype.createFurnitureDisplayPropertyMenu=function(e,t){var i=HomeView.ActionType,n=this;t.addSubMenu(n.getMenuAction(HomePane.MenuActionType.DISPLAY_HOME_FURNITURE_PROPERTY_MENU),(function(t){var o=function(i,o){var r=n.getAction(i);r&&r.getValue(AbstractAction.NAME)&&r.getValue(ResourceAction.VISIBLE)&&t.addCheckBoxItem(r.getValue(AbstractAction.NAME),(function(){r.actionPerformed()}),e.getFurnitureVisibleProperties().indexOf(o)>-1)};o(i.DISPLAY_HOME_FURNITURE_CATALOG_ID,"CATALOG_ID"),o(i.DISPLAY_HOME_FURNITURE_NAME,"NAME"),o(i.DISPLAY_HOME_FURNITURE_DESCRIPTION,"DESCRIPTION"),o(i.DISPLAY_HOME_FURNITURE_CREATOR,"CREATOR"),o(i.DISPLAY_HOME_FURNITURE_LICENSE,"LICENSE"),o(i.DISPLAY_HOME_FURNITURE_WIDTH,"WIDTH"),o(i.DISPLAY_HOME_FURNITURE_DEPTH,"DEPTH"),o(i.DISPLAY_HOME_FURNITURE_HEIGHT,"HEIGHT"),o(i.DISPLAY_HOME_FURNITURE_X,"X"),o(i.DISPLAY_HOME_FURNITURE_Y,"Y"),o(i.DISPLAY_HOME_FURNITURE_ELEVATION,"ELEVATION"),o(i.DISPLAY_HOME_FURNITURE_ANGLE,"ANGLE"),o(i.DISPLAY_HOME_FURNITURE_LEVEL,"LEVEL"),o(i.DISPLAY_HOME_FURNITURE_MODEL_SIZE,"MODEL_SIZE"),o(i.DISPLAY_HOME_FURNITURE_COLOR,"COLOR"),o(i.DISPLAY_HOME_FURNITURE_TEXTURE,"TEXTURE"),o(i.DISPLAY_HOME_FURNITURE_MOVABLE,"MOVABLE"),o(i.DISPLAY_HOME_FURNITURE_DOOR_OR_WINDOW,"DOOR_OR_WINDOW"),o(i.DISPLAY_HOME_FURNITURE_VISIBLE,"VISIBLE"),o(i.DISPLAY_HOME_FURNITURE_PRICE,"PRICE"),o(i.DISPLAY_HOME_FURNITURE_VALUE_ADDED_TAX_PERCENTAGE,"VALUE_ADDED_TAX_PERCENTAGE"),o(i.DISPLAY_HOME_FURNITURE_VALUE_ADDED_TAX,"VALUE_ADDED_TAX"),o(i.DISPLAY_HOME_FURNITURE_PRICE_VALUE_ADDED_TAX_INCLUDED,"PRICE_VALUE_ADDED_TAX_INCLUDED")}))},HomePane.prototype.createLockUnlockBasePlanButton=function(e,t){var i=this.getAction(HomeView.ActionType.UNLOCK_BASE_PLAN),n=this.getAction(HomeView.ActionType.LOCK_BASE_PLAN);if(null!=i&&null!=i.getValue(AbstractAction.NAME)&&null!=n.getValue(AbstractAction.NAME)){var o=this.createToolBarButton(e.isBasePlanLocked()?i:n,t);return e.addPropertyChangeListener("BASE_PLAN_LOCKED",(function(){o.setAction(e.isBasePlanLocked()?i:n)})),o}return null},HomePane.prototype.createEnableDisableMagnetismButton=function(e,t){var i=this.getAction(HomeView.ActionType.DISABLE_MAGNETISM),n=this.getAction(HomeView.ActionType.ENABLE_MAGNETISM);if(null!==i&&null!==i.getValue(AbstractAction.NAME)&&null!==n.getValue(AbstractAction.NAME)){var o=this.createToolBarButton(e.isMagnetismEnabled()?i:n,t);return e.addPropertyChangeListener("MAGNETISM_ENABLED",new HomePane.MagnetismChangeListener(this,o)),o}return null},HomePane.MagnetismChangeListener=function(e,t){this.enableDisableMagnetismButton=t,this.homePane=e},HomePane.MagnetismChangeListener.prototype.propertyChange=function(e){var t=this.homePane,i=e.getSource(),n=e.getPropertyName();null==t?i.removePropertyChangeListener(n,this):this.enableDisableMagnetismButton.setAction(i.isMagnetismEnabled()?t.getAction(HomeView.ActionType.DISABLE_MAGNETISM):t.getAction(HomeView.ActionType.ENABLE_MAGNETISM))},HomePane.prototype.createBoldStyleAction=function(e,t,i,n,o){var r=this.createAction(e,i,n,o);return t.addSelectionListener({selectionChanged:function(e){for(var i=null,n=t.getSelectedItems(),o=0;o<n.length;o++){var l;if(item=n[o],item instanceof Label)l=this.isItemTextBold("Label",item.getStyle());else if(item instanceof HomePieceOfFurniture&&item.isVisible())l=this.isItemTextBold("HomePieceOfFurniture",item.getNameStyle());else if(item instanceof Room)(l=this.isItemTextBold("Room",item.getNameStyle()))!=this.isItemTextBold("Room",item.getAreaStyle())&&(l=null);else{if(!(item instanceof DimensionLine))continue;l=this.isItemTextBold("DimensionLine",item.getLengthStyle())}if(null==i)i=l;else if(null==l||i!=l){i=null;break}}r.putValue(AbstractAction.SELECTED_KEY,null!=i&&i)},isItemTextBold:function(e,t){return null==t&&(t=i.getDefaultTextStyle(e)),t.isBold()}}),r},HomePane.prototype.createItalicStyleToggleModel=function(e,t,i,n,o){var r=this.createAction(e,i,n,o);return t.addSelectionListener({selectionChanged:function(e){for(var i=null,n=t.getSelectedItems(),o=0;o<n.length;o++){var l;if(item=n[o],item instanceof Label)l=this.isItemTextItalic("Label",item.getStyle());else if(item instanceof HomePieceOfFurniture&&item.isVisible())l=this.isItemTextItalic("HomePieceOfFurniture",item.getNameStyle());else if(item instanceof Room)(l=this.isItemTextItalic("Room",item.getNameStyle()))!=this.isItemTextItalic("Room",item.getAreaStyle())&&(l=null);else{if(!(item instanceof DimensionLine))continue;l=this.isItemTextItalic("DimensionLine",item.getLengthStyle())}if(null==i)i=l;else if(null==l||i!=l){i=null;break}}r.putValue(AbstractAction.SELECTED_KEY,null!=i&&i)},isItemTextItalic:function(e,t){return null==t&&(t=i.getDefaultTextStyle(e)),t.isItalic()}}),r},HomePane.prototype.createToolBar=function(e,t,i){var n=document.getElementById("application-menu-toolbar");null!=n&&(this.startToolBarButtonGroup(n),this.addActionToToolBar("SHOW_APPLICATION_MENU",n),this.showApplicationMenuButton=n.children[n.children.length-1].lastChild);var o=document.getElementById("home-pane-toolbar");this.toolBarDefaultChildren=Array.prototype.slice.call(o.children),this.startToolBarButtonGroup(o);var r=!1;o.classList.contains("new-home")&&(this.addActionToToolBar(HomeView.ActionType.NEW_HOME,o),r=!0),o.classList.contains("open")&&(this.addActionToToolBar(HomeView.ActionType.OPEN,o),r=!0),o.classList.contains("save")&&(this.addActionToToolBar(HomeView.ActionType.SAVE,o),r=!0),o.classList.contains("save-as")&&(this.addActionToToolBar(HomeView.ActionType.SAVE_AS,o),r=!0),r&&this.addSeparator(o),this.addToggleActionToToolBar(HomeView.ActionType.VIEW_FROM_TOP,o),this.addToggleActionToToolBar(HomeView.ActionType.VIEW_FROM_OBSERVER,o),this.addSeparator(o),this.addActionToToolBar(HomeView.ActionType.UNDO,o),this.addActionToToolBar(HomeView.ActionType.REDO,o),this.addSeparator(o),this.addActionToToolBar(HomeView.ActionType.DELETE_SELECTION,o),this.addActionToToolBar(HomeView.ActionType.CUT,o,"toolbar-optional"),this.addActionToToolBar(HomeView.ActionType.COPY,o),this.addActionToToolBar(HomeView.ActionType.PASTE,o),this.addSeparator(o),this.addActionToToolBar(HomeView.ActionType.ADD_HOME_FURNITURE,o,"toolbar-optional"),this.addSeparator(o),this.addToggleActionToToolBar(HomeView.ActionType.SELECT,o),this.addToggleActionToToolBar(HomeView.ActionType.PAN,o,"toolbar-optional"),this.addToggleActionToToolBar(HomeView.ActionType.CREATE_WALLS,o),this.addToggleActionToToolBar(HomeView.ActionType.CREATE_ROOMS,o),this.addToggleActionToToolBar(HomeView.ActionType.CREATE_POLYLINES,o),this.addToggleActionToToolBar(HomeView.ActionType.CREATE_DIMENSION_LINES,o),this.addToggleActionToToolBar(HomeView.ActionType.CREATE_LABELS,o),this.addSeparator(o);var l=this.createEnableDisableMagnetismButton(t);null!==l&&this.addButtonToToolBar(o,l);var a=this.createLockUnlockBasePlanButton(e);return null!==a&&this.addButtonToToolBar(o,a),this.addActionToToolBar(HomeView.ActionType.FLIP_HORIZONTALLY,o),this.addActionToToolBar(HomeView.ActionType.FLIP_VERTICALLY,o),this.addSeparator(o),this.addActionToToolBar(HomeView.ActionType.INCREASE_TEXT_SIZE,o),this.addActionToToolBar(HomeView.ActionType.DECREASE_TEXT_SIZE,o),this.addToggleActionToToolBar(HomeView.ActionType.TOGGLE_BOLD_STYLE,o),this.addToggleActionToToolBar(HomeView.ActionType.TOGGLE_ITALIC_STYLE,o),this.addSeparator(o),this.addActionToToolBar(HomeView.ActionType.ZOOM_IN,o,"toolbar-optional"),this.addActionToToolBar(HomeView.ActionType.ZOOM_OUT,o,"toolbar-optional"),this.addSeparator(o),null!=this.showApplicationMenuButton&&window.matchMedia("(hover: none), (pointer: coarse)").matches||(this.addActionToToolBar(HomeView.ActionType.ABOUT,o),this.addSeparator(o)),this.addActionToToolBar(HomeView.ActionType.PREFERENCES,o),o},HomePane.prototype.createPopupMenus=function(e,t){var i=HomeView.ActionType,n=this,o=this.controller;if(null!=this.showApplicationMenuButton&&window.matchMedia("(hover: none), (pointer: coarse)").matches)new JSPopupMenu(t,this.showApplicationMenuButton,(function(t){var r=document.getElementById("home-pane-toolbar");this.toolBarDefaultChildren=Array.prototype.slice.call(r.children);var l=!1;r.classList.contains("new-home")&&(n.addActionToMenu(HomeView.ActionType.NEW_HOME,t),l=!0),r.classList.contains("open")&&(n.addActionToMenu(HomeView.ActionType.OPEN,t),l=!0),r.classList.contains("save")&&(n.addActionToMenu(HomeView.ActionType.SAVE,t),l=!0),r.classList.contains("save-as")&&(n.addActionToMenu(HomeView.ActionType.SAVE_AS,t),l=!0),l&&t.addSeparator(),n.addActionToMenu(i.DELETE_SELECTION,t),n.addActionToMenu(i.CUT,t),n.addActionToMenu(i.COPY,t),n.addActionToMenu(i.PASTE,t),n.addActionToMenu(i.PASTE_TO_GROUP,t),n.addActionToMenu(i.PASTE_STYLE,t),t.addSeparator(),n.addActionToMenu(i.SELECT_ALL,t),n.addActionToMenu(i.SELECT_ALL_AT_ALL_LEVELS,t),t.addSeparator(),n.addActionToMenu(i.ADD_HOME_FURNITURE,t),n.addActionToMenu(i.ADD_FURNITURE_TO_GROUP,t),t.addSeparator(),n.addActionToMenu(i.MODIFY_FURNITURE,t),n.addActionToMenu(i.GROUP_FURNITURE,t),n.addActionToMenu(i.UNGROUP_FURNITURE,t),n.createAlignOrDistributeMenu(t),n.addActionToMenu(i.RESET_FURNITURE_ELEVATION,t);var a=o.getFurnitureController().getView();if(null!=a&&"none"!=window.getComputedStyle(a.getHTMLElement()).display&&(n.createFurnitureSortMenu(e,t),n.createFurnitureDisplayPropertyMenu(e,t)),t.addSeparator(),n.addActionToMenu(i.SELECT,t),n.addActionToMenu(i.CREATE_WALLS,t),n.addActionToMenu(i.CREATE_ROOMS,t),n.addActionToMenu(i.CREATE_POLYLINES,t),n.addActionToMenu(i.CREATE_DIMENSION_LINES,t),n.addActionToMenu(i.CREATE_LABELS,t),t.addSeparator(),n.addActionToMenu(i.MODIFY_COMPASS,t),n.addActionToMenu(i.MODIFY_WALL,t),n.addActionToMenu(i.JOIN_WALLS,t),n.addActionToMenu(i.REVERSE_WALL_DIRECTION,t),n.addActionToMenu(i.SPLIT_WALL,t),n.addActionToMenu(i.MODIFY_ROOM,t),n.addActionToMenu(i.MODIFY_POLYLINE,t),n.addActionToMenu(i.MODIFY_DIMENSION_LINE,t),n.addActionToMenu(i.MODIFY_LABEL,t),t.addSeparator(),n.addActionToMenu(i.IMPORT_BACKGROUND_IMAGE,t),n.addActionToMenu(i.MODIFY_BACKGROUND_IMAGE,t),n.addActionToMenu(i.HIDE_BACKGROUND_IMAGE,t),n.addActionToMenu(i.SHOW_BACKGROUND_IMAGE,t),n.addActionToMenu(i.DELETE_BACKGROUND_IMAGE,t),t.addSeparator(),n.addActionToMenu(i.ADD_LEVEL,t),n.addActionToMenu(i.ADD_LEVEL_AT_SAME_ELEVATION,t),n.addActionToMenu(i.MODIFY_LEVEL,t),n.addActionToMenu(i.DELETE_LEVEL,t),t.addSeparator(),n.addActionToMenu(i.MODIFY_OBSERVER,t),n.addActionToMenu(i.STORE_POINT_OF_VIEW,t),e.getStoredCameras().length>0){var s=n.getMenuAction(HomePane.MenuActionType.GO_TO_POINT_OF_VIEW);null!=s.getValue(AbstractAction.NAME)&&t.addSubMenu(s,(function(t){for(var i=function(e){t.addMenuItem(e.getName(),(function(){o.getHomeController3D().goToCamera(e)}))},n=e.getStoredCameras(),r=0;r<n.length;r++)i(n[r])})),n.addActionToMenu(i.DELETE_POINTS_OF_VIEW,t)}t.addSeparator(),n.addActionToMenu(i.DISPLAY_ALL_LEVELS,t),n.addActionToMenu(i.DISPLAY_SELECTED_LEVEL,t),n.addActionToMenu(i.MODIFY_3D_ATTRIBUTES,t),t.addSeparator(),n.addActionToMenu(i.ABOUT,t)}));else{var r=this.controller.getFurnitureCatalogController().getView();null!=r&&(this.furnitureCatalogPopupMenu=new JSPopupMenu(t,r.getHTMLElement(),(function(e){n.addActionToMenu(i.ADD_HOME_FURNITURE,e),n.addActionToMenu(i.ADD_FURNITURE_TO_GROUP,e)})));var l=this.controller.getFurnitureController().getView();null!=l&&(this.furniturePopupMenu=new JSPopupMenu(t,l.getHTMLElement(),(function(t){n.addActionToMenu(i.CUT,t),n.addActionToMenu(i.COPY,t),n.addActionToMenu(i.PASTE,t),n.addActionToMenu(i.PASTE_TO_GROUP,t),n.addActionToMenu(i.PASTE_STYLE,t),t.addSeparator(),n.addActionToMenu(i.MODIFY_FURNITURE,t),n.addActionToMenu(i.GROUP_FURNITURE,t),n.addActionToMenu(i.UNGROUP_FURNITURE,t),n.createAlignOrDistributeMenu(t),n.addActionToMenu(i.RESET_FURNITURE_ELEVATION,t),t.addSeparator(),n.createFurnitureSortMenu(e,t),n.createFurnitureDisplayPropertyMenu(e,t)})));var a=this.controller.getPlanController().getView();null!=a&&(this.planPopupMenu=new JSPopupMenu(t,a.getHTMLElement(),(function(e){n.addActionToMenu(i.UNDO,e),n.addActionToMenu(i.REDO,e),e.addSeparator(),n.addActionToMenu(i.DELETE_SELECTION,e),n.addActionToMenu(i.CUT,e),n.addActionToMenu(i.COPY,e),n.addActionToMenu(i.PASTE,e),n.addActionToMenu(i.PASTE_STYLE,e),e.addSeparator(),n.addActionToMenu(i.SELECT_ALL,e),n.addActionToMenu(i.SELECT_ALL_AT_ALL_LEVELS,e),e.addSeparator(),n.addActionToMenu(i.MODIFY_FURNITURE,e),n.addActionToMenu(i.GROUP_FURNITURE,e),n.addActionToMenu(i.UNGROUP_FURNITURE,e),n.addActionToMenu(i.RESET_FURNITURE_ELEVATION,e),e.addSeparator(),n.addActionToMenu(i.MODIFY_COMPASS,e),n.addActionToMenu(i.MODIFY_WALL,e),n.addActionToMenu(i.JOIN_WALLS,e),n.addActionToMenu(i.REVERSE_WALL_DIRECTION,e),n.addActionToMenu(i.SPLIT_WALL,e),n.addActionToMenu(i.MODIFY_ROOM,e),n.addActionToMenu(i.MODIFY_POLYLINE,e),n.addActionToMenu(i.MODIFY_DIMENSION_LINE,e),n.addActionToMenu(i.MODIFY_LABEL,e),e.addSeparator(),e.addSubMenu(n.getMenuAction(HomePane.MenuActionType.MODIFY_TEXT_STYLE),(function(e){n.addActionToMenu(i.INCREASE_TEXT_SIZE,e),n.addActionToMenu(i.DECREASE_TEXT_SIZE,e),n.addActionToMenu(i.TOGGLE_BOLD_STYLE,e),n.addActionToMenu(i.TOGGLE_ITALIC_STYLE,e)})),e.addSeparator(),n.addActionToMenu(i.IMPORT_BACKGROUND_IMAGE,e),n.addActionToMenu(i.MODIFY_BACKGROUND_IMAGE,e),n.addActionToMenu(i.HIDE_BACKGROUND_IMAGE,e),n.addActionToMenu(i.SHOW_BACKGROUND_IMAGE,e),n.addActionToMenu(i.DELETE_BACKGROUND_IMAGE,e),e.addSeparator(),n.addActionToMenu(i.ADD_LEVEL,e),n.addActionToMenu(i.ADD_LEVEL_AT_SAME_ELEVATION,e),n.addActionToMenu(i.MODIFY_LEVEL,e),n.addActionToMenu(i.DELETE_LEVEL,e)})));var s=this.controller.getHomeController3D().getView();null!=s&&(this.view3DPopupMenu=new JSPopupMenu(t,s.getHTMLElement(),(function(t){if(n.addActionToMenu(i.VIEW_FROM_TOP,t),n.addActionToMenu(i.VIEW_FROM_OBSERVER,t),n.addActionToMenu(i.MODIFY_OBSERVER,t),n.addActionToMenu(i.STORE_POINT_OF_VIEW,t),e.getStoredCameras().length>0){var r=n.getMenuAction(HomePane.MenuActionType.GO_TO_POINT_OF_VIEW);null!=r.getValue(AbstractAction.NAME)&&t.addSubMenu(r,(function(t){for(var i=function(e){t.addMenuItem(e.getName(),(function(){o.getHomeController3D().goToCamera(e)}))},n=e.getStoredCameras(),r=0;r<n.length;r++)i(n[r])})),n.addActionToMenu(i.DELETE_POINTS_OF_VIEW,t)}t.addSeparator(),n.addActionToMenu(i.DISPLAY_ALL_LEVELS,t),n.addActionToMenu(i.DISPLAY_SELECTED_LEVEL,t),n.addActionToMenu(i.MODIFY_3D_ATTRIBUTES,t)})))}},HomePane.prototype.initSplitters=function(){var e=this.controller,t=e.getFurnitureCatalogController().getView(),i=e.getFurnitureController().getView(),n=e.getPlanController().getView(),o=e.getHomeController3D().getView(),r=document.getElementById("furniture-plan-splitter"),l=document.getElementById("plan-3D-view-splitter"),a=document.getElementById("catalog-furniture-splitter");this.furniturePlanSplitter={element:r,homePropertyName:HomePane.MAIN_PANE_DIVIDER_LOCATION_VISUAL_PROPERTY,firstGroupElement:document.getElementById("catalog-furniture-pane"),secondGroupElement:document.getElementById("plan-3D-view-pane"),isDisplayed:function(){return r&&r.clientWidth>0},resizeListener:function(e){n.revalidate(),o.revalidate()}},this.plan3DViewSplitter={element:l,homePropertyName:HomePane.PLAN_PANE_DIVIDER_LOCATION_VISUAL_PROPERTY,firstGroupElement:n.getHTMLElement(),secondGroupElement:o.getHTMLElement(),isDisplayed:function(){return l&&l.clientWidth>0&&null!=n&&null!=o},resizeListener:function(e){n.revalidate(),o.revalidate()}},this.catalogFurnitureSplitter={element:a,homePropertyName:HomePane.CATALOG_PANE_DIVIDER_LOCATION_VISUAL_PROPERTY,firstGroupElement:t.getHTMLElement(),secondGroupElement:i.getHTMLElement(),isDisplayed:function(){return a&&a.clientWidth>0&&null!=t&&null!=i}},this.updateSplitters();var s=window.document.createEvent("UIEvents");s.initEvent("resize",!0,!0),window.dispatchEvent(s)},HomePane.prototype.updateSplitters=function(){var e=this.controller.getPlanController().getView(),t=this.controller.getHomeController3D().getView(),i=this.controller.getFurnitureCatalogController().getView();null!==i&&i.getHTMLElement().getBoundingClientRect().top>t.getHTMLElement().getBoundingClientRect().top+10?(this.plan3DViewSplitter.firstGroupElement=t.getHTMLElement(),this.plan3DViewSplitter.secondGroupElement=e.getHTMLElement()):(this.plan3DViewSplitter.firstGroupElement=e.getHTMLElement(),this.plan3DViewSplitter.secondGroupElement=t.getHTMLElement()),this.updateSplitter(this.plan3DViewSplitter),this.updateSplitter(this.furniturePlanSplitter),this.updateSplitter(this.catalogFurnitureSplitter)},HomePane.prototype.updateSplitter=function(e){e.element.style.display="",e.element.style.top="",e.element.style.left="",e.firstGroupElement.style.left="",e.firstGroupElement.style.top="",e.firstGroupElement.style.width="",e.firstGroupElement.style.height="",e.secondGroupElement.style.left="",e.secondGroupElement.style.top="",e.secondGroupElement.style.width="",e.secondGroupElement.style.height="";var t=e.isDisplayed();e.element.style.display=t?"block":"none",void 0!==e.mouseListener&&e.mouseListener.mousePressed&&(e.element.removeEventListener("mousedown",e.mouseListener.mousePressed,!0),e.element.removeEventListener("touchstart",e.mouseListener.mousePressed,!0),window.removeEventListener("resize",e.mouseListener.windowResized),delete e.mouseListener),e.element.classList.remove("horizontal"),e.element.classList.remove("vertical");var i=e.element.clientWidth>e.element.clientHeight;i?e.element.classList.add("horizontal"):e.element.classList.add("vertical");var n=this.home.getNumericProperty(e.homePropertyName),o=i?"top":"left",r=i?"height":"width",l=i?"clientHeight":"clientWidth",a=i?"clientY":"clientX",s=e.firstGroupElement.offsetParent,h=i?"offsetTop":"offsetLeft",u=s==document.body?e.firstGroupElement[h]-s[h]:0,d=this,c={getSplitterPosition:function(e){return(e.touches&&e.touches.length>0?e.touches[0]:e)[a]-s[h]},setSplitterPosition:function(t){t<u&&(t=u),t>s[l]-e.element[l]&&(t=s[l]-e.element[l]),e.firstGroupElement.style[r]=t-u+"px",e.element.style[o]=t+"px",e.secondGroupElement.style[o]=t+e.element[l]+"px",e.secondGroupElement.style[r]="calc(100% - "+(t+e.element[l])+"px)"},mouseDragged:function(t){t.stopImmediatePropagation(),c.currentPosition=c.getSplitterPosition(t),c.setSplitterPosition(c.currentPosition),void 0!==e.resizeListener&&e.resizeListener(c.currentPosition)},mousePressed:function(t){t.preventDefault(),t.stopImmediatePropagation(),c.currentPosition=c.getSplitterPosition(t),e.element.classList.add("moving"),window.addEventListener("mousemove",c.mouseDragged,!0),window.addEventListener("touchmove",c.mouseDragged,!0),window.addEventListener("mouseup",c.windowMouseReleased,!0),window.addEventListener("touchend",c.windowMouseReleased,!0)},windowMouseReleased:function(t){t.stopImmediatePropagation(),e.element.classList.remove("moving"),window.removeEventListener("mousemove",c.mouseDragged,!0),window.removeEventListener("touchmove",c.mouseDragged,!0),window.removeEventListener("mouseup",c.windowMouseReleased,!0),window.removeEventListener("touchend",c.windowMouseReleased,!0),d.controller.setHomeProperty(e.homePropertyName,null==c.currentPosition?null:c.currentPosition.toString()),void 0!==e.resizeListener&&e.resizeListener(c.currentPosition)},windowResized:function(t){var i=window.getComputedStyle(e.element)[o];null==i&&(i="0px"),(i=i.substring(0,i.length-2))>s[l]-e.element[l]&&c.setSplitterPosition(s[l]-e.element[l])}};null!=n&&(t&&c.setSplitterPosition(n),void 0!==e.resizeListener&&e.resizeListener(n)),e.element.addEventListener("mousedown",c.mousePressed,!0),e.element.addEventListener("touchstart",c.mousePressed,!0),window.addEventListener("resize",c.windowResized),e.mouseListener=c},HomePane.prototype.addOrientationChangeListener=function(){var e=this;this.resizeListener=function(t){window.matchMedia("(hover: none), (pointer: coarse)").matches&&function(t){var i=e.controller.getPlanController().getView(),n=e.controller.getHomeController3D().getView();null!=i&&null!=n&&(document.getElementById("plan-3D-view-splitter").removeAttribute("style"),i.getHTMLElement().removeAttribute("style"),n.getHTMLElement().removeAttribute("style"),i.revalidate(),n.revalidate()),setTimeout((function(){e.updateSplitters()}),100)}()},window.addEventListener("resize",this.resizeListener)},HomePane.prototype.startToolBarButtonGroup=function(e){var t=document.createElement("span");e.appendChild(t),t.classList.add("toolbar-button-group")},HomePane.prototype.addButtonToToolBar=function(e,t){0===e.children.length&&this.startToolBarButtonGroup(e),e.children[e.children.length-1].appendChild(t)},HomePane.prototype.addToggleActionToToolBar=function(e,t,i){var n=this.getAction(e);if(null!=n.getValue(AbstractAction.NAME)){var o=this.createToolBarButton(n,i);n.getValue(AbstractAction.SELECTED_KEY)&&o.classList.add("selected"),n.addPropertyChangeListener((function(e){e.getPropertyName()==AbstractAction.SELECTED_KEY&&(e.getNewValue()?o.classList.add("selected"):o.classList.remove("selected"))})),o.addEventListener("click",(function(){var e=n.getValue(ResourceAction.TOGGLE_BUTTON_GROUP);n.putValue(AbstractAction.SELECTED_KEY,!!e||!n.getValue(AbstractAction.SELECTED_KEY))})),this.addButtonToToolBar(t,o)}},HomePane.prototype.addActionToToolBar=function(e,t,i){var n=this.getAction(e);null!=n.getValue(AbstractAction.NAME)&&this.addButtonToToolBar(t,this.createToolBarButton(n,i))},HomePane.prototype.createToolBarButton=function(e,t){var i=document.createElement("button");i.id="toolbar-button-"+e.getValue(ResourceAction.RESOURCE_PREFIX),i.disabled=!e.isEnabled(),i.tabIndex=-1,i.setAction=function(e){i.action=e;var t=e.getURL(ResourceAction.TOOL_BAR_ICON);t||(t=e.getURL(AbstractAction.SMALL_ICON)),i.style.backgroundImage="url('"+t+"')",i.style.backgroundPosition="center",i.style.backgroundRepeat="no-repeat";var n=e.getValue(AbstractAction.SHORT_DESCRIPTION);n&&(i.title=n)},i.setAction(e),i.classList.add("toolbar-button"),e.getValue(ResourceAction.TOGGLE_BUTTON_GROUP)&&i.classList.add("toggle"),i.action=e,i.addEventListener("click",(function(e){this.action.actionPerformed(e)}));var n={propertyChange:function(e){"enabled"==e.getPropertyName()?i.disabled=!e.getNewValue():e.getPropertyName()==AbstractAction.SHORT_DESCRIPTION&&(i.title=e.getNewValue())}};return e.addPropertyChangeListener(n),t&&i.classList.add(t),i},HomePane.prototype.addSeparator=function(e){this.startToolBarButtonGroup(e)},HomePane.prototype.setEnabled=function(e,t){var i=this.getAction(e);null!=i&&i.setEnabled(t)},HomePane.prototype.setActionEnabled=function(e,t){var i=this.getAction(e);null!=i&&i.setEnabled(t)},HomePane.prototype.setUndoRedoName=function(e,t){this.setNameAndShortDescription(HomeView.ActionType.UNDO,null!=e?e.replace(/^Undo/,this.preferences.getLocalizedString("AbstractUndoableEdit","undo.textAndMnemonic")):null),this.setNameAndShortDescription(HomeView.ActionType.REDO,null!=t?t.replace(/^Redo/,this.preferences.getLocalizedString("AbstractUndoableEdit","redo.textAndMnemonic")):null)},HomePane.prototype.setNameAndShortDescription=function(e,t){var i=this.getAction(e);null!=i&&(null==t&&(t=i.getValue(AbstractAction.DEFAULT)),i.putValue(AbstractAction.NAME,t),i.putValue(AbstractAction.SHORT_DESCRIPTION,t))},HomePane.prototype.setTransferEnabled=function(e){var t=this.controller.getFurnitureCatalogController().getView();if(e&&!this.transferHandlerEnabled){if(null!=t){null==this.furnitureCatalogDragAndDropListener&&(this.furnitureCatalogDragAndDropListener=this.createFurnitureCatalogMouseListener());var n=t.getHTMLElement().querySelectorAll(".furniture");if(OperatingSystem.isInternetExplorerOrLegacyEdge()&&window.PointerEvent){for(i=0;i<n.length;i++)n[i].addEventListener("pointerdown",this.furnitureCatalogDragAndDropListener.pointerPressed);t.getHTMLElement().addEventListener("mousedown",this.furnitureCatalogDragAndDropListener.mousePressed),window.addEventListener("pointermove",this.furnitureCatalogDragAndDropListener.windowPointerMoved),window.addEventListener("pointerup",this.furnitureCatalogDragAndDropListener.windowPointerReleased)}else{for(i=0;i<n.length;i++)n[i].addEventListener("touchstart",this.furnitureCatalogDragAndDropListener.mousePressed);window.addEventListener("touchmove",this.furnitureCatalogDragAndDropListener.mouseDragged),window.addEventListener("touchend",this.furnitureCatalogDragAndDropListener.windowMouseReleased),t.getHTMLElement().addEventListener("mousedown",this.furnitureCatalogDragAndDropListener.mousePressed),window.addEventListener("mousemove",this.furnitureCatalogDragAndDropListener.mouseDragged),window.addEventListener("mouseup",this.furnitureCatalogDragAndDropListener.windowMouseReleased)}t.getHTMLElement().addEventListener("contextmenu",this.furnitureCatalogDragAndDropListener.contextMenuDisplayed)}var o=this;this.furnitureCatalogListener=function(e){e.getType()!==CollectionEvent.Type.ADD||o.furnitureCatalogListener.updater||(o.furnitureCatalogListener.updater=function(){if(void 0!==o.furnitureCatalogListener){var e=t.getHTMLElement().querySelectorAll(".furniture");if(OperatingSystem.isInternetExplorerOrLegacyEdge()&&window.PointerEvent)for(i=0;i<e.length;i++)e[i].addEventListener("pointerdown",o.furnitureCatalogDragAndDropListener.pointerPressed);else for(i=0;i<e.length;i++)e[i].addEventListener("touchstart",o.furnitureCatalogDragAndDropListener.mousePressed);delete o.furnitureCatalogListener.updater}},setTimeout(o.furnitureCatalogListener.updater,100))},this.preferences.getFurnitureCatalog().addFurnitureListener(this.furnitureCatalogListener)}else if(!e&&this.transferHandlerEnabled){if(null!=t){n=t.getHTMLElement().querySelectorAll(".furniture");if(OperatingSystem.isInternetExplorerOrLegacyEdge()&&window.PointerEvent){for(i=0;i<n.length;i++)n[i].removeEventListener("pointerdown",this.furnitureCatalogDragAndDropListener.pointerPressed);t.getHTMLElement().removeEventListener("mousedown",this.furnitureCatalogDragAndDropListener.mousePressed),window.removeEventListener("pointermove",this.furnitureCatalogDragAndDropListener.windowPointerMoved),window.removeEventListener("pointerup",this.furnitureCatalogDragAndDropListener.windowPointerReleased)}else{for(i=0;i<n.length;i++)n[i].removeEventListener("touchstart",this.furnitureCatalogDragAndDropListener.mousePressed);window.removeEventListener("touchmove",this.furnitureCatalogDragAndDropListener.mouseDragged),window.removeEventListener("touchend",this.furnitureCatalogDragAndDropListener.windowMouseReleased),t.getHTMLElement().removeEventListener("mousedown",this.furnitureCatalogDragAndDropListener.mousePressed),window.removeEventListener("mousemove",this.furnitureCatalogDragAndDropListener.mouseDragged),window.removeEventListener("mouseup",this.furnitureCatalogDragAndDropListener.windowMouseReleased)}t.getHTMLElement().removeEventListener("contextmenu",this.furnitureCatalogDragAndDropListener.contextMenuDisplayed)}this.preferences.getFurnitureCatalog().removeFurnitureListener(this.furnitureCatalogListener),delete this.furnitureCatalogListener}this.transferHandlerEnabled=e},HomePane.prototype.createFurnitureCatalogMouseListener=function(){var e=this,t={selectedPiece:null,previousCursor:null,previousView:null,escaped:!1,draggedImage:null,pointerTouches:{},actionStartedInFurnitureCatalog:!1,contextMenuEventType:!1,mousePressed:function(i){if(!t.contextMenuEventType&&(0===i.button||i.targetTouches)){if(!i.target.classList.contains("selected"))return;i.preventDefault(),i.stopPropagation();var n=e.controller.getFurnitureCatalogController().getSelectedFurniture();n.length>0&&(t.selectedPiece=n[0],t.previousCursor=null,t.previousView=null,t.escaped=!1,e.inputMap.ESCAPE="EscapeDragFromFurnitureCatalog"),t.actionStartedInFurnitureCatalog=!0}},mouseDragged:function(i){if(!t.contextMenuEventType&&t.actionStartedInFurnitureCatalog&&(1==(1&i.buttons)||i.targetTouches)&&null!=t.selectedPiece){if(i.preventDefault(),i.stopPropagation(),!t.escaped){if(null==t.draggedImage){var n=document.createElement("img"),o=e.controller.getFurnitureCatalogController().getView().getHTMLElement().querySelector(".furniture.selected .furniture-icon");n.src=o.src;var r=window.getComputedStyle(o);n.style.width=r.width,n.style.height=r.height,n.style.position="absolute",n.style.opacity=.6,n.style.zIndex=105,t.draggedImage=n,document.body.appendChild(n)}t.draggedImage.style.left=t.getCoordinates(i).clientX+"px",t.draggedImage.style.top=t.getCoordinates(i).clientY+"px"}var l=e.home.getSelectedLevel();if(null==l||l.isViewable()){var a,s=[e.controller.getFurnitureController().createHomePieceOfFurniture(t.selectedPiece)],h=t.getPointInPlanView(i,s);if(null!=h?a=e.controller.getPlanController().getView():(a=e.controller.getFurnitureController().getView(),h=t.getPointInFurnitureView(i)),t.previousView!==a){if(null!=t.previousView)t.previousView!==e.controller.getPlanController().getView()||t.escaped||e.controller.getPlanController().stopDraggedItems(),(u=t.previousView)&&"function"==typeof u.setCursor&&u.setCursor(t.previousCursor),t.previousCursor=null,t.previousView=null;if(null!=a){var u=a;t.previousCursor="default",t.previousView=a,t.escaped||("function"==typeof u.setCursor&&u.setCursor("copy"),a===e.controller.getPlanController().getView()&&e.controller.getPlanController().startDraggedItems(s,h[0],h[1]))}}else null!=h&&e.controller.getPlanController().moveMouse(h[0],h[1])}}},getPointInPlanView:function(i,n){var o=e.controller.getPlanController().getView();if(null!=o){var r=o.getHTMLElement().getBoundingClientRect(),l=t.getCoordinates(i);if(l.clientX>=r.left&&l.clientX<r.left+r.width&&l.clientY>=r.top&&l.clientY<r.top+r.height)return[o.convertXPixelToModel(l.clientX-r.left),o.convertYPixelToModel(l.clientY-r.top)]}return null},getPointInView3D:function(i){var n=e.controller.getHomeController3D().getView();if(null!=n){var o=n.getHTMLElement().getBoundingClientRect(),r=t.getCoordinates(i);if(r.clientX>=o.left&&r.clientX<o.left+o.width&&r.clientY>=o.top&&r.clientY<o.top+o.height)return[r.clientX-o.left,r.clientY-o.top]}return null},getCoordinates:function(e){if(e.targetTouches){if(1===e.targetTouches.length)return{clientX:e.targetTouches[0].clientX,clientY:e.targetTouches[0].clientY};if(0===e.targetTouches.length&&1===e.changedTouches.length)return{clientX:e.changedTouches[0].clientX,clientY:e.changedTouches[0].clientY}}return e},getPointInFurnitureView:function(i){var n=e.controller.getFurnitureController().getView();if(null!=n){var o=n.getHTMLElement().getBoundingClientRect(),r=t.getCoordinates(i);if(r.clientX>=o.left&&r.clientX<o.left+o.width&&r.clientY>=o.top&&r.clientY<o.top+o.height)return[0,0]}return null},contextMenuDisplayed:function(e){t.contextMenuEventType=!0},windowMouseReleased:function(i){if(t.actionStartedInFurnitureCatalog&&(null!=t.draggedImage&&(document.body.removeChild(t.draggedImage),t.draggedImage=null),!t.contextMenuEventType&&(0===i.button||i.targetTouches)&&null!=t.selectedPiece&&(i.preventDefault(),!t.escaped))){var n=e.home.getSelectedLevel();if(null==n||n.isViewable()){var o,r=[e.controller.getFurnitureController().createHomePieceOfFurniture(t.selectedPiece)],l=t.getPointInPlanView(i,r);if(null!=l)e.controller.getPlanController().stopDraggedItems(),o=e.controller.getPlanController().getView(),e.controller.drop(r,o,l[0],l[1]),(o=t.previousView)&&"function"==typeof o.setCursor&&o.setCursor(this.previousCursor);else if(e.preferences.isEditingIn3DViewEnabled()&&(pointInView3D=t.getPointInView3D(i),null!==pointInView3D)){o=e.controller.getHomeController3D().getView();var a=e.getDropModelLevel(o,pointInView3D),s=e.getDropModelLocation(o,r,a,pointInView3D);e.controller.drop(r,o,a,s[0],s[1],3===s.length?s[2]:null)}}}t.selectedPiece=null,t.actionStartedInFurnitureCatalog=!1,t.contextMenuEventType=!1,delete e.inputMap.ESCAPE},pointerPressed:function(e){"mouse"==e.pointerType?t.mousePressed(e):t.copyPointerToTargetTouches(e)},windowPointerMoved:function(e){"mouse"==e.pointerType?t.mouseDragged(e):t.copyPointerToTargetTouches(e)},windowPointerReleased:function(e){"mouse"==e.pointerType?t.windowMouseReleased(e):delete t.pointerTouches[e.pointerId]},copyPointerToTargetTouches:function(e){for(var i in t.pointerTouches[e.pointerId]={clientX:e.clientX,clientY:e.clientY},e.targetTouches=[],t.pointerTouches)t.pointerTouches.hasOwnProperty(i)&&e.targetTouches.push(t.pointerTouches[i])}},i={actionPerformed:function(){t.escaped||(null!=t.previousView&&(t.previousView===e.controller.getPlanController().getView()&&e.controller.getPlanController().stopDraggedItems(),null!=t.previousCursor&&"function"==typeof t.previousView.setCursor&&t.previousView.setCursor(t.previousCursor)),t.escaped=!0,null!=t.draggedImage&&(document.body.removeChild(t.draggedImage),t.draggedImage=null))}};return this.getActionMap().EscapeDragFromFurnitureCatalog=i,t},HomePane.prototype.getDropModelLevel=function(e,t){if(e instanceof HomeComponent3D){var i=e.getClosestSelectableItemAt(t[0],t[1]),n=this.home.getSelectedLevel();if(null!=i&&"function"==typeof i.isAtLevel&&!i.isAtLevel(n))return i.getLevel()}return this.home.getSelectedLevel()},HomePane.prototype.getDropModelLocation=function(e,t,i,n){var o=[0,0,0];if(e instanceof HomeComponent3D){var r=e,l=r.getClosestSelectableItemAt(n[0],n[1]),a=0;if(null!=i&&(a=i.getElevation()),l instanceof HomePieceOfFurniture){if(o=[l.getX(),l.getY()],1===t.length&&t[0]instanceof HomePieceOfFurniture){var s=r.getVirtualWorldPointAt(n[0],n[1],a),h=this.computeIntersection(s[0],s[1],this.home.getCamera().getX(),this.home.getCamera().getY(),o[0],o[1],o[0]+Math.cos(l.getAngle()),o[1]+Math.sin(l.getAngle()));java.awt.geom.Point2D.distance(h[0],h[1],l.getX(),l.getY())<l.getWidth()/2&&(o=h);var u=t[0];if(o[0]-=u.getWidth()/2,o[1]-=u.getDepth()/2,l instanceof HomeShelfUnit)var d=this.home.getCamera(),c=java.awt.geom.Point2D.distance(s[0],s[1],d.getX(),d.getY()),p=java.awt.geom.Point2D.distance(s[0],s[1],o[0],o[1]),g=(d.getZ()-(null!==this.home.getSelectedLevel()?this.home.getSelectedLevel().getElevation():0))/c*p;else g=l.isHorizontallyRotated()?l.getElevation()+l.getHeightInPlan():l.getDropOnTopElevation()>=0?l.getElevation()+l.getHeight()*l.getDropOnTopElevation():0;o=[o[0],o[1],g]}}else if(l instanceof Wall&&null===l.getArcExtent()&&1===t.length){s=r.getVirtualWorldPointAt(n[0],n[1],a);var m=l,f=m.getPoints(),v=this.computeIntersection(s[0],s[1],this.home.getCamera().getX(),this.home.getCamera().getY(),f[0][0],f[0][1],f[1][0],f[1][1]),_=this.computeIntersection(s[0],s[1],this.home.getCamera().getX(),this.home.getCamera().getY(),f[3][0],f[3][1],f[2][0],f[2][1]);if(o=java.awt.geom.Point2D.distanceSq(this.home.getCamera().getX(),this.home.getCamera().getY(),v[0],v[1])<java.awt.geom.Point2D.distanceSq(this.home.getCamera().getX(),this.home.getCamera().getY(),_[0],_[1])?v:_,t[0]instanceof HomePieceOfFurniture){u=t[0];var S=Math.atan((m.getYEnd()-m.getYStart())/(m.getXEnd()-m.getXStart()));o[0]-=u.getWidth()/2*Math.cos(S),o[1]-=u.getWidth()/2*Math.sin(S)}}else if(!this.home.isEmpty()&&(o=[(o=r.getVirtualWorldPointAt(n[0],n[1],a))[0],o[1]],1===t.length&&t[0]instanceof HomePieceOfFurniture)){u=t[0];o[0]-=u.getWidth()/2,o[1]-=u.getDepth()/2}}return o},HomePane.prototype.computeIntersection=function(e,t,i,n,o,r,l,a){var s=i,h=n,u=(n-t)/(i-e),d=(a-r)/(l-o);if(u!==d)if(Math.abs(u)>4e3)Math.abs(d)<4e3&&(h=d*(s=e)+(a-d*l));else if(Math.abs(d)>4e3){if(Math.abs(u)<4e3)h=u*(s=o)+(c=n-u*i)}else{var c,p=u>0&&d>0||u<0&&d<0;if(Math.abs(u-d)>1e-5&&(!p||(Math.abs(u)>Math.abs(d)?u/d:d/u)>1.004))h=u*(s=(a-d*l-(c=n-u*i))/(u-d))+c}return[s,h]},HomePane.prototype.detachView=function(e){},HomePane.prototype.attachView=function(e){},HomePane.prototype.showOpenDialog=function(){},HomePane.prototype.showNewHomeFromExampleDialog=function(){},HomePane.prototype.confirmOpenDamagedHome=function(e,t,i){return!0},HomePane.prototype.showImportLanguageLibraryDialog=function(){},HomePane.prototype.confirmReplaceLanguageLibrary=function(e){return!0},HomePane.prototype.showImportFurnitureLibraryDialog=function(){},HomePane.prototype.confirmReplaceFurnitureLibrary=function(e){return!0},HomePane.prototype.showImportTexturesLibraryDialog=function(){},HomePane.prototype.confirmReplaceTexturesLibrary=function(e){return!0},HomePane.prototype.confirmReplacePlugin=function(e){return!0},HomePane.prototype.showSaveDialog=function(e){return null},HomePane.prototype.showError=function(e){alert(e.indexOf("<html>")<0?e:e.replace(/\<\/?\w+(\s+\w+\=[\"\'][^\"\']+[\"\'])*\>/g," ").replace(/\s+/g," "))},HomePane.prototype.showMessage=function(e){alert(e.indexOf("<html>")<0?e:e.replace(/\<\/?\w+(\s+\w+\=[\"\'][^\"\']+[\"\'])*\>/g," ").replace(/\s+/g," "))},HomePane.prototype.showActionTipMessage=function(e){return!1},HomePane.prototype.confirmSave=function(e,t){var i;i=null!=e?this.preferences.getLocalizedString("HomePane","confirmSave.message",'"'+e+'"'):this.preferences.getLocalizedString("HomePane","confirmSave.message"," ");var n=new JSDialog(this.preferences,this.preferences.getLocalizedString("HomePane","confirmSave.title"),i.replace(/\<br\>/," ")+"</font>",{size:"small",applier:function(){t(!0)}});n.findElement(".dialog-ok-button").innerHTML=this.preferences.getLocalizedString("HomePane","confirmSave.save");var o=n.findElement(".dialog-cancel-button");o.innerHTML=this.preferences.getLocalizedString("HomePane","confirmSave.cancel");var r=document.createElement("button");return r.innerHTML=this.preferences.getLocalizedString("HomePane","confirmSave.doNotSave"),n.registerEventListener(r,"click",(function(){n.close(),t(!1)})),o.parentElement.insertBefore(r,o),n.displayView(),HomeView.SaveAnswer.CANCEL},HomePane.prototype.confirmSaveNewerHome=function(e){return!0},HomePane.prototype.confirmExit=function(){return!0},HomePane.prototype.showAboutDialog=function(){var e=this.preferences.getLocalizedString("HomePane","about.message",this.controller.getVersion()),t="<table><tr><td><img src='"+ZIPTools.getScriptFolder()+this.preferences.getLocalizedString("HomePane","about.icon")+"'></td><td>"+e+"</td></tr></table>",i=new JSDialog(this.preferences,this.preferences.getLocalizedString("HomePane","about.title"),t,{size:"medium"});i.getHTMLElement().classList.add("about-dialog"),i.displayView()},HomePane.prototype.showUpdatesMessage=function(e,t){return!1},HomePane.prototype.showPrintDialog=function(){return null},HomePane.prototype.showPrintToPDFDialog=function(e){return null},HomePane.prototype.printToPDF=function(e){},HomePane.prototype.showExportToCSVDialog=function(e){return null},HomePane.prototype.exportToCSV=function(e){},HomePane.prototype.showExportToSVGDialog=function(e){return null},HomePane.prototype.exportToSVG=function(e){},HomePane.prototype.showExportToOBJDialog=function(e){return null},HomePane.prototype.exportToOBJ=function(e,t){},HomePane.prototype.confirmDeleteCatalogSelection=function(){return!0},HomePane.prototype.showStoreCameraDialog=function(e){return prompt(this.preferences.getLocalizedString("HomePane","showStoreCameraDialog.message"),e)},HomePane.prototype.showDeletedCamerasDialog=function(){var e=this,t=this.home.getStoredCameras();function i(){JSDialog.call(this,e.preferences,"@{HomePane.showDeletedCamerasDialog.title}","<div>@{HomePane.confirmDeleteCameras.message}</div>",{applier:function(t){e.controller.getHomeController3D().deleteCameras(t.selectedCameras)}});var t=this,i=this.findElement(".dialog-cancel-button");this.registerEventListener(i,"click",(function(e){t.cancel()}));var n=this.findElements(".dialog-ok-button");this.registerEventListener(n,"click",(function(e){t.validate()}))}i.prototype=Object.create(JSDialog.prototype),i.prototype.constructor=i,i.prototype.appendButtons=function(e){e.innerHTML=JSComponent.substituteWithLocale(this.preferences,"<button class='dialog-cancel-button'>@{HomePane.confirmDeleteCameras.cancel}</button><button class='dialog-ok-button'>@{HomePane.confirmDeleteCameras.delete}</button>")};for(var n="<div>@{HomePane.showDeletedCamerasDialog.message}</div><br />",o=0;o<t.length;o++)n+="<div><label><input type='checkbox' value='"+o+"' />"+t[o].getName()+"</label></div>";function r(){JSDialog.call(this,e.preferences,"@{HomePane.showDeletedCamerasDialog.title}",n,{applier:function(e){for(var n=e.findElements("input[type='checkbox']:checked"),o=[],r=0;r<n.length;r++){var l=parseInt(n[r].value),a=t[l];o.push(a)}if(o.length>0){var s=new i;s.selectedCameras=o,s.displayView()}}})}return r.prototype=Object.create(JSDialog.prototype),r.prototype.constructor=r,(new r).displayView(),null},HomePane.prototype.isClipboardEmpty=function(){return this.clipboardEmpty},HomePane.prototype.getClipboardItems=function(){return this.clipboard},HomePane.prototype.invokeLater=function(e){setTimeout(e)},HomePane.prototype.dispose=function(){this.setTransferEnabled(!1);var e=this.controller.getFurnitureCatalogController().getView(),t=this.controller.getFurnitureController().getView(),i=this.controller.getPlanController().getView(),n=this.controller.getHomeController3D().getView();if(null!=n&&n.dispose(),null!=i&&i.dispose(),null!=t&&t.dispose(),null!=e&&e.dispose(),null!=this.view3DPopupMenu&&document.body.removeChild(this.view3DPopupMenu.getHTMLElement()),null!=this.planPopupMenu&&document.body.removeChild(this.planPopupMenu.getHTMLElement()),null!=this.furniturePopupMenu&&document.body.removeChild(this.furniturePopupMenu.getHTMLElement()),null!=this.furnitureCatalogPopupMenu&&document.body.removeChild(this.furnitureCatalogPopupMenu.getHTMLElement()),this.levelSelector){for(;this.levelSelector.children.length>0;)this.levelSelector.removeChild(this.levelSelector.children[0]);this.levelSelector.removeEventListener("change",this.levelSelectorChangeListener)}document.removeEventListener("keydown",this.keydownListener),window.removeEventListener("resize",this.resizeListener);for(var o=[this.catalogFurnitureSplitter,this.furniturePlanSplitter,this.plan3DViewSplitter],r=0;r<o.length;r++){var l=o[r];l.element.removeEventListener("mousedown",l.mouseListener.mousePressed,!0),l.element.removeEventListener("touchstart",l.mouseListener.mousePressed,!0),window.removeEventListener("resize",l.mouseListener.windowResized)}var a=document.getElementById("application-menu-toolbar");if(null!=a){var s=a.children;for(r=s.length-1;r>=0;r--)a.removeChild(s[r])}var h=document.getElementById("home-pane-toolbar");for(r=(s=h.children).length-1;r>=0;r--)this.toolBarDefaultChildren.indexOf(s[r])<0&&h.removeChild(s[r]);this.getHTMLElement().removeEventListener("focusin",this.focusListener),this.preferences.removePropertyChangeListener("VALUE_ADDED_TAX_ENABLED",this.preferencesChangeListener),this.preferences.removePropertyChangeListener("CURRENCY",this.preferencesChangeListener),null!=this.furnitureCatalogListener&&this.preferences.getFurnitureCatalog().removeFurnitureListener(this.furnitureCatalogListener)},ModelManager.instance=null,ContentDigestManager.getInstance=function(){return null==ContentDigestManager.instance&&(ContentDigestManager.instance=new ContentDigestManager),ContentDigestManager.instance},ContentDigestManager.prototype.equals=function(e,t){var i=this.contentDigestsCache[e.getURL()];return null!=i&&i===this.contentDigestsCache[t.getURL()]},ContentDigestManager.prototype.setContentDigest=function(e,t){this.contentDigestsCache[e.getURL()]=t,this.permanentContents[t]=e},ContentDigestManager.prototype.getPermanentContentDigest=function(e){var t=this.contentDigestsCache[e.getURL()];if(void 0!==t){var i=this.permanentContents[t];if(void 0!==i)return i}return null},ContentDigestManager.prototype.getContentDigest=function(e,t){var i=this.contentDigestsCache[e.getURL()];if(void 0===i)if(e.isJAREntry())this.getZipContentDigest(e,t);else if(e instanceof LocalURLContent){var n=this;e.getBlob({blobReady:function(i){"application/zip"===i.type?n.getZipContentDigest(e,t):n.getURLContentDigest(e,t)},blobError:function(e,i){t.digestError(e,i)}})}else this.getURLContentDigest(e,t);else t.digestReady(e,i)},ContentDigestManager.prototype.getZipContentDigest=function(e,t){var i=this;ZIPTools.getZIP(e.isJAREntry()?e.getJAREntryURL():e.getURL(),!1,{zipReady:function(n){try{for(var o=e.isJAREntry()?e.getJAREntryName():"",r=e instanceof HomeURLContent?o.indexOf("/"):-1,l=o.substring(0,r+1),a=new Uint8Array(0),s=r>0||!(e instanceof HomeURLContent)?n.file(new RegExp("^"+l+".*")).sort((function(e,t){return e.name===t.name?0:e.name<t.name?1:-1})):[n.file(o)],h=s.length-1;h>=0;h--){var u=s[h];if(u.name!==l&&i.isSignificant(u.name)){var d=u.asUint8Array(),c=new Uint8Array(a.length+d.length);c.set(a),c.set(d,a.length),a=c}}i.computeContentDigest(a,(function(n){i.contentDigestsCache[e.getURL()]=n,t.digestReady(e,n)}))}catch(e){this.zipError(e)}},zipError:function(e){t.digestError(e,e.message)}})},ContentDigestManager.prototype.getURLContentDigest=function(e,t){var i=this;e.getStreamURL({urlReady:function(n){var o=new XMLHttpRequest;o.open("GET",n,!0),o.responseType="arraybuffer",o.addEventListener("load",(function(){i.computeContentDigest(o.response,(function(n){i.contentDigestsCache[e.getURL()]=n,t.digestReady(e,n)}))})),o.send()},urlError:function(e,i){t.digestError(e,i)}})},ContentDigestManager.prototype.computeContentDigest=function(e,t){var i,n=void 0!==window.msCrypto?window.msCrypto:window.crypto;try{i=n.subtle.digest("SHA-1",e)}catch(t){i=n.subtle.digest("SHA-256",e)}void 0!==i.then?i.then((function(e){t(btoa(String.fromCharCode.apply(null,new Uint8Array(e))))})):setTimeout((function(){t(btoa(String.fromCharCode.apply(null,new Uint8Array(i.result))))}))},ContentDigestManager.prototype.isSignificant=function(e){var t=e.toUpperCase();return"LICENSE.TXT"!==t&&-1===t.indexOf("/LICENSE.TXT",t.length-12)},DefaultFurnitureCatalog.prototype=Object.create(FurnitureCatalog.prototype),DefaultFurnitureCatalog.prototype.constructor=DefaultFurnitureCatalog,DefaultFurnitureCatalog.__class="com.eteks.sweethome3d.io.DefaultFurnitureCatalog",DefaultFurnitureCatalog.furnitureAdditionalKeys={},DefaultFurnitureCatalog.prototype.getLibraries=function(){return this.libraries.slice(0)},DefaultFurnitureCatalog.prototype.readDefaultFurnitureCatalogs=function(e,t){this.readFurnitureCatalog("DefaultFurnitureCatalog",e,t)},DefaultFurnitureCatalog.prototype.readFurnitureCatalog=function(e,t,i){this.readFurniture(t.getResourceBundles(e),null,null,i)},DefaultFurnitureCatalog.prototype.readFurniture=function(e,t,i,n){for(var o=0;;){var r=0;try{r=CoreTools.getStringFromKey(e,this.getKey("ignored",++o))}catch(e){r=null}if(null!=r&&this.parseBoolean(r))this.getContent(e,this.getKey(DefaultFurnitureCatalog.PropertyKey.ICON,o),this.getKey(DefaultFurnitureCatalog.PropertyKey.ICON_DIGEST,o),t,i,!1,!0),this.getContent(e,this.getKey(DefaultFurnitureCatalog.PropertyKey.PLAN_ICON,o),this.getKey(DefaultFurnitureCatalog.PropertyKey.PLAN_ICON_DIGEST,o),t,i,!1,!0),this.getContent(e,this.getKey(DefaultFurnitureCatalog.PropertyKey.MODEL,o),this.getKey(DefaultFurnitureCatalog.PropertyKey.MODEL_DIGEST,o),t,i,!1,!0);else{var l=null==r?this.readPieceOfFurniture(e,o,t,i):null;if(null==l)break;if(null!=l.getId()){if(-1!==n.indexOf(l.getId()))continue;n.push(l.getId())}var a=this.readFurnitureCategory(e,o);this.add(a,l)}}},DefaultFurnitureCatalog.prototype.getAdditionalProperties=function(e,t){var i=this.getCatalogAdditionalProperties(e)[t.toString()];if(null!=i){var n={};for(var o in i){var r=i[o];r.getType()!==ObjectProperty.Type.CONTENT&&(n[r.getName()]=CoreTools.getStringFromKey(e,o))}return n}return{}},DefaultFurnitureCatalog.prototype.getAdditionalContents=function(e,t,i,n){var o=this.getCatalogAdditionalProperties(e)[t.toString()];if(null!=o){var r={};for(var l in o){var a=o[l];a.getType()===ObjectProperty.Type.CONTENT&&(r[a.getName()]=this.getContent(e,l,null,i,n,!1,!0))}return r}return{}},DefaultFurnitureCatalog.prototype.getCatalogAdditionalProperties=function(e){var t=CoreTools.getFromMap(DefaultFurnitureCatalog.furnitureAdditionalKeys,e);if(null==t){t={},CoreTools.putToMap(DefaultFurnitureCatalog.furnitureAdditionalKeys,e,t);for(var i=CoreTools.getKeys(e),n=0;n<i.length;n++){var o=i[n],r=o.lastIndexOf("#");if(-1!==r&&r+1<o.length){var l=o.indexOf(":",r+1),a=parseInt(o.substring(r+1,-1!=l?l:o.length).trim());if(!isNaN(a)){var s=o.substring(0,r);if(!this.isDefaultProperty(s)){var h=t[a.toString()];null==h&&(h={},t[a.toString()]=h);var u=null;if(l>0){var d=o.substring(l+1);d.length>0&&void 0===(u=ObjectProperty.Type[d])&&(u=null)}h[o]=new ObjectProperty(s,u)}}}}}return t},DefaultFurnitureCatalog.prototype.isDefaultProperty=function(e){try{return DefaultFurnitureCatalog.PropertyKey.fromPrefix(e),!0}catch(t){return"ignored"==e}},DefaultFurnitureCatalog.prototype.readPieceOfFurniture=function(e,t,i,n){var o=null;try{o=CoreTools.getStringFromKey(e,this.getKey(DefaultFurnitureCatalog.PropertyKey.NAME,t))}catch(e){return null}var r,l=this.getOptionalString(e,this.getKey(DefaultFurnitureCatalog.PropertyKey.ID,t),null),a=this.getOptionalString(e,this.getKey(DefaultFurnitureCatalog.PropertyKey.DESCRIPTION,t),null),s=this.getOptionalString(e,this.getKey(DefaultFurnitureCatalog.PropertyKey.INFORMATION,t),null),h=this.getOptionalString(e,this.getKey(DefaultFurnitureCatalog.PropertyKey.LICENSE,t),null),u=this.getOptionalString(e,this.getKey(DefaultFurnitureCatalog.PropertyKey.TAGS,t),null);r=null!=u?u.split(/\s*,\s*/):[];var d=this.getOptionalString(e,this.getKey(DefaultFurnitureCatalog.PropertyKey.CREATION_DATE,t),null),c=null;if(null!=d)try{var p=d.split(/-/);c=new Date(p[0],p[1],p[2]).getTime()}catch(e){throw new IllegalArgumentException("Can't parse date "+d,e)}var g=this.getOptionalString(e,this.getKey(DefaultFurnitureCatalog.PropertyKey.GRADE,t),null),m=null;null!=g&&(m=parseFloat(g));var f=this.getContent(e,this.getKey(DefaultFurnitureCatalog.PropertyKey.ICON,t),this.getKey(DefaultFurnitureCatalog.PropertyKey.ICON_DIGEST,t),i,n,!1,!1),v=this.getContent(e,this.getKey(DefaultFurnitureCatalog.PropertyKey.PLAN_ICON,t),this.getKey(DefaultFurnitureCatalog.PropertyKey.PLAN_ICON_DIGEST,t),i,n,!1,!0),_=this.getOptionalBoolean(e,this.getKey(DefaultFurnitureCatalog.PropertyKey.MULTI_PART_MODEL,t),!1),S=this.getContent(e,this.getKey(DefaultFurnitureCatalog.PropertyKey.MODEL,t),this.getKey(DefaultFurnitureCatalog.PropertyKey.MODEL_DIGEST,t),i,n,_,!1),y=parseFloat(CoreTools.getStringFromKey(e,this.getKey(DefaultFurnitureCatalog.PropertyKey.WIDTH,t))),E=parseFloat(CoreTools.getStringFromKey(e,this.getKey(DefaultFurnitureCatalog.PropertyKey.DEPTH,t))),C=parseFloat(CoreTools.getStringFromKey(e,this.getKey(DefaultFurnitureCatalog.PropertyKey.HEIGHT,t))),P=this.getOptionalFloat(e,this.getKey(DefaultFurnitureCatalog.PropertyKey.ELEVATION,t),0),w=this.getOptionalFloat(e,this.getKey(DefaultFurnitureCatalog.PropertyKey.DROP_ON_TOP_ELEVATION,t),C)/C,L=this.parseBoolean(CoreTools.getStringFromKey(e,this.getKey(DefaultFurnitureCatalog.PropertyKey.MOVABLE,t))),T=this.parseBoolean(CoreTools.getStringFromKey(e,this.getKey(DefaultFurnitureCatalog.PropertyKey.DOOR_OR_WINDOW,t))),A=this.getOptionalString(e,this.getKey(DefaultFurnitureCatalog.PropertyKey.STAIRCASE_CUT_OUT_SHAPE,t),null),I=this.getModelRotation(e,this.getKey(DefaultFurnitureCatalog.PropertyKey.MODEL_ROTATION,t)),b=this.getOptionalString(e,this.getKey(DefaultFurnitureCatalog.PropertyKey.MODEL_FLAGS,t),null),O=0;null!=b&&(O=parseInt(b));var M=this.getOptionalString(e,this.getKey(DefaultFurnitureCatalog.PropertyKey.MODEL_SIZE,t),null),D=null;null!=M&&(D=parseInt(M));var R=this.getOptionalString(e,this.getKey(DefaultFurnitureCatalog.PropertyKey.CREATOR,t),null),F=this.getOptionalBoolean(e,this.getKey(DefaultFurnitureCatalog.PropertyKey.RESIZABLE,t),!0),x=this.getOptionalBoolean(e,this.getKey(DefaultFurnitureCatalog.PropertyKey.DEFORMABLE,t),!0),N=this.getOptionalBoolean(e,this.getKey(DefaultFurnitureCatalog.PropertyKey.TEXTURABLE,t),!0),k=this.getOptionalBoolean(e,this.getKey(DefaultFurnitureCatalog.PropertyKey.HORIZONTALLY_ROTATABLE,t),!0),H=null;try{H=new Big(CoreTools.getStringFromKey(e,this.getKey(DefaultFurnitureCatalog.PropertyKey.PRICE,t)))}catch(e){}var V=null;try{V=new Big(CoreTools.getStringFromKey(e,this.getKey(DefaultFurnitureCatalog.PropertyKey.VALUE_ADDED_TAX_PERCENTAGE,t)))}catch(e){}var U=this.getOptionalString(e,this.getKey(DefaultFurnitureCatalog.PropertyKey.CURRENCY,t),null),W=this.getAdditionalProperties(e,t),B=this.getAdditionalContents(e,t,i,n);if(T){var G=this.getOptionalString(e,this.getKey(DefaultFurnitureCatalog.PropertyKey.DOOR_OR_WINDOW_CUT_OUT_SHAPE,t),null),Y=this.getOptionalFloat(e,this.getKey(DefaultFurnitureCatalog.PropertyKey.DOOR_OR_WINDOW_WALL_THICKNESS,t),E)/E,$=this.getOptionalFloat(e,this.getKey(DefaultFurnitureCatalog.PropertyKey.DOOR_OR_WINDOW_WALL_DISTANCE,t),0)/E,X=this.getOptionalBoolean(e,this.getKey(DefaultFurnitureCatalog.PropertyKey.DOOR_OR_WINDOW_WALL_CUT_OUT_ON_BOTH_SIDES,t),!0),z=this.getOptionalBoolean(e,this.getKey(DefaultFurnitureCatalog.PropertyKey.DOOR_OR_WINDOW_WIDTH_DEPTH_DEFORMABLE,t),!0),j=this.getDoorOrWindowSashes(e,t,y,E);return new CatalogDoorOrWindow(l,o,a,s,h,r,c,m,f,v,S,y,E,C,P,w,L,G,Y,$,X,z,j,I,O,D,R,F,x,N,H,V,U,W,B)}var K=this.getLightSources(e,t,y,E,C),J=this.getOptionalString(e,this.getKey(DefaultFurnitureCatalog.PropertyKey.LIGHT_SOURCE_MATERIAL_NAME,t),null),q=null!=J?J.split(/ +/):null;if(null!=K||null!=q)return new CatalogLight(l,o,a,s,h,r,c,m,f,v,S,y,E,C,P,w,L,K,q,A,I,O,D,R,F,x,N,k,H,V,U,W,B);var Z=this.getShelfElevations(e,t,C),Q=this.getShelfBoxes(e,t,y,E,C);return null!=Z||null!=Q?new CatalogShelfUnit(l,o,a,s,h,r,c,m,f,v,S,y,E,C,P,w,Z,Q,L,A,I,O,D,R,F,x,N,k,H,V,U,W,B):new CatalogPieceOfFurniture(l,o,a,s,h,r,c,m,f,v,S,y,E,C,P,w,L,A,I,O,D,R,F,x,N,k,H,V,U,W,B)},DefaultFurnitureCatalog.prototype.readFurnitureCategory=function(e,t){var i=CoreTools.getStringFromKey(e,this.getKey(DefaultFurnitureCatalog.PropertyKey.CATEGORY,t));return new FurnitureCategory(i)},DefaultFurnitureCatalog.prototype.getContent=function(e,t,i,n,o,r,l){var a=l?this.getOptionalString(e,t,null):CoreTools.getStringFromKey(e,t);if(l&&null==a)return null;var s=null;s=null!=o?o+a:a,a.indexOf("!/")>=0&&0!==a.indexOf("jar:")&&(s="jar:"+s);var h=URLContent.fromURL(s),u=this.getOptionalString(e,i,null);return null!=u&&u.length>0&&ContentDigestManager.getInstance().setContentDigest(h,u),h},DefaultFurnitureCatalog.prototype.getModelRotation=function(e,t){try{var i=CoreTools.getStringFromKey(e,t).split(/ +/,9);return 9===i.length?[[parseFloat(i[0]),parseFloat(i[1]),parseFloat(i[2])],[parseFloat(i[3]),parseFloat(i[4]),parseFloat(i[5])],[parseFloat(i[6]),parseFloat(i[7]),parseFloat(i[8])]]:null}catch(e){return null}},DefaultFurnitureCatalog.prototype.getDoorOrWindowSashes=function(e,t,i,n){var o,r=this.getOptionalString(e,this.getKey(DefaultFurnitureCatalog.PropertyKey.DOOR_OR_WINDOW_SASH_X_AXIS,t),null);if(null!=r){var l=r.split(/ +/),a=CoreTools.getStringFromKey(e,this.getKey(DefaultFurnitureCatalog.PropertyKey.DOOR_OR_WINDOW_SASH_Y_AXIS,t)).split(/ +/);if(a.length!==l.length)throw new IllegalArgumentException("Expected "+l.length+" values in "+this.getKey(DefaultFurnitureCatalog.PropertyKey.DOOR_OR_WINDOW_SASH_Y_AXIS,t)+" key");var s=CoreTools.getStringFromKey(e,this.getKey(DefaultFurnitureCatalog.PropertyKey.DOOR_OR_WINDOW_SASH_WIDTH,t)).split(/ +/);if(s.length!==l.length)throw new IllegalArgumentException("Expected "+l.length+" values in "+this.getKey(DefaultFurnitureCatalog.PropertyKey.DOOR_OR_WINDOW_SASH_WIDTH,t)+" key");var h=CoreTools.getStringFromKey(e,this.getKey(DefaultFurnitureCatalog.PropertyKey.DOOR_OR_WINDOW_SASH_START_ANGLE,t)).split(/ +/);if(h.length!==l.length)throw new IllegalArgumentException("Expected "+l.length+" values in "+this.getKey(DefaultFurnitureCatalog.PropertyKey.DOOR_OR_WINDOW_SASH_START_ANGLE,t)+" key");var u=CoreTools.getStringFromKey(e,this.getKey(DefaultFurnitureCatalog.PropertyKey.DOOR_OR_WINDOW_SASH_END_ANGLE,t)).split(/ +/);if(u.length!==l.length)throw new IllegalArgumentException("Expected "+l.length+" values in "+this.getKey(DefaultFurnitureCatalog.PropertyKey.DOOR_OR_WINDOW_SASH_END_ANGLE,t)+" key");o=new Array(l.length);for(var d=0;d<o.length;d++)o[d]=new Sash(parseFloat(l[d])/i,parseFloat(a[d])/n,parseFloat(s[d])/i,parseFloat(h[d])*Math.PI/180,parseFloat(u[d])*Math.PI/180)}else o=[];return o},DefaultFurnitureCatalog.prototype.getLightSources=function(e,t,i,n,o){var r=null,l=this.getOptionalString(e,this.getKey(DefaultFurnitureCatalog.PropertyKey.LIGHT_SOURCE_X,t),null);if(null!=l){var a=l.split(/ +/),s=CoreTools.getStringFromKey(e,this.getKey(DefaultFurnitureCatalog.PropertyKey.LIGHT_SOURCE_Y,t)).split(/ +/);if(s.length!==a.length)throw new IllegalArgumentException("Expected "+a.length+" values in "+this.getKey(DefaultFurnitureCatalog.PropertyKey.LIGHT_SOURCE_Y,t)+" key");var h=CoreTools.getStringFromKey(e,this.getKey(DefaultFurnitureCatalog.PropertyKey.LIGHT_SOURCE_Z,t)).split(/ +/);if(h.length!==a.length)throw new IllegalArgumentException("Expected "+a.length+" values in "+this.getKey(DefaultFurnitureCatalog.PropertyKey.LIGHT_SOURCE_Z,t)+" key");var u=CoreTools.getStringFromKey(e,this.getKey(DefaultFurnitureCatalog.PropertyKey.LIGHT_SOURCE_COLOR,t)).split(/ +/);if(u.length!==a.length)throw new IllegalArgumentException("Expected "+a.length+" values in "+this.getKey(DefaultFurnitureCatalog.PropertyKey.LIGHT_SOURCE_COLOR,t)+" key");var d=this.getOptionalString(e,this.getKey(DefaultFurnitureCatalog.PropertyKey.LIGHT_SOURCE_DIAMETER,t),null),c=null;if(null!=d){if((c=d.split(/ +/)).length!==a.length)throw new IllegalArgumentException("Expected "+a.length+" values in "+this.getKey(DefaultFurnitureCatalog.PropertyKey.LIGHT_SOURCE_DIAMETER,t)+" key")}else c=null;r=new Array(a.length);for(var p=0;p<r.length;p++){var g=0===u[p].indexOf("#")?parseInt(u[p].substring(1),16):parseInt(u[p]);r[p]=new LightSource(parseFloat(a[p])/i,parseFloat(s[p])/n,parseFloat(h[p])/o,g,null!=c?parseFloat(c[p])/i:null)}}return r},DefaultFurnitureCatalog.prototype.getShelfElevations=function(e,t,i){var n=null,o=this.getOptionalString(e,this.getKey(DefaultFurnitureCatalog.PropertyKey.SHELF_ELEVATIONS,t),null);if(null!=o){var r=o.split(/ +/);n=new Array(r.length);for(var l=0;l<r.length;l++)n[l]=parseFloat(r[l])/i}return n},DefaultFurnitureCatalog.prototype.getShelfBoxes=function(e,t,i,n,o){var r=null,l=this.getOptionalString(e,this.getKey(DefaultFurnitureCatalog.PropertyKey.SHELF_BOXES,t),null);if(null!=l){var a=l.split(/ +/);if(a.length%6!=0)throw new IllegalArgumentException("Expected a multiple of 6 values in "+this.getKey(DefaultFurnitureCatalog.PropertyKey.SHELF_BOXES,t)+" key");r=new Array(a.length/6);for(var s=0;s<r.length;s++)r[s]=new BoxBounds(parseFloat(a[6*s])/i,parseFloat(a[6*s+1])/n,parseFloat(a[6*s+2])/o,parseFloat(a[6*s+3])/i,parseFloat(a[6*s+4])/n,parseFloat(a[6*s+5])/o)}return r},DefaultFurnitureCatalog.prototype.getOptionalString=function(e,t,i){try{return CoreTools.getStringFromKey(e,t)}catch(e){return i}},DefaultFurnitureCatalog.prototype.getOptionalFloat=function(e,t,i){try{return parseFloat(CoreTools.getStringFromKey(e,t))}catch(e){return i}},DefaultFurnitureCatalog.prototype.getOptionalBoolean=function(e,t,i){try{return this.parseBoolean(CoreTools.getStringFromKey(e,t))}catch(e){return i}},DefaultFurnitureCatalog.prototype.parseBoolean=function(e){return"true"==e},DefaultFurnitureCatalog.prototype.getKey=function(e,t){return e+"#"+t},DefaultFurnitureCatalog.PropertyKey={ID:"id",NAME:"name",DESCRIPTION:"description",INFORMATION:"information",LICENSE:"license",TAGS:"tags",CREATION_DATE:"creationDate",GRADE:"grade",CATEGORY:"category",ICON:"icon",ICON_DIGEST:"iconDigest",PLAN_ICON:"planIcon",PLAN_ICON_DIGEST:"planIconDigest",MODEL:"model",MODEL_SIZE:"modelSize",MODEL_DIGEST:"modelDigest",MULTI_PART_MODEL:"multiPartModel",WIDTH:"width",DEPTH:"depth",HEIGHT:"height",MOVABLE:"movable",DOOR_OR_WINDOW:"doorOrWindow",DOOR_OR_WINDOW_CUT_OUT_SHAPE:"doorOrWindowCutOutShape",DOOR_OR_WINDOW_WALL_THICKNESS:"doorOrWindowWallThickness",DOOR_OR_WINDOW_WALL_DISTANCE:"doorOrWindowWallDistance",DOOR_OR_WINDOW_WALL_CUT_OUT_ON_BOTH_SIDES:"doorOrWindowWallCutOutOnBothSides",DOOR_OR_WINDOW_WIDTH_DEPTH_DEFORMABLE:"doorOrWindowWidthDepthDeformable",DOOR_OR_WINDOW_SASH_X_AXIS:"doorOrWindowSashXAxis",DOOR_OR_WINDOW_SASH_Y_AXIS:"doorOrWindowSashYAxis",DOOR_OR_WINDOW_SASH_WIDTH:"doorOrWindowSashWidth",DOOR_OR_WINDOW_SASH_START_ANGLE:"doorOrWindowSashStartAngle",DOOR_OR_WINDOW_SASH_END_ANGLE:"doorOrWindowSashEndAngle",LIGHT_SOURCE_X:"lightSourceX",LIGHT_SOURCE_Y:"lightSourceY",LIGHT_SOURCE_Z:"lightSourceZ",LIGHT_SOURCE_COLOR:"lightSourceColor",LIGHT_SOURCE_DIAMETER:"lightSourceDiameter",LIGHT_SOURCE_MATERIAL_NAME:"lightSourceMaterialName",STAIRCASE_CUT_OUT_SHAPE:"staircaseCutOutShape",ELEVATION:"elevation",DROP_ON_TOP_ELEVATION:"dropOnTopElevation",SHELF_ELEVATIONS:"shelfElevations",SHELF_BOXES:"shelfBoxes",MODEL_ROTATION:"modelRotation",CREATOR:"creator",RESIZABLE:"resizable",DEFORMABLE:"deformable",TEXTURABLE:"texturable",HORIZONTALLY_ROTATABLE:"horizontallyRotatable",PRICE:"price",VALUE_ADDED_TAX_PERCENTAGE:"valueAddedTaxPercentage",CURRENCY:"currency",getKey:function(e,t){return e+"#"+t},fromPrefix:function(e){for(var t in DefaultFurnitureCatalog.PropertyKey)if(DefaultFurnitureCatalog.PropertyKey[t]==e)return t;throw new IllegalArgumentException("Unknow prefix "+e)}},DefaultTexturesCatalog.prototype=Object.create(TexturesCatalog.prototype),DefaultTexturesCatalog.prototype.constructor=DefaultTexturesCatalog,DefaultTexturesCatalog.__class="com.eteks.sweethome3d.io.DefaultTexturesCatalog",DefaultTexturesCatalog.texturesAdditionalKeys={},DefaultTexturesCatalog.prototype.getLibraries=function(){return this.libraries.slice(0)},DefaultTexturesCatalog.prototype.readDefaultTexturesCatalogs=function(e,t){this.readTexturesCatalog("DefaultTexturesCatalog",e,t)},DefaultTexturesCatalog.prototype.readTexturesCatalog=function(e,t,i){this.readTextures(t.getResourceBundles(e),null,null,i)},DefaultTexturesCatalog.prototype.readTextures=function(e,t,i,n){for(var o=0;;){var r=0;try{r=CoreTools.getStringFromKey(e,this.getKey("ignored",++o))}catch(e){r=null}if(null==r||"true"!=r){var l=null==r?this.readTexture(e,o,t,i):null;if(null==l)break;if(null!=l.getId()){if(-1!==n.indexOf(l.getId()))continue;n.push(l.getId())}var a=this.readTexturesCategory(e,o);this.add(a,l)}else this.getContent(e,this.getKey(DefaultTexturesCatalog.PropertyKey.IMAGE,o),this.getKey(DefaultTexturesCatalog.PropertyKey.ICON_DIGEST,o),t,i,!0)}},DefaultTexturesCatalog.prototype.readTexture=function(e,t,i,n){var o=null;try{o=CoreTools.getStringFromKey(e,this.getKey(DefaultTexturesCatalog.PropertyKey.NAME,t))}catch(e){return null}var r=this.getContent(e,this.getKey(DefaultTexturesCatalog.PropertyKey.IMAGE,t),this.getKey(DefaultTexturesCatalog.PropertyKey.IMAGE_DIGEST,t),i,n,!1),l=parseFloat(CoreTools.getStringFromKey(e,this.getKey(DefaultTexturesCatalog.PropertyKey.WIDTH,t))),a=parseFloat(CoreTools.getStringFromKey(e,this.getKey(DefaultTexturesCatalog.PropertyKey.HEIGHT,t))),s=this.getOptionalString(e,this.getKey(DefaultTexturesCatalog.PropertyKey.CREATOR,t),null),h=this.getOptionalString(e,this.getKey(DefaultTexturesCatalog.PropertyKey.ID,t),null);return new CatalogTexture(h,o,r,l,a,s)},DefaultTexturesCatalog.prototype.readTexturesCategory=function(e,t){var i=CoreTools.getStringFromKey(e,this.getKey(DefaultTexturesCatalog.PropertyKey.CATEGORY,t));return new TexturesCategory(i)},DefaultTexturesCatalog.prototype.getContent=function(e,t,i,n,o,r){var l=r?this.getOptionalString(e,t,null):CoreTools.getStringFromKey(e,t);if(r&&null==l)return null;var a=null;a=null!=o?o+l:l;var s=URLContent.fromURL(a),h=this.getOptionalString(e,i,null);return null!=h&&h.length>0&&ContentDigestManager.getInstance().setContentDigest(s,h),s},DefaultTexturesCatalog.prototype.getOptionalString=function(e,t,i){try{return CoreTools.getStringFromKey(e,t)}catch(e){return i}},DefaultTexturesCatalog.prototype.getKey=function(e,t){return e+"#"+t},DefaultTexturesCatalog.PropertyKey={ID:"id",NAME:"name",CATEGORY:"category",IMAGE:"image",IMAGE_DIGEST:"imageDigest",WIDTH:"width",HEIGHT:"height",CREATOR:"creator",getKey:function(e,t){return e+"#"+t}},FurnitureCatalogListPanel.prototype.getHTMLElement=function(){return this.container},FurnitureCatalogListPanel.prototype.createComponents=function(e,t,i){var n=this,o=this.container.getElementsByClassName("furniture-catalog-list")[0];this.catalog=e,this.toolTipDiv=document.createElement("div"),this.toolTipDiv.classList.add("furniture-tooltip"),this.toolTipDiv.style.display="none",this.toolTipDiv.style.position="absolute",document.body.appendChild(this.toolTipDiv);var r=document.createElement("div");r.id="furniture-filter",this.container.insertBefore(r,o);var l=document.createElement("select");this.categorySelector=l;var a=document.createElement("input");this.searchInput=a;var s=function(){var e=CoreTools.removeAccents(a.value.trim()).replace(/[.*+?^${}()|[\]\\]/g," "),t=e.split(" ");n.filterCatalog(l.selectedIndex,(function(i){if(""==e)return!0;var n=i.getName()+"|"+i.getCategory().getName()+"|"+i.getTags().join("|");null!==i.getCreator()&&(n+="|"+i.getCreator()),n=CoreTools.removeAccents(n);for(var o=1;o<t.length;o++)if(!RegExp(t[o],"i").test(n))return!1;return RegExp(t[0],"i").test(n)}))};l.id="furniture-category-select";var h,u=document.createElement("option"),d=t.getLocalizedString("FurnitureCatalogListPanel","categoryFilterComboBox.noCategory");u.value=u.text=d,l.appendChild(u);for(var c=0;c<e.getCategories().length;c++){var p=document.createElement("option");p.value=p.text=e.getCategories()[c].getName(),l.appendChild(p)}l.addEventListener("change",s),l.addEventListener("mousemove",(function(e){n.hideTooltip(),e.stopPropagation()})),r.appendChild(l),a.setAttribute("type","text"),a.id="furniture-search-field",a.placeholder=ResourceAction.getLocalizedLabelText(t,"FurnitureCatalogListPanel","searchLabel.text").replace(":",""),a.addEventListener("input",s),a.addEventListener("mousemove",(function(e){n.hideTooltip(),e.stopPropagation()})),o.addEventListener("click",(function(e){var t=a.getBoundingClientRect();e.clientX>=t.left&&e.clientX<=t.right&&e.clientY>=t.top&&e.clientY<=t.bottom||n.searchInput.blur()})),a.addEventListener("focusin",(function(e){a.classList.remove("partly-expanded"),a.classList.contains("expanded")||(a.classList.add("expanded"),setTimeout((function(){""!=a.value&&a.select(),0==document.body.scrollTop&&window.scrollTo(0,n.container.getBoundingClientRect().top)}),100))})),a.addEventListener("focusout",(function(e){a.classList.contains("expanded")&&(a.classList.remove("expanded"),""!=a.value.trim()&&a.classList.add("partly-expanded"))})),a.addEventListener("keydown",(function(e){27==e.keyCode&&(a.value="",(e=document.createEvent("Event")).initEvent("input",!0,!0),a.dispatchEvent(e));e.stopPropagation()})),r.appendChild(a),this.resetFurnitureCatalog(e),window.addEventListener("mousemove",(function(e){var t=n.container.getBoundingClientRect(),i=e;i.clientX>=t.left&&i.clientX<t.left+t.width&&i.clientY>=t.top&&i.clientY<t.top+t.height?"none"==n.toolTipDiv.style.display?(n.showTooltipTimeout&&clearTimeout(n.showTooltipTimeout),n.showTooltipTimeout=setTimeout((function(){void 0!==n.currentFurnitureContainer&&(h=n.currentFurnitureContainer,n.showTooltip(h,e),n.hideTooltipTimeout||(n.hideTooltipTimeout=setTimeout((function(){n.hideTooltip()}),3e3)))}),1e3)):(h!==n.currentFurnitureContainer&&(h=n.currentFurnitureContainer,n.showTooltip(h,e)),n.hideTooltipTimeout&&clearTimeout(n.hideTooltipTimeout),n.hideTooltipTimeout=setTimeout((function(){n.hideTooltip()}),3e3)):(n.currentFurnitureContainer=void 0,n.hideTooltip())})),o.addEventListener("mouseleave",(function(e){n.hideTooltip()})),this.languageChangeListener=function(e){document.getElementById("furniture-search-field").placeholder=ResourceAction.getLocalizedLabelText(t,"FurnitureCatalogListPanel","searchLabel.text").replace(":","");var i=t.getLocalizedString("FurnitureCatalogListPanel","categoryFilterComboBox.noCategory");u.value=u.text=i},t.addPropertyChangeListener("LANGUAGE",this.languageChangeListener),e.addFurnitureListener((function(t){var i=t.getItem().getCategory(),o=e.getCategories(),r=l.childNodes;if(-1===o.indexOf(i)){for(var a=0;a<r.length;a++)if(r[a].value==i.getName()){l.removeChild(r[a]);break}}else if(t.getType()===CollectionEvent.Type.ADD){var s=r.length;for(a=1;a<r.length;a++){if(r[a].value==i.getName()){s=-1;break}if(r[a].value>i.getName()){s=a;break}}s>=0&&((p=document.createElement("option")).value=p.text=i.getName(),s===r.length?l.appendChild(p):l.insertBefore(p,r[s]))}n.furnitureCatalogUpdater||(n.furnitureCatalogUpdater=function(){n.resetFurnitureCatalog(e),delete n.furnitureCatalogUpdater},setTimeout(n.furnitureCatalogUpdater,0))}))},FurnitureCatalogListPanel.prototype.findCategoryElements=function(e){for(var t=[],i=this.container.getElementsByClassName("furniture-catalog-list")[0],n=0;n<i.childNodes.length;n++)i.childNodes[n].category===e&&t.push(i.childNodes[n]);return t},FurnitureCatalogListPanel.prototype.filterCatalog=function(e,t){for(var i=this.container.getElementsByClassName("furniture-catalog-list")[0],n=0;n<i.childNodes.length;n++)i.childNodes[n]instanceof HTMLElement&&"furniture-filter"!==i.childNodes[n].id&&(void 0===i.childNodes[n]._displayBackup&&(i.childNodes[n]._displayBackup=i.childNodes[n].style.display),i.childNodes[n].style.display="none");var o=null==e||0===e?this.catalog.getCategories():[this.catalog.getCategories()[e-1]];for(n=0;n<o.length;n++){var r=o[n],l=null==t?r.getFurniture():r.getFurniture().filter(t);if(null!=l&&l.length>0)this.findCategoryElements(r).forEach((function(e){o.length>1&&(e.classList.contains("furniture-category-label")||e.classList.contains("furniture-category-separator"))&&(e.style.display=e._displayBackup),e.piece&&-1!==l.indexOf(e.piece)&&(e.style.display=e._displayBackup)}))}},FurnitureCatalogListPanel.prototype.clearFurnitureCatalog=function(e){for(var t=this.container.getElementsByClassName("furniture-catalog-list")[0],i=t.getElementsByClassName("furniture-category-label"),n=i.length-1;n>=0;n--)t.removeChild(i[n]);for(n=(i=t.getElementsByClassName("furniture")).length-1;n>=0;n--)t.removeChild(i[n]);for(n=(i=t.getElementsByClassName("furniture-category-separator")).length-1;n>=0;n--)t.removeChild(i[n])},FurnitureCatalogListPanel.prototype.resetFurnitureCatalog=function(e){this.clearFurnitureCatalog();for(var t=this.container.getElementsByClassName("furniture-catalog-list")[0],i=0;i<e.getCategoriesCount();i++){var n=e.getCategories()[i],o=document.createElement("div");o.className="furniture-category-label",o.innerHTML=n.getName(),o.category=n,t.appendChild(o);for(var r=0;r<n.getFurnitureCount();r++){var l=n.getFurniture()[r],a=document.createElement("div");a.pieceOfFurniture=l,a.className="furniture",a.innerHTML='<div class="furniture-label">'+l.getName()+"</div>",t.appendChild(a),this.createPieceOfFurniturePanel(a,l),a.category=n,a.piece=l}if(i<e.getCategoriesCount()-1){var s=document.createElement("div");s.className="furniture-category-separator",s.category=n,t.appendChild(s)}}},FurnitureCatalogListPanel.prototype.createPieceOfFurniturePanel=function(e,t){var i=this;e.addEventListener("mousemove",(function(t){i.currentFurnitureContainer=e})),e.addEventListener("mousedown",(function(n){if(0===n.button){for(var o=i.container.querySelectorAll(".furniture"),r=0;r<o.length;r++)o[r].classList.remove("selected");e.classList.add("selected"),i.controller.setSelectedFurniture([t]),i.hideTooltip()}}));var n=function(n){var o=e.getBoundingClientRect();if(0===n.touches.length&&1===n.changedTouches.length&&n.changedTouches[0].clientX>=o.left&&n.changedTouches[0].clientX<o.left+o.width&&n.changedTouches[0].clientY>=o.top&&n.changedTouches[0].clientY<o.top+o.height){for(var r=i.container.querySelectorAll(".furniture"),l=0;l<r.length;l++)r[l].classList.remove("selected");e.classList.add("selected"),i.container.focus(),i.controller.setSelectedFurniture([t])}};if(OperatingSystem.isInternetExplorerOrLegacyEdge()&&window.PointerEvent){e.addEventListener("pointerup",(function(e){"mouse"!=e.pointerType&&(e.touches=[],e.changedTouches=[{clientX:e.clientX,clientY:e.clientY}],n(e),e.preventDefault())})),e.addEventListener("pointerdown",(function(e){"mouse"!=e.pointerType&&e.preventDefault()}));e.addEventListener("mousedown",(function(e){e.preventDefault()}))}else e.addEventListener("touchend",n);TextureManager.getInstance().loadTexture(t.icon,{textureUpdated:function(t){t.classList.add("furniture-icon"),e.appendChild(t)},textureError:function(e){console.log("Image cannot be loaded",e)}})},FurnitureCatalogListPanel.prototype.showTooltip=function(e,t){var i=e.querySelector("img.furniture-icon");if(null!==i){this.toolTipDiv.style.left=t.clientX+10+"px",this.toolTipDiv.style.top=t.clientY+10+"px",this.toolTipDiv.style.display="block",this.toolTipDiv.innerHTML=this.createCatalogItemTooltipText(e.pieceOfFurniture),this.toolTipDiv.querySelector("img").src=i.src;var n=this.toolTipDiv.getBoundingClientRect();n.x<0&&(this.toolTipDiv.style.left=t.clientX+10-n.x+"px"),n.y<0&&(this.toolTipDiv.style.left=t.clientY+10-n.y+"px"),n.x+Math.max(150,n.width)>window.innerWidth&&(this.toolTipDiv.style.left=window.innerWidth-Math.max(150,n.width)+"px"),n.y+n.height>window.innerHeight&&(this.toolTipDiv.style.top=window.innerHeight-n.height+"px")}else this.hideTooltip()},FurnitureCatalogListPanel.prototype.hideTooltip=function(){this.hideTooltipTimeout&&(clearTimeout(this.hideTooltipTimeout),this.hideTooltipTimeout=void 0),this.showTooltipTimeout&&(clearTimeout(this.showTooltipTimeout),this.showTooltipTimeout=void 0),"none"!=this.toolTipDiv.style.display&&(this.toolTipDiv.style.display="none")},FurnitureCatalogListPanel.prototype.createCatalogItemTooltipText=function(e){if(null!=this.preferences){var t=e.getCreator(),i=null;null!=t&&t.length>0&&(i=this.preferences.getLocalizedString("CatalogItemToolTip","tooltipCreator",t));var n=this.preferences.getLengthUnit().getFormatWithUnit(),o=this.preferences.getLocalizedString("CatalogItemToolTip","tooltipPieceOfFurnitureDimensions",n.format(e.getWidth()),n.format(e.getDepth()),n.format(e.getHeight())),r=null;null!=e.getModelSize()&&e.getModelSize()>0&&(r=this.preferences.getLocalizedString("CatalogItemToolTip","tooltipModelSize",Math.max(1,Math.round(e.getModelSize()/1e3))))}var l="<center>";return l+="- <b>"+e.getCategory().getName()+"</b> -<br>",l+="<b>"+e.getName()+"</b>",null!=o&&(l+="<br>"+o),null!=r&&(l+="<br>"+r),null!=i&&(l+="<br>"+i),l+="<br/><img height='100px'/>",l+="</center>"},FurnitureCatalogListPanel.prototype.dispose=function(){this.preferences.removePropertyChangeListener("LANGUAGE",this.languageChangeListener),this.clearFurnitureCatalog(),this.container.removeChild(document.getElementById("furniture-filter")),this.toolTipDiv.parentElement.removeChild(this.toolTipDiv)},FurnitureTablePanel.EXPANDED_ROWS_VISUAL_PROPERTY="com.eteks.sweethome3d.SweetHome3D.ExpandedGroups",FurnitureTablePanel.prototype.getHTMLElement=function(){return this.container},FurnitureTablePanel.prototype.addHomeListeners=function(e){var t=this,i=this.treeTable;e.addSelectionListener({selectionChanged:function(t){i.setSelectedRowsByValue(e.getSelectedItems())}});var n=function(){i.setModel(t.createTableModel(e))};e.addPropertyChangeListener("FURNITURE_SORTED_PROPERTY",n),e.addPropertyChangeListener("FURNITURE_DESCENDING_SORTED",n),e.addPropertyChangeListener("FURNITURE_VISIBLE_PROPERTIES",n);for(var o=function(i){t.updatePieceOfFurnitureData(e,i.getSource(),i.getPropertyName())},r=e.getFurniture(),l=0;l<r.length;l++){var a=r[l];if(a.addPropertyChangeListener(o),a instanceof HomeFurnitureGroup)for(var s=a.getAllFurniture(),h=0;h<s.length;h++)s[h].addPropertyChangeListener(o)}e.addFurnitureListener((function(i){t.updateData(e);var n=i.getItem();if(i.getType()==CollectionEvent.Type.ADD){if(n.addPropertyChangeListener(o),n instanceof HomeFurnitureGroup)for(var r=n.getAllFurniture(),l=0;l<r.length;l++)r[l].addPropertyChangeListener(o)}else if(n.removePropertyChangeListener(o),n instanceof HomeFurnitureGroup)for(r=n.getAllFurniture(),l=0;l<r.length;l++)r[l].removePropertyChangeListener(o)}));var u=function(){t.updateData(e)},d=e.getLevels();for(l=0;l<d.length;l++)d[l].addPropertyChangeListener(u);e.addLevelsListener((function(e){e.getType()==CollectionEvent.Type.ADD?e.getItem().addPropertyChangeListener(u):e.getItem().removePropertyChangeListener(u)}))},FurnitureTablePanel.prototype.addUserPreferencesListeners=function(e){var t=this;this.preferencesListener=function(i){"UNIT"!=i.getPropertyName()&&"LANGUAGE"!=i.getPropertyName()||t.treeTable.setModel(t.createTableModel(e))},this.preferences.addPropertyChangeListener(this.preferencesListener)},FurnitureTablePanel.prototype.createTableModel=function(e){for(var t={CATALOG_ID:{name:"CATALOG_ID",label:ResourceAction.getLocalizedLabelText(this.preferences,"FurnitureTable","catalogIdColumn"),defaultWidth:"4rem"},NAME:{name:"NAME",label:ResourceAction.getLocalizedLabelText(this.preferences,"FurnitureTable","nameColumn"),defaultWidth:"14rem"},DESCRIPTION:{name:"DESCRIPTION",label:ResourceAction.getLocalizedLabelText(this.preferences,"FurnitureTable","descriptionColumn"),defaultWidth:"14rem"},WIDTH:{name:"WIDTH",label:ResourceAction.getLocalizedLabelText(this.preferences,"FurnitureTable","widthColumn")},DEPTH:{name:"DEPTH",label:ResourceAction.getLocalizedLabelText(this.preferences,"FurnitureTable","depthColumn")},HEIGHT:{name:"HEIGHT",label:ResourceAction.getLocalizedLabelText(this.preferences,"FurnitureTable","heightColumn")},MOVABLE:{name:"MOVABLE",label:ResourceAction.getLocalizedLabelText(this.preferences,"FurnitureTable","movableColumn")},DOOR_OR_WINDOW:{name:"DOOR_OR_WINDOW",label:ResourceAction.getLocalizedLabelText(this.preferences,"FurnitureTable","doorOrWindowColumn")},COLOR:{name:"COLOR",label:ResourceAction.getLocalizedLabelText(this.preferences,"FurnitureTable","colorColumn")},TEXTURE:{name:"TEXTURE",label:ResourceAction.getLocalizedLabelText(this.preferences,"FurnitureTable","textureColumn")},VISIBLE:{name:"VISIBLE",label:ResourceAction.getLocalizedLabelText(this.preferences,"FurnitureTable","visibleColumn")},X:{name:"X",label:ResourceAction.getLocalizedLabelText(this.preferences,"FurnitureTable","xColumn")},Y:{name:"Y",label:ResourceAction.getLocalizedLabelText(this.preferences,"FurnitureTable","yColumn")},ELEVATION:{name:"ELEVATION",label:ResourceAction.getLocalizedLabelText(this.preferences,"FurnitureTable","elevationColumn")},ANGLE:{name:"ANGLE",label:ResourceAction.getLocalizedLabelText(this.preferences,"FurnitureTable","angleColumn")},MODEL_SIZE:{name:"MODEL_SIZE",label:ResourceAction.getLocalizedLabelText(this.preferences,"FurnitureTable","modelSizeColumn")},CREATOR:{name:"CREATOR",label:ResourceAction.getLocalizedLabelText(this.preferences,"FurnitureTable","creatorColumn")},LICENSE:{name:"LICENSE",label:ResourceAction.getLocalizedLabelText(this.preferences,"FurnitureTable","licenseColumn"),defaultWidth:"5rem"},PRICE:{name:"PRICE",label:ResourceAction.getLocalizedLabelText(this.preferences,"FurnitureTable","priceColumn")},VALUE_ADDED_TAX:{name:"VALUE_ADDED_TAX",label:ResourceAction.getLocalizedLabelText(this.preferences,"FurnitureTable","valueAddedTaxColumn")},VALUE_ADDED_TAX_PERCENTAGE:{name:"VALUE_ADDED_TAX_PERCENTAGE",label:ResourceAction.getLocalizedLabelText(this.preferences,"FurnitureTable","valueAddedTaxPercentageColumn")},PRICE_VALUE_ADDED_TAX_INCLUDED:{name:"PRICE_VALUE_ADDED_TAX_INCLUDED",label:ResourceAction.getLocalizedLabelText(this.preferences,"FurnitureTable","priceValueAddedTaxIncludedColumn")},LEVEL:{name:"LEVEL",label:ResourceAction.getLocalizedLabelText(this.preferences,"FurnitureTable","levelColumn")}},i=[],n=e.getFurnitureVisibleProperties(),o=0;o<n.length;o++)for(var r in t)n[o]==t[r].name&&i.push(t[r]);var l=[];if(e.getVersion()>=5e3){var a=e.getProperty(FurnitureTablePanel.EXPANDED_ROWS_VISUAL_PROPERTY);if(null!=a){l=[];var s=a.split(",");for(o=0;o<s.length;o++){var h=parseInt(s[o]);isNaN(h)||l.push(h)}}}var u=this;return{columns:i,renderCell:function(e,t,i){return u.renderCell(e,t,i)},getValueComparator:function(e){if(null!=e.columnName){var t=HomePieceOfFurniture.getFurnitureComparator(e.columnName);return"desc"==e.direction?function(e,i){return t(i,e)}:t}return null},selectionChanged:function(e){null!==u.controller&&u.controller.setSelectedFurniture(e,!1)},rowDoubleClicked:function(e){null!==u.controller&&u.controller.modifySelectedFurniture(e)},expandedRowsChanged:function(t,i){null!==u.controller&&u.storeExpandedRows(i,e,u.controller)},sortChanged:function(e){null!==u.controller&&u.controller.sortFurniture(e.columnName)},initialState:{visibleColumnNames:n,sort:{columnName:e.getFurnitureSortedProperty(),direction:e.isFurnitureDescendingSorted()?"desc":"asc"},expandedRowsIndices:l}}},FurnitureTablePanel.prototype.updateData=function(e){var t=[],i=function(e,t){for(var n=0;n<e.length;n++){var o=e[n],r={value:o};o instanceof HomeFurnitureGroup&&(r.children=[],i(o.getFurniture(),r.children)),t.push(r)}};i(e.getFurniture(),t),this.treeTable.setData(t)},FurnitureTablePanel.prototype.updatePieceOfFurnitureData=function(e,t,i){this.treeTable.updateRowData(t,i);var n=this,o=function(e,i){for(var r=0;r<e.length;r++){if(e[r]===t)return!0;if(e[r]instanceof HomeFurnitureGroup){var l=o(e[r].getFurniture(),i);return l&&n.treeTable.updateRowData(e[r],i),l}}return!1};void 0===i&&o(e.getFurniture(),i),"PRICE"!=i&&"VALUE_ADDED_TAX_PERCENTAGE"!=i||(o(e.getFurniture(),i),this.treeTable.updateRowData(t,"PRICE_VALUE_ADDED_TAX_INCLUDED"),o(e.getFurniture(),"PRICE_VALUE_ADDED_TAX_INCLUDED")),"VALUE_ADDED_TAX_PERCENTAGE"==i&&(o(e.getFurniture(),i),this.treeTable.updateRowData(t,"VALUE_ADDED_TAX"),o(e.getFurniture(),"VALUE_ADDED_TAX")),"CURRENCY"==i&&(this.treeTable.updateRowData(t,"PRICE"),o(e.getFurniture(),"PRICE"),this.treeTable.updateRowData(t,"PRICE_VALUE_ADDED_TAX_INCLUDED"),o(e.getFurniture(),"PRICE_VALUE_ADDED_TAX_INCLUDED"))},FurnitureTablePanel.prototype.isRootPieceOfFurniture=function(e){for(var t=this.treeTable.getData(),i=0;i<t.length;i++)if(t[i].value==e)return!0;return!1},FurnitureTablePanel.prototype.renderNumberCellValue=function(e,t,i){i||(i=this.defaultDecimalFormat);var n="";null!=e&&(n=i.format(e)),t.innerHTML=n,t.classList.add("number")},FurnitureTablePanel.prototype.renderSizeCellValue=function(e,t){this.renderNumberCellValue(e,t,this.preferences.getLengthUnit().getFormat())},FurnitureTablePanel.prototype.renderNameCell=function(e,t){for(;t.firstChild;)t.removeChild(t.firstChild);t.classList.add("main","name");var i=document.createElement("span");i.setAttribute("icon",!0);var n=e instanceof HomeFurnitureGroup?new URLContent(ZIPTools.getScriptFolder()+"resources/groupIcon.png"):e.getIcon();if(null!=n)TextureManager.getInstance().loadTexture(n,0,!1,{textureUpdated:function(e){i.appendChild(e.cloneNode())},textureError:function(e){return this.textureUpdated(TextureManager.getInstance().getErrorImage())}});else{var o=document.createElement("img");o.width=15,i.appendChild(o)}t.appendChild(i);var r=document.createElement("span");r.textContent=e.getName(),t.appendChild(r)},FurnitureTablePanel.prototype.renderColorCell=function(e,t){for(;t.firstChild;)t.removeChild(t.firstChild);if(t.classList.add("color"),null!=e.getColor()){var i=document.createElement("div");i.style.backgroundColor=ColorTools.integerToHexadecimalString(e.getColor()),t.appendChild(i)}else t.textContent="-"},FurnitureTablePanel.prototype.renderTextureCell=function(e,t){for(;t.firstChild;)t.removeChild(t.firstChild);if(t.classList.add("texture"),null!=e.getTexture()){var i=document.createElement("div");TextureManager.getInstance().loadTexture(e.getTexture().getImage(),0,!1,{textureUpdated:function(e){i.style.backgroundImage="url('"+e.src+"')"},textureError:function(e){return this.textureUpdated(TextureManager.getInstance().getErrorImage())}}),t.appendChild(i)}},FurnitureTablePanel.prototype.renderBooleanCell=function(e,t,i,n){for(;t.firstChild;)t.removeChild(t.firstChild);t.classList.add("boolean");var o=document.createElement("input");o.type="checkbox",o.disabled=!0!==i,o.checked=!0===e,o.tabIndex=-1,void 0!==n&&o.addEventListener("click",(function(e){n(o.checked)}),!0),t.appendChild(o)},FurnitureTablePanel.prototype.renderPriceCellValue=function(e,t,i){var n=null==e.getCurrency()?this.preferences.getCurrency():e.getCurrency(),o=NumberFormat.getCurrencyInstance();o.setCurrency(n),this.renderNumberCellValue(this.bigToNumber(t),i,o)},FurnitureTablePanel.prototype.bigToNumber=function(e){return null==e?null:parseFloat(e.valueOf())},FurnitureTablePanel.prototype.renderCreatorCell=function(e,t){var i=e.getCreator();if(null!=i){var n=e.getTexture();if(null!=n){null!=(s=n.getCreator())&&i!=s&&(i+=", "+s)}else{var o=i,r=e.getModelMaterials();if(null!=r)for(var l=0;l<r.length;l++){var a=r[l];if(null!=a){var s,h=a.getTexture();if(null!=h)null!=(s=h.getCreator())&&o!=s&&-1==i.indexOf(", "+s)&&(i+=", "+s)}}}}t.textContent=i},FurnitureTablePanel.prototype.renderTextCell=function(e,t){t.textContent=e},FurnitureTablePanel.prototype.renderCell=function(e,t,i){switch(t){case"CATALOG_ID":return this.renderTextCell(e.getCatalogId(),i);case"NAME":return this.renderNameCell(e,i);case"DESCRIPTION":return this.renderTextCell(e.getDescription(),i);case"CREATOR":return this.renderCreatorCell(e,i);case"LICENSE":return this.renderTextCell(e.getLicense(),i);case"WIDTH":return this.renderSizeCellValue(e.getWidth(),i);case"DEPTH":return this.renderSizeCellValue(e.getDepth(),i);case"HEIGHT":return this.renderSizeCellValue(e.getHeight(),i);case"X":return this.renderSizeCellValue(e.getX(),i);case"Y":return this.renderSizeCellValue(e.getY(),i);case"ELEVATION":return this.renderSizeCellValue(e.getElevation(),i);case"ANGLE":var n=Math.round(Math.toDegrees(e.getAngle())+360)%360;return this.renderNumberCellValue(n,i,this.integerFormat);case"LEVEL":i.textContent=null!=e&&null!=e.getLevel()?e.getLevel().getName():"";break;case"MODEL_SIZE":n=null!=e&&null!=e.getModelSize()&&e.getModelSize()>0?Math.max(1,Math.round(e.getModelSize()/1e3)):null;return this.renderNumberCellValue(n,i,this.integerFormat);case"COLOR":return this.renderColorCell(e,i);case"TEXTURE":return this.renderTextureCell(e,i);case"MOVABLE":return this.renderBooleanCell(e.isMovable(),i);case"DOOR_OR_WINDOW":return this.renderBooleanCell(e.isDoorOrWindow(),i);case"VISIBLE":var o=this.controller;return this.renderBooleanCell(e.isVisible(),i,this.isRootPieceOfFurniture(e),(function(e){null!==o&&o.toggleSelectedFurnitureVisibility()}));case"PRICE":return this.renderPriceCellValue(e,e.getPrice(),i);case"VALUE_ADDED_TAX_PERCENTAGE":return this.renderNumberCellValue(null!==e.getValueAddedTaxPercentage()?100*this.bigToNumber(e.getValueAddedTaxPercentage()):null,i);case"VALUE_ADDED_TAX":return this.renderPriceCellValue(e,e.getValueAddedTax(),i);case"PRICE_VALUE_ADDED_TAX_INCLUDED":return this.renderPriceCellValue(e,e.getPriceValueAddedTaxIncluded(),i);default:i.textContent="-"}},FurnitureTablePanel.prototype.storeExpandedRows=function(e,t,i){var n=e.join(",");(null!=t.getProperty(FurnitureTablePanel.EXPANDED_ROWS_VISUAL_PROPERTY)||n.length>0)&&i.setHomeProperty(FurnitureTablePanel.EXPANDED_ROWS_VISUAL_PROPERTY,n)},FurnitureTablePanel.prototype.dispose=function(){this.treeTable.dispose(),this.preferences.removePropertyChangeListener(this.preferencesListener)},JSComponent.prototype.getHTMLElement=function(){return this.container},JSComponent.prototype.getUserPreferences=function(){return this.preferences},JSComponent.isElementContained=function(e,t){if(null==e||null==t)return!1;var i=e;do{if(i==t)return!0}while(i=i.parentElement);return!1},JSComponent.substituteWithLocale=function(e,t){return t.replace(/\@\{([a-zA-Z0-9_.]+)\}/g,(function(t,i){return ResourceAction.getLocalizedLabelText(e,i.substring(0,i.indexOf(".")),i.substring(i.indexOf(".")+1))}))},JSComponent.prototype.buildHtmlFromTemplate=function(e){return JSComponent.substituteWithLocale(this.preferences,e)},JSComponent.prototype.getLocalizedLabelText=function(e,t,i){return ResourceAction.getLocalizedLabelText(this.preferences,e,t,i)},JSComponent.prototype.attachChildComponent=function(e,t){this.getElement(e).appendChild(t.getHTMLElement())},JSComponent.prototype.registerEventListener=function(e,t,i){if(null!=e){if(e instanceof NodeList||e instanceof HTMLCollection){for(var n=new Array(e.length),o=0;o<e.length;o++)n[o]=e[o];e=n}Array.isArray(e)||(e=[e]),null==this.listeners&&(this.listeners=[]);for(o=0;o<e.length;o++){e[o].addEventListener(t,i,!1)}this.listeners.push({listener:i,eventName:t,elements:e})}},JSComponent.prototype.registerPropertyChangeListener=function(e,t,i){e.addPropertyChangeListener(t,i),this.listeners.push({listener:i,propertyName:t,object:e})},JSComponent.prototype.unregisterEventListeners=function(){if(Array.isArray(this.listeners))for(var e=0;e<this.listeners.length;e++){var t=this.listeners[e];if(void 0!==t.eventName)for(var i=0;i<t.elements.length;i++){t.elements[i].removeEventListener(t.eventName,t.listener)}else t.object.removePropertyChangeListener(t.propertyName,t.listener)}},JSComponent.prototype.getElement=function(e){var t=this.container.querySelector("[name='"+e+"']");return null==t&&(t=this.container.querySelector("[data-name='"+e+"']")),t},JSComponent.prototype.findElement=function(e){return this.container.querySelector(e)},JSComponent.prototype.findElements=function(e){return this.container.querySelectorAll(e)},JSComponent.prototype.dispose=function(){this.unregisterEventListeners()},JSComponent.createOptionElement=function(e,t,i){var n=document.createElement("option");return n.value=e,n.textContent=t,void 0!==i&&(n.selected=i),n},JSDialog.prototype=Object.create(JSComponent.prototype),JSDialog.prototype.constructor=JSDialog,JSDialog.prototype.appendButtons=function(e){var t;t=this.applier?"<button class='dialog-ok-button default-capable'>@{OptionPane.okButton.textAndMnemonic}</button><button class='dialog-cancel-button'>@{OptionPane.cancelButton.textAndMnemonic}</button>":"<button class='dialog-cancel-button default-capable'>@{InternalFrameTitlePane.closeButtonAccessibleName}</button>",e.innerHTML=JSComponent.substituteWithLocale(this.getUserPreferences(),t);var i=this,n=this.findElement(".dialog-cancel-button");n&&this.registerEventListener(n,"click",(function(e){i.cancel()}));var o=this.findElement(".dialog-ok-button");o&&this.registerEventListener(o,"click",(function(e){i.validate()}))},JSDialog.closeTopMostDialog=function(){var e=JSDialog.getTopMostDialog();null!=e&&e.close()},JSDialog.getTopMostDialog=function(){var e=document.querySelectorAll(".dialog-container.visible"),t=null;if(e.length>0)for(var i=0;i<e.length;i++){var n=e[i]._dialogBoxInstance;(null==t||t.displayIndex<=n.displayIndex)&&(t=n)}return t},JSDialog.prototype.buildHtmlFromTemplate=function(e){return JSComponent.substituteWithLocale(this.getUserPreferences(),'<div class="dialog-content">  <div class="dialog-top">    <span class="title"></span>    <span class="dialog-close-button">&times;</span>  </div>  <div class="dialog-body">'+JSComponent.prototype.buildHtmlFromTemplate.call(this,e)+'  </div>  <div class="dialog-buttons">  </div></div>')},JSDialog.prototype.getInput=function(e){return this.getHTMLElement().querySelector("[name='"+e+"']")},JSDialog.prototype.getCloseButton=function(){return this.getHTMLElement().querySelector(".dialog-close-button")},JSDialog.prototype.validate=function(){null!=this.applier&&this.applier(this),this.close()},JSDialog.prototype.cancel=function(){this.close()},JSDialog.prototype.close=function(){this.getHTMLElement().classList.add("closing");var e=this;setTimeout((function(){e.getHTMLElement().classList.remove("visible"),e.dispose(),e.getHTMLElement()&&document.body.contains(e.getHTMLElement())&&document.body.removeChild(e.getHTMLElement())}),500)},JSDialog.prototype.dispose=function(){JSComponent.prototype.dispose.call(this),"function"==typeof this.disposer&&this.disposer(this)},JSDialog.prototype.setTitle=function(e){this.findElement(".dialog-top .title").textContent=JSComponent.substituteWithLocale(this.getUserPreferences(),e||"")},JSDialog.prototype.isDisplayed=function(){return this.getHTMLElement().classList.contains("visible")},JSDialog.prototype.displayView=function(e){var t=this;this.getHTMLElement().style.display="block",setTimeout((function(){t.getHTMLElement().classList.add("visible"),t.displayIndex=JSDialog.shownDialogsCounter++;for(var e=t.findElements("input"),i=0;i<e.length;i++){var n=e[i];if(!n.classList.contains("not-focusable-at-opening")){n.focus();break}}}),100)},JSDialog.shownDialogsCounter=0,JSWizardDialog.prototype=Object.create(JSDialog.prototype),JSWizardDialog.prototype.constructor=JSWizardDialog,JSWizardDialog.prototype.appendButtons=function(e){var t="<button class='wizard-back-button'>@{WizardPane.backOptionButton.text}</button>",i="<button class='wizard-next-button default-capable'></button>",n="<div class='dialog-buttons'>"+(OperatingSystem.isMacOSX()?i+t:t+i)+"<button class='wizard-cancel-button'>@{InternalFrameTitlePane.closeButtonAccessibleName}</button></div>";e.innerHTML=JSComponent.substituteWithLocale(this.getUserPreferences(),n)},JSWizardDialog.prototype.updateNextButtonText=function(){this.nextButton.innerText=this.getLocalizedLabelText("WizardPane",this.controller.isLastStep()?"finishOptionButton.text":"nextOptionButton.text")},JSWizardDialog.prototype.updateStepView=function(){var e=this.controller.getStepView();this.stepViewPanel.innerHTML="",this.stepViewPanel.appendChild(e.getHTMLElement())},JSWizardDialog.prototype.updateStepIcon=function(){var e=this.stepIconPanel,t=this.stepIconPanel.querySelector("div");t.innerHTML="";var i=this.controller.getStepIcon();if(null!=i){var n="rgb(163, 168, 226)",o="rgb(80, 86, 158)";try{var r=this.getLocalizedLabelText("WizardPane","stepIconBackgroundColors").trim().split(" ");n=r[0],1==r.length?o=n:2==r.length&&(o=r[1])}catch(e){}var l=n,a=o;e.style.background="linear-gradient(180deg, "+l+" 0%, "+a+" 100%)",e.style.border="solid 1px #333333";var s=new Image;s.crossOrigin="anonymous",t.appendChild(s),s.src=-1===i.indexOf("://")?ZIPTools.getScriptFolder()+i:i}},JSImageResizingDialog.prototype=Object.create(JSDialog.prototype),JSImageResizingDialog.prototype.constructor=JSImageResizingDialog,JSImageResizingDialog.prototype.appendButtons=function(e){e.innerHTML=JSComponent.substituteWithLocale(this.getUserPreferences(),"<button class='dialog-ok-button default-capable'>"+this.okButtonMessage+"</button><button class='keep-image-unchanged-button dialog-ok-button'>"+this.keepUnchangedButtonMessage+"</button><button class='dialog-cancel-button'>"+this.cancelButtonMessage+"</button>")},JSPopupMenu.prototype=Object.create(JSComponent.prototype),JSPopupMenu.prototype.constructor=JSPopupMenu,JSPopupMenu.closeOpenedMenu=function(){return null!=JSPopupMenu.current&&(JSPopupMenu.current.close(),!0)},JSPopupMenu.prototype.showSourceElement=function(e,t){this.menuItemListeners=[];var i=new JSPopupMenu.Builder;this.build(i,e);var n=i.items;n.length>0&&n[n.length-1]==JSPopupMenu.CONTEXT_MENU_SEPARATOR_ITEM&&n.pop();var o=this.createMenuElement(n);this.getHTMLElement().appendChild(o),this.getHTMLElement().setAttribute("tabindex",1e3),this.getHTMLElement().style.outline="none",this.getHTMLElement().style.outlineWidth="0",this.getHTMLElement().style.visibility="hidden",this.getHTMLElement().classList.add("visible");var r=t.clientX;o.clientWidth>window.innerWidth?r=0:r+o.clientWidth+20>window.innerWidth&&(r=Math.max(0,window.innerWidth-o.clientWidth-20));var l=t.clientY;o.clientHeight>window.innerHeight?l=0:l+o.clientHeight+10>window.innerHeight&&(l=window.innerHeight-o.clientHeight-10),this.getHTMLElement().style.visibility="visible",this.getHTMLElement().style.left=r+"px",this.getHTMLElement().style.top=l+"px",this.getHTMLElement().focus(),JSPopupMenu.current=this},JSPopupMenu.prototype.createMenuElement=function(e,t){void 0===t&&(t=1e3);var i=document.createElement("ul");i.classList.add("items"),i.style.zIndex=t,i.addEventListener("contextmenu",(function(e){e.preventDefault()}));var n=document.createElement("li");n.classList.add("item"),n.classList.add("back"),n.textContent="",this.registerEventListener(n,"click",(function(e){"li"!=i.parentElement.tagName.toLowerCase()?JSPopupMenu.closeOpenedMenu():(i.classList.remove("visible"),e.stopPropagation())})),i.appendChild(n);for(var o=0;o<e.length;o++){var r=e[o],l=document.createElement("li");r==JSPopupMenu.CONTEXT_MENU_SEPARATOR_ITEM?l.classList.add("separator"):this.initMenuItemElement(l,r,t),i.appendChild(l)}return i},JSPopupMenu.prototype.initMenuItemElement=function(e,t,i){var n=this,o=document.createElement("img");null!=t.iconPath&&(o.src=t.iconPath,o.classList.add("visible")),void 0!==t.mode&&(e.classList.add("checkable"),!0===t.selected&&e.classList.add("selected"),null==t.iconPath&&((o=document.createElement("span")).innerHTML=!0===t.selected?"":"&nbsp;",o.classList.add("visible")));var r=document.createElement("span");if(r.textContent=JSComponent.substituteWithLocale(this.getUserPreferences(),t.label),e.classList.add("item"),o.classList.add("icon"),e.appendChild(o),e.appendChild(r),Array.isArray(t.subItems)){e.classList.add("sub-menu");var l=this.createMenuElement(t.subItems,i+1);this.registerEventListener(e,"click",(function(e){l.classList.add("visible")})),this.registerEventListener(e,"mouseover",(function(t){var i=e.getBoundingClientRect();l.style.position="fixed";var n=i.left+e.clientWidth;l.clientWidth>window.innerWidth?n=0:n+l.clientWidth>window.innerWidth&&(n=window.innerWidth-l.clientWidth);var o=i.top;l.clientHeight>window.innerHeight?o=0:o+l.clientHeight>window.innerHeight&&(o=window.innerHeight-l.clientHeight),l.style.left=n,l.style.top=o})),e.appendChild(l)}if("function"==typeof t.itemSelectedListener){var a=function(){n.close(),setTimeout((function(){t.itemSelectedListener()}),50)};e.addEventListener("click",a),e.addEventListener("mouseup",a),this.menuItemListeners.push((function(){e.removeEventListener("click",a),e.removeEventListener("mouseup",a)}))}},JSPopupMenu.prototype.close=function(){if(this.getHTMLElement().removeAttribute("tabindex"),this.getHTMLElement().classList.remove("visible"),JSPopupMenu.current=null,this.menuItemListeners)for(var e=0;e<this.menuItemListeners.length;e++)this.menuItemListeners[e]();this.menuItemListeners=null,this.getHTMLElement().innerHTML=""},JSPopupMenu.Builder=function(){this.items=[]},JSPopupMenu.Builder.prototype=Object.create(JSPopupMenu.Builder.prototype),JSPopupMenu.Builder.prototype.constructor=JSPopupMenu.Builder,JSPopupMenu.Builder.prototype.addCheckBoxItem=function(e,t,i){this.addNewMenuItem(e,void 0,t,!0===i,"checkbox")},JSPopupMenu.Builder.prototype.addRadioButtonItem=function(e,t,i){this.addNewMenuItem(e,void 0,t,!0===i,"radiobutton")},JSPopupMenu.Builder.prototype.addMenuItem=function(e,t,i){var n=null,o=null,r=(i=null,void 0);if(e instanceof ResourceAction){var l=e;if(!l.isEnabled()||!1===l.getValue(ResourceAction.VISIBLE))return this;o=l.getURL(AbstractAction.SMALL_ICON),n=l.getValue(ResourceAction.POPUP)||l.getValue(AbstractAction.NAME),l.getValue(ResourceAction.TOGGLE_BUTTON_GROUP)&&(r=l.getValue(AbstractAction.SELECTED_KEY)),i=function(){l.actionPerformed()}}else"function"==typeof i?(o=e,n=t):(n=e,i=t);return this.addNewMenuItem(n,o,i,r,void 0!==r?"radiobutton":void 0),this},JSPopupMenu.Builder.prototype.addNewMenuItem=function(e,t,i,n,o){this.items.push({label:e,iconPath:t,itemSelectedListener:i,selected:n,mode:o})},JSPopupMenu.Builder.prototype.addSubMenu=function(e,t){if(e.isEnabled()){var i=e.getValue(ResourceAction.POPUP)||e.getValue(AbstractAction.NAME),n=e.getURL(AbstractAction.SMALL_ICON),o=new JSPopupMenu.Builder;t(o);var r=o.items;r.length>0&&this.items.push({label:i,iconPath:n,subItems:r})}return this},JSPopupMenu.CONTEXT_MENU_SEPARATOR_ITEM={},JSPopupMenu.Builder.prototype.addSeparator=function(){return this.items.length>0&&this.items[this.items.length-1]!=JSPopupMenu.CONTEXT_MENU_SEPARATOR_ITEM&&this.items.push(JSPopupMenu.CONTEXT_MENU_SEPARATOR_ITEM),this},!JSPopupMenu.globalCloserRegistered){var listener=function(e){null==JSPopupMenu.current||JSComponent.isElementContained(e.target,JSPopupMenu.current.getHTMLElement())||JSPopupMenu.closeOpenedMenu()&&(e.stopPropagation(),e.preventDefault())};window.addEventListener("click",listener),window.addEventListener("touchstart",listener),document.addEventListener("keydown",(function(e){if("Escape"==e.key||27==e.keyCode)JSComboBox.closeOpenedSelectionPanel()||(JSDialog.closeTopMostDialog(),JSPopupMenu.closeOpenedMenu());else if(13==e.keyCode&&null!=JSDialog.getTopMostDialog()){var t=JSDialog.getTopMostDialog().findElement(".default-capable");null!=t&&t.click()}})),JSPopupMenu.globalCloserRegistered=!0}function JSSpinner(e,t,i){if("SPAN"!=t.tagName.toUpperCase())throw new Error("JSSpinner: please provide a span for the spinner to work - "+t+" is not a span");i||(i={}),this.checkMinimumMaximum(i.minimum,i.maximum),isNaN(parseFloat(i.minimum))||(this.minimum=i.minimum),isNaN(parseFloat(i.maximum))||(this.maximum=i.maximum),isNaN(parseFloat(i.stepSize))?this.stepSize=1:this.stepSize=i.stepSize,"boolean"==typeof i.nullable?this.nullable=i.nullable:this.nullable=!1,i.format instanceof Format?this.format=i.format:this.format=new DecimalFormat;var n=this;JSComponent.call(this,e,t,!0),t.classList.add("spinner"),this.textInput=document.createElement("input"),this.textInput.type="text",t.appendChild(this.textInput),this.registerEventListener(this.textInput,"focus",(function(e){n.updateUI()})),this.registerEventListener(this.textInput,"focusout",(function(e){n.updateUI()})),this.registerEventListener(this.textInput,"input",(function(e){if(n.isFocused()){var t=new ParsePosition(0),i=n.parseValueFromInput(t);t.getIndex()!=n.textInput.value.length||null==i&&!n.nullable||null!=n.minimum&&i<n.minimum||null!=n.maximum&&i>n.maximum?n.textInput.style.color="red":(n.textInput.style.color=null,n.value=i)}})),this.registerEventListener(this.textInput,"blur",(function(e){var t=n.parseValueFromInput();if(null==t&&!n.nullable){var i=n.value;null==i&&(i=n.getDefaultValue()),t=i}n.textInput.style.color=null,n.setValue(t)})),this.initIncrementDecrementButtons(t),Object.defineProperty(this,"width",{get:function(){return t.style.width},set:function(e){t.style.width=e}}),Object.defineProperty(this,"parentElement",{get:function(){return t.parentElement}}),Object.defineProperty(this,"previousElementSibling",{get:function(){return t.previousElementSibling}}),Object.defineProperty(this,"style",{get:function(){return t.style}}),this.setValue(i.value)}function JSComboBox(e,t,i){if(JSComponent.call(this,e,t,!0),i||(i={}),"boolean"!=typeof i.nullable&&(i.nullable=!1),!Array.isArray(i.availableValues)||i.availableValues.length<=0)throw new Error("JSComboBox: No available values provided");"function"!=typeof i.renderCell&&(i.renderCell=function(e,t){t.textContent=null==e?"":e.toString()}),null!=i.value||i.nullable||(i.value=i.availableValues[0]),this.options=i,t.classList.add("combo-box"),this.button=document.createElement("button"),t.appendChild(this.button),this.preview=document.createElement("div"),this.preview.classList.add("preview"),this.button.appendChild(this.preview),this.initSelectionPanel();var n=this;this.registerEventListener(this.button,"click",(function(e){e.stopImmediatePropagation(),n.openSelectionPanel(e.pageX,e.pageY)})),this.setSelectedItem(i.value)}function JSTreeTable(e,t,i,n){JSComponent.call(this,t,e,!0),this.state={},this.selectedRowsValues=[],this.tableElement=document.createElement("div"),this.tableElement.classList.add("tree-table"),e.appendChild(this.tableElement),this.setModel(i),this.setData(n||[])}function ColorButton(e,t){JSComponent.call(this,e,document.createElement("span"),!0),void 0!==t&&(this.observer=t),this.getHTMLElement().innerHTML='<button class="color-button"><div class="color-preview" /></button>',this.button=this.findElement(".color-button");var i=this;this.registerEventListener(this.button,"click",(function(t){i.openColorDialog(e)})),this.colorOverview=this.findElement(".color-preview")}function JSColorChooser(e,t){JSComponent.call(this,e,"<div class='picker'></div><hr /><div class='custom-color-editor'>  <input class='not-focusable-at-opening' type='text' value='FFFFFF' />  <div class='custom-color-preview'></div><div class='current-color-preview'></div></div><div class='recent-colors'></div>"),null!=t&&t.appendChild(this.getHTMLElement()),this.getHTMLElement().classList.add("color-chooser"),this.pickerElement=this.findElement(".picker"),this.recentColorsContainerElement=this.findElement(".recent-colors"),this.customColorEditorInput=this.findElement(".custom-color-editor input"),this.customColorEditorPreview=this.findElement(".custom-color-preview"),this.currentColorEditorPreview=this.findElement(".current-color-preview"),this.createPickerColorTiles(),this.initCustomColorEditor()}function JSColorChooserDialog(e,t,i,n){JSDialog.call(this,e,t,'<div>  <div data-name="color-chooser"></div></div>',{applier:n.applier}),this.getHTMLElement().classList.add("color-chooser-dialog"),this.getHTMLElement().classList.add("small"),this.colorChooser=new JSColorChooser(e,this.getElement("color-chooser")),this.colorChooser.setColor(i);var o=this;if(this.registerEventListener(this.colorChooser.colorTileElements,"dblclick",(function(e){o.validate()})),!OperatingSystem.isInternetExplorerOrLegacyEdge()||!window.PointerEvent){var r=-1,l=null;this.registerEventListener(this.colorChooser.colorTileElements,"touchstart",(function(e){var t=Date.now();t-r<500&&l===e.target?(e.preventDefault(),o.validate()):(r=t,l=e.target)}))}}function TextureChoiceComponent(e,t){JSComponent.call(this,e,document.createElement("span"),!0),this.controller=t,this.getHTMLElement().innerHTML='<button class="texture-button"><div class="texture-preview" /></button>',this.button=this.findElement(".texture-button");var i=this;this.registerEventListener(this.button,"click",(function(e){i.openTextureDialog()})),this.preview=this.findElement(".texture-preview");this.registerPropertyChangeListener(t,"TEXTURE",(function(){i.updateTexture(t.getTexture())})),this.updateTexture(t.getTexture())}function JSTextureDialog(e,t){this.controller=t,this.selectedTextureModel={texture:null,xOffset:0,yOffset:0,angleInRadians:0,scale:1};var i=function(e){var t=e.getCategory(),i=document.createElement("div");return i.classList.add("item"),e.getImage().getStreamURL({urlReady:function(n){i.innerHTML='<img src="'+n+'" />'+t.getName()+" - "+e.getName()},urlError:function(n){i.innerHTML="<img/>"+t.getName()+" - "+e.getName()}}),i._catalogTexture=e,i};JSDialog.call(this,e,t.getDialogTitle(),'<div class="columns-2">  <div class="column1">    <div class="texture-search"><input type="text" /></div>    <div class="texture-catalog-list"></div>    <div class="recent-textures"></div>  </div>  <div class="column2">    <div class="selected-texture-preview">      <div></div>    </div>    <div class="selected-texture-config label-input-grid">      <div>@{TextureChoiceComponent.xOffsetLabel.text}</div>      <div><span data-name="selected-texture-offset-x" /></div>      <div>@{TextureChoiceComponent.yOffsetLabel.text}</div>      <div><span data-name="selected-texture-offset-y" /></div>      <div>@{TextureChoiceComponent.angleLabel.text}</div>      <div><span data-name="selected-texture-angle" /></div>      <div>@{TextureChoiceComponent.scaleLabel.text}</div>      <div><span data-name="selected-texture-scale" /></div>    </div>    <hr />    <div class="imported-textures-panel">      <div><button import>@{TextureChoiceComponent.importTextureButton.text}</button></div>      <div><button disabled modify>@{TextureChoiceComponent.modifyTextureButton.text}</button></div>      <div><button disabled delete>@{TextureChoiceComponent.deleteTextureButton.text}</button></div>    </div>  </div></div>',{applier:function(e){this.updateTextureTransform();var i=e.getSelectedTexture();t.setTexture(i),null!=i&&t.addRecentTexture(i)},disposer:function(t){e.getTexturesCatalog().removeTexturesListener(t.texturesCatalogListener)}}),this.getHTMLElement().classList.add("texture-chooser-dialog"),this.recentTexturesPanel=this.findElement(".recent-textures"),this.catalogList=this.findElement(".texture-catalog-list"),this.selectedTexturePreview=this.findElement(".selected-texture-preview > div"),this.xOffsetInput=new JSSpinner(e,this.getElement("selected-texture-offset-x"),{value:0,minimum:0,maximum:100,stepSize:5}),this.yOffsetInput=new JSSpinner(e,this.getElement("selected-texture-offset-y"),{value:0,minimum:0,maximum:100,stepSize:5}),this.angleInput=new JSSpinner(e,this.getElement("selected-texture-angle"),{format:new IntegerFormat,value:0,minimum:0,maximum:360,stepSize:15}),this.scaleInput=new JSSpinner(e,this.getElement("selected-texture-scale"),{value:100,minimum:1,maximum:1e4,stepSize:5});var n=this;this.registerEventListener([this.xOffsetInput,this.yOffsetInput,this.angleInput,this.scaleInput],"input",(function(e){n.updateTextureTransform()}));for(var o=e.getTexturesCatalog().getCategories(),r=0;r<o.length;r++)for(var l=o[r],a=0;a<l.getTextures().length;a++){var s=l.getTextures()[a];n.catalogList.appendChild(i(s))}this.texturesCatalogItems=this.catalogList.childNodes;var h=function(e){n.selectTexture(n.getCatalogTextureFromItem(this))};if(this.registerEventListener(this.texturesCatalogItems,"click",h),this.initCatalogTextureSearch(e),this.initRecentTextures(),this.registerPropertyChangeListener(e,"RECENT_TEXTURES",(function(e){n.initRecentTextures()})),this.registerEventListener(this.findElements(".item"),"dblclick",(function(e){n.validate()})),!OperatingSystem.isInternetExplorerOrLegacyEdge()||!window.PointerEvent){var u=-1,d=null;this.registerEventListener(this.findElements(".item"),"touchstart",(function(e){var t=Date.now();t-u<500&&d===e.target?(e.preventDefault(),n.validate()):(u=t,d=e.target)}))}this.initImportTexturesPanel(),this.texturesCatalogListener=function(e){var t=e.getItem&&e.getItem();switch(e.getType()){case CollectionEvent.Type.ADD:n.searchInput.value="";var o=i(t);n.catalogList.appendChild(o),n.registerEventListener(o,"click",h),n.selectTexture(t);break;case CollectionEvent.Type.DELETE:var r=n.getCatalogTextureItem(t);n.catalogList.removeChild(r);var l=n.catalogList.querySelector(".item");l&&n.selectTexture(n.getCatalogTextureFromItem(l))}},e.getTexturesCatalog().addTexturesListener(this.texturesCatalogListener)}function ModelMaterialsComponent(e,t){JSComponent.call(this,e,document.createElement("span"),!0),this.controller=t,this.getHTMLElement().innerHTML='<button class="model-materials-button">'+this.getLocalizedLabelText("ModelMaterialsComponent","modifyButton.text")+"</button>",this.button=this.findElement(".model-materials-button"),this.button.disabled=!0;var i=this;this.registerEventListener(this.button,"click",(function(e){i.openModelMaterialsSelectorDialog()}))}function JSModelMaterialsSelectorDialog(e,t){this.controller=t;JSDialog.call(this,e,"@{HomeFurnitureController.modelMaterialsTitle}",'<div data-name="preview-panel">  <span>@{ModelMaterialsComponent.previewLabel.text}</span><br/>  <canvas id="model-preview-canvas"></canvas></div><div data-name="edit-panel">  <div>    <span>@{ModelMaterialsComponent.materialsLabel.text}</span>    <div data-name="materials-list">    </div>  </div>  <div class="color-texture-shininess-panel">    <span>@{ModelMaterialsComponent.colorAndTextureLabel.text}</span><br/>    <div class="label-input-grid">      <label class="whole-line"><input type="radio" name="color-and-texture-checkbox" value="DEFAULT">@{ModelMaterialsComponent.defaultColorAndTextureRadioButton.text}</label>      <label class="whole-line"><input type="radio" name="color-and-texture-checkbox" value="INVISIBLE">@{ModelMaterialsComponent.invisibleRadioButton.text}</label>      <label><input type="radio" name="color-and-texture-checkbox" value="COLOR">@{ModelMaterialsComponent.colorRadioButton.text}</label>      <span data-name="color-button"></span>      <label><input type="radio" name="color-and-texture-checkbox" value="TEXTURE">@{ModelMaterialsComponent.textureRadioButton.text}</label>      <span data-name="texture-component"></span>    </div>    <br />    <span>@{ModelMaterialsComponent.shininessLabel.text}</span><br/>    <input type="range" name="shininess-slider" min="0" max="128" list="model-materials-shininess-list" />     <datalist id="model-materials-shininess-list"></datalist>     <div class="slider-labels"><div>@{ModelMaterialsComponent.mattLabel.text}</div><div>@{ModelMaterialsComponent.shinyLabel.text}</div></div>  </div></div>',{size:"medium",applier:function(e){t.setMaterials(e.materialsList.getMaterials())},disposer:function(e){e.selectedMaterialBlinker.stop(),e.colorButton.dispose(),e.textureComponent.dispose()}}),this.getHTMLElement().classList.add("model-materials-chooser-dialog"),this.initMaterialsList(),this.initPreviewPanel(),this.initColorAndTexturePanel(),this.initShininessPanel();var i=this;if(this.materialsList.size()>0)this.materialsList.addSelectionInterval(0,0);else{var n=function(){i.materialsList.size()>0&&(i.materialsList.addSelectionInterval(0,0),i.materialsList.removeListDataListener(n))};this.materialsList.addListDataListener(n)}this.enableComponents();var o={delay:500,animationTask:null,start:function(){var e=i.materialsList,t=function(){if(e.size()>1){var n=e.getMaterials();if(100!==o.delay){o.delay=100,n=null==n?i.newArray(e.size()):n.slice(0);for(var r=e.getSelectedIndices(),l=0;l<r.length;l++){var a=r[l],s=e.getDefaultMaterialAt(a),h=null!=n[a]?n[a]:s,u=4280435967;if(null==h.getTexture()){var d=h.getColor();null==d&&null==(d=s.getColor())&&(d=4278190080);var c=(d&=16777215)>>16&255,p=d>>8&255,g=255&d;Math.max(c,Math.max(p,g))>119?u=4278190080|c/2<<16|p/2<<8|g/2:(c+p+g)/3>15&&(u=4278190080|Math.min(2*c,255)<<16|Math.min(2*p,255)<<8|Math.min(2*g,255))}n[a]=new HomeMaterial(h.getName(),u,null,h.getShininess())}}else o.delay=1e3;i.previewComponent.setModelMaterials(n)}o.animationTask=setTimeout(t,o.delay)};o.animationTask=setTimeout(t,o.delay)},stop:function(){clearTimeout(o.animationTask)},restart:function(){o.stop(),o.delay=101,o.start()}};o.start(),this.materialsList.addListSelectionListener((function(e){o.restart()})),this.selectedMaterialBlinker=o}function JSViewFactory(e){this.application=e}function DirectHomeRecorder(e){HomeRecorder.call(this,e)}function IncrementalHomeRecorder(e,t){HomeRecorder.call(this,t),this.application=e,this.homeData={},this.online=!0;if(void 0!==this.configuration.pingURL){var i=this;setTimeout((function(){i.checkServer(1e4)}),1e4)}}function LocalFileHomeController(e,t,i){HomeController.call(this,e,t,i)}function DirectRecordingHomeController(e,t,i){HomeController.call(this,e,t,i)}function SweetHome3DJSApplication(e){HomeApplication.call(this),this.homeControllers=[],this.configuration=e;var t=this;this.addHomesListener((function(e){if(e.getType()==CollectionEvent.Type.ADD){var i=t.createHomeController(e.getItem());t.homeControllers.push(i),t.getHomeRecorder()instanceof IncrementalHomeRecorder&&t.getHomeRecorder().addHome(e.getItem(),i),i.getView()}else e.getType()==CollectionEvent.Type.DELETE&&(t.homeControllers.splice(e.getIndex(),1),t.getHomeRecorder()instanceof IncrementalHomeRecorder&&t.getHomeRecorder().removeHome(e.getItem()))})),void 0!==this.configuration&&this.configuration.autoRecovery&&void 0===this.configuration.writeHomeEditsURL&&setTimeout((function(){t.autoRecoveryManager=new AutoRecoveryManager(t)}))}function AutoRecoveryManager(e){this.application=e;var t="SweetHome3DJS",i="Recovery";void 0!==e.configuration.autoRecoveryDatabase&&(t=e.configuration.autoRecoveryDatabase),void 0!==e.configuration.autoRecoveryObjectstore&&(i=e.configuration.autoRecoveryObjectstore);var n=this;function o(){HomeRecorder.call(this,{readHomeURL:n.autoRecoveryDatabaseUrlBase+"/content?name=%s.recovered",writeHomeURL:n.autoRecoveryDatabaseUrlBase+"?keyPathField=name&contentField=content&dateField=date&name=%s.recovered",readResourceURL:n.autoRecoveryDatabaseUrlBase+"/content?name=%s",writeResourceURL:n.autoRecoveryDatabaseUrlBase+"?keyPathField=name&contentField=content&dateField=date&name=%s",listHomesURL:n.autoRecoveryDatabaseUrlBase+"?name=(.*).recovered",deleteHomeURL:n.autoRecoveryDatabaseUrlBase+"?name=%s.recovered",writeHomeWithWorker:!0})}this.autoRecoveryDatabaseUrlBase="indexeddb://"+t+"/"+i,o.prototype=Object.create(DirectHomeRecorder.prototype),o.prototype.constructor=DirectHomeRecorder,o.prototype.getHomeXMLHandler=function(){return e.getHomeRecorder().getHomeXMLHandler()},o.prototype.getHomeXMLExporter=function(){return e.getHomeRecorder().getHomeXMLExporter()},this.autoSaveRecorder=new o,this.recoveredHomeNames=[];var r=e.getUserPreferences().getLocalizedString("FileContentManager","homeExtension"),l=e.getUserPreferences().getLocalizedString("FileContentManager","homeExtension2"),a=function(e){var t=e.getSource();t.isModified()||(t.removePropertyChangeListener("MODIFIED",a),setTimeout((function(){t.isModified()||n.deleteRecoveredHome(t.getName()),t.addPropertyChangeListener("MODIFIED",a)}),1e3))},s=function(e){n.recoveredHomeNames.splice(n.recoveredHomeNames.indexOf(e.getOldValue()),1),e.getSource().isRecovered()||n.deleteRecoveredHome(e.getOldValue()),n.recoveredHomeNames.push(e.getNewValue())},h=function(t){var i=t.getItem();t.getType()==CollectionEvent.Type.ADD?n.autoSaveRecorder.getAvailableHomes({availableHomes:function(t){null!=i.getName()&&n.recoveredHomeNames.push(i.getName());for(var o=!1,r=0;r<t.length;r++)if(null!=i.getName()&&this.homeNamesEqual(i.getName(),t[r])){e.configuration.silentAutoRecovery||confirm(e.getUserPreferences().getLocalizedString("SweetHome3DJSApplication","confirmRecoverHome"))?(o=!0,n.autoSaveRecorder.readHome(t[r],{homeLoaded:function(t){e.removeHomesListener(h),e.getHomeController(i).close();var o=t.getName();t.setRecovered(!0),t.addPropertyChangeListener("RECOVERED",(function(e){t.isRecovered()||(n.recoveredHomeNames.splice(n.recoveredHomeNames.indexOf(t.getName()),1),n.deleteRecoveredHome(o),t.addPropertyChangeListener("MODIFIED",a))})),t.addPropertyChangeListener("NAME",s),e.addHome(t),e.addHomesListener(h)},homeError:function(t){var n=e.getUserPreferences().getLocalizedString("HomeController","openError",i.getName())+"\n"+t;console.log(n),alert(n)}})):(n.recoveredHomeNames.splice(n.recoveredHomeNames.indexOf(i.getName()),1),n.deleteRecoveredHome(t[r]));break}o||(i.addPropertyChangeListener("MODIFIED",a),i.addPropertyChangeListener("NAME",s),i.isModified()&&(n.saveRecoveredHomes(),n.restartTimer()))},homesError:function(e,t){console.log("Couldn't retrieve homes from database : "+e+" "+t)},homeNamesEqual:function(e,t){var i=e.indexOf(r,e.length-r.length),n=e.indexOf(l,e.length-l.length),o=t.indexOf(r,t.length-r.length),a=t.indexOf(l,t.length-l.length);return(i>0||n>0)&&(o>0||a>0)?(i>0?e.substring(0,i):e.substring(0,n))===(o>0?t.substring(0,o):t.substring(0,a)):e===t}}):t.getType()==CollectionEvent.Type.DELETE&&null!=i.getName()&&(n.recoveredHomeNames.indexOf(i.getName())>=0&&(n.recoveredHomeNames.splice(n.recoveredHomeNames.indexOf(i.getName()),1),n.deleteRecoveredHome(i.getName())),i.removePropertyChangeListener("MODIFIED",a))};e.addHomesListener(h),this.lastAutoSaveTime=Date.now(),e.getUserPreferences().addPropertyChangeListener("AUTO_SAVE_DELAY_FOR_RECOVERY",(function(e){n.restartTimer()})),this.restartTimer()}JSSpinner.prototype=Object.create(JSComponent.prototype),JSSpinner.prototype.constructor=JSSpinner,JSSpinner.prototype.getValue=function(){return this.value},JSSpinner.prototype.setValue=function(e){if(e instanceof Big&&(e=parseFloat(e)),null!=e&&"number"!=typeof e)throw new Error("JSSpinner: Expected values of type number");null!=e||this.nullable||(e=this.getDefaultValue()),null!=e&&null!=this.minimum&&e<this.minimum&&(e=this.minimum),null!=e&&null!=this.maximum&&e>this.maximum&&(e=this.maximum),e!=this.value&&(this.value=e,this.updateUI())},JSSpinner.prototype.checkMinimumMaximum=function(e,t){if(null!=e&&null!=t&&e>t)throw new Error("JSSpinner: minimum is not below maximum - minimum = "+e+" maximum = "+t)},JSSpinner.prototype.isNullable=function(){return this.nullable},JSSpinner.prototype.setNullable=function(e){var t=this.nullable&&null===this.value;this.nullable=e,!e&&t&&(this.value=this.getDefaultValue())},JSSpinner.prototype.getFormat=function(){return this.format},JSSpinner.prototype.setFormat=function(e){this.format=e,this.updateUI()},JSSpinner.prototype.getMinimum=function(){return this.minimum},JSSpinner.prototype.setMinimum=function(e){this.checkMinimumMaximum(e,this.maximum),this.minimum=e},JSSpinner.prototype.getMinimum=function(){return this.minimum},JSSpinner.prototype.setMinimum=function(e){this.checkMinimumMaximum(e,this.maximum),this.minimum=e},JSSpinner.prototype.getMaximum=function(){return this.maximum},JSSpinner.prototype.setMaximum=function(e){this.checkMinimumMaximum(this.minimum,e),this.maximum=e},JSSpinner.prototype.getStepSize=function(){return this.stepSize},JSSpinner.prototype.setStepSize=function(e){this.stepSize=e},JSSpinner.prototype.getInputElement=function(){return this.textInput},JSSpinner.prototype.addEventListener=function(){return this.textInput.addEventListener.apply(this.textInput,arguments)},JSSpinner.prototype.removeEventListener=function(){return this.textInput.removeEventListener.apply(this.textInput,arguments)},JSSpinner.prototype.updateUI=function(){this.textInput.value=this.formatValueForUI(this.value)},JSSpinner.prototype.parseValueFromInput=function(e){return this.textInput.value&&""!=this.textInput.value.trim()?this.format.parse(this.textInput.value,null!=e?e:new ParsePosition(0)):this.nullable?null:this.value},JSSpinner.prototype.getDefaultValue=function(){var e=0;return null!=this.minimum&&this.minimum>e&&(e=this.minimum),null!=this.maximum&&this.maximum<e&&(e=this.maximum),e},JSSpinner.prototype.formatValueForUI=function(e){return null==e?"":this.isFocused()?(null!=this.noGroupingFormat&&this.lastFormat===this.format||(this.lastFormat=this.format,this.noGroupingFormat=this.lastFormat.clone(),this.noGroupingFormat.setGroupingUsed(!1)),this.noGroupingFormat.format(e)):this.format.format(e)},JSSpinner.prototype.isFocused=function(){return this.textInput===document.activeElement},JSSpinner.prototype.initIncrementDecrementButtons=function(e){var t=this;this.incrementButton=document.createElement("button"),this.incrementButton.setAttribute("increment",""),this.incrementButton.textContent="+",this.incrementButton.tabIndex=-1,e.appendChild(this.incrementButton),this.decrementButton=document.createElement("button"),this.decrementButton.setAttribute("decrement",""),this.decrementButton.textContent="-",this.decrementButton.tabIndex=-1,e.appendChild(this.decrementButton);var i=function(e){var i=t.value;(null==i||isNaN(i))&&(i=t.getDefaultValue()),t.setValue(i+t.stepSize),t.fireInputEvent()},n=function(e){var i=t.value;(null==i||isNaN(i))&&(i=t.getDefaultValue()),t.setValue(i-t.stepSize),t.fireInputEvent()},o=function(e,i,n){t.isFocused()&&e.preventDefault();var o=function(e){clearTimeout(a),i.removeEventListener("mouseleave",o),i.removeEventListener("mouseup",o)},r=function(e){clearTimeout(a),i.removeEventListener("click",r),n()};i.addEventListener("click",r);var l=function(){n(),a=setTimeout(l,80)},a=setTimeout((function(){i.removeEventListener("click",r),i.addEventListener("mouseleave",o),i.addEventListener("mouseup",o),l()}),400)};this.registerEventListener(t.incrementButton,"mousedown",(function(e){o(e,t.incrementButton,i)}));this.registerEventListener(t.decrementButton,"mousedown",(function(e){o(e,t.decrementButton,n)})),this.registerEventListener(t.textInput,"keydown",(function(e){var t=KeyStroke.getKeyStrokeForEvent(e,"keydown");t.lastIndexOf(" UP")>0?(e.stopImmediatePropagation(),i()):t.lastIndexOf(" DOWN")>0&&(e.stopImmediatePropagation(),n())})),this.registerEventListener(this.textInput,"focus",(function(e){t.updateUI()}))},JSSpinner.prototype.fireInputEvent=function(){var e=document.createEvent("Event");e.initEvent("input",!0,!0),this.textInput.dispatchEvent(e)},JSSpinner.prototype.setEnabled=function(e){this.textInput.disabled=!e,this.incrementButton.disabled=!e,this.decrementButton.disabled=!e},JSComboBox.prototype=Object.create(JSComponent.prototype),JSComboBox.prototype.constructor=JSComboBox,JSComboBox.prototype.initSelectionPanel=function(){var e=document.createElement("div");e.classList.add("selection-panel");for(var t=0;t<this.options.availableValues.length;t++){var i=document.createElement("div");i.value=this.options.availableValues[t],this.options.renderCell(i.value,i),e.appendChild(i)}this.getHTMLElement().appendChild(e),this.selectionPanel=e;var n=this;this.registerEventListener(e.children,"click",(function(e){n.selectedItem=this.value,n.updateUI(),"function"==typeof n.options.selectionChanged&&n.options.selectionChanged(n.selectedItem)})),this.registerEventListener(this.selectionPanel,"focusout",(function(e){comboBox.closeSelectionPanel()}))},JSComboBox.prototype.getSelectedItem=function(){return this.selectedItem},JSComboBox.prototype.setSelectedItem=function(e){for(var t=!1,i=0;i<this.options.availableValues.length;i++)if(this.areValuesEqual(e,this.options.availableValues[i])){t=!0;break}t||(e=null),null!=e||this.options.nullable||(e=this.options.availableValues[0]),this.areValuesEqual(e,this.selectedItem)||(this.selectedItem=e,this.updateUI())},JSComboBox.prototype.setEnabled=function(e){this.button.disabled=!e},JSComboBox.prototype.openSelectionPanel=function(e,t){null!=JSComboBox.current&&JSComboBox.current.closeSelectionPanel();var i=this;this.closeSelectionPanelListener=function(){i.closeSelectionPanel()},this.selectionPanel.style.display="block",this.selectionPanel.style.opacity=1,this.selectionPanel.style.left=(e+this.selectionPanel.clientWidth>window.width?window.width-this.selectionPanel.clientWidth:e)+"px",this.selectionPanel.style.top=(t+this.selectionPanel.clientHeight>window.innerHeight?window.innerHeight-this.selectionPanel.clientHeight:t)+"px",window.addEventListener("click",this.closeSelectionPanelListener),JSComboBox.current=this},JSComboBox.prototype.closeSelectionPanel=function(){window.removeEventListener("click",this.closeSelectionPanelListener),this.selectionPanel.style.opacity=0,this.selectionPanel.style.display="none",this.closeSelectionPanelListener=null,JSComboBox.current=null},JSComboBox.closeOpenedSelectionPanel=function(){return null!=JSComboBox.current&&(JSComboBox.current.closeSelectionPanel(),!0)},JSComboBox.prototype.updateUI=function(){this.preview.innerHTML="",this.options.renderCell(this.getSelectedItem(),this.preview)},JSComboBox.prototype.areValuesEqual=function(e,t){return JSON.stringify(e)==JSON.stringify(t)},JSTreeTable.prototype=Object.create(JSComponent.prototype),JSTreeTable.prototype.constructor=JSTreeTable,JSTreeTable.prototype.setData=function(e){this.data=e;var t=this.getExpandedRowsValues();null!=t&&this.updateState({expandedRowsValues:t}),this.isDisplayed()&&(this.generateTableRows(),this.fireExpandedRowsChanged())},JSTreeTable.prototype.updateRowData=function(e,t){if(this.isDisplayed())if(!this.state.sort||null==this.state.sort.columnName||void 0!==t&&this.state.sort.columnName!=t){var n=this.getColumnNames(),o=void 0!==t?n.indexOf(t):0;if(o>=0){var r=this.bodyElement.children;for(i=0;i<r.length;i++){var l=r[i];if(l._model.value===e){if(void 0!==t)this.model.renderCell(e,t,l.children[o]);else for(var a=0;a<n.length;a++)this.model.renderCell(e,n[a],l.children[a]);break}}}}else this.generateTableRows()},JSTreeTable.prototype.getData=function(){return this.data},JSTreeTable.prototype.setModel=function(e){this.model=e,this.updateState(e.initialState),this.columnsWidths=this.getColumnsWidthByName(),this.isDisplayed()&&(this.generateTableHeaders(),this.generateTableRows())},JSTreeTable.prototype.isDisplayed=function(){return"none"!=window.getComputedStyle(this.getHTMLElement()).display},JSTreeTable.prototype.setSelectedRowsByValue=function(e){if(this.selectedRowsValues=e.slice(0),this.isDisplayed()){this.expandGroupOfSelectedRows(e);for(var t=this.bodyElement.children,i=0;i<t.length;i++){(o=t[i])._model.selected=!1,o.classList.remove("selected")}for(var n=0;n<e.length;n++)for(i=0;i<t.length;i++){var o;if((o=t[i])._model.value===e[n]){this.selectRowAt(i);break}}this.scrollToSelectedRowsIfNotVisible()}},JSTreeTable.prototype.selectRowAt=function(e){var t=this.bodyElement.children,i=t[e];if(i._model.selected=!0,i.classList.add("selected"),i._model.group&&!1===i._model.collapsed)for(var n=e+1;n<t.length;n++){var o=t[n];o._model.parentGroup&&o._model.parentGroup.value===i._model.value&&this.selectRowAt(n)}},JSTreeTable.prototype.expandGroupOfSelectedRows=function(e){if(this.isDisplayed())for(var t=this.bodyElement.children,i=0;i<e.length;i++)for(var n=0;n<t.length;n++){var o=t[n];if(o._model.value===e[i]){if(o._model.hidden){this.expandOrCollapseRow(o._model.parentGroup,!0);for(var r=n-1;r>=0;r--)if(o._model.parentGroup.value===t[r]._model.value){for(t[r]._model.collapsed=!1,t[r].classList.remove("collapsed"),r++;r<t.length;r++){var l=t[r];l._model.parentGroup&&l._model.parentGroup.value===o._model.parentGroup.value&&(l._model.hidden=!1,l.style.display="flex")}o._model.parentGroup.parentGroup&&this.expandGroupOfSelectedRows([o._model.parentGroup.value]);break}}break}}},JSTreeTable.prototype.scrollToSelectedRowsIfNotVisible=function(){var e=this.bodyElement.querySelectorAll(".selected");if(e.length>0){for(var t=0;t<e.length;t++){var i=e[t],n=i.offsetTop-this.bodyElement.offsetTop,o=n+i.clientHeight;if(n>=this.bodyElement.scrollTop&&o<=this.bodyElement.scrollTop+this.bodyElement.clientHeight)return}this.bodyElement.scrollTop=e[0].offsetTop-this.bodyElement.offsetTop}},JSTreeTable.prototype.getExpandedRowsValues=function(){if(this.state&&this.state.expandedRowsValues)return this.state.expandedRowsValues},JSTreeTable.prototype.fireExpandedRowsChanged=function(){null!=this.state.expandedRowsValues&&(this.updateExpandedRowsIndices(),this.model.expandedRowsChanged(this.state.expandedRowsValues,this.state.expandedRowsIndices))},JSTreeTable.prototype.updateExpandedRowsIndices=function(){if(null!=this.state.expandedRowsValues&&null!=this.data&&null!=this.data.sortedList){this.state.expandedRowsIndices=[];for(var e=0;e<this.data.sortedList.length;e++){var t=this.data.sortedList[e].value;this.state.expandedRowsValues.indexOf(t)>-1&&this.state.expandedRowsIndices.push(e)}}},JSTreeTable.prototype.fireSortChanged=function(){null!=this.state.sort&&this.model.sortChanged(this.state.sort)},JSTreeTable.prototype.updateState=function(e){e&&CoreTools.merge(this.state,e)},JSTreeTable.prototype.getValueComparator=function(){return this.model.getValueComparator(this.state.sort)},JSTreeTable.prototype.generateTableHeaders=function(){var e=this,t=this.tableElement.querySelector("[header]");t||((t=document.createElement("div")).setAttribute("header","true"),this.tableElement.appendChild(t),this.tableElement.appendChild(document.createElement("br"))),t.innerHTML="";for(var i=this.getColumns(),n=0;n<i.length;n++){var o=i[n],r=document.createElement("div");t.appendChild(r),r.setAttribute("cell","true"),r.textContent=o.label,r.dataset.name=o.name,this.state.sort&&this.state.sort.columnName==o.name&&(r.classList.add("sort"),"desc"==this.state.sort.direction&&r.classList.add("descending")),r.style.width=e.getColumnWidth(o.name)}this.registerEventListener(t.children,"click",(function(t){var i=this.dataset.name,n=this.classList.contains("sort")&&!this.classList.contains("descending");e.sortTable(i,n)}))},JSTreeTable.prototype.generateTableRows=function(){var e=this,t=function(){var t=0;e.bodyElement&&(t=e.bodyElement.scrollTop,e.bodyElement.parentElement.removeChild(e.bodyElement)),e.bodyElement=document.createElement("div"),e.bodyElement.setAttribute("body","true");var i=e.data.sortedList=[],n=e.getValueComparator(),o=function(t,r,l){for(var a=r>0,s=null!=n?t.sort((function(e,t){return n(e.value,t.value)})):t,h=[],u=0;u<s.length;u++){var d=s[u],c=e.selectedRowsValues.indexOf(d.value)>-1,p=l&&l.selected||c,g={value:d.value,indentation:r,group:!1,parentGroup:l,selected:p,hidden:a,collapsed:void 0,childrenItems:void 0,setCollapsed:function(){},isInCollapsedGroup:function(){for(var e=this;e=e.parentGroup;)if(!0===e.collapsed)return!0;return!1}};h.push(g),i.push(g),Array.isArray(d.children)&&d.children.length>0&&(g.group=!0,g.collapsed=!0,g.childrenItems=o(d.children,r+1,g),g.setCollapsed=function(e){return function(t){e.collapsed=t;for(var i=0;i<e.childrenItems.length;i++)e.childrenItems[i].hidden=t}}(g))}return h};if(o(e.data.slice(0),0),e.updateExpandedRowsIndices(),e.state.expandedRowsIndices&&e.state.expandedRowsIndices.length>0){for(var r=[],l=0;l<e.state.expandedRowsIndices.length;l++){var a=i[e.state.expandedRowsIndices[l]];a&&(r.push(a.value),a.isInCollapsedGroup()||a.setCollapsed(!1))}r.length>0&&(e.state.expandedRowsValues=r)}var s=e.getColumnNames();for(l=0;l<i.length;l++){var h=e.generateRowElement(s,l,i[l]);e.bodyElement.appendChild(h)}e.tableElement.appendChild(e.bodyElement),e.bodyElement.scrollTop=t,delete e.generatingTableRows};this.data&&(e.bodyElement?this.generatingTableRows||(this.generatingTableRows=!0,setTimeout(t,0)):t())},JSTreeTable.prototype.generateRowElement=function(e,t,i){var n=this,o=document.createElement("div");o.setAttribute("row","true");for(var r=null,l=0;l<e.length;l++){var a=e[l],s=document.createElement("div");s.setAttribute("cell","true"),this.model.renderCell(i.value,a,s),s.style.width=this.getColumnWidth(a),(null==r||s.classList.contains("main"))&&(r=s),o.appendChild(s)}return null!=r&&(r.classList.add("main"),r.style.paddingLeft=15+10*i.indentation+"px",i.group&&(this.registerEventListener(r,"click",(function(e){if(e.clientX<16){e.stopImmediatePropagation();var t=r.parentElement.classList.contains("collapsed");n.expandOrCollapseRow(i,t),r.parentElement._model.collapsed=!t,t?r.parentElement.classList.remove("collapsed"):r.parentElement.classList.add("collapsed");for(var o=n.bodyElement.children,l=0;l<o.length;l++){o[l];var a=o[l]._model.isInCollapsedGroup();t&&o[l]._model.hidden!==a&&o[l].classList.add("selected"),o[l]._model.hidden=a,o[l].style.display=a?"none":"flex"}}return!1})),o.classList.add("group"),i.collapsed&&o.classList.add("collapsed"))),i.hidden&&(o.style.display="none"),i.selected&&o.classList.add("selected"),this.registerEventListener(o,"click",(function(e){var t=this,i=t._model.value;if(OperatingSystem.isMacOSX()?e.metaKey:e.ctrlKey){var o=n.selectedRowsValues.indexOf(i);o<0?(t.classList.add("selected"),n.selectedRowsValues.push(i)):(t.classList.remove("selected"),n.selectedRowsValues.splice(o,1))}else t.classList.add("selected"),n.selectedRowsValues=[i];"function"==typeof n.model.selectionChanged&&n.model.selectionChanged(n.selectedRowsValues)})),this.registerEventListener(o,"dblclick",(function(e){if("function"==typeof n.model.rowDoubleClicked){var t=this._model.value;n.model.rowDoubleClicked(t)}})),o._model=i,o},JSTreeTable.prototype.expandOrCollapseRow=function(e,t){var i=this;null==i.state.expandedRowsValues&&(i.state.expandedRowsValues=[]);var n=i.state.expandedRowsValues.indexOf(e.value);t?n<0&&(i.state.expandedRowsValues.push(e.value),this.fireExpandedRowsChanged()):n>=0&&(i.state.expandedRowsValues.splice(n,1),this.fireExpandedRowsChanged())},JSTreeTable.prototype.sortTable=function(e,t){this.state.sort||(this.state.sort={}),this.state.sort.columnName=e,this.state.sort.direction=t?"desc":"asc",this.fireSortChanged(this.state.sort)},JSTreeTable.prototype.getColumnWidth=function(e){return this.columnsWidths[e]},JSTreeTable.prototype.getColumns=function(){return this.model.columns.slice(0)},JSTreeTable.prototype.getColumnNames=function(){for(var e=new Array(this.model.columns.length),t=0;t<e.length;t++)e[t]=this.model.columns[t].name;return e},JSTreeTable.prototype.getColumnsWidthByName=function(){for(var e=this.model.columns,t={},i=0;i<e.length;i++){var n=e[i],o=n.defaultWidth?n.defaultWidth:"6rem";t[n.name]=o}return t},JSTreeTable.prototype.dispose=function(){this.unregisterEventListeners(),this.container.removeChild(this.tableElement)},ColorButton.prototype=Object.create(JSComponent.prototype),ColorButton.prototype.constructor=ColorButton,ColorButton.prototype.getColor=function(){return this.color},ColorButton.prototype.setColor=function(e){this.color=e,this.colorOverview.style.backgroundColor=null!=e?ColorTools.integerToHexadecimalString(e):"transparent"},ColorButton.prototype.getColorDialogTitle=function(){return this.colorDialogTitle},ColorButton.prototype.setColorDialogTitle=function(e){this.colorDialogTitle=e},ColorButton.prototype.setEnabled=function(e){this.button.disabled=!e},ColorButton.prototype.openColorDialog=function(e){var t=this,i=new JSColorChooserDialog(this.getUserPreferences(),this.colorDialogTitle,this.color,{applier:function(){var n=i.getSelectedColor();null!=n&&(n|=4278190080),t.setColor(n);var o=e.getRecentColors().slice(0),r=o.indexOf(n);0!=r&&(r>0?o.splice(r,1):o.length=Math.min(o.length,13),o.splice(0,0,n),e.setRecentColors(o)),void 0!==t.observer&&"function"==typeof t.observer.colorChanged&&t.observer.colorChanged(n)}});i.displayView()},JSColorChooser.prototype=Object.create(JSComponent.prototype),JSColorChooser.prototype.constructor=JSColorChooser,JSColorChooser.prototype.createPickerColorTiles=function(){var e=["#BEBD7F","#C2B078","#C6A664","#E5BE01","#CDA434","#A98307","#E4A010","#DC9D00","#8A6642","#C7B446","#EAE6CA","#E1CC4F","#E6D690","#EDFF21","#F5D033","#F8F32B","#9E9764","#999950","#F3DA0B","#FAD201","#AEA04B","#FFFF00","#9D9101","#F4A900","#D6AE01","#F3A505","#EFA94A","#6A5D4D","#705335","#F39F18","#ED760E","#C93C20","#CB2821","#FF7514","#F44611","#FF2301","#FFA420","#F75E25","#F54021","#D84B20","#EC7C26","#E55137","#C35831","#AF2B1E","#A52019","#A2231D","#9B111E","#75151E","#5E2129","#412227","#642424","#781F19","#C1876B","#A12312","#D36E70","#EA899A","#B32821","#E63244","#D53032","#CC0605","#D95030","#F80000","#FE0000","#CB3234","#B32428","#721422","#B44C43","#6D3F5B","#922B3E","#DE4C8A","#641C34","#6C4675","#A03472","#4A192C","#924E7D","#A18594","#CF3476","#8673A1","#6C6874","#354D73","#1F3438","#20214F","#1D1E33","#18171C","#1E2460","#3E5F8A","#26252D","#025669","#0E294B","#231A24","#3B83BD","#1E213D","#606E8C","#2271B3","#063971","#3F888F","#1B5583","#1D334A","#256D7B","#252850","#49678D","#5D9B9B","#2A6478","#102C54","#316650","#287233","#2D572C","#424632","#1F3A3D","#2F4538","#3E3B32","#343B29","#39352A","#31372B","#35682D","#587246","#343E40","#6C7156","#47402E","#3B3C36","#1E5945","#4C9141","#57A639","#BDECB6","#2E3A23","#89AC76","#25221B","#308446","#3D642D","#015D52","#84C3BE","#2C5545","#20603D","#317F43","#497E76","#7FB5B5","#1C542D","#193737","#008F39","#00BB2D","#78858B","#8A9597","#7E7B52","#6C7059","#969992","#646B63","#6D6552","#6A5F31","#4D5645","#4C514A","#434B4D","#4E5754","#464531","#434750","#293133","#23282B","#332F2C","#686C5E","#474A51","#2F353B","#8B8C7A","#474B4E","#B8B799","#7D8471","#8F8B66","#D7D7D7","#7F7679","#7D7F7D","#B5B8B1","#6C6960","#9DA1AA","#8D948D","#4E5452","#CAC4B0","#909090","#82898F","#D0D0D0","#898176","#826C34","#955F20","#6C3B2A","#734222","#8E402A","#59351F","#6F4F28","#5B3A29","#592321","#382C1E","#633A34","#4C2F27","#45322E","#403A3A","#212121","#A65E2E","#79553D","#755C48","#4E3B31","#763C28","#FDF4E3","#E7EBDA","#F4F4F4","#282828","#0A0A0A","#A5A5A5","#8F8F8F","#FFFFFF","#1C1C1C","#F6F6F6","#1E1E1E","#D7D7D7","#9C9C9C","#828282"];this.colorTileElements=[this.currentColorEditorPreview];for(var t=0;t<e.length;t++){var i=e[t],n=this.createColorTile(i);this.pickerElement.appendChild(n)}var o=this.getUserPreferences().getRecentColors();for(t=0;t<o.length;t++){i=ColorTools.integerToHexadecimalString(o[t]),n=this.createColorTile(i);this.recentColorsContainerElement.appendChild(n)}var r=this;this.registerEventListener(this.colorTileElements,"click",(function(e){r.selectColorTile(this)}))},JSColorChooser.prototype.initCustomColorEditor=function(){var e=this,t=null;if(!OperatingSystem.isInternetExplorerOrLegacyEdge()){(t=document.createElement("input")).type="color",t.classList.add("color-input"),this.customColorEditorPreview.appendChild(t);t.value="#010101",this.registerEventListener(t,"input",(function(i){e.customColorEditorPreview.style.backgroundColor=t.value,e.customColorEditorInput.value=t.value.substring(1).toUpperCase(),e.color=ColorTools.hexadecimalStringToInteger(t.value)}))}this.registerEventListener(this.customColorEditorInput,"input",(function(i){var n="#"+e.customColorEditorInput.value;n.match(/#[0-9a-fA-F]{3,6}/)&&(e.customColorEditorPreview.style.backgroundColor=n,e.color=ColorTools.hexadecimalStringToInteger(n),null!=t&&(t.value=n))}))},JSColorChooser.prototype.getColor=function(){return this.color},JSColorChooser.prototype.setColor=function(e){this.color=e;var t=null!=e?e:16777215,i=this.findElement("[data-color='"+t+"']");null!=i?this.selectColorTile(i):(this.customColorEditorInput.value=ColorTools.integerToHexadecimalString(t).substring(1),this.customColorEditorPreview.style.backgroundColor=ColorTools.integerToHexadecimalString(t)),null!=this.findElement(".color-input")&&(this.findElement(".color-input").value=ColorTools.integerToHexadecimalString(t)),this.currentColorEditorPreview.style.backgroundColor=ColorTools.integerToHexadecimalString(t),this.currentColorEditorPreview.dataset.color=t},JSColorChooser.prototype.selectColorTile=function(e){for(var t=0;t<this.colorTileElements.length;t++){var i=this.colorTileElements[t];i==e?i.classList.add("selected"):i.classList.remove("selected")}this.color=this.getTileColor(e);var n=ColorTools.integerToHexadecimalString(this.color);this.customColorEditorInput.value=n.substring(1),this.customColorEditorPreview.style.backgroundColor=n,null!=this.findElement(".color-input")&&(this.findElement(".color-input").value=n)},JSColorChooser.prototype.getTileColor=function(e){return parseInt(e.dataset.color)},JSColorChooser.prototype.createColorTile=function(e){var t=document.createElement("div");return t.dataset.color=ColorTools.hexadecimalStringToInteger(e),t.style.backgroundColor=e,this.colorTileElements.push(t),t},JSColorChooserDialog.prototype=Object.create(JSDialog.prototype),JSColorChooserDialog.prototype.constructor=JSColorChooserDialog,JSColorChooserDialog.prototype.getSelectedColor=function(){return this.colorChooser.getColor()},JSColorChooserDialog.prototype.dispose=function(){this.colorChooser.dispose(),JSDialog.prototype.dispose.call(this)},TextureChoiceComponent.prototype=Object.create(JSComponent.prototype),TextureChoiceComponent.prototype.constructor=TextureChoiceComponent,TextureChoiceComponent.prototype.updateTexture=function(e){if(null==e)this.preview.style.backgroundImage="none";else{var t=this;TextureManager.getInstance().loadTexture(e.getImage(),{textureUpdated:function(e){t.preview.style.backgroundImage="url('"+e.src+"')"},textureError:function(e){console.log("Image cannot be loaded",e)}})}},TextureChoiceComponent.prototype.setEnabled=function(e){this.button.disabled=!e},TextureChoiceComponent.prototype.openTextureDialog=function(){var e=new JSTextureDialog(this.getUserPreferences(),this.controller);null!=this.controller.getTexture()&&e.setSelectedTexture(this.controller.getTexture()),e.displayView()},TextureChoiceComponent.prototype.confirmDeleteSelectedCatalogTexture=function(){var e=this.getLocalizedLabelText("TextureChoiceComponent","confirmDeleteSelectedCatalogTexture.message").replace(/\<[^\>]*\>/g," ").replace(/[ ]+/g," ").replace(/^\s*/,"");return confirm(e)},JSTextureDialog.prototype=Object.create(JSDialog.prototype),JSTextureDialog.prototype.constructor=JSTextureDialog,JSTextureDialog.prototype.getSelectedTexture=function(){return null!=this.selectedTextureModel.texture?new HomeTexture(this.selectedTextureModel.texture,this.selectedTextureModel.xOffset,this.selectedTextureModel.yOffset,this.selectedTextureModel.angleInRadians,this.selectedTextureModel.scale,this.controller.getTexture()instanceof HomeTexture&&this.controller.getTexture().isFittingArea(),!0):null},JSTextureDialog.prototype.setSelectedTexture=function(e){if(null!=e){this.selectedTextureModel.texture=e,this.selectedTextureModel.xOffset=e.getXOffset(),this.selectedTextureModel.yOffset=e.getYOffset(),this.selectedTextureModel.angleInRadians=e.getAngle(),this.selectedTextureModel.scale=e.getScale(),this.xOffsetInput.setValue(100*this.selectedTextureModel.xOffset),this.yOffsetInput.setValue(100*this.selectedTextureModel.yOffset),this.angleInput.setValue(Math.toDegrees(this.selectedTextureModel.angleInRadians)),this.scaleInput.setValue(100*this.selectedTextureModel.scale);for(var t=e.getImage(),i=this.getUserPreferences().getTexturesCatalog().getCategories(),n=null,o=0;o<i.length&&null===n;o++)for(var r=i[o].getTextures(),l=0;l<r.length;l++)if(t.equals(r[l].getImage())){n=r[l];break}null!==n?this.selectTexture(n):this.selectTexture(e)}else this.selectedTexturePreview.style.backgroundImage="none";this.updateTextureTransform()},JSTextureDialog.prototype.selectTexture=function(e){this.selectedTextureModel.texture=e;var t=!1;if(null!=e){for(var i=0;i<this.texturesCatalogItems.length;i++)this.texturesCatalogItems[i].classList.remove("selected");if(e instanceof CatalogTexture){var n=this.getCatalogTextureItem(e);n.classList.add("selected");var o=this.catalogList;setTimeout((function(){var e=n.offsetTop-o.offsetTop,t=e+n.clientHeight;(e<o.scrollTop||t>o.scrollTop+o.clientHeight)&&(o.scrollTop=e-o.offsetTop)}),10),this.selectedTexturePreview.style.backgroundImage="url('"+n.querySelector("img").src+"')",t=null!=e&&e.isModifiable()}else{var r=this;TextureManager.getInstance().loadTexture(e.getImage(),{textureUpdated:function(e){r.selectedTexturePreview.style.backgroundImage="url('"+e.src+"')"},textureError:function(e){r.selectedTexturePreview.style.backgroundImage="none"}})}}else r.selectedTexturePreview.style.backgroundImage="none";this.modifyTextureButton.disabled=!t,this.deleteTextureButton.disabled=!t},JSTextureDialog.prototype.updateTextureTransform=function(){this.selectedTextureModel.xOffset=this.xOffsetInput.getValue()/100,this.selectedTextureModel.yOffset=this.yOffsetInput.getValue()/100,this.selectedTextureModel.angleInRadians=Math.toRadians(this.angleInput.getValue()),this.selectedTextureModel.scale=this.scaleInput.getValue()/100,this.selectedTexturePreview.style.transform=" rotate("+this.angleInput.getValue()+"deg)"},JSTextureDialog.prototype.getCatalogTextureItem=function(e){if(null!=e)for(var t=e.getImage(),i=0;i<this.texturesCatalogItems.length;i++){var n=this.texturesCatalogItems[i],o=this.getCatalogTextureFromItem(n).getImage();if(t.equals(o))return n}return null},JSTextureDialog.prototype.getCatalogTextureFromItem=function(e){return e._catalogTexture},JSTextureDialog.prototype.initCatalogTextureSearch=function(e){var t=this;this.searchInput=this.findElement(".texture-search input"),this.searchInput.placeholder=ResourceAction.getLocalizedLabelText(e,"TextureChoiceComponent","searchLabel.text").replace(":",""),this.registerEventListener(t.searchInput,"input",(function(){for(var e=CoreTools.removeAccents(t.searchInput.value.trim()),i=0;i<t.texturesCatalogItems.length;i++){var n=t.texturesCatalogItems[i],o=n._catalogTexture.getName()+"|"+n._catalogTexture.getCategory().getName();null!==n._catalogTexture.getCreator()&&(o+="|"+n._catalogTexture.getCreator()),RegExp(e,"i").test(CoreTools.removeAccents(o))?n.classList.remove("hidden"):n.classList.add("hidden")}})),this.searchInput.addEventListener("focusin",(function(e){setTimeout((function(){""!=t.searchInput.value&&t.searchInput.select()}),100)}))},JSTextureDialog.prototype.initRecentTextures=function(){var e=this;this.recentTexturesPanel.innerHTML="";for(var t=this.getUserPreferences().getRecentTextures(),i=0;i<t.length;i++){var n=t[i],o=document.createElement("div");o.classList.add("item"),o._catalogTexture=n,this.recentTexturesPanel.appendChild(o),TextureManager.getInstance().loadTexture(n.getImage(),{textureUpdated:function(e){o.style.backgroundImage="url('"+e.src+"')"},textureError:function(t){e.recentTexturesPanel.removeChild(o)}})}e=this;this.registerEventListener(this.recentTexturesPanel.childNodes,"click",(function(t){e.selectTexture(e.getCatalogTextureFromItem(this))}))},JSTextureDialog.prototype.initImportTexturesPanel=function(){this.importTextureButton=this.findElement(".imported-textures-panel [import]"),this.modifyTextureButton=this.findElement(".imported-textures-panel [modify]"),this.deleteTextureButton=this.findElement(".imported-textures-panel [delete]");var e=this,t=this.controller;this.registerEventListener(this.importTextureButton,"click",(function(e){t.importTexture()})),this.registerEventListener(this.modifyTextureButton,"click",(function(i){t.modifyTexture(e.selectedTextureModel.texture)})),this.registerEventListener(this.deleteTextureButton,"click",(function(i){t.deleteTexture(e.selectedTextureModel.texture)}))},ModelMaterialsComponent.prototype=Object.create(JSComponent.prototype),ModelMaterialsComponent.prototype.constructor=ModelMaterialsComponent,ModelMaterialsComponent.prototype.setEnabled=function(e){this.button.disabled=!e},ModelMaterialsComponent.prototype.openModelMaterialsSelectorDialog=function(){new JSModelMaterialsSelectorDialog(this.getUserPreferences(),this.controller).displayView()},ModelMaterialsComponent.prototype.dispose=function(){JSComponent.prototype.dispose.call(this)},JSModelMaterialsSelectorDialog.prototype=Object.create(JSDialog.prototype),JSModelMaterialsSelectorDialog.prototype.constructor=JSModelMaterialsSelectorDialog,JSModelMaterialsSelectorDialog.prototype.newArray=function(e){for(var t=new Array(e),i=0;i<t.length;i++)t[i]=null;return t},JSModelMaterialsSelectorDialog.prototype.initMaterialsList=function(){var e=this,t=this.controller,i=this.getElement("materials-list"),n=[],o=t.getMaterials();null!=o&&(o=o.slice(0)),ModelManager.getInstance().loadModel(t.getModel(),!0,{modelUpdated:function(i){if(n=ModelManager.getInstance().getMaterials(i,0!=(t.getModelFlags()&PieceOfFurniture.HIDE_EDGE_COLOR_MATERIAL),t.getModelCreator()),null!=o){for(var r=e.newArray(n.length),l=!1,a=0;a<n.length;a++)for(var s=n[a].getName(),h=0;h<o.length;h++)if(null!=o[h]&&o[h].getName()==s){r[a]=o[h],l=!0;break}o=l?r:null}}});var r=this.materialsList={element:i,materials:o,defaultMaterials:n,dataListeners:[],selectionListeners:[],size:function(){return null!=r.defaultMaterials?r.defaultMaterials.length:0},getMaterials:function(){return r.materials},getDefaultMaterialAt:function(e){return r.defaultMaterials[e]},getElementAt:function(e){return null!=r.materials&&null!=r.materials[e]&&null!=r.materials[e].getName()&&r.materials[e].getName()==r.defaultMaterials[e].getName()?r.materials[e]:new HomeMaterial(r.defaultMaterials[e].getName(),null,null,null)},setMaterialAt:function(t,i){if(null==t.getColor()&&null==t.getTexture()&&null==t.getShininess()){if(null!=r.materials){r.materials[i]=null;for(var n=!0,o=0;o<r.materials.length;o++)if(null!=r.materials[o]){n=!1;break}n&&(r.materials=null)}}else null!=r.materials&&r.materials.length==r.defaultMaterials.length||(r.materials=e.newArray(r.defaultMaterials.length)),r.materials[i]=t;r.fireContentsChanged()},fireContentsChanged:function(){for(var e=0;e<r.dataListeners.length;e++)r.dataListeners[e]();r.repaint()},createListItem:function(e,t,i){var n=e.getTexture(),o=e.getColor();null==n&&null==o&&null==(n=t.getTexture())&&(o=t.getColor());var r=document.createElement("div");r.classList.add("icon"),null!=n&&null!=n.getImage()?TextureManager.getInstance().loadTexture(n.getImage(),{textureUpdated:function(e){r.style.backgroundImage="url('"+e.src+"')"},textureError:function(e){r.style.backgroundImage="none"}}):null!=o&&0!=(4278190080&o)&&(r.style.backgroundColor=ColorTools.integerToHexadecimalString(o));var l=document.createElement("div");return l.textContent=e.getName(),i&&l.classList.add("selected"),l.appendChild(r),l},repaint:function(){var i=r.defaultMaterials,n=(r.materials,r.getSelectedIndices());if(r.element.innerHTML="",null!=i){r.element.innerHTML="";for(var o=0;o<i.length;o++){var l=r.getElementAt(o),a=r.getDefaultMaterialAt(o),s=n.indexOf(o)>-1;r.element.appendChild(r.createListItem(l,a,s))}e.registerEventListener(r.element.children,"click",(function(e){var t=this;if(OperatingSystem.isMacOSX()?e.metaKey:e.ctrlKey)t.classList.contains("selected")?(t.classList.remove("selected"),r.fireSelectionChanged()):r.selectItem(t);else{for(var i=0;i<r.element.children.length;i++){var n=r.element.children[i];n!=t&&n.classList.remove("selected")}r.selectItem(t)}})),e.registerEventListener(r.element.children,"dblclick",(function(i){r.selectItem(this),null!=e.colorButton.getColor()?e.colorButton.findElement("button").click():null!=t.getTextureController().getTexture()&&null!=e.textureComponent&&e.textureComponent.findElement("button").click()}))}},addListDataListener:function(e){r.dataListeners.push(e)},removeListDataListener:function(e){r.dataListeners.splice(r.dataListeners.index(e),1)},addListSelectionListener:function(e){r.selectionListeners.push(e)},addSelectionInterval:function(e,t){for(var i=e;i<=t;i++)r.element.children[i].classList.add("selected");r.fireSelectionChanged()},removeSelectionInterval:function(e,t){for(var i=e;i<=t;i++)r.element.children[i].classList.remove("selected");r.fireSelectionChanged()},clearSelection:function(){r.removeSelectionInterval(0,r.size()-1)},selectItem:function(e){e.classList.add("selected"),r.fireSelectionChanged()},fireSelectionChanged:function(){for(var e=0;e<r.selectionListeners.length;e++)r.selectionListeners[e]()},isSelectionEmpty:function(){return null!=r.element.querySelector(".selected")},getSelectedIndices:function(){for(var e=[],t=r.element.children,i=0;i<t.length;i++)t[i].classList.contains("selected")&&e.push(i);return e}};this.materialsList.repaint(),this.materialsList.addListSelectionListener((function(){var i=e.materialsList.getSelectedIndices();if(i.length>0){var n=e.materialsList.getElementAt(i[0]),o=n.getTexture(),r=n.getColor(),l=n.getShininess(),a=e.materialsList.getDefaultMaterialAt(i[0]);null==r&&null==o?(e.defaultColorAndTextureRadioButton.checked=!0,null!=(o=a.getTexture())?(e.colorButton.setColor(null),t.getTextureController().setTexture(o)):null!=(r=a.getColor())&&(t.getTextureController().setTexture(null),e.colorButton.setColor(r))):null!=o?(e.textureRadioButton.checked=!0,e.colorButton.setColor(null),t.getTextureController().setTexture(o)):0==(4278190080&r)?(e.invisibleRadioButton.checked=!0,null!=(o=a.getTexture())?(e.colorButton.setColor(null),t.getTextureController().setTexture(o)):null!=(r=a.getColor())&&(t.getTextureController().setTexture(null),e.colorButton.setColor(r))):(e.colorRadioButton.checked=!0,t.getTextureController().setTexture(null),e.colorButton.setColor(r)),e.shininessSlider.value=null!=l?128*l:null!=a.getShininess()?128*a.getShininess():0}e.enableComponents()}))},JSModelMaterialsSelectorDialog.prototype.initPreviewPanel=function(){var e=this.controller,t=this,i=this.getElement("preview-panel"),n=this.findElement("#model-preview-canvas");n.width=250,n.height=250;var o=t.previewComponent=new ModelPreviewComponent(n,!0);ModelManager.getInstance().loadModel(e.getModel(),!1,{modelUpdated:function(i){var n=t.materialsList;o.setModel(e.getModel(),e.getModelFlags(),e.getModelRotation(),e.getModelWidth(),e.getModelDepth(),e.getModelHeight()),o.setModelMaterials(n.getMaterials()),o.setModelTransformations(e.getModelTransformations()),n.addListDataListener((function(){o.setModelMaterials(n.getMaterials())}))},modelError:function(){i.style.visibility="hidden"}});var r=function(e){var i=t.previewComponent.getPickedMaterial();if(null!=i)for(var n=0,o=t.materialsList.size();n<o;n++){var r=t.materialsList.getDefaultMaterialAt(n);if(null!==r.getName()&&r.getName()==i.getName())if(OperatingSystem.isMacOSX()?e.metaKey:e.ctrlKey)t.materialsList.getSelectedIndices().indexOf(n)>=0?t.materialsList.removeSelectionInterval(n,n):t.materialsList.addSelectionInterval(n,n);else t.materialsList.clearSelection(),t.materialsList.addSelectionInterval(n,n)}};OperatingSystem.isInternetExplorerOrLegacyEdge()&&window.PointerEvent?(t.previewComponent.getHTMLElement().addEventListener("pointerdown",r),t.previewComponent.getHTMLElement().addEventListener("mousedown",r)):(t.previewComponent.getHTMLElement().addEventListener("touchstart",r),t.previewComponent.getHTMLElement().addEventListener("mousedown",r))},JSModelMaterialsSelectorDialog.prototype.initColorAndTexturePanel=function(){var e=this,t=this.controller;this.defaultColorAndTextureRadioButton=this.findElement("[name='color-and-texture-checkbox'][value='DEFAULT']"),this.invisibleRadioButton=this.findElement("[name='color-and-texture-checkbox'][value='INVISIBLE']"),this.colorRadioButton=this.findElement("[name='color-and-texture-checkbox'][value='COLOR']"),this.textureRadioButton=this.findElement("[name='color-and-texture-checkbox'][value='TEXTURE']");var i=function(t){for(var i=e.materialsList.getSelectedIndices(),n=0;n<i.length;n++){var o=i[n],r=e.materialsList.getElementAt(o);e.materialsList.setMaterialAt(t(r,o),o)}};this.registerEventListener(this.defaultColorAndTextureRadioButton,"click",(function(e){!this.disabled&&this.checked&&i((function(e){return new HomeMaterial(e.getName(),null,null,e.getShininess())}))})),this.registerEventListener(this.invisibleRadioButton,"click",(function(e){!this.disabled&&this.checked&&i((function(e){return new HomeMaterial(e.getName(),0,null,e.getShininess())}))}));var n=function(){!e.colorRadioButton.disabled&&e.colorRadioButton.checked&&i((function(t,i){var n=e.materialsList.getDefaultMaterialAt(i),o=n.getColor()!=e.colorButton.getColor()||null!=n.getTexture()?e.colorButton.getColor():null;return new HomeMaterial(t.getName(),o,null,t.getShininess())}))};this.colorButton=new ColorButton(this.getUserPreferences(),{colorChanged:function(t){null!=t&&(e.colorRadioButton.checked=!0,n())}}),this.colorButton.setColorDialogTitle(this.getUserPreferences().getLocalizedString("ModelMaterialsComponent","colorDialog.title")),this.registerEventListener(this.colorRadioButton,"click",(function(t){e.colorRadioButton.checked&&n()})),this.attachChildComponent("color-button",this.colorButton);var o=function(){!e.textureRadioButton.disabled&&e.textureRadioButton.checked&&i((function(i,n){var o=e.materialsList.getDefaultMaterialAt(n).getTexture()!=t.getTextureController().getTexture()?t.getTextureController().getTexture():null;return new HomeMaterial(i.getName(),null,o,i.getShininess())}))};this.textureComponent=t.getTextureController().getView(),this.textureComponent.textureChanged=function(t){null!=t&&(e.textureRadioButton.checked=!0,o())},this.registerEventListener(this.textureRadioButton,"click",(function(t){e.textureRadioButton.checked&&o()})),this.registerPropertyChangeListener(t.getTextureController(),"TEXTURE",(function(t){null!=t.getNewValue()&&(e.textureRadioButton.checked||(e.textureRadioButton.checked=!0),o())})),this.attachChildComponent("texture-component",this.textureComponent)},JSModelMaterialsSelectorDialog.prototype.initShininessPanel=function(){var e=this;this.shininessSlider=this.getElement("shininess-slider");for(var t=this.findElement("#model-materials-shininess-list"),i=0;i<=128;i+=16){var n=document.createElement("option");n.value=i,t.appendChild(n)}this.registerEventListener(this.shininessSlider,"input",(function(t){for(var i=this.value,n=e.materialsList.getSelectedIndices(),o=0;o<n.length;o++){var r=n[o],l=e.materialsList.getElementAt(r);e.materialsList.setMaterialAt(new HomeMaterial(l.getName(),l.getColor(),l.getTexture(),i/128),r)}}))},JSModelMaterialsSelectorDialog.prototype.enableComponents=function(){var e=!this.materialsList.isSelectionEmpty();this.defaultColorAndTextureRadioButton.disabled=e,this.invisibleRadioButton.disabled=e,this.textureRadioButton.disabled=e,this.textureComponent.setEnabled(!e),this.colorRadioButton.disabled=e,this.colorButton.setEnabled(!e),this.shininessSlider.disabled=e},JSViewFactory.prototype=Object.create(JSViewFactory.prototype),JSViewFactory.prototype.constructor=JSViewFactory,JSViewFactory.__class="JSViewFactory",JSViewFactory.__interfaces=["com.eteks.sweethome3d.viewcontroller.ViewFactory"],JSViewFactory.dummyDialogView={displayView:function(e){}},JSViewFactory.prototype.createFurnitureCatalogView=function(e,t,i){return new FurnitureCatalogListPanel("furniture-catalog",e,t,i)},JSViewFactory.prototype.createFurnitureView=function(e,t,i){return null!=document.getElementById("furniture-view")?new FurnitureTablePanel("furniture-view",e,t,i):void 0},JSViewFactory.prototype.createPlanView=function(e,t,i){return new PlanComponent("home-plan",e,t,i)},JSViewFactory.prototype.createView3D=function(e,t,i){return new HomeComponent3D("home-3D-view",e,t,null,i)},JSViewFactory.prototype.createHomeView=function(e,t,i){return new HomePane("home-pane",e,t,i)},JSViewFactory.prototype.createWizardView=function(e,t){return new JSWizardDialog(e,t,t.getTitle()||"@{WizardPane.wizard.title}",{})},JSViewFactory.prototype.createBackgroundImageWizardStepsView=function(e,t,i){function n(){JSComponent.call(this,t,"<div choiceStep>  <div description>@{BackgroundImageWizardStepsPanel.imageChangeLabel.text}</div>  <div class='buttons'>    <button selectImage></button>    <input type='file' accept='image/*' style='display: none' />  </div>  <div preview>    <img />  </div></div><div scaleStep>  <div>@{BackgroundImageWizardStepsPanel.scaleLabel.text}</div>  <br />  <div>    <span data-name='scale-distance-label'></span>    <span data-name='scale-distance-input'></span>  </div>  <br />  <div class='preview-panel'>    <div preview>      <canvas />    </div>    <div class='preview-controls' style='z-index:5'>      <div previewZoomIn></div>      <br />      <div previewZoomOut></div>    </div>  </div></div><div originStep>  <div>@{BackgroundImageWizardStepsPanel.originLabel.text}</div>  <br />  <div>    <span data-name='x-origin-label'></span>    <span data-name='x-origin-input'></span>    <span data-name='y-origin-label'></span>    <span data-name='y-origin-input'></span>  </div>  <br />  <div class='preview-panel'>    <div preview>      <canvas />    </div>    <div class='preview-controls' style='z-index:5'>      <div previewZoomIn></div>      <br />      <div previewZoomOut></div>    </div>  </div></div>"),this.controller=i,this.getHTMLElement().classList.add("background-image-wizard"),this.initImageChoiceStep(),this.initScaleStep(),this.initOriginStep();var n=this;this.registerPropertyChangeListener(i,"STEP",(function(e){n.updateStep(),n.repaintOriginCanvas()})),this.registerPropertyChangeListener(i,"IMAGE",(function(e){n.updatePreviewComponentsImage()})),this.updateImage(e)}return n.prototype=Object.create(JSComponent.prototype),n.prototype.constructor=n,n.prototype.buildHtmlFromTemplate=function(e){return JSComponent.prototype.buildHtmlFromTemplate.call(this,e).replace(/\<br\>/g," ")},n.prototype.initImageChoiceStep=function(){var e=this;e.imageChoiceStep={panel:e.findElement("[choiceStep]"),imageChoiceOrChangeLabel:e.findElement("[choiceStep] [description]"),imageChoiceOrChangeButton:e.findElement("[choiceStep] [selectImage]"),imageChooser:e.findElement("[choiceStep] input[type='file']"),preview:e.findElement("[choiceStep] [preview] img")};var i=function(i){console.warn("Error loading image: "+i),e.controller.setImage(null),e.setImageChoiceTexts(),e.updatePreviewComponentsImage(),alert(ResourceAction.getLocalizedLabelText(t,"BackgroundImageWizardStepsPanel","imageChoiceErrorLabel.text"))};e.registerEventListener(e.imageChoiceStep.imageChoiceOrChangeButton,"click",(function(t){e.imageChoiceStep.imageChooser.click()}));var n=function(t){if(t){var n=new FileReader;n.onload=function(n){var o=new Image;o.addEventListener("load",(function(i){e.updateController(o,t)})),o.addEventListener("error",i),o.src=n.target.result},n.onerror=i,n.readAsDataURL(t)}};e.registerEventListener(e.imageChoiceStep.imageChooser,"input",(function(e){n(this.files[0])})),e.registerEventListener(e.imageChoiceStep.preview,"drop",(function(e){e.preventDefault(),n(e.dataTransfer.files[0])})),e.registerEventListener(e.imageChoiceStep.preview,"dragover",(function(e){e.preventDefault()}))},n.prototype.initScaleStep=function(){var e=this,n=t.getLengthUnit().getName(),o=t.getLengthUnit().getMaximumLength();e.scaleStep={panel:e.findElement("[scaleStep]"),preview:e.findElement("[scaleStep] [preview] canvas"),previewZoomIn:e.findElement("[scaleStep] [previewZoomIn]"),previewZoomOut:e.findElement("[scaleStep] [previewZoomOut]"),scaleDistanceLabel:e.getElement("scale-distance-label"),scaleDistanceInput:new JSSpinner(t,e.getElement("scale-distance-input"),{format:t.getLengthUnit().getFormat(),minimum:t.getLengthUnit().getMinimumLength(),maximum:o,stepSize:t.getLengthUnit().getStepSize()})},e.scaleStep.scaleDistanceLabel.textContent=this.getLocalizedLabelText("BackgroundImageWizardStepsPanel","scaleDistanceLabel.text",n),e.registerEventListener(e.scaleStep.scaleDistanceInput,"input",(function(t){i.setScaleDistance(null!=e.scaleStep.scaleDistanceInput.getValue()?parseFloat(e.scaleStep.scaleDistanceInput.getValue()):null)}));var r=function(){var t=i.getScaleDistance();e.scaleStep.scaleDistanceInput.setNullable(null===t),e.scaleStep.scaleDistanceInput.setValue(t)};r(),this.registerPropertyChangeListener(i,"SCALE_DISTANCE",r);var l=new ResourceAction(t,"BackgroundImageWizardStepsPanel","ZOOM_IN",!0),a=new ResourceAction(t,"BackgroundImageWizardStepsPanel","ZOOM_OUT",!0);e.scaleStep.previewZoomIn.style.backgroundImage="url('"+l.getURL(AbstractAction.SMALL_ICON)+"')",e.registerEventListener(e.scaleStep.previewZoomIn,"click",(function(t){e.scaleStep.preview.width*=2,e.repaintScaleCanvas()})),e.scaleStep.previewZoomOut.style.backgroundImage="url('"+a.getURL(AbstractAction.SMALL_ICON)+"')",e.registerEventListener(e.scaleStep.previewZoomOut,"click",(function(t){e.scaleStep.preview.width/=2,e.repaintScaleCanvas()})),this.registerPropertyChangeListener(i,"SCALE_DISTANCE_POINTS",(function(){e.repaintScaleCanvas()})),e.repaintScaleCanvas();var s=this.scaleStep.preview;s.style.touchAction="none";var h=function(e){s.dragging&&(s.dragging=!1,s.distanceStartPoint=s.distanceEndPoint=!1)},u=function(t){t.stopImmediatePropagation();var n=s.getBoundingClientRect(),o=t.touches&&t.touches.length>0?t.touches[0]:t,r=o.clientX-n.left,l=o.clientY-n.top;if(s.dragging){var a,h,u=r/(g=s.width/e.selectedImage.width),d=l/g,c=i.getScaleDistancePoints();if(s.distanceStartPoint?(a=c[0],h=c[1]):(a=c[1],h=c[0]),java.awt.geom.Point2D.distanceSq(h[0]*g,h[1]*g,u*g,d*g)>=4){if(t.shiftKey){var p=Math.abs(Math.atan2(h[1]-d,u-h[0]));p>Math.PI/4&&p<=3*Math.PI/4?u=h[0]:d=h[1]}a[0]=u,a[1]=d,i.setScaleDistancePoints(c[0][0],c[0][1],c[1][0],c[1][1]),e.repaintScaleCanvas()}}else{s.distanceStartPoint=s.distanceEndPoint=!1;c=i.getScaleDistancePoints();var g=s.width/e.selectedImage.width;Math.abs(c[0][0]*g-r)<=10&&Math.abs(c[0][1]*g-l)<=10?s.distanceStartPoint=!0:Math.abs(c[1][0]*g-r)<=10&&Math.abs(c[1][1]*g-l)<=10&&(s.distanceEndPoint=!0),s.distanceStartPoint||s.distanceEndPoint?s.style.cursor="crosshair":s.style.cursor="default"}},d=function(e){e.stopImmediatePropagation(),u(e),(s.distanceStartPoint||s.distanceEndPoint)&&(s.dragging=!0)};this.registerEventListener(s,"mousedown",d,!0),this.registerEventListener(s,"touchstart",d,!0),this.registerEventListener(s,"mousemove",u,!0),this.registerEventListener(s,"touchmove",u,!0),this.registerEventListener(s,"mouseup",h,!0),this.registerEventListener(s,"touchend",h,!0)},n.prototype.repaintScaleCanvas=function(){var e=this.scaleStep.preview,t=new Graphics2D(e);t.fillRect(0,0,e.width,e.height);var i=this.selectedImage;if(i){e.height=i.height/i.width*e.width,t.drawImageWithSize(i,0,0,e.width,e.height),t.setColor("blue");var n=t.getTransform(),o=e.width/i.width;t.scale(o,o),t.setStroke(new java.awt.BasicStroke(5/o,java.awt.BasicStroke.CAP_BUTT,java.awt.BasicStroke.JOIN_BEVEL));var r=this.controller.getScaleDistancePoints();t.draw(new java.awt.geom.Line2D.Float(r[0][0],r[0][1],r[1][0],r[1][1])),t.setStroke(new java.awt.BasicStroke(1/o,java.awt.BasicStroke.CAP_BUTT,java.awt.BasicStroke.JOIN_BEVEL));var l=Math.atan2(r[1][1]-r[0][1],r[1][0]-r[0][0]),a=t.getTransform();t.translate(r[0][0],r[0][1]),t.rotate(l);var s=new java.awt.geom.Line2D.Double(0,5/o,0,-5/o);t.draw(s),t.setTransform(a),t.translate(r[1][0],r[1][1]),t.rotate(l),t.draw(s),t.setTransform(n)}},n.prototype.initOriginStep=function(){var e=this,n=t.getLengthUnit().getName(),o=t.getLengthUnit().getMaximumLength();this.originStep={panel:this.findElement("[originStep]"),preview:this.findElement("[originStep] [preview] canvas"),previewZoomIn:this.findElement("[originStep] [previewZoomIn]"),previewZoomOut:this.findElement("[originStep] [previewZoomOut]"),xOriginLabel:this.getElement("x-origin-label"),xOriginInput:new JSSpinner(t,this.getElement("x-origin-input"),{format:t.getLengthUnit().getFormat(),value:i.getXOrigin(),minimum:-o,maximum:o,stepSize:t.getLengthUnit().getStepSize()}),yOriginLabel:this.getElement("y-origin-label"),yOriginInput:new JSSpinner(t,this.getElement("y-origin-input"),{format:t.getLengthUnit().getFormat(),value:i.getYOrigin(),minimum:-o,maximum:o,stepSize:t.getLengthUnit().getStepSize()})},this.originStep.xOriginLabel.textContent=this.getLocalizedLabelText("BackgroundImageWizardStepsPanel","xOriginLabel.text",n),this.originStep.yOriginLabel.textContent=this.getLocalizedLabelText("BackgroundImageWizardStepsPanel","yOriginLabel.text",n),this.registerEventListener([this.originStep.xOriginInput,this.originStep.yOriginInput],"input",(function(t){i.setOrigin(e.originStep.xOriginInput.getValue(),e.originStep.yOriginInput.getValue())})),this.registerPropertyChangeListener(i,"X_ORIGIN",(function(){e.originStep.xOriginInput.setValue(i.getXOrigin()),e.repaintOriginCanvas()})),this.registerPropertyChangeListener(i,"Y_ORIGIN",(function(){e.originStep.yOriginInput.setValue(i.getYOrigin()),e.repaintOriginCanvas()}));var r=this.originStep.preview,l=new ResourceAction(t,"BackgroundImageWizardStepsPanel","ZOOM_IN",!0),a=new ResourceAction(t,"BackgroundImageWizardStepsPanel","ZOOM_OUT",!0);this.originStep.previewZoomIn.style.backgroundImage="url('"+l.getURL(AbstractAction.SMALL_ICON)+"')",this.registerEventListener(this.originStep.previewZoomIn,"click",(function(t){e.originStep.preview.width*=2,e.repaintOriginCanvas()})),this.originStep.previewZoomOut.style.backgroundImage="url('"+a.getURL(AbstractAction.SMALL_ICON)+"')",this.registerEventListener(this.originStep.previewZoomOut,"click",(function(t){e.originStep.preview.width/=2,e.repaintOriginCanvas()}));var s=function(t){e.isMovingOrigin=!1,r.style.cursor="default"},h=function(t){if(t.stopImmediatePropagation(),e.isMovingOrigin){var n=r.getBoundingClientRect(),o=t.touches&&t.touches.length>0?t.touches[0]:t,l=i.getScaleDistancePoints(),a=e.originStep.preview.width/e.selectedImage.width;a/=BackgroundImage.getScale(i.getScaleDistance(),l[0][0],l[0][1],l[1][0],l[1][1]);var s=Math.round((o.clientX-n.left)/a*10)/10,h=Math.round((o.clientY-n.top)/a*10)/10;i.setOrigin(s,h),e.repaintOriginCanvas()}},u=function(t){e.isMovingOrigin=!0,r.style.cursor="crosshair",h(t)};this.registerEventListener(r,"mousedown",u,!0),this.registerEventListener(r,"touchstart",u,!0),this.registerEventListener(r,"mousemove",h,!0),this.registerEventListener(r,"touchmove",h,!0),this.registerEventListener(r,"mouseup",s,!0),this.registerEventListener(r,"touchend",s,!0)},n.prototype.repaintOriginCanvas=function(){var e=this.originStep.preview,t=new Graphics2D(e);t.fillRect(0,0,e.width,e.height);var i=this.selectedImage;if(i){e.height=i.height/i.width*e.width,t.drawImageWithSize(i,0,0,e.width,e.height),t.setColor("blue");var n=t.getTransform(),o=e.width/i.width,r=this.controller.getScaleDistancePoints();o/=BackgroundImage.getScale(this.controller.getScaleDistance(),r[0][0],r[0][1],r[1][0],r[1][1]),t.scale(o,o),t.translate(this.controller.getXOrigin(),this.controller.getYOrigin());var l=4/o;t.fill(new java.awt.geom.Ellipse2D.Float(-l,-l,2*l,2*l)),t.setStroke(new java.awt.BasicStroke(1/o,java.awt.BasicStroke.CAP_BUTT,java.awt.BasicStroke.JOIN_BEVEL)),t.draw(new java.awt.geom.Line2D.Double(8/o,0,-8/o,0)),t.draw(new java.awt.geom.Line2D.Double(0,8/o,0,-8/o)),t.setTransform(n)}},n.prototype.setImageChangeTexts=function(){this.imageChoiceStep.imageChoiceOrChangeLabel.innerHTML=this.getLocalizedLabelText("BackgroundImageWizardStepsPanel","imageChangeLabel.text").replace(/\<br\>/g," "),this.imageChoiceStep.imageChoiceOrChangeButton.innerHTML=this.getLocalizedLabelText("BackgroundImageWizardStepsPanel","imageChangeButton.text")},n.prototype.setImageChoiceTexts=function(){this.imageChoiceStep.imageChoiceOrChangeLabel.innerHTML=this.getLocalizedLabelText("BackgroundImageWizardStepsPanel","imageChoiceLabel.text").replace(/\<br\>/g," "),this.imageChoiceStep.imageChoiceOrChangeButton.innerHTML=this.getLocalizedLabelText("BackgroundImageWizardStepsPanel","imageChoiceButton.text")},n.prototype.updateImage=function(e){null==e?(this.setImageChoiceTexts(),this.updatePreviewComponentsImage()):(this.setImageChangeTexts(),setTimeout((function(){i.setImage(e.getImage()),i.setScaleDistance(e.getScaleDistance()),i.setScaleDistancePoints(e.getScaleDistanceXStart(),e.getScaleDistanceYStart(),e.getScaleDistanceXEnd(),e.getScaleDistanceYEnd()),i.setOrigin(e.getXOrigin(),e.getYOrigin())}),100))},n.prototype.updateController=function(e,t){var i=this,n=this.controller,o=ImageTools.isImageWithAlpha(e)?"image/png":"image/jpeg";this.checkImageSize(e,o,(function(r){var l=function(e){setTimeout((function(){n.setImage(e),i.setImageChangeTexts();var t=n.getReferenceBackgroundImage();if(null!=t&&t.getScaleDistanceXStart()<r.width&&t.getScaleDistanceXEnd()<r.width&&t.getScaleDistanceYStart()<r.height&&t.getScaleDistanceYEnd()<r.height)n.setScaleDistance(t.getScaleDistance()),n.setScaleDistancePoints(t.getScaleDistanceXStart(),t.getScaleDistanceYStart(),t.getScaleDistanceXEnd(),t.getScaleDistanceYEnd()),n.setOrigin(t.getXOrigin(),t.getYOrigin());else{n.setScaleDistance(null);var o=.1*r.width,l=r.height/2,a=.9*r.width;n.setScaleDistancePoints(o,l,a,l),n.setOrigin(0,0)}}),100)};e!==r||"image/jpeg"!=t.type&&"image/png"!=t.type?BlobURLContent.fromImage(r,o,l):l(BlobURLContent.fromBlob(t))}))},n.prototype.checkImageSize=function(e,i,n){if(e.width*e.height<1e7)n(e);else{var o=Math.sqrt(8e6/(e.width*e.height)),r=Math.round(e.width*o),l=Math.round(e.height*o),a=function(){ImageTools.resize(e,r,l,n,i)};if(this.getUserPreferences().isImportedImageResizedWithoutPrompting())a();else new JSImageResizingDialog(t,"@{BackgroundImageWizardStepsPanel.reduceImageSize.title}",this.getLocalizedLabelText("BackgroundImageWizardStepsPanel","reduceImageSize.message",[e.width,e.height,r,l]),"@{BackgroundImageWizardStepsPanel.reduceImageSize.cancel}","@{BackgroundImageWizardStepsPanel.reduceImageSize.keepUnchanged}","@{BackgroundImageWizardStepsPanel.reduceImageSize.reduceSize}",a,(function(){n(e)})).displayView()}},n.prototype.updatePreviewComponentsImage=function(){var e=this,t=this.controller.getImage();delete this.imageChoiceStep.preview.src,this.imageChoiceStep.preview.width=0,delete this.scaleStep.preview.src,delete this.originStep.preview.src,null!=t&&TextureManager.getInstance().loadTexture(t,{textureUpdated:function(t){e.imageChoiceStep.preview.src=t.src,e.imageChoiceStep.preview.width=t.width,e.selectedImage=t,t.width>400&&(e.scaleStep.preview.width=400,e.originStep.preview.width=400),e.repaintScaleCanvas(),e.repaintOriginCanvas()},textureError:function(e){imageErrorListener(e)}})},n.prototype.updateStep=function(){switch(this.controller.getStep()){case BackgroundImageWizardController.Step.CHOICE:this.imageChoiceStep.panel.style.display="flex",this.scaleStep.panel.style.display="none",this.originStep.panel.style.display="none";break;case BackgroundImageWizardController.Step.SCALE:this.imageChoiceStep.panel.style.display="none",this.scaleStep.panel.style.display="flex",delete this.scaleStep.panel.style.display,this.originStep.panel.style.display="none";break;case BackgroundImageWizardController.Step.ORIGIN:this.imageChoiceStep.panel.style.display="none",this.scaleStep.panel.style.display="none",this.originStep.panel.style.display="flex"}},new n},JSViewFactory.prototype.createImportedFurnitureWizardStepsView=function(e,t,i,n,o){return null},JSViewFactory.prototype.createImportedTextureWizardStepsView=function(e,t,i,n){var o=512;function r(){JSComponent.call(this,i,"<div imageStep>  <div description>@{ImportedTextureWizardStepsPanel.imageChangeLabel.text}</div>  <div class='buttons'>    <button changeImage>@{ImportedTextureWizardStepsPanel.imageChangeButton.text}</button>    <button findImage>@{ImportedTextureWizardStepsPanel.findImagesButton.text}</button>    <input type='file' accept='image/*' style='display: none'/>  </div>  <div preview>    <img>  </div></div><div attributesStep>  <div description></div>  <div form>    <div preview>      <img />    </div>    <div>@{ImportedTextureWizardStepsPanel.nameLabel.text}</div>    <div>      <input type='text' name='name' />    </div>    <div>@{ImportedTextureWizardStepsPanel.categoryLabel.text}</div>    <div>      <select name='category'></select>    </div>    <div>@{ImportedTextureWizardStepsPanel.creatorLabel.text}</div>    <div>      <input type='text' name='creator' />    </div>    <div data-name='width-label' class='label-cell'></div>    <div>      <span data-name='width-input'></span>    </div>    <div data-name='height-label' class='label-cell'></div>    <div>      <span data-name='height-input'></span>    </div>  </div></div>"),this.controller=n,this.userCategory=new TexturesCategory(ResourceAction.getLocalizedLabelText(i,"ImportedTextureWizardStepsPanel","userCategory")),this.getHTMLElement().classList.add("imported-texture-wizard"),this.initComponents();var e=this;this.registerPropertyChangeListener(n,"STEP",(function(t){e.updateStep()}))}return r.prototype=Object.create(JSComponent.prototype),r.prototype.constructor=r,r.prototype.initComponents=function(){this.imageStepPanel=this.findElement("[imageStep]"),this.imageChoiceOrChangeLabel=this.findElement("[imageStep] [description]"),this.imageChoiceOrChangeButton=this.findElement("button[changeImage]"),this.imageFindImageButton=this.findElement("button[findImage]"),this.imageChooserInput=this.findElement("input[type='file']"),this.previewPanel=this.findElement("[preview]"),null==e&&this.setImageChoiceTexts(),this.attributesStepPanel=this.findElement("[attributesStep]"),this.attributesStepPanelDescription=this.findElement("[attributesStep] [description]"),this.attributesPreviewPanel=this.findElement("[attributesStep] [preview]"),this.nameInput=this.findElement("input[name='name']"),this.categorySelect=this.findElement("select[name='category']"),this.creatorInput=this.findElement("input[name='creator']");var t=i.getLengthUnit().getName(),o=i.getLengthUnit().getMinimumLength(),r=i.getLengthUnit().getMaximumLength();this.widthLabel=this.getElement("width-label"),this.widthLabel.textContent=this.getLocalizedLabelText("ImportedTextureWizardStepsPanel","widthLabel.text",t),this.widthInput=new JSSpinner(i,this.getElement("width-input"),{format:i.getLengthUnit().getFormat(),minimum:o,maximum:r,stepSize:i.getLengthUnit().getStepSize()}),this.heightLabel=this.getElement("height-label"),this.heightLabel.textContent=this.getLocalizedLabelText("ImportedTextureWizardStepsPanel","heightLabel.text",t),this.heightInput=new JSSpinner(i,this.getElement("height-input"),{format:i.getLengthUnit().getFormat(),minimum:o,maximum:r,stepSize:i.getLengthUnit().getStepSize()});var l=this,a=function(e){console.warn("Error loading image: "+e),l.controller.setImage(null),l.setImageChoiceTexts(),l.updatePreviewComponentsImage(),alert(ResourceAction.getLocalizedLabelText(i,"ImportedTextureWizardStepsPanel","imageChoiceErrorLabel.text"))};this.registerEventListener(this.imageChoiceOrChangeButton,"click",(function(e){l.imageChooserInput.click()})),this.registerEventListener(this.imageFindImageButton,"click",(function(e){try{var t=i.getLocalizedString("ImportedTextureWizardStepsPanel","findImagesButton.url");window.open(t,"_blank")}catch(e){this.imageFindImageButton.style.display="none"}}));var s=function(e){if(e){var t=new FileReader;t.onload=function(t){var i=new Image;i.addEventListener("load",(function(t){l.updateController(i,e)})),i.addEventListener("error",a),i.src=t.target.result},t.onerror=a,t.readAsDataURL(e)}};this.registerEventListener(this.imageChooserInput,"input",(function(e){s(this.files[0])})),this.registerEventListener(this.previewPanel,"drop",(function(e){e.preventDefault(),s(e.dataTransfer.files[0])})),this.registerEventListener(this.previewPanel,"dragover",(function(e){e.preventDefault()})),this.registerPropertyChangeListener(n,"IMAGE",(function(e){l.updatePreviewComponentsImage()})),this.registerPropertyChangeListener(n,"WIDTH",(function(e){l.updatePreviewComponentsImage()})),this.registerPropertyChangeListener(n,"HEIGHT",(function(e){l.updatePreviewComponentsImage()}));var h=i.getTexturesCatalog().getCategories();null==this.findUserCategory(h)&&(h=h.concat([this.userCategory]));for(var u=0;u<h.length;u++){var d=document.createElement("option");d.value=h[u].getName(),d.textContent=h[u].getName(),d._category=h[u],this.categorySelect.appendChild(d)}this.attributesStepPanelDescription.innerHTML=this.getLocalizedLabelText("ImportedTextureWizardStepsPanel","attributesLabel.text").replace(/\<br\>/g," "),this.registerPropertyChangeListener(n,"NAME",(function(){l.nameInput.value.trim()!=n.getName()&&(l.nameInput.value=n.getName())})),this.registerEventListener(this.nameInput,"input",(function(e){n.setName(l.nameInput.value.trim())})),this.registerPropertyChangeListener(n,"CATEGORY",(function(e){var t=n.getCategory();null!=t&&(l.categorySelect.value=t.getName())})),this.registerEventListener(this.categorySelect,"change",(function(e){var t=l.categorySelect.item(l.categorySelect.selectedIndex)._category;n.setCategory(t)})),this.registerPropertyChangeListener(n,"CREATOR",(function(e){l.creatorInput.value.trim()!=n.getCreator()&&(l.creatorInput.value=n.getCreator())})),this.registerEventListener(l.creatorInput,"input",(function(e){n.setCreator(l.creatorInput.value.trim())})),this.registerPropertyChangeListener(n,"WIDTH",(function(e){l.widthInput.setValue(n.getWidth())})),this.registerEventListener(this.widthInput,"input",(function(e){n.setWidth(parseFloat(l.widthInput.value))})),this.registerPropertyChangeListener(n,"HEIGHT",(function(e){l.heightInput.setValue(n.getHeight())})),this.registerEventListener(this.heightInput,"input",(function(e){n.setHeight(parseFloat(l.heightInput.value))})),null!=e&&TextureManager.getInstance().loadTexture(e.getImage(),{textureUpdated:function(t){l.updateController(t,e)},textureError:function(e){a(e)}})},r.prototype.updateController=function(e,t){var i=this,n=this.controller;if(this.setImageChangeTexts(),t instanceof CatalogTexture){var o=t;setTimeout((function(){n.setImage(o.getImage()),n.setName(o.getName()),n.setCategory(o.getCategory()),n.setCreator(o.getCreator()),n.setWidth(o.getWidth()),n.setHeight(o.getHeight())}),100)}else{var r="Texture";if(t.name.lastIndexOf(".")>0){var l=t.name.split(/\/|\\|\./);l.length>1&&(r=l[l.length-2])}var a=ImageTools.isImageWithAlpha(e)?"image/png":"image/jpeg";this.checkImageSize(e,a,(function(o){var l=function(e){setTimeout((function(){n.setImage(e),n.setName(r);var t=i.preferences.getTexturesCatalog().getCategories(),l=i.findUserCategory(t)||i.userCategory;n.setCategory(l),n.setCreator(null);var a=i.preferences.getLengthUnit().isMetric()?20:LengthUnit.inchToCentimeter(8);n.setWidth(a),n.setHeight(a/o.width*o.height)}),100)};e!==o||"image/jpeg"!=t.type&&"image/png"!=t.type?BlobURLContent.fromImage(o,a,l):l(BlobURLContent.fromBlob(t))}))}},r.prototype.setImageChangeTexts=function(){this.imageChoiceOrChangeLabel.innerHTML=this.getLocalizedLabelText("ImportedTextureWizardStepsPanel","imageChangeLabel.text").replace(/\<br\>/g," "),this.imageChoiceOrChangeButton.innerHTML=this.getLocalizedLabelText("ImportedTextureWizardStepsPanel","imageChangeButton.text")},r.prototype.setImageChoiceTexts=function(){this.imageChoiceOrChangeLabel.innerHTML=this.getLocalizedLabelText("ImportedTextureWizardStepsPanel","imageChoiceLabel.text").replace(/\<br\>/g," "),this.imageChoiceOrChangeButton.innerHTML=this.getLocalizedLabelText("ImportedTextureWizardStepsPanel","imageChoiceButton.text")},r.prototype.findUserCategory=function(e){e=i.getTexturesCatalog().getCategories();for(var t=0;t<e.length;t++)if(e[t].equals(this.userCategory))return e[t];return null},r.prototype.checkImageSize=function(e,t,n){if(e.width*e.height<409600)n(e);else{var r,l=e.width/e.height;r=l<.5||l>2?Math.sqrt(262144/(e.width*e.height)):l<1?o/e.height:o/e.width;var a=Math.round(e.width*r),s=Math.round(e.height*r),h=function(){ImageTools.resize(e,a,s,n,t)};if(this.getUserPreferences().isImportedImageResizedWithoutPrompting())h();else new JSImageResizingDialog(i,"@{ImportedTextureWizardStepsPanel.reduceImageSize.title}",this.getLocalizedLabelText("ImportedTextureWizardStepsPanel","reduceImageSize.message",[e.width,e.height,a,s]),"@{ImportedTextureWizardStepsPanel.reduceImageSize.cancel}","@{ImportedTextureWizardStepsPanel.reduceImageSize.keepUnchanged}","@{ImportedTextureWizardStepsPanel.reduceImageSize.reduceSize}",h,(function(){n(e)})).displayView()}},r.prototype.updatePreviewComponentsImage=function(){this.previewPanel.innerHTML="";var e=new Image;null!==this.controller.getImage()&&this.controller.getImage().getStreamURL({urlReady:function(t){e.src=t}}),this.previewPanel.appendChild(e),this.attributesPreviewPanel.innerHTML="";var t=document.createElement("div");t.style.backgroundImage="url('"+e.src+"')",t.style.backgroundRepeat="repeat";var i=this.controller.getWidth()/250,n=this.controller.getHeight()/250;t.style.backgroundSize="calc(100% * "+i+") calc(100% * "+n+")",t.classList.add("image"),this.attributesPreviewPanel.appendChild(t)},r.prototype.updateStep=function(){switch(this.controller.getStep()){case ImportedTextureWizardController.Step.IMAGE:this.imageStepPanel.style.display="block",this.attributesStepPanel.style.display="none";break;case ImportedTextureWizardController.Step.ATTRIBUTES:this.imageStepPanel.style.display="none",this.attributesStepPanel.style.display="block"}},new r},JSViewFactory.prototype.createUserPreferencesView=function(e,t){var i=function(e){return e instanceof JSComponent&&(e=e.getHTMLElement()),"none"!==window.getComputedStyle(e).display},n=function(e){e.parentElement.style.display="none";for(var t=e;null!=t.parentElement&&!t.parentElement.classList.contains("user-preferences-dialog");)t=t.parentElement;t.style.display="none",t.previousElementSibling.style.display="none"},o=new JSDialog(e,"@{UserPreferencesPanel.preferences.title}",document.getElementById("user-preferences-dialog-template"),{applier:function(e){if(i(e.languageSelect)){var n=e.languageSelect.options[e.languageSelect.selectedIndex];t.setLanguage(null!=n?n.value:null)}i(e.furnitureCatalogViewTreeRadioButton)&&t.setFurnitureCatalogViewedInTree(e.furnitureCatalogViewTreeRadioButton.checked),i(e.navigationPanelCheckBox)&&t.setNavigationPanelVisible(e.navigationPanelCheckBox.checked),i(e.editingIn3DViewCheckBox)&&t.setEditingIn3DViewEnabled(e.editingIn3DViewCheckBox.checked),i(e.aerialViewCenteredOnSelectionCheckBox)&&t.setAerialViewCenteredOnSelectionEnabled(e.aerialViewCenteredOnSelectionCheckBox.checked),i(e.observerCameraSelectedAtChangeCheckBox)&&t.setObserverCameraSelectedAtChange(e.observerCameraSelectedAtChangeCheckBox.checked),i(e.magnetismCheckBox)&&t.setMagnetismEnabled(e.magnetismCheckBox.checked),i(e.rulersCheckBox)&&t.setRulersVisible(e.rulersCheckBox.checked),i(e.gridCheckBox)&&t.setGridVisible(e.gridCheckBox.checked),i(e.iconTopViewRadioButton)&&t.setFurnitureViewedFromTop(e.iconTopViewRadioButton.checked),i(e.iconSizeSelect)&&!e.iconSizeSelect.disabled&&t.setFurnitureModelIconSize(parseInt(e.iconSizeSelect.value)),i(e.roomRenderingFloorColorOrTextureRadioButton)&&t.setRoomFloorColoredOrTextured(e.roomRenderingFloorColorOrTextureRadioButton.checked),i(e.newWallThicknessInput)&&t.setNewWallThickness(parseFloat(e.newWallThicknessInput.getValue())),i(e.newWallHeightInput)&&t.setNewWallHeight(parseFloat(e.newWallHeightInput.getValue())),i(e.newFloorThicknessInput)&&t.setNewFloorThickness(parseFloat(e.newFloorThicknessInput.getValue())),t.modifyUserPreferences()}});if(o.languageSelect=o.getElement("language-select"),t.isPropertyEditable("LANGUAGE"))for(var r=e.getSupportedLanguages(),l=0;l<r.length;l++){var a=r[l].replace("_","-"),s=a;try{if((s=new Intl.DisplayNames([a,"en"],{type:"language"}).of(a))==a)throw"No support for Intl.DisplayNames";s=s.charAt(0).toUpperCase()+s.slice(1)}catch(e){void 0===(s={bg:"",cs:"etina",de:"Deutsch",el:"",en:"English",es:"Espaol",fr:"Franais",it:"Italiano",ja:"",hu:"Magyar",nl:"Nederlands",pl:"Polski",pt:"Portugus","pt-BR":"Portugus (Brasil)",ru:"",sv:"Svenska",vi:"Ting Vit","zh-CN":"","zh-TW":""}[a])&&(s=a,console.log("Unknown display name for "+a))}var h=r[l]==t.getLanguage(),u=JSComponent.createOptionElement(r[l],s,h);o.languageSelect.appendChild(u)}else n(o.languageSelect);o.unitSelect=o.getElement("unit-select"),t.isPropertyEditable("UNIT")?(o.unitSelect.appendChild(JSComponent.createOptionElement("MILLIMETER",e.getLocalizedString("UserPreferencesPanel","unitComboBox.millimeter.text"),t.getUnit()==LengthUnit.MILLIMETER)),o.unitSelect.appendChild(JSComponent.createOptionElement("CENTIMETER",e.getLocalizedString("UserPreferencesPanel","unitComboBox.centimeter.text"),t.getUnit()==LengthUnit.CENTIMETER)),o.unitSelect.appendChild(JSComponent.createOptionElement("METER",e.getLocalizedString("UserPreferencesPanel","unitComboBox.meter.text"),t.getUnit()==LengthUnit.METER)),o.unitSelect.appendChild(JSComponent.createOptionElement("INCH",e.getLocalizedString("UserPreferencesPanel","unitComboBox.inch.text"),t.getUnit()==LengthUnit.INCH)),o.unitSelect.appendChild(JSComponent.createOptionElement("INCH_FRACTION",e.getLocalizedString("UserPreferencesPanel","unitComboBox.inchFraction.text"),t.getUnit()==LengthUnit.INCH_FRACTION)),o.unitSelect.appendChild(JSComponent.createOptionElement("INCH_DECIMALS",e.getLocalizedString("UserPreferencesPanel","unitComboBox.inchDecimals.text"),t.getUnit()==LengthUnit.INCH_DECIMALS)),o.unitSelect.appendChild(JSComponent.createOptionElement("FOOT_DECIMALS",e.getLocalizedString("UserPreferencesPanel","unitComboBox.footDecimals.text"),t.getUnit()==LengthUnit.FOOT_DECIMALS)),o.registerEventListener(o.unitSelect,"change",(function(e){var i=o.unitSelect.options[o.unitSelect.selectedIndex];t.setUnit(null!=i?LengthUnit[i.value]:null)}))):n(o.unitSelect),o.currencySelect=o.getElement("currency-select"),o.valueAddedTaxCheckBox=o.getElement("value-added-tax-checkbox");var d=o.getLocalizedLabelText("UserPreferencesPanel","currencyComboBox.noCurrency.text");if(t.isPropertyEditable("CURRENCY")){o.currencySelect.appendChild(JSComponent.createOptionElement("",d,!t.getCurrency()));var c={EUR:"EUR ",AED:"AED AED",AFN:"AFN ",ALL:"ALL Lek",AMD:"AMD ",ANG:"ANG NAf.",AOA:"AOA Kz",ARS:"ARS $",AUD:"AUD $",AWG:"AWG Afl.",AZN:"AZN ",BAM:"BAM KM",BBD:"BBD $",BDT:"BDT ",BGN:"BGN .",BHD:"BHD ..",BIF:"BIF FBu",BMD:"BMD $",BND:"BND $",BOB:"BOB Bs",BRL:"BRL R$",BSD:"BSD $",BTN:"BTN Nu.",BWP:"BWP P",BYN:"BYN Br",BZD:"BZD $",CAD:"CAD $",CDF:"CDF FC",CHF:"CHF CHF",CLP:"CLP $",CNY:"CNY ",COP:"COP $",CRC:"CRC ",CSD:"CSD CSD",CUP:"CUP $",CVE:"CVE ",CZK:"CZK K",DJF:"DJF Fdj",DKK:"DKK kr",DOP:"DOP RD$",DZD:"DZD DA",EGP:"EGP ..",ERN:"ERN Nfk",ETB:"ETB Br",EUR:"EUR ",FJD:"FJD $",FKP:"FKP ",GBP:"GBP ",GEL:"GEL ",GHS:"GHS GH",GIP:"GIP ",GMD:"GMD D",GNF:"GNF FG",GTQ:"GTQ Q",GYD:"GYD $",HKD:"HKD HK$",HNL:"HNL L",HRK:"HRK HRK",HTG:"HTG G",HUF:"HUF Ft",IDR:"IDR Rp",ILS:"ILS ",INR:"INR ",IQD:"IQD ..",IRR:"IRR IRR",ISK:"ISK ISK",JMD:"JMD $",JOD:"JOD ..",JPY:"JPY ",KES:"KES Ksh",KGS:"KGS ",KHR:"KHR ",KMF:"KMF CF",KPW:"KPW KPW",KRW:"KRW ",KWD:"KWD ..",KYD:"KYD $",KZT:"KZT ",LAK:"LAK ",LBP:"LBP ..",LKR:"LKR Rs.",LRD:"LRD $",LSL:"LSL LSL",LYD:"LYD ..",MAD:"MAD MAD",MDL:"MDL L",MGA:"MGA Ar",MKD:"MKD den",MMK:"MMK K",MNT:"MNT ",MOP:"MOP MOP$",MRU:"MRU UM",MUR:"MUR Rs",MWK:"MWK MK",MXN:"MXN $",MYR:"MYR RM",MZN:"MZN MTn",NAD:"NAD $",NGN:"NGN ",NIO:"NIO C$",NOK:"NOK kr",NPR:"NPR ",NZD:"NZD $",OMR:"OMR ..",PAB:"PAB B/.",PEN:"PEN S/",PGK:"PGK K",PHP:"PHP ",PKR:"PKR ",PLN:"PLN z",PYG:"PYG Gs.",QAR:"QAR ..",RON:"RON RON",RSD:"RSD RSD",RUB:"RUB ",RWF:"RWF RF",SAR:"SAR ..",SBD:"SBD $",SCR:"SCR SR",SDG:"SDG SDG",SEK:"SEK kr",SGD:"SGD $",SHP:"SHP ",SLL:"SLL Le",SOS:"SOS S",SRD:"SRD $",SSP:"SSP ",STN:"STN Db",SVC:"SVC C",SYP:"SYP LS",SZL:"SZL E",THB:"THB ",TJS:"TJS .",TMT:"TMT TMT",TND:"TND DT",TOP:"TOP T$",TRY:"TRY ",TTD:"TTD $",TWD:"TWD $",TZS:"TZS TSh",UAH:"UAH ",UGX:"UGX USh",USD:"USD $",UYU:"UYU $",UZS:"UZS ",VES:"VES Bs.S",VND:"VND ",VUV:"VUV VT",WST:"WST WS$",XAF:"XAF FCFA",XCD:"XCD $",XOF:"XOF CFA",XPF:"XPF FCFP",YER:"YER ..",ZAR:"ZAR R",ZMW:"ZMW K",ZWL:"ZWL ZWL"},p=Object.keys(c);for(l=0;l<p.length;l++){var g=p[l],m=c[g];o.currencySelect.appendChild(JSComponent.createOptionElement(g,m,g==t.getCurrency()))}o.registerEventListener(o.currencySelect,"change",(function(e){var i=o.currencySelect.selectedIndex,n=o.currencySelect.options[i].value;t.setCurrency(n||null)})),o.registerPropertyChangeListener(t,"CURRENCY",(function(e){o.currencySelect.querySelector("[value='"+(t.getCurrency()?t.getCurrency():"")+"']").selected=!0,o.valueAddedTaxCheckBox.disabled=null==t.getCurrency()}));var f=t.isPropertyEditable("VALUE_ADDED_TAX_ENABLED");o.valueAddedTaxCheckBox.parentElement.style.display=f?"initial":"none",o.valueAddedTaxCheckBox.disabled=null==t.getCurrency(),o.valueAddedTaxCheckBox.checked=t.isValueAddedTaxEnabled(),o.registerEventListener(o.valueAddedTaxCheckBox,"change",(function(e){t.setValueAddedTaxEnabled(o.valueAddedTaxCheckBox.checked)})),o.registerPropertyChangeListener(t,"VALUE_ADDED_TAX_ENABLED",(function(e){o.valueAddedTaxCheckBox.disabled=null==t.getCurrency(),o.valueAddedTaxCheckBox.checked=t.isValueAddedTaxEnabled()}))}else n(o.currencySelect);if(o.furnitureCatalogViewTreeRadioButton=o.findElement("[name='furniture-catalog-view-radio'][value='tree']"),t.isPropertyEditable("FURNITURE_CATALOG_VIEWED_IN_TREE"),n(o.furnitureCatalogViewTreeRadioButton),o.navigationPanelCheckBox=o.getElement("navigation-panel-checkbox"),t.isPropertyEditable("NAVIGATION_PANEL_VISIBLE")?o.navigationPanelCheckBox.checked=t.isNavigationPanelVisible():n(o.navigationPanelCheckBox),o.editingIn3DViewCheckBox=o.getElement("editing-in-3D-view-checkbox"),t.isPropertyEditable("EDITING_IN_3D_VIEW_ENABLED")?o.editingIn3DViewCheckBox.checked=t.isEditingIn3DViewEnabled():n(o.editingIn3DViewCheckBox),o.aerialViewCenteredOnSelectionCheckBox=o.getElement("aerial-view-centered-on-selection-checkbox"),t.isPropertyEditable("AERIAL_VIEW_CENTERED_ON_SELECTION_ENABLED")?o.aerialViewCenteredOnSelectionCheckBox.checked=t.isAerialViewCenteredOnSelectionEnabled():n(o.aerialViewCenteredOnSelectionCheckBox),o.observerCameraSelectedAtChangeCheckBox=o.getElement("observer-camera-selected-at-change-checkbox"),t.isPropertyEditable("OBSERVER_CAMERA_SELECTED_AT_CHANGE")?o.observerCameraSelectedAtChangeCheckBox.checked=t.isObserverCameraSelectedAtChange():n(o.observerCameraSelectedAtChangeCheckBox),o.magnetismCheckBox=o.getElement("magnetism-checkbox"),t.isPropertyEditable("MAGNETISM_ENABLED")?o.magnetismCheckBox.checked=t.isMagnetismEnabled():n(o.magnetismCheckBox),o.rulersCheckBox=o.getElement("rulers-checkbox"),t.isPropertyEditable("RULERS_VISIBLE"),n(o.rulersCheckBox),o.gridCheckBox=o.getElement("grid-checkbox"),t.isPropertyEditable("GRID_VISIBLE")?o.gridCheckBox.checked=t.isGridVisible():n(o.gridCheckBox),o.defaultFontNameSelect=o.getElement("default-font-name-select"),t.isPropertyEditable("DEFAULT_FONT_NAME")){var v="DEFAULT_SYSTEM_FONT_NAME",_=function(){var e=null==t.getDefaultFontName()?v:t.getDefaultFontName(),i=o.defaultFontNameSelect.querySelector("[value='"+e+"']");i&&(i.selected=!0)};CoreTools.loadAvailableFontNames((function(e){e=[v].concat(e);for(var t=0;t<e.length;t++){var i=e[t],n=0==t?o.getLocalizedLabelText("FontNameComboBox","systemFontName"):i;o.defaultFontNameSelect.appendChild(JSComponent.createOptionElement(i,n))}_()})),o.registerPropertyChangeListener(t,"DEFAULT_FONT_NAME",_),o.registerEventListener(o.defaultFontNameSelect,"change",(function(e){var i=o.defaultFontNameSelect.querySelector("option:checked").value;t.setDefaultFontName(i==v?null:i)}))}else n(o.defaultFontNameSelect);if(o.iconTopViewRadioButton=o.findElement("[name='furniture-icon-radio'][value='topView']"),o.iconSizeSelect=o.getElement("icon-size-select"),t.isPropertyEditable("FURNITURE_VIEWED_FROM_TOP")){var S=t.isFurnitureViewedFromTop()?"topView":"catalog";o.findElement("[name='furniture-icon-radio'][value='"+S+"']").checked=!0;var y=[128,256,512,1024];for(l=0;l<y.length;l++){var E=y[l];o.iconSizeSelect.appendChild(JSComponent.createOptionElement(E,E+""+E,t.getFurnitureModelIconSize()==E))}var C=function(e){e.iconSizeSelect.disabled=!e.iconTopViewRadioButton.checked};C(o),o.registerEventListener(o.findElements("[name='furniture-icon-radio']"),"change",(function(e){C(o)}))}else n(o.iconTopViewRadioButton);if(o.roomRenderingFloorColorOrTextureRadioButton=o.findElement("[name='room-rendering-radio'][value='floorColorOrTexture']"),t.isPropertyEditable("ROOM_FLOOR_COLORED_OR_TEXTURED")){var P=t.isRoomFloorColoredOrTextured()?"floorColorOrTexture":"monochrome";o.findElement("[name='room-rendering-radio'][value='"+P+"']").checked=!0}else n(o.roomRenderingFloorColorOrTextureRadioButton);var w=o.getElement("new-wall-pattern-select");if(t.isPropertyEditable("NEW_WALL_PATTERN")){var L={},T=e.getPatternsCatalog().getPatterns();for(l=0;l<T.length;l++){var A=T[l].getImage().getURL();L[A]=T[l]}w.classList.add("wall-pattern-combo-box"),o.patternComboBox=new JSComboBox(e,w,{availableValues:Object.keys(L),renderCell:function(e,t){t.style.backgroundImage="url('"+e+"')"},selectionChanged:function(e){t.setNewWallPattern(L[e])}});var I=(null!=t.getNewWallPattern()?t.getNewWallPattern():t.getWallPattern()).getImage().getURL();o.patternComboBox.setSelectedItem(I),o.registerPropertyChangeListener(t,"NEW_WALL_PATTERN",(function(){var e=t.getNewWallPattern().getImage().getURL();o.patternComboBox.setSelectedItem(e)}))}else n(o.newWallPatternSelect);o.newWallThicknessInput=new JSSpinner(e,o.getElement("new-wall-thickness-input"),{value:1,minimum:0,maximum:1e5}),t.isPropertyEditable("NEW_WALL_THICKNESS")?o.newWallThicknessInput.setValue(t.getNewWallThickness()):n(o.newWallThicknessInput),o.newWallHeightInput=new JSSpinner(e,o.getElement("new-wall-height-input"),{value:1,minimum:0,maximum:1e5}),t.isPropertyEditable("NEW_WALL_HEIGHT")?o.newWallHeightInput.setValue(t.getNewWallHeight()):n(o.newWallHeightInput),o.newFloorThicknessInput=new JSSpinner(e,o.getElement("new-floor-thickness-input"),{value:1,minimum:0,maximum:1e5}),t.isPropertyEditable("NEW_FLOOR_THICKNESS")?o.newFloorThicknessInput.setValue(t.getNewFloorThickness()):n(o.newFloorThicknessInput);var b=function(e,i,n){t.getUnit().isMetric()?e.setStepSize(i):e.setStepSize(n),e.setMinimum(t.getUnit().getMinimumLength()),e.getMinimum()>e.getValue()&&e.setValue(e.getMinimum()),e.setFormat(t.getUnit().getFormat())},O=function(){b(o.newWallThicknessInput,LengthUnit.CENTIMETER.getStepSize(),LengthUnit.INCH.getStepSize()),b(o.newWallHeightInput,20*LengthUnit.CENTIMETER.getStepSize(),16*LengthUnit.INCH.getStepSize()),b(o.newFloorThicknessInput,LengthUnit.CENTIMETER.getStepSize(),LengthUnit.INCH.getStepSize())};return O(),o.registerPropertyChangeListener(t,"UNIT",(function(e){O()})),o},JSViewFactory.prototype.createLevelView=function(e,t){var i=new JSDialog(e,"@{LevelPanel.level.title}",document.getElementById("level-dialog-template"),{size:"medium",applier:function(){t.modifyLevels()}}),n=e.getLengthUnit().getName(),o=i.getElement("viewable-checkbox"),r=t.isPropertyEditable("VIEWABLE")?"initial":"none";o.parentElement.style.display=r,o.checked=t.getViewable(),i.registerEventListener(o,"change",(function(e){t.setViewable(o.checked)})),i.registerPropertyChangeListener(t,"VIEWABLE",(function(e){o.checked=t.getViewable()}));var l=i.getElement("name-input"),a=t.isPropertyEditable("NAME")?"initial":"none";l.parentElement.style.display=a,l.parentElement.previousElementSibling.style.display=a,l.value=null!=t.getName()?t.getName():"",i.registerEventListener(l,"input",(function(e){var i=l.value;0==i.trim().length?t.setName(null):t.setName(i)})),i.registerPropertyChangeListener(t,"NAME",(function(e){l.value=null!=t.getName()?t.getName():""}));var s=e.getLengthUnit().getMinimumLength(),h=e.getLengthUnit().getMaximumLength(),u=function(){var e=t.getSelectedLevelIndex();if(null!=e){var n=t.getLevels();i.floorThicknessInput.setEnabled(n[e].getElevation()!=n[0].getElevation())}},d=function(){var e=t.getSelectedLevelIndex();if(null!=e){var n=t.getLevels();i.increaseElevationButton.disabled=!(e<n.length-1&&n[e].getElevation()==n[e+1].getElevation()),i.decreaseElevationButton.disabled=!(e>0&&n[e].getElevation()==n[e-1].getElevation())}else i.increaseElevationButton.setEnabled(!1),i.decreaseElevationButton.setEnabled(!1)},c=t.isPropertyEditable("ELEVATION")?"initial":"none";i.getElement("elevation-label").textContent=i.getLocalizedLabelText("LevelPanel","elevationLabel.text",n);var p=new JSSpinner(e,i.getElement("elevation-input"),{nullable:null==t.getElevation(),format:e.getLengthUnit().getFormat(),value:t.getElevation(),minimum:-1e3,maximum:e.getLengthUnit().getMaximumElevation(),stepSize:e.getLengthUnit().getStepSize()});p.parentElement.style.display=c,p.parentElement.previousElementSibling.style.display=c,i.registerEventListener(p,"input",(function(e){t.setElevation(p.getValue()),u(),d()})),i.registerPropertyChangeListener(t,"ELEVATION",(function(e){p.setValue(e.getNewValue())}));var g=t.isPropertyEditable("FLOOR_THICKNESS")?"initial":"none";i.getElement("floor-thickness-label").textContent=i.getLocalizedLabelText("LevelPanel","floorThicknessLabel.text",n);var m=new JSSpinner(e,i.getElement("floor-thickness-input"),{nullable:null==t.getFloorThickness(),format:e.getLengthUnit().getFormat(),value:t.getFloorThickness(),minimum:s,maximum:h/10,stepSize:e.getLengthUnit().getStepSize()});m.parentElement.style.display=g,m.parentElement.previousElementSibling.style.display=g,i.registerEventListener(m,"input",(function(e){t.setFloorThickness(m.getValue())})),i.registerPropertyChangeListener(t,"FLOOR_THICKNESS",(function(e){m.setValue(e.getNewValue())})),i.floorThicknessInput=m,u();var f=t.isPropertyEditable("HEIGHT")?"initial":"none";i.getElement("height-label").textContent=i.getLocalizedLabelText("LevelPanel","heightLabel.text",n);var v=new JSSpinner(e,i.getElement("height-input"),{nullable:null==t.getHeight(),format:e.getLengthUnit().getFormat(),value:t.getHeight(),minimum:s,maximum:h,stepSize:e.getLengthUnit().getStepSize()});v.parentElement.style.display=f,v.parentElement.previousElementSibling.style.display=f,i.registerEventListener(v,"input",(function(e){t.setHeight(v.getValue())})),i.registerPropertyChangeListener(t,"HEIGHT",(function(e){v.setValue(e.getNewValue())}));var _=t.isPropertyEditable("ELEVATION_INDEX")?"initial":"none",S=new ResourceAction(e,"LevelPanel","INCREASE_ELEVATION_INDEX",!0),y=new ResourceAction(e,"LevelPanel","DECREASE_ELEVATION_INDEX",!0);i.increaseElevationButton=i.getElement("increase-elevation-index-button"),i.increaseElevationButton.style.backgroundImage="url('"+S.getURL(AbstractAction.SMALL_ICON)+"')",i.increaseElevationButton.style.display=_,i.registerEventListener(i.increaseElevationButton,"click",(function(e){t.setElevationIndex(t.getElevationIndex()+1),d()})),i.decreaseElevationButton=i.getElement("decrease-elevation-index-button"),i.decreaseElevationButton.style.backgroundImage="url('"+y.getURL(AbstractAction.SMALL_ICON)+"')",i.decreaseElevationButton.style.display=_,i.registerEventListener(i.decreaseElevationButton,"click",(function(e){t.setElevationIndex(t.getElevationIndex()-1),d()})),d();var E=i.getElement("levels-table").querySelector("tbody"),C=function(){var e=t.getSelectedLevelIndex(),i=E.querySelector(".selected");if(null!=i&&i.classList.remove("selected"),null!=e){var n=E.childElementCount-e-1;E.children[n].classList.add("selected")}},P=function(){for(var i=t.getLevels(),n="",o=e.getLengthUnit().getFormat(),r=i.length-1;r>=0;r--){var l=i[r];n+="<tr "+(l.isViewable()?"":"disabled")+">  <td>"+l.getName()+"</td>  <td>"+o.format(l.getElevation())+"</td>  <td>"+(l.getElevation()==i[0].getElevation()?"":o.format(l.getFloorThickness()))+"</td>  <td>"+o.format(l.getHeight())+"</td></tr>"}E.innerHTML=n,C()};return P(),i.registerPropertyChangeListener(t,"SELECT_LEVEL_INDEX",C),i.registerPropertyChangeListener(t,"LEVELS",P),i},JSViewFactory.prototype.createHomeFurnitureView=function(e,t){function i(){this.controller=t,JSDialog.call(this,e,"@{HomeFurniturePanel.homeFurniture.title}",document.getElementById("home-furniture-dialog-template"),{applier:function(){t.modifyFurniture()},disposer:function(e){e.paintPanel.colorButton.dispose(),e.paintPanel.textureComponent.dispose()}}),this.initNameAndPricePanel(),this.initLocationPanel(),this.initPaintPanel(),this.initOrientationPanel(),this.initSizePanel(),this.initShininessPanel();var i=this;if(this.controller.isPropertyEditable("VISIBLE")){var n=this.getElement("visible-checkbox");n.checked=this.controller.getVisible(),this.registerPropertyChangeListener(this.controller,"VISIBLE",(function(e){n.checked=e.getNewValue()})),this.registerEventListener(n,"change",(function(e){i.controller.setVisible(n.checked)}))}this.controller.isPropertyEditable("PAINT")&&this.updatePaintRadioButtons()}return i.prototype=Object.create(JSDialog.prototype),i.prototype.constructor=i,i.prototype.initNameAndPricePanel=function(){this.getElement("name-and-price-title").textContent=this.getLocalizedLabelText("HomeFurniturePanel",t.isPropertyEditable("PRICE")?"nameAndPricePanel.title":"namePanel.title");var e=this.getElement("name-label"),i=this.getElement("name-input"),n=this.getElement("name-visible-checkbox"),o=this.getElement("description-label"),r=this.getElement("description-input"),l=this.getElement("price-label"),a=new JSSpinner(this.preferences,this.getElement("price-input"),{nullable:null==this.controller.getPrice(),value:0,minimum:0,maximum:1e9}),s=new JSSpinner(this.preferences,this.getElement("value-added-tax-percentage-input"),{nullable:null==this.controller.getValueAddedTaxPercentage(),value:0,minimum:0,maximum:100,stepSize:.5}),h=this.controller.isPropertyEditable("NAME")?"initial":"none",u=this.controller.isPropertyEditable("NAME_VISIBLE")?"initial":"none",d=this.controller.isPropertyEditable("DESCRIPTION")?"initial":"none",c=this.controller.isPropertyEditable("PRICE")?"inline-block":"none",p=this.controller.isPropertyEditable("VALUE_ADDED_TAX_PERCENTAGE")?"inline-block":"none";e.style.display=h,i.style.display=h,n.parentElement.style.display=u,o.style.display=d,r.style.display=d,o.parentElement.style.display=d,r.parentElement.style.display=d,l.style.display=c,a.style.display=c,l.parentElement.style.display=c,a.parentElement.style.display=c,s.getHTMLElement().previousElementSibling.style.display=p,s.style.display=p,i.value=null!=t.getName()?t.getName():"",n.checked=this.controller.getNameVisible(),r.value=null!=t.getDescription()?t.getDescription():"",a.setValue(this.controller.getPrice()),this.controller.getValueAddedTaxPercentage()&&s.setValue(100*this.controller.getValueAddedTaxPercentage()),this.registerPropertyChangeListener(this.controller,"NAME",(function(e){i.value=null!=t.getName()?t.getName():""})),this.registerPropertyChangeListener(this.controller,"NAME_VISIBLE",(function(e){n.checked=t.getNameVisible()})),this.registerPropertyChangeListener(this.controller,"DESCRIPTION",(function(e){r.value=null!=t.getDescription()?t.getDescription():""})),this.registerPropertyChangeListener(this.controller,"PRICE",(function(e){a.setValue(t.getPrice())})),this.registerPropertyChangeListener(this.controller,"VALUE_ADDED_TAX_PERCENTAGE",(function(e){t.getValueAddedTaxPercentage()?s.setValue(100*t.getValueAddedTaxPercentage()):s.setValue(null)})),this.registerEventListener(i,"input",(function(e){var n=i.value;0==n.trim().length?t.setName(null):t.setName(n)})),this.registerEventListener(n,"change",(function(e){t.setNameVisible(n.checked)})),this.registerEventListener(r,"input",(function(e){var i=r.value;0==i.trim().length?t.setDescription(null):t.setDescription(i)}));var g=this.getElement("ha-entity-label"),m=this.getElement("ha-entity-input");if(g&&m){var f=!1,v=this.controller.home.getSelectedItems();if(v&&v.length>0){var _=v[0],S=_.getCatalogId?_.getCatalogId():"",y=_.getCreator?_.getCreator():"",E="";try{_.properties&&_.properties.catalogId&&(E=_.properties.catalogId)}catch(e){}f=S&&0===S.indexOf("ha_")||E&&0===E.indexOf("ha_")||"HA"===y}var C=f?"initial":"none";if(g.style.display=C,m.parentElement.style.display=C,f){var P="";if(v&&v.length>0){var w=v[0].getProperty("ha_entity_id");w&&(P=w)}m.value=P,this.registerEventListener(m,"input",(function(e){var t=m.value.trim();v&&v.length>0&&(t.length>0?v[0].setProperty$java_lang_String$java_lang_Object("ha_entity_id",t):v[0].setProperty$java_lang_String$java_lang_Object("ha_entity_id",null))}))}}this.registerEventListener(a,"input",(function(e){t.setPrice(null!=a.getValue()?new Big(a.getValue()):null)})),this.registerEventListener(s,"input",(function(e){var i=s.getValue();t.setValueAddedTaxPercentage(null!=i?new Big(i/100):null)}))},i.prototype.initLocationPanel=function(){var e=this.getElement("x-label"),t=new JSSpinner(this.preferences,this.getElement("x-input"),{nullable:null==this.controller.getX(),format:this.preferences.getLengthUnit().getFormat(),stepSize:this.preferences.getLengthUnit().getStepSize()}),i=this.getElement("y-label"),n=new JSSpinner(this.preferences,this.getElement("y-input"),{nullable:null==this.controller.getY(),format:this.preferences.getLengthUnit().getFormat(),stepSize:this.preferences.getLengthUnit().getStepSize()}),o=this.getElement("elevation-label"),r=new JSSpinner(this.preferences,this.getElement("elevation-input"),{nullable:null==this.controller.getElevation(),format:this.preferences.getLengthUnit().getFormat(),stepSize:this.preferences.getLengthUnit().getStepSize()}),l=this.getElement("mirrored-model-checkbox"),a=this.getElement("base-plan-item-checkbox"),s=this.controller.isPropertyEditable("X")?"initial":"none",h=this.controller.isPropertyEditable("Y")?"initial":"none",u=this.controller.isPropertyEditable("ELEVATION")?"initial":"none",d=this.controller.isPropertyEditable("MODEL_MIRRORED")?"initial":"none",c=this.controller.isPropertyEditable("BASE_PLAN_ITEM")?"initial":"none";e.style.display=s,t.getHTMLElement().parentElement.style.display=s,i.style.display=h,n.getHTMLElement().parentElement.style.display=h,o.style.display=u,r.getHTMLElement().parentElement.style.display=u,l.parentElement.style.display=d,a.parentElement.style.display=c,t.setValue(this.controller.getX()),n.setValue(this.controller.getY()),r.setValue(this.controller.getElevation()),l.checked=this.controller.getModelMirrored(),a.checked=this.controller.getBasePlanItem();var p=this.preferences.getLengthUnit().getName();e.textContent=this.getLocalizedLabelText("HomeFurniturePanel","xLabel.text",p),i.textContent=this.getLocalizedLabelText("HomeFurniturePanel","yLabel.text",p),o.textContent=this.getLocalizedLabelText("HomeFurniturePanel","elevationLabel.text",p);var g=this.preferences.getLengthUnit().getMaximumLength(),m=this.preferences.getLengthUnit().getMaximumElevation();t.setMinimum(-g),n.setMinimum(-g),t.setMaximum(g),n.setMaximum(g),r.setMinimum(0),r.setMaximum(m);var f=this.controller;this.registerPropertyChangeListener(this.controller,"X",(function(e){t.setValue(f.getX())})),this.registerPropertyChangeListener(this.controller,"Y",(function(e){n.setValue(f.getY())})),this.registerPropertyChangeListener(this.controller,"ELEVATION",(function(e){r.setValue(f.getElevation())})),this.registerPropertyChangeListener(this.controller,"MODEL_MIRRORED",(function(e){l.checked=f.getModelMirrored()})),this.registerPropertyChangeListener(this.controller,"BASE_PLAN_ITEM",(function(e){a.checked=f.getBasePlanItem()})),this.registerEventListener(t,"input",(function(e){f.setX(t.getValue())})),this.registerEventListener(n,"input",(function(e){f.setY(n.getValue())})),this.registerEventListener(r,"input",(function(e){f.setElevation(r.getValue())})),this.registerEventListener(l,"change",(function(e){f.setModelMirrored(l.checked)})),this.registerEventListener(a,"change",(function(e){f.setBasePlanItem(a.checked)})),this.locationPanel={element:this.findElement(".location-panel"),elevationInput:r}},i.prototype.initOrientationPanel=function(){var e=this.controller,t=this.getElement("angle-label"),i=new DecimalFormat("0.#"),n=new JSSpinner(this.preferences,this.getElement("angle-input"),{nullable:null==this.controller.getAngle(),format:i,minimum:0,maximum:360}),o=this.findElement("[name='horizontal-rotation-radio'][value='ROLL']"),r=this.findElement("[name='horizontal-rotation-radio'][value='PITCH']"),l=new JSSpinner(this.preferences,this.getElement("roll-input"),{nullable:null==this.controller.getRoll(),format:i,minimum:0,maximum:360}),a=new JSSpinner(this.preferences,this.getElement("pitch-input"),{nullable:null==this.controller.getPitch(),format:i,minimum:0,maximum:360}),s=this.getElement("vertical-rotation-label"),h=this.getElement("horizontal-rotation-label"),u=this.getElement("furniture-orientation-image");u.innerHTML="<img src='"+ZIPTools.getScriptFolder()+"resources/furnitureOrientation.png' />";var d=this.controller.isPropertyEditable("ANGLE_IN_DEGREES")||this.controller.isPropertyEditable("ANGLE")?"initial":"none",c=this.controller.isPropertyEditable("ROLL")?"initial":"none",p=this.controller.isPropertyEditable("PITCH")?"initial":"none",g=this.controller.isPropertyEditable("ROLL")&&this.controller.isPropertyEditable("PITCH"),m=g?"initial":"none",f=m,v=this.controller.isTexturable()&&g?"initial":"none";t.style.display=d,n.getHTMLElement().parentElement.style.display=d,o.parentElement.style.display=c,l.getHTMLElement().parentElement.style.display=c,r.parentElement.style.display=p,a.getHTMLElement().parentElement.style.display=p,h.style.display=f,s.style.display=m,u.style.display=v,null!=this.controller.getAngle()?n.setValue(Math.toDegrees(this.controller.getAngle())):n.setValue(null),null!=this.controller.getRoll()?l.setValue(Math.toDegrees(this.controller.getRoll())):l.setValue(null),null!=this.controller.getPitch()?a.setValue(Math.toDegrees(this.controller.getPitch())):a.setValue(null);var _=function(){o.checked=e.getHorizontalAxis()==HomeFurnitureController.FurnitureHorizontalAxis.ROLL,r.checked=e.getHorizontalAxis()==HomeFurnitureController.FurnitureHorizontalAxis.PITCH};_(),this.registerPropertyChangeListener(this.controller,"ANGLE",(function(t){null!=e.getAngle()?n.setValue(Math.toDegrees(e.getAngle())):n.setValue(null)})),this.registerPropertyChangeListener(this.controller,"ROLL",(function(t){null!=e.getRoll()?l.setValue(Math.toDegrees(e.getRoll())):l.setValue(null)})),this.registerPropertyChangeListener(this.controller,"PITCH",(function(t){null!=e.getPitch()?a.setValue(Math.toDegrees(e.getPitch())):a.setValue(null)})),this.registerPropertyChangeListener(this.controller,"HORIZONTAL_AXIS",(function(e){_()})),this.registerEventListener(n,"input",(function(t){null==n.getValue()?e.setAngle(null):e.setAngle(Math.toRadians(n.getValue()))})),this.registerEventListener(l,"input",(function(t){null==l.getValue()?e.setRoll(null):(e.setRoll(Math.toRadians(l.getValue())),e.setHorizontalAxis(HomeFurnitureController.FurnitureHorizontalAxis.ROLL))})),this.registerEventListener(a,"input",(function(t){null==a.getValue()?e.setPitch(null):(e.setPitch(Math.toRadians(a.getValue())),e.setHorizontalAxis(HomeFurnitureController.FurnitureHorizontalAxis.PITCH))})),this.registerEventListener([o,r],"change",(function(t){o.checked?e.setHorizontalAxis(HomeFurnitureController.FurnitureHorizontalAxis.ROLL):e.setHorizontalAxis(HomeFurnitureController.FurnitureHorizontalAxis.PITCH)})),g||(this.findElement(".orientation-column").style.display="none",this.locationPanel.elevationInput.parentElement.insertAdjacentElement("afterend",t),t.insertAdjacentElement("afterend",n.parentElement))},i.prototype.initPaintPanel=function(){var e=this,t=this.controller,i=this.preferences,n=new ColorButton(i,{colorChanged:function(e){l[HomeFurnitureController.FurniturePaint.COLORED].checked=!0,t.setPaint(HomeFurnitureController.FurniturePaint.COLORED),t.setColor(e)}});this.attachChildComponent("color-button",n),n.setColor(t.getColor()),n.setColorDialogTitle(i.getLocalizedString("HomeFurniturePanel","colorDialog.title"));var o=t.getTextureController().getView();this.attachChildComponent("texture-component",o);var r=t.getPaint(),l=[];l[HomeFurnitureController.FurniturePaint.DEFAULT]=e.findElement("[name='paint-checkbox'][value='default']"),l[HomeFurnitureController.FurniturePaint.COLORED]=e.findElement("[name='paint-checkbox'][value='color']"),l[HomeFurnitureController.FurniturePaint.TEXTURED]=e.findElement("[name='paint-checkbox'][value='texture']"),l[HomeFurnitureController.FurniturePaint.MODEL_MATERIALS]=e.findElement("[name='paint-checkbox'][value='MODEL_MATERIALS']");for(var a=0;a<l.length;a++){l[a].checked=a==r||a==HomeFurnitureController.FurniturePaint.DEFAULT&&!l[r]}var s=t.getModelMaterialsController().getView();this.attachChildComponent("material-component",s);var h=null!=t.getModelMaterialsController().getModel();l[HomeFurnitureController.FurniturePaint.MODEL_MATERIALS].disabled=!h,s.setEnabled(h),this.paintPanel={colorAndTextureRadioButtons:l,colorButton:n,textureComponent:o};var u=t.isPropertyEditable("PAINT")&&t.isTexturable()?void 0:"none";this.getElement("paint-panel").style.display=u,this.getElement("paint-panel").previousElementSibling.style.display=u,this.registerPropertyChangeListener(t,"PAINT",(function(t){e.updatePaintRadioButtons()})),this.registerEventListener(l,"change",(function(e){var i=l.indexOf(e.target);t.setPaint(i)}))},i.prototype.updatePaintRadioButtons=function(){var e=this.controller,t=this.paintPanel.colorAndTextureRadioButtons;if(null==e.getPaint())for(var i=0;i<t.length;i++)t[i].checked=!1;else{var n=t[e.getPaint()];n&&(n.checked=!0),this.updateShininessRadioButtons(e)}},i.prototype.initSizePanel=function(){var e=this,t=this.controller,i=this.getElement("width-label"),n=new JSSpinner(this.preferences,this.getElement("width-input"),{nullable:null==t.getWidth(),format:this.preferences.getLengthUnit().getFormat(),stepSize:this.preferences.getLengthUnit().getStepSize()}),o=this.getElement("depth-label"),r=new JSSpinner(this.preferences,this.getElement("depth-input"),{nullable:null==t.getDepth(),format:this.preferences.getLengthUnit().getFormat(),stepSize:this.preferences.getLengthUnit().getStepSize()}),l=this.getElement("height-label"),a=this.getElement("height-input"),s=(a=new JSSpinner(this.preferences,this.getElement("height-input"),{nullable:null==t.getHeight(),format:this.preferences.getLengthUnit().getFormat(),stepSize:this.preferences.getLengthUnit().getStepSize()}),this.getElement("keep-proportions-checkbox")),h=this.getElement("model-transformations-button"),u=this.controller.isPropertyEditable("WIDTH")?"initial":"none",d=this.controller.isPropertyEditable("DEPTH")?"initial":"none",c=this.controller.isPropertyEditable("HEIGHT")?"initial":"none",p=this.controller.isPropertyEditable("PROPORTIONAL")?"initial":"none";if(i.style.display=u,n.parentElement.style.display=u,o.style.display=d,r.parentElement.style.display=d,l.style.display=c,a.parentElement.style.display=c,s.parentElement.style.display=p,h.parentElement.style.display="none",this.controller.isPropertyEditable("MODEL_TRANSFORMATIONS")&&null!=h){var g=t.getModelMaterialsController();null!==g&&null!==g.getModel()&&ModelManager.getInstance().loadModel(g.getModel(),{modelUpdated:function(t){var i=ModelManager.getInstance();i.containsDeformableNode(t)&&(h.innerHTML=e.getLocalizedLabelText("HomeFurniturePanel",i.containsNode(t,ModelManager.MANNEQUIN_ABDOMEN_PREFIX)?"mannequinTransformationsButton.text":"modelTransformationsButton.text"),h.parentElement.style.display="block",e.registerEventListener(h,"click",(function(t){e.displayModelTransformationsView(e.getUserPreferences(),e.controller)})))},modelError:function(e){}})}n.setValue(this.controller.getWidth()),r.setValue(this.controller.getDepth()),a.setValue(this.controller.getHeight()),s.checked=this.controller.isProportional();var m=this.preferences.getLengthUnit().getName();i.textContent=this.getLocalizedLabelText("HomeFurniturePanel","widthLabel.text",m),o.textContent=this.getLocalizedLabelText("HomeFurniturePanel","depthLabel.text",m),l.textContent=this.getLocalizedLabelText("HomeFurniturePanel","heightLabel.text",m);var f=this.preferences.getLengthUnit().getMinimumLength(),v=this.preferences.getLengthUnit().getMaximumLength();n.setMinimum(f),n.setMaximum(v),r.setMinimum(f),r.setMaximum(v),a.setMinimum(f),a.setMaximum(v);t=this.controller;this.registerPropertyChangeListener(this.controller,"WIDTH",(function(e){n.setValue(t.getWidth())})),this.registerPropertyChangeListener(this.controller,"DEPTH",(function(e){r.setValue(t.getDepth())})),this.registerPropertyChangeListener(this.controller,"HEIGHT",(function(e){a.setValue(t.getHeight())})),this.registerPropertyChangeListener(this.controller,"PROPORTIONAL",(function(e){s.checked=t.isProportional()})),this.registerEventListener(n,"input",(function(e){t.setWidth(n.getValue())})),this.registerEventListener(r,"input",(function(e){t.setDepth(r.getValue())})),this.registerEventListener(a,"input",(function(e){t.setHeight(a.getValue())})),this.registerEventListener(s,"change",(function(e){t.setProportional(s.checked)})),this.sizePanel={widthLabel:i,widthInput:n,depthLabel:o,depthInput:r,heightLabel:l,heightInput:a,keepProportionsCheckBox:s},this.updateSizeComponents(),this.registerPropertyChangeListener(this.controller,"RESIZABLE",(function(t){e.updateSizeComponents()})),this.registerPropertyChangeListener(this.controller,"DEFORMABLE",(function(t){e.updateSizeComponents()}))},i.prototype.updateSizeComponents=function(){var e=this.controller.isResizable();this.sizePanel.widthLabel.disabled=!e,this.sizePanel.widthInput.disabled=!e,this.sizePanel.depthLabel.disabled=!e,this.sizePanel.depthInput.disabled=!e,this.sizePanel.heightLabel.disabled=!e,this.sizePanel.heightInput.disabled=!e,this.sizePanel.keepProportionsCheckBox.disabled=!e||!this.controller.isDeformable()},i.prototype.initShininessPanel=function(){var e=this.controller,t=this,i=this.findElement("[name='shininess-radio'][value='DEFAULT']"),n=this.findElement("[name='shininess-radio'][value='MATT']"),o=this.findElement("[name='shininess-radio'][value='SHINY']");this.shininessPanel={defaultShininessRadioButton:i,mattRadioButton:n,shinyRadioButton:o};var r=e.isPropertyEditable("SHININESS")&&e.isTexturable()?void 0:"none";this.getElement("shininess-panel").style.display=r,this.getElement("shininess-panel").previousElementSibling.style.display=r,e.isPropertyEditable("SHININESS")&&(this.registerEventListener([i,n,o],"change",(function(i){var n=t.findElement("[name='shininess-radio']:checked");e.setShininess(HomeFurnitureController.FurnitureShininess[n.value])})),this.registerPropertyChangeListener(e,"SHININESS",(function(i){t.updateShininessRadioButtons(e)})),this.updateShininessRadioButtons(e))},i.prototype.updateShininessRadioButtons=function(){var e=this.controller;if(e.isPropertyEditable("SHININESS")){e.getShininess()==HomeFurnitureController.FurnitureShininess.DEFAULT?this.shininessPanel.defaultShininessRadioButton.checked=!0:e.getShininess()==HomeFurnitureController.FurnitureShininess.MATT?this.shininessPanel.mattRadioButton.checked=!0:e.getShininess()==HomeFurnitureController.FurnitureShininess.SHINY?this.shininessPanel.shinyRadioButton.checked=!0:(this.shininessPanel.defaultShininessRadioButton.checked=!1,this.shininessPanel.mattRadioButton.checked=!1,this.shininessPanel.shinyRadioButton.checked=!1);var t=e.getPaint()!=HomeFurnitureController.FurniturePaint.MODEL_MATERIALS;this.shininessPanel.defaultShininessRadioButton.disabled=!t,this.shininessPanel.mattRadioButton.disabled=!t,this.shininessPanel.shinyRadioButton.disabled=!t,t||(this.shininessPanel.defaultShininessRadioButton.checked=!1,this.shininessPanel.mattRadioButton.checked=!1,this.shininessPanel.shinyRadioButton.checked=!1)}},i.prototype.displayModelTransformationsView=function(e,t){var i=new JSDialog(e,e.getLocalizedString("ModelTransformationsPanel","modelTransformations.title"),"<div data-name='label-panel'>  <span>@{ModelTransformationsPanel.transformationsLabel.text}</span><br/></div><div data-name='preview-panel'>  <canvas id='model-preview-canvas'></canvas></div><div data-name='edit-panel'>  <div>    <button name='reset-transformations-button'>@{ModelTransformationsPanel.resetTransformationsButton.text}</button>    <div name='presetTransformationsLabel'>@{ModelTransformationsPanel.presetTransformationsLabel.text}</div>     <div>      <select name='presetTransformations'></select>    </div>    <button name='view-from-front-button'>@{ModelTransformationsPanel.viewFromFrontButton.text}</button>    <button name='view-from-side-button'>@{ModelTransformationsPanel.viewFromSideButton.text}</button>    <button name='view-from-top-button'>@{ModelTransformationsPanel.viewFromTopButton.text}</button>  </div></div>",{size:"medium",applier:function(){var e=t.getModelMirrored()?-i.previewComponent.getModelX():i.previewComponent.getModelX(),n=i.previewComponent.getModelY(),o=t.getX()+e*Math.cos(t.getAngle())-n*Math.sin(t.getAngle()),r=t.getY()+e*Math.sin(t.getAngle())+n*Math.cos(t.getAngle()),l=t.getElevation()+i.previewComponent.getModelElevation()+t.getHeight()/2,a=i.previewComponent.getModelTransformations();t.setModelTransformations(null!==a?a:[],o,r,l,i.previewComponent.getModelWidth(),i.previewComponent.getModelDepth(),i.previewComponent.getModelHeight())},disposer:function(){}});i.getHTMLElement().classList.add("model-transformations-chooser-dialog");var n=i.findElement("#model-preview-canvas");n.width=350,n.height=350;var o=t.getModelMaterialsController();i.previewComponent=new ModelPreviewComponent(n,!0,!0),i.previewComponent.setModel(o.getModel(),o.getModelFlags(),o.getModelRotation(),o.getModelWidth(),o.getModelDepth(),o.getModelHeight()),i.previewComponent.setModelMaterials(o.getMaterials()),i.previewComponent.setModelTransformations(t.getModelTransformations());var r=i.getElement("reset-transformations-button");i.registerEventListener(r,"click",(function(e){i.previewComponent.resetModelTransformations()}));var l=i.getElement("presetTransformations"),a=t.getModelPresetTransformationsNames();if(a.length>0){(h=document.createElement("option")).value=-1,h.textContent=e.getLocalizedString("ModelTransformationsPanel","presetTransformationsComboBox.chooseTransformations.text"),l.appendChild(h);for(var s=0;s<a.length;s++){var h;(h=document.createElement("option")).value=s,h.textContent=a[s],l.appendChild(h)}i.registerEventListener(l,"change",(function(e){l.value>=0&&i.previewComponent.setPresetModelTransformations(t.getModelPresetTransformations(l.value))}))}else i.getElement("presetTransformationsLabel").style.display="none",l.style.display="none";var u=i.getElement("view-from-front-button");i.registerEventListener(u,"click",(function(e){i.previewComponent.setViewYaw(0),i.previewComponent.setViewPitch(0)}));var d=i.getElement("view-from-side-button");i.registerEventListener(d,"click",(function(e){i.previewComponent.setViewYaw(Math.PI/2),i.previewComponent.setViewPitch(0)}));var c=i.getElement("view-from-top-button");i.registerEventListener(c,"click",(function(e){i.previewComponent.setViewYaw(0),i.previewComponent.setViewPitch(-Math.PI/2)})),i.displayView()},new i},JSViewFactory.prototype.createWallView=function(e,t){var i,n,o,r,l,a,s,h,u,d,c,p,g,m=function(t,i){var n=i.getView(),o=new JSDialog(e,t,"<div data-name='content'></div>",{size:"small",applier:function(){},disposer:function(){n.dispose()}});o.attachChildComponent("content",n);var r=i.getVisible(),l=i.getColor(),a=i.getTextureController().getTexture(),s=i.getPaint(),h=i.getThickness(),u=i.getHeight();o.cancel=function(){i.setVisible(r),i.setColor(l),i.getTextureController().setTexture(a),i.setPaint(s),i.setThickness(h),i.setHeight(u),o.close()},o.displayView()},f=new JSDialog(e,"@{WallPanel.wall.title}",document.getElementById("wall-dialog-template"),{applier:function(e){t.modifyWalls()},disposer:function(e){e.leftSideColorButton.dispose(),e.rightSideColorButton.dispose(),e.leftSideTextureComponent.dispose(),e.rightSideTextureComponent.dispose(),e.topColorButton.dispose()},size:"medium"});i=f,n=e.getLengthUnit().getMaximumLength(),o=i.getElement("x-start-label"),r=i.getElement("y-start-label"),l=new JSSpinner(e,i.getElement("x-start-input"),{nullable:null==t.getXStart(),format:e.getLengthUnit().getFormat(),value:t.getXStart(),minimum:-n,maximum:n,stepSize:e.getLengthUnit().getStepSize()}),a=new JSSpinner(e,i.getElement("y-start-input"),{nullable:null==t.getYStart(),format:e.getLengthUnit().getFormat(),value:t.getYStart(),minimum:-n,maximum:n,stepSize:e.getLengthUnit().getStepSize()}),s=i.getElement("x-end-label"),h=i.getElement("y-end-label"),u=i.getElement("distance-to-end-point-label"),d=new JSSpinner(e,i.getElement("x-end-input"),{nullable:null==t.getXEnd(),format:e.getLengthUnit().getFormat(),value:t.getXEnd(),minimum:-n,maximum:n,stepSize:e.getLengthUnit().getStepSize()}),c=new JSSpinner(e,i.getElement("y-end-input"),{nullable:null==t.getYEnd(),format:e.getLengthUnit().getFormat(),value:t.getYEnd(),minimum:-n,maximum:n,stepSize:e.getLengthUnit().getStepSize()}),p=new JSSpinner(e,i.getElement("distance-to-end-point-input"),{nullable:null==t.getDistanceToEndPoint(),format:e.getLengthUnit().getFormat(),value:t.getDistanceToEndPoint(),minimum:e.getLengthUnit().getMinimumLength(),maximum:2*n*Math.sqrt(2),stepSize:e.getLengthUnit().getStepSize()}),g=e.getLengthUnit().getName(),o.textContent=i.getLocalizedLabelText("WallPanel","xLabel.text",g),s.textContent=i.getLocalizedLabelText("WallPanel","xLabel.text",g),r.textContent=i.getLocalizedLabelText("WallPanel","yLabel.text",g),h.textContent=i.getLocalizedLabelText("WallPanel","yLabel.text",g),u.textContent=i.getLocalizedLabelText("WallPanel","distanceToEndPointLabel.text",g),i.registerPropertyChangeListener(t,"X_START",(function(e){l.setValue(e.getNewValue())})),i.registerPropertyChangeListener(t,"Y_START",(function(e){a.setValue(e.getNewValue())})),i.registerPropertyChangeListener(t,"X_END",(function(e){d.setValue(e.getNewValue())})),i.registerPropertyChangeListener(t,"Y_END",(function(e){c.setValue(e.getNewValue())})),i.registerPropertyChangeListener(t,"DISTANCE_TO_END_POINT",(function(e){p.setValue(e.getNewValue())})),i.registerEventListener(l,"input",(function(e){t.setXStart(l.getValue())})),i.registerEventListener(a,"input",(function(e){t.setYStart(a.getValue())})),i.registerEventListener(d,"input",(function(e){t.setXEnd(d.getValue())})),i.registerEventListener(c,"input",(function(e){t.setYEnd(c.getValue())})),i.registerEventListener(p,"input",(function(e){t.setDistanceToEndPoint(p.getValue())})),function(i){var n=i.findElement("[name='left-side-color-and-texture-choice'][value='COLORED']"),o=i.findElement("[name='left-side-color-and-texture-choice'][value='TEXTURED']"),r=i.findElement("[name='right-side-color-and-texture-choice'][value='COLORED']"),l=i.findElement("[name='right-side-color-and-texture-choice'][value='TEXTURED']"),a=function(){n.checked=t.getLeftSidePaint()==WallController.WallPaint.COLORED,o.checked=t.getLeftSidePaint()==WallController.WallPaint.TEXTURED},s=function(){r.checked=t.getRightSidePaint()==WallController.WallPaint.COLORED,l.checked=t.getRightSidePaint()==WallController.WallPaint.TEXTURED};a(),s(),i.registerPropertyChangeListener(t,"LEFT_SIDE_PAINT",(function(){a()})),i.registerPropertyChangeListener(t,"RIGHT_SIDE_PAINT",(function(){s()})),i.leftSideColorButton=new ColorButton(e,{colorChanged:function(e){i.findElement("[name='left-side-color-and-texture-choice'][value='COLORED']").checked=!0,t.setLeftSidePaint(WallController.WallPaint.COLORED),t.setLeftSideColor(e)}}),i.rightSideColorButton=new ColorButton(e,{colorChanged:function(e){i.findElement("[name='right-side-color-and-texture-choice'][value='COLORED']").checked=!0,t.setRightSidePaint(WallController.WallPaint.COLORED),t.setRightSideColor(e)}}),i.attachChildComponent("left-side-color-button",i.leftSideColorButton),i.attachChildComponent("right-side-color-button",i.rightSideColorButton),i.leftSideColorButton.setColor(t.getLeftSideColor()),i.leftSideColorButton.setColorDialogTitle(e.getLocalizedString("WallPanel","leftSideColorDialog.title")),i.rightSideColorButton.setColor(t.getRightSideColor()),i.rightSideColorButton.setColorDialogTitle(e.getLocalizedString("WallPanel","rightSideColorDialog.title")),i.registerPropertyChangeListener(t,"LEFT_SIDE_COLOR",(function(){i.leftSideColorButton.setColor(t.getLeftSideColor())})),i.registerPropertyChangeListener(t,"RIGHT_SIDE_COLOR",(function(){i.rightSideColorButton.setColor(t.getRightSideColor())})),i.leftSideTextureComponent=t.getLeftSideTextureController().getView(),i.attachChildComponent("left-side-texture-component",i.leftSideTextureComponent),i.rightSideTextureComponent=t.getRightSideTextureController().getView(),i.attachChildComponent("right-side-texture-component",i.rightSideTextureComponent);var h=i.findElement("[name='left-side-shininess-choice'][value='0']"),u=i.findElement("[name='left-side-shininess-choice'][value='0.25']"),d=i.findElement("[name='right-side-shininess-choice'][value='0']"),c=i.findElement("[name='right-side-shininess-choice'][value='0.25']"),p=function(){h.checked=0==t.getLeftSideShininess(),u.checked=.25==t.getLeftSideShininess()},g=function(){d.checked=0==t.getRightSideShininess(),c.checked=.25==t.getRightSideShininess()};p(),g(),i.registerPropertyChangeListener(t,"LEFT_SIDE_SHININESS",(function(e){p()})),i.registerPropertyChangeListener(t,"RIGHT_SIDE_SHININESS",(function(e){g()})),i.registerEventListener([h,u],"change",(function(e){t.setLeftSideShininess(parseFloat(this.value))})),i.registerEventListener([d,c],"change",(function(e){t.setRightSideShininess(parseFloat(this.value))}));var f=i.getElement("left-side-modify-baseboard-button"),v=i.getElement("right-side-modify-baseboard-button"),_=new ResourceAction(e,"WallPanel","MODIFY_LEFT_SIDE_BASEBOARD",!0),S=new ResourceAction(e,"WallPanel","MODIFY_RIGHT_SIDE_BASEBOARD",!0);f.textContent=_.getValue(AbstractAction.NAME),v.textContent=S.getValue(AbstractAction.NAME),i.registerEventListener(f,"click",(function(e){m(i.getLocalizedLabelText("WallPanel","leftSideBaseboardDialog.title"),t.getLeftSideBaseboardController())})),i.registerEventListener(v,"click",(function(e){m(i.getLocalizedLabelText("WallPanel","rightSideBaseboardDialog.title"),t.getRightSideBaseboardController())}))}(f),function(i){for(var n={},o=e.getPatternsCatalog().getPatterns(),r=0;r<o.length;r++){var l=o[r].getImage().getURL();n[l]=o[r]}var a=i.getElement("pattern-select");a.classList.add("wall-pattern-combo-box");var s=new JSComboBox(this.preferences,a,{nullable:null!=t.getPattern(),availableValues:Object.keys(n),renderCell:function(e,t){t.style.backgroundImage="url('"+e+"')"},selectionChanged:function(e){t.setPattern(n[e])}}),h=function(){var e=t.getPattern();s.setSelectedItem(null!=t.getPattern()?e.getImage().getURL():null)};h(),i.registerPropertyChangeListener(t,"PATTERN",(function(e){h()}));var u=i.findElement("[name='top-color-choice'][value='DEFAULT']"),d=i.findElement("[name='top-color-choice'][value='COLORED']"),c=[u,d],p=function(){u.checked=t.getTopPaint()==WallController.WallPaint.DEFAULT,d.checked=t.getTopPaint()==WallController.WallPaint.COLORED};i.registerEventListener(c,"click",(function(e){t.setTopPaint(WallController.WallPaint[this.value])})),p(),i.registerPropertyChangeListener(t,"TOP_PAINT",(function(e){p()})),i.topColorButton=new ColorButton(e,{colorChanged:function(e){d.checked=!0,t.setTopPaint(WallController.WallPaint.COLORED),t.setTopColor(e)}}),i.attachChildComponent("top-color-button",i.topColorButton),i.topColorButton.setColor(t.getTopColor()),i.topColorButton.setColorDialogTitle(e.getLocalizedString("WallPanel","topColorDialog.title")),i.registerPropertyChangeListener(t,"TOP_COLOR",(function(){i.topColorButton.setColor(t.getTopColor())}))}(f),function(i){var n=e.getLengthUnit().getName();i.getElement("rectangular-wall-height-label").textContent=i.getLocalizedLabelText("WallPanel","rectangularWallHeightLabel.text",n);var o=i.findElement("[name='wall-shape-choice'][value='RECTANGULAR_WALL']"),r=i.findElement("[name='wall-shape-choice'][value='SLOPING_WALL']");i.registerEventListener([o,r],"change",(function(e){t.setShape(WallController.WallShape[this.value])}));var l=function(){o.checked=t.getShape()==WallController.WallShape.RECTANGULAR_WALL,r.checked=t.getShape()==WallController.WallShape.SLOPING_WALL};l(),i.registerPropertyChangeListener(t,"SHAPE",(function(e){l()}));var a=e.getLengthUnit().getMinimumLength(),s=e.getLengthUnit().getMaximumLength(),h=new JSSpinner(e,i.getElement("rectangular-wall-height-input"),{nullable:null==t.getRectangularWallHeight(),format:e.getLengthUnit().getFormat(),value:t.getRectangularWallHeight(),minimum:a,maximum:s,stepSize:e.getLengthUnit().getStepSize()});i.registerPropertyChangeListener(t,"RECTANGULAR_WALL_HEIGHT",(function(e){h.setValue(e.getNewValue())})),i.registerEventListener(h,"input",(function(e){t.setRectangularWallHeight(h.getValue())}));var u=null!=t.getSlopingWallHeightAtStart()&&null!=t.getSlopingWallHeightAtEnd()?0:a,d=new JSSpinner(e,i.getElement("sloping-wall-height-at-start-input"),{nullable:null==t.getSlopingWallHeightAtStart(),format:e.getLengthUnit().getFormat(),value:t.getSlopingWallHeightAtStart(),minimum:u,maximum:s,stepSize:e.getLengthUnit().getStepSize()});i.registerPropertyChangeListener(t,"SLOPING_WALL_HEIGHT_AT_START",(function(e){d.setValue(e.getNewValue())})),i.registerEventListener(d,"input",(function(e){t.setSlopingWallHeightAtStart(d.getValue()),0==u&&0==t.getSlopingWallHeightAtStart()&&0==t.getSlopingWallHeightAtEnd()&&t.setSlopingWallHeightAtEnd(a)}));var c=new JSSpinner(e,i.getElement("sloping-wall-height-at-end-input"),{nullable:null==t.getSlopingWallHeightAtEnd(),format:e.getLengthUnit().getFormat(),value:t.getSlopingWallHeightAtEnd(),minimum:u,maximum:s,stepSize:e.getLengthUnit().getStepSize()});i.registerPropertyChangeListener(t,"SLOPING_WALL_HEIGHT_AT_END",(function(e){c.setValue(e.getNewValue())})),i.registerEventListener(c,"input",(function(e){t.setSlopingWallHeightAtEnd(c.getValue()),0==u&&0==t.getSlopingWallHeightAtStart()&&0==t.getSlopingWallHeightAtEnd()&&t.setSlopingWallHeightAtStart(a)})),i.getElement("thickness-label").textContent=i.getLocalizedLabelText("WallPanel","thicknessLabel.text",n);var p=new JSSpinner(e,i.getElement("thickness-input"),{nullable:null==t.getThickness(),format:e.getLengthUnit().getFormat(),value:t.getThickness(),minimum:a,maximum:s/10,stepSize:e.getLengthUnit().getStepSize()});i.registerPropertyChangeListener(t,"THICKNESS",(function(e){p.setValue(e.getNewValue())})),i.registerEventListener(p,"input",(function(e){t.setThickness(p.getValue())})),i.getElement("arc-extent-label").textContent=i.getLocalizedLabelText("WallPanel","arcExtentLabel.text",n);var g=new DecimalFormat("0.#"),m=new JSSpinner(this.preferences,i.getElement("arc-extent-input"),{nullable:null==t.getArcExtentInDegrees(),format:g,value:0,minimum:-270,maximum:270,stepSize:5}),f=function(){m.setValue(t.getArcExtentInDegrees())};f(),i.registerPropertyChangeListener(t,"ARC_EXTENT_IN_DEGREES",(function(e){f()})),i.registerEventListener(m,"input",(function(e){t.setArcExtentInDegrees(m.getValue())}))}(f),f.getElement("wall-orientation-label").innerHTML=f.getLocalizedLabelText("WallPanel","wallOrientationLabel.text",ZIPTools.getScriptFolder()+"resources/wallOrientation.png");var v=function(e,t,i){null!=e&&(i&&(e=e.parentElement),e.style.display=t?"":"none",e.previousElementSibling.style.display=t?"":"none",i&&(e.nextElementSibling.style.display=t?"":"none"))},_=function(){v(f.getElement("x-start-input"),t.isEditablePoints(),!0),v(f.getElement("x-end-input"),t.isEditablePoints(),!0),v(f.getElement("distance-to-end-point-input"),t.isEditablePoints()),v(f.getElement("arc-extent-input"),t.isEditablePoints())};return f.registerPropertyChangeListener(t,"EDITABLE_POINTS",_),_(t.isEditablePoints()),f},JSViewFactory.prototype.createRoomView=function(e,t){var i=function(e){if(e.firstWallChange&&null!=e.splitSurroundingWallsCheckBox&&!e.splitSurroundingWallsCheckBox.disabled){e.splitSurroundingWallsCheckBox.checked=!0;var t=document.createEvent("Event");t.initEvent("change",!0,!0),e.splitSurroundingWallsCheckBox.dispatchEvent(t),e.firstWallChange=!1}},n=new JSDialog(e,"@{RoomPanel.room.title}",document.getElementById("room-dialog-template"),{applier:function(e){t.modifyRooms()},disposer:function(e){e.floorColorButton.dispose(),e.floorTextureComponent.dispose(),e.ceilingColorButton.dispose(),e.ceilingTextureComponent.dispose(),t.getWallSidesBaseboardController().getView().dispose()}}),o=t.isPropertyEditable("NAME")?"initial":"none";n.nameInput=n.getElement("name-input"),n.nameInput.value=null!=t.getName()?t.getName():"",n.nameInput.parentElement.style.display=o,n.registerEventListener(n.nameInput,"input",(function(e){t.setName(n.nameInput.value.trim())})),n.registerPropertyChangeListener(t,"NAME",(function(e){n.nameInput.value=null!=t.getName()?t.getName():""}));var r=t.isPropertyEditable("AREA_VISIBLE")?"initial":"none";return n.areaVisibleCheckBox=n.getElement("area-visible-checkbox"),n.areaVisibleCheckBox.checked=t.getAreaVisible(),n.areaVisibleCheckBox.parentElement.style.display=r,n.registerEventListener(n.areaVisibleCheckBox,"change",(function(e){t.setAreaVisible(n.areaVisibleCheckBox.checked)})),n.registerPropertyChangeListener(t,"AREA_VISIBLE",(function(e){n.areaVisibleCheckBox.checked=t.getAreaVisible()})),function(i){var n=t.isPropertyEditable("FLOOR_VISIBLE")?"initial":"none";i.floorVisibleCheckBox=i.getElement("floor-visible-checkbox"),i.floorVisibleCheckBox.checked=t.getFloorVisible(),i.floorVisibleCheckBox.parentElement.style.display=n,i.registerEventListener(i.floorVisibleCheckBox,"change",(function(e){t.setFloorVisible(i.floorVisibleCheckBox.checked)})),i.registerPropertyChangeListener(t,"FLOOR_VISIBLE",(function(e){i.floorVisibleCheckBox.checked=t.getFloorVisible(e)}));var o=i.findElement("[name='floor-color-and-texture-choice'][value='COLORED']");i.floorColorButton=new ColorButton(e,{colorChanged:function(e){o.checked=!0,t.setFloorPaint(RoomController.RoomPaint.COLORED),t.setFloorColor(e)}}),i.attachChildComponent("floor-color-button",i.floorColorButton),i.floorColorButton.setColor(t.getFloorColor()),i.floorColorButton.setColorDialogTitle(e.getLocalizedString("RoomPanel","floorColorDialog.title"));var r=i.findElement("[name='floor-color-and-texture-choice'][value='TEXTURED']");i.floorTextureComponent=t.getFloorTextureController().getView(),i.attachChildComponent("floor-texture-component",i.floorTextureComponent),i.registerEventListener([o,r],"change",(function(e){t.setFloorPaint(RoomController.RoomPaint[this.value])}));var l=function(){o.checked=t.getFloorPaint()==RoomController.RoomPaint.COLORED,r.checked=t.getFloorPaint()==RoomController.RoomPaint.TEXTURED};i.registerPropertyChangeListener(t,"FLOOR_PAINT",l);var a=t.isPropertyEditable("FLOOR_PAINT")?"initial":"none";o.parentElement.parentElement.style.display=a,r.parentElement.parentElement.style.display=a,i.getElement("floor-color-button").style.display=a,i.getElement("floor-texture-component").style.display=a,l();var s=i.findElements("[name='floor-shininess-choice']");i.registerEventListener(s,"change",(function(){t.setFloorShininess(parseFloat(this.value))}));var h=function(){for(var e=0;e<s.length;e++)s[e].checked=t.getFloorShininess()==parseFloat(s[e].value)};h(),i.registerPropertyChangeListener(t,"FLOOR_SHININESS",h);var u=t.isPropertyEditable("FLOOR_SHININESS")?"initial":"none";s[0].parentElement.parentElement=u}(n),function(i){var n=t.isPropertyEditable("CEILING_VISIBLE")?"initial":"none";i.ceilingVisibleCheckBox=i.getElement("ceiling-visible-checkbox"),i.ceilingVisibleCheckBox.checked=t.getCeilingVisible(),i.ceilingVisibleCheckBox.parentElement.style.display=n,i.registerEventListener(i.ceilingVisibleCheckBox,"change",(function(e){t.setCeilingVisible(i.ceilingVisibleCheckBox.checked)})),i.registerPropertyChangeListener(t,"CEILING_VISIBLE",(function(e){i.ceilingVisibleCheckBox.checked=t.getCeilingVisible()}));var o=i.findElement("[name='ceiling-color-and-texture-choice'][value='COLORED']");i.ceilingColorButton=new ColorButton(e,{colorChanged:function(e){o.checked=!0,t.setCeilingPaint(RoomController.RoomPaint.COLORED),t.setCeilingColor(e)}}),i.attachChildComponent("ceiling-color-button",i.ceilingColorButton),i.ceilingColorButton.setColor(t.getCeilingColor()),i.ceilingColorButton.setColorDialogTitle(e.getLocalizedString("RoomPanel","ceilingColorDialog.title"));var r=i.findElement("[name='ceiling-color-and-texture-choice'][value='TEXTURED']");i.ceilingTextureComponent=t.getCeilingTextureController().getView(),i.attachChildComponent("ceiling-texture-component",i.ceilingTextureComponent),i.registerEventListener([o,r],"change",(function(e){t.setCeilingPaint(RoomController.RoomPaint[this.value])}));var l=function(){o.checked=t.getCeilingPaint()==RoomController.RoomPaint.COLORED,r.checked=t.getCeilingPaint()==RoomController.RoomPaint.TEXTURED};l(),i.registerPropertyChangeListener(t,"CEILING_PAINT",l);var a=t.isPropertyEditable("CEILING_PAINT")?"initial":"none";o.parentElement.parentElement.style.display=a,r.parentElement.parentElement.style.display=a,i.getElement("ceiling-color-button").style.display=a,i.getElement("ceiling-texture-component").style.display=a;var s=i.findElements("[name='ceiling-shininess-choice']");i.registerEventListener(s,"change",(function(){t.setCeilingShininess(parseFloat(this.value))}));var h=function(){for(var e=0;e<s.length;e++)s[e].checked=t.getCeilingShininess()==parseFloat(s[e].value)};h(),i.registerPropertyChangeListener(t,"CEILING_SHININESS",h);var u=t.isPropertyEditable("CEILING_SHININESS")?"initial":"none";s[0].parentElement.parentElement=u,i.ceilingFlatCheckBox=i.getElement("ceiling-flat-checkbox"),i.ceilingFlatCheckBox.checked=t.getCeilingFlat(),i.ceilingFlatCheckBox.parentElement.style.display=t.isPropertyEditable("CEILING_FLAT")?"initial":"none",i.registerEventListener(i.ceilingFlatCheckBox,"change",(function(e){t.setCeilingFlat(i.ceilingFlatCheckBox.checked)})),i.registerPropertyChangeListener(t,"CEILING_FLAT",(function(e){i.ceilingFlatCheckBox.checked=t.getCeilingFlat(e)}))}(n),function(n){var o=function(){n.splitSurroundingWallsCheckBox.disabled=!t.isSplitSurroundingWallsNeeded(),n.splitSurroundingWallsCheckBox.checked=t.isSplitSurroundingWalls()},r=t.isPropertyEditable("SPLIT_SURROUNDING_WALLS")?"initial":"none";n.splitSurroundingWallsCheckBox=n.getElement("split-surrounding-walls-checkbox"),n.splitSurroundingWallsCheckBox.parentElement.style.display=r,n.registerEventListener(n.splitSurroundingWallsCheckBox,"change",(function(e){t.setSplitSurroundingWalls(n.splitSurroundingWallsCheckBox.checked),n.firstWallChange=!1})),o(),n.registerPropertyChangeListener(t,"SPLIT_SURROUNDING_WALLS",(function(e){o()}));var l=n.findElement("[name='wall-sides-color-and-texture-choice'][value='COLORED']");n.wallSidesColorButton=new ColorButton(e,{colorChanged:function(e){l.checked=!0,t.setWallSidesPaint(RoomController.RoomPaint.COLORED),t.setWallSidesColor(e),i(n)}}),n.attachChildComponent("wall-sides-color-button",n.wallSidesColorButton),n.wallSidesColorButton.setColor(t.getWallSidesColor()),n.wallSidesColorButton.setColorDialogTitle(e.getLocalizedString("RoomPanel","wallSidesColorDialog.title"));var a=n.findElement("[name='wall-sides-color-and-texture-choice'][value='TEXTURED']");n.wallSidesTextureComponent=t.getWallSidesTextureController().getView(),n.registerPropertyChangeListener(t.getWallSidesTextureController(),"TEXTURE",(function(e){i(n)})),n.attachChildComponent("wall-sides-texture-component",n.wallSidesTextureComponent),n.registerEventListener([l,a],"change",(function(e){t.setWallSidesPaint(RoomController.RoomPaint[this.value])}));var s=function(){l.checked=t.getWallSidesPaint()==RoomController.RoomPaint.COLORED,a.checked=t.getWallSidesPaint()==RoomController.RoomPaint.TEXTURED};s(),n.registerPropertyChangeListener(t,"WALL_SIDES_PAINT",s);var h=t.isPropertyEditable("WALL_SIDES_PAINT")?"initial":"none";l.parentElement.parentElement.style.display=h,a.parentElement.parentElement.style.display=h,n.getElement("wall-sides-color-button").style.display=h,n.getElement("wall-sides-texture-component").style.display=h;var u=n.findElements("[name='wall-sides-shininess-choice']");n.registerEventListener(u,"change",(function(e){t.setWallSidesShininess(parseFloat(this.value))}));var d=function(){for(var e=0;e<u.length;e++)u[e].checked=t.getWallSidesShininess()==parseFloat(u[e].value)};d(),n.registerPropertyChangeListener(t,"WALL_SIDES_SHININESS",d);var c=t.isPropertyEditable("WALL_SIDES_SHININESS")?"initial":"none";u[0].parentElement.parentElement.style.display=c,"none"==h&&"none"==c&&(n.getElement("wall-sides-panel").parentElement.style.display="none")}(n),function(e){if(t.isPropertyEditable("WALL_SIDES_BASEBOARD")){var n=t.getWallSidesBaseboardController().getView();e.attachChildComponent("wall-sides-baseboard-panel",n),e.registerPropertyChangeListener(t.getWallSidesBaseboardController(),"VISIBLE",(function(){i(e)}))}else e.getElement("wall-sides-baseboard-panel").parentElement.style.display="none"}(n),n.firstWallChange=!0,n},JSViewFactory.prototype.createPolylineView=function(e,t){var i=new JSDialog(e,"@{PolylinePanel.polyline.title}",document.getElementById("polyline-dialog-template"),{size:"small",applier:function(e){t.modifyPolylines()},disposer:function(e){e.colorButton.dispose()}});return i.colorButton=new ColorButton(e,{colorChanged:function(e){t.setColor(e)}}),i.attachChildComponent("color-button",i.colorButton),i.colorButton.setColor(t.getColor()),i.colorButton.setColorDialogTitle(e.getLocalizedString("PolylinePanel","colorDialog.title")),i.thicknessLabelElement=i.getElement("thickness-label"),i.thicknessLabelElement.textContent=i.getLocalizedLabelText("PolylinePanel","thicknessLabel.text",i.preferences.getLengthUnit().getName()),i.thicknessInput=new JSSpinner(e,i.getElement("thickness-input"),{nullable:null==t.getThickness(),format:e.getLengthUnit().getFormat(),value:t.getThickness(),minimum:e.getLengthUnit().getMinimumLength(),maximum:50,stepSize:e.getLengthUnit().getStepSize()}),i.registerPropertyChangeListener(t,"THICKNESS",(function(e){i.thicknessInput.setValue(t.getThickness())})),i.registerEventListener(i.thicknessInput,"input",(function(e){t.setThickness(i.thicknessInput.getValue())})),function(e){for(var i=[],n=Object.keys(Polyline.ArrowStyle),o=0;o<n.length;o++){var r=parseInt(n[o]);isNaN(r)||i.push(r)}var l=[];for(o=0;o<i.length;o++)for(var a=0;a<i.length;a++)l.push({startStyle:i[o],endStyle:i[a]});var s=new java.awt.geom.GeneralPath;s.moveTo(15,4),s.lineTo(5,8),s.lineTo(15,12);var h=new java.awt.geom.GeneralPath;h.moveTo(3,8),h.lineTo(15,3),h.lineTo(15,13),h.closePath();var u=64,d=new java.awt.geom.GeneralPath;d.moveTo(50,4),d.lineTo(60,8),d.lineTo(50,12);var c=new java.awt.geom.GeneralPath;c.moveTo(62,8),c.lineTo(50,3),c.lineTo(50,13),c.closePath();var p=new JSComboBox(this.preferences,e.getElement("arrows-style-select"),{nullable:null==t.getCapStyle(),availableValues:l,renderCell:function(e,t){t.style.border="none",t.style.maxWidth="6em",t.style.margin="auto",t.style.textAlign="center";var i=document.createElement("canvas");if(i.width=200,i.height=50,i.style.maxWidth="100%",i.style.height="1em",null!=e){var n=new Graphics2D(i);switch(n.scale(i.width/u,i.width/u),n.setStroke(new java.awt.BasicStroke(2)),n.draw(new java.awt.geom.Line2D.Float(6,8,58,8)),e.startStyle){case Polyline.ArrowStyle.DISC:n.fill(new java.awt.geom.Ellipse2D.Float(4,4,9,9));break;case Polyline.ArrowStyle.OPEN:n.draw(s);break;case Polyline.ArrowStyle.DELTA:n.fill(h)}switch(e.endStyle){case Polyline.ArrowStyle.DISC:n.fill(new java.awt.geom.Ellipse2D.Float(52,4,9,9));break;case Polyline.ArrowStyle.OPEN:n.draw(d);break;case Polyline.ArrowStyle.DELTA:n.fill(c)}t.appendChild(i)}},selectionChanged:function(e){t.setStartArrowStyle(e.startStyle),t.setEndArrowStyle(e.endStyle)}}),g=function(){var e=t.getStartArrowStyle(),i=t.getEndArrowStyle();p.setEnabled(t.isArrowsStyleEditable()),p.setSelectedItem({startStyle:e,endStyle:i})};g(),e.registerPropertyChangeListener(t,"START_ARROW_STYLE",g),e.registerPropertyChangeListener(t,"END_ARROW_STYLE",g)}(i),function(e){for(var i=[],n=Object.keys(Polyline.JoinStyle),o=0;o<n.length;o++){var r=parseInt(n[o]);isNaN(r)||i.push(r)}var l=new java.awt.geom.GeneralPath;l.moveTo(10,10),l.lineTo(80,10),l.lineTo(50,35);var a=new java.awt.geom.Arc2D.Float(10,20,80,20,0,180,java.awt.geom.Arc2D.OPEN),s=new JSComboBox(this.preferences,e.getElement("join-style-select"),{nullable:null==t.getJoinStyle(),availableValues:i,renderCell:function(e,t){t.style.border="none",t.style.textAlign="center";var i=document.createElement("canvas");if(i.width=100,i.height=40,i.style.maxWidth="100%",i.style.height="1em",null!=e){var n=new Graphics2D(i);n.setStroke(ShapeTools.getStroke(8,Polyline.CapStyle.BUTT,e,null,0)),e==Polyline.JoinStyle.CURVED?n.draw(a):n.draw(l)}t.appendChild(i)},selectionChanged:function(e){t.setJoinStyle(e)}}),h=function(){s.setEnabled(t.isJoinStyleEditable()),s.setSelectedItem(t.getJoinStyle())};h(),e.registerPropertyChangeListener(t,"JOIN_STYLE",h)}(i),function(i){for(var n=[],o=Object.keys(Polyline.DashStyle),r=0;r<o.length;r++){var l=parseInt(o[r]);isNaN(l)||l==Polyline.DashStyle.CUSTOMIZED&&t.getDashStyle()!=Polyline.DashStyle.CUSTOMIZED||n.push(l)}var a=new JSComboBox(this.preferences,i.getElement("dash-style-select"),{nullable:null==t.getDashStyle(),availableValues:n,renderCell:function(e,i){i.style.border="none",i.style.textAlign="center",i.style.maxHeight="2em",i.style.minWidth="4em";var n=document.createElement("canvas");n.width=500,n.height=100,n.style.maxWidth="100%",n.style.height="1em";var o=null!=e&&e!=Polyline.DashStyle.CUSTOMIZED?Polyline.DashStyle._$wrappers[e].getDashPattern():t.getDashPattern();if(null!=o){var r=new Graphics2D(n),l=null!=t.getDashOffset()?t.getDashOffset():0;r.setStroke(ShapeTools.getStroke(12,Polyline.CapStyle.BUTT,Polyline.JoinStyle.MITER,o,l)),r.draw(new java.awt.geom.Line2D.Float(20,n.height/2,n.width-60,n.height/2))}i.appendChild(n)},selectionChanged:function(e){t.setDashStyle(e)}}),s=new JSSpinner(e,i.getElement("dash-offset-input"),{nullable:null==t.getDashOffset(),value:null==t.getDashOffset()?null:100*t.getDashOffset(),minimum:0,maximum:100,stepSize:5});i.registerEventListener(s,"input",(function(e){t.setDashOffset(null!=s.getValue()?s.getValue()/100:null)})),i.registerPropertyChangeListener(t,"DASH_OFFSET",(function(){s.setValue(null==t.getDashOffset()?null:100*t.getDashOffset()),a.updateUI()}));var h=function(){s.setEnabled(t.getDashStyle()!=Polyline.DashStyle.SOLID),a.setSelectedItem(t.getDashStyle())};h(),i.registerPropertyChangeListener(t,"DASH_STYLE",h)}(i),i.visibleIn3DCheckBox=i.getElement("visible-in-3D-checkbox"),i.visibleIn3DCheckBox.checked=t.isElevationEnabled()&&null!=t.getElevation(),i.registerEventListener(i.visibleIn3DCheckBox,"change",(function(e){i.visibleIn3DCheckBox.checked?t.setElevation(0):t.setElevation(null)})),i},JSViewFactory.prototype.createDimensionLineView=function(e,t,i){var n=new JSDialog(t,e?"@{DimensionLinePanel.dimensionLineModification.title}":"@{DimensionLinePanel.dimensionLineCreation.title}",document.getElementById("dimension-line-dialog-template"),{applier:function(t){e?i.modifyDimensionLines():i.createDimensionLine()},disposer:function(e){e.colorButton.dispose()},size:"small"}),o=t.getLengthUnit().getMaximumLength(),r=t.getLengthUnit().getName();n.xStartLabel=n.getElement("x-start-label"),n.xStartLabel.textContent=n.getLocalizedLabelText("DimensionLinePanel","xLabel.text",r),n.xStartInput=new JSSpinner(t,n.getElement("x-start-input"),{nullable:null==i.getXStart(),format:t.getLengthUnit().getFormat(),value:i.getXStart(),minimum:-o,maximum:o,stepSize:t.getLengthUnit().getStepSize()}),n.registerPropertyChangeListener(i,"X_START",(function(e){n.xStartInput.setValue(e.getNewValue())})),n.registerEventListener(n.xStartInput,"input",(function(e){i.setXStart(n.xStartInput.getValue())})),n.yStartLabel=n.getElement("y-start-label"),n.yStartLabel.textContent=n.getLocalizedLabelText("DimensionLinePanel","yLabel.text",r),n.yStartInput=new JSSpinner(t,n.getElement("y-start-input"),{nullable:null==i.getYStart(),format:t.getLengthUnit().getFormat(),value:i.getYStart(),minimum:-o,maximum:o,stepSize:t.getLengthUnit().getStepSize()}),n.registerPropertyChangeListener(i,"Y_START",(function(e){n.yStartInput.setValue(e.getNewValue())})),n.registerEventListener(n.yStartInput,"input",(function(e){i.setYStart(n.yStartInput.getValue())})),n.elevationStartLabel=n.getElement("elevation-start-label"),n.elevationStartLabel.textContent=n.getLocalizedLabelText("DimensionLinePanel","elevationLabel.text",r),n.elevationStartInput=new JSSpinner(t,n.getElement("elevation-start-input"),{nullable:null==i.getElevationStart(),format:t.getLengthUnit().getFormat(),value:i.getElevationStart(),minimum:0,maximum:o,stepSize:t.getLengthUnit().getStepSize()}),n.registerPropertyChangeListener(i,"ELEVATION_START",(function(e){n.elevationStartInput.setValue(e.getNewValue())})),n.registerEventListener(n.elevationStartInput,"input",(function(e){i.setElevationStart(n.elevationStartInput.getValue())})),n.xEndLabel=n.getElement("x-end-label"),n.xEndLabel.textContent=n.getLocalizedLabelText("DimensionLinePanel","xLabel.text",r),n.xEndInput=new JSSpinner(t,n.getElement("x-end-input"),{nullable:null==i.getXEnd(),format:t.getLengthUnit().getFormat(),value:i.getXEnd(),minimum:-o,maximum:o,stepSize:t.getLengthUnit().getStepSize()}),n.registerPropertyChangeListener(i,"X_END",(function(e){n.xEndInput.setValue(e.getNewValue())})),n.registerEventListener(n.xEndInput,"input",(function(e){i.setXEnd(n.xEndInput.getValue())})),n.yEndLabel=n.getElement("y-end-label"),n.yEndLabel.textContent=n.getLocalizedLabelText("DimensionLinePanel","yLabel.text",r),n.yEndInput=new JSSpinner(t,n.getElement("y-end-input"),{nullable:null==i.getYEnd(),format:t.getLengthUnit().getFormat(),value:i.getYEnd(),minimum:-o,maximum:o,stepSize:t.getLengthUnit().getStepSize()}),n.registerPropertyChangeListener(i,"Y_END",(function(e){n.yEndInput.setValue(e.getNewValue())})),n.registerEventListener(n.yEndInput,"input",(function(e){i.setYEnd(n.yEndInput.getValue())})),n.distanceToEndPointLabel=n.getElement("distance-to-end-point-label"),n.distanceToEndPointLabel.textContent=n.getLocalizedLabelText("DimensionLinePanel","distanceToEndPointLabel.text",r),n.distanceToEndPointInput=new JSSpinner(t,n.getElement("distance-to-end-point-input"),{nullable:null==i.getDistanceToEndPoint(),format:t.getLengthUnit().getFormat(),value:i.getDistanceToEndPoint(),minimum:t.getLengthUnit().getMinimumLength(),maximum:2*o*Math.sqrt(2),stepSize:t.getLengthUnit().getStepSize()}),n.registerPropertyChangeListener(i,"DISTANCE_TO_END_POINT",(function(e){n.distanceToEndPointInput.setValue(e.getNewValue())})),n.registerEventListener(n.distanceToEndPointInput,"input",(function(e){i.setDistanceToEndPoint(n.distanceToEndPointInput.getValue())})),n.offsetLabel=n.getElement("offset-label"),n.offsetLabel.textContent=n.getLocalizedLabelText("DimensionLinePanel","offsetLabel.text",r),n.offsetInput=new JSSpinner(t,n.getElement("offset-input"),{nullable:null==i.getOffset(),format:t.getLengthUnit().getFormat(),value:i.getOffset(),minimum:-1e4,maximum:1e4,stepSize:t.getLengthUnit().getStepSize()}),n.registerPropertyChangeListener(i,"OFFSET",(function(e){n.offsetInput.setValue(e.getNewValue())})),n.registerEventListener(n.offsetInput,"input",(function(e){i.setOffset(n.offsetInput.getValue())})),n.planDimensionLineRadioButton=n.findElement("[name='orientation-choice'][value='PLAN']"),n.registerEventListener(n.planDimensionLineRadioButton,"change",(function(e){n.planDimensionLineRadioButton.checked&&i.setOrientation(DimensionLineController.DimensionLineOrientation.PLAN)})),n.elevationDimensionLineRadioButton=n.findElement("[name='orientation-choice'][value='ELEVATION']"),n.registerEventListener(n.elevationDimensionLineRadioButton,"change",(function(e){n.elevationDimensionLineRadioButton.checked&&i.setOrientation(DimensionLineController.DimensionLineOrientation.ELEVATION)})),n.registerPropertyChangeListener(i,"ORIENTATION",(function(e){a()})),n.lengthFontSizeLabel=n.getElement("length-font-size-label"),n.lengthFontSizeLabel.textContent=n.getLocalizedLabelText("DimensionLinePanel","lengthFontSizeLabel.text",n.preferences.getLengthUnit().getName()),n.lengthFontSizeInput=new JSSpinner(t,n.getElement("length-font-size-input"),{format:t.getLengthUnit().getFormat(),value:i.getLengthFontSize(),minimum:5,maximum:999,stepSize:t.getLengthUnit().getStepSize()});var l=function(){var e=i.getLengthFontSize();n.lengthFontSizeInput.setNullable(null==e),n.lengthFontSizeInput.setValue(e)};l(),n.registerPropertyChangeListener(i,"LENGTH_FONT_SIZE",l),n.registerEventListener(n.lengthFontSizeInput,"input",(function(e){i.setLengthFontSize(n.lengthFontSizeInput.getValue())})),n.colorButton=new ColorButton(t,{colorChanged:function(e){i.setColor(n.colorButton.getColor())}}),n.attachChildComponent("color-button",n.colorButton),n.colorButton.setColor(i.getColor()),n.colorButton.setColorDialogTitle(t.getLocalizedString("DimensionLinePanel","colorDialog.title")),n.registerPropertyChangeListener(i,"COLOR",(function(){n.colorButton.setColor(i.getColor())}));var a=function(){i.getOrientation()==DimensionLineController.DimensionLineOrientation.PLAN?n.planDimensionLineRadioButton.checked=!0:i.getOrientation()==DimensionLineController.DimensionLineOrientation.ELEVATION&&(n.elevationDimensionLineRadioButton.checked=!0),orientable=i.isEditableDistance(),n.planDimensionLineRadioButton.disabled=!orientable,n.elevationDimensionLineRadioButton.disabled=!orientable,null!=i.getPitch()&&i.getOrientation()!=DimensionLineController.DimensionLineOrientation.ELEVATION&&(0===i.getPitch()?n.pitch0DegreeRadioButton.checked=!0:Math.abs(i.getPitch())===Math.PI/2&&(n.pitch90DegreeRadioButton.checked=!0));var e=i.getOrientation()==DimensionLineController.DimensionLineOrientation.PLAN,t=!0===i.isVisibleIn3D();n.pitch0DegreeRadioButton.disabled=!(t&&e),n.pitch90DegreeRadioButton.disabled=!(t&&e),n.elevationStartInput.setEnabled(t||i.getOrientation()==DimensionLineController.DimensionLineOrientation.ELEVATION),n.xEndInput.setEnabled(e),n.yEndInput.setEnabled(e)};n.visibleIn3DViewCheckBox=n.getElement("visible-in-3D-checkbox"),n.visibleIn3DViewCheckBox.checked=i.isVisibleIn3D(),n.registerPropertyChangeListener(i,"VISIBLE_IN_3D",(function(e){n.visibleIn3DViewCheckBox.checked=i.isVisibleIn3D()})),n.registerEventListener(n.visibleIn3DViewCheckBox,"change",(function(e){i.setVisibleIn3D(n.visibleIn3DViewCheckBox.checked),a()})),n.pitch0DegreeRadioButton=n.findElement("[name='label-pitch-radio'][value='0']"),n.pitch90DegreeRadioButton=n.findElement("[name='label-pitch-radio'][value='90']");return n.registerEventListener([n.pitch0DegreeRadioButton,n.pitch90DegreeRadioButton],"change",(function(){n.pitch0DegreeRadioButton.checked?i.setPitch(0):n.pitch90DegreeRadioButton.checked&&i.setPitch(-Math.PI/2)})),n.registerPropertyChangeListener(i,"PITCH",a),a(),n},JSViewFactory.prototype.createLabelView=function(e,t,i){var n=new JSDialog(t,e?"@{LabelPanel.labelModification.title}":"@{LabelPanel.labelCreation.title}",document.getElementById("label-dialog-template"),{applier:function(t){e?i.modifyLabels():i.createLabel()},disposer:function(e){e.colorButton.dispose()},size:"small"});n.textInput=n.getElement("text"),n.textInput.value=null!=i.getText()?i.getText():"",n.registerEventListener(n.textInput,"input",(function(e){i.setText(n.textInput.value)})),n.registerPropertyChangeListener(i,"TEXT",(function(e){n.textInput.value=null!=i.getText()?i.getText():""})),n.alignmentRadioButtons=n.getHTMLElement().querySelectorAll("[name='label-alignment-radio']"),n.registerEventListener(n.alignmentRadioButtons,"change",(function(e){for(var t=0;t<n.alignmentRadioButtons.length;t++)n.alignmentRadioButtons[t].checked&&i.setAlignment(TextStyle.Alignment[n.alignmentRadioButtons[t].value])}));var o=function(){var e=n.findElement("[name='label-alignment-radio'][value='"+TextStyle.Alignment[i.getAlignment()]+"']");null!=e&&(e.checked=!0)};n.registerPropertyChangeListener(i,"ALIGNMENT",o),o(),n.fontSelect=n.getElement("font-select");var r="DEFAULT_SYSTEM_FONT_NAME";n.registerEventListener(n.fontSelect,"change",(function(e){var t=n.fontSelect.querySelector("option:checked").value;i.setFontName(t==r?null:t)}));var l=function(){if(i.isFontNameSet()){var e=null==i.getFontName()?r:i.getFontName(),t=n.fontSelect.querySelector("[value='"+e+"']");t&&(t.selected=!0)}else n.fontSelect.selectedIndex=void 0};n.registerPropertyChangeListener(i,"FONT_NAME",l),CoreTools.loadAvailableFontNames((function(e){e=[r].concat(e);for(var t=0;t<e.length;t++){var i=e[t],o=0==t?n.getLocalizedLabelText("FontNameComboBox","systemFontName"):i;n.fontSelect.appendChild(JSComponent.createOptionElement(i,o))}l()})),n.fontSizeLabel=n.getElement("font-size-label"),n.fontSizeLabel.textContent=n.getLocalizedLabelText("LabelPanel","fontSizeLabel.text",n.preferences.getLengthUnit().getName()),n.fontSizeInput=new JSSpinner(t,n.getElement("font-size-input"),{format:t.getLengthUnit().getFormat(),value:i.getFontSize(),minimum:5,maximum:999,stepSize:t.getLengthUnit().getStepSize()});var a=function(){var e=i.getFontSize();n.fontSizeInput.setNullable(null==e),n.fontSizeInput.setValue(e)};a(),n.registerPropertyChangeListener(i,"FONT_SIZE",a),n.registerEventListener(n.fontSizeInput,"input",(function(e){i.setFontSize(n.fontSizeInput.getValue())})),n.colorButton=new ColorButton(t,{colorChanged:function(e){i.setColor(n.colorButton.getColor())}}),n.attachChildComponent("color-button",n.colorButton),n.colorButton.setColor(i.getColor()),n.colorButton.setColorDialogTitle(t.getLocalizedString("LabelPanel","colorDialog.title")),n.registerPropertyChangeListener(i,"COLOR",(function(){n.colorButton.setColor(i.getColor())}));var s=function(){var e=!0===i.isPitchEnabled();n.pitch0DegreeRadioButton.disabled=!e,n.pitch90DegreeRadioButton.disabled=!e,n.elevationInput.setEnabled(e),null!==i.getPitch()&&(0===i.getPitch()?n.pitch0DegreeRadioButton.checked=!0:i.getPitch()===Math.PI/2&&(n.pitch90DegreeRadioButton.checked=!0))};n.registerPropertyChangeListener(i,"PITCH",s),n.visibleIn3DCheckBox=n.getElement("visible-in-3D-checkbox"),n.visibleIn3DCheckBox.checked=null!==i.isPitchEnabled()&&null!==i.getPitch(),n.registerEventListener(n.visibleIn3DCheckBox,"change",(function(e){n.visibleIn3DCheckBox.checked?n.pitch90DegreeRadioButton.checked?i.setPitch(Math.PI/2):i.setPitch(0):i.setPitch(null),s()})),n.pitch0DegreeRadioButton=n.findElement("[name='label-pitch-radio'][value='0']"),n.pitch90DegreeRadioButton=n.findElement("[name='label-pitch-radio'][value='90']");n.registerEventListener([n.pitch0DegreeRadioButton,n.pitch90DegreeRadioButton],"change",(function(){n.pitch0DegreeRadioButton.checked?i.setPitch(0):n.pitch90DegreeRadioButton.checked&&i.setPitch(Math.PI/2)})),n.elevationLabel=n.getElement("elevation-label"),n.elevationLabel.textContent=n.getLocalizedLabelText("LabelPanel","elevationLabel.text",n.preferences.getLengthUnit().getName()),n.elevationInput=new JSSpinner(t,n.getElement("elevation-input"),{nullable:null==i.getElevation(),format:t.getLengthUnit().getFormat(),value:i.getElevation(),minimum:0,maximum:t.getLengthUnit().getMaximumElevation(),stepSize:t.getLengthUnit().getStepSize()});return n.registerPropertyChangeListener(i,"ELEVATION",(function(e){n.elevationInput.setNullable(null===e.getNewValue()),n.elevationInput.setValue(e.getNewValue())})),n.registerEventListener(n.elevationInput,"input",(function(e){i.setElevation(n.elevationInput.getValue())})),s(),n},JSViewFactory.prototype.createCompassView=function(e,t){function i(){this.controller=t,JSDialog.call(this,e,"@{CompassPanel.compass.title}",document.getElementById("compass-dialog-template"),{size:"medium",applier:function(e){e.controller.modifyCompass()}}),this.initRosePanel(),this.initGeographicLocationPanel()}return i.prototype=Object.create(JSDialog.prototype),i.prototype.constructor=i,i.prototype.initRosePanel=function(){var e=this.preferences,t=this.controller,i=e.getLengthUnit().getMaximumLength(),n=this.getElement("x-label"),o=new JSSpinner(this.preferences,this.getElement("x-input"),{format:e.getLengthUnit().getFormat(),minimum:-i,maximum:i,stepSize:e.getLengthUnit().getStepSize()}),r=this.getElement("y-label"),l=new JSSpinner(this.preferences,this.getElement("y-input"),{format:e.getLengthUnit().getFormat(),minimum:-i,maximum:i,stepSize:e.getLengthUnit().getStepSize()}),a=this.getElement("diameter-label"),s=new JSSpinner(this.preferences,this.getElement("diameter-input"),{format:e.getLengthUnit().getFormat(),minimum:e.getLengthUnit().getMinimumLength(),maximum:e.getLengthUnit().getMaximumLength()/10,stepSize:e.getLengthUnit().getStepSize()});o.setValue(t.getX()),l.setValue(t.getY()),s.setValue(t.getDiameter());var h=this.preferences.getLengthUnit().getName();n.textContent=this.getLocalizedLabelText("CompassPanel","xLabel.text",h),r.textContent=this.getLocalizedLabelText("CompassPanel","yLabel.text",h),a.textContent=this.getLocalizedLabelText("CompassPanel","diameterLabel.text",h);t=this.controller;this.registerPropertyChangeListener(this.controller,"X",(function(e){o.setValue(t.getX())})),this.registerPropertyChangeListener(this.controller,"Y",(function(e){l.setValue(t.getY())})),this.registerPropertyChangeListener(this.controller,"DIAMETER",(function(e){s.setValue(t.getDiameter())})),this.registerEventListener(o,"input",(function(e){t.setX(o.getValue())})),this.registerEventListener(l,"input",(function(e){t.setY(l.getValue())})),this.registerEventListener(s,"input",(function(e){t.setDiameter(s.getValue())}));var u=this.getElement("visible-checkbox");u.checked=t.isVisible(),this.registerEventListener(u,"change",(function(e){t.setVisible(u.checked)})),this.registerPropertyChangeListener(t,"VISIBLE",(function(e){u.checked=t.isVisible()}))},i.prototype.initGeographicLocationPanel=function(){this.preferences;var e=this.controller,t=new JSSpinner(this.preferences,this.getElement("latitude-input"),{format:new DecimalFormat("N ##0.000;S ##0.000"),minimum:-90,maximum:90,stepSize:5}),i=new JSSpinner(this.preferences,this.getElement("longitude-input"),{format:new DecimalFormat("E ##0.000;W ##0.000"),minimum:-180,maximum:180,stepSize:5}),n=new JSSpinner(this.preferences,this.getElement("north-direction-input"),{format:new IntegerFormat,minimum:0,maximum:360,stepSize:5});n.getHTMLElement().style.width="3em",n.style.verticalAlign="super",t.setValue(e.getLatitudeInDegrees()),i.setValue(e.getLongitudeInDegrees()),n.setValue(e.getNorthDirectionInDegrees()),this.registerPropertyChangeListener(e,"LATITUDE_IN_DEGREES",(function(i){t.setValue(e.getLatitudeInDegrees())})),this.registerPropertyChangeListener(e,"LONGITUDE_IN_DEGREES",(function(t){i.setValue(e.getLongitudeInDegrees())})),this.registerPropertyChangeListener(e,"NORTH_DIRECTION_IN_DEGREES",(function(t){n.setValue(e.getNorthDirectionInDegrees())})),this.registerEventListener(t,"input",(function(i){e.setLatitudeInDegrees(t.getValue())})),this.registerEventListener(i,"input",(function(t){e.setLongitudeInDegrees(i.getValue())})),this.registerEventListener(n,"input",(function(t){e.setNorthDirectionInDegrees(n.getValue()),l()}));var o=this.getElement("compass-preview");o.width=140,o.height=140,o.style.verticalAlign="middle",o.style.width="35px";o.getContext("2d");var r=new Graphics2D(o),l=function(){r.clear();var t=r.getTransform();r.translate(70,70),r.scale(100,100),r.setColor("#000000"),r.fill(PlanComponent.COMPASS),r.setTransform(t),0==e.getNorthDirectionInDegrees()||null==e.getNorthDirectionInDegrees()?o.style.transform="":o.style.transform="rotate("+e.getNorthDirectionInDegrees()+"deg)"};l()},new i},JSViewFactory.prototype.createObserverCameraView=function(e,t){function i(){this.controller=t,JSDialog.call(this,e,"@{ObserverCameraPanel.observerCamera.title}",document.getElementById("observer-camera-dialog-template"),{applier:function(e){e.controller.modifyObserverCamera()}}),this.initLocationPanel(),this.initAnglesPanel();var i=this.getElement("adjust-observer-camera-elevation-checkbox");i.checked=t.isElevationAdjusted();var n=t.isObserverCameraElevationAdjustedEditable()?"initial":"none";i.parentElement.style.display=n,this.registerEventListener(i,"change",(function(e){t.setElevationAdjusted(i.checked)})),this.registerPropertyChangeListener(t,"OBSERVER_CAMERA_ELEVATION_ADJUSTED",(function(e){i.checked=t.isElevationAdjusted()}))}return i.prototype=Object.create(JSDialog.prototype),i.prototype.constructor=i,i.prototype.initLocationPanel=function(){var e=5e5,t=this.getElement("x-label"),i=new JSSpinner(this.preferences,this.getElement("x-input"),{nullable:null==this.controller.getX(),format:this.preferences.getLengthUnit().getFormat(),minimum:-e,maximum:e,stepSize:this.preferences.getLengthUnit().getStepSize()}),n=this.getElement("y-label"),o=new JSSpinner(this.preferences,this.getElement("y-input"),{nullable:null==this.controller.getY(),format:this.preferences.getLengthUnit().getFormat(),minimum:-e,maximum:e,stepSize:this.preferences.getLengthUnit().getStepSize()}),r=this.getElement("elevation-label"),l=new JSSpinner(this.preferences,this.getElement("elevation-input"),{nullable:null==this.controller.getElevation(),format:this.preferences.getLengthUnit().getFormat(),minimum:this.controller.getMinimumElevation(),maximum:this.preferences.getLengthUnit().getMaximumElevation(),stepSize:this.preferences.getLengthUnit().getStepSize()});i.setValue(this.controller.getX()),o.setValue(this.controller.getY()),l.setValue(this.controller.getElevation());var a=this.preferences.getLengthUnit().getName();t.textContent=this.getLocalizedLabelText("HomeFurniturePanel","xLabel.text",a),n.textContent=this.getLocalizedLabelText("HomeFurniturePanel","yLabel.text",a),r.textContent=this.getLocalizedLabelText("ObserverCameraPanel","elevationLabel.text",a);var s=this.controller;this.registerPropertyChangeListener(this.controller,"X",(function(e){i.setValue(s.getX())})),this.registerPropertyChangeListener(this.controller,"Y",(function(e){o.setValue(s.getY())})),this.registerPropertyChangeListener(this.controller,"ELEVATION",(function(e){l.setValue(s.getElevation())})),this.registerEventListener(i,"input",(function(e){s.setX(i.getValue())})),this.registerEventListener(o,"input",(function(e){s.setY(o.getValue())})),this.registerEventListener(l,"input",(function(e){s.setElevation(l.getValue())}))},i.prototype.initAnglesPanel=function(){var e=new DecimalFormat("0.#"),t=new JSSpinner(this.preferences,this.getElement("yaw-input"),{format:e,value:Math.toDegrees(this.controller.getYaw()),minimum:-1e4,maximum:1e4,stepSize:5}),i=new JSSpinner(this.preferences,this.getElement("pitch-input"),{format:e,value:Math.toDegrees(this.controller.getPitch()),minimum:-90,maximum:90,stepSize:5}),n=new JSSpinner(this.preferences,this.getElement("field-of-view-input"),{nullable:null==this.controller.getFieldOfView(),format:e,value:Math.toDegrees(this.controller.getFieldOfView()),minimum:2,maximum:120,stepSize:1}),o=this.controller;this.registerPropertyChangeListener(this.controller,"YAW",(function(e){t.setValue(Math.toDegrees(this.controller.getYaw()))})),this.registerPropertyChangeListener(this.controller,"PITCH",(function(e){i.setValue(Math.toDegrees(this.controller.getPitch()))})),this.registerPropertyChangeListener(this.controller,"FIELD_OF_VIEW",(function(e){n.setValue(Math.toDegrees(this.controller.getFieldOfView()))})),this.registerEventListener(t,"input",(function(e){o.setYaw(null!=t.getValue()?Math.toRadians(t.getValue()):null)})),this.registerEventListener(i,"input",(function(e){o.setPitch(null!=i.getValue()?Math.toRadians(i.getValue()):null)})),this.registerEventListener(n,"input",(function(e){o.setFieldOfView(null!=n.getValue()?Math.toRadians(n.getValue()):null)}))},new i},JSViewFactory.prototype.createHome3DAttributesView=function(e,t){function i(){this.controller=t,JSDialog.call(this,e,"@{Home3DAttributesPanel.home3DAttributes.title}",document.getElementById("home-3Dattributes-dialog-template"),{size:"small",applier:function(e){e.controller.modify3DAttributes()},disposer:function(e){e.groundPanel.colorButton.dispose(),e.groundPanel.textureComponent.dispose(),e.skyPanel.colorButton.dispose(),e.skyPanel.textureComponent.dispose()}}),this.initGroundPanel(),this.initSkyPanel(),this.initRenderingPanel()}return i.prototype=Object.create(JSDialog.prototype),i.prototype.constructor=i,i.prototype.initGroundPanel=function(){var t=this.controller,i=this,n=i.findElement("[name='ground-color-and-texture-choice'][value='COLORED']"),o=new ColorButton(e,{colorChanged:function(e){n.checked=!0,t.setGroundPaint(Home3DAttributesController.EnvironmentPaint.COLORED),t.setGroundColor(e)}});i.attachChildComponent("ground-color-button",o),o.setColor(t.getGroundColor()),o.setColorDialogTitle(e.getLocalizedString("Home3DAttributesPanel","groundColorDialog.title"));var r=i.findElement("[name='ground-color-and-texture-choice'][value='TEXTURED']"),l=t.getGroundTextureController().getView();i.attachChildComponent("ground-texture-component",l);var a=[n,r];i.registerEventListener(a,"change",(function(e){e.target.checked&&t.setGroundPaint(Home3DAttributesController.EnvironmentPaint[e.target.value])}));var s=function(){n.checked=t.getGroundPaint()==Home3DAttributesController.EnvironmentPaint.COLORED,r.checked=t.getGroundPaint()==Home3DAttributesController.EnvironmentPaint.TEXTURED};s(),this.registerPropertyChangeListener(t,"GROUND_PAINT",s),this.registerPropertyChangeListener(t,"GROUND_COLOR",(function(e){o.setColor(t.getGroundColor())}));var h=this.getElement("background-image-visible-on-ground-3D-checkbox");h.checked=t.isBackgroundImageVisibleOnGround3D(),this.registerEventListener(h,"change",(function(e){t.setBackgroundImageVisibleOnGround3D(h.checked)})),this.registerPropertyChangeListener(t,"BACKGROUND_IMAGE_VISIBLE_ON_GROUND_3D",(function(e){h.checked=t.isBackgroundImageVisibleOnGround3D()})),this.groundPanel={colorButton:o,textureComponent:l}},i.prototype.initSkyPanel=function(){var t=this.controller,i=this,n=i.findElement("[name='sky-color-and-texture-choice'][value='COLORED']"),o=new ColorButton(e,{colorChanged:function(e){n.checked=!0,t.setSkyPaint(Home3DAttributesController.EnvironmentPaint.COLORED),t.setSkyColor(e)}});i.attachChildComponent("sky-color-button",o),o.setColor(t.getSkyColor()),o.setColorDialogTitle(e.getLocalizedString("Home3DAttributesPanel","skyColorDialog.title"));var r=i.findElement("[name='sky-color-and-texture-choice'][value='TEXTURED']"),l=t.getSkyTextureController().getView();i.attachChildComponent("sky-texture-component",l);var a=[n,r];i.registerEventListener(a,"change",(function(e){e.target.checked&&t.setSkyPaint(Home3DAttributesController.EnvironmentPaint[e.target.value])}));var s=function(){n.checked=t.getSkyPaint()==Home3DAttributesController.EnvironmentPaint.COLORED,r.checked=t.getSkyPaint()==Home3DAttributesController.EnvironmentPaint.TEXTURED};s(),this.registerPropertyChangeListener(t,"SKY_PAINT",s),this.registerPropertyChangeListener(t,"SKY_COLOR",(function(){o.setColor(t.getSkyColor())})),this.skyPanel={colorButton:o,textureComponent:l}},i.prototype.initRenderingPanel=function(){for(var e=this.controller,t=this.getElement("brightness-slider"),i=this.findElement("#home-3Dattributes-brightness-list"),n=this.getElement("walls-transparency-slider"),o=this.findElement("#home-3Dattributes-walls-transparency-list"),r=0;r<=255;r+=17){var l=document.createElement("option");l.value=r,i.appendChild(l),o.appendChild(l.cloneNode())}t.value=255&e.getLightColor(),n.value=255*e.getWallsAlpha(),this.registerEventListener(t,"input",(function(t){var i=t.target.value;e.setLightColor(i<<16|i<<8|i)})),this.registerEventListener(n,"input",(function(t){e.setWallsAlpha(this.value/255)})),this.registerPropertyChangeListener(e,"LIGHT_COLOR",(function(i){t.value=255&e.getLightColor()})),this.registerPropertyChangeListener(e,"WALLS_ALPHA",(function(t){n.value=255*e.getWallsAlpha()}))},new i},JSViewFactory.prototype.createTextureChoiceView=function(e,t){return new TextureChoiceComponent(e,t)},JSViewFactory.prototype.createBaseboardChoiceView=function(e,t){function i(){JSComponent.call(this,e,"  <div class='whole-line'>    <label>      <input name='baseboard-visible-checkbox' type='checkbox'/>      @{BaseboardChoiceComponent.visibleCheckBox.text}    </label>  </div>  <div class='whole-line'>    <label>      <input type='radio' name='baseboard-color-and-texture-choice' value='sameColorAsWall'/>      @{BaseboardChoiceComponent.sameColorAsWallRadioButton.text}    </label>  </div>  <div>    <label>      <input type='radio' name='baseboard-color-and-texture-choice' value='COLORED'>        @{BaseboardChoiceComponent.colorRadioButton.text}    </label>  </div>  <div data-name='baseboard-color-button'></div>  <div>    <label>      <input type='radio' name='baseboard-color-and-texture-choice' value='TEXTURED'>        @{BaseboardChoiceComponent.textureRadioButton.text}    </label>  </div>  <div data-name='baseboard-texture-component'></div>  <div class='whole-line'>    <hr/>  </div>  <div data-name='height-label' class='label-cell'></div>  <div><span data-name='height-input'></span></div>  <div data-name='thickness-label' class='label-cell'></div>  <div><span data-name='thickness-input'></span></div>"),this.initComponents(t)}return i.prototype=Object.create(JSComponent.prototype),i.prototype.constructor=i,i.prototype.dispose=function(){this.colorButton.dispose(),this.textureComponent.dispose(),JSComponent.prototype.dispose.call(this)},i.prototype.initComponents=function(t){var i=this;this.getHTMLElement().dataset.name="baseboard-panel",this.getHTMLElement().classList.add("label-input-grid"),this.visibleCheckBox=this.getElement("baseboard-visible-checkbox"),this.visibleCheckBox.checked=t.getVisible(),this.registerEventListener(this.visibleCheckBox,"change",(function(e){t.setVisible(i.visibleCheckBox.checked)}));var n=function(){var e=t.getVisible();i.visibleCheckBox.checked=e;for(var n=!1!==e,o=0;o<i.colorAndTextureRadioButtons.length;o++)i.colorAndTextureRadioButtons[o].disabled=!n;i.colorButton.setEnabled(n),i.textureComponent.setEnabled(n),i.heightInput.setEnabled(n),i.thicknessInput.setEnabled(n)};this.registerPropertyChangeListener(t,"VISIBLE",(function(e){n()}));var o=this.findElement("[name='baseboard-color-and-texture-choice'][value='sameColorAsWall']"),r=this.findElement("[name='baseboard-color-and-texture-choice'][value='COLORED']");this.colorButton=new ColorButton(e,{colorChanged:function(e){r.checked=!0,t.setPaint(BaseboardChoiceController.BaseboardPaint.COLORED),t.setColor(e)}}),this.attachChildComponent("baseboard-color-button",this.colorButton),this.colorButton.setColor(t.getColor()),this.colorButton.setColorDialogTitle(e.getLocalizedString("BaseboardChoiceComponent","colorDialog.title"));var l=this.findElement("[name='baseboard-color-and-texture-choice'][value='TEXTURED']");this.textureComponent=t.getTextureController().getView(),this.attachChildComponent("baseboard-texture-component",this.textureComponent),this.colorAndTextureRadioButtons=[o,r,l],this.registerEventListener(this.colorAndTextureRadioButtons,"change",(function(e){if(e.target.checked){var i="sameColorAsWall"==e.target.value?BaseboardChoiceController.BaseboardPaint.DEFAULT:BaseboardChoiceController.BaseboardPaint[e.target.value];t.setPaint(i)}}));var a=function(){o.checked=t.getPaint()==BaseboardChoiceController.BaseboardPaint.DEFAULT,r.checked=t.getPaint()==BaseboardChoiceController.BaseboardPaint.COLORED,l.checked=t.getPaint()==BaseboardChoiceController.BaseboardPaint.TEXTURED};a(),this.registerPropertyChangeListener(t,"PAINT",a);var s=e.getLengthUnit().getName();this.getElement("height-label").textContent=this.getLocalizedLabelText("BaseboardChoiceComponent","heightLabel.text",s),this.getElement("thickness-label").textContent=this.getLocalizedLabelText("BaseboardChoiceComponent","thicknessLabel.text",s);var h=e.getLengthUnit().getMinimumLength();this.heightInput=new JSSpinner(e,this.getElement("height-input"),{nullable:null==t.getHeight(),format:e.getLengthUnit().getFormat(),value:null!=t.getHeight()&&null!=t.getMaxHeight()?Math.min(t.getHeight(),t.getMaxHeight()):t.getHeight(),minimum:h,maximum:null==t.getMaxHeight()?e.getLengthUnit().getMaximumLength()/10:t.getMaxHeight(),stepSize:e.getLengthUnit().getStepSize()}),this.thicknessInput=new JSSpinner(e,this.getElement("thickness-input"),{nullable:null==t.getThickness(),format:e.getLengthUnit().getFormat(),value:t.getThickness(),minimum:h,maximum:2,stepSize:e.getLengthUnit().getStepSize()}),this.registerPropertyChangeListener(t,"HEIGHT",(function(e){i.heightInput.setValue(e.getNewValue())})),this.registerPropertyChangeListener(t,"MAX_HEIGHT",(function(e){(null==e.getOldValue()||null!=t.getMaxHeight()&&i.heightInput.max<t.getMaxHeight())&&(i.heightInput.max=t.getMaxHeight())})),this.registerPropertyChangeListener(t,"THICKNESS",(function(e){i.thicknessInput.setValue(e.getNewValue())})),this.registerEventListener(this.heightInput,"input",(function(e){t.setHeight(i.heightInput.getValue())})),this.registerEventListener(this.thicknessInput,"input",(function(e){t.setThickness(i.thicknessInput.getValue())})),n()},new i},JSViewFactory.prototype.createModelMaterialsView=function(e,t){return new ModelMaterialsComponent(e,t)},JSViewFactory.prototype.createPageSetupView=function(e,t){return this.dummyDialogView},JSViewFactory.prototype.createPrintPreviewView=function(e,t,i,n){return this.dummyDialogView},JSViewFactory.prototype.createPhotoView=function(e,t,i){return this.dummyDialogView},JSViewFactory.prototype.createPhotosView=function(e,t,i){return this.dummyDialogView},JSViewFactory.prototype.createVideoView=function(e,t,i){return this.dummyDialogView},DirectHomeRecorder.prototype=Object.create(HomeRecorder.prototype),DirectHomeRecorder.prototype.constructor=DirectHomeRecorder,DirectHomeRecorder.prototype.readHome=function(e,t){if(void 0!==this.configuration.readHomeURL){var i=CoreTools.format(this.configuration.readHomeURL.replace(/(%[^s])/g,"%$1"),encodeURIComponent(e)),n=-1!=i.indexOf("?")?"&":"?";e=i+=n+"editionId="+HomeObject.createId("home")}HomeRecorder.prototype.readHome.call(this,e,t)},DirectHomeRecorder.prototype.writeHome=function(e,t,i){var n=[];this.searchContents(e,[],n,(function(e){return e instanceof LocalURLContent||e.isJAREntry()&&URLContent.fromURL(e.getJAREntryURL())instanceof LocalURLContent}));var o=[],r=this,l={contentsSaved:function(n){var l=[];r.searchContents(e,[],l,(function(e){return e instanceof HomeURLContent||e instanceof SimpleURLContent}));for(var a=0,s=0;s<l.length;s++){var h=l[s];if(h instanceof HomeURLContent){var u=h.getJAREntryName();u.indexOf("/")<0?n[h.getURL()]=(++a).toString():n[h.getURL()]=++a+u.substring(u.indexOf("/"))}else h instanceof SimpleURLContent&&h.isJAREntry()&&URLContent.fromURL(h.getJAREntryURL())instanceof LocalURLContent&&(n[h.getURL()]=(++a).toString())}o.push(r.writeHomeToZip(e,t,l,n,"blob",{homeSaved:function(e,n){var l=new BlobURLContent(n),a={abort:function(){URL.revokeObjectURL(l.getURL())}};o.push(l.writeBlob(r.configuration.writeHomeURL,t,{blobSaved:function(t,n){a.abort(),null!=i&&null!=i.homeSaved&&i.homeSaved(e)},blobError:function(e,t){a.abort(),null!=i&&null!=i.homeError&&i.homeError(e,t)}})),o.push(a)},homeError:function(e,t){null!=i&&null!=i.homeError&&i.homeError(e,t)}}))},contentsError:function(e,t){null!=i&&null!=i.homeError&&i.homeError(e,t)}};return void 0!==this.configuration.writeResourceURL&&void 0!==this.configuration.readResourceURL?o.push(this.saveContents(n,l)):l.contentsSaved({}),{abort:function(){for(var e=0;e<o.length;e++)o[e].abort()}}},DirectHomeRecorder.prototype.saveContents=function(e,t){var i={},n={},o={},r="/Recovery";void 0!==this.configuration.autoRecoveryObjectstore&&(r="/"+this.configuration.autoRecoveryObjectstore);for(var l=this,a=(e=e.slice(0)).length-1;a>=0;a--){var s=e[a],h=s.isJAREntry()?URLContent.fromURL(s.getJAREntryURL()):s;if((!(h instanceof LocalStorageURLContent)||this.configuration.writeResourceURL.indexOf(LocalStorageURLContent.LOCAL_STORAGE_PREFIX)<0)&&(!(h instanceof IndexedDBURLContent)||this.configuration.writeResourceURL.indexOf(IndexedDBURLContent.INDEXED_DB_PREFIX)<0)||h instanceof IndexedDBURLContent&&(this.configuration.writeResourceURL.indexOf(IndexedDBURLContent.INDEXED_DB_PREFIX)<0||this.configuration.writeResourceURL.indexOf(r)<0)&&h.getURL().indexOf(r)>0)if(null==h.getSavedContent()||0===h.getSavedContent().getURL().indexOf(LocalStorageURLContent.LOCAL_STORAGE_PREFIX)&&this.configuration.writeResourceURL.indexOf(LocalStorageURLContent.LOCAL_STORAGE_PREFIX)<0||0===h.getSavedContent().getURL().indexOf(IndexedDBURLContent.INDEXED_DB_PREFIX)&&(this.configuration.writeResourceURL.indexOf(IndexedDBURLContent.INDEXED_DB_PREFIX)<0||this.configuration.writeResourceURL.indexOf(r)<0&&h.getSavedContent().getURL().indexOf(r)>0)){var u=n[h.getURL()];null!=u?(h.setSavedContent(u),e.splice(a,1)):(h.setSavedContent(null),h.getBlob({localContent:s,blobReady:function(a){var s="dat";"image/png"==a.type?s="png":"image/jpeg"==a.type&&(s="jpg");var u=UUID.randomUUID()+"."+s,d={handledContent:this.localContent,blobSaved:function(a,s){if(null==a.getSavedContent()||0===a.getSavedContent().getURL().indexOf(IndexedDBURLContent.INDEXED_DB_PREFIX)&&(l.configuration.writeResourceURL.indexOf(IndexedDBURLContent.INDEXED_DB_PREFIX)<0||l.configuration.writeResourceURL.indexOf(r)<0&&a.getSavedContent().getURL().indexOf(r)>0)){var h=URLContent.fromURL(CoreTools.format(l.configuration.readResourceURL.replace(/(%[^s])/g,"%$1"),encodeURIComponent(s)));a.setSavedContent(h),n[a.getURL()]=h}o[this.handledContent.getURL()]=this.handledContent.isJAREntry()?"jar:"+a.getSavedContent().getURL()+"!/"+this.handledContent.getJAREntryName():a.getSavedContent().getURL(),delete i[s],e.splice(e.lastIndexOf(this.handledContent),1),0===e.length&&t.contentsSaved(o)},blobError:function(e,i){t.contentsError(e,i)}};i[u]=h.writeBlob(l.configuration.writeResourceURL,u,d)},blobError:function(e,i){t.contentsError(e,i)}}))}else o[s.getURL()]=s.isJAREntry()?"jar:"+h.getSavedContent().getURL()+"!/"+s.getJAREntryName():h.getSavedContent().getURL(),e.splice(a,1);else e.splice(a,1)}return 0===e.length&&t.contentsSaved(o),{abort:function(){for(var e in i)i[e].abort()}}},DirectHomeRecorder.prototype.getAvailableHomes=function(e){if(void 0!==this.configuration.listHomesURL){var t=this.configuration.listHomesURL;if(0===t.indexOf(LocalStorageURLContent.LOCAL_STORAGE_PREFIX)){for(var i=t.substring(t.indexOf(LocalStorageURLContent.LOCAL_STORAGE_PREFIX)+LocalStorageURLContent.LOCAL_STORAGE_PREFIX.length),n=new RegExp(i.indexOf("?")>0?i.substring(0,i.indexOf("?")):i),o=Object.getOwnPropertyNames(localStorage),r=[],l=0;l<o.length;l++){var a=o[l].match(n);a&&r.push(a.length>1?a[1]:a[0])}return e.availableHomes(r),{abort:function(){}}}if(0===t.indexOf(IndexedDBURLContent.INDEXED_DB_PREFIX)){var s=t.indexOf(IndexedDBURLContent.INDEXED_DB_PREFIX)+IndexedDBURLContent.INDEXED_DB_PREFIX.length,h=t.indexOf("/",s),u=t.indexOf("?",h+1),d=t.indexOf("=",u+1),c=t.indexOf("&",d+1),p=t.substring(s,h),g=t.substring(h+1,u),m=t.substring(u+1,d),f=(n=new RegExp(t.substring(d+1,c>0?c:t.length)),function(e){var t=e.target.result;t.objectStoreNames.contains(g)||t.createObjectStore(g,{keyPath:m})}),v=function(t){void 0!==e.homesError&&e.homesError(t.target.errorCode,"Can't connect to database "+p)},_=function(t){var i=t.target.result;try{if(i.objectStoreNames.contains(g)){var o,r=i.transaction(g,"readonly"),l=r.objectStore(g);if(void 0!==IDBObjectStore.prototype.getAllKeys)(o=l.getAllKeys()).addEventListener("success",(function(t){for(var i=[],o=0;o<t.target.result.length;o++){var r=t.target.result[o].match(n);r&&i.push(r.length>1?r[1]:r[0])}e.availableHomes(i)}));else{o=l.openCursor();var a=[];o.addEventListener("success",(function(t){var i=t.target.result;if(null!=i){var o=i.primaryKey.match(n);o&&a.push(o.length>1?o[1]:o[0]),i.continue()}else e.availableHomes(a)}))}o.addEventListener("error",(function(t){void 0!==e.homesError&&e.homesError(t.target.errorCode,"Can't query in "+g)})),r.addEventListener("complete",(function(e){i.close()}))}else{i.close();var s=indexedDB.open(p,i.version+1);s.addEventListener("upgradeneeded",f),s.addEventListener("error",v),s.addEventListener("success",_)}}catch(t){void 0!==e.homesError&&e.homesError(t,t.message)}};if(null!=indexedDB)(S=indexedDB.open(p)).addEventListener("upgradeneeded",f),S.addEventListener("error",v),S.addEventListener("success",_);else void 0!==e.homesError&&e.homesError(new Error("indexedDB"),"indexedDB unavailable");return{abort:function(){}}}var S=new XMLHttpRequest,y=-1!=t.indexOf("?")?"&":"?";if(S.open("GET",t+y+"requestId="+UUID.randomUUID(),!0),S.addEventListener("load",(function(t){S.readyState===XMLHttpRequest.DONE&&200===S.status?e.availableHomes(JSON.parse(S.responseText)):void 0!==e.homesError&&e.homesError(S.status,S.responseText)})),void 0!==e.homesError){var E=function(t){e.homesError(0,t)};S.addEventListener("error",E),S.addEventListener("timeout",E)}return S.send(),S}return null},DirectHomeRecorder.prototype.deleteHome=function(e,t){if(void 0!==this.configuration.deleteHomeURL){var i=CoreTools.format(this.configuration.deleteHomeURL.replace(/(%[^s])/g,"%$1"),encodeURIComponent(e));if(0===i.indexOf(LocalStorageURLContent.LOCAL_STORAGE_PREFIX)){var n=i.substring(i.indexOf(LocalStorageURLContent.LOCAL_STORAGE_PREFIX)+LocalStorageURLContent.LOCAL_STORAGE_PREFIX.length),o=decodeURIComponent(n.indexOf("?")>0?n.substring(0,n.indexOf("?")):n);return localStorage.removeItem(o),t.homeDeleted(e),{abort:function(){}}}if(0===i.indexOf(IndexedDBURLContent.INDEXED_DB_PREFIX)){var r,l=i.indexOf(IndexedDBURLContent.INDEXED_DB_PREFIX)+IndexedDBURLContent.INDEXED_DB_PREFIX.length,a=i.indexOf("/",l),s=i.indexOf("?",a+1),h=i.indexOf("=",s+1),u=i.indexOf("&",h+1),d=i.substring(l,a),c=i.substring(a+1,s),p=i.substring(s+1,h),g=decodeURIComponent(i.substring(h+1,u>0?u:i.length)),m=function(e){var t=e.target.result;t.objectStoreNames.contains(c)||t.createObjectStore(c,{keyPath:p})},f=function(e){void 0!==t.homeError&&t.homeError(e.target.errorCode,"Can't connect to database "+d)},v=function(i){var n=i.target.result;try{if(n.objectStoreNames.contains(c)){var o=n.transaction(c,"readwrite"),r=o.objectStore(c).delete(g);r.addEventListener("error",(function(e){void 0!==t.homeError&&t.homeError(e.target.errorCode,"Can't delete in "+c)})),r.addEventListener("success",(function(i){t.homeDeleted(e)})),o.addEventListener("complete",(function(e){n.close()}))}else{n.close();var l=indexedDB.open(d,n.version+1);l.addEventListener("upgradeneeded",m),l.addEventListener("error",f),l.addEventListener("success",v)}}catch(e){void 0!==t.homeError&&t.homeError(e,e.message)}};if(null!=indexedDB)(r=indexedDB.open(d)).addEventListener("upgradeneeded",m),r.addEventListener("error",f),r.addEventListener("success",v);else void 0!==t.homeError&&t.homeError(new Error("indexedDB"),"indexedDB unavailable");return{abort:function(){}}}if(i.indexOf("?")>0&&(i+="&requestId="+UUID.randomUUID()),(r=new XMLHttpRequest).open("GET",i,!0),r.addEventListener("load",(function(i){r.readyState===XMLHttpRequest.DONE&&200===r.status?t.homeDeleted(e):void 0!==t.homeError&&t.homeError(r.status,r.responseText)})),void 0!==t.homeError){var _=function(e){t.homeError(0,e)};r.addEventListener("error",_),r.addEventListener("timeout",_)}return r.send(),r}return null},IncrementalHomeRecorder.prototype=Object.create(HomeRecorder.prototype),IncrementalHomeRecorder.prototype.constructor=IncrementalHomeRecorder,IncrementalHomeRecorder.DEFAULT_TRACKED_HOME_PROPERTIES=[FurnitureTablePanel.EXPANDED_ROWS_VISUAL_PROPERTY,HomePane.PLAN_VIEWPORT_X_VISUAL_PROPERTY,HomePane.PLAN_VIEWPORT_Y_VISUAL_PROPERTY,HomePane.MAIN_PANE_DIVIDER_LOCATION_VISUAL_PROPERTY,HomePane.PLAN_PANE_DIVIDER_LOCATION_VISUAL_PROPERTY,HomePane.CATALOG_PANE_DIVIDER_LOCATION_VISUAL_PROPERTY,PlanController.SCALE_VISUAL_PROPERTY,"CAMERA","STORED_CAMERAS","SELECTED_LEVEL","FURNITURE_SORTED_PROPERTY","FURNITURE_DESCENDING_SORTED","FURNITURE_VISIBLE_PROPERTIES","OBSERVER_CAMERA_ELEVATION_ADJUSTED","ALL_LEVELS_VISIBLE"],IncrementalHomeRecorder.prototype.getTrackedHomeProperties=function(){return this.configuration&&this.configuration.trackedHomeProperties?this.configuration.trackedHomeProperties:IncrementalHomeRecorder.DEFAULT_TRACKED_HOME_PROPERTIES},IncrementalHomeRecorder.prototype.configure=function(e){this.configuration=e},IncrementalHomeRecorder.prototype.checkServer=function(e){var t=this,i=new XMLHttpRequest,n=this.configuration.pingURL;i.open("GET",n,!0),i.addEventListener("load",(function(n){i.readyState===XMLHttpRequest.DONE&&200===i.status?(t.online||t.configuration&&t.configuration.writingObserver&&t.configuration.writingObserver.connectionFound&&t.configuration.writingObserver.connectionFound(t),t.online=!0,setTimeout((function(){t.checkServer(e)}),e)):(t.online&&t.configuration&&t.configuration.writingObserver&&t.configuration.writingObserver.connectionLost&&t.configuration.writingObserver.connectionLost(i.status,i.statusText),t.online=!1,setTimeout((function(){t.checkServer(e)}),e))})),i.addEventListener("error",(function(i){t.online&&t.configuration&&t.configuration.writingObserver&&t.configuration.writingObserver.connectionLost&&t.configuration.writingObserver.connectionLost(0,"Can't post "+n),t.online=!1,setTimeout((function(){t.checkServer(e)}),e)})),i.send()},IncrementalHomeRecorder.prototype.readHome=function(e,t){if(void 0!==this.configuration.readHomeURL){var i=CoreTools.format(this.configuration.readHomeURL.replace(/(%[^s])/g,"%$1"),encodeURIComponent(e));if(i.indexOf("?")>0){var n=HomeObject.createId("home");i+="&editionId="+n;var o=t;t={homeLoaded:function(e){e.editionId=n,o.homeLoaded(e)},homeError:function(e){o.homeError(e)},progression:function(e,t,i){o.progression(e,t,i)}}}e=i}HomeRecorder.prototype.readHome.call(this,e,t)},IncrementalHomeRecorder.prototype.checkPoint=function(e){var t=this;t.homeData[e.editionId].existingHomeObjects={},e.getHomeObjects().forEach((function(i){t.homeData[e.editionId].existingHomeObjects[i.id]=i.id}))},IncrementalHomeRecorder.prototype.addHome=function(e,t){if(void 0!==this.configuration.writeHomeEditsURL){void 0===t&&void 0!==this.application.getHomeController&&(t=this.application.getHomeController(e)),void 0===e.editionId&&(e.editionId=HomeObject.createId("home")),this.homeData[e.editionId]={},this.checkPoint(e),this.homeData[e.editionId].undoableEditSupport=t.getUndoableEditSupport();var i=this,n={undoableEditHappened:function(t){i.storeEdit(e,t.getEdit()),i.scheduleWrite(e)},source:i};this.homeData[e.editionId].undoableEditSupport.addUndoableEditListener(n);var o=t.undoManager,r=o.undo,l=o.redo;o.undo=function(){var t=o.editToBeUndone();r.call(o),i.storeEdit(e,t,!0),i.scheduleWrite(e)},o.redo=function(){var t=o.editToBeRedone();l.call(o),i.storeEdit(e,t),i.scheduleWrite(e)};var a=function(t){var n=void 0;t.source===e.getObserverCamera()&&(n="observerCamera"),t.source===e.getTopCamera()&&(n="topCamera"),t.source!==e&&t.source!==e.getEnvironment()||-1!==i.getTrackedHomeProperties().indexOf(t.getPropertyName())&&(n=t.getPropertyName()),void 0!==n&&(void 0===i.homeData[e.editionId].trackedStateChanges&&(i.homeData[e.editionId].trackedStateChanges={}),i.homeData[e.editionId].trackedStateChanges[n]=!0)};e.getObserverCamera().addPropertyChangeListener(a),e.getTopCamera().addPropertyChangeListener(a);for(var s=this.getTrackedHomeProperties(),h=0;h<s.length;h++)"OBSERVER_CAMERA_ELEVATION_ADJUSTED"==s[h]||"ALL_LEVELS_VISIBLE"==s[h]?e.getEnvironment().addPropertyChangeListener(s[h],a):e.addPropertyChangeListener(s[h],a);i.getAutoWriteDelay()>0&&i.scheduleWrite(e)}},IncrementalHomeRecorder.prototype.getAutoWriteDelay=function(){return void 0===this.configuration||void 0===this.configuration.autoWriteDelay?-1:this.configuration.autoWriteDelay},IncrementalHomeRecorder.prototype.removeHome=function(e){if(void 0!==this.configuration.closeHomeURL){var t=CoreTools.format(this.configuration.closeHomeURL.replace(/(%[^s])/g,"%$1"),encodeURIComponent(e.name));if(navigator.sendBeacon)navigator.sendBeacon(t);else try{var i=new XMLHttpRequest;i.open("GET",t,!0),i.send()}catch(e){console.log(e)}}if(void 0!==this.configuration.writeHomeEditsURL){for(var n=this.homeData[e.editionId].undoableEditSupport.getUndoableEditListeners(),o=0;o<n.length;o++)if(n[o].source===this){this.homeData[e.editionId].undoableEditSupport.removeUndoableEditListener(n[o]);break}delete this.homeData[e.editionId]}},IncrementalHomeRecorder.prototype.saveBlobs=function(e,t){if(e)if(e.blob instanceof Blob&&e.resourceFileName){var i=this.configuration.writeResourceURL,n=CoreTools.format(i.replace(/(%[^s])/g,"%$1"),encodeURIComponent(e.resourceFileName)),o=new XMLHttpRequest;o.open("POST",n,!0),o.addEventListener("load",(function(i){o.readyState===XMLHttpRequest.DONE&&(200===o.status?(delete e.blob,delete e.resourceFileName):t(o.status,o.statusText))}));var r=function(e){t(0,"Can't post "+n)};o.addEventListener("error",r),o.addEventListener("timeout",r),o.send(e.blob)}else for(var l=Object.getOwnPropertyNames(e),a=0;a<l.length;a++){var s=l[a];if("_type"!=s){var h=e[s];"object"==typeof h&&this.saveBlobs(h,t)}}},IncrementalHomeRecorder.prototype.sendUndoableEdits=function(e){if(this.hasEdits(e)){this.addTrackedStateChange(e);var t=this,i=this.beginUpdate(e);if(null!==i){var n=function(n,o){t.rollbackUpdate(e,i,n,o),t.scheduleWrite(e,1e4)};if(this.configuration.writeResourceURL&&this.configuration.readResourceURL)for(var o=0;o<i.edits.length;o++)this.saveBlobs(i.edits[o],n);var r=new XMLHttpRequest,l=this.configuration.writeHomeEditsURL;r.open("POST",l,!0),r.withCredentials=!0,r.addEventListener("load",(function(o){if(r.readyState===XMLHttpRequest.DONE)if(200===r.status){var l=JSON.parse(r.responseText);l&&l.result===i.edits.length?t.commitUpdate(e,i):(console.log(r.responseText),n(r.status,r.responseText))}else n(r.status,r.statusText)}));var a=function(e){n(0,"Can't post "+l)};r.addEventListener("error",a),r.addEventListener("timeout",a),r.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),r.send("home="+encodeURIComponent(e.name)+"&editionId="+e.editionId+"&version="+this.application.getVersion()+"&edits="+encodeURIComponent(JSON.stringify(i.edits)))}}},IncrementalHomeRecorder.prototype.hasEdits=function(e){return void 0!==this.queue&&this.queue.length>0||this.configuration&&this.configuration.autoWriteTrackedStateChange&&void 0!==this.homeData[e.editionId].trackedStateChanges},IncrementalHomeRecorder.prototype.addTrackedStateChange=function(e,t){if(void 0!==this.homeData[e.editionId].trackedStateChanges&&(t||this.configuration&&this.configuration.autoWriteTrackedStateChange)){for(var i={_type:"com.eteks.sweethome3d.io.TrackedStateChangeUndoableEdit"},n=this.getTrackedHomeProperties(),o=0;o<n.length;o++){var r=n[o];if(this.homeData[e.editionId].trackedStateChanges[r])switch(r){case"CAMERA":i.camera=e.getCamera();break;case"STORED_CAMERAS":i.storedCameras=e.getStoredCameras();break;case"SELECTED_LEVEL":i.selectedLevel=e.getSelectedLevel();break;case"FURNITURE_SORTED_PROPERTY":i.furnitureSortedProperty=e.getFurnitureSortedProperty();break;case"FURNITURE_DESCENDING_SORTED":i.furnitureDescendingSorted=e.isFurnitureDescendingSorted();break;case"FURNITURE_VISIBLE_PROPERTIES":i.furnitureVisibleProperties=e.getFurnitureVisibleProperties();break;case"OBSERVER_CAMERA_ELEVATION_ADJUSTED":i.observerCameraElevationAdjusted=e.getEnvironment().isObserverCameraElevationAdjusted();break;case"ALL_LEVELS_VISIBLE":i.allLevelsVisible=e.getEnvironment().isAllLevelsVisible();break;default:void 0===i.homeProperties&&(i.homeProperties={}),i.homeProperties[r]=e.getProperty(r)}}this.homeData[e.editionId].trackedStateChanges.topCamera&&(i.topCamera=e.getTopCamera().duplicate()),this.homeData[e.editionId].trackedStateChanges.observerCamera&&(i.observerCamera=e.getObserverCamera().duplicate()),this.homeData[e.editionId].trackedStateChanges=void 0,this.storeEdit(e,i)}},IncrementalHomeRecorder.prototype.scheduleWrite=function(e,t){if(void 0===t&&(t=this.getAutoWriteDelay()),t>=0){void 0!==this.homeData[e.editionId].scheduledWrite&&(clearTimeout(this.homeData[e.editionId].scheduledWrite),this.homeData[e.editionId].scheduledWrite=void 0);var i=this;this.homeData[e.editionId].scheduledWrite=setTimeout((function(){i.homeData[e.editionId].scheduledWrite=void 0,i.online&&i.hasEdits(e)&&i.sendUndoableEdits(e),i.getAutoWriteDelay()>0&&i.scheduleWrite(e)}),t)}},IncrementalHomeRecorder.prototype.storeEdit=function(e,t,i){var n=[],o=this.substituteIdentifiableObjects(e,t,null,{},n,["object3D","hasBeenDone","alive","presentationNameKey","__parent"],[UserPreferences,PlanController,Home],[Boolean,String,Number]);n.length>0&&(o._newObjects=n),i&&(o._action="undo"),o._undoableEditId=UUID.randomUUID(),this.queue||(this.queue=[]),this.queue.push(o),"com.eteks.sweethome3d.io.TrackedStateChangeUndoableEdit"!=t._type&&this.checkPoint(e)},IncrementalHomeRecorder.prototype.beginUpdate=function(e){return void 0!==this.homeData[e.editionId].ongoingUpdate?(this.homeData[e.editionId].rejectedUpdate=!0,null):(this.homeData[e.editionId].ongoingUpdate={home:e,edits:this.queue.slice(0)},this.configuration.writingObserver&&this.configuration.writingObserver.writeStarted&&this.configuration.writingObserver.writeStarted(this.homeData[e.editionId].ongoingUpdate),this.homeData[e.editionId].ongoingUpdate)},IncrementalHomeRecorder.prototype.commitUpdate=function(e,t){for(var i=0;i<t.edits.length;i++){if(this.queue[0]!==t.edits[i])throw new Error("Unexpected error while saving");this.queue.shift()}this.configuration.writingObserver&&this.configuration.writingObserver.writeSucceeded&&this.configuration.writingObserver.writeSucceeded(t),this.homeData[e.editionId].ongoingUpdate=void 0,this.homeData[e.editionId].rejectedUpdate&&(this.homeData[e.editionId].rejectedUpdate=void 0,this.scheduleWrite(e,0))},IncrementalHomeRecorder.prototype.rollbackUpdate=function(e,t,i,n){this.configuration.writingObserver&&this.configuration.writingObserver.writeFailed&&this.configuration.writingObserver.writeFailed(t,i,n),this.homeData[e.editionId].ongoingUpdate=void 0,this.homeData[e.editionId].rejectedUpdate=void 0},IncrementalHomeRecorder.prototype.substituteIdentifiableObjects=function(e,t,i,n,o,r,l,a){if(Array.isArray(t)){for(var s=t.slice(0),h=0;h<t.length;h++)s[h]=this.substituteIdentifiableObjects(e,t[h],t,n,o,r,l,a);return s}if(t instanceof Big)return{value:t.toString(),_type:"java.math.BigDecimal"};if(t instanceof LocalURLContent||t instanceof URLContent&&t.isJAREntry()&&URLContent.fromURL(t.getJAREntryURL())instanceof LocalURLContent){var u=t.isJAREntry()?URLContent.fromURL(t.getJAREntryURL()):t;if(null!=u.getSavedContent()&&u.getSavedContent().getURL().indexOf(LocalStorageURLContent.LOCAL_STORAGE_PREFIX)<0&&u.getSavedContent().getURL().indexOf(IndexedDBURLContent.INDEXED_DB_PREFIX)<0)return this.substituteIdentifiableObjects(e,t.isJAREntry()?URLContent.fromURL("jar:"+u.getSavedContent().getURL()+"!/"+t.getJAREntryName()):u.getSavedContent(),i,n,o,r,l,a);var d=u.getBlob(),c="dat";"image/png"==d.type?c="png":"image/jpeg"==d.type&&(c="jpg");var p=UUID.randomUUID()+"."+c,g=URLContent.fromURL(CoreTools.format(this.configuration.readResourceURL.replace(/(%[^s])/g,"%$1"),encodeURIComponent(p)));return u.setSavedContent(g),(s=this.substituteIdentifiableObjects(e,t.isJAREntry()?URLContent.fromURL("jar:"+u.getSavedContent().getURL()+"!/"+t.getJAREntryName()):u.getSavedContent(),i,n,o,r,l,a)).resourceFileName=p,s.blob=d,s}if(null==t||t!==Object(t)||a.some((function(e){return t instanceof e})))return t;if(void 0!==t.id&&(void 0!==this.homeData[e.editionId].existingHomeObjects[t.id]||void 0!==n[t.id]||t instanceof Home))return t.id;s={};void 0!==t.id&&(n[t.id]=s,o.push(s)),t.constructor&&t.constructor.__class&&("com.eteks.sweethome3d.tools.URLContent"!=t.constructor.__class||void 0===i||i.constructor===Object)&&(s._type=t.constructor.__class);for(var m=Object.getOwnPropertyNames(t),f=0;f<m.length;f++){var v=m[f];if((!t.constructor||!t.constructor.__transients||-1==t.constructor.__transients.indexOf(v))&&-1===r.indexOf(v)){var _=t[v];"function"==typeof _||l.some((function(e){return _ instanceof e}))||(s[v]=this.substituteIdentifiableObjects(e,_,t,n,o,r,l,a))}}return void 0!==t.id?t.id:s},LocalFileHomeController.prototype=Object.create(HomeController.prototype),LocalFileHomeController.prototype.constructor=LocalFileHomeController,LocalFileHomeController.prototype.newHome=function(){var e=this,t=function(){e.close(),e.application.addHome(e.application.createHome())};this.home.isModified()||this.home.isRecovered()?this.getView().confirmSave(void 0===this.application.configuration||this.home.getName()!==this.application.configuration.defaultHomeName?this.home.getName():null,(function(i){i?e.save(t):t()})):t()},LocalFileHomeController.prototype.open=function(){var e=this,t=function(t){var i=this.application.getUserPreferences(),n=new JSDialog(i,i.getLocalizedString("ThreadedTaskPanel","threadedTask.title"),i.getLocalizedString("HomeController","openMessage"),{size:"small"});n.findElement(".dialog-cancel-button").style="display: none";var o=document.createElement("input");o.setAttribute("style","display: none"),o.setAttribute("type","file"),document.body.appendChild(o),o.addEventListener("change",(function(t){if(document.body.removeChild(o),this.files[0]){n.displayView();var r=this.files[0];setTimeout((function(){var t=r.name.substring(r.name.indexOf("/")+1);e.application.getHomeRecorder().readHome(URL.createObjectURL(r),{homeLoaded:function(t){e.close(),n.close(),e.application.addHome(t)},homeError:function(e){n.close();var o=i.getLocalizedString("HomeController","openError",t)+"\n"+e;console.log(e),alert(o)}})}),100)}})),o.click()};this.home.isModified()||this.home.isRecovered()?this.getView().confirmSave(void 0===this.application.configuration||this.home.getName()!==this.application.configuration.defaultHomeName?this.home.getName():null,(function(i){i?e.save(t):t()})):t()},LocalFileHomeController.prototype.save=function(e){if(null==this.home.getName()||void 0!==this.application.configuration&&this.home.getName()===this.application.configuration.defaultHomeName)this.saveAs(e);else{var t=this.application.getUserPreferences(),i=new JSDialog(t,t.getLocalizedString("ThreadedTaskPanel","threadedTask.title"),t.getLocalizedString("HomeController","saveMessage"),{size:"small",disposer:function(e){void 0!==e.writingOperation&&e.writingOperation.abort()}});this.application.getHomeRecorder().configuration&&this.application.getHomeRecorder().configuration.writeHomeWithWorker?i.findElement(".dialog-cancel-button").innerHTML=ResourceAction.getLocalizedLabelText(t,"ThreadedTaskPanel","cancelButton.text"):i.findElement(".dialog-cancel-button").style="display: none",i.displayView();var n=this,o=application.getUserPreferences().getLocalizedString("FileContentManager","homeExtension"),r=application.getUserPreferences().getLocalizedString("FileContentManager","homeExtension2"),l=n.home.getName().replace(o,r);setTimeout((function(){i.writingOperation=n.application.getHomeRecorder().writeHome(n.home,l,{homeSaved:function(t,n){if(delete i.writingOperation,i.close(),void 0!==navigator.msSaveOrOpenBlob)navigator.msSaveOrOpenBlob(n,l);else{var o=document.createElement("a");o.setAttribute("style","display: none"),o.setAttribute("href",URL.createObjectURL(n)),o.setAttribute("download",l),document.body.appendChild(o),o.click(),setTimeout((function(){document.body.removeChild(o),URL.revokeObjectURL(o.getAttribute("href"))}),500)}t.setModified(!1),t.setRecovered(!1),void 0!==e&&e()},homeError:function(e,n){i.close(),console.log(e+" "+n),new JSDialog(t,t.getLocalizedString("HomePane","error.title"),t.getLocalizedString("HomeController","saveError",l,e+"<br>"+n),{size:"small"}).displayView()}})}),200)}},LocalFileHomeController.prototype.saveAs=function(e){var t=this.application.getUserPreferences().getLocalizedString("AppletContentManager","showSaveDialog.message"),i=prompt(t);if(null!=i&&i.length>0){var n=application.getUserPreferences().getLocalizedString("FileContentManager","homeExtension2");this.home.setName(i+(i.indexOf(".")<0?n:"")),this.save(e)}},LocalFileHomeController.prototype.close=function(){this.home.setRecovered(!1),this.application.deleteHome(this.home),this.getView().dispose()},DirectRecordingHomeController.prototype=Object.create(HomeController.prototype),DirectRecordingHomeController.prototype.constructor=DirectRecordingHomeController,DirectRecordingHomeController.prototype.newHome=function(){var e=this,t=function(){e.close(),e.application.addHome(e.application.createHome())};this.home.isModified()||this.home.isRecovered()?this.getView().confirmSave(void 0===this.application.configuration||this.home.getName()!==this.application.configuration.defaultHomeName?this.home.getName():null,(function(i){i?e.save(t):t()})):t()},DirectRecordingHomeController.prototype.open=function(){var e=this,t=e.application.getUserPreferences(),i=function(i){null!=i&&i.length>0&&e.application.getHomeRecorder().readHome(i,{homeLoaded:function(t){t.setName(i),e.close(),e.application.addHome(t)},homeError:function(e){var n=t.getLocalizedString("HomeController","openError",i)+"\n"+e;console.log(e),alert(n)},progression:function(e,t,i){}})},n=function(){if(null==e.application.getHomeRecorder().getAvailableHomes({availableHomes:function(n){if(0==n.length){var o=t.getLocalizedString("AppletContentManager","showOpenDialog.noAvailableHomes");alert(o)}else{var r=new JSDialog(t,"@{FileContentManager.openDialog.title}",'  <div class="column1">    <div>@{AppletContentManager.showOpenDialog.message}</div>    <div class="home-list"></div>  </div>',{size:"small",applier:function(e){var t=r.findElement(".selected");null!=t&&i(t.innerText)}});r.getHTMLElement().classList.add("open-dialog");var l=r.findElement(".dialog-ok-button");l.innerHTML=t.getLocalizedString("AppletContentManager","showOpenDialog.open"),l.disabled=!0;var a=r.findElement(".dialog-cancel-button");a.innerHTML=t.getLocalizedString("AppletContentManager","showOpenDialog.cancel");var s=document.createElement("button");s.innerHTML=t.getLocalizedString("AppletContentManager","showOpenDialog.delete"),s.disabled=!0,a.parentElement.insertBefore(s,a);for(var h=r.findElement(".home-list"),u=0;u<n.length;u++){var d=document.createElement("div");d.classList.add("item"),d.innerHTML=n[u],h.appendChild(d)}var c=h.childNodes;r.registerEventListener(c,"click",(function(t){for(var i=0;i<c.length;i++)t.target==c[i]?(c[i].classList.add("selected"),l.disabled=!1,s.disabled=t.target.innerHTML==e.home.getName()):c[i].classList.remove("selected")})),r.registerEventListener(c,"dblclick",(function(){r.validate()})),r.registerEventListener(s,"click",(function(i){var n=r.findElement(".selected");e.confirmDeleteHome(n.innerText,(function(){e.application.getHomeRecorder().deleteHome(n.innerText,{homeDeleted:function(){n.remove(),l.disabled=!0,s.disabled=!0},homeError:function(e,i){var o=t.getLocalizedString("AppletContentManager","confirmDeleteHome.errorMessage",n.innerText);console.log(o+" : "+i),alert(o)}})}))})),r.displayView()}},homesError:function(e,i){var n=t.getLocalizedString("AppletContentManager","showOpenDialog.availableHomesError");console.log(n+" : "+i),alert(n)}})){var n=t.getLocalizedString("AppletContentManager","showOpenDialog.message");i(prompt(n))}};this.home.isModified()||this.home.isRecovered()?this.getView().confirmSave(void 0===this.application.configuration||this.home.getName()!==this.application.configuration.defaultHomeName?this.home.getName():null,(function(t){t?e.save(n):n()})):n()},DirectRecordingHomeController.prototype.save=function(e){if(null==this.home.getName()||void 0!==this.application.configuration&&this.home.getName()===this.application.configuration.defaultHomeName)this.saveAs(e);else{var t=this.application.getUserPreferences(),i=new JSDialog(t,t.getLocalizedString("ThreadedTaskPanel","threadedTask.title"),t.getLocalizedString("HomeController","saveMessage"),{size:"small",disposer:function(e){void 0!==e.writingOperation&&e.writingOperation.abort()}});i.findElement(".dialog-cancel-button").innerHTML=ResourceAction.getLocalizedLabelText(t,"ThreadedTaskPanel","cancelButton.text"),i.displayView();var n=this;i.writingOperation=this.application.getHomeRecorder().writeHome(this.home,this.home.getName(),{homeSaved:function(t){delete i.writingOperation,i.close(),t.setModified(!1),t.setRecovered(!1),void 0!==e&&e()},homeError:function(e,o){i.close(),new JSDialog(t,t.getLocalizedString("HomePane","error.title"),t.getLocalizedString("HomeController","saveError",[n.home.getName(),o]),{size:"small"}).displayView()}})}},DirectRecordingHomeController.prototype.saveAs=function(e){var t=this.application.getUserPreferences(),i=t.getLocalizedString("AppletContentManager","showSaveDialog.message"),n=prompt(i,null==this.home.getName()||void 0!==this.application.configuration&&this.home.getName()===this.application.configuration.defaultHomeName?void 0:this.home.getName());if(null!=n&&n.length>0){var o=this;null==o.application.getHomeRecorder().getAvailableHomes({availableHomes:function(i){for(var r=!1,l=0;l<i.length;l++)n==i[l]&&(r=!0);if(r){var a=t.getLocalizedString("FileContentManager","confirmOverwrite.message",n).replace(/\<br\>/g," "),s=new JSDialog(t,t.getLocalizedString("FileContentManager","confirmOverwrite.title"),a+"</font>",{size:"small",applier:function(){o.home.setName(n),o.save(e)}});s.findElement(".dialog-ok-button").innerHTML=t.getLocalizedString("FileContentManager","confirmOverwrite.overwrite"),s.findElement(".dialog-cancel-button").innerHTML=t.getLocalizedString("FileContentManager","confirmOverwrite.cancel"),s.displayView()}else o.home.setName(n),o.save(e)},homesError:function(e,i){var n=t.getLocalizedString("AppletContentManager","showSaveDialog.checkHomeError");console.log(n+" : "+i),alert(n)}})&&(this.home.setName(n),this.save(e))}},DirectRecordingHomeController.prototype.close=function(){this.home.setRecovered(!1),this.application.deleteHome(this.home),this.getView().dispose()},DirectRecordingHomeController.prototype.confirmDeleteHome=function(e,t){var i=this.application.getUserPreferences(),n=i.getLocalizedString("AppletContentManager","confirmDeleteHome.message",e).replace(/\<br\>/g," "),o=new JSDialog(i,i.getLocalizedString("AppletContentManager","confirmDeleteHome.title"),n+"</font>",{size:"small",applier:function(){t()}});o.findElement(".dialog-ok-button").innerHTML=i.getLocalizedString("AppletContentManager","confirmDeleteHome.delete"),o.findElement(".dialog-cancel-button").innerHTML=i.getLocalizedString("AppletContentManager","confirmDeleteHome.cancel"),o.displayView()},SweetHome3DJSApplication.prototype=Object.create(HomeApplication.prototype),SweetHome3DJSApplication.prototype.constructor=SweetHome3DJSApplication,SweetHome3DJSApplication.prototype.getVersion=function(){return"7.5.2"},SweetHome3DJSApplication.prototype.getHomeRecorder=function(){return this.homeRecorder||(this.homeRecorder=void 0===this.configuration||void 0===this.configuration.readHomeURL?new HomeRecorder(this.configuration):void 0!==this.configuration.writeHomeEditsURL?new IncrementalHomeRecorder(this,this.configuration):new DirectHomeRecorder(this.configuration)),this.homeRecorder},SweetHome3DJSApplication.prototype.getUserPreferences=function(){return null==this.preferences&&(void 0===this.configuration?this.preferences=new DefaultUserPreferences:this.preferences=new RecordedUserPreferences(this.configuration)),this.preferences},SweetHome3DJSApplication.prototype.createHome=function(){var e=HomeApplication.prototype.createHome.call(this);return void 0!==this.configuration&&void 0!==this.configuration.defaultHomeName&&e.setName(this.configuration.defaultHomeName),e},SweetHome3DJSApplication.prototype.getViewFactory=function(){return null==this.viewFactory&&(this.viewFactory=new JSViewFactory(this)),this.viewFactory},SweetHome3DJSApplication.prototype.createHomeController=function(e){return void 0===this.configuration||void 0===this.configuration.readHomeURL?new LocalFileHomeController(e,this,this.getViewFactory()):void 0!==this.configuration.writeHomeEditsURL?new HomeController(e,this,this.getViewFactory()):new DirectRecordingHomeController(e,this,this.getViewFactory())},SweetHome3DJSApplication.prototype.getHomeController=function(e){return this.homeControllers[this.getHomes().indexOf(e)]},AutoRecoveryManager.prototype.saveRecoveredHomes=function(){for(var e=this.application.getHomes(),t=0;t<e.length;t++){var i=e[t];null!=i.getName()&&(i.isModified()?this.autoSaveRecorder.writeHome(i,i.getName(),{homeSaved:function(e){},homeError:function(e,t){console.log("Couldn't save home for recovery : "+e+" "+t)}}):this.recoveredHomeNames.indexOf(i.getName())<0&&this.deleteRecoveredHome(i.getName()))}this.lastAutoSaveTime=Math.max(this.lastAutoSaveTime,Date.now())},AutoRecoveryManager.prototype.restartTimer=function(){var e=this;this.stopTimer();var t=application.getUserPreferences().getAutoSaveDelayForRecovery();if(t>0){this.timerIntervalId=setInterval((function(){Date.now()-e.lastAutoSaveTime>5e3&&e.saveRecoveredHomes()}),t)}},AutoRecoveryManager.prototype.stopTimer=function(){this.timerIntervalId&&(window.clearInterval(this.timerIntervalId),delete this.timerIntervalId)},AutoRecoveryManager.prototype.deleteRecoveredHome=function(e){var t=this;this.autoSaveRecorder.deleteHome(e,{homeDeleted:function(){0==t.recoveredHomeNames.length&&t.autoSaveRecorder.getAvailableHomes({availableHomes:function(e){if(0===e.length){var i=new DirectHomeRecorder({listHomesURL:t.autoRecoveryDatabaseUrlBase+"?name=.*",deleteHomeURL:t.autoRecoveryDatabaseUrlBase+"?name=%s"});i.getAvailableHomes({availableHomes:function(e){for(var t=0;t<e.length;t++)i.deleteHome(e[t],{homeDeleted:function(){}})}})}}})}})};